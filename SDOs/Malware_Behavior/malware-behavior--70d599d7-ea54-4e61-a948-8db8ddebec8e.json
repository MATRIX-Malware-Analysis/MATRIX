{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--70d599d7-ea54-4e61-a948-8db8ddebec8e",
    "created": "2024-08-13T14:46:36.682278Z",
    "modified": "2024-08-13T14:46:36.682278Z",
    "name": "DHCP Spoofing",
    "description": "An adversary masquerades as a legitimate Dynamic Host Configuration Protocol (DHCP) server by spoofing DHCP traffic, with the goal of redirecting network traffic or denying service to DHCP.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/697.html",
            "external_id": "697"
        },
        {
            "source_name": "CWE",
            "external_id": "923"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Read Data",
            "scope": "Access Control"
        },
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Integrity"
        },
        {
            "impact": "Modify Data",
            "scope": "Access Control"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Access Control"
        },
        {
            "impact": "Resource Consumption",
            "scope": "Availability"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "In early 2019, Microsoft patched a critical vulnerability (CVE-2019-0547) in the Windows DHCP client which allowed remote code execution via crafted DHCP OFFER packets. [REF-739]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Determine Exsisting DHCP lease] An adversary observes network traffic and waits for an existing DHCP lease to expire on a target machine in the LAN.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Adversary observes LAN traffic for DHCP solicitations"
            ]
        },
        {
            "description": "[Capture the DHCP DISCOVER message] The adversary captures \"DISCOVER\" messages and crafts \"OFFER\" responses for the identified target MAC address. The success of this attack centers on the capturing of and responding to these \"DISCOVER\" messages.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Adversary captures and responds to DHCP \"DISCOVER\" messages tailored to the target subnet."
            ]
        },
        {
            "description": "[Compromise Network Access and Collect Network Activity] An adversary successfully acts as a rogue DHCP server by redirecting legitimate DHCP requests to itself.",
            "phase": "Exploit",
            "step": "3",
            "techniques": [
                "Adversary sends repeated DHCP \"REQUEST\" messages to quickly lease all the addresses within network's DHCP pool and forcing new DHCP requests to be handled by the rogue DHCP server."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Low",
    "x_mitre_mitigations": [
        {
            "description": "Design: MAC-Forced Forwarding"
        },
        {
            "description": "Implementation: Port Security and DHCP snooping"
        },
        {
            "description": "Implementation: Network-based Intrusion Detection Systems"
        }
    ]
}