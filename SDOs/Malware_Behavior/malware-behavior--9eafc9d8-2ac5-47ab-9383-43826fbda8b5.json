{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--9eafc9d8-2ac5-47ab-9383-43826fbda8b5",
    "created": "2024-08-13T14:46:37.050164Z",
    "modified": "2024-08-13T14:46:45.69086Z",
    "name": "Remote Services: SSH",
    "description": "Adversaries may use Valid Accounts to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user.SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user\u2019s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1021/004",
            "external_id": "T1021/004"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects SSH user login access failures.\nPlease note that this rule can be noisy and is recommended to use with correlation based on \"author.name\" field.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "User login failed(SSH)",
                    "auditType.category": "Authentication"
                }
            },
            "falsepositives": [
                "Legitimate user wrong password attempts."
            ],
            "id": "d3f90469-fb05-42ce-b67d-0fded91bbef3",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/view-and-configure-the-audit-log-776640417.html",
                "https://confluence.atlassian.com/bitbucketserver/enable-ssh-access-to-git-repositories-776640358.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1021.004",
                "attack.t1110"
            ],
            "title": "Bitbucket User Login Failure Via SSH"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects Bitbucket global SSH access configuration changes.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "SSH settings changed",
                    "auditType.category": "Global administration"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "16ab6143-510a-44e2-a615-bdb80b8317fc",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/enable-ssh-access-to-git-repositories-776640358.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.lateral_movement",
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1021.004"
            ],
            "title": "Bitbucket Global SSH Settings Changed"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/12",
            "description": "Detects port forwarding activity via SSH.exe",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|windash": " -R ",
                    "Image|endswith": "\\ssh.exe"
                }
            },
            "falsepositives": [
                "Administrative activity using a remote port forwarding to a local port"
            ],
            "id": "327f48c1-a6db-4eb8-875a-f6981f1b0183",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "status": "experimental",
            "references": [
                "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.lateral_movement",
                "attack.t1572",
                "attack.t1021.001",
                "attack.t1021.004"
            ],
            "title": "Port Forwarding Activity Via SSH.EXE"
        },
        {
            "author": "mdecrevoisier",
            "date": "2022/10/25",
            "description": "Detects scenarios where an attacker enables the OpenSSH server and server starts to listening on SSH socket.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4,
                    "payload|startswith": "Server listening on ",
                    "process": "sshd"
                }
            },
            "falsepositives": [
                "Legitimate administrator activity"
            ],
            "id": "3ce8e9a4-bc61-4c9b-8e69-d7e2492a8781",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "openssh"
            },
            "references": [
                "https://github.com/mdecrevoisier/EVTX-to-MITRE-Attack/tree/master/TA0008-Lateral%20Movement/T1021.004-Remote%20Service%20SSH",
                "https://winaero.com/enable-openssh-server-windows-10/",
                "https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse",
                "https://virtualizationreview.com/articles/2020/05/21/ssh-server-on-windows-10.aspx",
                "https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1021.004"
            ],
            "title": "OpenSSH Server Listening On Socket"
        }
    ]
}