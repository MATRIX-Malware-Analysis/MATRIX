{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--f72ff75f-74c8-429c-a662-29e9d0f2d81a",
    "created": "2024-08-13T14:46:37.163853Z",
    "modified": "2024-08-13T14:46:46.400261Z",
    "name": "Indicator Removal: Clear Linux or Mac System Logs",
    "description": "Adversaries may clear system logs to hide evidence of an intrusion. macOS and Linux both keep track of system or user-initiated actions via system logs. The majority of native system logging is stored under the /var/log/ directory. Subfolders in this directory categorize logs by their related functions, such as:[1]/var/log/messages:: General and system-related messages/var/log/secure or /var/log/auth.log: Authentication logs/var/log/utmp or /var/log/wtmp: Login records/var/log/kern.log: Kernel logs/var/log/cron.log: Crond logs/var/log/maillog: Mail server logs/var/log/httpd/: Web server access and error logs",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1070/002",
            "external_id": "T1070/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "remotephone, oscd.community",
            "date": "2020/10/11",
            "description": "Detects deletion of local audit logs",
            "detection": {
                "condition": "selection1 and 1 of selection_cli*",
                "selection1": {
                    "Image|endswith": [
                        "/rm",
                        "/unlink",
                        "/shred"
                    ]
                },
                "selection_cli_1": {
                    "CommandLine|contains": "/var/log"
                },
                "selection_cli_2": {
                    "CommandLine|contains|all": [
                        "/Users/",
                        "/Library/Logs/"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "acf61bd8-d814-4272-81f0-a7a269aa69aa",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/09/16",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.002"
            ],
            "title": "Indicator Removal on Host - Clear Mac System Logs"
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/07",
            "description": "Detects attempts to clear logs on the system. Adversaries may clear system logs to hide evidence of an intrusion",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "/var/log",
                        "/var/spool/mail"
                    ],
                    "Image|endswith": [
                        "/rm",
                        "/shred",
                        "/unlink"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "80915f59-9b56-4616-9de0-fd0dea6c12fe",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.002"
            ],
            "title": "Clear Linux Logs"
        },
        {
            "author": "Max Altgelt (Nextron Systems), Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Detects specific commands commonly used to remove or empty the syslog. Which is often used by attacker as a method to hide their tracks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "rm /var/log/syslog",
                        "rm -r /var/log/syslog",
                        "rm -f /var/log/syslog",
                        "rm -rf /var/log/syslog",
                        "unlink /var/log/syslog",
                        "unlink -r /var/log/syslog",
                        "unlink -f /var/log/syslog",
                        "unlink -rf /var/log/syslog",
                        "mv /var/log/syslog",
                        " >/var/log/syslog",
                        " > /var/log/syslog"
                    ]
                }
            },
            "falsepositives": [
                "Log rotation."
            ],
            "id": "3fcc9b35-39e4-44c0-a2ad-9e82b6902b31",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.002"
            ],
            "title": "Commands to Clear or Remove the Syslog"
        }
    ]
}