{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--efd9a4f2-14d8-4996-ab8c-338f11d99975",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:37.288683Z",
    "name": "Plist File Modification",
    "description": "Adversaries may modify property list files (plist files) to enable other malicious activity, while also potentially evading and bypassing system defenses. macOS applications use plist files, such as the info.plist file, to store properties and configuration settings that inform the operating system how to handle the application at runtime. Plist files are structured metadata in key-value pairs formatted in XML based on Apple's Core Foundation DTD. Plist files can be saved in text or binary format.[1] Adversaries can modify key-value pairs in plist files to influence system behaviors, such as hiding the execution of an application (i.e. Hidden Window) or running additional commands for persistence (ex: Launch Agent/Launch Daemon or Re-opened Applications).For example, adversaries can add a malicious application path to the ~/Library/Preferences/com.apple.dock.plist file, which controls apps that appear in the Dock. Adversaries can also modify the LSUIElement key in an application\u2019s info.plist file  to run the app in the background. Adversaries can also insert key-value pairs to insert environment variables, such as LSEnvironment, to enable persistence via Dynamic Linker Hijacking.[2][3]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1647",
            "external_id": "T1647"
        },
        {
            "source_name": "CAPEC 203",
            "external_id": "malware-behavior--a9869766-8217-45ff-97e9-7f55f93a3282"
        },
        {
            "source_name": "mitre-attack",
            "external_id": "T1647",
            "url": "https://attack.mitre.org/techniques/T1647"
        },
        {
            "source_name": "eset_osx_flashback",
            "url": "https://www.welivesecurity.com/wp-content/uploads/200x/white-papers/osx_flashback.pdf",
            "description": "ESET. (2012, January 1). OSX/Flashback. Retrieved April 19, 2022."
        },
        {
            "source_name": "fileinfo plist file description",
            "url": "https://fileinfo.com/extension/plist",
            "description": "FileInfo.com team. (2019, November 26). .PLIST File Extension. Retrieved October 12, 2021."
        },
        {
            "source_name": "wardle chp2 persistence",
            "url": "https://taomm.org/PDFs/vol1/CH%200x02%20Persistence.pdf",
            "description": "Patrick Wardle. (2022, January 1). The Art of Mac Malware Volume 0x1:Analysis. Retrieved April 19, 2022."
        }
    ],
    "x_mitre_platforms": [
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "phase_name": "defense-evasion",
            "kill_chain_name": "mitre-attack"
        }
    ],
    "x_mitre_detection": "Monitor for common command-line editors used to modify plist files located in auto-run locations, such as <code>\\~/LaunchAgents</code>, <code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code>, and an application's <code>Info.plist</code>. \n\nMonitor for plist file modification immediately followed by code execution from <code>\\~/Library/Scripts</code> and <code>~/Library/Preferences</code>. Also, monitor for significant changes to any path pointers in a modified plist.\n\nIdentify new services executed from plist modified in the previous user's session. ",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "Process: Process Creation",
        "File: File Modification"
    ],
    "x_mitre_permissions_required": []
}