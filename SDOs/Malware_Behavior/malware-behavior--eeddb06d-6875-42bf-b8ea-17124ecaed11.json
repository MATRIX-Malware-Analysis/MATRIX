{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--eeddb06d-6875-42bf-b8ea-17124ecaed11",
    "created": "2024-08-13T14:46:37.14206Z",
    "modified": "2024-08-13T14:46:46.267584Z",
    "name": "Data Manipulation: Stored",
    "description": "Adversaries may insert, delete, or manipulate data at rest in order to influence external outcomes or hide activity, thus threatening the integrity of the data.[1][2] By manipulating stored data, adversaries may attempt to affect a business process, organizational understanding, and decision making.Stored data could include a variety of file formats, such as Office files, databases, stored emails, and custom file formats. The type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1565/001",
            "external_id": "T1565/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/08",
            "description": "Identifies when DNS zone is modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName|endswith": [
                        "/WRITE",
                        "/DELETE"
                    ],
                    "operationName|startswith": "MICROSOFT.NETWORK/DNSZONES"
                }
            },
            "falsepositives": [
                "DNS zone modified and deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "DNS zone modification from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "af6925b0-8826-47f1-9324-337507a0babd",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1565.001"
            ],
            "title": "Azure DNS Zone Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/03",
            "description": "Identifies when a device or device configuration in azure is modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "properties.message": [
                        "Delete device",
                        "Delete device configuration",
                        "Update device",
                        "Update device configuration"
                    ]
                }
            },
            "falsepositives": [
                "Device or device configuration being modified or deleted may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Device or device configuration modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "46530378-f9db-4af9-a9e5-889c177d3881",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/10/09",
            "references": [
                "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#core-directory"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485",
                "attack.t1565.001"
            ],
            "title": "Azure Device or Configuration Modified or Deleted"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/15",
            "description": "Detect a system being shutdown or put into different boot mode",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "shutdown",
                    "config-register 0x2100",
                    "config-register 0x2142"
                ]
            },
            "falsepositives": [
                "Legitimate administrators may run these commands, though rarely."
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "d94a35f0-7a29-45f6-90a0-80df6159967c",
            "level": "medium",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1495",
                "attack.t1529",
                "attack.t1565.001"
            ],
            "title": "Cisco Denial of Service"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/20",
            "description": "Detects events in which a history file gets deleted, e.g. the ~/bash_history to remove traces of malicious activity",
            "detection": {
                "condition": "all of selection*",
                "selection": {
                    "Image|endswith": [
                        "/rm",
                        "/unlink",
                        "/shred"
                    ]
                },
                "selection_history": [
                    {
                        "CommandLine|contains": [
                            "/.bash_history",
                            "/.zsh_history"
                        ]
                    },
                    {
                        "CommandLine|endswith": [
                            "_history",
                            ".history",
                            "zhistory"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "1182f3b3-e716-4efa-99ab-d2685d04360f",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://github.com/sleventyeleven/linuxprivchecker/",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1565.001"
            ],
            "title": "History File Deletion"
        },
        {
            "author": "@d4ns4n_ (Wuerth-Phoenix)",
            "date": "2023/05/30",
            "description": "Detects changes of sensitive and critical files. Monitors files that you don't expect to change without planning on Linux system.",
            "detection": {
                "condition": "1 of selection_img_* and selection_paths",
                "selection_img_1": {
                    "CommandLine|contains": ">",
                    "Image|endswith": [
                        "/cat",
                        "/echo",
                        "/grep",
                        "/head",
                        "/more",
                        "/tail"
                    ]
                },
                "selection_img_2": {
                    "Image|endswith": [
                        "/emacs",
                        "/nano",
                        "/sed",
                        "/vi",
                        "/vim"
                    ]
                },
                "selection_paths": {
                    "CommandLine|contains": [
                        "/bin/login",
                        "/bin/passwd",
                        "/boot/",
                        "/etc/*.conf",
                        "/etc/cron.",
                        "/etc/crontab",
                        "/etc/hosts",
                        "/etc/init.d",
                        "/etc/sudoers",
                        "/opt/bin/",
                        "/sbin",
                        "/usr/bin/",
                        "/usr/local/bin/"
                    ]
                }
            },
            "falsepositives": [
                "Some false positives are to be expected on user or administrator machines. Apply additional filters as needed."
            ],
            "id": "86157017-c2b1-4d4a-8c33-93b8e67e4af4",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://learn.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-overview#which-files-should-i-monitor"
            ],
            "status": "test",
            "title": "Potential Suspicious Change To Sensitive/Critical Files",
            "tags": [
                "attack.impact",
                "attack.t1565.001"
            ]
        },
        {
            "author": "Max Altgelt (Nextron Systems)",
            "date": "2021/09/10",
            "description": "Detects specific commands commonly used to remove or empty the syslog",
            "detection": {
                "condition": "selection and not falsepositives",
                "falsepositives": [
                    "/syslog."
                ],
                "selection": [
                    "rm /var/log/syslog",
                    "rm -r /var/log/syslog",
                    "rm -f /var/log/syslog",
                    "rm -rf /var/log/syslog",
                    "mv /var/log/syslog",
                    " >/var/log/syslog",
                    " > /var/log/syslog"
                ]
            },
            "falsepositives": [
                "Log rotation"
            ],
            "id": "e09eb557-96d2-4de9-ba2d-30f712a5afd3",
            "level": "high",
            "logsource": {
                "product": "linux"
            },
            "modified": "2022/11/26",
            "references": [
                "https://www.virustotal.com/gui/file/fc614fb4bda24ae8ca2c44e812d12c0fab6dd7a097472a35dd12ded053ab8474"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1565.001"
            ],
            "title": "Commands to Clear or Remove the Syslog - Builtin"
        }
    ]
}