{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--0eeae6f9-d60a-4d6a-8e4e-904be7137d80",
    "created": "2024-08-13T14:46:36.629264Z",
    "modified": "2024-08-13T14:46:36.629264Z",
    "name": "Using Malicious Files",
    "description": "An attack of this type exploits a system's configuration that allows an adversary to either directly access an executable file, for example through shell access; or in a possible worst case allows an adversary to upload a file and then execute it. Web servers, ftp servers, and message oriented middleware systems which have many integration points are particularly vulnerable, because both the programmers and the administrators must be in synch regarding the interfaces and the correct privileges for each interface.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/17.html",
            "external_id": "17"
        },
        {
            "source_name": "CWE",
            "external_id": "732"
        },
        {
            "source_name": "CWE",
            "external_id": "285"
        },
        {
            "source_name": "CWE",
            "external_id": "272"
        },
        {
            "source_name": "CWE",
            "external_id": "59"
        },
        {
            "source_name": "CWE",
            "external_id": "282"
        },
        {
            "source_name": "CWE",
            "external_id": "270"
        },
        {
            "source_name": "CWE",
            "external_id": "693"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Confidentiality"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Integrity"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Availability"
        },
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "Consider a directory on a web server with the following permissions\n               drwxrwxrwx 5 admin public 170 Nov 17 01:08 webroot\n               This could allow an attacker to both execute and upload and execute programs' on the web server. This one vulnerability can be exploited by a threat to probe the system and identify additional vulnerabilities to exploit."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Determine File/Directory Configuration] The adversary looks for misconfigured files or directories on a system that might give executable access to an overly broad group of users.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Through shell access to a system, use the command \"ls -l\" to view permissions for files and directories."
            ]
        },
        {
            "description": "[Upload Malicious Files] If the adversary discovers a directory that has executable permissions, they will attempt to upload a malicious file to execute.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Upload a malicious file through a misconfigured FTP server."
            ]
        },
        {
            "description": "[Execute Malicious File] The adversary either executes the uploaded malicious file, or executes an existing file that has been misconfigured to allow executable access to the adversary.",
            "phase": "Exploit",
            "step": "3",
            "techniques": []
        }
    ],
    "x_mitre_impact": "Very High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Design: Enforce principle of least privilege"
        },
        {
            "description": "Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands."
        },
        {
            "description": "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables."
        }
    ]
}