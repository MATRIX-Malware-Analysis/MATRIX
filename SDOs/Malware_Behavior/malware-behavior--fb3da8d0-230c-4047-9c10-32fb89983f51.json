{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--fb3da8d0-230c-4047-9c10-32fb89983f51",
    "created": "2024-08-13T14:46:37.090343Z",
    "modified": "2024-08-13T14:46:45.946771Z",
    "name": "Trusted Developer Utilities Proxy Execution: MSBuild",
    "description": "Adversaries may use MSBuild to proxy execution of code through a trusted Windows utility. MSBuild.exe (Microsoft Build Engine) is a software build platform used by Visual Studio. It handles XML formatted project files that define requirements for loading and building various platforms and configurations.[1]Adversaries can abuse MSBuild to proxy execution of malicious code. The inline task capability of MSBuild that was introduced in .NET version 4 allows for C# or Visual Basic code to be inserted into an XML project file.[1][2] MSBuild will compile and execute the inline task. MSBuild.exe is a signed Microsoft binary, so when it is used this way it can execute arbitrary code and bypass application control defenses that are configured to allow MSBuild.exe execution.[3]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1127/001",
            "external_id": "T1127/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Kiran kumar s, oscd.community",
            "date": "2020/10/11",
            "description": "Detects a possible remote connections to Silenttrinity c2",
            "detection": {
                "condition": "selection and filter",
                "filter": {
                    "DestinationPort": [
                        80,
                        443
                    ],
                    "Initiated": "true"
                },
                "selection": {
                    "Image|endswith": "\\msbuild.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "50e54b8d-ad73-43f8-96a1-5191685b17a4",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2022/10/05",
            "references": [
                "https://www.blackhillsinfosec.com/my-first-joyride-with-silenttrinity/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1127.001"
            ],
            "title": "Silenttrinity Stager Msbuild Activity"
        }
    ]
}