{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6ccaae5d-5431-4dbe-9bbb-66690e994806",
    "created": "2024-08-13T14:46:37.160747Z",
    "modified": "2024-08-13T14:46:37.288295Z",
    "name": "OS Credential Dumping: Proc Filesystem",
    "description": "Adversaries may gather credentials from the proc filesystem or /proc. The proc filesystem is a pseudo-filesystem used as an interface to kernel data structures for Linux based systems managing virtual memory. For each process, the /proc/<PID>/maps file shows how memory is mapped within the process\u2019s virtual address space. And /proc/<PID>/mem, exposed for debugging purposes, provides access to the process\u2019s virtual address space.[1][2]When executing with root privileges, adversaries can search these memory locations for all processes on a system that contain patterns indicative of credentials. Adversaries may use regex patterns, such as grep -E '^[0-9a-f-]* r' /proc/'$pid'/maps | cut -d' ' -f 1, to look for fixed strings in memory structures or cached hashes.[3] When running without privileged access, processes can still view their own virtual memory locations. Some services or programs may save credentials in clear text inside the process\u2019s memory.[4][5]If running as or with the permissions of a web browser, a process can search the /maps & /mem locations for common website credential patterns (that can also be used to find adjacent memory within the same structure) in which hashes or cleartext credentials may be located.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1003/007",
            "external_id": "T1003/007"
        }
    ]
}