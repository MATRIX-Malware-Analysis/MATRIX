{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--ef12e977-98b9-45dc-a911-c3dd04457888",
    "created": "2024-08-13T14:46:36.914058Z",
    "modified": "2024-08-13T14:46:44.955824Z",
    "name": "Scheduled Task/Job: Cron",
    "description": "Adversaries may abuse the cron utility to perform task scheduling for initial or recurring execution of malicious code.[1] The cron utility is a time-based job scheduler for Unix-like operating systems.  The  crontab file contains the schedule of cron entries to be run and the specified times for execution. Any crontab files are stored in operating system-specific file paths.An adversary may use cron in Linux or Unix environments to execute programs at system startup or on a scheduled basis for Persistence.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1053/003",
            "external_id": "T1053/003"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/11/22",
            "description": "Identifies when a Azure Kubernetes CronJob runs in Azure Cloud. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate.\nKubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs.\nAn Adversary may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName|endswith": [
                        "/CRONJOBS/WRITE",
                        "/JOBS/WRITE"
                    ],
                    "operationName|startswith": [
                        "MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/BATCH",
                        "MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/BATCH"
                    ]
                }
            },
            "falsepositives": [
                "Azure Kubernetes CronJob/Job may be done by a system administrator.",
                "If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "1c71e254-6655-42c1-b2d6-5e4718d7fc0a",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/12/18",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes",
                "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/",
                "https://kubernetes.io/docs/concepts/workloads/controllers/job/",
                "https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.003",
                "attack.privilege_escalation",
                "attack.execution"
            ],
            "title": "Azure Kubernetes CronJob"
        },
        {
            "author": "Alejandro Ortuno, oscd.community",
            "date": "2020/10/06",
            "description": "Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/tmp/",
                    "Image|endswith": "/crontab"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "7c3b43d8-d794-47d2-800a-d277715aa460",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1053.003"
            ],
            "title": "Scheduled Cron Task/Job - MacOs"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/05",
            "description": "Detects creation of sudoers file or files in \"sudoers.d\" directory which can be used a potential method to persiste privileges for a specific user.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|startswith": "/etc/sudoers.d/"
                }
            },
            "falsepositives": [
                "Creation of legitimate files in sudoers.d folder part of administrator work"
            ],
            "id": "ddb26b76-4447-4807-871f-1b035b2bfa5d",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "modified": "2022/12/31",
            "references": [
                "https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.003"
            ],
            "title": "Persistence Via Sudoers Files"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/05",
            "description": "Detects the creation of \"ebpfbackdoor\" files in both \"cron.d\" and \"sudoers.d\" directories. Which both are related to the TripleCross persistence method",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "ebpfbackdoor"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "1a2ea919-d11d-4d1e-8535-06cda13be20f",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "modified": "2022/12/31",
            "references": [
                "https://github.com/h3xduck/TripleCross/blob/12629558b8b0a27a5488a0b98f1ea7042e76f8ab/apps/deployer.sh"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.defense_evasion",
                "attack.t1053.003"
            ],
            "title": "Triple Cross eBPF Rootkit Default Persistence"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Detects creation of cron file or files in Cron directories which could indicates potential persistence.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "TargetFilename|startswith": [
                        "/etc/cron.d/",
                        "/etc/cron.daily/",
                        "/etc/cron.hourly/",
                        "/etc/cron.monthly/",
                        "/etc/cron.weekly/",
                        "/var/spool/cron/crontabs/"
                    ]
                },
                "selection2": {
                    "TargetFilename|contains": [
                        "/etc/cron.allow",
                        "/etc/cron.deny",
                        "/etc/crontab"
                    ]
                }
            },
            "falsepositives": [
                "Any legitimate cron file."
            ],
            "id": "6c4e2f43-d94d-4ead-b64d-97e53fa2bd05",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "modified": "2022/12/31",
            "references": [
                "https://github.com/microsoft/MSTIC-Sysmon/blob/f1477c0512b0747c1455283069c21faec758e29d/linux/configs/attack-based/persistence/T1053.003_Cron_Activity.xml"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.003"
            ],
            "title": "Persistence Via Cron Files"
        },
        {
            "author": "Alejandro Ortuno, oscd.community",
            "date": "2020/10/06",
            "description": "Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/tmp/",
                    "Image|endswith": "crontab"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "6b14bac8-3e3a-4324-8109-42f0546a347f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1053.003"
            ],
            "title": "Scheduled Cron Task/Job - Linux"
        },
        {
            "author": "Pawel Mazur",
            "date": "2022/04/16",
            "description": "Detects suspicious modification of crontab file.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "REPLACE"
                ]
            },
            "falsepositives": [
                "Legitimate modification of crontab"
            ],
            "id": "af202fd3-7bff-4212-a25a-fb34606cfcbe",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "cron"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md"
            ],
            "status": "test",
            "title": "Modifying Crontab",
            "tags": [
                "attack.persistence",
                "attack.t1053.003"
            ]
        }
    ]
}