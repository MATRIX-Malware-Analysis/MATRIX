{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6b4c96de-c013-4580-b86e-0a707fa622f4",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:46.304542Z",
    "name": "Unsecured Credentials: Bash History",
    "description": "Adversaries may search the bash command history on compromised systems for insecurely stored credentials. Bash keeps track of the commands users type on the command-line with the 'history' utility. Once a user logs out, the history is flushed to the user\u2019s .bash_history file. For each user, this file resides at the same location: ~/.bash_history. Typically, this file keeps track of the user\u2019s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Adversaries can abuse this by looking through the file for potential credentials. [1]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1552/003",
            "external_id": "T1552/003"
        },
        {
            "source_name": "CAPEC 639",
            "external_id": "malware-behavior--efd72166-96bf-49d1-b3c6-934f26b4f578"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Clark",
            "date": "2019/08/11",
            "description": "See what commands are being input into the device by other people, full credentials can be in the history",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "show history",
                    "show history all",
                    "show logging"
                ]
            },
            "falsepositives": [
                "Not commonly run by administrators, especially if remote logging is configured"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "b094d9fb-b1ad-4650-9f1a-fb7be9f1d34b",
            "level": "medium",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.003"
            ],
            "title": "Cisco Show Commands Input"
        },
        {
            "author": "Mikhail Larin, oscd.community",
            "date": "2020/10/17",
            "description": "Detects commandline operations on shell history files",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        ".bash_history",
                        ".zsh_history",
                        ".zhistory",
                        ".history",
                        ".sh_history",
                        "fish_history"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative activity",
                "Legitimate software, cleaning hist file"
            ],
            "id": "508a9374-ad52-4789-b568-fc358def2c65",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "level": "medium",
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.003"
            ],
            "title": "Suspicious History File Operations"
        },
        {
            "author": "Mikhail Larin, oscd.community",
            "date": "2020/10/17",
            "description": "Detects commandline operations on shell history files",
            "detection": {
                "condition": "execve and history",
                "execve": {
                    "type": "EXECVE"
                },
                "history": [
                    ".bash_history",
                    ".zsh_history",
                    ".zhistory",
                    ".history",
                    ".sh_history",
                    "fish_history"
                ]
            },
            "falsepositives": [
                "Legitimate administrative activity",
                "Legitimate software, cleaning hist file"
            ],
            "fields": [
                "a0",
                "a1",
                "a2",
                "a3",
                "key"
            ],
            "id": "eae8ce9f-bde9-47a6-8e79-f20d18419910",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md"
            ],
            "modified": "2022/11/28",
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.003"
            ],
            "title": "Suspicious History File Operations - Linux"
        }
    ]
}