{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6b064593-b3ed-428a-bf12-1423018331bd",
    "created": "2024-08-13T14:46:36.628103Z",
    "modified": "2024-08-13T14:46:36.628103Z",
    "name": "Redirect Access to Libraries",
    "description": "An adversary exploits a weakness in the way an application searches for external libraries to manipulate the execution flow to point to an adversary supplied library or code base. This pattern of attack allows the adversary to compromise the application or server via the execution of unauthorized code. An application typically makes calls to functions that are a part of libraries external to the application. These libraries may be part of the operating system or they may be third party libraries. If an adversary can redirect an application's attempts to access these libraries to other libraries that the adversary supplies, the adversary will be able to force the targeted application to execute arbitrary code. This is especially dangerous if the targeted application has enhanced privileges. Access can be redirected through a number of techniques, including the use of symbolic links, search path modification, and relative path manipulation.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/159.html",
            "external_id": "159"
        },
        {
            "source_name": "CWE",
            "external_id": "706"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Authorization"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Access Control"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Authorization"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "In this example, the attacker using ELF infection that redirects the Procedure Linkage Table (PLT) of an executable allowing redirection to be resident outside of the infected executable. The algorithm at the entry point code is as follows... \u2022 mark the text segment writeable \u2022 save the PLT(GOT) entry \u2022 replace the PLT(GOT) entry with the address of the new lib call The algorithm in the new library call is as follows... \u2022 do the payload of the new lib call \u2022 restore the original PLT(GOT) entry \u2022 call the lib call \u2022 save the PLT(GOT) entry again (if its changed) \u2022 replace the PLT(GOT) entry with the address of the new lib call"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Identify Target] The adversary identifies the target application and determines what libraries are being used.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Find public source code and identify library dependencies.",
                "Gain access to the system hosting the application and look for libraries in common locations."
            ]
        },
        {
            "description": "[Deploy Malicious Libraries] The adversary crafts malicious libraries and deploys them on the system where the application is running, or in a remote location that can be loaded by the application.",
            "phase": "Experiment",
            "step": "2",
            "techniques": []
        },
        {
            "description": "[Redirect Library Calls to Malicious Library] Once the malicious library crafted by the adversary is deployed, the adversary will manipulate the flow of the application such that it calls the malicious library. This can be done in a variety of ways based on how the application is loading and calling libraries.",
            "phase": "Exploit",
            "step": "3",
            "techniques": [
                "Poison the DNS cache of the system so that it loads a malicious library from a remote location hosted by the adversary instead of the legitimate location",
                "Create a symlink that tricks the application into thinking that a malicious library is the legitimate library.",
                "Use DLL side-loading to place a malicious verison of a DLL in the windows directory."
            ]
        }
    ],
    "x_mitre_impact": "Very High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Implementation: Restrict the permission to modify the entries in the configuration file."
        },
        {
            "description": "Implementation: Check the integrity of the dynamically linked libraries before use them."
        },
        {
            "description": "Implementation: Use obfuscation and other techniques to prevent reverse engineering the libraries."
        }
    ]
}