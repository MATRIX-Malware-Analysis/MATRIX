{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--e8c31590-424a-49a2-ba36-408f24c9ded1",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.349938Z",
    "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
    "description": "Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the 'run keys' in the Registry or startup folder will cause the program referenced to be executed when a user logs in.[1] These programs will be executed under the context of the user and will have the account's associated permissions level.The following run keys are created by default on Windows systems:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceRun keys may exist under multiple hives.[2][3] The HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.[1] For example, it is possible to load a DLL at logon using a 'Depend' key with RunOnceEx: reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d 'C:\\temp\\evil[.]dll' [4]Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is C:\\Users\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup. The startup folder path for all users is C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp.The following Registry keys can be used to set startup folder items for persistence:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell FoldersHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell FoldersHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell FoldersHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell FoldersThe following Registry keys can control automatic startup of services during boot:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnceHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnceHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\RunHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\RunPrograms listed in the load value of the registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows run automatically for the currently logged-on user.By default, the multistring BootExecute value of the registry key HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use Masquerading to make the Registry entries look as if they are associated with legitimate programs.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1547/001",
            "external_id": "T1547/001"
        },
        {
            "source_name": "CAPEC 270",
            "external_id": "malware-behavior--1e90609e-7477-49ff-9a87-b76b90c2260c"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "number": "0x07 = CSIDL_STARTUP"
                                    },
                                    {
                                        "number": "0x18 = CSIDL_COMMON_STARTUP"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "api": "shell32.SHGetFolderPath"
                                    },
                                    {
                                        "api": "shell32.SHGetFolderLocation"
                                    },
                                    {
                                        "api": "shell32.SHGetSpecialFolderPath"
                                    },
                                    {
                                        "api": "shell32.SHGetSpecialFolderLocation"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]"
                    ],
                    "authors": [
                        "matthew.williams@mandiant.com"
                    ],
                    "examples": [
                        "07F7846BBCDA782E5639292AD93907EB:0x40121A"
                    ],
                    "name": "get startup folder",
                    "namespace": "persistence/startup-folder",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "get startup folder"
                            },
                            {
                                "or": [
                                    {
                                        "match": "copy file"
                                    },
                                    {
                                        "match": "move file"
                                    },
                                    {
                                        "match": "host-interaction/file-system/write"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]"
                    ],
                    "authors": [
                        "matthew.williams@mandiant.com"
                    ],
                    "examples": [
                        "07F7846BBCDA782E5639292AD93907EB:0x401040"
                    ],
                    "name": "write file to startup folder",
                    "namespace": "persistence/startup-folder",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "match": "set registry value"
                                    },
                                    {
                                        "number": "0x80000001 = HKEY_CURRENT_USER"
                                    },
                                    {
                                        "number": "0x80000002 = HKEY_LOCAL_MACHINE"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "string": "/Software\\\\Microsoft\\\\Windows\\\\CurrentVersion/i"
                                            },
                                            {
                                                "or": [
                                                    {
                                                        "string": "/Run/i"
                                                    },
                                                    {
                                                        "string": "/Explorer\\\\Shell Folders/i"
                                                    },
                                                    {
                                                        "string": "/User Shell Folders/i"
                                                    },
                                                    {
                                                        "string": "/RunServices/i"
                                                    },
                                                    {
                                                        "string": "/Policies\\\\Explorer\\\\Run/i"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "string": "/Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\load/i"
                                    },
                                    {
                                        "string": "/System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\BootExecute/i"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com"
                    ],
                    "examples": [
                        "Practical Malware Analysis Lab 06-03.exe_:0x401130",
                        "b87e9dd18a5533a09d3e48a7a1efbcf6:0x1400070E0",
                        "9ff8e68343cc29c1036650fc153e69f7:0x470624"
                    ],
                    "mbc": [
                        "Persistence::Registry Run Keys / Startup Folder [F0012]"
                    ],
                    "name": "persist via Run registry key",
                    "namespace": "persistence/registry/run",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "string": "/Start Menu\\\\Programs\\\\Startup/i"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]"
                    ],
                    "authors": [
                        "matthew.williams@mandiant.com"
                    ],
                    "name": "reference startup folder",
                    "namespace": "persistence/startup-folder",
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/10",
            "description": "Detects when a file with a suspicious extension is created in the startup folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "\\Windows\\Start Menu\\Programs\\Startup\\",
                    "TargetFilename|endswith": [
                        ".vbs",
                        ".vbe",
                        ".bat",
                        ".ps1",
                        ".hta",
                        ".dll",
                        ".jar",
                        ".msi",
                        ".scr",
                        ".cmd"
                    ]
                }
            },
            "falsepositives": [
                "Rare legitimate usage of some of the extensions mentioned in the rule"
            ],
            "id": "28208707-fe31-437f-9a7f-4b1108b94d2e",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/01/06",
            "references": [
                "https://github.com/last-byte/PersistenceSniper"
            ],
            "related": [
                {
                    "id": "2aa0a6b4-a865-495b-ab51-c28249537b75",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Suspicious Startup Folder Persistence"
        },
        {
            "id": "2aa0a6b4-a865-495b-ab51-c28249537b75",
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "A General detection for files being created in the Windows startup directory. This could be an indicator of persistence.",
            "detection": {
                "condition": "selection and not filter_update",
                "filter_update": [
                    {
                        "Image": "C:\\Windows\\System32\\wuauclt.exe"
                    },
                    {
                        "TargetFilename|startswith": "C:\\$WINDOWS.~BT\\NewOS\\"
                    }
                ],
                "selection": {
                    "TargetFilename|contains": "\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp"
                }
            },
            "falsepositives": [
                "FP could be caused by legitimate application writing shortcuts for example. This folder should always be inspected to make sure that all the files in there are legitimate"
            ],
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/10/07",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/12",
                "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/5.B.1_611FCA99-97D0-4873-9E51-1C1BA2DBB40D.md"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "28208707-fe31-437f-9a7f-4b1108b94d2e"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Startup Folder File Write"
        },
        {
            "author": "Christopher Peacock '@securepeacock', SCYTHE",
            "date": "2021/10/24",
            "description": "Detects PowerShell writing startup shortcuts.\nThis procedure was highlighted in Red Canary Intel Insights Oct. 2021, \"We frequently observe adversaries using PowerShell to write malicious .lnk files into the startup directory to establish persistence.\nAccordingly, this detection opportunity is likely to identify persistence mechanisms in multiple threats.\nIn the context of Yellow Cockatoo, this persistence mechanism eventually launches the command-line script that leads to the installation of a malicious DLL\"\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ],
                    "TargetFilename|contains": "\\start menu\\programs\\startup\\",
                    "TargetFilename|endswith": ".lnk"
                }
            },
            "falsepositives": [
                "Depending on your environment accepted applications may leverage this at times. It is recommended to search for anomalies inidicative of malware."
            ],
            "id": "92fa78e7-4d39-45f1-91a3-8b23f3f1088d",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/02/23",
            "references": [
                "https://redcanary.com/blog/intelligence-insights-october-2021/",
                "https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder"
            ],
            "status": "test",
            "title": "Potential Startup Shortcut Persistence Via PowerShell.EXE",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Vadim Varganov, Florian Roth (Nextron Systems)",
            "date": "2022/08/24",
            "description": "Detects msdt.exe creating files in suspicious directories which could be a sign of exploitation of either Follina or Dogwalk vulnerabilities",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\msdt.exe",
                    "TargetFilename|contains": [
                        "\\Desktop\\",
                        "\\Start Menu\\Programs\\Startup\\",
                        "C:\\PerfLogs\\",
                        "C:\\ProgramData\\",
                        "C:\\Users\\Public\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "318557a5-150c-4c8d-b70e-a9910e199857",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/02/23",
            "references": [
                "https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd",
                "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001",
                "cve.2022.30190"
            ],
            "title": "File Creation In Suspicious Directory By Msdt.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/06/28",
            "description": "Detects suspicious command line reg.exe tool adding key to RUN key in Registry",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "reg",
                        " ADD ",
                        "Software\\Microsoft\\Windows\\CurrentVersion\\Run"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.",
                "Legitimate administrator sets up autorun keys for legitimate reasons.",
                "Discord"
            ],
            "id": "de587dce-915e-4218-aac4-835ca6af6f70",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/30",
            "references": [
                "https://app.any.run/tasks/9c0f37bc-867a-4314-b685-e101566766d7/",
                "https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys"
            ],
            "status": "test",
            "title": "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Janantha Marasinghe",
            "date": "2022/11/18",
            "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
            "detection": {
                "condition": "selection_img and (1 of selection_flags_*)",
                "selection_flags_configure": {
                    "CommandLine|contains|all": [
                        "/configure",
                        "/db"
                    ]
                },
                "selection_flags_discovery": {
                    "CommandLine|contains|all": [
                        "/export",
                        "/cfg"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\secedit.exe"
                    },
                    {
                        "OriginalFileName": "SeCEdit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative use"
            ],
            "id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.privilege_escalation",
                "attack.t1562.002",
                "attack.t1547.001",
                "attack.t1505.005",
                "attack.t1556.002",
                "attack.t1562",
                "attack.t1574.007",
                "attack.t1564.002",
                "attack.t1546.008",
                "attack.t1546.007",
                "attack.t1547.014",
                "attack.t1547.010",
                "attack.t1547.002",
                "attack.t1557",
                "attack.t1082"
            ],
            "title": "Potential Suspicious Activity Using SeCEdit"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, oscd.community",
            "date": "2019/10/25",
            "description": "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.",
            "detection": {
                "condition": "all of selection_*",
                "selection_1": {
                    "CommandLine|contains": "add",
                    "Image|endswith": "\\reg.exe"
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "\\software\\Microsoft\\Windows\\CurrentVersion\\Run",
                        "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit",
                        "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell",
                        "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                        "\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                        "\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.",
                "Legitimate administrator sets up autorun keys for legitimate reasons.",
                "Discord"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "24357373-078f-44ed-9ac4-6d334a668a11",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/08/04",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Direct Autorun Keys Modification"
        },
        {
            "author": "Dmitriy Lifanov, oscd.community",
            "date": "2019/10/25",
            "description": "Detects abusing Windows 10 Narrator's Feedback-Hub",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "EventType": "DeleteValue",
                    "TargetObject|endswith": "\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute"
                },
                "selection2": {
                    "TargetObject|endswith": "\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\(Default)"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f663a6d9-9d1b-49b8-b2b1-0637914d199a",
            "level": "high",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2022/03/26",
            "references": [
                "https://giuliocomi.blogspot.com/2019/10/abusing-windows-10-narrators-feedback.html"
            ],
            "status": "test",
            "title": "Narrator's Feedback-Hub Persistence",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/10/01",
            "description": "Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|contains": [
                        "\\Downloads\\",
                        "\\Temporary Internet Files\\Content.Outlook\\",
                        "\\Local Settings\\Temporary Internet Files\\"
                    ],
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\"
                }
            },
            "falsepositives": [
                "Software installers downloaded and used by users"
            ],
            "id": "9c5037d1-c568-49b3-88c7-9846a5bdc2be",
            "level": "high",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://app.any.run/tasks/c5bef5b7-f484-4c43-9cf3-d5c5c7839def/"
            ],
            "status": "test",
            "title": "Suspicious Run Key from Download",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "ie and ie_details and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_extensions": {
                    "TargetObject|contains": [
                        "\\Extensions\\{2670000A-7350-4f3c-8081-5663EE0C6C49}",
                        "\\Extensions\\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}",
                        "\\Extensions\\{789FE86F-6FC4-46A1-9849-EDE0DB0C95CA}",
                        "\\Extensions\\{A95fe080-8f5d-11d2-a20b-00aa003c157a}"
                    ]
                },
                "filter_toolbar": {
                    "TargetObject|endswith": [
                        "\\Toolbar\\ShellBrowser\\ITBar7Layout",
                        "\\Toolbar\\ShowDiscussionButton",
                        "\\Toolbar\\Locked"
                    ]
                },
                "ie": {
                    "TargetObject|contains": [
                        "\\Software\\Wow6432Node\\Microsoft\\Internet Explorer",
                        "\\Software\\Microsoft\\Internet Explorer"
                    ]
                },
                "ie_details": {
                    "TargetObject|contains": [
                        "\\Toolbar",
                        "\\Extensions",
                        "\\Explorer Bars"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "a80f662f-022f-4429-9b8c-b1a41aaa6688",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Internet Explorer Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "all of system_control_* and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_cutepdf": {
                    "Details": [
                        "cpwmon64_v40.dll",
                        "CutePDF Writer"
                    ],
                    "Image": "C:\\Windows\\System32\\spoolsv.exe",
                    "TargetObject|contains": "\\Print\\Monitors\\CutePDF Writer Monitor"
                },
                "filter_onenote": {
                    "Image": "C:\\Windows\\System32\\spoolsv.exe",
                    "TargetObject|contains": "Print\\Monitors\\Appmon\\Ports\\Microsoft.Office.OneNote_",
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "filter_poqexec": {
                    "Image": "C:\\Windows\\System32\\poqexec.exe",
                    "TargetObject|endswith": "\\NetworkProvider\\Order\\ProviderOrder"
                },
                "filter_realvnc": {
                    "Details": "VNCpm.dll",
                    "Image": "C:\\Windows\\System32\\spoolsv.exe",
                    "TargetObject|endswith": "\\Print\\Monitors\\MONVNC\\Driver"
                },
                "system_control_base": {
                    "TargetObject|contains": "\\SYSTEM\\CurrentControlSet\\Control"
                },
                "system_control_keys": {
                    "TargetObject|contains": [
                        "\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram",
                        "\\Terminal Server\\Wds\\rdpwd\\StartupPrograms",
                        "\\SecurityProviders\\SecurityProviders",
                        "\\SafeBoot\\AlternateShell",
                        "\\Print\\Providers",
                        "\\Print\\Monitors",
                        "\\NetworkProvider\\Order",
                        "\\Lsa\\Notification Packages",
                        "\\Lsa\\Authentication Packages",
                        "\\BootVerificationProgram\\ImagePath"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "f674e36a-4b91-431e-8aef-f8a96c2aca35",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "CurrentControlSet Autorun Keys Modification"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/03/05",
            "description": "Detects VBScript content stored into registry keys as seen being used by UNC2452 group",
            "detection": {
                "condition": "selection and not 1 of filter*",
                "filter": {
                    "TargetObject|contains": "Software\\Microsoft\\Windows\\CurrentVersion\\Run"
                },
                "filter_dotnet": {
                    "Details|contains": [
                        "\\Microsoft.NET\\Primary Interop Assemblies\\Microsoft.mshtml.dll",
                        "<\\Microsoft.mshtml,fileVersion=",
                        "_mshtml_dll_",
                        "<\\Microsoft.mshtml,culture="
                    ],
                    "Image|endswith": "\\msiexec.exe",
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\"
                },
                "selection": {
                    "Details|contains": [
                        "vbscript:",
                        "jscript:",
                        "mshtml,",
                        "RunHTMLApplication",
                        "Execute(",
                        "CreateObject",
                        "window.close"
                    ],
                    "TargetObject|contains": "Software\\Microsoft\\Windows\\CurrentVersion"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "46490193-1b22-4c29-bdd6-5bf63907216f",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/"
            ],
            "modified": "2023/08/17",
            "status": "test",
            "title": "VBScript Payload Stored in Registry",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "frack113, Florian Roth (Nextron Systems)",
            "date": "2022/03/17",
            "description": "Detects potential PowerShell commands or code within registry run keys",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|contains": [
                        "powershell",
                        "pwsh ",
                        "FromBase64String",
                        ".DownloadFile(",
                        ".DownloadString(",
                        " -w hidden ",
                        " -w 1 ",
                        "-windowstyle hidden",
                        "-window hidden",
                        " -nop ",
                        " -encodedcommand ",
                        "-ExecutionPolicy Bypass",
                        "Invoke-Expression",
                        "IEX (",
                        "Invoke-Command",
                        "ICM -",
                        "Invoke-WebRequest",
                        "IWR ",
                        " -noni ",
                        " -noninteractive "
                    ],
                    "TargetObject|contains": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
                }
            },
            "falsepositives": [
                "Legitimate admin or third party scripts. Baseline according to your environment"
            ],
            "id": "8d85cf08-bf97-4260-ba49-986a2a65129c",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://github.com/frack113/atomic-red-team/blob/a9051c38de8a5320b31c7039efcbd3b56cf2d65a/atomics/T1547.001/T1547.001.md#atomic-test-9---systembc-malware-as-a-service-registry",
                "https://www.trendmicro.com/en_us/research/22/j/lv-ransomware-exploits-proxyshell-in-attack.html"
            ],
            "modified": "2023/08/17",
            "status": "test",
            "title": "Suspicious Powershell In Registry Run Keys",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "office and office_details and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_avg": {
                    "Image": "C:\\Program Files\\AVG\\Antivirus\\RegSvr.exe",
                    "TargetObject|contains": "\\Microsoft\\Office\\Outlook\\Addins\\Antivirus.AsOutExt\\"
                },
                "filter_known_addins": {
                    "Image|startswith": [
                        "C:\\Program Files\\Microsoft Office\\",
                        "C:\\Program Files (x86)\\Microsoft Office\\",
                        "C:\\Windows\\System32\\msiexec.exe",
                        "C:\\Windows\\System32\\regsvr32.exe"
                    ],
                    "TargetObject|contains": [
                        "\\Excel\\Addins\\AdHocReportingExcelClientLib.AdHocReportingExcelClientAddIn.1\\",
                        "\\Excel\\Addins\\ExcelPlugInShell.PowerMapConnect\\",
                        "\\Excel\\Addins\\NativeShim\\",
                        "\\Excel\\Addins\\NativeShim.InquireConnector.1\\",
                        "\\Excel\\Addins\\PowerPivotExcelClientAddIn.NativeEntry.1\\",
                        "\\Outlook\\AddIns\\AccessAddin.DC\\",
                        "\\Outlook\\AddIns\\ColleagueImport.ColleagueImportAddin\\",
                        "\\Outlook\\AddIns\\EvernoteCC.EvernoteContactConnector\\",
                        "\\Outlook\\AddIns\\EvernoteOLRD.Connect\\",
                        "\\Outlook\\Addins\\Microsoft.VbaAddinForOutlook.1\\",
                        "\\Outlook\\Addins\\OcOffice.OcForms\\",
                        "\\Outlook\\Addins\\\\OneNote.OutlookAddin",
                        "\\Outlook\\Addins\\OscAddin.Connect\\",
                        "\\Outlook\\Addins\\OutlookChangeNotifier.Connect\\",
                        "\\Outlook\\Addins\\UCAddin.LyncAddin.1",
                        "\\Outlook\\Addins\\UCAddin.UCAddin.1",
                        "\\Outlook\\Addins\\UmOutlookAddin.FormRegionAddin\\"
                    ]
                },
                "filter_officeclicktorun": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                },
                "office": {
                    "TargetObject|contains": [
                        "\\Software\\Wow6432Node\\Microsoft\\Office",
                        "\\Software\\Microsoft\\Office"
                    ]
                },
                "office_details": {
                    "TargetObject|contains": [
                        "\\Word\\Addins",
                        "\\PowerPoint\\Addins",
                        "\\Outlook\\Addins",
                        "\\Onenote\\Addins",
                        "\\Excel\\Addins",
                        "\\Access\\Addins",
                        "test\\Special\\Perf"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "baecf8fb-edbf-429f-9ade-31fc3f22b970",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Office Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_drivers": {
                    "Image": "C:\\Windows\\System32\\drvinst.exe"
                },
                "filter_msoffice": {
                    "Details": "{807583E5-5146-11D5-A672-00B0D022E945}"
                },
                "filter_svchost": {
                    "Image": "C:\\Windows\\System32\\svchost.exe",
                    "TargetObject|contains": "\\lnkfile\\shellex\\ContextMenuHandlers\\"
                },
                "selection_classes_base": {
                    "TargetObject|contains": "\\Software\\Classes"
                },
                "selection_classes_target": {
                    "TargetObject|contains": [
                        "\\Folder\\ShellEx\\ExtShellFolderViews",
                        "\\Folder\\ShellEx\\DragDropHandlers",
                        "\\Folder\\Shellex\\ColumnHandlers",
                        "\\Filter",
                        "\\Exefile\\Shell\\Open\\Command\\(Default)",
                        "\\Directory\\Shellex\\DragDropHandlers",
                        "\\Directory\\Shellex\\CopyHookHandlers",
                        "\\CLSID\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\Instance",
                        "\\CLSID\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\Instance",
                        "\\CLSID\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\Instance",
                        "\\CLSID\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\Instance",
                        "\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers",
                        "\\.exe",
                        "\\.cmd",
                        "\\ShellEx\\PropertySheetHandlers",
                        "\\ShellEx\\ContextMenuHandlers"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "9df5f547-c86a-433e-b533-f2794357e242",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Classes Autorun Keys Modification"
        },
        {
            "author": "Florian Roth (Nextron Systems), Markus Neis, Sander Wiebing",
            "date": "2018/08/25",
            "description": "Detects suspicious new RUN key element pointing to an executable in a suspicious folder",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_*",
                "filter_main_windows_update": {
                    "Details|contains": [
                        "\\AppData\\Local\\Temp\\",
                        "C:\\Windows\\Temp\\"
                    ],
                    "Details|contains|all": [
                        "rundll32.exe ",
                        "C:\\WINDOWS\\system32\\advpack.dll,DelNodeRunDLL32"
                    ],
                    "Image|startswith": "C:\\Windows\\SoftwareDistribution\\Download\\",
                    "TargetObject|contains": "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\"
                },
                "selection_details": [
                    {
                        "Details|contains": [
                            ":\\$Recycle.bin\\",
                            ":\\Temp\\",
                            ":\\Users\\Default\\",
                            ":\\Users\\Desktop\\",
                            ":\\Users\\Public\\",
                            ":\\Windows\\Temp\\",
                            "\\AppData\\Local\\Temp\\",
                            "%temp%\\",
                            "%tmp%\\"
                        ]
                    },
                    {
                        "Details|startswith": [
                            "%Public%\\",
                            "wscript",
                            "cscript"
                        ]
                    }
                ],
                "selection_target": {
                    "TargetObject|contains": [
                        "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\",
                        "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\"
                    ]
                }
            },
            "falsepositives": [
                "Software using weird folders for updates"
            ],
            "id": "02ee49e2-e294-4d0f-9278-f5b3212fc588",
            "level": "high",
            "modified": "2024/07/16",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html"
            ],
            "status": "experimental",
            "title": "New RUN Key Pointing to Suspicious Folder",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "session_manager_base and session_manager and not filter",
                "filter": {
                    "Details": "(Empty)"
                },
                "session_manager": {
                    "TargetObject|contains": [
                        "\\SetupExecute",
                        "\\S0InitialCommand",
                        "\\KnownDlls",
                        "\\Execute",
                        "\\BootExecute",
                        "\\AppCertDlls"
                    ]
                },
                "session_manager_base": {
                    "TargetObject|contains": "\\System\\CurrentControlSet\\Control\\Session Manager"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "046218bd-e0d8-4113-a3c3-895a12b2b298",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001",
                "attack.t1546.009"
            ],
            "title": "Session Manager Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "all of current_version_* and not 1 of filter_*",
                "current_version_base": {
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion"
                },
                "current_version_keys": {
                    "TargetObject|contains": [
                        "\\ShellServiceObjectDelayLoad",
                        "\\Run\\",
                        "\\RunOnce\\",
                        "\\RunOnceEx\\",
                        "\\RunServices\\",
                        "\\RunServicesOnce\\",
                        "\\Policies\\System\\Shell",
                        "\\Policies\\Explorer\\Run",
                        "\\Group Policy\\Scripts\\Startup",
                        "\\Group Policy\\Scripts\\Shutdown",
                        "\\Group Policy\\Scripts\\Logon",
                        "\\Group Policy\\Scripts\\Logoff",
                        "\\Explorer\\ShellServiceObjects",
                        "\\Explorer\\ShellIconOverlayIdentifiers",
                        "\\Explorer\\ShellExecuteHooks",
                        "\\Explorer\\SharedTaskScheduler",
                        "\\Explorer\\Browser Helper Objects",
                        "\\Authentication\\PLAP Providers",
                        "\\Authentication\\Credential Providers",
                        "\\Authentication\\Credential Provider Filters"
                    ]
                },
                "filter_AVG": {
                    "Details": [
                        "\"C:\\Program Files\\AVG\\Antivirus\\AvLaunch.exe\" /gui",
                        "\"C:\\Program Files (x86)\\AVG\\Antivirus\\AvLaunch.exe\" /gui",
                        "{472083B0-C522-11CF-8763-00608CC02F24}"
                    ],
                    "Image|startswith": "C:\\Program Files\\AVG\\Antivirus\\Setup\\"
                },
                "filter_all": [
                    {
                        "Details": "(Empty)"
                    },
                    {
                        "TargetObject|endswith": "\\NgcFirst\\ConsecutiveSwitchCount"
                    },
                    {
                        "Image|endswith": [
                            "\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe",
                            "\\AppData\\Roaming\\Spotify\\Spotify.exe",
                            "\\AppData\\Local\\WebEx\\WebexHost.exe"
                        ]
                    },
                    {
                        "Image": [
                            "C:\\WINDOWS\\system32\\devicecensus.exe",
                            "C:\\Windows\\system32\\winsat.exe",
                            "C:\\Program Files\\Microsoft OneDrive\\StandaloneUpdater\\OneDriveSetup.exe",
                            "C:\\Program Files\\Microsoft OneDrive\\Update\\OneDriveSetup.exe",
                            "C:\\Program Files (x86)\\Microsoft OneDrive\\Update\\OneDriveSetup.exe",
                            "C:\\Program Files\\KeePass Password Safe 2\\ShInstUtil.exe",
                            "C:\\Program Files\\Everything\\Everything.exe",
                            "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                        ]
                    }
                ],
                "filter_officeclicktorun": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                },
                "filter_aurora_dashboard": {
                    "Details": "C:\\Program Files\\Aurora-Agent\\tools\\aurora-dashboard.exe",
                    "Image|endswith": [
                        "\\aurora-agent-64.exe",
                        "\\aurora-agent.exe"
                    ],
                    "TargetObject|endswith": "\\Microsoft\\Windows\\CurrentVersion\\Run\\aurora-dashboard"
                },
                "filter_ctfmon": {
                    "Details": "ctfmon.exe /n",
                    "Image": "C:\\Windows\\system32\\userinit.exe"
                },
                "filter_defender": {
                    "Image": "C:\\Program Files\\Windows Defender\\MsMpEng.exe"
                },
                "filter_dropbox": {
                    "Details|endswith": "A251-47B7-93E1-CDD82E34AF8B}",
                    "Image": "C:\\Windows\\system32\\regsvr32.exe",
                    "TargetObject|contains": "DropboxExt"
                },
                "filter_edge": {
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\Install\\",
                        "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\",
                        "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"
                    ]
                },
                "filter_everything": {
                    "Details|endswith": "\\Everything\\Everything.exe\" -startup",
                    "TargetObject|endswith": "\\Microsoft\\Windows\\CurrentVersion\\Run\\Everything"
                },
                "filter_googledrive1": {
                    "Details|contains": "\\GoogleDriveFS.exe",
                    "Details|startswith": "C:\\Program Files\\Google\\Drive File Stream\\",
                    "TargetObject|endswith": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleDriveFS"
                },
                "filter_googledrive2": {
                    "Details": [
                        "{CFE8B367-77A7-41D7-9C90-75D16D7DC6B6}",
                        "{A8E52322-8734-481D-A7E2-27B309EF8D56}",
                        "{C973DA94-CBDF-4E77-81D1-E5B794FBD146}",
                        "{51EF1569-67EE-4AD6-9646-E726C3FFC8A2}"
                    ],
                    "TargetObject|contains": "GoogleDrive"
                },
                "filter_greenshot": {
                    "Details": "C:\\Program Files\\Greenshot\\Greenshot.exe",
                    "TargetObject|endswith": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Greenshot"
                },
                "filter_itunes": {
                    "Details": "\"C:\\Program Files\\iTunes\\iTunesHelper.exe\"",
                    "TargetObject|endswith": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\iTunesHelper"
                },
                "filter_logonui": {
                    "Image": "C:\\Windows\\system32\\LogonUI.exe",
                    "TargetObject|contains": [
                        "\\Authentication\\Credential Providers\\{D6886603-9D2F-4EB2-B667-1971041FA96B}\\",
                        "\\Authentication\\Credential Providers\\{BEC09223-B018-416D-A0AC-523971B639F5}\\",
                        "\\Authentication\\Credential Providers\\{8AF662BF-65A0-4D0A-A540-A338A999D36F}\\",
                        "\\Authentication\\Credential Providers\\{27FBDB57-B613-4AF2-9D7E-4FA7A66C21AD}\\"
                    ]
                },
                "filter_onedrive": {
                    "Details|contains": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                    "Details|startswith": [
                        "C:\\Windows\\system32\\cmd.exe /q /c rmdir /s /q \"C:\\Users\\",
                        "C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\"
                    ]
                },
                "filter_opera": {
                    "Details": "C:\\Program Files\\Opera\\assistant\\browser_assistant.exe",
                    "TargetObject|endswith": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Opera Browser Assistant"
                },
                "filter_python": {
                    "Details|contains|all": [
                        "\\AppData\\Local\\Package Cache\\{",
                        "}\\python-"
                    ],
                    "Details|endswith": ".exe\" /burn.runonce",
                    "TargetObject|contains": "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{"
                },
                "filter_teams": {
                    "Details|contains": "\\Microsoft\\Teams\\Update.exe --processStart ",
                    "Image|endswith": "\\Microsoft\\Teams\\current\\Teams.exe"
                },
                "filter_zoom": {
                    "Details": "\"C:\\Program Files\\Zoom\\bin\\installer.exe\" /repair",
                    "TargetObject|endswith": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\zoommsirepair"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "id": "20f0ee37-5942-4e45-b7d5-c5b5db9df5cd",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d",
                "https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/"
            ],
            "modified": "2023/08/17",
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "CurrentVersion Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "scripts_base and scripts and not filter",
                "filter": {
                    "Details": "(Empty)"
                },
                "scripts": {
                    "TargetObject|contains": [
                        "\\Startup",
                        "\\Shutdown",
                        "\\Logon",
                        "\\Logoff"
                    ]
                },
                "scripts_base": {
                    "TargetObject|contains": "\\Software\\Policies\\Microsoft\\Windows\\System\\Scripts"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "e7a2fd40-3ae1-4a85-bf80-15cf624fb1b1",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "System Scripts Autorun Keys Modification"
        },
        {
            "author": "frack113",
            "date": "2022/10/01",
            "description": "Detect modification of the startup key to a path where a payload could be stored to be launched during startup",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                    "TargetObject|endswith": "Startup"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9c226817-8dc9-46c2-a58d-66655aafd7dc",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1547.001/T1547.001.md"
            ],
            "modified": "2023/08/17",
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1547.001"
            ],
            "title": "Modify User Shell Folders Startup Value"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "wow_nt_current_version_base and wow_nt_current_version and not filter",
                "filter": {
                    "Details": [
                        "(Empty)",
                        "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options"
                    ]
                },
                "wow_nt_current_version": {
                    "TargetObject|contains": [
                        "\\Windows\\Appinit_Dlls",
                        "\\Image File Execution Options",
                        "\\Drivers32"
                    ]
                },
                "wow_nt_current_version_base": {
                    "TargetObject|contains": "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "480421f9-417f-4d3b-9552-fd2728443ec8",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Wow6432Node Windows NT CurrentVersion Autorun Keys Modification"
        },
        {
            "author": "Florian Roth (Nextron Systems), oscd.community",
            "date": "2018/07/18",
            "description": "Detects a possible persistence mechanism using RUN key for Windows Explorer and pointing to a suspicious folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|contains": [
                        ":\\$Recycle.bin\\",
                        ":\\ProgramData\\",
                        ":\\Temp\\",
                        ":\\Users\\Default\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Temp\\",
                        "\\AppData\\Local\\Temp\\"
                    ],
                    "TargetObject|endswith": "\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b7916c2a-fa2f-4795-9477-32b731f70f11",
            "level": "high",
            "modified": "2023/12/11",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/"
            ],
            "status": "test",
            "title": "Registry Persistence via Explorer Run Key",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ]
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "all of selection_wow_current_version_* and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_dotnet": {
                    "Details|startswith": "\"C:\\ProgramData\\Package Cache\\",
                    "Details|endswith": ".exe\" /burn.runonce",
                    "Image|contains": "\\windowsdesktop-runtime-",
                    "TargetObject|endswith": [
                        "\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}",
                        "\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{7037b699-7382-448c-89a7-4765961d2537}"
                    ]
                },
                "filter_dropbox": [
                    {
                        "Details|endswith": "-A251-47B7-93E1-CDD82E34AF8B}"
                    },
                    {
                        "Details": "grpconv -o"
                    },
                    {
                        "Details|contains|all": [
                            "C:\\Program Files",
                            "\\Dropbox\\Client\\Dropbox.exe",
                            " /systemstartup"
                        ]
                    }
                ],
                "filter_edge": {
                    "Image|contains|all": [
                        "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\Install\\{",
                        "\\setup.exe"
                    ]
                },
                "filter_evernote": {
                    "TargetObject|endswith": "\\Explorer\\Browser Helper Objects\\{92EF2EAD-A7CE-4424-B0DB-499CF856608E}\\NoExplorer"
                },
                "filter_ms_win_desktop_runtime": {
                    "Details|startswith": "\"C:\\ProgramData\\Package Cache\\{d21a4f20-968a-4b0c-bf04-a38da5f06e41}\\windowsdesktop-runtime-"
                },
                "filter_msiexec": {
                    "Image": "C:\\WINDOWS\\system32\\msiexec.exe",
                    "TargetObject|contains": "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\"
                },
                "filter_msoffice1": {
                    "Image": "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\OfficeClickToRun.exe",
                    "TargetObject|contains": "\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Wow6432Node\\"
                },
                "filter_msoffice2": {
                    "Image": [
                        "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe",
                        "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                    ],
                    "TargetObject|contains": "\\Explorer\\Browser Helper Objects\\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}\\"
                },
                "filter_office": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                },
                "filter_uninstallers": {
                    "Image|startswith": "C:\\Windows\\Installer\\MSI",
                    "TargetObject|contains": "\\Explorer\\Browser Helper Objects"
                },
                "filter_upgrades": {
                    "Details|endswith": " /burn.runonce",
                    "Image|contains": [
                        "\\winsdksetup.exe",
                        "\\windowsdesktop-runtime-",
                        "\\AspNetCoreSharedFrameworkBundle-"
                    ],
                    "Image|startswith": [
                        "C:\\ProgramData\\Package Cache",
                        "C:\\Windows\\Temp\\"
                    ]
                },
                "filter_vcredist": {
                    "Details|endswith": "}\\VC_redist.x64.exe\" /burn.runonce",
                    "Image|endswith": "\\VC_redist.x64.exe"
                },
                "selection_wow_current_version_base": {
                    "TargetObject|contains": "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion"
                },
                "selection_wow_current_version_keys": {
                    "TargetObject|contains": [
                        "\\ShellServiceObjectDelayLoad",
                        "\\Run\\",
                        "\\RunOnce\\",
                        "\\RunOnceEx\\",
                        "\\RunServices\\",
                        "\\RunServicesOnce\\",
                        "\\Explorer\\ShellServiceObjects",
                        "\\Explorer\\ShellIconOverlayIdentifiers",
                        "\\Explorer\\ShellExecuteHooks",
                        "\\Explorer\\SharedTaskScheduler",
                        "\\Explorer\\Browser Helper Objects"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "b29aed60-ebd1-442b-9cb5-16a1d0324adb",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d",
                "https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/"
            ],
            "modified": "2023/08/17",
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Wow6432Node CurrentVersion Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "winsock_parameters_base and winsock_parameters and not filter",
                "filter": [
                    {
                        "Details": "(Empty)"
                    },
                    {
                        "Image": "C:\\Windows\\System32\\MsiExec.exe"
                    },
                    {
                        "Image": "C:\\Windows\\syswow64\\MsiExec.exe"
                    }
                ],
                "winsock_parameters": {
                    "TargetObject|contains": [
                        "\\Protocol_Catalog9\\Catalog_Entries",
                        "\\NameSpace_Catalog5\\Catalog_Entries"
                    ]
                },
                "winsock_parameters_base": {
                    "TargetObject|contains": "\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "d6c2ce7e-afb5-4337-9ca4-4b5254ed0565",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "WinSock2 Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "nt_current_version_base and nt_current_version and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_edge": {
                    "Image|endswith": "\\MicrosoftEdgeUpdate.exe",
                    "Image|startswith": "C:\\Program Files (x86)\\Microsoft\\Temp\\"
                },
                "filter_legitimate_subkey": {
                    "TargetObject|contains": "\\Image File Execution Options\\",
                    "TargetObject|endswith": [
                        "\\DisableExceptionChainValidation",
                        "\\MitigationOptions"
                    ]
                },
                "filter_msoffice": [
                    {
                        "TargetObject|contains": [
                            "\\ClickToRunStore\\HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\",
                            "\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\"
                        ]
                    },
                    {
                        "Image": [
                            "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe",
                            "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                        ]
                    }
                ],
                "filter_officeclicktorun": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                },
                "filter_ngen": {
                    "Image|endswith": "\\ngen.exe",
                    "Image|startswith": "C:\\Windows\\Microsoft.NET\\Framework"
                },
                "filter_onedrive": {
                    "Details|endswith": "\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe\"",
                    "Details|startswith": "C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\",
                    "Image|endswith": "\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdater\\OneDriveSetup.exe",
                    "TargetObject|endswith": "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Delete Cached Update Binary"
                },
                "filter_security_extension_dc": {
                    "Details": [
                        "DWORD (0x00000009)",
                        "DWORD (0x000003c0)"
                    ],
                    "Image": "C:\\Windows\\system32\\svchost.exe",
                    "TargetObject|contains": [
                        "\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\PreviousPolicyAreas",
                        "\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\MaxNoGPOListChangesInterval"
                    ]
                },
                "nt_current_version": {
                    "TargetObject|contains": [
                        "\\Winlogon\\VmApplet",
                        "\\Winlogon\\Userinit",
                        "\\Winlogon\\Taskman",
                        "\\Winlogon\\Shell",
                        "\\Winlogon\\GpExtensions",
                        "\\Winlogon\\AppSetup",
                        "\\Winlogon\\AlternateShells\\AvailableShells",
                        "\\Windows\\IconServiceLib",
                        "\\Windows\\Appinit_Dlls",
                        "\\Image File Execution Options",
                        "\\Font Drivers",
                        "\\Drivers32",
                        "\\Windows\\Run",
                        "\\Windows\\Load"
                    ]
                },
                "nt_current_version_base": {
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "cbf93e5d-ca6c-4722-8bea-e9119007c248",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "CurrentVersion NT Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "wow_classes_base and wow_classes and not filter",
                "filter": {
                    "Details": "(Empty)"
                },
                "wow_classes": {
                    "TargetObject|contains": [
                        "\\Folder\\ShellEx\\ExtShellFolderViews",
                        "\\Folder\\ShellEx\\DragDropHandlers",
                        "\\Folder\\ShellEx\\ColumnHandlers",
                        "\\Directory\\Shellex\\DragDropHandlers",
                        "\\Directory\\Shellex\\CopyHookHandlers",
                        "\\CLSID\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\Instance",
                        "\\CLSID\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\Instance",
                        "\\CLSID\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\Instance",
                        "\\CLSID\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\Instance",
                        "\\AllFileSystemObjects\\ShellEx\\DragDropHandlers",
                        "\\ShellEx\\PropertySheetHandlers",
                        "\\ShellEx\\ContextMenuHandlers"
                    ]
                },
                "wow_classes_base": {
                    "TargetObject|contains": "\\Software\\Wow6432Node\\Classes"
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "fields": [
                "SecurityID",
                "ObjectName",
                "OldValueType",
                "NewValueType"
            ],
            "id": "18f2065c-d36c-464a-a748-bcf909acb2e3",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
            ],
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Wow6432Node Classes Autorun Keys Modification"
        },
        {
            "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split), wagga (name)",
            "date": "2019/10/25",
            "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
            "detection": {
                "condition": "main_selection and not 1 of filter_*",
                "filter_empty": {
                    "Details": "(Empty)"
                },
                "filter_IE": {
                    "TargetObject|contains": "\\Software\\Microsoft\\Active Setup\\Installed Components\\{89820200-ECBD-11cf-8B85-00AA005B4383}"
                },
                "filter_chrome": {
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{8A69D345-D564-463c-AFF1-A69D9E530F96}"
                },
                "filter_edge": {
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{9459C573-B17A-45AE-9F64-1857B5D58CEE}"
                },
                "filter_image": {
                    "Image": [
                        "C:\\Windows\\System32\\poqexec.exe",
                        "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                    ]
                },
                "filter_msoffice": [
                    {
                        "TargetObject|contains": [
                            "\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Classes\\PROTOCOLS\\Handler\\",
                            "\\ClickToRunStore\\HKMU\\SOFTWARE\\Classes\\PROTOCOLS\\Handler\\"
                        ]
                    },
                    {
                        "Details": [
                            "{314111c7-a502-11d2-bbca-00c04f8ec294}",
                            "{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}",
                            "{42089D2D-912D-4018-9087-2B87803E93FB}",
                            "{5504BE45-A83B-4808-900A-3A5C36E7F77A}",
                            "{807583E5-5146-11D5-A672-00B0D022E945}"
                        ]
                    }
                ],
                "main_selection": {
                    "TargetObject|contains": [
                        "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows CE Services\\AutoStart",
                        "\\Software\\Wow6432Node\\Microsoft\\Command Processor\\Autorun",
                        "\\SOFTWARE\\Wow6432Node\\Microsoft\\Active Setup\\Installed Components",
                        "\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnDisconnect",
                        "\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnConnect",
                        "\\SYSTEM\\Setup\\CmdLine",
                        "\\Software\\Microsoft\\Ctf\\LangBarAddin",
                        "\\Software\\Microsoft\\Command Processor\\Autorun",
                        "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components",
                        "\\SOFTWARE\\Classes\\Protocols\\Handler",
                        "\\SOFTWARE\\Classes\\Protocols\\Filter",
                        "\\SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command\\(Default)",
                        "\\Environment\\UserInitMprLogonScript",
                        "\\SOFTWARE\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop\\Scrnsave.exe",
                        "\\Software\\Microsoft\\Internet Explorer\\UrlSearchHooks",
                        "\\SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\Components",
                        "\\Software\\Classes\\Clsid\\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\\Inprocserver32",
                        "\\Control Panel\\Desktop\\Scrnsave.exe"
                    ]
                },
                "filter_office": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
                "Legitimate administrator sets up autorun keys for legitimate reason"
            ],
            "id": "f59c3faf-50f3-464b-9f4c-1b67ab512d99",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
                "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
                "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d",
                "https://persistence-info.github.io/Data/userinitmprlogonscript.html"
            ],
            "modified": "2023/08/17",
            "related": [
                {
                    "id": "17f878b8-9968-4578-b814-c4217fc5768c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.001"
            ],
            "title": "Common Autorun Keys Modification"
        }
    ]
}