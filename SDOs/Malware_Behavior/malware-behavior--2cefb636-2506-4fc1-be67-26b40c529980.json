{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--2cefb636-2506-4fc1-be67-26b40c529980",
    "created": "2024-08-13T14:46:37.071116Z",
    "modified": "2024-08-13T14:46:45.822021Z",
    "name": "Scheduled Task/Job",
    "description": "Adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code. Utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time. A task can also be scheduled on a remote system, provided the proper authentication is met (ex: RPC and file and printer sharing in Windows environments). Scheduling a task on a remote system typically may require being a member of an admin or otherwise privileged group on the remote system.[1]Adversaries may use task scheduling to execute programs at system startup or on a scheduled basis for persistence. These mechanisms can also be abused to run a process under the context of a specified account (such as one with elevated permissions/privileges). Similar to System Binary Proxy Execution, adversaries have also abused task scheduling to potentially mask one-time execution under a trusted system process.[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1053",
            "external_id": "T1053"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1053",
            "external_id": "T1053"
        },
        {
            "source_name": "ProofPoint Serpent",
            "description": "Campbell, B. et al. (2022, March 21). Serpent, No Swiping! New Backdoor Targets French Entities with Unique Attack Chain. Retrieved April 11, 2022.",
            "url": "https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain"
        },
        {
            "source_name": "TechNet Task Scheduler Security",
            "description": "Microsoft. (2005, January 21). Task Scheduler and security. Retrieved June 8, 2016.",
            "url": "https://technet.microsoft.com/en-us/library/cc785125.aspx"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/11/22",
            "description": "Identifies when a Azure Kubernetes CronJob runs in Azure Cloud. Kubernetes Job is a controller that creates one or more pods and ensures that a specified number of them successfully terminate.\nKubernetes Job can be used to run containers that perform finite tasks for batch jobs. Kubernetes CronJob is used to schedule Jobs.\nAn Adversary may use Kubernetes CronJob for scheduling execution of malicious code that would run as a container in the cluster.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName|endswith": [
                        "/CRONJOBS/WRITE",
                        "/JOBS/WRITE"
                    ],
                    "operationName|startswith": [
                        "MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/BATCH",
                        "MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/BATCH"
                    ]
                }
            },
            "falsepositives": [
                "Azure Kubernetes CronJob/Job may be done by a system administrator.",
                "If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "1c71e254-6655-42c1-b2d6-5e4718d7fc0a",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/12/18",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes",
                "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/",
                "https://kubernetes.io/docs/concepts/workloads/controllers/job/",
                "https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.003",
                "attack.privilege_escalation",
                "attack.execution"
            ],
            "title": "Azure Kubernetes CronJob"
        },
        {
            "author": "Sagie Dulce, Dekel Paz",
            "date": "2022/01/01",
            "description": "Detects remote RPC calls to create or execute a scheduled task",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "EventLog": "RPCFW",
                    "InterfaceUuid": "86d35949-83c9-4044-b424-db363231fd0c",
                    "OpNum": [
                        1,
                        3,
                        4,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ace3ff54-e7fd-46bd-8ea0-74b49a0aca1d",
            "level": "high",
            "logsource": {
                "category": "application",
                "definition": "Requirements: install and apply the RPC Firewall to all processes with \"audit:true action:block uuid:86d35949-83c9-4044-b424-db363231fd0c\"",
                "product": "rpc_firewall"
            },
            "modified": "2022/01/01",
            "references": [
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931",
                "https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md",
                "https://github.com/zeronetworks/rpcfirewall",
                "https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1053",
                "attack.t1053.002"
            ],
            "title": "Remote Schedule Task Lateral Movement via ITaskSchedulerService"
        },
        {
            "author": "Sagie Dulce, Dekel Paz",
            "date": "2022/01/01",
            "description": "Detects remote RPC calls to create or execute a scheduled task via ATSvc",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "EventLog": "RPCFW",
                    "InterfaceUuid": "1ff70682-0a51-30e8-076d-740be8cee98b",
                    "OpNum": [
                        0,
                        1
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0fcd1c79-4eeb-4746-aba9-1b458f7a79cb",
            "level": "high",
            "logsource": {
                "category": "application",
                "definition": "Requirements: install and apply the RPC Firewall to all processes with \"audit:true action:block uuid:1ff70682-0a51-30e8-076d-740be8cee98b\"",
                "product": "rpc_firewall"
            },
            "modified": "2022/01/01",
            "references": [
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931",
                "https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md",
                "https://github.com/zeronetworks/rpcfirewall",
                "https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1053",
                "attack.t1053.002"
            ],
            "title": "Remote Schedule Task Lateral Movement via ATSvc"
        },
        {
            "author": "Sagie Dulce, Dekel Paz",
            "date": "2022/01/01",
            "description": "Detects remote RPC calls to create or execute a scheduled task via SASec",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "EventLog": "RPCFW",
                    "InterfaceUuid": "378e52b0-c0a9-11cf-822d-00aa0051e40f",
                    "OpNum": [
                        0,
                        1
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "aff229ab-f8cd-447b-b215-084d11e79eb0",
            "level": "high",
            "logsource": {
                "category": "application",
                "definition": "Requirements: install and apply the RPC Firewall to all processes with \"audit:true action:block uuid:378e52b0-c0a9-11cf-822d-00aa0051e40f\"",
                "product": "rpc_firewall"
            },
            "modified": "2022/01/01",
            "references": [
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/d1058a28-7e02-4948-8b8d-4a347fa64931",
                "https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-TSCH.md",
                "https://github.com/zeronetworks/rpcfirewall",
                "https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1053",
                "attack.t1053.002"
            ],
            "title": "Remote Schedule Task Lateral Movement via SASec"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Modifications to a config that will serve an adversary's impacts or persistence",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "ip http server",
                    "ip https server",
                    "kron policy-list",
                    "kron occurrence",
                    "policy-list",
                    "access-list",
                    "ip access-group",
                    "archive maximum"
                ]
            },
            "falsepositives": [
                "Legitimate administrators may run these commands"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "671ffc77-50a7-464f-9e3d-9ea2b493b26b",
            "level": "medium",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.impact",
                "attack.t1490",
                "attack.t1505",
                "attack.t1565.002",
                "attack.t1053"
            ],
            "title": "Cisco Modify Configuration"
        },
        {
            "author": "@neu5ron, SOC Prime",
            "date": "2020/03/19",
            "description": "Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE",
            "detection": {
                "condition": "1 of op*",
                "op1": {
                    "endpoint": "JobAdd",
                    "operation": "atsvc"
                },
                "op10": {
                    "endpoint": "svcctl",
                    "operation": "StartServiceW"
                },
                "op2": {
                    "endpoint": "ITaskSchedulerService",
                    "operation": "SchRpcEnableTask"
                },
                "op3": {
                    "endpoint": "ITaskSchedulerService",
                    "operation": "SchRpcRegisterTask"
                },
                "op4": {
                    "endpoint": "ITaskSchedulerService",
                    "operation": "SchRpcRun"
                },
                "op5": {
                    "endpoint": "IWbemServices",
                    "operation": "ExecMethod"
                },
                "op6": {
                    "endpoint": "IWbemServices",
                    "operation": "ExecMethodAsync"
                },
                "op7": {
                    "endpoint": "svcctl",
                    "operation": "CreateServiceA"
                },
                "op8": {
                    "endpoint": "svcctl",
                    "operation": "CreateServiceW"
                },
                "op9": {
                    "endpoint": "svcctl",
                    "operation": "StartServiceA"
                }
            },
            "falsepositives": [
                "Windows administrator tasks or troubleshooting",
                "Windows management scripts or software"
            ],
            "id": "b640c0b8-87f8-4daa-aef8-95a24261dd1d",
            "level": "medium",
            "logsource": {
                "product": "zeek",
                "service": "dce_rpc"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/mitre-attack/bzar#indicators-for-attck-execution"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.t1053.002",
                "attack.t1569.002"
            ],
            "title": "MITRE BZAR Indicators for Execution"
        },
        {
            "author": "Samir Bousseaden, @neu5rn",
            "date": "2020/04/03",
            "description": "Detects remote task creation via at.exe or API interacting with ATSVC namedpipe",
            "detection": {
                "condition": "selection",
                "selection": {
                    "name": "atsvc",
                    "path": "\\\\\\*\\IPC$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dde85b37-40cd-4a94-b00c-0b8794f956b5",
            "level": "medium",
            "logsource": {
                "product": "zeek",
                "service": "smb_files"
            },
            "modified": "2022/12/27",
            "references": [
                "https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html"
            ],
            "related": [
                {
                    "id": "f6de6525-4509-495a-8a82-1f8b0ed73a00",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.persistence",
                "car.2013-05-004",
                "car.2015-04-001",
                "attack.t1053.002"
            ],
            "title": "Remote Task Creation via ATSVC Named Pipe - Zeek"
        },
        {
            "author": "Alejandro Ortuno, oscd.community",
            "date": "2020/10/06",
            "description": "Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/tmp/",
                    "Image|endswith": "/crontab"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "7c3b43d8-d794-47d2-800a-d277715aa460",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1053.003"
            ],
            "title": "Scheduled Cron Task/Job - MacOs"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/11/16",
            "description": "Detects the creation of tasks from processes executed from suspicious locations",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|contains": [
                        "\\AppData\\",
                        "C:\\PerfLogs",
                        "\\Windows\\System32\\config\\systemprofile"
                    ],
                    "TargetFilename|contains": "\\Windows\\System32\\Tasks"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "80e1f67a-4596-4351-98f5-a9c3efabac95",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/01/12",
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.execution",
                "attack.t1053"
            ],
            "title": "Suspicious Scheduled Task Write to System32 Tasks"
        },
        {
            "author": "pH-T (Nextron Systems)",
            "date": "2022/07/15",
            "description": "Detects scheduled task creation events that include suspicious actions, and is run once at 00:00",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "wscript",
                        "vbscript",
                        "cscript",
                        "wmic ",
                        "wmic.exe",
                        "regsvr32.exe",
                        "powershell",
                        "\\AppData\\"
                    ]
                },
                "selection_img": [
                    {
                        "Image|contains": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ],
                "selection_time": {
                    "CommandLine|contains|all": [
                        "once",
                        "00:00"
                    ]
                }
            },
            "falsepositives": [
                "Software installation"
            ],
            "id": "970823b7-273b-460a-8afc-3a6811998529",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1053.005"
            ],
            "title": "Uncommon One Time Only Scheduled Task At 00:00"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/28",
            "description": "Detects when an attacker tries to modify an already existing scheduled tasks to run from a suspicious location\nAttackers can create a simple looking task in order to avoid detection on creation as it's often the most focused on\nInstead they modify the task after creation to include their malicious payload\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_schtasks": {
                    "CommandLine|contains|all": [
                        " /Change ",
                        " /TN "
                    ],
                    "Image|endswith": "\\schtasks.exe"
                },
                "selection_susp_images": {
                    "CommandLine|contains": [
                        "regsvr32",
                        "rundll32",
                        "cmd /c ",
                        "cmd /k ",
                        "cmd /r ",
                        "cmd.exe /c ",
                        "cmd.exe /k ",
                        "cmd.exe /r ",
                        "powershell",
                        "mshta",
                        "wscript",
                        "cscript",
                        "certutil",
                        "bitsadmin",
                        "bash.exe",
                        "bash ",
                        "scrcons",
                        "wmic ",
                        "wmic.exe",
                        "forfiles",
                        "scriptrunner",
                        "hh.exe",
                        "hh "
                    ]
                },
                "selection_susp_locations": {
                    "CommandLine|contains": [
                        "\\AppData\\Local\\Temp",
                        "\\AppData\\Roaming\\",
                        "\\Users\\Public\\",
                        "\\WINDOWS\\Temp\\",
                        "\\Desktop\\",
                        "\\Downloads\\",
                        "\\Temporary Internet",
                        "C:\\ProgramData\\",
                        "C:\\Perflogs\\",
                        "%ProgramData%",
                        "%appdata%",
                        "%comspec%",
                        "%localappdata%"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1c0e41cd-21bb-4433-9acc-4a2cd6367b9b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/11/18",
            "references": [
                "Internal Research",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks"
            ],
            "related": [
                {
                    "id": "614cf376-6651-47c4-9dcc-6b9527f749f4",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ],
            "title": "Suspicious Modification Of Scheduled Tasks"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/15",
            "description": "Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli_1": {
                    "CommandLine|contains": [
                        " -t schtask -c ",
                        " -t startupfolder -c "
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains|all": [
                        " -t reg -c ",
                        " -m add"
                    ]
                },
                "selection_cli_3": {
                    "CommandLine|contains|all": [
                        " -t service -c ",
                        " -m add"
                    ]
                },
                "selection_cli_4": {
                    "CommandLine|contains|all": [
                        " -t schtask -c ",
                        " -m add"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\SharPersist.exe"
                    },
                    {
                        "Product": "SharPersist"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "26488ad0-f9fd-4536-876f-52fea846a2e4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://www.mandiant.com/resources/blog/sharpersist-windows-persistence-toolkit",
                "https://github.com/mandiant/SharPersist"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053"
            ],
            "title": "HackTool - SharPersist Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/31",
            "description": "Detects creation of a scheduled task with a GUID like name",
            "detection": {
                "condition": "all of selection_*",
                "selection_end": {
                    "CommandLine|contains": [
                        "}\"",
                        "}'",
                        "} "
                    ]
                },
                "selection_img": {
                    "CommandLine|contains": "/Create ",
                    "Image|endswith": "\\schtasks.exe"
                },
                "selection_tn": {
                    "CommandLine|contains": [
                        "/TN \"{",
                        "/TN '{",
                        "/TN {"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software naming their tasks as GUIDs"
            ],
            "id": "ff2fff64-4cd6-4a2b-ba7d-e28a30bbe66b",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/",
                "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
            ],
            "status": "test",
            "title": "Suspicious Scheduled Task Name As GUID",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ]
        },
        {
            "author": "pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport, X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/02/12",
            "description": "Detects the creation of a schtask that potentially executes a base64 encoded payload stored in the Windows Registry using PowerShell.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli_create": {
                    "CommandLine|contains": "/Create"
                },
                "selection_cli_encoding": {
                    "CommandLine|contains": [
                        "FromBase64String",
                        "encodedcommand"
                    ]
                },
                "selection_cli_get": {
                    "CommandLine|contains": [
                        "Get-ItemProperty",
                        " gp "
                    ]
                },
                "selection_cli_hive": {
                    "CommandLine|contains": [
                        "HKCU:",
                        "HKLM:",
                        "registry::",
                        "HKEY_"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1053.005",
                "attack.t1059.001"
            ],
            "title": "Scheduled Task Executing Encoded Payload from Registry"
        },
        {
            "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
            "date": "2019/10/24",
            "description": "Detects an interactive AT job, which may be used as a form of privilege escalation.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "interactive",
                    "Image|endswith": "\\at.exe"
                }
            },
            "falsepositives": [
                "Unlikely (at.exe deprecated as of Windows 8)"
            ],
            "id": "60fc936d-2eb0-4543-8a13-911c750a1dfc",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.002/T1053.002.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html"
            ],
            "status": "test",
            "tags": [
                "attack.privilege_escalation",
                "attack.t1053.002"
            ],
            "title": "Interactive AT Job"
        },
        {
            "author": "Thomas Patzke",
            "date": "2020/05/22",
            "description": "Detects various execution patterns of the CrackMapExec pentesting framework",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "cmd.exe /Q /c * 1> \\\\\\\\*\\\\*\\\\* 2>&1",
                        "cmd.exe /C * > \\\\\\\\*\\\\*\\\\* 2>&1",
                        "cmd.exe /C * > *\\\\Temp\\\\* 2>&1",
                        "powershell.exe -exec bypass -noni -nop -w 1 -C \"",
                        "powershell.exe -noni -nop -w 1 -enc "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "058f4380-962d-40a5-afce-50207d36d7e2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/06",
            "references": [
                "https://github.com/byt3bl33d3r/CrackMapExec"
            ],
            "status": "stable",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.t1053",
                "attack.t1059.003",
                "attack.t1059.001",
                "attack.s0106"
            ],
            "title": "HackTool - CrackMapExec Execution Patterns"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/25",
            "description": "This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.",
            "detection": {
                "condition": "1 of selection_* or all of part_localauth*",
                "part_localauth_1": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -p "
                    ]
                },
                "part_localauth_2": {
                    "CommandLine|contains|all": [
                        " 10.",
                        " 192.168.",
                        "/24 "
                    ]
                },
                "selection_binary": {
                    "Image|endswith": "\\crackmapexec.exe"
                },
                "selection_execute": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -x "
                    ]
                },
                "selection_hash": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -p ",
                        " -H 'NTHASH'"
                    ]
                },
                "selection_module_mssql": {
                    "CommandLine|contains|all": [
                        " mssql ",
                        " -u ",
                        " -p ",
                        " -M ",
                        " -d "
                    ]
                },
                "selection_module_smb1": {
                    "CommandLine|contains|all": [
                        " smb ",
                        " -u ",
                        " -H ",
                        " -M ",
                        " -o "
                    ]
                },
                "selection_module_smb2": {
                    "CommandLine|contains|all": [
                        " smb ",
                        " -u ",
                        " -p ",
                        " --local-auth"
                    ]
                },
                "selection_special": {
                    "CommandLine|contains": " -M pe_inject "
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine"
            ],
            "id": "42a993dd-bb3e-48c8-b372-4d6684c4106c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/08",
            "status": "test",
            "references": [
                "https://mpgn.gitbook.io/crackmapexec/smb-protocol/authentication/checking-credentials-local",
                "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
                "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=mssql-mimikatz",
                "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-pe_inject"
            ],
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.credential_access",
                "attack.discovery",
                "attack.t1047",
                "attack.t1053",
                "attack.t1059.003",
                "attack.t1059.001",
                "attack.t1110",
                "attack.t1201"
            ],
            "title": "HackTool - CrackMapExec Execution"
        },
        {
            "author": "pH-T (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/03/15",
            "description": "Detects the creation of a schtask that executes a file from C:\\Users\\<USER>\\AppData\\Local",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "CommandLine|contains": "/TN TVInstallRestore",
                    "Image|endswith": "\\schtasks.exe",
                    "ParentImage|contains|all": [
                        "\\AppData\\Local\\Temp\\",
                        "TeamViewer_.exe"
                    ]
                },
                "selection": {
                    "CommandLine|contains": [
                        "NT AUT",
                        " SYSTEM "
                    ],
                    "Image|endswith": "\\schtasks.exe",
                    "CommandLine|contains|all": [
                        "/Create",
                        "/RU",
                        "/TR",
                        "C:\\Users\\",
                        "\\AppData\\Local\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c5c00f49-b3f9-45a6-997e-cfdecc6e1967",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/07/28",
            "references": [
                "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1053.005",
                "attack.t1059.001"
            ],
            "title": "Suspicious Schtasks Execution AppData Folder"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/31",
            "description": "Detects scheduled task creations or modification to be run with high privileges on a suspicious schedule type",
            "detection": {
                "condition": "all of selection_*",
                "selection_privs": {
                    "CommandLine|contains": [
                        "NT AUT",
                        " SYSTEM",
                        "HIGHEST"
                    ]
                },
                "selection_time": {
                    "CommandLine|contains": [
                        " ONLOGON ",
                        " ONSTART ",
                        " ONCE ",
                        " ONIDLE "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Some installers were seen using this method of creation unfortunately. Filter them in your environment"
            ],
            "id": "7a02e22e-b885-4404-b38b-1ddc7e65258a",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create"
            ],
            "related": [
                {
                    "id": "24c8392b-aa3c-46b7-a545-43f71657fe98",
                    "type": "similar"
                }
            ],
            "status": "test",
            "title": "Suspicious Schtasks Schedule Type With High Privileges",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/23",
            "description": "Detects scheduled task creation using \"schtasks\" that contain potentially suspicious or uncommon commands",
            "detection": {
                "condition": "selection_schtasks and ( all of selection_pattern_* or selection_uncommon or all of selection_anomaly_* )",
                "selection_anomaly_1": {
                    "CommandLine|contains": [
                        ":\\ProgramData\\",
                        ":\\Temp\\",
                        ":\\Tmp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Temp\\",
                        "\\AppData\\",
                        "%AppData%",
                        "%Temp%",
                        "%tmp%"
                    ]
                },
                "selection_anomaly_2": {
                    "CommandLine|contains": [
                        "cscript",
                        "curl",
                        "wscript"
                    ]
                },
                "selection_pattern_1": {
                    "CommandLine|contains": [
                        "/sc minute ",
                        "/ru system "
                    ]
                },
                "selection_pattern_2": {
                    "CommandLine|contains": [
                        "cmd /c",
                        "cmd /k",
                        "cmd /r",
                        "cmd.exe /c ",
                        "cmd.exe /k ",
                        "cmd.exe /r "
                    ]
                },
                "selection_schtasks": {
                    "CommandLine|contains": "/Create ",
                    "Image|endswith": "\\schtasks.exe"
                },
                "selection_uncommon": {
                    "CommandLine|contains": [
                        " -decode ",
                        " -enc ",
                        " -w hidden ",
                        " bypass ",
                        " IEX",
                        ".DownloadData",
                        ".DownloadFile",
                        ".DownloadString",
                        "/c start /min ",
                        "FromBase64String",
                        "mshta http",
                        "mshta.exe http"
                    ]
                }
            },
            "falsepositives": [
                "Software installers that run from temporary folders and also install scheduled tasks are expected to generate some false positives"
            ],
            "id": "f2c64357-b1d2-41b7-849f-34d2682c0fad",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/19",
            "references": [
                "https://app.any.run/tasks/512c1352-6380-4436-b27d-bb62f0c020d6/",
                "https://twitter.com/RedDrip7/status/1506480588827467785",
                "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf"
            ],
            "status": "experimental",
            "title": "Suspicious Command Patterns In Scheduled Task Creation",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/21",
            "description": "Detects Schtask creations that point to a suspicious folder or an environment variable often used by malware",
            "detection": {
                "condition": "( all of selection1* or all of selection2* ) and not 1 of filter*",
                "filter_avira_install": {
                    "CommandLine|contains|all": [
                        "/Create /Xml \"C:\\Users\\",
                        "\\AppData\\Local\\Temp\\.CR.",
                        "Avira_Security_Installation.xml"
                    ]
                },
                "filter_avira_other": {
                    "CommandLine|contains": [
                        ".tmp\\UpdateFallbackTask.xml",
                        ".tmp\\WatchdogServiceControlManagerTimeout.xml",
                        ".tmp\\SystrayAutostart.xml",
                        ".tmp\\MaintenanceTask.xml"
                    ],
                    "CommandLine|contains|all": [
                        "/Create /F /TN",
                        "/Xml ",
                        "\\AppData\\Local\\Temp\\is-",
                        "Avira_"
                    ]
                },
                "filter_klite_codec": {
                    "CommandLine|contains|all": [
                        "\\AppData\\Local\\Temp\\",
                        "/Create /TN \"klcp_update\" /XML ",
                        "\\klcp_update_task.xml"
                    ]
                },
                "filter_mixed": [
                    {
                        "CommandLine|contains": [
                            "update_task.xml",
                            "/Create /TN TVInstallRestore /TR"
                        ]
                    },
                    {
                        "ParentCommandLine|contains": "unattended.ini"
                    }
                ],
                "selection1_all_folders": {
                    "CommandLine|contains": [
                        ":\\Perflogs",
                        ":\\Windows\\Temp",
                        "\\AppData\\Local\\",
                        "\\AppData\\Roaming\\",
                        "\\Users\\Public",
                        "%AppData%",
                        "%Public%"
                    ]
                },
                "selection1_create": {
                    "CommandLine|contains": " /create ",
                    "Image|endswith": "\\schtasks.exe"
                },
                "selection2_parent": {
                    "ParentCommandLine|endswith": "\\svchost.exe -k netsvcs -p -s Schedule"
                },
                "selection2_some_folders": {
                    "CommandLine|contains": [
                        ":\\Perflogs",
                        ":\\Windows\\Temp",
                        "\\Users\\Public",
                        "%Public%"
                    ]
                }
            },
            "falsepositives": [
                "Benign scheduled tasks creations or executions that happen often during software installations",
                "Software that uses the AppData folder and scheduled tasks to update the software in the AppData folders"
            ],
            "id": "81325ce1-be01-4250-944f-b4789644556f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/30",
            "references": [
                "https://www.welivesecurity.com/2022/01/18/donot-go-do-not-respawn/",
                "https://www.joesandbox.com/analysis/514608/0/html#324415FF7D8324231381BAD48A052F85DF04"
            ],
            "related": [
                {
                    "id": "43f487f0-755f-4c2a-bce7-d6d2eec2fcf8",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ],
            "title": "Suspicious Schtasks From Env Var Folder"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/04/15",
            "description": "Detects scheduled task creations that have suspicious action command and folder combinations",
            "detection": {
                "condition": "all of selection_*",
                "selection_all_folders": {
                    "CommandLine|contains": [
                        "C:\\ProgramData\\",
                        "%ProgramData%"
                    ]
                },
                "selection_command": {
                    "CommandLine|contains": [
                        "powershell",
                        "pwsh",
                        "cmd /c ",
                        "cmd /k ",
                        "cmd /r ",
                        "cmd.exe /c ",
                        "cmd.exe /k ",
                        "cmd.exe /r "
                    ]
                },
                "selection_create": {
                    "CommandLine|contains": " /create "
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8a8379b8-780b-4dbf-b1e9-31c8d112fefb",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/11/18",
            "references": [
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/lazarus-dream-job-chemical"
            ],
            "status": "test",
            "title": "Schtasks From Suspicious Folders",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ]
        },
        {
            "author": "X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/07/18",
            "description": "Detects the creation of a schtasks that potentially executes a payload stored in the Windows Registry using PowerShell.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "selection_cli_create": {
                    "CommandLine|contains": "/Create"
                },
                "filter_main_encoding": {
                    "CommandLine|contains": [
                        "FromBase64String",
                        "encodedcommand"
                    ]
                },
                "selection_cli_get": {
                    "CommandLine|contains": [
                        "Get-ItemProperty",
                        " gp "
                    ]
                },
                "selection_cli_hive": {
                    "CommandLine|contains": [
                        "HKCU:",
                        "HKLM:",
                        "registry::",
                        "HKEY_"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "86588b36-c6d3-465f-9cee-8f9093e07798",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "related": [
                {
                    "type": "derived",
                    "id": "c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78"
                }
            ],
            "references": [
                "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1053.005",
                "attack.t1059.001"
            ],
            "title": "Scheduled Task Executing Payload from Registry"
        },
        {
            "author": "Markus Neis, @Karneades",
            "date": "2018/03/06",
            "description": "Detects the creation of a schtask via PowerSploit or Empire Default Configuration.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "/SC ONLOGON",
                        "/SC DAILY /ST",
                        "/SC ONIDLE",
                        "/SC HOURLY"
                    ],
                    "Image|endswith": "\\schtasks.exe",
                    "CommandLine|contains|all": [
                        "/Create",
                        "powershell.exe -NonI",
                        "/TN Updater /TR"
                    ],
                    "ParentImage|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "56c217c3-2de2-479b-990f-5c109ba8458f",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/03",
            "references": [
                "https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1",
                "https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/lib/modules/powershell/persistence/userland/schtasks.py"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.s0111",
                "attack.g0022",
                "attack.g0060",
                "car.2013-08-001",
                "attack.t1053.005",
                "attack.t1059.001"
            ],
            "title": "HackTool - Default PowerSploit/Empire Scheduled Task Creation"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/01/16",
            "description": "Detects the creation of scheduled tasks by user accounts via the \"schtasks\" utility.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_system_user": {
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "selection": {
                    "CommandLine|contains": " /create ",
                    "Image|endswith": "\\schtasks.exe"
                }
            },
            "falsepositives": [
                "Administrative activity",
                "Software installation"
            ],
            "id": "92626ddd-662c-49e3-ac59-f6535f12d189",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/18",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1053.005",
                "attack.s0111",
                "car.2013-08-001",
                "stp.1u"
            ],
            "title": "Scheduled Task Creation Via Schtasks.EXE"
        },
        {
            "author": "pH-T (Nextron Systems), Florian Roth (Nextron Systems)",
            "date": "2022/04/08",
            "description": "Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell \"Get-Variable\" technique as seen being used in Colibri Loader",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|endswith": [
                        " -windowstyle hidden",
                        " -w hidden",
                        " -ep bypass",
                        " -noni"
                    ],
                    "ParentCommandLine|contains|all": [
                        "-k netsvcs",
                        "-s Schedule"
                    ],
                    "ParentImage": "C:\\WINDOWS\\System32\\svchost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b66474aa-bd92-4333-a16c-298155b120df",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/"
            ],
            "related": [
                {
                    "id": "6e8811ee-90ba-441e-8486-5653e68b2299",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1053.005",
                "attack.t1059.001"
            ],
            "title": "Potential Persistence Via Powershell Search Order Hijacking - Task"
        },
        {
            "author": "Sreeman",
            "date": "2020/09/29",
            "description": "Detects manual execution of the \"Microsoft Compatibility Appraiser\" task via schtasks.\nIn order to trigger persistence stored in the \"\\AppCompatFlags\\TelemetryController\" registry key.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "run ",
                        "\\Application Experience\\Microsoft Compatibility Appraiser"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f548a603-c9f2-4c89-b511-b089f7e94549",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/10",
            "references": [
                "https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/"
            ],
            "related": [
                {
                    "id": "73a883d0-0348-4be4-a8d8-51031c2564f8",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Potential Persistence Via Microsoft Compatibility Appraiser"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/28",
            "description": "Detects the creation or update of a scheduled task to run with \"NT AUTHORITY\\SYSTEM\" privileges",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_avira": {
                    "CommandLine|contains": [
                        "/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR ",
                        ":\\Program Files (x86)\\Avira\\System Speedup\\setup\\avira_speedup_setup.exe",
                        "/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART\" /RL HIGHEST"
                    ]
                },
                "filter_optional_teamviewer": {
                    "CommandLine|contains|all": [
                        "/TN TVInstallRestore",
                        "\\TeamViewer_.exe"
                    ],
                    "Image|endswith": "\\schtasks.exe"
                },
                "selection_root": {
                    "CommandLine|contains": [
                        " /change ",
                        " /create "
                    ],
                    "Image|endswith": "\\schtasks.exe"
                },
                "selection_run": {
                    "CommandLine|contains": "/ru "
                },
                "selection_user": {
                    "CommandLine|contains": [
                        "NT AUT",
                        " SYSTEM "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "89ca78fd-b37c-4310-b3d3-81a023f83936",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/10/11",
            "references": [
                "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks"
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Schtasks Creation Or Modification With SYSTEM Privileges"
        },
        {
            "id": "24c8392b-aa3c-46b7-a545-43f71657fe98",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/09",
            "description": "Detects scheduled task creations or modification on a suspicious schedule type",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "filter_privs": {
                    "CommandLine|contains": [
                        "NT AUT",
                        " SYSTEM",
                        "HIGHEST"
                    ]
                },
                "selection_time": {
                    "CommandLine|contains": [
                        " ONLOGON ",
                        " ONSTART ",
                        " ONCE ",
                        " ONIDLE "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate processes that run at logon. Filter according to your environment"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create",
                "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "7a02e22e-b885-4404-b38b-1ddc7e65258a"
                }
            ],
            "status": "test",
            "title": "Suspicious Schtasks Schedule Types",
            "tags": [
                "attack.execution",
                "attack.t1053.005"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/03/11",
            "description": "Detects the creation of scheduled tasks that involves a temporary folder and runs only once",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " /create ",
                        " /sc once ",
                        "\\Temp\\"
                    ],
                    "Image|endswith": "\\schtasks.exe"
                }
            },
            "falsepositives": [
                "Administrative activity",
                "Software installation"
            ],
            "id": "39019a4e-317f-4ce3-ae63-309a8c6b53c5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Suspicious Scheduled Task Creation Involving Temp Folder"
        },
        {
            "author": "Swachchhanda Shrawan Poudel, Elastic (idea)",
            "date": "2023/04/20",
            "description": "Detects the creation of a scheduled task using the \"-XML\" flag with a file without the '.xml' extension. This behavior could be indicative of potential defense evasion attempt during persistence",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_extension_xml": {
                    "CommandLine|contains": ".xml"
                },
                "filter_main_rundll32": {
                    "ParentCommandLine|contains|all": [
                        ":\\WINDOWS\\Installer\\MSI",
                        ".tmp,zzzzInvokeManagedCustomActionOutOfProc"
                    ],
                    "ParentImage|endswith": "\\rundll32.exe"
                },
                "filter_main_system_process": {
                    "IntegrityLevel": "System"
                },
                "filter_optional_third_party": {
                    "ParentImage|endswith": [
                        ":\\ProgramData\\OEM\\UpgradeTool\\CareCenter_*\\BUnzip\\Setup_msi.exe",
                        ":\\Program Files\\Axis Communications\\AXIS Camera Station\\SetupActions.exe",
                        ":\\Program Files\\Axis Communications\\AXIS Device Manager\\AdmSetupActions.exe",
                        ":\\Program Files (x86)\\Zemana\\AntiMalware\\AntiMalware.exe",
                        ":\\Program Files\\Dell\\SupportAssist\\pcdrcui.exe"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ],
                "selection_cli_create": {
                    "CommandLine|contains": [
                        "/create",
                        "-create"
                    ]
                },
                "selection_cli_xml": {
                    "CommandLine|contains": [
                        "/xml",
                        "-xml"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/taskschd/daily-trigger-example--xml-",
                "https://github.com/elastic/protections-artifacts/blob/084067123d3328a823b1c3fdde305b694275c794/behavior/rules/persistence_suspicious_scheduled_task_creation_via_masqueraded_xml_file.toml"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1036.005",
                "attack.t1053.005"
            ],
            "title": "Suspicious Scheduled Task Creation via Masqueraded XML File"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/05",
            "description": "Detects the execution of Scheduled Tasks where the Program being run is located in a suspicious location or it's an unusale program to be run from a Scheduled Task",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 129,
                    "Path|contains": [
                        "C:\\Windows\\Temp\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\Desktop\\",
                        "\\Downloads\\",
                        "\\Users\\Public\\",
                        "C:\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "424273ea-7cf8-43a6-b712-375f925e481f",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: The \"Microsoft-Windows-TaskScheduler/Operational\" is disabled by default and needs to be enabled in order for this detection to trigger",
                "product": "windows",
                "service": "taskscheduler"
            },
            "modified": "2023/02/07",
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "title": "Scheduled Task Executed From A Suspicious Location",
            "tags": [
                "attack.persistence",
                "attack.t1053.005"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/05",
            "description": "Detects the execution of Scheduled Tasks where the program being run is located in a suspicious location or where it is an unusual program to be run from a Scheduled Task",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 129,
                    "Path|endswith": [
                        "\\calc.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\mspaint.exe",
                        "\\notepad.exe",
                        "\\regsvr32.exe",
                        "\\wscript.exe"
                    ]
                }
            },
            "falsepositives": [
                "False positives may occur with some of the selected binaries if you have tasks using them (which could be very common in your environment). Exclude all the specific trusted tasks before using this rule"
            ],
            "id": "f0767f15-0fb3-44b9-851e-e8d9a6d0005d",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: The \"Microsoft-Windows-TaskScheduler/Operational\" is disabled by default and needs to be enabled in order for this detection to trigger",
                "product": "windows",
                "service": "taskscheduler"
            },
            "modified": "2023/02/07",
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "title": "Scheduled Task Executed Uncommon LOLBIN",
            "tags": [
                "attack.persistence",
                "attack.t1053.005"
            ]
        },
        {
            "id": "614cf376-6651-47c4-9dcc-6b9527f749f4",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/05",
            "description": "Detects update to a scheduled task event that contain suspicious keywords.",
            "detection": {
                "condition": "all of selection_*",
                "selection_commands": {
                    "TaskContentNew|contains": [
                        "regsvr32",
                        "rundll32",
                        "cmd.exe</Command>",
                        "cmd</Command>",
                        "<Arguments>/c ",
                        "<Arguments>/k ",
                        "<Arguments>/r ",
                        "powershell",
                        "pwsh",
                        "mshta",
                        "wscript",
                        "cscript",
                        "certutil",
                        "bitsadmin",
                        "bash.exe",
                        "bash ",
                        "scrcons",
                        "wmic ",
                        "wmic.exe",
                        "forfiles",
                        "scriptrunner",
                        "hh.exe"
                    ]
                },
                "selection_eid": {
                    "EventID": 4702
                },
                "selection_paths": {
                    "TaskContentNew|contains": [
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\",
                        "\\Users\\Public\\",
                        "\\WINDOWS\\Temp\\",
                        "C:\\Temp\\",
                        "\\Desktop\\",
                        "\\Downloads\\",
                        "\\Temporary Internet",
                        "C:\\ProgramData\\",
                        "C:\\Perflogs\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "definition": "The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.",
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "1c0e41cd-21bb-4433-9acc-4a2cd6367b9b"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Suspicious Scheduled Task Update"
        },
        {
            "id": "f6de6525-4509-495a-8a82-1f8b0ed73a00",
            "author": "Samir Bousseaden",
            "date": "2019/04/03",
            "description": "Detects remote task creation via at.exe or API interacting with ATSVC namedpipe",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Accesses|contains": "WriteData",
                    "EventID": 5145,
                    "RelativeTargetName": "atsvc",
                    "ShareName": "\\\\\\\\\\*\\\\IPC$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "definition": "The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/08/11",
            "references": [
                "https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html"
            ],
            "status": "test",
            "title": "Remote Task Creation via ATSVC Named Pipe",
            "tags": [
                "attack.lateral_movement",
                "attack.persistence",
                "car.2013-05-004",
                "car.2015-04-001",
                "attack.t1053.002"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/05",
            "description": "Detects when adversaries stop services or processes by deleting or disabling their respective scheduled tasks in order to conduct data destructive activities",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_sys_username": {
                    "EventID": 4699,
                    "SubjectUserName|endswith": "$",
                    "TaskName|contains": "\\Windows\\Windows Defender\\"
                },
                "selection": {
                    "EventID": [
                        4699,
                        4701
                    ],
                    "TaskName|contains": [
                        "\\Windows\\SystemRestore\\SR",
                        "\\Windows\\Windows Defender\\",
                        "\\Windows\\BitLocker",
                        "\\Windows\\WindowsBackup\\",
                        "\\Windows\\WindowsUpdate\\",
                        "\\Windows\\UpdateOrchestrator\\Schedule",
                        "\\Windows\\ExploitGuard"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7595ba94-cf3b-4471-aa03-4f6baa9e5fad",
            "level": "high",
            "logsource": {
                "definition": "The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/03/13",
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4699",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4701"
            ],
            "related": [
                {
                    "id": "dbc1f800-0fe0-4bc0-9c66-292c2abe3f78",
                    "type": "similar"
                },
                {
                    "id": "9ac94dc8-9042-493c-ba45-3b5e7c86b980",
                    "type": "similar"
                },
                {
                    "id": "9e3cb244-bdb8-4632-8c90-6079c8f4f16d",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Important Scheduled Task Deleted/Disabled"
        },
        {
            "author": "Samir Bousseaden",
            "date": "2019/04/03",
            "description": "Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Accesses|contains": [
                        "WriteData",
                        "%%4417"
                    ],
                    "EventID": 5145,
                    "RelativeTargetName|endswith": "ScheduledTasks.xml",
                    "ShareName": "\\\\\\\\\\*\\\\SYSVOL"
                }
            },
            "falsepositives": [
                "If the source IP is not localhost then it's super suspicious, better to monitor both local and remote changes to GPO scheduledtasks"
            ],
            "id": "a8f29a7b-b137-4446-80a0-b804272f3da2",
            "level": "high",
            "logsource": {
                "definition": "The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure",
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/11/27",
            "references": [
                "https://twitter.com/menasec1/status/1106899890377052160",
                "https://www.secureworks.com/blog/ransomware-as-a-distraction"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.lateral_movement",
                "attack.t1053.005"
            ],
            "title": "Persistence and Execution at Scale via GPO Scheduled Task"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/05",
            "description": "Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc.",
            "detection": {
                "condition": "all of selection_*",
                "selection_commands": {
                    "TaskContent|contains": [
                        "regsvr32",
                        "rundll32",
                        "cmd.exe</Command>",
                        "cmd</Command>",
                        "<Arguments>/c ",
                        "<Arguments>/k ",
                        "<Arguments>/r ",
                        "powershell",
                        "pwsh",
                        "mshta",
                        "wscript",
                        "cscript",
                        "certutil",
                        "bitsadmin",
                        "bash.exe",
                        "bash ",
                        "scrcons",
                        "wmic ",
                        "wmic.exe",
                        "forfiles",
                        "scriptrunner",
                        "hh.exe"
                    ]
                },
                "selection_eid": {
                    "EventID": 4698
                },
                "selection_paths": {
                    "TaskContent|contains": [
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\",
                        "\\Users\\Public\\",
                        "\\WINDOWS\\Temp\\",
                        "C:\\Temp\\",
                        "\\Desktop\\",
                        "\\Downloads\\",
                        "\\Temporary Internet",
                        "C:\\ProgramData\\",
                        "C:\\Perflogs\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3a734d25-df5c-4b99-8034-af1ddb5883a4",
            "level": "high",
            "logsource": {
                "definition": "The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection. We also recommend extracting the Command field from the embedded XML in the event data.",
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698"
            ],
            "modified": "2022/12/07",
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.privilege_escalation",
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Suspicious Scheduled Task Creation"
        },
        {
            "author": "frack113",
            "date": "2021/12/28",
            "description": "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cimmethod": {
                    "ScriptBlockText|contains|all": [
                        "Invoke-CimMethod",
                        "-ClassName",
                        "PS_ScheduledTask",
                        "-NameSpace",
                        "Root\\Microsoft\\Windows\\TaskScheduler"
                    ]
                },
                "selection_cmdlet": {
                    "ScriptBlockText|contains": [
                        "New-ScheduledTaskAction",
                        "New-ScheduledTaskTrigger",
                        "New-ScheduledTaskPrincipal",
                        "New-ScheduledTaskSettingsSet",
                        "New-ScheduledTask",
                        "Register-ScheduledTask"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "363eccc0-279a-4ccf-a3ab-24c2e63b11fb",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.005/T1053.005.md#atomic-test-4---powershell-cmdlet-scheduled-task",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.005/T1053.005.md#atomic-test-6---wmi-invoke-cimmethod-scheduled-task"
            ],
            "status": "test",
            "title": "Powershell Create Scheduled Task",
            "tags": [
                "attack.persistence",
                "attack.t1053.005"
            ]
        },
        {
            "author": "Syed Hasan (@syedhasan009)",
            "date": "2021/06/18",
            "description": "Monitor the creation of a new key under 'TaskCache' when a new scheduled task is registered by a process that is not svchost.exe, which is suspicious",
            "detection": {
                "condition": "selection and not 1 of filter*",
                "filter": {
                    "TargetObject|contains": [
                        "Microsoft\\Windows\\UpdateOrchestrator",
                        "Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcRestartTask\\Index",
                        "Microsoft\\Windows\\Flighting\\OneSettings\\RefreshCache\\Index"
                    ]
                },
                "filter_dropbox_updater": {
                    "Image": [
                        "C:\\Program Files (x86)\\Dropbox\\Update\\DropboxUpdate.exe",
                        "C:\\Program Files\\Dropbox\\Update\\DropboxUpdate.exe"
                    ]
                },
                "filter_explorer": {
                    "Image": "C:\\Windows\\explorer.exe",
                    "TargetObject|contains": "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\PLA\\Server Manager Performance Monitor\\"
                },
                "filter_msiexec": {
                    "Image": "C:\\Windows\\System32\\msiexec.exe"
                },
                "filter_ngen": {
                    "Image|endswith": "\\ngen.exe",
                    "Image|startswith": "C:\\Windows\\Microsoft.NET\\Framework",
                    "TargetObject|contains": [
                        "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{B66B135D-DA06-4FC4-95F8-7458E1D10129}",
                        "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\.NET Framework\\.NET Framework NGEN"
                    ]
                },
                "filter_office_click_to_run": {
                    "Image": [
                        "C:\\Program Files\\Microsoft Office\\root\\Integration\\Integrator.exe",
                        "C:\\Program Files (x86)\\Microsoft Office\\root\\Integration\\Integrator.exe"
                    ]
                },
                "filter_svchost": {
                    "Image": "C:\\WINDOWS\\system32\\svchost.exe"
                },
                "filter_system": {
                    "Image": "System"
                },
                "filter_tiworker": {
                    "Image|endswith": "\\TiWorker.exe",
                    "Image|startswith": "C:\\Windows\\"
                },
                "selection": {
                    "TargetObject|contains": "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4720b7df-40c3-48fd-bbdf-fd4b3c464f0d",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
                "https://labs.f-secure.com/blog/scheduled-task-tampering/"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053",
                "attack.t1053.005"
            ],
            "title": "Scheduled TaskCache Change by Uncommon Program"
        },
        {
            "id": "73a883d0-0348-4be4-a8d8-51031c2564f8",
            "author": "Lednyov Alexey, oscd.community, Sreeman",
            "date": "2020/10/16",
            "description": "Detects potential persistence behavior using the windows telemetry registry key.\nWindows telemetry makes use of the binary CompatTelRunner.exe to run a variety of commands and perform the actual telemetry collections.\nThis binary was created to be easily extensible, and to that end, it relies on the registry to instruct on which commands to run.\nThe problem is, it will run any arbitrary command without restriction of location or type.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "Details|contains": [
                        "\\system32\\CompatTelRunner.exe",
                        "\\system32\\DeviceCensus.exe"
                    ]
                },
                "selection": {
                    "Details|contains": [
                        ".bat",
                        ".bin",
                        ".cmd",
                        ".dat",
                        ".dll",
                        ".exe",
                        ".hta",
                        ".jar",
                        ".js",
                        ".msi",
                        ".ps",
                        ".sh",
                        ".vb"
                    ],
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController\\",
                    "TargetObject|endswith": "\\Command"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows",
                "definition": "Requirements: Sysmon config that monitors \\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController subkey of the HKLM hives"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/"
            ],
            "related": [
                {
                    "id": "4e8d5fd3-c959-441f-a941-f73d0cdcdca5",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.005"
            ],
            "title": "Potential Registry Persistence Attempt Via Windows Telemetry"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/05",
            "description": "Detects creation of sudoers file or files in \"sudoers.d\" directory which can be used a potential method to persiste privileges for a specific user.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|startswith": "/etc/sudoers.d/"
                }
            },
            "falsepositives": [
                "Creation of legitimate files in sudoers.d folder part of administrator work"
            ],
            "id": "ddb26b76-4447-4807-871f-1b035b2bfa5d",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "modified": "2022/12/31",
            "references": [
                "https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.003"
            ],
            "title": "Persistence Via Sudoers Files"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/05",
            "description": "Detects the creation of \"ebpfbackdoor\" files in both \"cron.d\" and \"sudoers.d\" directories. Which both are related to the TripleCross persistence method",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "ebpfbackdoor"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "1a2ea919-d11d-4d1e-8535-06cda13be20f",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "modified": "2022/12/31",
            "references": [
                "https://github.com/h3xduck/TripleCross/blob/12629558b8b0a27a5488a0b98f1ea7042e76f8ab/apps/deployer.sh"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.defense_evasion",
                "attack.t1053.003"
            ],
            "title": "Triple Cross eBPF Rootkit Default Persistence"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Detects creation of cron file or files in Cron directories which could indicates potential persistence.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "TargetFilename|startswith": [
                        "/etc/cron.d/",
                        "/etc/cron.daily/",
                        "/etc/cron.hourly/",
                        "/etc/cron.monthly/",
                        "/etc/cron.weekly/",
                        "/var/spool/cron/crontabs/"
                    ]
                },
                "selection2": {
                    "TargetFilename|contains": [
                        "/etc/cron.allow",
                        "/etc/cron.deny",
                        "/etc/crontab"
                    ]
                }
            },
            "falsepositives": [
                "Any legitimate cron file."
            ],
            "id": "6c4e2f43-d94d-4ead-b64d-97e53fa2bd05",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "modified": "2022/12/31",
            "references": [
                "https://github.com/microsoft/MSTIC-Sysmon/blob/f1477c0512b0747c1455283069c21faec758e29d/linux/configs/attack-based/persistence/T1053.003_Cron_Activity.xml"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1053.003"
            ],
            "title": "Persistence Via Cron Files"
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/06",
            "description": "Detects the use of at/atd which are utilities that are used to schedule tasks.\nThey are often abused by adversaries to maintain persistence or to perform task scheduling for initial or recurring execution of malicious code\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/at",
                        "/atd"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "d2d642d7-b393-43fe-bae4-e81ed5915c4b",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/07/07",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.002/T1053.002.md"
            ],
            "status": "stable",
            "tags": [
                "attack.persistence",
                "attack.t1053.002"
            ],
            "title": "Scheduled Task/Job At"
        },
        {
            "author": "Alejandro Ortuno, oscd.community",
            "date": "2020/10/06",
            "description": "Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/tmp/",
                    "Image|endswith": "crontab"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "6b14bac8-3e3a-4324-8109-42f0546a347f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1053.003"
            ],
            "title": "Scheduled Cron Task/Job - Linux"
        },
        {
            "author": "Pawel Mazur",
            "date": "2022/04/16",
            "description": "Detects suspicious modification of crontab file.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "REPLACE"
                ]
            },
            "falsepositives": [
                "Legitimate modification of crontab"
            ],
            "id": "af202fd3-7bff-4212-a25a-fb34606cfcbe",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "cron"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md"
            ],
            "status": "test",
            "title": "Modifying Crontab",
            "tags": [
                "attack.persistence",
                "attack.t1053.003"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "Linux",
        "macOS",
        "Containers"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Prashant Verma, Paladion",
        "Leo Loobeek, @leoloobeek",
        "Travis Smith, Tripwire",
        "Alain Homewood, Insomnia Security",
        "Andrew Northern, @ex_raritas",
        "Bryan Campbell, @bry_campbell",
        "Zachary Abzug, @ZackDoesML",
        "Selena Larson, @selenalarson"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "privilege-escalation"
        }
    ],
    "x_mitre_detection": "Monitor scheduled task creation from common utilities using command-line invocation. Legitimate scheduled tasks may be created during installation of new software or through system administration functions. Look for changes to tasks that do not correlate with known software, patch cycles, etc. \n\nSuspicious program execution through scheduled tasks may show up as outlier processes that have not been seen before when compared against historical data. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.3",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Scheduled Job: Scheduled Job Creation",
        "File: File Creation",
        "Process: Process Creation",
        "Container: Container Creation",
        "Command: Command Execution",
        "File: File Modification"
    ],
    "x_mitre_permissions_required": [
        "Administrator",
        "SYSTEM",
        "User"
    ]
}