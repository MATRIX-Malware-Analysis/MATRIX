{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--fed865ce-a79b-4f3f-9fa2-d1a236912af6",
    "created": "2024-08-13T14:46:36.676705Z",
    "modified": "2024-08-13T14:46:36.676705Z",
    "name": "Adversary in the Browser (AiTB)",
    "description": "An adversary exploits security vulnerabilities or inherent functionalities of a web browser, in order to manipulate traffic between two endpoints.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/662.html",
            "external_id": "662"
        },
        {
            "source_name": "CWE",
            "external_id": "300"
        },
        {
            "source_name": "CWE",
            "external_id": "494"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "An adversary conducts a phishing attack and tricks a victim into installing a malicious browser plugin. The adversary then positions themself between the victim and their banking institution. The victim begins by initiating a funds transfer from their personal savings to their personal checking account. Using injected JavaScript, the adversary captures this request and modifies it to transfer an increased amount of funds to an account that they controls, before sending it to the bank. The bank processes the transfer and sends the confirmation notice back to the victim, which is instead intercepted by the adversary. The adversary modifies the confirmation to reflect the original transaction details and sends this modified message back to the victim. Upon receiving the confirmation, the victim assumes the transfer was successful and is unaware that their money has just been transferred to the adversary."
        },
        {
            "description": "In 2020, the Agent Tesla malware was leveraged to conduct AiTB attacks against organizations within the gas, oil, and other energy sectors. The malware was delivered via a spearphishing campaign and has the capability to form-grab, keylog, copy clipboard data, extract credentials, and capture screenshots. [REF-630]"
        },
        {
            "description": "Boy in the browser attacks are a subset of AiTB attacks. Similar to AiTB attacks, the adversary must first trick the victim into installing a Trojan, either via social engineering or drive-by-download attacks. The malware then modifies the victim's \"hosts\" file in order to reroute web traffic from an intended website to an adversary-controlled website that mimics the legitimate website. The adversary is now able to observe, intercept, and/or modify all traffic, as in a traditional Adversary in the Middle attack (CAPEC-94). BiTB attacks are low-cost, easy to execute, and more difficult to detect since the malware often removes itself once the attack has concluded. [REF-631]"
        },
        {
            "description": "Man in the Mobile attacks are a subset of AiTB attacks that target mobile device users. Like AiTB attacks, an adversary convinces a victim to install a Trojan mobile application on their mobile device, often under the guise of security. Once the victim has installed the application, the adversary can capture all SMS traffic to bypass SMS-based out-of-band authentication systems. [REF-632]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "The adversary tricks the victim into installing the Trojan Horse malware onto their system.",
            "phase": "Experiment",
            "step": "1",
            "techniques": [
                "Conduct phishing attacks, drive-by malware installations, or masquerade malicious browser extensions as being legitimate."
            ]
        },
        {
            "description": "The adversary inserts themself into the communication channel initially acting as a routing proxy between the two targeted components.",
            "phase": "Experiment",
            "step": "2",
            "techniques": []
        },
        {
            "description": "The adversary observes, filters, or alters passed data of their choosing to gain access to sensitive information or to manipulate the actions of the two target components for their own purposes.",
            "phase": "Exploit",
            "step": "3",
            "techniques": []
        }
    ],
    "x_mitre_impact": "Very High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Ensure software and applications are only downloaded from legitimate and reputable sources, in addition to conducting integrity checks on the downloaded component."
        },
        {
            "description": "Leverage anti-malware tools, which can detect Trojan Horse malware."
        },
        {
            "description": "Use strong, out-of-band mutual authentication to always fully authenticate both ends of any communications channel."
        },
        {
            "description": "Limit user permissions to prevent browser pivoting."
        },
        {
            "description": "Ensure browser sessions are regularly terminated and when their effective lifetime ends."
        }
    ]
}