{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--f6e0ab41-1bf0-4bcc-9ea1-798678b2704e",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.305894Z",
    "name": "Modify Registry",
    "description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility Reg may be used for local or remote Registry modification. [1] Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via Reg or other utilities using the Win32 API. [2] Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. [3] [4]The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. [5] Often Valid Accounts are required, along with access to the remote system's SMB/Windows Admin Shares for RPC communication.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1112",
            "external_id": "T1112"
        },
        {
            "source_name": "CAPEC 203",
            "external_id": "malware-behavior--a9869766-8217-45ff-97e9-7f55f93a3282"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1112",
            "external_id": "T1112"
        },
        {
            "source_name": "Microsoft Reg",
            "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.",
            "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx"
        },
        {
            "source_name": "Microsoft Remote",
            "description": "Microsoft. (n.d.). Enable the Remote Registry Service. Retrieved May 1, 2015.",
            "url": "https://technet.microsoft.com/en-us/library/cc754820.aspx"
        },
        {
            "source_name": "Microsoft 4657 APR 2017",
            "description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4657(S): A registry value was modified. Retrieved August 9, 2018.",
            "url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4657"
        },
        {
            "source_name": "SpectorOps Hiding Reg Jul 2017",
            "description": "Reitz, B. (2017, July 14). Hiding Registry keys with PSReflect. Retrieved August 9, 2018.",
            "url": "https://posts.specterops.io/hiding-registry-keys-with-psreflect-b18ec5ac8353"
        },
        {
            "source_name": "Microsoft Reghide NOV 2006",
            "description": "Russinovich, M. & Sharkey, K. (2006, January 10). Reghide. Retrieved August 9, 2018.",
            "url": "https://docs.microsoft.com/sysinternals/downloads/reghide"
        },
        {
            "source_name": "Microsoft RegDelNull July 2016",
            "description": "Russinovich, M. & Sharkey, K. (2016, July 4). RegDelNull v1.11. Retrieved August 10, 2018.",
            "url": "https://docs.microsoft.com/en-us/sysinternals/downloads/regdelnull"
        },
        {
            "source_name": "TrendMicro POWELIKS AUG 2014",
            "description": "Santos, R. (2014, August 1). POWELIKS: Malware Hides In Windows Registry. Retrieved August 9, 2018.",
            "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-malware-hides-in-windows-registry/"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "ORDeleteKey"
                            },
                            {
                                "api": "ORDeleteValue"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Modify Registry [T1112]"
                    ],
                    "authors": [
                        "johnk3r"
                    ],
                    "mbc": [
                        "Operating System::Registry::Delete Registry Key [C0036.002]",
                        "Operating System::Registry::Delete Registry Value [C0036.007]"
                    ],
                    "name": "delete registry key via offline registry library",
                    "namespace": "host-interaction/registry",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "ORCreateHive"
                            },
                            {
                                "api": "ORCreateKey"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Modify Registry [T1112]"
                    ],
                    "authors": [
                        "johnk3r"
                    ],
                    "examples": [
                        "5fbbfeed28b258c42e0cfeb16718b31c:0x100481A0"
                    ],
                    "mbc": [
                        "Operating System::Registry::Create Registry Key [C0036.004]"
                    ],
                    "name": "create registry key via offline registry library",
                    "namespace": "host-interaction/registry",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "ORSetValue"
                            },
                            {
                                "optional": [
                                    {
                                        "api": "ORSaveHive"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Modify Registry [T1112]"
                    ],
                    "authors": [
                        "johnk3r"
                    ],
                    "examples": [
                        "5fbbfeed28b258c42e0cfeb16718b31c:0x43A6C8"
                    ],
                    "mbc": [
                        "Operating System::Registry::Set Registry Key [C0036.001]"
                    ],
                    "name": "set registry key via offline registry library",
                    "namespace": "host-interaction/registry",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "optional": [
                                    {
                                        "match": "create or open registry key"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "api": "advapi32.RegDeleteValue"
                                    },
                                    {
                                        "api": "advapi32.RegDeleteKeyValue"
                                    },
                                    {
                                        "api": "ZwDeleteValueKey"
                                    },
                                    {
                                        "api": "NtDeleteValueKey"
                                    },
                                    {
                                        "api": "RtlDeleteRegistryValue"
                                    },
                                    {
                                        "api": "SHDeleteValue"
                                    },
                                    {
                                        "api": "SHRegDeleteUSValue"
                                    },
                                    {
                                        "api": "Microsoft.Win32.RegistryKey::DeleteValue"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Modify Registry [T1112]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "examples": [
                        "B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4041A0"
                    ],
                    "mbc": [
                        "Operating System::Registry::Delete Registry Value [C0036.007]"
                    ],
                    "name": "delete registry value",
                    "namespace": "host-interaction/registry/delete",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "optional": [
                                    {
                                        "match": "create or open registry key"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "api": "advapi32.RegDeleteKey"
                                    },
                                    {
                                        "api": "advapi32.RegDeleteTree"
                                    },
                                    {
                                        "api": "advapi32.RegDeleteKeyEx"
                                    },
                                    {
                                        "api": "advapi32.RegDeleteKeyTransacted"
                                    },
                                    {
                                        "api": "ZwDeleteKey"
                                    },
                                    {
                                        "api": "NtDeleteKey"
                                    },
                                    {
                                        "api": "SHDeleteKey"
                                    },
                                    {
                                        "api": "SHDeleteEmptyKey"
                                    },
                                    {
                                        "api": "SHRegDeleteEmptyUSKey"
                                    },
                                    {
                                        "api": "Microsoft.Win32.RegistryKey::DeleteSubKey"
                                    },
                                    {
                                        "api": "Microsoft.Win32.RegistryKey::DeleteSubKeyTree"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Modify Registry [T1112]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "michael.hunhoff@mandiant.com",
                        "johnk3r"
                    ],
                    "examples": [
                        "4f11bdb380dafa2518053c6d20147a05:0x402A36",
                        "493167E85E45363D09495D0841C30648:0x404D60"
                    ],
                    "mbc": [
                        "Operating System::Registry::Delete Registry Key [C0036.002]"
                    ],
                    "name": "delete registry key",
                    "namespace": "host-interaction/registry/delete",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Sagie Dulce, Dekel Paz",
            "date": "2022/01/01",
            "description": "Detects remote RPC calls to modify the registry and possible execute code",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "EventLog": "RPCFW",
                    "InterfaceUuid": "338cd001-2244-31f1-aaaa-900038001003",
                    "OpNum": [
                        6,
                        7,
                        8,
                        13,
                        18,
                        19,
                        21,
                        22,
                        23,
                        35
                    ]
                }
            },
            "falsepositives": [
                "Remote administration of registry values"
            ],
            "id": "35c55673-84ca-4e99-8d09-e334f3c29539",
            "level": "high",
            "logsource": {
                "category": "application",
                "definition": "Requirements: install and apply the RPC Firewall to all processes with \"audit:true action:block uuid:338cd001-2244-31f1-aaaa-900038001003\"",
                "product": "rpc_firewall"
            },
            "modified": "2022/01/01",
            "references": [
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/0fa3191d-bb79-490a-81bd-54c2601b7a78",
                "https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-RRP.md",
                "https://github.com/zeronetworks/rpcfirewall",
                "https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1112"
            ],
            "title": "Remote Registry Lateral Movement"
        },
        {
            "author": "frack113",
            "date": "2023/09/15",
            "description": "Detects file access requests to files ending with either the \".hive\"/\".reg\" extension, usually associated with Windows Registry backups.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "selection": {
                    "FileName|endswith": [
                        ".hive",
                        ".reg"
                    ]
                }
            },
            "falsepositives": [
                "Third party software installed in the user context might generate a lot of FPs. Heavy baselining and tuning might be required."
            ],
            "id": "337a31c6-46c4-46be-886a-260d7aa78cac",
            "level": "low",
            "logsource": {
                "category": "file_access",
                "definition": "Requirements: Microsoft-Windows-Kernel-File ETW provider",
                "product": "windows"
            },
            "references": [
                "https://github.com/tccontre/Reg-Restore-Persistence-Mole"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1112",
                "attack.defense_evasion"
            ],
            "title": "Access To .Reg/.Hive Files By Uncommon Application"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/12/15",
            "description": "Detects changes to the \"NoLMHash\" registry value in order to allow Windows to store LM Hashes.\nBy setting this registry value to \"0\" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "\\System\\CurrentControlSet\\Control\\Lsa",
                        "NoLMHash",
                        " 0"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "98dedfdd-8333-49d4-9f23-d7018cccae53",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/22",
            "references": [
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a",
                "https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password",
                "https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/"
            ],
            "related": [
                {
                    "id": "c420410f-c2d8-4010-856b-dffe21866437",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Enable LM Hash Storage - ProcCreation"
        },
        {
            "author": "Teymur Kheirkhabarov (idea), Ryan Plas (rule), oscd.community",
            "date": "2020/10/05",
            "description": "Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry",
            "detection": {
                "condition": "(reg or powershell) and select_data",
                "powershell": {
                    "CommandLine|contains": [
                        "powershell",
                        "set-itemproperty",
                        " sp ",
                        "new-itemproperty"
                    ]
                },
                "reg": {
                    "CommandLine|contains|all": [
                        "reg ",
                        "add"
                    ]
                },
                "select_data": {
                    "CommandLine|contains": [
                        "ImagePath",
                        "FailureCommand",
                        "ServiceDLL"
                    ],
                    "CommandLine|contains|all": [
                        "ControlSet",
                        "Services"
                    ],
                    "IntegrityLevel": "Medium"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "EventID",
                "IntegrityLevel",
                "CommandLine"
            ],
            "id": "8f02c935-effe-45b3-8fc9-ef8696a9e41d",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/07/07",
            "status": "test",
            "references": [
                "https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-20-638.jpg"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Non-privileged Usage of Reg or Powershell"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/05/08",
            "description": "Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "/config",
                        "/serverlevelplugindll"
                    ],
                    "Image|endswith": "\\dnscmd.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f63b56ee-3f79-4b8a-97fb-5c48007e8573",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/05",
            "references": [
                "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83",
                "https://blog.3or.de/hunting-dns-server-level-plugin-dll-injection.html"
            ],
            "related": [
                {
                    "id": "e61e8a88-59a9-451c-874e-70fcc9740d67",
                    "type": "derived"
                },
                {
                    "id": "cbe51394-cd93-4473-b555-edf0144952d9",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1574.002",
                "attack.t1112"
            ],
            "title": "New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE"
        },
        {
            "author": "Eli Salem, Sander Wiebing, oscd.community",
            "date": "2020/10/08",
            "description": "Detects the execution of regini.exe which can be used to modify registry keys, the changes are imported from one or more text files.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "CommandLine|re": ":[^ \\\\]"
                },
                "selection": [
                    {
                        "Image|endswith": "\\regini.exe"
                    },
                    {
                        "OriginalFileName": "REGINI.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate modification of keys"
            ],
            "fields": [
                "ParentImage",
                "CommandLine"
            ],
            "id": "5f60740a-f57b-4e76-82a1-15b6ff2cb134",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Regini/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regini"
            ],
            "tags": [
                "attack.t1112",
                "attack.defense_evasion"
            ],
            "related": [
                {
                    "id": "77946e79-97f1-45a2-84b4-f37b5c0d8682",
                    "type": "derived"
                }
            ],
            "title": "Registry Modification Via Regini.EXE"
        },
        {
            "author": "Oddvar Moe, Sander Wiebing, oscd.community",
            "date": "2020/10/12",
            "description": "Detects the import of a alternate datastream to the registry with regedit.exe.",
            "detection": {
                "condition": "all of selection_* and not filter",
                "filter": {
                    "CommandLine|contains|windash": [
                        " -e ",
                        " -a ",
                        " -c "
                    ]
                },
                "selection_cli": {
                    "CommandLine|contains": [
                        " /i ",
                        ".reg"
                    ],
                    "CommandLine|re": ":[^ \\\\]"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\regedit.exe"
                    },
                    {
                        "OriginalFileName": "REGEDIT.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ParentImage",
                "CommandLine"
            ],
            "id": "0b80ade5-6997-4b1d-99a1-71701778ea61",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "tags": [
                "attack.t1112",
                "attack.defense_evasion"
            ],
            "related": [
                {
                    "id": "73bba97f-a82d-42ce-b315-9182e76c57b1",
                    "type": "similar"
                }
            ],
            "title": "Imports Registry Key From an ADS"
        },
        {
            "id": "73bba97f-a82d-42ce-b315-9182e76c57b1",
            "author": "Oddvar Moe, Sander Wiebing, oscd.community",
            "date": "2020/10/07",
            "description": "Detects the import of the specified file to the registry with regedit.exe.",
            "detection": {
                "condition": "all of selection_* and not all of filter_*",
                "filter_1": {
                    "CommandLine|contains|windash": [
                        " -e ",
                        " -a ",
                        " -c "
                    ]
                },
                "filter_2": {
                    "CommandLine|re": ":[^ \\\\]"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\regedit.exe"
                    },
                    {
                        "OriginalFileName": "REGEDIT.EXE"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains": [
                        " /i ",
                        " /s ",
                        ".reg"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate import of keys",
                "Evernote"
            ],
            "fields": [
                "ParentImage",
                "CommandLine"
            ],
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2024/03/13",
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "tags": [
                "attack.t1112",
                "attack.defense_evasion"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "0b80ade5-6997-4b1d-99a1-71701778ea61"
                }
            ],
            "title": "Imports Registry Key From a File"
        },
        {
            "id": "77946e79-97f1-45a2-84b4-f37b5c0d8682",
            "author": "Eli Salem, Sander Wiebing, oscd.community",
            "date": "2020/10/12",
            "description": "Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys.",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "Image|endswith": "\\regini.exe"
                    },
                    {
                        "OriginalFileName": "REGINI.EXE"
                    }
                ],
                "selection_re": {
                    "CommandLine|re": ":[^ \\\\]"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ParentImage",
                "CommandLine"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Regini/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regini"
            ],
            "tags": [
                "attack.t1112",
                "attack.defense_evasion"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "5f60740a-f57b-4e76-82a1-15b6ff2cb134"
                }
            ],
            "title": "Suspicious Registry Modification From ADS Via Regini.EXE"
        },
        {
            "author": "frack113, Nasreddine Bencherchali",
            "date": "2022/08/01",
            "description": "Detects the import of '.reg' files from suspicious paths using the 'reg.exe' utility",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": " import "
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        "C:\\Users\\",
                        "%temp%",
                        "%tmp%",
                        "%appdata%",
                        "\\AppData\\Local\\Temp\\",
                        "C:\\Windows\\Temp\\",
                        "C:\\ProgramData\\"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate import of keys"
            ],
            "id": "62e0298b-e994-4189-bc87-bc699aa62d97",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/02/05",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-import"
            ],
            "related": [
                {
                    "id": "73bba97f-a82d-42ce-b315-9182e76c57b1",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.t1112",
                "attack.defense_evasion"
            ],
            "title": "Potential Suspicious Registry File Imported Via Reg.EXE"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/19",
            "description": "Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys",
            "detection": {
                "condition": "all of selection_*",
                "selection_path": {
                    "CommandLine|contains": [
                        "\\AppDataLow\\Software\\Microsoft\\",
                        "\\Policies\\Microsoft\\Windows\\OOBE",
                        "\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
                        "\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon",
                        "\\CurrentControlSet\\Control\\SecurityProviders\\WDigest",
                        "\\Microsoft\\Windows Defender\\"
                    ]
                },
                "selection_reg": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Rare legitimate add to registry via cli (to these locations)"
            ],
            "id": "b7e2a8d4-74bb-4b78-adc9-3f92af2d4829",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/10",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md",
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md",
                "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562.001"
            ],
            "title": "Reg Add Suspicious Paths"
        },
        {
            "author": "Avneet Singh @v3t0_, oscd.community, Christopher Peacock @SecurePeacock (updated)",
            "date": "2020/10/18",
            "description": "This rule detects the execution of Run Once task as configured in the registry",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": [
                    {
                        "CommandLine|contains": "/AlternateShellStartup"
                    },
                    {
                        "CommandLine|endswith": "/r"
                    }
                ],
                "selection_img": [
                    {
                        "Image|endswith": "\\runonce.exe"
                    },
                    {
                        "Description": "Run Once Wrapper"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "198effb6-6c98-4d0c-9ea3-451fa143c45c",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/13",
            "references": [
                "https://twitter.com/pabraeken/status/990717080805789697",
                "https://lolbas-project.github.io/lolbas/Binaries/Runonce/",
                "https://twitter.com/0gtweet/status/1602644163824156672?s=20&t=kuxbUnZPltpvFPZdCrqPXA"
            ],
            "status": "test",
            "title": "Run Once Task Execution as Configured in Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/02/01",
            "description": "Detects actions that clear the local ShimCache and remove forensic evidence",
            "detection": {
                "condition": "( selection1a and selection1b ) or ( selection2a and selection2b )",
                "selection1a": {
                    "CommandLine|contains|all": [
                        "rundll32",
                        "apphelp.dll"
                    ]
                },
                "selection1b": {
                    "CommandLine|contains": [
                        "ShimFlushCache",
                        "#250"
                    ]
                },
                "selection2a": {
                    "CommandLine|contains|all": [
                        "rundll32",
                        "kernel32.dll"
                    ]
                },
                "selection2b": {
                    "CommandLine|contains": [
                        "BaseFlushAppcompatCache",
                        "#46"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "Image",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "b0524451-19af-4efa-a46f-562a977f792e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://medium.com/@blueteamops/shimcache-flush-89daff28d15e"
            ],
            "status": "stable",
            "title": "ShimCache Flush",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "frack113",
            "date": "2023/01/13",
            "description": "Detects changes to the \"DisableRestrictedAdmin\" registry value in order to disable or enable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "\\System\\CurrentControlSet\\Control\\Lsa\\",
                        "DisableRestrictedAdmin"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "28ac00d6-22d9-4a3c-927f-bbd770104573",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md",
                "https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx"
            ],
            "related": [
                {
                    "id": "d6ce7ebd-260b-4323-9768-a9631c8d4db2",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "RestrictedAdminMode Registry Value Tampering - ProcCreation"
        },
        {
            "author": "pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport",
            "date": "2022/02/12",
            "description": "Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values",
            "detection": {
                "condition": "all of selection_main_* and 1 of selection_values_*",
                "selection_main_cli": {
                    "CommandLine|contains|all": [
                        " add ",
                        "\\CurrentControlSet\\Control\\Terminal Server",
                        "REG_DWORD",
                        " /f"
                    ]
                },
                "selection_main_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ],
                "selection_values_1": {
                    "CommandLine|contains|all": [
                        "Licensing Core",
                        "EnableConcurrentSessions"
                    ]
                },
                "selection_values_2": {
                    "CommandLine|contains": [
                        "WinStations\\RDP-Tcp",
                        "MaxInstanceCount",
                        "fEnableWinStation",
                        "TSUserEnabled",
                        "TSEnabled",
                        "TSAppCompat",
                        "IdleWinStationPoolCount",
                        "TSAdvertise",
                        "AllowTSConnections",
                        "fSingleSessionPerUser",
                        "fDenyTSConnections"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0d5675be-bc88-4172-86d3-1e96a4476536",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/05",
            "references": [
                "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.lateral_movement",
                "attack.t1021.001",
                "attack.t1112"
            ],
            "title": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE"
        },
        {
            "author": "Stephen Lincoln @slincoln-aiq (AttackIQ)",
            "date": "2023/12/21",
            "description": "Detects the execution of \"reg.exe\" to alter registry keys that would replace the user's desktop background.\nThis is a common technique used by malware to change the desktop background to a ransom note or other image.\n",
            "detection": {
                "condition": "all of selection_reg_* and selection_keys and 1 of selection_cli_reg_*",
                "selection_cli_reg_1": {
                    "CommandLine|contains|all": [
                        "/v NoChangingWallpaper",
                        "/d 1"
                    ]
                },
                "selection_cli_reg_2": {
                    "CommandLine|contains|all": [
                        "/v Wallpaper",
                        "/t REG_SZ"
                    ]
                },
                "selection_cli_reg_3": {
                    "CommandLine|contains|all": [
                        "/v WallpaperStyle",
                        "/d 2"
                    ]
                },
                "selection_keys": {
                    "CommandLine|contains": [
                        "Control Panel\\Desktop",
                        "CurrentVersion\\Policies\\ActiveDesktop",
                        "CurrentVersion\\Policies\\System"
                    ]
                },
                "selection_reg_flag": {
                    "CommandLine|contains": "add"
                },
                "selection_reg_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Administrative scripts that change the desktop background to a company logo or other image."
            ],
            "id": "8cbc9475-8d05-4e27-9c32-df960716c701",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://www.attackiq.com/2023/09/20/emulating-rhysida/",
                "https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/",
                "https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html",
                "https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI"
            ],
            "related": [
                {
                    "id": "85b88e05-dadc-430b-8a9e-53ff1cd30aae",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1112",
                "attack.t1491.001"
            ],
            "title": "Potentially Suspicious Desktop Background Change Using Reg.EXE"
        },
        {
            "author": "Konstantin Grishchenko, oscd.community",
            "date": "2020/10/06",
            "description": "Detect VBoxDrvInst.exe run with parameters allowing processing INF file.\nThis allows to create values in the registry and install drivers.\nFor example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "driver",
                        "executeinf"
                    ],
                    "Image|endswith": "\\VBoxDrvInst.exe"
                }
            },
            "falsepositives": [
                "Legitimate use of VBoxDrvInst.exe utility by VirtualBox Guest Additions installation process"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "b7b19cb6-9b32-4fc4-a108-73f19acfe262",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OtherBinaries/VBoxDrvInst.yml",
                "https://twitter.com/pabraeken/status/993497996179492864"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Suspicious VBoxDrvInst.exe Parameters"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/06/05",
            "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_complus": {
                    "EventID": 4657,
                    "NewValue": 0,
                    "ObjectName|contains": "\\Environment",
                    "ObjectValueName": [
                        "COMPlus_ETWEnabled",
                        "COMPlus_ETWFlags"
                    ]
                },
                "selection_etw_enabled": {
                    "EventID": 4657,
                    "NewValue": 0,
                    "ObjectName|endswith": "\\SOFTWARE\\Microsoft\\.NETFramework",
                    "ObjectValueName": "ETWEnabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc",
            "level": "high",
            "logsource": {
                "service": "security",
                "product": "windows"
            },
            "modified": "2022/12/20",
            "references": [
                "https://twitter.com/_xpn_/status/1268712093928378368",
                "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
                "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
                "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
                "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
                "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
                "https://bunnyinside.com/?term=f71e8cb9c76a",
                "http://managed670.rssing.com/chan-5590147/all_p1.html",
                "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
                "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
            ],
            "related": [
                {
                    "id": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ],
            "title": "ETW Logging Disabled In .NET Processes - Registry"
        },
        {
            "author": "Florian Roth (Nextron Systems), wagga",
            "date": "2018/03/20",
            "description": "Detects NetNTLM downgrade attack",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4657,
                    "ObjectName|contains|all": [
                        "\\REGISTRY\\MACHINE\\SYSTEM",
                        "ControlSet",
                        "\\Control\\Lsa"
                    ],
                    "ObjectValueName": [
                        "LmCompatibilityLevel",
                        "NtlmMinClientSec",
                        "RestrictSendingNTLMTraffic"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d3abac66-f11c-4ed0-8acb-50cc29c97eed",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Policy : Object Access > Audit Registry (Success)",
                "service": "security",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks"
            ],
            "related": [
                {
                    "id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1112"
            ],
            "title": "NetNTLM Downgrade Attack"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/07/14",
            "description": "Potential threat actor tampering with Sysmon manifest and eventually disabling it",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "EventID": 4657,
                    "NewValue": 0,
                    "ObjectName|contains": [
                        "WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                        "WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational"
                    ],
                    "ObjectValueName": "Enabled"
                },
                "selection2": {
                    "AccessMask": 65536,
                    "EventID": 4663,
                    "ObjectName|contains": [
                        "WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                        "WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc",
            "level": "high",
            "logsource": {
                "service": "security",
                "product": "windows"
            },
            "modified": "2022/10/05",
            "references": [
                "https://twitter.com/Flangvik/status/1283054508084473861",
                "https://twitter.com/SecurityJosh/status/1283027365770276866",
                "https://securityjosh.github.io/2020/04/23/Mute-Sysmon.html",
                "https://gist.github.com/Cyb3rWard0g/cf08c38c61f7e46e8404b38201ca01c8"
            ],
            "status": "test",
            "title": "Sysmon Channel Reference Deletion",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Trent Liffick",
            "date": "2020/05/08",
            "description": "Detects the presence of a registry key created during Azorult execution",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        12,
                        13
                    ],
                    "TargetObject|contains": "SYSTEM\\",
                    "TargetObject|endswith": "\\services\\localNETService"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "Image",
                "TargetObject",
                "TargetDetails"
            ],
            "id": "f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7",
            "level": "critical",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.azoruit.a"
            ],
            "tags": [
                "attack.execution",
                "attack.t1112"
            ],
            "title": "Registry Entries For Azorult Malware"
        },
        {
            "author": "Alexander Rausch",
            "date": "2020/06/24",
            "description": "Detects actions caused by the RedMimicry Winnti playbook",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "HKLM\\SOFTWARE\\Microsoft\\HTMLHelp\\data"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5b175490-b652-4b02-b1de-5b5b4083c5f8",
            "level": "high",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "references": [
                "https://redmimicry.com"
            ],
            "modified": "2021/11/27",
            "status": "test",
            "title": "RedMimicry Winnti Playbook Registry Manipulation",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Ilyas Ochkov, oscd.community",
            "date": "2019/10/25",
            "description": "Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "EventType": "CreateKey",
                        "TargetObject": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"
                    },
                    {
                        "NewName": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "EventID",
                "Image",
                "TargetObject",
                "NewName"
            ],
            "id": "919f2ef0-be2d-4a7a-b635-eb2b41fde044",
            "level": "high",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://twitter.com/0gtweet/status/1182516740955226112"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1112"
            ],
            "title": "Disable Security Events Logging Adding Reg Key MiniNt"
        },
        {
            "id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
            "author": "Florian Roth (Nextron Systems), wagga",
            "date": "2018/03/20",
            "description": "Detects NetNTLM downgrade attack",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains|all": [
                        "SYSTEM\\",
                        "ControlSet",
                        "\\Control\\Lsa"
                    ],
                    "TargetObject|endswith": [
                        "\\lmcompatibilitylevel",
                        "\\NtlmMinClientSec",
                        "\\RestrictSendingNTLMTraffic"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "modified": "2022/11/29",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "references": [
                "https://web.archive.org/web/20171113231705/https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks"
            ],
            "status": "test",
            "title": "NetNTLM Downgrade Attack - Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1112"
            ]
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2019/08/25",
            "description": "Detects potential malicious modification of the property value of IsCredGuardEnabled from\nHKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to disable Cred Guard on a system.\nThis is usually used with UseLogonCredential to manipulate the caching credentials.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "\\IsCredGuardEnabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1a2d6c47-75b0-45bd-b133-2c0be75349fd",
            "level": "high",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "references": [
                "https://teamhydra.blog/2020/08/25/bypassing-credential-guard/"
            ],
            "modified": "2021/11/27",
            "status": "test",
            "title": "Wdigest CredGuard Registry Modification",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Hieu Tran",
            "date": "2023/03/13",
            "description": "Detects a registry key used by IceID in a campaign that distributes malicious OneNote files",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "\\Software\\firm\\soft\\Name"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1c8e96cd-2bed-487d-9de0-b46c90cade56",
            "level": "high",
            "references": [
                "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
            ],
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "status": "test",
            "title": "Potential Qakbot Registry Activity",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Avneet Singh @v3t0_, oscd.community",
            "date": "2020/11/15",
            "description": "Rule to detect the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_chrome": {
                    "Details|contains|all": [
                        "C:\\Program Files\\Google\\Chrome\\Application\\",
                        "\\Installer\\chrmstp.exe\" --configure-user-settings --verbose-logging --system-level"
                    ]
                },
                "filter_optional_edge": {
                    "Details|contains": [
                        "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\",
                        "C:\\Program Files\\Microsoft\\Edge\\Application\\"
                    ],
                    "Details|endswith": "\\Installer\\setup.exe\" --configure-user-settings --verbose-logging --system-level --msedge --channel=stable"
                },
                "selection": {
                    "TargetObject|contains": "\\Microsoft\\Active Setup\\Installed Components",
                    "TargetObject|endswith": "\\StubPath"
                }
            },
            "falsepositives": [
                "Legitimate modification of the registry key by legitimate program"
            ],
            "id": "c74d7efc-8826-45d9-b8bb-f04fac9e4eff",
            "level": "medium",
            "modified": "2024/03/25",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "references": [
                "https://twitter.com/pabraeken/status/990717080805789697",
                "https://lolbas-project.github.io/lolbas/Binaries/Runonce/"
            ],
            "status": "test",
            "title": "Run Once Task Configuration in Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Christopher Peacock",
            "date": "2021/10/07",
            "description": "Detects registry keys related to NetWire RAT",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "CreateKey",
                    "TargetObject|contains": "\\software\\NetWire"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1d218616-71b0-4c40-855b-9dbe75510f7f",
            "level": "high",
            "logsource": {
                "category": "registry_add",
                "product": "windows"
            },
            "modified": "2023/02/07",
            "references": [
                "https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing",
                "https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/",
                "https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/",
                "https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line",
                "https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/"
            ],
            "status": "test",
            "title": "Potential NetWire RAT Activity - Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "Detects any deletion of entries in \".*\\shell\\open\\command\" registry keys.\nThese registry keys might have been used for COM hijacking activities by a threat actor or an attacker and the deletion could indicate steps to remove its tracks.\n",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_dropbox": {
                    "Image|endswith": "\\Dropbox.exe",
                    "TargetObject|contains": "\\Dropbox."
                },
                "filter_everything": {
                    "Image|endswith": "\\Everything.exe",
                    "TargetObject|contains": "\\Everything."
                },
                "filter_integrator": {
                    "Image": "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                },
                "filter_java": {
                    "Image|endswith": "\\installer.exe",
                    "Image|startswith": "C:\\Program Files (x86)\\Java\\",
                    "TargetObject|contains": "\\Classes\\WOW6432Node\\CLSID\\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}"
                },
                "filter_office": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                },
                "filter_opera": {
                    "Image|endswith": "\\installer.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Opera\\",
                        "C:\\Program Files (x86)\\Opera\\"
                    ]
                },
                "filter_peazip": {
                    "Image|contains": "peazip",
                    "TargetObject|contains": "\\PeaZip."
                },
                "filter_svchost": {
                    "Image": "C:\\Windows\\system32\\svchost.exe"
                },
                "filter_uninstallers": {
                    "Image|startswith": "C:\\Windows\\Installer\\MSI"
                },
                "filter_wireshark": {
                    "Image|endswith": "\\AppData\\Local\\Temp\\Wireshark_uninstaller.exe",
                    "TargetObject|contains": "\\wireshark-capture-file\\"
                },
                "selection": {
                    "EventType": "DeleteKey",
                    "TargetObject|endswith": "\\shell\\open\\command"
                }
            },
            "falsepositives": [
                "Legitimate software (un)installations are known to cause some false positives. Please add them as a filter when encountered"
            ],
            "id": "96f697b0-b499-4e5d-9908-a67bec11cdb6",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/01/19",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/7",
                "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.C.1_22A46621-7A92-48C1-81BF-B3937EB4FDC3.md",
                "https://learn.microsoft.com/en-us/windows/win32/shell/launch",
                "https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand",
                "https://learn.microsoft.com/en-us/windows/win32/shell/shell-and-managed-code"
            ],
            "status": "test",
            "title": "Removal of Potential COM Hijacking Registry Keys",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/10/19",
            "description": "Detects the deletion of registry keys containing the MSTSC connection history",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "EventType": "DeleteValue",
                    "TargetObject|contains": "\\Microsoft\\Terminal Server Client\\Default\\MRU"
                },
                "selection2": {
                    "EventType": "DeleteKey",
                    "TargetObject|contains": "\\Microsoft\\Terminal Server Client\\Servers\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "07bdd2f5-9c58-4f38-aec8-e101bb79ef8d",
            "level": "high",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/troubleshoot/windows-server/remote/remove-entries-from-remote-desktop-connection-computer",
                "http://woshub.com/how-to-clear-rdp-connections-history/",
                "https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html"
            ],
            "modified": "2023/02/08",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1112"
            ],
            "title": "Terminal Server Client Connection History Cleared - Registry"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems), CrimpSec",
            "date": "2022/03/18",
            "description": "Detects registry modifications that change features of internal Windows tools (malware like Agent Tesla uses this technique)",
            "detection": {
                "condition": "1 of selection_set_*",
                "selection_set_0": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\shutdownwithoutlogon",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\\ToastEnabled",
                        "SYSTEM\\CurrentControlSet\\Control\\Storage\\Write Protection",
                        "SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies\\WriteProtect"
                    ]
                },
                "selection_set_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": [
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\StartMenuLogOff",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableLockWorkstation",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskmgr",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispBackgroundPage",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispCPL",
                        "SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableNotificationCenter",
                        "SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableCMD"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate admin script"
            ],
            "id": "e2482f8d-3443-4237-b906-cc145d87a076",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/11/20",
            "status": "experimental",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md",
                "https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions",
                "https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html",
                "https://www.malwarebytes.com/blog/detections/pum-optional-nodispbackgroundpage",
                "https://www.malwarebytes.com/blog/detections/pum-optional-nodispcpl"
            ],
            "title": "Disable Internal Tools or Feature in Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Samir Bousseaden, David ANDRE, Roberto Rodriguez @Cyb3rWard0g, Nasreddine Bencherchali",
            "date": "2022/08/06",
            "description": "Detects tampering of RDP Terminal Service/Server sensitive settings.\nSuch as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections'...etc\n",
            "detection": {
                "condition": "selection_shadow or selection_terminal_services_key or selection_tamper_only",
                "selection_shadow": {
                    "Details": [
                        "DWORD (0x00000001)",
                        "DWORD (0x00000002)",
                        "DWORD (0x00000003)",
                        "DWORD (0x00000004)"
                    ],
                    "TargetObject|contains": [
                        "\\Control\\Terminal Server\\",
                        "\\Windows NT\\Terminal Services\\"
                    ],
                    "TargetObject|endswith": "\\Shadow"
                },
                "selection_tamper_only": {
                    "TargetObject|contains": [
                        "\\Control\\Terminal Server\\InitialProgram",
                        "\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram",
                        "\\services\\TermService\\Parameters\\ServiceDll",
                        "\\Windows NT\\Terminal Services\\InitialProgram"
                    ]
                },
                "selection_terminal_services_key": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|contains": [
                        "\\Control\\Terminal Server\\",
                        "\\Windows NT\\Terminal Services\\"
                    ],
                    "TargetObject|endswith": [
                        "\\DisableRemoteDesktopAntiAlias",
                        "\\DisableSecuritySettings",
                        "\\fAllowUnsolicited",
                        "\\fAllowUnsolicitedFullControl"
                    ]
                }
            },
            "falsepositives": [
                "Some of the keys mentioned here could be modified by an administrator while setting group policy (it should be investigated either way)"
            ],
            "id": "3f6b7b62-61aa-45db-96bd-9c31b36b653c",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/02/08",
            "references": [
                "https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html",
                "http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/",
                "https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03",
                "https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html",
                "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/",
                "http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/",
                "https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services",
                "https://blog.sekoia.io/darkgate-internals/",
                "https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-63---disable-remote-desktop-anti-alias-setting-through-registry",
                "https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-64---disable-remote-desktop-security-settings-through-registry"
            ],
            "related": [
                {
                    "id": "171b67e1-74b4-460e-8d55-b331f3e32d67",
                    "type": "obsoletes"
                },
                {
                    "id": "41904ebe-d56c-4904-b9ad-7a77bdf154b3",
                    "type": "obsoletes"
                },
                {
                    "id": "a2863fbc-d5cb-48d5-83fb-d976d4b1743b",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1112"
            ],
            "title": "RDP Sensitive Settings Changed"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2019/09/12",
            "description": "Detects potential malicious modification of the property value of UseLogonCredential from HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to enable clear-text credentials",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "WDigest\\UseLogonCredential"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d6a9b252-c666-4de6-8806-5561bbbd3bdc",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/190510-RegModWDigestDowngrade/notebook.html",
                "https://support.microsoft.com/en-us/topic/microsoft-security-advisory-update-to-improve-credentials-protection-and-management-may-13-2014-93434251-04ac-b7f3-52aa-9f951c14b649",
                "https://github.com/redcanaryco/atomic-red-team/blob/73fcfa1d4863f6a4e17f90e54401de6e30a312bb/atomics/T1112/T1112.md#atomic-test-3---modify-registry-to-store-logon-credentials"
            ],
            "status": "test",
            "title": "Wdigest Enable UseLogonCredential",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "id": "85b88e05-dadc-430b-8a9e-53ff1cd30aae",
            "author": "Nasreddine Bencherchali (Nextron Systems), Stephen Lincoln @slincoln-aiq (AttackIQ)",
            "date": "2023/12/21",
            "description": "Detects registry value settings that would replace the user's desktop background.\nThis is a common technique used by malware to change the desktop background to a ransom note or other image.\n",
            "detection": {
                "condition": "selection_keys and 1 of selection_values_* and not 1 of filter_main_*",
                "filter_main_svchost": {
                    "Image|endswith": "\\svchost.exe"
                },
                "selection_keys": {
                    "TargetObject|contains": [
                        "Control Panel\\Desktop",
                        "CurrentVersion\\Policies\\ActiveDesktop",
                        "CurrentVersion\\Policies\\System"
                    ]
                },
                "selection_values_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "NoChangingWallpaper"
                },
                "selection_values_2": {
                    "TargetObject|endswith": "\\Wallpaper"
                },
                "selection_values_3": {
                    "Details": "2",
                    "TargetObject|endswith": "\\WallpaperStyle"
                }
            },
            "falsepositives": [
                "Administrative scripts that change the desktop background to a company logo or other image."
            ],
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://www.attackiq.com/2023/09/20/emulating-rhysida/",
                "https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/",
                "https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html",
                "https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "8cbc9475-8d05-4e27-9c32-df960716c701"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1112",
                "attack.t1491.001"
            ],
            "title": "Potentially Suspicious Desktop Background Change Via Registry"
        },
        {
            "author": "Tobias Michalski (Nextron Systems)",
            "date": "2021/06/09",
            "description": "Detects potential persistence activity via outlook home pages.",
            "detection": {
                "condition": "all of selection_*",
                "selection_1": {
                    "TargetObject|contains": [
                        "\\Software\\Microsoft\\Office\\",
                        "\\Outlook\\WebView\\"
                    ],
                    "TargetObject|endswith": "\\URL"
                },
                "selection_2": {
                    "TargetObject|contains": [
                        "\\Calendar\\",
                        "\\Inbox\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "Details"
            ],
            "id": "ddd171b5-2cc6-4975-9e78-f0eccd08cc76",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "status": "test",
            "references": [
                "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70",
                "https://support.microsoft.com/en-us/topic/outlook-home-page-feature-is-missing-in-folder-properties-d207edb7-aa02-46c5-b608-5d9dbed9bd04?ui=en-us&rs=en-us&ad=us"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1112"
            ],
            "title": "Potential Persistence Via Outlook Home Page"
        },
        {
            "id": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/06/05",
            "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_complus": {
                    "Details": [
                        0,
                        "DWORD (0x00000000)"
                    ],
                    "TargetObject|endswith": [
                        "\\COMPlus_ETWEnabled",
                        "\\COMPlus_ETWFlags"
                    ]
                },
                "selection_etw_enabled": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": "SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/_xpn_/status/1268712093928378368",
                "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
                "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
                "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
                "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
                "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
                "https://bunnyinside.com/?term=f71e8cb9c76a",
                "http://managed670.rssing.com/chan-5590147/all_p1.html",
                "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
                "https://blog.xpnsec.com/hiding-your-dotnet-complus-etwenabled/",
                "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ],
            "title": "ETW Logging Disabled In .NET Processes - Sysmon Registry"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/16",
            "description": "Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom WMI query via \"BgInfo.exe\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|startswith": "6",
                    "EventType": "SetValue",
                    "TargetObject|contains": "\\Software\\Winternals\\BGInfo\\UserFields\\"
                }
            },
            "falsepositives": [
                "Legitimate WMI query"
            ],
            "id": "cd277474-5c52-4423-a52b-ac2d7969902f",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "Internal Research"
            ],
            "related": [
                {
                    "id": "992dd79f-dde8-4bb0-9085-6350ba97cfb3",
                    "type": "similar"
                }
            ],
            "status": "test",
            "title": "New BgInfo.EXE Custom WMI Query Registry Configuration",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/06/21",
            "description": "Detects changes to registry keys related to \"Trusted Location\" of Microsoft Office where the path is set to something uncommon. Attackers might add additional trusted locations to avoid macro security restrictions.",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_exclude_*",
                "filter_exclude_known_paths": {
                    "Details|contains": [
                        "%APPDATA%\\Microsoft\\Templates",
                        "%%APPDATA%%\\Microsoft\\Templates",
                        "%APPDATA%\\Microsoft\\Word\\Startup",
                        "%%APPDATA%%\\Microsoft\\Word\\Startup",
                        ":\\Program Files (x86)\\Microsoft Office\\root\\Templates\\",
                        ":\\Program Files\\Microsoft Office (x86)\\Templates",
                        ":\\Program Files\\Microsoft Office\\root\\Templates\\",
                        ":\\Program Files\\Microsoft Office\\Templates\\"
                    ]
                },
                "filter_main_office_apps": {
                    "Image|contains": [
                        ":\\Program Files\\Microsoft Office\\",
                        ":\\Program Files (x86)\\Microsoft Office\\"
                    ]
                },
                "filter_main_office_click_to_run": {
                    "Image|contains": ":\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                    "Image|endswith": "\\OfficeClickToRun.exe"
                },
                "selection": {
                    "TargetObject|contains": "Security\\Trusted Locations\\Location",
                    "TargetObject|endswith": "\\Path"
                }
            },
            "falsepositives": [
                "Other unknown legitimate or custom paths need to be filtered to avoid false positives"
            ],
            "id": "f742bde7-9528-42e5-bd82-84f51a8387d2",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/09/29",
            "status": "experimental",
            "references": [
                "Internal Research",
                "https://admx.help/?Category=Office2016&Policy=excel16.Office.Microsoft.Policies.Windows::L_TrustedLoc01"
            ],
            "related": [
                {
                    "id": "a0bed973-45fa-4625-adb5-6ecdf9be70ac",
                    "type": "derived"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Uncommon Microsoft Office Trusted Location Added"
        },
        {
            "id": "a2863fbc-d5cb-48d5-83fb-d976d4b1743b",
            "author": "Samir Bousseaden, David ANDRE, Roberto Rodriguez @Cyb3rWard0g, Nasreddine Bencherchali",
            "date": "2022/09/29",
            "description": "Detects tampering of RDP Terminal Service/Server sensitive settings.\nSuch as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections', etc.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\fDenyTSConnections",
                        "\\fSingleSessionPerUser",
                        "\\UserAuthentication"
                    ]
                }
            },
            "falsepositives": [
                "Some of the keys mentioned here could be modified by an administrator while setting group policy (it should be investigated either way)"
            ],
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2022/11/26",
            "references": [
                "https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html",
                "http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/",
                "https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03",
                "https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html",
                "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/",
                "http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/",
                "https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "3f6b7b62-61aa-45db-96bd-9c31b36b653c"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1112"
            ],
            "title": "RDP Sensitive Settings Changed to Zero"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/08",
            "description": "Detects an attacker trying to enable the outlook security setting \"EnableUnsafeClientMailRules\" which allows outlook to run applications or execute macros",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\Outlook\\Security\\EnableUnsafeClientMailRules"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6763c6c8-bd01-4687-bc8d-4fa52cf8ba08",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://support.microsoft.com/en-us/topic/how-to-control-the-rule-actions-to-start-an-application-or-run-a-macro-in-outlook-2016-and-outlook-2013-e4964b72-173c-959d-5d7b-ead562979048",
                "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=44"
            ],
            "related": [
                {
                    "id": "c3cefdf4-6703-4e1c-bad8-bf422fc5015a",
                    "type": "similar"
                },
                {
                    "id": "55f0a3a1-846e-40eb-8273-677371b8d912",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Outlook EnableUnsafeClientMailRules Setting Enabled - Registry"
        },
        {
            "author": "Tobias Michalski (Nextron Systems)",
            "date": "2022/02/24",
            "description": "Detects disabling the CrashDump per registry (as used by HermeticWiper)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "SYSTEM\\CurrentControlSet\\Control\\CrashControl"
                }
            },
            "falsepositives": [
                "Legitimate disabling of crashdumps"
            ],
            "id": "2ff692c2-4594-41ec-8fcb-46587de769e0",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/"
            ],
            "status": "test",
            "tags": [
                "attack.t1564",
                "attack.t1112"
            ],
            "title": "CrashControl CrashDump Disabled"
        },
        {
            "author": "frack113",
            "date": "2022/11/18",
            "description": "Detects changes to the NGenAssemblyUsageLog registry key.\n.NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog CLR configuration knob in the Registry or by configuring an environment variable (as described in the next section).\nBy simplify specifying an arbitrary value (e.g. fake output location or junk data) for the expected value, a Usage Log file for the .NET execution context will not be created.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "SOFTWARE\\Microsoft\\.NETFramework\\NGenAssemblyUsageLog"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "28036918-04d3-423d-91c0-55ecf99fb892",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/"
            ],
            "status": "test",
            "title": "NET NGenAssemblyUsageLog Registry Key Tamper",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "id": "e61e8a88-59a9-451c-874e-70fcc9740d67",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/05/08",
            "description": "Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "\\services\\DNS\\Parameters\\ServerLevelPluginDll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83",
                "https://blog.3or.de/hunting-dns-server-level-plugin-dll-injection.html"
            ],
            "related": [
                {
                    "id": "cbe51394-cd93-4473-b555-edf0144952d9",
                    "type": "derived"
                },
                {
                    "type": "derived",
                    "id": "f63b56ee-3f79-4b8a-97fb-5c48007e8573"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1574.002",
                "attack.t1112"
            ],
            "title": "New DNS ServerLevelPluginDll Installed"
        },
        {
            "author": "Trent Liffick (@tliffick), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/05/22",
            "description": "Detects registry changes to Microsoft Office \"VBAWarning\" to a value of \"1\" which enables the execution of all macros, whether signed or unsigned.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\Security\\VBAWarnings"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "91239011-fe3c-4b54-9f24-15c86bb65913",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/19",
            "references": [
                "https://twitter.com/inversecos/status/1494174785621819397",
                "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/",
                "https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/"
            ],
            "related": [
                {
                    "id": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Office Macros Warning Disabled"
        },
        {
            "id": "992dd79f-dde8-4bb0-9085-6350ba97cfb3",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/16",
            "description": "Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom VBScript via \"BgInfo.exe\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|startswith": "4",
                    "EventType": "SetValue",
                    "TargetObject|contains": "\\Software\\Winternals\\BGInfo\\UserFields\\"
                }
            },
            "falsepositives": [
                "Legitimate VBScript"
            ],
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "Internal Research"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "cd277474-5c52-4423-a52b-ac2d7969902f"
                }
            ],
            "status": "test",
            "title": "New BgInfo.EXE Custom VBScript Registry Configuration",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "id": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/06/21",
            "description": "Detects registry changes to Office trust records where the path is located in a potentially suspicious location",
            "detection": {
                "condition": "all of selection_*",
                "selection_paths": {
                    "TargetObject|contains": [
                        "/AppData/Local/Microsoft/Windows/INetCache/",
                        "/AppData/Local/Temp/",
                        "/PerfLogs/",
                        "C:/Users/Public/",
                        "file:///D:/",
                        "file:///E:/"
                    ]
                },
                "selection_value": {
                    "TargetObject|contains": "\\Security\\Trusted Documents\\TrustRecords"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/inversecos/status/1494174785621819397",
                "Internal Research"
            ],
            "related": [
                {
                    "id": "295a59c1-7b79-4b47-a930-df12c15fc9c2",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Macro Enabled In A Potentially Suspicious Document"
        },
        {
            "author": "frack113",
            "date": "2022/08/19",
            "description": "Detect set Notification_Suppress to 1 to disable the Windows security center notification",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\\Notification_Suppress"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0c93308a-3f1b-40a9-b649-57ea1a1c1d63",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
            ],
            "status": "test",
            "title": "Activate Suppression of Windows Security Center Notifications",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "id": "c420410f-c2d8-4010-856b-dffe21866437",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/12/15",
            "description": "Detects changes to the \"NoLMHash\" registry value in order to allow Windows to store LM Hashes.\nBy setting this registry value to \"0\" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": "System\\CurrentControlSet\\Control\\Lsa\\NoLMHash"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "related": [
                {
                    "type": "similar",
                    "id": "98dedfdd-8333-49d4-9f23-d7018cccae53"
                }
            ],
            "status": "experimental",
            "references": [
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a",
                "https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password",
                "https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/"
            ],
            "title": "Enable LM Hash Storage",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/17",
            "description": "Detects potential registry persistence technique using the Event Viewer \"Events.asp\" technique",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_cleaner": {
                    "Details": "(Empty)"
                },
                "filter_default_redirect_program": {
                    "Details": "%%SystemRoot%%\\PCHealth\\HelpCtr\\Binaries\\HelpCtr.exe",
                    "Image|endswith": "C:\\WINDOWS\\system32\\svchost.exe",
                    "TargetObject|endswith": "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgram"
                },
                "filter_default_redirect_program_cli": {
                    "Details": "-url hcp://services/centers/support?topic=%%s",
                    "Image|endswith": "C:\\WINDOWS\\system32\\svchost.exe",
                    "TargetObject|endswith": "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgramCommandLineParameters"
                },
                "filter_url": {
                    "Details": "http://go.microsoft.com/fwlink/events.asp"
                },
                "selection": {
                    "TargetObject|contains": [
                        "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgram",
                        "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionURL"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a1e11042-a74a-46e6-b07c-c4ce8ecc239b",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/03/05",
            "references": [
                "https://twitter.com/nas_bench/status/1626648985824788480",
                "https://admx.help/?Category=Windows_7_2008R2&Policy=Microsoft.Policies.InternetCommunicationManagement::EventViewer_DisableLinks",
                "https://www.hexacorn.com/blog/2019/02/15/beyond-good-ol-run-key-part-103/",
                "https://github.com/redcanaryco/atomic-red-team/blob/f296668303c29d3f4c07e42bdd2b28d8dd6625f9/atomics/T1112/T1112.md"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Potential Persistence Via Event Viewer Events.asp"
        },
        {
            "author": "frack113",
            "date": "2022/07/17",
            "description": "Detect change of the user account associated with the FAX service to avoid the escalation problem.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Details|contains": "NetworkService"
                },
                "selection": {
                    "TargetObject": "HKLM\\System\\CurrentControlSet\\Services\\Fax\\ObjectName"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e3fdf743-f05b-4051-990a-b66919be1743",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://twitter.com/dottor_morte/status/1544652325570191361",
                "https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf"
            ],
            "status": "test",
            "title": "Change User Account Associated with the FAX Service",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Tobias Michalski (Nextron Systems)",
            "date": "2021/06/10",
            "description": "Detects potential persistence activity via outlook today pages. An attacker can set a custom page to execute arbitrary code and link to it via the registry key \"UserDefinedUrl\".",
            "detection": {
                "condition": "selection_main and 1 of selection_value_* and not 1 of filter_*",
                "selection_main": {
                    "TargetObject|contains|all": [
                        "Software\\Microsoft\\Office\\",
                        "\\Outlook\\Today\\"
                    ]
                },
                "selection_value_stamp": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "Stamp"
                },
                "selection_value_user_defined": {
                    "TargetObject|endswith": "UserDefinedUrl"
                },
                "filter_office": {
                    "Image|endswith": "\\OfficeClickToRun.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                        "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "Details"
            ],
            "id": "487bb375-12ef-41f6-baae-c6a1572b4dd1",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "status": "test",
            "references": [
                "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=74"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1112"
            ],
            "title": "Potential Persistence Via Outlook Today Pages"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/09",
            "description": "Detects changes to the \"ExtErrorInformation\" key in order to disable ETW logging for rpcrt4.dll",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": [
                        "DWORD (0x00000000)",
                        "DWORD (0x00000002)"
                    ],
                    "TargetObject|endswith": "\\Microsoft\\Windows NT\\Rpc\\ExtErrorInformation"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "90f342e1-1aaa-4e43-b092-39fda57ed11e",
            "level": "low",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html"
            ],
            "status": "test",
            "title": "ETW Logging Disabled For rpcrt4.dll",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/03/18",
            "description": "Detects registry modifications that disable internal tools or functions in explorer (malware like Agent Tesla uses this technique)",
            "detection": {
                "condition": "selection_set_1",
                "selection_set_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": [
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoLogOff",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFind",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFileMenu",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetTaskbar",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyDocuments",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoTrayContextMenu"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate admin script"
            ],
            "id": "1c3121ed-041b-4d97-a075-07f54f20fb4a",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md"
            ],
            "status": "test",
            "title": "Registry Explorer Policy Modification",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/16",
            "description": "Detects setting of a new registry database value related to BgInfo configuration. Attackers can for example set this value to save the results of the commands executed by BgInfo in order to exfiltrate information.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "SetValue",
                    "TargetObject|endswith": "\\Software\\Winternals\\BGInfo\\Database"
                }
            },
            "falsepositives": [
                "Legitimate use of external DB to save the results"
            ],
            "id": "53330955-dc52-487f-a3a2-da24dcff99b5",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "title": "New BgInfo.EXE Custom DB Path Registry Configuration",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/08/19",
            "description": "Detect set DisallowRun to 1 to prevent user running specific computer program",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "275641a5-a492-45e2-a817-7c81e9d9d3e9",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
            ],
            "status": "test",
            "title": "Add DisallowRun Execution to Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Trent Liffick (@tliffick)",
            "date": "2020/05/14",
            "description": "Attempts to detect system changes made by Blue Mockingbird",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "\\CurrentControlSet\\Services\\wercplsupport\\Parameters\\ServiceDll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "92b0b372-a939-44ed-a11b-5136cf680e27",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://redcanary.com/blog/blue-mockingbird-cryptominer/"
            ],
            "related": [
                {
                    "id": "c3198a27-23a0-4c2c-af19-e5328d49680e",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1112",
                "attack.t1047"
            ],
            "title": "Blue Mockingbird - Registry"
        },
        {
            "author": "frack113",
            "date": "2022/01/24",
            "description": "BlackByte set three different registry values to escalate privileges and begin setting the stage for lateral movement and encryption",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject": [
                        "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy",
                        "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLinkedConnections",
                        "HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\LongPathsEnabled"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "83314318-052a-4c90-a1ad-660ece38d276",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://redcanary.com/blog/blackbyte-ransomware/?utm_source=twitter&utm_medium=social",
                "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/blackbyte-ransomware-pt-1-in-depth-analysis/"
            ],
            "status": "test",
            "title": "Blackbyte Ransomware Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/08/19",
            "description": "Detect enable rdp feature to allow specific user to rdp connect on the targeted machine",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "System\\CurrentControlSet\\Control\\Terminal Server\\fAllowToGetHelp"
                }
            },
            "falsepositives": [
                "Legitimate use of the feature (alerts should be investigated either way)"
            ],
            "id": "37b437cf-3fc5-4c8e-9c94-1d7c9aff842b",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
            ],
            "status": "test",
            "title": "Allow RDP Remote Assistance Feature",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/22",
            "description": "Detects modification of the registry settings used for Internet Explorer and other Windows components that use these settings. An attacker can abuse this registry key to add a domain to the trusted sites Zone or insert javascript for persistence",
            "detection": {
                "condition": "selection_domains and not 1 of filter_*",
                "filter_accepted_documents": {
                    "TargetObject|contains": "\\Accepted Documents\\"
                },
                "filter_binary": {
                    "Details": "Binary Data"
                },
                "filter_dword": {
                    "Details|startswith": "DWORD"
                },
                "filter_office": {
                    "Details": [
                        "Cookie:",
                        "Visited:",
                        "(Empty)"
                    ]
                },
                "filter_path": {
                    "TargetObject|contains": [
                        "\\Cache",
                        "\\ZoneMap",
                        "\\WpadDecision"
                    ]
                },
                "selection_domains": {
                    "TargetObject|contains": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d88d0ab2-e696-4d40-a2ed-9790064e66b3",
            "level": "low",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-5---javascript-in-registry"
            ],
            "status": "test",
            "title": "Modification of IE Registry Settings",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/09",
            "description": "Detects changes to the \"TracingDisabled\" key in order to disable ETW logging for services.exe (SCM)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "Software\\Microsoft\\Windows NT\\CurrentVersion\\Tracing\\SCM\\Regular\\TracingDisabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4f281b83-0200-4b34-bf35-d24687ea57c2",
            "level": "low",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html"
            ],
            "status": "test",
            "title": "ETW Logging Disabled For SCM",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/09",
            "description": "Detects when the 'AllowMultipleTSSessions' value is enabled.\nWhich allows for multiple Remote Desktop connection sessions to be opened at once.\nThis is often used by attacker as a way to connect to an RDP session without disconnecting the other users\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|endswith": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AllowMultipleTSSessions"
                }
            },
            "falsepositives": [
                "Legitimate use of the multi session functionality"
            ],
            "id": "f7997770-92c3-4ec9-b112-774c4ef96f96",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Winlogon AllowMultipleTSSessions Enable"
        },
        {
            "author": "frack113",
            "date": "2022/08/19",
            "description": "Detect set UseActionCenterExperience to 0 to disable the Windows security center notification",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": "Windows\\CurrentVersion\\ImmersiveShell\\UseActionCenterExperience"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3ae1a046-f7db-439d-b7ce-b8b366b81fa6",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
            ],
            "status": "test",
            "title": "Disable Windows Security Center Notifications",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "id": "d6ce7ebd-260b-4323-9768-a9631c8d4db2",
            "author": "frack113",
            "date": "2023/01/13",
            "description": "Detects changes to the \"DisableRestrictedAdmin\" registry value in order to disable or enable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "System\\CurrentControlSet\\Control\\Lsa\\DisableRestrictedAdmin"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/12/15",
            "status": "experimental",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md",
                "https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "28ac00d6-22d9-4a3c-927f-bbd770104573"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "RestrictedAdminMode Registry Value Tampering"
        },
        {
            "author": "Austin Songer",
            "date": "2021/07/22",
            "description": "Detects when a user enables DNS-over-HTTPS.\nThis can be used to hide internet activity or be used to hide the process of exfiltrating data.\nWith this enabled organization will lose visibility into data such as query type, response and originating IP that are used to determine bad actors.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_chrome": {
                    "Details": "secure",
                    "TargetObject|endswith": "\\SOFTWARE\\Google\\Chrome\\DnsOverHttpsMode"
                },
                "selection_edge": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\SOFTWARE\\Policies\\Microsoft\\Edge\\BuiltInDnsClientEnabled"
                },
                "selection_firefox": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\SOFTWARE\\Policies\\Mozilla\\Firefox\\DNSOverHTTPS\\Enabled"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "04b45a8a-d11d-49e4-9acc-4a1b524407a5",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html",
                "https://github.com/elastic/detection-rules/issues/1371",
                "https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode",
                "https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1140",
                "attack.t1112"
            ],
            "title": "DNS-over-HTTPS Enabled by Registry"
        },
        {
            "author": "frack113",
            "date": "2022/07/17",
            "description": "Detect possible persistence using Fax DLL load when service restart",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Details": "%systemroot%\\system32\\fxst30.dll"
                },
                "selection": {
                    "TargetObject|contains|all": [
                        "\\Software\\Microsoft\\Fax\\Device Providers\\",
                        "\\ImageName"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9e3357ba-09d4-4fbd-a7c5-ad6386314513",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://twitter.com/dottor_morte/status/1544652325570191361",
                "https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf"
            ],
            "status": "test",
            "title": "Change the Fax Dll",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), frack113",
            "date": "2022/05/02",
            "description": "Detect the creation of a service with a service binary located in a suspicious directory",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_*",
                "filter_1": {
                    "Image|contains|all": [
                        "\\Common Files\\",
                        "\\Temp\\"
                    ]
                },
                "selection_1": {
                    "Details": [
                        "DWORD (0x00000000)",
                        "DWORD (0x00000001)",
                        "DWORD (0x00000002)"
                    ],
                    "Image|contains": [
                        "\\Users\\Public\\",
                        "\\Perflogs\\",
                        "\\ADMIN$\\",
                        "\\Temp\\"
                    ],
                    "TargetObject|endswith": "\\Start",
                    "TargetObject|startswith": "HKLM\\System\\CurrentControlSet\\Services\\"
                },
                "selection_2": {
                    "Details|contains": [
                        "\\Users\\Public\\",
                        "\\Perflogs\\",
                        "\\ADMIN$\\",
                        "\\Temp\\"
                    ],
                    "TargetObject|endswith": "\\ImagePath",
                    "TargetObject|startswith": "HKLM\\System\\CurrentControlSet\\Services\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a07f0359-4c90-4dc4-a681-8ffea40b4f47",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
            ],
            "related": [
                {
                    "id": "c0abc838-36b0-47c9-b3b3-a90c39455382",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Service Binary in Suspicious Folder"
        },
        {
            "author": "Dimitrios Slamaris",
            "date": "2017/05/15",
            "description": "Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": [
                        "\\Services\\DHCPServer\\Parameters\\CalloutDlls",
                        "\\Services\\DHCPServer\\Parameters\\CalloutEnabled"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9d3436ef-9476-4c43-acca-90ce06bdf33a",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html",
                "https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx",
                "https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx"
            ],
            "status": "test",
            "title": "DHCP Callout DLL Installation",
            "tags": [
                "attack.defense_evasion",
                "attack.t1574.002",
                "attack.t1112"
            ]
        },
        {
            "author": "@SerkinValery, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/06/12",
            "description": "Detects changes to the ClickOnce trust prompt registry key in order to enable an installation from different locations such as the Internet.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "Enabled",
                    "TargetObject|contains": "\\SOFTWARE\\MICROSOFT\\.NETFramework\\Security\\TrustManager\\PromptingLevel\\",
                    "TargetObject|endswith": [
                        "\\Internet",
                        "\\LocalIntranet",
                        "\\MyComputer",
                        "\\TrustedSites",
                        "\\UntrustedSites"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate internal requirements."
            ],
            "id": "ac9159cc-c364-4304-8f0a-d63fc1a0aabb",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5",
                "https://learn.microsoft.com/en-us/visualstudio/deployment/how-to-configure-the-clickonce-trust-prompt-behavior"
            ],
            "status": "test",
            "title": "ClickOnce Trust Prompt Tampering",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/03/18",
            "description": "Detects registry modifications that hide internal tools or functions from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)",
            "detection": {
                "condition": "1 of selection_set_*",
                "selection_set_0": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowInfoTip",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowCompColor"
                    ]
                },
                "selection_set_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": [
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideClock",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAHealth",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCANetwork",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAPower",
                        "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAVolume"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate admin script"
            ],
            "id": "5a93eb65-dffa-4543-b761-94aa60098fb6",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md"
            ],
            "status": "test",
            "title": "Registry Hide Function from User",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/05/30",
            "description": "Detects potential persistence activity via the registering of a new custom protocole handlers. While legitimate applications register protocole handlers often times during installation. And attacker can abuse this by setting a custom handler to be used as a persistence mechanism.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic_locations": {
                    "Image|startswith": [
                        "C:\\Program Files (x86)",
                        "C:\\Program Files\\",
                        "C:\\Windows\\System32\\",
                        "C:\\Windows\\SysWOW64\\"
                    ]
                },
                "filter_main_ms_trusted": {
                    "Details|startswith": "URL:ms-"
                },
                "selection": {
                    "Details|startswith": "URL:",
                    "TargetObject|startswith": "HKCR\\"
                }
            },
            "falsepositives": [
                "Many legitimate applications can register a new custom protocol handler. Additional filters needs to applied according to your environment."
            ],
            "id": "fdbf0b9d-0182-4c43-893b-a1eaab92d085",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/05/12",
            "references": [
                "https://ladydebug.com/blog/2019/06/21/custom-protocol-handler-cph/"
            ],
            "status": "test",
            "title": "Potential Persistence Via Custom Protocol Handler",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ]
        },
        {
            "author": "Trent Liffick (@tliffick), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/05/22",
            "description": "Detects registry changes to Microsoft Office \"AccessVBOM\" to a value of \"1\" which disables trust access for VBA on the victim machine and lets attackers execute malicious macros without any Microsoft Office warnings.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\Security\\AccessVBOM"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "1a5c46e9-f32f-42f7-b2bc-6e9084db7fbf",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/inversecos/status/1494174785621819397",
                "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/",
                "https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/"
            ],
            "related": [
                {
                    "id": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112"
            ],
            "title": "Trust Access Disable For VBApplications"
        }
    ],
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Bartosz Jerzman",
        "Travis Smith, Tripwire",
        "David Lu, Tripwire"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "x_mitre_detection": "Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\n\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nMonitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.4",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Windows Registry: Windows Registry Key Modification",
        "Process: OS API Execution",
        "Network Traffic: Network Traffic Flow",
        "Command: Command Execution",
        "Windows Registry: Windows Registry Key Deletion",
        "Windows Registry: Windows Registry Key Creation",
        "Process: Process Creation"
    ],
    "x_mitre_permissions_required": []
}