{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--b897667e-8e71-46d4-b7ea-4b532a680e60",
    "created": "2024-08-13T14:46:37.086725Z",
    "modified": "2024-08-13T14:46:45.922605Z",
    "name": "Create Account: Domain Account",
    "description": "Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the net user /add /domain command can be used to create a domain account.[1]Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1136/002",
            "external_id": "T1136/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/21",
            "description": "Detects creation of the PSEXEC key file. Which is created anytime a PsExec command is executed. It gets written to the file system and will be recorded in the USN Journal on the target system",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": ".key",
                    "TargetFilename|startswith": "C:\\Windows\\PSEXEC-"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "304afd73-55a5-4bb9-8c21-0b1fc84ea9e4",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/02/23",
            "references": [
                "https://aboutdfir.com/the-key-to-identify-psexec/",
                "https://twitter.com/davisrichardg/status/1616518800584704028"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.privilege_escalation",
                "attack.execution",
                "attack.persistence",
                "attack.t1136.002",
                "attack.t1543.003",
                "attack.t1570",
                "attack.s0029"
            ],
            "title": "PSEXEC Remote Execution File Artefact"
        },
        {
            "author": "James Pemberton / @4A616D6573",
            "date": "2019/10/31",
            "description": "Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4720,
                    "SamAccountName|contains|all": [
                        "ANONYMOUS",
                        "LOGON"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1bbf25b9-8038-4154-a50b-118f2a32be27",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/10/09",
            "references": [
                "https://twitter.com/SBousseaden/status/1189469425482829824"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.001",
                "attack.t1136.002"
            ],
            "title": "Suspicious Windows ANONYMOUS LOGON Local Account Created"
        },
        {
            "author": "frack113",
            "date": "2021/12/28",
            "description": "Adversaries may create a domain account to maintain access to victim systems.\nDomain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain..\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": "System.DirectoryServices.AccountManagement"
                }
            },
            "falsepositives": [
                "Legitimate administrative script"
            ],
            "id": "b29a93fb-087c-4b5b-a84d-ee3309e69d08",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.002/T1136.002.md#atomic-test-3---create-a-new-domain-account-using-powershell",
                "https://learn.microsoft.com/en-us/dotnet/api/system.directoryservices.accountmanagement?view=net-8.0"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.002"
            ],
            "title": "Manipulation of User Computer or Group Security Principals Across AD"
        }
    ]
}