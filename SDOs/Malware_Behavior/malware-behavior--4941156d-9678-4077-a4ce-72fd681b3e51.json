{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--4941156d-9678-4077-a4ce-72fd681b3e51",
    "created": "2024-08-13T14:46:36.884887Z",
    "modified": "2024-08-13T14:46:44.771301Z",
    "name": "Data Staged: Local Data Staging",
    "description": "Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as Archive Collected Data. Interactive command shells may be used, and common functionality within cmd and bash may be used to copy data into a staging location.Adversaries may also stage collected data in various available formats/locations of a system, including local storage databases/repositories or the Windows Registry.[1]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1074/001",
            "external_id": "T1074/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2021/07/20",
            "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "Compress-Archive -Path*-DestinationPath $env:TEMP",
                        "Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\",
                        "Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md",
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
            ],
            "related": [
                {
                    "id": "71ff406e-b633-4989-96ec-bc49d825a412",
                    "type": "similar"
                },
                {
                    "id": "daf7eb81-35fd-410d-9d7a-657837e602bb",
                    "type": "similar"
                },
                {
                    "id": "b7a3c9a3-09ea-4934-8864-6a32cacd98d9",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1074.001"
            ],
            "title": "Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet"
        },
        {
            "id": "71ff406e-b633-4989-96ec-bc49d825a412",
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2021/07/20",
            "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Data|contains": [
                        "Compress-Archive -Path*-DestinationPath $env:TEMP",
                        "Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\",
                        "Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "powershell-classic"
            },
            "modified": "2023/12/18",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md",
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
            ],
            "related": [
                {
                    "id": "daf7eb81-35fd-410d-9d7a-657837e602bb",
                    "type": "similar"
                },
                {
                    "id": "b7a3c9a3-09ea-4934-8864-6a32cacd98d9",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98"
                }
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1074.001"
            ],
            "title": "Zip A Folder With PowerShell For Staging In Temp - PowerShell"
        },
        {
            "id": "b7a3c9a3-09ea-4934-8864-6a32cacd98d9",
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2021/07/20",
            "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Compress-Archive -Path*-DestinationPath $env:TEMP",
                        "Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\",
                        "Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2023/12/18",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md",
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
            ],
            "related": [
                {
                    "id": "71ff406e-b633-4989-96ec-bc49d825a412",
                    "type": "similar"
                },
                {
                    "id": "daf7eb81-35fd-410d-9d7a-657837e602bb",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98"
                }
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1074.001"
            ],
            "title": "Zip A Folder With PowerShell For Staging In Temp - PowerShell Script"
        },
        {
            "id": "daf7eb81-35fd-410d-9d7a-657837e602bb",
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2021/07/20",
            "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ContextInfo|contains|all": [
                        "Compress-Archive -Path*-DestinationPath $env:TEMP",
                        "Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\",
                        "Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_module",
                "product": "windows",
                "definition": "0ad03ef1-f21b-4a79-8ce8-e6900c54b65b"
            },
            "modified": "2023/12/18",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md",
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
            ],
            "related": [
                {
                    "id": "71ff406e-b633-4989-96ec-bc49d825a412",
                    "type": "similar"
                },
                {
                    "id": "b7a3c9a3-09ea-4934-8864-6a32cacd98d9",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98"
                }
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1074.001"
            ],
            "title": "Zip A Folder With PowerShell For Staging In Temp  - PowerShell Module"
        }
    ]
}