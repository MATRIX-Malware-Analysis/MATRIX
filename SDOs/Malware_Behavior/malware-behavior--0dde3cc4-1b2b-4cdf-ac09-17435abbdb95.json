{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--0dde3cc4-1b2b-4cdf-ac09-17435abbdb95",
    "created": "2024-08-13T14:46:37.063558Z",
    "modified": "2024-08-13T14:46:45.7741Z",
    "name": "Inter-Process Communication",
    "description": "Adversaries may abuse inter-process communication (IPC) mechanisms for local code or command execution. IPC is typically used by processes to share data, communicate with each other, or synchronize execution. IPC is also commonly used to avoid situations such as deadlocks, which occurs when processes are stuck in a cyclic waiting pattern. Adversaries may abuse IPC to execute arbitrary code or commands. IPC mechanisms may differ depending on OS, but typically exists in a form accessible through programming languages/libraries or native interfaces such as Windows Dynamic Data Exchange or Component Object Model. Linux environments support several different IPC mechanisms, two of which being sockets and pipes.[1] Higher level execution mediums, such as those of Command and Scripting Interpreters, may also leverage underlying IPC mechanisms. Adversaries may also use Remote Services such as Distributed Component Object Model to facilitate remote IPC execution.[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1559",
            "external_id": "T1559"
        },
        {
            "source_name": "mitre-attack",
            "external_id": "T1559",
            "url": "https://attack.mitre.org/techniques/T1559"
        },
        {
            "source_name": "Linux IPC",
            "url": "https://www.geeksforgeeks.org/inter-process-communication-ipc/#:~:text=Inter%2Dprocess%20communication%20(IPC),of%20co%2Doperation%20between%20them.",
            "description": "N/A. (2021, April 1). Inter Process Communication (IPC). Retrieved March 11, 2022."
        },
        {
            "source_name": "Fireeye Hunting COM June 2019",
            "url": "https://www.fireeye.com/blog/threat-research/2019/06/hunting-com-objects.html",
            "description": "Hamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019."
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Nik Seetharaman",
            "date": "2018/07/16",
            "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallTrace|contains": "cmlua.dll"
                }
            },
            "falsepositives": [
                "Legitimate CMSTP use (unlikely in modern enterprise environments)"
            ],
            "id": "3b4b232a-af90-427c-a22f-30b0c0837b95",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2021/06/27",
            "references": [
                "https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.003",
                "attack.execution",
                "attack.t1559.001",
                "attack.g0069",
                "attack.g0080",
                "car.2019-04-001"
            ],
            "title": "CMSTP Execution Process Access"
        },
        {
            "author": "Dmitriy Lifanov, oscd.community",
            "date": "2019/10/25",
            "description": "Detects DNS queries initiated by \"Regsvr32.exe\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\regsvr32.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "36e037c4-c228-4866-b6a3-48eb292b9955",
            "level": "medium",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/",
                "https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/"
            ],
            "related": [
                {
                    "id": "c7e91a02-d771-4a6d-a700-42587e0b1095",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1559.001",
                "attack.defense_evasion",
                "attack.t1218.010"
            ],
            "title": "DNS Query Request By Regsvr32.EXE"
        },
        {
            "id": "c7e91a02-d771-4a6d-a700-42587e0b1095",
            "author": "Dmitriy Lifanov, oscd.community",
            "date": "2019/10/25",
            "description": "Detects a network connection initiated by \"Regsvr32.exe\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\regsvr32.exe",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/",
                "https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/"
            ],
            "status": "test",
            "title": "Network Connection Initiated By Regsvr32.EXE",
            "tags": [
                "attack.execution",
                "attack.t1559.001",
                "attack.defense_evasion",
                "attack.t1218.010"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/26",
            "description": "Enable Dynamic Data Exchange protocol (DDE) in all supported editions of Microsoft Word or Excel.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_excel": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\Excel\\Security\\DisableDDEServerLaunch",
                        "\\Excel\\Security\\DisableDDEServerLookup"
                    ]
                },
                "selection_word": {
                    "Details": [
                        "DWORD (0x00000001)",
                        "DWORD (0x00000002)"
                    ],
                    "TargetObject|endswith": "\\Word\\Security\\AllowDDE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "63647769-326d-4dde-a419-b925cc0caf42",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://msrc.microsoft.com/update-guide/vulnerability/ADV170021"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1559.002"
            ],
            "title": "Enable Microsoft Dynamic Data Exchange"
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "macOS",
        "Linux"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        }
    ],
    "x_mitre_detection": "Monitor for strings in files/commands, loaded DLLs/libraries, or spawned processes that are associated with abuse of IPC mechanisms.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Module: Module Load",
        "Process: Process Creation",
        "Script: Script Execution",
        "Process: Process Access"
    ],
    "x_mitre_permissions_required": [
        "Administrator",
        "User",
        "SYSTEM"
    ]
}