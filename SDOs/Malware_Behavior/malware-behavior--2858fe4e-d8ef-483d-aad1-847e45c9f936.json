{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--2858fe4e-d8ef-483d-aad1-847e45c9f936",
    "created": "2024-08-13T14:46:36.880284Z",
    "modified": "2024-08-13T14:46:44.743447Z",
    "name": "Account Discovery: Domain Account",
    "description": "Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges.Commands such as net user /domain and net group /domain of the Net utility, dscacheutil -q groupon macOS, and ldapsearch on Linux can list domain users and groups. PowerShell cmdlets including Get-ADUser and Get-ADGroupMember may enumerate members of Active Directory groups.[1]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1087/002",
            "external_id": "T1087/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "C.J. May",
            "date": "2022/08/09",
            "description": "Detects default file names outputted by the BloodHound collection tool SharpHound",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_ms_winapps": {
                    "Image|endswith": "\\svchost.exe",
                    "TargetFilename|endswith": "\\pocket_containers.json",
                    "TargetFilename|startswith": "C:\\Program Files\\WindowsApps\\Microsoft."
                },
                "selection": {
                    "TargetFilename|endswith": [
                        "BloodHound.zip",
                        "_computers.json",
                        "_containers.json",
                        "_domains.json",
                        "_gpos.json",
                        "_groups.json",
                        "_ous.json",
                        "_users.json"
                    ]
                }
            },
            "falsepositives": [
                "Some false positives may arise in some environment and this may require some tuning. Add additional filters or reduce level depending on the level of noise"
            ],
            "id": "02773bed-83bf-469f-b7ff-e676e7d78bab",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/03/29",
            "references": [
                "https://academy.hackthebox.com/course/preview/active-directory-bloodhound/bloodhound--data-collection"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087.001",
                "attack.t1087.002",
                "attack.t1482",
                "attack.t1069.001",
                "attack.t1069.002",
                "attack.execution",
                "attack.t1059.001"
            ],
            "title": "BloodHound Collection Files"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/14",
            "description": "Detects the execution of \"csvde.exe\" in order to export organizational Active Directory structure.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "filter_import": {
                    "CommandLine|contains": " -i"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\csvde.exe"
                    },
                    {
                        "OriginalFileName": "csvde.exe"
                    }
                ],
                "selection_remote": {
                    "CommandLine|contains": " -f"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e5d36acd-acb4-4c6f-a13f-9eb203d50099",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms",
                "https://web.archive.org/web/20180725233601/https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf",
                "https://businessinsights.bitdefender.com/deep-dive-into-a-backdoordiplomacy-attack-a-study-of-an-attackers-toolkit",
                "https://redcanary.com/blog/msix-installers/"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.discovery",
                "attack.t1087.002"
            ],
            "title": "Active Directory Structure Export Via Csvde.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/12/18",
            "description": "Detects usage of the PsLogList utility to dump event log in order to extract admin accounts and perform account discovery or delete events logs",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli_eventlog": {
                    "CommandLine|contains": [
                        " security",
                        " application",
                        " system"
                    ]
                },
                "selection_cli_flags": {
                    "CommandLine|contains|windash": [
                        " -d",
                        " -x",
                        " -s",
                        " -c",
                        " -g"
                    ]
                },
                "selection_img": [
                    {
                        "OriginalFileName": "psloglist.exe"
                    },
                    {
                        "Image|endswith": [
                            "\\psloglist.exe",
                            "\\psloglist64.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Another tool that uses the command line switches of PsLogList",
                "Legitimate use of PsLogList by an administrator"
            ],
            "id": "aae1243f-d8af-40d8-ab20-33fc6d0c55bc",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "references": [
                "https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/",
                "https://www.cybereason.com/blog/deadringer-exposing-chinese-threat-actors-targeting-major-telcos",
                "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Sysinternals/PsLogList",
                "https://twitter.com/EricaZelic/status/1614075109827874817"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087",
                "attack.t1087.001",
                "attack.t1087.002"
            ],
            "title": "Suspicious Use of PsLogList"
        },
        {
            "author": "Janantha Marasinghe (https://github.com/blueteam0ps), FPT.EagleEye Team, omkar72, oscd.community",
            "date": "2021/02/02",
            "description": "Detects AdFind execution with common flags seen used during attacks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "domainlist",
                        "trustdmp",
                        "dcmodes",
                        "adinfo",
                        " dclist ",
                        "computer_pwdnotreqd",
                        "objectcategory=",
                        "-subnets -f",
                        "name=\"Domain Admins\"",
                        "-sc u:",
                        "domainncs",
                        "dompol",
                        " oudmp ",
                        "subnetdmp",
                        "gpodmp",
                        "fspdmp",
                        "users_noexpire",
                        "computers_active",
                        "computers_pwdnotreqd"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate admin activity"
            ],
            "id": "9a132afa-654e-11eb-ae93-0242ac130002",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "references": [
                "https://www.joeware.net/freetools/tools/adfind/",
                "https://thedfirreport.com/2020/05/08/adfind-recon/",
                "https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/",
                "https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/",
                "https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx",
                "https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/bf62ece1c679b07b5fb49c4bae947fe24c81811f/fin6/Emulation_Plan/Phase1.md",
                "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1087.002/T1087.002.md#atomic-test-7---adfind---enumerate-active-directory-user-objects"
            ],
            "related": [
                {
                    "id": "455b9d50-15a1-4b99-853f-8d37655a4c1b",
                    "type": "similar"
                },
                {
                    "id": "75df3b17-8bcc-4565-b89b-c9898acef911",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1018",
                "attack.t1087.002",
                "attack.t1482",
                "attack.t1069.002",
                "stp.1u"
            ],
            "title": "PUA - AdFind Suspicious Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/12/20",
            "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli_1": {
                    "CommandLine|contains": [
                        " -CollectionMethod All ",
                        " --CollectionMethods Session ",
                        " --Loop --Loopduration ",
                        " --PortScanTimeout ",
                        ".exe -c All -d ",
                        "Invoke-Bloodhound",
                        "Get-BloodHoundData"
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains|all": [
                        " -JsonFolder ",
                        " -ZipFileName "
                    ]
                },
                "selection_cli_3": {
                    "CommandLine|contains|all": [
                        " DCOnly ",
                        " --NoSaveCache "
                    ]
                },
                "selection_img": [
                    {
                        "Product|contains": "SharpHound"
                    },
                    {
                        "Description|contains": "SharpHound"
                    },
                    {
                        "Company|contains": [
                            "SpecterOps",
                            "evil corp"
                        ]
                    },
                    {
                        "Image|contains": [
                            "\\Bloodhound.exe",
                            "\\SharpHound.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Other programs that use these command line option and accepts an 'All' parameter"
            ],
            "id": "f376c8a7-a2d0-4ddc-aa0c-16c17236d962",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://github.com/BloodHoundAD/BloodHound",
                "https://github.com/BloodHoundAD/SharpHound"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087.001",
                "attack.t1087.002",
                "attack.t1482",
                "attack.t1069.001",
                "attack.t1069.002",
                "attack.execution",
                "attack.t1059.001"
            ],
            "title": "HackTool - Bloodhound/Sharphound Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/02",
            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "Add-Exfiltration",
                        "Add-Persistence",
                        "Add-RegBackdoor",
                        "Add-RemoteRegBackdoor",
                        "Add-ScrnSaveBackdoor",
                        "Check-VM",
                        "ConvertTo-Rc4ByteStream",
                        "Decrypt-Hash",
                        "Disable-ADIDNSNode",
                        "Disable-MachineAccount",
                        "Do-Exfiltration",
                        "Enable-ADIDNSNode",
                        "Enable-MachineAccount",
                        "Enabled-DuplicateToken",
                        "Exploit-Jboss",
                        "Export-ADR",
                        "Export-ADRCSV",
                        "Export-ADRExcel",
                        "Export-ADRHTML",
                        "Export-ADRJSON",
                        "Export-ADRXML",
                        "Find-Fruit",
                        "Find-GPOLocation",
                        "Find-TrustedDocuments",
                        "Get-ADIDNS",
                        "Get-ApplicationHost",
                        "Get-ChromeDump",
                        "Get-ClipboardContents",
                        "Get-FoxDump",
                        "Get-GPPPassword",
                        "Get-IndexedItem",
                        "Get-KerberosAESKey",
                        "Get-Keystrokes",
                        "Get-LSASecret",
                        "Get-MachineAccountAttribute",
                        "Get-MachineAccountCreator",
                        "Get-PassHashes",
                        "Get-RegAlwaysInstallElevated",
                        "Get-RegAutoLogon",
                        "Get-RemoteBootKey",
                        "Get-RemoteCachedCredential",
                        "Get-RemoteLocalAccountHash",
                        "Get-RemoteLSAKey",
                        "Get-RemoteMachineAccountHash",
                        "Get-RemoteNLKMKey",
                        "Get-RickAstley",
                        "Get-Screenshot",
                        "Get-SecurityPackages",
                        "Get-ServiceFilePermission",
                        "Get-ServicePermission",
                        "Get-ServiceUnquoted",
                        "Get-SiteListPassword",
                        "Get-System",
                        "Get-TimedScreenshot",
                        "Get-UnattendedInstallFile",
                        "Get-Unconstrained",
                        "Get-USBKeystrokes",
                        "Get-VaultCredential",
                        "Get-VulnAutoRun",
                        "Get-VulnSchTask",
                        "Grant-ADIDNSPermission",
                        "Gupt-Backdoor",
                        "HTTP-Login",
                        "Install-ServiceBinary",
                        "Install-SSP",
                        "Invoke-ACLScanner",
                        "Invoke-ADRecon",
                        "Invoke-ADSBackdoor",
                        "Invoke-AgentSmith",
                        "Invoke-AllChecks",
                        "Invoke-ARPScan",
                        "Invoke-AzureHound",
                        "Invoke-BackdoorLNK",
                        "Invoke-BadPotato",
                        "Invoke-BetterSafetyKatz",
                        "Invoke-BypassUAC",
                        "Invoke-Carbuncle",
                        "Invoke-Certify",
                        "Invoke-ConPtyShell",
                        "Invoke-CredentialInjection",
                        "Invoke-DAFT",
                        "Invoke-DCSync",
                        "Invoke-DinvokeKatz",
                        "Invoke-DllInjection",
                        "Invoke-DNSUpdate",
                        "Invoke-DomainPasswordSpray",
                        "Invoke-DowngradeAccount",
                        "Invoke-EgressCheck",
                        "Invoke-Eyewitness",
                        "Invoke-FakeLogonScreen",
                        "Invoke-Farmer",
                        "Invoke-Get-RBCD-Threaded",
                        "Invoke-Gopher",
                        "Invoke-Grouper",
                        "Invoke-HandleKatz",
                        "Invoke-ImpersonatedProcess",
                        "Invoke-ImpersonateSystem",
                        "Invoke-InteractiveSystemPowerShell",
                        "Invoke-Internalmonologue",
                        "Invoke-Inveigh",
                        "Invoke-InveighRelay",
                        "Invoke-KrbRelay",
                        "Invoke-LdapSignCheck",
                        "Invoke-Lockless",
                        "Invoke-MalSCCM",
                        "Invoke-Mimikatz",
                        "Invoke-Mimikittenz",
                        "Invoke-MITM6",
                        "Invoke-NanoDump",
                        "Invoke-NetRipper",
                        "Invoke-Nightmare",
                        "Invoke-NinjaCopy",
                        "Invoke-OfficeScrape",
                        "Invoke-OxidResolver",
                        "Invoke-P0wnedshell",
                        "Invoke-Paranoia",
                        "Invoke-PortScan",
                        "Invoke-PoshRatHttp",
                        "Invoke-PostExfil",
                        "Invoke-PowerDump",
                        "Invoke-PowerShellTCP",
                        "Invoke-PowerShellWMI",
                        "Invoke-PPLDump",
                        "Invoke-PsExec",
                        "Invoke-PSInject",
                        "Invoke-PsUaCme",
                        "Invoke-ReflectivePEInjection",
                        "Invoke-ReverseDNSLookup",
                        "Invoke-Rubeus",
                        "Invoke-RunAs",
                        "Invoke-SafetyKatz",
                        "Invoke-SauronEye",
                        "Invoke-SCShell",
                        "Invoke-Seatbelt",
                        "Invoke-ServiceAbuse",
                        "Invoke-ShadowSpray",
                        "Invoke-Sharp",
                        "Invoke-Shellcode",
                        "Invoke-SMBScanner",
                        "Invoke-Snaffler",
                        "Invoke-Spoolsample",
                        "Invoke-SpraySinglePassword",
                        "Invoke-SSHCommand",
                        "Invoke-StandIn",
                        "Invoke-StickyNotesExtract",
                        "Invoke-SystemCommand",
                        "Invoke-Tasksbackdoor",
                        "Invoke-Tater",
                        "Invoke-Thunderfox",
                        "Invoke-ThunderStruck",
                        "Invoke-TokenManipulation",
                        "Invoke-Tokenvator",
                        "Invoke-TotalExec",
                        "Invoke-UrbanBishop",
                        "Invoke-UserHunter",
                        "Invoke-VoiceTroll",
                        "Invoke-Whisker",
                        "Invoke-WinEnum",
                        "Invoke-winPEAS",
                        "Invoke-WireTap",
                        "Invoke-WmiCommand",
                        "Invoke-WMIExec",
                        "Invoke-WScriptBypassUAC",
                        "Invoke-Zerologon",
                        "MailRaider",
                        "New-ADIDNSNode",
                        "New-DNSRecordArray",
                        "New-HoneyHash",
                        "New-InMemoryModule",
                        "New-MachineAccount",
                        "New-SOASerialNumberArray",
                        "Out-Minidump",
                        "Port-Scan",
                        "PowerBreach",
                        "powercat ",
                        "PowerUp",
                        "PowerView",
                        "Remove-ADIDNSNode",
                        "Remove-MachineAccount",
                        "Remove-Update",
                        "Rename-ADIDNSNode",
                        "Revoke-ADIDNSPermission",
                        "Set-ADIDNSNode",
                        "Set-MacAttribute",
                        "Set-MachineAccountAttribute",
                        "Set-Wallpaper",
                        "Show-TargetScreen",
                        "Start-CaptureServer",
                        "Start-Dnscat2",
                        "Start-WebcamRecorder",
                        "VolumeShadowCopyTools"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "02030f2f-6199-49ec-b258-ea71b07e03dc",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/25",
            "references": [
                "https://adsecurity.org/?p=2921",
                "https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries",
                "https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1",
                "https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1",
                "https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1",
                "https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1",
                "https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/",
                "https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/",
                "https://github.com/calebstewart/CVE-2021-1675",
                "https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1",
                "https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html",
                "https://github.com/HarmJ0y/DAMP",
                "https://github.com/samratashok/nishang",
                "https://github.com/DarkCoderSc/PowerRunAsSystem/",
                "https://github.com/besimorhino/powercat",
                "https://github.com/Kevin-Robertson/Powermad",
                "https://github.com/adrecon/ADRecon",
                "https://github.com/adrecon/AzureADRecon"
            ],
            "related": [
                {
                    "id": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
                    "type": "derived"
                },
                {
                    "id": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1482",
                "attack.t1087",
                "attack.t1087.001",
                "attack.t1087.002",
                "attack.t1069.001",
                "attack.t1069.002",
                "attack.t1069",
                "attack.t1059.001"
            ],
            "title": "Malicious PowerShell Commandlets - ProcessCreation"
        },
        {
            "author": "Florian Roth (Nextron Systems), omkar72, @svch0st, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/01/16",
            "description": "Detects suspicious reconnaissance command line activity on Windows systems using Net.EXE\nCheck if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\n",
            "detection": {
                "condition": "selection_img and ((all of selection_group_* and not filter_group_add) or all of selection_accounts_*)",
                "filter_group_add": {
                    "CommandLine|contains": " /add"
                },
                "selection_accounts_flags": {
                    "CommandLine|contains": " /do"
                },
                "selection_accounts_root": {
                    "CommandLine|contains": " accounts "
                },
                "selection_group_flags": {
                    "CommandLine|contains": [
                        "domain admins",
                        " administrator",
                        " administrateur",
                        "enterprise admins",
                        "Exchange Trusted Subsystem",
                        "Remote Desktop Users",
                        "Utilisateurs du Bureau \u00e0 distance",
                        "Usuarios de escritorio remoto",
                        " /do"
                    ]
                },
                "selection_group_root": {
                    "CommandLine|contains": [
                        " group ",
                        " localgroup "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\net.exe",
                            "\\net1.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "net.exe",
                            "net1.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Inventory tool runs",
                "Administrative activity"
            ],
            "id": "d95de845-b83c-4a9a-8a6a-4fc802ebf6c0",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/02",
            "references": [
                "https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/",
                "https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/",
                "https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087.001",
                "attack.t1087.002"
            ],
            "title": "Suspicious Group And Account Reconnaissance Activity Using Net.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/08/21",
            "description": "Detects the use of a renamed Adfind.exe. AdFind continues to be seen across majority of breaches. It is used to domain trust discovery to plan out subsequent steps in the attack chain.",
            "detection": {
                "condition": "1 of selection* and not filter",
                "filter": {
                    "Image|endswith": "\\AdFind.exe"
                },
                "selection_1": {
                    "CommandLine|contains": [
                        "domainlist",
                        "trustdmp",
                        "dcmodes",
                        "adinfo",
                        " dclist ",
                        "computer_pwdnotreqd",
                        "objectcategory=",
                        "-subnets -f",
                        "name=\"Domain Admins\"",
                        "-sc u:",
                        "domainncs",
                        "dompol",
                        " oudmp ",
                        "subnetdmp",
                        "gpodmp",
                        "fspdmp",
                        "users_noexpire",
                        "computers_active",
                        "computers_pwdnotreqd"
                    ]
                },
                "selection_2": [
                    {
                        "Imphash": [
                            "bca5675746d13a1f246e2da3c2217492",
                            "53e117a96057eaf19c41380d0e87f1c2"
                        ]
                    },
                    {
                        "Hashes|contains": [
                            "IMPHASH=BCA5675746D13A1F246E2DA3C2217492",
                            "IMPHASH=53E117A96057EAF19C41380D0E87F1C2"
                        ]
                    }
                ],
                "selection_3": {
                    "OriginalFileName": "AdFind.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "df55196f-f105-44d3-a675-e9dfb6cc2f2b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://www.joeware.net/freetools/tools/adfind/",
                "https://thedfirreport.com/2020/05/08/adfind-recon/",
                "https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/",
                "https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/",
                "https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx",
                "https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/bf62ece1c679b07b5fb49c4bae947fe24c81811f/fin6/Emulation_Plan/Phase1.md"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1018",
                "attack.t1087.002",
                "attack.t1482",
                "attack.t1069.002"
            ],
            "title": "Renamed AdFind Execution"
        },
        {
            "id": "455b9d50-15a1-4b99-853f-8d37655a4c1b",
            "author": "frack113",
            "date": "2021/12/13",
            "description": "Detects active directory enumeration activity using known AdFind CLI flags",
            "detection": {
                "condition": "1 of selection_*",
                "selection_enum_ad": {
                    "CommandLine|contains": "-sc admincountdmp"
                },
                "selection_enum_exchange": {
                    "CommandLine|contains": "-sc exchaddresses"
                },
                "selection_password": {
                    "CommandLine|contains": [
                        "lockoutduration",
                        "lockoutthreshold",
                        "lockoutobservationwindow",
                        "maxpwdage",
                        "minpwdage",
                        "minpwdlength",
                        "pwdhistorylength",
                        "pwdproperties"
                    ]
                }
            },
            "falsepositives": [
                "Authorized administrative activity"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "references": [
                "https://www.joeware.net/freetools/tools/adfind/",
                "https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.002/T1087.002.md"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "9a132afa-654e-11eb-ae93-0242ac130002"
                }
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087.002"
            ],
            "title": "PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE"
        },
        {
            "author": "Adeem Mawani",
            "date": "2021/06/22",
            "description": "Detects potential Active Directory enumeration via LDAP",
            "detection": {
                "condition": "(generic_search and not narrow_down_filter) or suspicious_flag",
                "generic_search": {
                    "EventID": 30,
                    "SearchFilter|contains": [
                        "(groupType:1.2.840.113556.1.4.803:=2147483648)",
                        "(groupType:1.2.840.113556.1.4.803:=2147483656)",
                        "(groupType:1.2.840.113556.1.4.803:=2147483652)",
                        "(groupType:1.2.840.113556.1.4.803:=2147483650)",
                        "(sAMAccountType=805306369)",
                        "(sAMAccountType=805306368)",
                        "(sAMAccountType=536870913)",
                        "(sAMAccountType=536870912)",
                        "(sAMAccountType=268435457)",
                        "(sAMAccountType=268435456)",
                        "(objectCategory=groupPolicyContainer)",
                        "(objectCategory=organizationalUnit)",
                        "(objectCategory=Computer)",
                        "(objectCategory=nTDSDSA)",
                        "(objectCategory=server)",
                        "(objectCategory=domain)",
                        "(objectCategory=person)",
                        "(objectCategory=group)",
                        "(objectCategory=user)",
                        "(objectClass=trustedDomain)",
                        "(objectClass=computer)",
                        "(objectClass=server)",
                        "(objectClass=group)",
                        "(objectClass=user)",
                        "(primaryGroupID=521)",
                        "(primaryGroupID=516)",
                        "(primaryGroupID=515)",
                        "(primaryGroupID=512)",
                        "Domain Admins",
                        "objectGUID=\\*",
                        "(schemaIDGUID=\\*)"
                    ]
                },
                "narrow_down_filter": {
                    "EventID": 30,
                    "SearchFilter|contains": [
                        "(domainSid=*)",
                        "(objectSid=*)"
                    ]
                },
                "suspicious_flag": {
                    "EventID": 30,
                    "SearchFilter|contains": [
                        "(userAccountControl:1.2.840.113556.1.4.803:=4194304)",
                        "(userAccountControl:1.2.840.113556.1.4.803:=2097152)",
                        "!(userAccountControl:1.2.840.113556.1.4.803:=1048574)",
                        "(userAccountControl:1.2.840.113556.1.4.803:=524288)",
                        "(userAccountControl:1.2.840.113556.1.4.803:=65536)",
                        "(userAccountControl:1.2.840.113556.1.4.803:=8192)",
                        "(userAccountControl:1.2.840.113556.1.4.803:=544)",
                        "!(UserAccountControl:1.2.840.113556.1.4.803:=2)",
                        "msDS-AllowedToActOnBehalfOfOtherIdentity",
                        "msDS-AllowedToDelegateTo",
                        "msDS-GroupManagedServiceAccount",
                        "(accountExpires=9223372036854775807)",
                        "(accountExpires=0)",
                        "(adminCount=1)",
                        "ms-MCS-AdmPwd"
                    ]
                }
            },
            "id": "31d68132-4038-47c7-8f8e-635a39a7c174",
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-LDAP-Client/Debug ETW logging",
                "product": "windows",
                "service": "ldap"
            },
            "level": "medium",
            "modified": "2023/11/03",
            "references": [
                "https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/hunting-for-reconnaissance-activities-using-ldap-search-filters/ba-p/824726",
                "https://github.com/PowerShellMafia/PowerSploit/blob/d943001a7defb5e0d1657085a77a0e78609be58f/Recon/PowerView.ps1",
                "https://github.com/BloodHoundAD/SharpHound3/blob/7d96b991b1887ff50349ce59c80980bc0d95c86a/SharpHound3/LdapBuilder.cs",
                "https://medium.com/falconforce/falconfriday-detecting-active-directory-data-collection-0xff21-c22d1a57494c",
                "https://github.com/fox-it/BloodHound.py/blob/d65eb614831cd30f26028ccb072f5e77ca287e0b/bloodhound/ad/domain.py#L427"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1069.002",
                "attack.t1087.002",
                "attack.t1482"
            ],
            "title": "Potential Active Directory Reconnaissance/Enumeration Via LDAP"
        },
        {
            "author": "Samir Bousseaden",
            "date": "2019/04/03",
            "description": "Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs",
            "detection": {
                "condition": "selection and selection_object and not filter",
                "filter": {
                    "SubjectUserName|endswith": "$"
                },
                "selection": {
                    "EventID": 4661,
                    "ObjectType": [
                        "SAM_USER",
                        "SAM_GROUP"
                    ]
                },
                "selection_object": [
                    {
                        "ObjectName|endswith": [
                            "-512",
                            "-502",
                            "-500",
                            "-505",
                            "-519",
                            "-520",
                            "-544",
                            "-551",
                            "-555"
                        ]
                    },
                    {
                        "ObjectName|contains": "admin"
                    }
                ]
            },
            "falsepositives": [
                "If source account name is not an admin then its super suspicious"
            ],
            "id": "35ba1d85-724d-42a3-889f-2e2362bcaf23",
            "level": "high",
            "logsource": {
                "definition": "Requirements: enable Object Access SAM on your Domain Controllers",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/07/13",
            "references": [
                "https://blog.menasec.net/2019/02/threat-hunting-5-detecting-enumeration.html"
            ],
            "status": "test",
            "title": "AD Privileged Users or Groups Reconnaissance",
            "tags": [
                "attack.discovery",
                "attack.t1087.002"
            ]
        },
        {
            "author": "Maxime Thiebaut (@0xThiebaut)",
            "date": "2020/03/30",
            "description": "Detects read access to a domain user from a non-machine account",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_machine_accounts": {
                    "SubjectUserName|endswith": "$"
                },
                "filter_main_msql": {
                    "SubjectUserName|startswith": "MSOL_"
                },
                "selection": {
                    "AccessMask|endswith": [
                        "1?",
                        "3?",
                        "4?",
                        "7?",
                        "9?",
                        "B?",
                        "D?",
                        "F?"
                    ],
                    "EventID": 4662,
                    "ObjectType|contains": "bf967aba-0de6-11d0-a285-00aa003049e2"
                }
            },
            "falsepositives": [
                "Administrators configuring new users."
            ],
            "id": "ab6bffca-beff-4baa-af11-6733f296d57a",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: The \"Read all properties\" permission on the user object needs to be audited for the \"Everyone\" principal",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/11/08",
            "references": [
                "https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf",
                "http://www.stuffithoughtiknew.com/2019/02/detecting-bloodhound.html",
                "https://learn.microsoft.com/en-us/windows/win32/adschema/attributes-all",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662"
            ],
            "status": "test",
            "title": "Potential AD User Enumeration From Non-Machine Account",
            "tags": [
                "attack.discovery",
                "attack.t1087.002"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Jack Croock (method), Jonhnathan Ribeiro (improvements), oscd.community",
            "date": "2017/03/07",
            "description": "Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4661,
                    "AccessMask": "0x2d",
                    "ObjectType": [
                        "SAM_USER",
                        "SAM_GROUP"
                    ],
                    "ObjectName|endswith": [
                        "-500",
                        "-512"
                    ],
                    "ObjectName|startswith": "S-1-5-21-"
                }
            },
            "falsepositives": [
                "Administrator activity"
            ],
            "id": "968eef52-9cff-4454-8992-1e74b9cbad6c",
            "level": "high",
            "logsource": {
                "definition": "The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommendations for server systems",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/08/22",
            "references": [
                "https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087.002",
                "attack.t1069.002",
                "attack.s0039"
            ],
            "title": "Reconnaissance Activity"
        },
        {
            "author": "frack113",
            "date": "2022/03/17",
            "description": "Detects usage of the \"Get-AdComputer\" to enumerate Computers or properties within Active Directory.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmdlet": {
                    "ScriptBlockText|contains": "Get-AdComputer "
                },
                "selection_option": {
                    "ScriptBlockText|contains": [
                        "-Filter ",
                        "-LDAPFilter ",
                        "-Properties "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "36bed6b2-e9a0-4fff-beeb-413a92b86138",
            "level": "low",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2023/07/08",
            "references": [
                "https://learn.microsoft.com/en-us/powershell/module/activedirectory/get-adcomputer",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md",
                "https://github.com/redcanaryco/atomic-red-team/blob/02cb591f75064ffe1e0df9ac3ed5972a2e491c97/atomics/T1087.002/T1087.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1018",
                "attack.t1087.002"
            ],
            "title": "Active Directory Computers Enumeration With Get-AdComputer"
        },
        {
            "id": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
            "author": "Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias Michalski, Austin Songer",
            "date": "2017/03/05",
            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_amazon_ec2": {
                    "ScriptBlockText|contains": [
                        "Get-SystemDriveInfo",
                        "C:\\ProgramData\\Amazon\\EC2-Windows\\Launch\\Module\\"
                    ]
                },
                "selection": {
                    "ScriptBlockText|contains": [
                        "Add-Exfiltration",
                        "Add-Persistence",
                        "Add-RegBackdoor",
                        "Add-RemoteRegBackdoor",
                        "Add-ScrnSaveBackdoor",
                        "ConvertTo-Rc4ByteStream",
                        "Decrypt-Hash",
                        "Disable-ADIDNSNode",
                        "Do-Exfiltration",
                        "Enable-ADIDNSNode",
                        "Enabled-DuplicateToken",
                        "Exploit-Jboss",
                        "Export-ADRCSV",
                        "Export-ADRExcel",
                        "Export-ADRHTML",
                        "Export-ADRJSON",
                        "Export-ADRXML",
                        "Find-Fruit",
                        "Find-GPOLocation",
                        "Find-TrustedDocuments",
                        "Get-ADIDNSNodeAttribute",
                        "Get-ADIDNSNodeOwner",
                        "Get-ADIDNSNodeTombstoned",
                        "Get-ADIDNSPermission",
                        "Get-ADIDNSZone",
                        "Get-ChromeDump",
                        "Get-ClipboardContents",
                        "Get-FoxDump",
                        "Get-GPPPassword",
                        "Get-IndexedItem",
                        "Get-KerberosAESKey",
                        "Get-Keystrokes",
                        "Get-LSASecret",
                        "Get-PassHashes",
                        "Get-RegAlwaysInstallElevated",
                        "Get-RegAutoLogon",
                        "Get-RemoteBootKey",
                        "Get-RemoteCachedCredential",
                        "Get-RemoteLocalAccountHash",
                        "Get-RemoteLSAKey",
                        "Get-RemoteMachineAccountHash",
                        "Get-RemoteNLKMKey",
                        "Get-RickAstley",
                        "Get-SecurityPackages",
                        "Get-ServiceFilePermission",
                        "Get-ServicePermission",
                        "Get-ServiceUnquoted",
                        "Get-SiteListPassword",
                        "Get-System",
                        "Get-TimedScreenshot",
                        "Get-UnattendedInstallFile",
                        "Get-Unconstrained",
                        "Get-USBKeystrokes",
                        "Get-VaultCredential",
                        "Get-VulnAutoRun",
                        "Get-VulnSchTask",
                        "Grant-ADIDNSPermission",
                        "Gupt-Backdoor",
                        "Invoke-ACLScanner",
                        "Invoke-ADRecon",
                        "Invoke-ADSBackdoor",
                        "Invoke-AgentSmith",
                        "Invoke-AllChecks",
                        "Invoke-ARPScan",
                        "Invoke-AzureHound",
                        "Invoke-BackdoorLNK",
                        "Invoke-BadPotato",
                        "Invoke-BetterSafetyKatz",
                        "Invoke-BypassUAC",
                        "Invoke-Carbuncle",
                        "Invoke-Certify",
                        "Invoke-ConPtyShell",
                        "Invoke-CredentialInjection",
                        "Invoke-DAFT",
                        "Invoke-DCSync",
                        "Invoke-DinvokeKatz",
                        "Invoke-DllInjection",
                        "Invoke-DNSUpdate",
                        "Invoke-DomainPasswordSpray",
                        "Invoke-DowngradeAccount",
                        "Invoke-EgressCheck",
                        "Invoke-Eyewitness",
                        "Invoke-FakeLogonScreen",
                        "Invoke-Farmer",
                        "Invoke-Get-RBCD-Threaded",
                        "Invoke-Gopher",
                        "Invoke-Grouper",
                        "Invoke-HandleKatz",
                        "Invoke-ImpersonatedProcess",
                        "Invoke-ImpersonateSystem",
                        "Invoke-InteractiveSystemPowerShell",
                        "Invoke-Internalmonologue",
                        "Invoke-Inveigh",
                        "Invoke-InveighRelay",
                        "Invoke-KrbRelay",
                        "Invoke-LdapSignCheck",
                        "Invoke-Lockless",
                        "Invoke-MalSCCM",
                        "Invoke-Mimikatz",
                        "Invoke-Mimikittenz",
                        "Invoke-MITM6",
                        "Invoke-NanoDump",
                        "Invoke-NetRipper",
                        "Invoke-Nightmare",
                        "Invoke-NinjaCopy",
                        "Invoke-OfficeScrape",
                        "Invoke-OxidResolver",
                        "Invoke-P0wnedshell",
                        "Invoke-Paranoia",
                        "Invoke-PortScan",
                        "Invoke-PoshRatHttp",
                        "Invoke-PostExfil",
                        "Invoke-PowerDump",
                        "Invoke-PowerShellTCP",
                        "Invoke-PowerShellWMI",
                        "Invoke-PPLDump",
                        "Invoke-PsExec",
                        "Invoke-PSInject",
                        "Invoke-PsUaCme",
                        "Invoke-ReflectivePEInjection",
                        "Invoke-ReverseDNSLookup",
                        "Invoke-Rubeus",
                        "Invoke-RunAs",
                        "Invoke-SafetyKatz",
                        "Invoke-SauronEye",
                        "Invoke-SCShell",
                        "Invoke-Seatbelt",
                        "Invoke-ServiceAbuse",
                        "Invoke-ShadowSpray",
                        "Invoke-Sharp",
                        "Invoke-Shellcode",
                        "Invoke-SMBScanner",
                        "Invoke-Snaffler",
                        "Invoke-Spoolsample",
                        "Invoke-SpraySinglePassword",
                        "Invoke-SSHCommand",
                        "Invoke-StandIn",
                        "Invoke-StickyNotesExtract",
                        "Invoke-SystemCommand",
                        "Invoke-Tasksbackdoor",
                        "Invoke-Tater",
                        "Invoke-Thunderfox",
                        "Invoke-ThunderStruck",
                        "Invoke-TokenManipulation",
                        "Invoke-Tokenvator",
                        "Invoke-TotalExec",
                        "Invoke-UrbanBishop",
                        "Invoke-UserHunter",
                        "Invoke-VoiceTroll",
                        "Invoke-Whisker",
                        "Invoke-WinEnum",
                        "Invoke-winPEAS",
                        "Invoke-WireTap",
                        "Invoke-WmiCommand",
                        "Invoke-WMIExec",
                        "Invoke-WScriptBypassUAC",
                        "Invoke-Zerologon",
                        "MailRaider",
                        "New-ADIDNSNode",
                        "New-HoneyHash",
                        "New-InMemoryModule",
                        "New-SOASerialNumberArray",
                        "Out-Minidump",
                        "PowerBreach",
                        "powercat ",
                        "PowerUp",
                        "PowerView",
                        "Remove-ADIDNSNode",
                        "Remove-Update",
                        "Rename-ADIDNSNode",
                        "Revoke-ADIDNSPermission",
                        "Set-ADIDNSNode",
                        "Show-TargetScreen",
                        "Start-CaptureServer",
                        "Start-Dnscat2",
                        "Start-WebcamRecorder",
                        "VolumeShadowCopyTools"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2024/01/25",
            "references": [
                "https://adsecurity.org/?p=2921",
                "https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries",
                "https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1",
                "https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1",
                "https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1",
                "https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1",
                "https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/",
                "https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/",
                "https://github.com/calebstewart/CVE-2021-1675",
                "https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1",
                "https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html",
                "https://github.com/HarmJ0y/DAMP",
                "https://github.com/samratashok/nishang",
                "https://github.com/DarkCoderSc/PowerRunAsSystem/",
                "https://github.com/besimorhino/powercat",
                "https://github.com/Kevin-Robertson/Powermad",
                "https://github.com/adrecon/ADRecon",
                "https://github.com/adrecon/AzureADRecon"
            ],
            "related": [
                {
                    "id": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "02030f2f-6199-49ec-b258-ea71b07e03dc"
                },
                {
                    "id": "6d3f1399-a81c-4409-aff3-1ecfe9330baf",
                    "type": "obsoletes"
                },
                {
                    "id": "83083ac6-1816-4e76-97d7-59af9a9ae46e",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1482",
                "attack.t1087",
                "attack.t1087.001",
                "attack.t1087.002",
                "attack.t1069.001",
                "attack.t1069.002",
                "attack.t1069",
                "attack.t1059.001"
            ],
            "title": "Malicious PowerShell Commandlets - ScriptBlock"
        },
        {
            "id": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/20",
            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Payload|contains": [
                        "Add-Exfiltration",
                        "Add-Persistence",
                        "Add-RegBackdoor",
                        "Add-RemoteRegBackdoor",
                        "Add-ScrnSaveBackdoor",
                        "Check-VM",
                        "ConvertTo-Rc4ByteStream",
                        "Decrypt-Hash",
                        "Disable-ADIDNSNode",
                        "Disable-MachineAccount",
                        "Do-Exfiltration",
                        "Enable-ADIDNSNode",
                        "Enable-MachineAccount",
                        "Enabled-DuplicateToken",
                        "Exploit-Jboss",
                        "Export-ADR",
                        "Export-ADRCSV",
                        "Export-ADRExcel",
                        "Export-ADRHTML",
                        "Export-ADRJSON",
                        "Export-ADRXML",
                        "Find-Fruit",
                        "Find-GPOLocation",
                        "Find-TrustedDocuments",
                        "Get-ADIDNS",
                        "Get-ApplicationHost",
                        "Get-ChromeDump",
                        "Get-ClipboardContents",
                        "Get-FoxDump",
                        "Get-GPPPassword",
                        "Get-IndexedItem",
                        "Get-KerberosAESKey",
                        "Get-Keystrokes",
                        "Get-LSASecret",
                        "Get-MachineAccountAttribute",
                        "Get-MachineAccountCreator",
                        "Get-PassHashes",
                        "Get-RegAlwaysInstallElevated",
                        "Get-RegAutoLogon",
                        "Get-RemoteBootKey",
                        "Get-RemoteCachedCredential",
                        "Get-RemoteLocalAccountHash",
                        "Get-RemoteLSAKey",
                        "Get-RemoteMachineAccountHash",
                        "Get-RemoteNLKMKey",
                        "Get-RickAstley",
                        "Get-Screenshot",
                        "Get-SecurityPackages",
                        "Get-ServiceFilePermission",
                        "Get-ServicePermission",
                        "Get-ServiceUnquoted",
                        "Get-SiteListPassword",
                        "Get-System",
                        "Get-TimedScreenshot",
                        "Get-UnattendedInstallFile",
                        "Get-Unconstrained",
                        "Get-USBKeystrokes",
                        "Get-VaultCredential",
                        "Get-VulnAutoRun",
                        "Get-VulnSchTask",
                        "Grant-ADIDNSPermission",
                        "Gupt-Backdoor",
                        "HTTP-Login",
                        "Install-ServiceBinary",
                        "Install-SSP",
                        "Invoke-ACLScanner",
                        "Invoke-ADRecon",
                        "Invoke-ADSBackdoor",
                        "Invoke-AgentSmith",
                        "Invoke-AllChecks",
                        "Invoke-ARPScan",
                        "Invoke-AzureHound",
                        "Invoke-BackdoorLNK",
                        "Invoke-BadPotato",
                        "Invoke-BetterSafetyKatz",
                        "Invoke-BypassUAC",
                        "Invoke-Carbuncle",
                        "Invoke-Certify",
                        "Invoke-ConPtyShell",
                        "Invoke-CredentialInjection",
                        "Invoke-DAFT",
                        "Invoke-DCSync",
                        "Invoke-DinvokeKatz",
                        "Invoke-DllInjection",
                        "Invoke-DNSUpdate",
                        "Invoke-DomainPasswordSpray",
                        "Invoke-DowngradeAccount",
                        "Invoke-EgressCheck",
                        "Invoke-Eyewitness",
                        "Invoke-FakeLogonScreen",
                        "Invoke-Farmer",
                        "Invoke-Get-RBCD-Threaded",
                        "Invoke-Gopher",
                        "Invoke-Grouper",
                        "Invoke-HandleKatz",
                        "Invoke-ImpersonatedProcess",
                        "Invoke-ImpersonateSystem",
                        "Invoke-InteractiveSystemPowerShell",
                        "Invoke-Internalmonologue",
                        "Invoke-Inveigh",
                        "Invoke-InveighRelay",
                        "Invoke-KrbRelay",
                        "Invoke-LdapSignCheck",
                        "Invoke-Lockless",
                        "Invoke-MalSCCM",
                        "Invoke-Mimikatz",
                        "Invoke-Mimikittenz",
                        "Invoke-MITM6",
                        "Invoke-NanoDump",
                        "Invoke-NetRipper",
                        "Invoke-Nightmare",
                        "Invoke-NinjaCopy",
                        "Invoke-OfficeScrape",
                        "Invoke-OxidResolver",
                        "Invoke-P0wnedshell",
                        "Invoke-Paranoia",
                        "Invoke-PortScan",
                        "Invoke-PoshRatHttp",
                        "Invoke-PostExfil",
                        "Invoke-PowerDump",
                        "Invoke-PowerShellTCP",
                        "Invoke-PowerShellWMI",
                        "Invoke-PPLDump",
                        "Invoke-PsExec",
                        "Invoke-PSInject",
                        "Invoke-PsUaCme",
                        "Invoke-ReflectivePEInjection",
                        "Invoke-ReverseDNSLookup",
                        "Invoke-Rubeus",
                        "Invoke-RunAs",
                        "Invoke-SafetyKatz",
                        "Invoke-SauronEye",
                        "Invoke-SCShell",
                        "Invoke-Seatbelt",
                        "Invoke-ServiceAbuse",
                        "Invoke-ShadowSpray",
                        "Invoke-Sharp",
                        "Invoke-Shellcode",
                        "Invoke-SMBScanner",
                        "Invoke-Snaffler",
                        "Invoke-Spoolsample",
                        "Invoke-SpraySinglePassword",
                        "Invoke-SSHCommand",
                        "Invoke-StandIn",
                        "Invoke-StickyNotesExtract",
                        "Invoke-SystemCommand",
                        "Invoke-Tasksbackdoor",
                        "Invoke-Tater",
                        "Invoke-Thunderfox",
                        "Invoke-ThunderStruck",
                        "Invoke-TokenManipulation",
                        "Invoke-Tokenvator",
                        "Invoke-TotalExec",
                        "Invoke-UrbanBishop",
                        "Invoke-UserHunter",
                        "Invoke-VoiceTroll",
                        "Invoke-Whisker",
                        "Invoke-WinEnum",
                        "Invoke-winPEAS",
                        "Invoke-WireTap",
                        "Invoke-WmiCommand",
                        "Invoke-WMIExec",
                        "Invoke-WScriptBypassUAC",
                        "Invoke-Zerologon",
                        "MailRaider",
                        "New-ADIDNSNode",
                        "New-DNSRecordArray",
                        "New-HoneyHash",
                        "New-InMemoryModule",
                        "New-MachineAccount",
                        "New-SOASerialNumberArray",
                        "Out-Minidump",
                        "Port-Scan",
                        "PowerBreach",
                        "powercat ",
                        "PowerUp",
                        "PowerView",
                        "Remove-ADIDNSNode",
                        "Remove-MachineAccount",
                        "Remove-Update",
                        "Rename-ADIDNSNode",
                        "Revoke-ADIDNSPermission",
                        "Set-ADIDNSNode",
                        "Set-MacAttribute",
                        "Set-MachineAccountAttribute",
                        "Set-Wallpaper",
                        "Show-TargetScreen",
                        "Start-CaptureServer",
                        "Start-Dnscat2",
                        "Start-WebcamRecorder",
                        "VolumeShadowCopyTools"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "ps_module",
                "product": "windows",
                "definition": "0ad03ef1-f21b-4a79-8ce8-e6900c54b65b"
            },
            "modified": "2024/01/25",
            "references": [
                "https://adsecurity.org/?p=2921",
                "https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries",
                "https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1",
                "https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1",
                "https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1",
                "https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1",
                "https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/",
                "https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/",
                "https://github.com/calebstewart/CVE-2021-1675",
                "https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1",
                "https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html",
                "https://github.com/HarmJ0y/DAMP",
                "https://github.com/samratashok/nishang",
                "https://github.com/DarkCoderSc/PowerRunAsSystem/",
                "https://github.com/besimorhino/powercat",
                "https://github.com/Kevin-Robertson/Powermad",
                "https://github.com/adrecon/ADRecon",
                "https://github.com/adrecon/AzureADRecon"
            ],
            "related": [
                {
                    "id": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "02030f2f-6199-49ec-b258-ea71b07e03dc"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1482",
                "attack.t1087",
                "attack.t1087.001",
                "attack.t1087.002",
                "attack.t1069.001",
                "attack.t1069.002",
                "attack.t1069",
                "attack.t1059.001"
            ],
            "title": "Malicious PowerShell Commandlets - PoshModule"
        }
    ]
}