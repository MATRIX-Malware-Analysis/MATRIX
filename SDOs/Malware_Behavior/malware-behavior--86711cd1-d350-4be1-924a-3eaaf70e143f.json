{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--86711cd1-d350-4be1-924a-3eaaf70e143f",
    "created": "2024-08-13T14:46:37.071702Z",
    "modified": "2024-08-13T14:46:45.825551Z",
    "name": "Indicator Removal: Clear Mailbox Data",
    "description": "Adversaries may modify mail and mail application data to remove evidence of their activity. Email applications allow users and other programs to export and delete mailbox data via command line tools or use of APIs. Mail application data can be emails, email metadata, or logs generated by the application or operating system, such as export requests. Adversaries may manipulate emails and mailbox data to remove logs, artifacts, and metadata, such as evidence of Phishing/Internal Spearphishing, Email Collection, Mail Protocols for command and control, or email-based exfiltration such as Exfiltration Over Alternative Protocol. For example, to remove evidence on Exchange servers adversaries have used the ExchangePowerShell PowerShell module, including Remove-MailboxExportRequest to remove evidence of mailbox exports.[1][2] On Linux and macOS, adversaries may also delete emails through a command line utility called mail  or use AppleScript to interact with APIs on macOS.[3][4]Adversaries may also remove emails and metadata/headers indicative of spam or suspicious activity (for example, through the use of organization-wide transport rules) to reduce the likelihood of malicious emails being detected by security products.[5]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1070/008",
            "external_id": "T1070/008"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113",
            "date": "2024/05/10",
            "description": "Detects file access requests to Windows Outlook Mail by uncommon processes.\nCould indicate potential attempt of credential stealing.\nRequires heavy baselining before usage\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\system32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "filter_main_system": {
                    "Image": "System"
                },
                "filter_optional_defender": {
                    "Image|contains": ":\\ProgramData\\Microsoft\\Windows Defender\\",
                    "Image|endswith": [
                        "\\MpCopyAccelerator.exe",
                        "\\MsMpEng.exe"
                    ]
                },
                "filter_optional_thor": {
                    "Image|endswith": [
                        "\\thor64.exe",
                        "\\thor.exe"
                    ]
                },
                "selection_unistore": {
                    "FileName|contains": "\\AppData\\Local\\Comms\\Unistore\\data"
                },
                "selection_unistoredb": {
                    "FileName|endswith": "\\AppData\\Local\\Comms\\UnistoreDB\\store.vol"
                }
            },
            "falsepositives": [
                "Antivirus, Anti-Spyware, Anti-Malware Software",
                "Backup software",
                "Legitimate software installed on partitions other than \"C:\\\"",
                "Searching software such as \"everything.exe\""
            ],
            "id": "fc3e237f-2fef-406c-b90d-b3ae7e02fa8f",
            "level": "low",
            "logsource": {
                "category": "file_access",
                "definition": "Requirements: Microsoft-Windows-Kernel-File ETW provider",
                "product": "windows"
            },
            "references": [
                "https://darkdefender.medium.com/windows-10-mail-app-forensics-39025f5418d2",
                "https://github.com/redcanaryco/atomic-red-team/blob/58496ee3306e6e42a7054d36a94e6eb561ee3081/atomics/T1070.008/T1070.008.md#atomic-test-4---copy-and-modify-mailbox-data-on-windows"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1070.008",
                "attack.defense_evasion"
            ],
            "title": "Access To Windows Outlook Mail Files By Uncommon Application"
        }
    ]
}