{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--8b348767-fcea-40be-af4c-d51491330100",
    "created": "2024-08-13T14:46:36.874793Z",
    "modified": "2024-08-13T14:46:44.708503Z",
    "name": "Data Destruction",
    "description": "Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives.[1][2][3][4][5][6] Common operating system file deletion commands such as del and rm often only remove pointers to files without wiping the contents of the files themselves, making the files recoverable by proper forensic methodology. This behavior is distinct from Disk Content Wipe and Disk Structure Wipe because individual files are destroyed rather than sections of a storage disk or the disk's logical structure.Adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable.[4][5] In some cases politically oriented image files have been used to overwrite data.[2][3][4]To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware designed for destroying data may have worm-like features to propagate across a network by leveraging additional techniques like Valid Accounts, OS Credential Dumping, and SMB/Windows Admin Shares.[1][2][3][4][6].In cloud environments, adversaries may leverage access to delete cloud storage, cloud storage accounts, machine images, and other infrastructure crucial to operations to damage an organization or their customers.[7][8]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1485",
            "external_id": "T1485"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1485",
            "external_id": "T1485"
        },
        {
            "source_name": "DOJ  - Cisco Insider",
            "description": "DOJ. (2020, August 26). San Jose Man Pleads Guilty To Damaging Cisco\u2019s Network. Retrieved December 15, 2020.",
            "url": "https://www.justice.gov/usao-ndca/pr/san-jose-man-pleads-guilty-damaging-cisco-s-network"
        },
        {
            "source_name": "Unit 42 Shamoon3 2018",
            "description": "Falcone, R. (2018, December 13). Shamoon 3 Targets Oil and Gas Organization. Retrieved March 14, 2019.",
            "url": "https://unit42.paloaltonetworks.com/shamoon-3-targets-oil-gas-organization/"
        },
        {
            "source_name": "Palo Alto Shamoon Nov 2016",
            "description": "Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack Wiper. Retrieved January 11, 2017.",
            "url": "http://researchcenter.paloaltonetworks.com/2016/11/unit42-shamoon-2-return-disttrack-wiper/"
        },
        {
            "source_name": "FireEye Shamoon Nov 2016",
            "description": "FireEye. (2016, November 30). FireEye Responds to Wave of Destructive Cyber Attacks in Gulf Region. Retrieved January 11, 2017.",
            "url": "https://www.fireeye.com/blog/threat-research/2016/11/fireeye_respondsto.html"
        },
        {
            "source_name": "Kaspersky StoneDrill 2017",
            "description": "Kaspersky Lab. (2017, March 7). From Shamoon to StoneDrill: Wipers attacking Saudi organizations and beyond. Retrieved March 14, 2019.",
            "url": "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180722/Report_Shamoon_StoneDrill_final.pdf"
        },
        {
            "source_name": "Talos Olympic Destroyer 2018",
            "description": "Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.",
            "url": "https://blog.talosintelligence.com/2018/02/olympic-destroyer.html"
        },
        {
            "source_name": "Data Destruction - Threat Post",
            "description": "Mimoso, M.. (2014, June 18). Hacker Puts Hosting Service Code Spaces Out of Business. Retrieved December 15, 2020.",
            "url": "https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/"
        },
        {
            "source_name": "Symantec Shamoon 2012",
            "description": "Symantec. (2012, August 16). The Shamoon Attacks. Retrieved March 14, 2019.",
            "url": "https://www.symantec.com/connect/blogs/shamoon-attacks"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "austinsonger",
            "date": "2021/08/19",
            "description": "Detects when a Microsoft Cloud App Security reported a user has deleted a unusual a large volume of files.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "Unusual volume of file deletion",
                    "eventSource": "SecurityComplianceCenter",
                    "status": "success"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "78a34b67-3c39-4886-8fb4-61c46dc18ecd",
            "level": "medium",
            "logsource": {
                "product": "m365",
                "service": "threat_management"
            },
            "modified": "2022/10/09",
            "references": [
                "https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy",
                "https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "Microsoft 365 - Unusual Volume of File Deletion"
        },
        {
            "author": "Austin Songer",
            "date": "2021/08/16",
            "description": "Identifies when an EKS cluster is created or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "CreateCluster",
                        "DeleteCluster"
                    ],
                    "eventSource": "eks.amazonaws.com"
                }
            },
            "falsepositives": [
                "EKS Cluster being created or deleted may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "EKS Cluster created or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "33d50d03-20ec-4b74-a74e-1e65a38af1c0",
            "level": "low",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://any-api.com/amazonaws_com/eks/docs/API_Description"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "AWS EKS Cluster Created or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/15",
            "description": "Detects when a EFS Fileshare Mount is modified or deleted. An adversary breaking any file system using the mount target that is being deleted, which might disrupt instances or applications using those mounts.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "DeleteMountTarget",
                    "eventSource": "elasticfilesystem.amazonaws.com"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6a7ba45c-63d8-473e-9736-2eaabff79964",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://docs.aws.amazon.com/efs/latest/ug/API_DeleteMountTarget.html"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "AWS EFS Fileshare Mount Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/03",
            "description": "Identifies when a device or device configuration in azure is modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "properties.message": [
                        "Delete device",
                        "Delete device configuration",
                        "Update device",
                        "Update device configuration"
                    ]
                }
            },
            "falsepositives": [
                "Device or device configuration being modified or deleted may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Device or device configuration modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "46530378-f9db-4af9-a9e5-889c177d3881",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/10/09",
            "references": [
                "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/reference-audit-activities#core-directory"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485",
                "attack.t1565.001"
            ],
            "title": "Azure Device or Configuration Modified or Deleted"
        },
        {
            "author": "frack113",
            "date": "2021/06/03",
            "description": "Detects the use of SDelete to erase a file not the free space",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "CommandLine|contains": [
                        " -h",
                        " -c",
                        " -z",
                        " /\\?"
                    ]
                },
                "selection": {
                    "OriginalFileName": "sdelete.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "a4824fca-976f-4964-b334-0621379e84c4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/28",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md"
            ],
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "Potential File Overwrite Via Sysinternals SDelete"
        },
        {
            "author": "frack113",
            "date": "2021/12/26",
            "description": "Detects usage of the \"cipher\" built-in utility in order to overwrite deleted data from disk.\nAdversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources.\nData destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": " /w:"
                },
                "selection_img": [
                    {
                        "OriginalFileName": "CIPHER.EXE"
                    },
                    {
                        "Image|endswith": "\\cipher.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4b046706-5789-4673-b111-66f25fe99534",
            "level": "medium",
            "modified": "2023/02/21",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-3---overwrite-deleted-data-on-c-drive"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "Deleted Data Overwritten Via Cipher.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/06",
            "description": "Detects the use of a renamed SysInternals Sdelete, which is something an administrator shouldn't do (the renaming)",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": [
                        "\\sdelete.exe",
                        "\\sdelete64.exe"
                    ]
                },
                "selection": {
                    "OriginalFileName": "sdelete.exe"
                }
            },
            "falsepositives": [
                "System administrator usage"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "c1d867fe-8d95-4487-aab4-e53f2d339f90",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "status": "test",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/sdelete",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md"
            ],
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "Renamed Sysinternals Sdelete Execution"
        },
        {
            "author": "Ecco, E.M. Anhaus, oscd.community",
            "date": "2019/09/26",
            "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc).\nMight be used by ransomwares during the attack (seen by NotPetya and others).\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "deletejournal",
                        "createjournal",
                        "setZeroData"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\fsutil.exe"
                    },
                    {
                        "OriginalFileName": "fsutil.exe"
                    }
                ]
            },
            "falsepositives": [
                "Admin activity",
                "Scripts and administrative tools used in the monitored environment"
            ],
            "id": "add64136-62e5-48ea-807e-88638d02df1e",
            "level": "high",
            "modified": "2023/09/09",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070/T1070.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html",
                "https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md",
                "https://blog.cluster25.duskrise.com/2023/05/22/back-in-black-blackbyte-nt"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1070",
                "attack.t1485"
            ],
            "title": "Fsutil Suspicious Invocation"
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/06/14",
            "description": "Detects renaming of file while deletion with SDelete tool.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4656,
                        4663,
                        4658
                    ],
                    "ObjectName|endswith": [
                        ".AAA",
                        ".ZZZ"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate usage of SDelete"
            ],
            "id": "39a80702-d7ca-4a83-b776-525b1f86a36d",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/11/27",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/sdelete.htm",
                "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
                "https://learn.microsoft.com/en-gb/sysinternals/downloads/sdelete"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1070.004",
                "attack.t1027.005",
                "attack.t1485",
                "attack.t1553.002",
                "attack.s0195"
            ],
            "title": "Secure Deletion with SDelete"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Detects potential overwriting and deletion of a file using DD.",
            "detection": {
                "condition": "all of selection*",
                "selection1": {
                    "Image": [
                        "/bin/dd",
                        "/usr/bin/dd"
                    ]
                },
                "selection2": {
                    "CommandLine|contains": "of="
                },
                "selection3": {
                    "CommandLine|contains": [
                        "if=/dev/zero",
                        "if=/dev/null"
                    ]
                }
            },
            "falsepositives": [
                "Any user deleting files that way."
            ],
            "id": "2953194b-e33c-4859-b9e8-05948c167447",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/07/07",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-2---macoslinux---overwrite-file-with-dd"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1485"
            ],
            "title": "DD File Overwrite"
        },
        {
            "author": "Jakob Weinzettl, oscd.community",
            "date": "2019/10/23",
            "description": "Detects overwriting (effectively wiping/deleting) of a file.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0|contains": "dd",
                    "a1|contains": [
                        "if=/dev/null",
                        "if=/dev/zero"
                    ],
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Appending null bytes to files.",
                "Legitimate overwrite of files."
            ],
            "id": "37222991-11e9-4b6d-8bdf-60fbe48f753e",
            "level": "low",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "status": "stable",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md"
            ],
            "title": "Overwriting the File with Dev Zero or Null",
            "tags": [
                "attack.impact",
                "attack.t1485"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Linux",
        "macOS",
        "Containers"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Brent Murphy, Elastic",
        "David French, Elastic",
        "Syed Ummar Farooqh, McAfee",
        "Prasad Somasamudram, McAfee",
        "Sekhar Sarukkai, McAfee",
        "Varonis Threat Labs",
        "Joey Lei"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "impact"
        }
    ],
    "x_mitre_detection": "Use process monitoring to monitor the execution and command-line parameters of binaries that could be involved in data destruction activity, such as [SDelete](https://attack.mitre.org/software/S0195). Monitor for the creation of suspicious files as well as high unusual file modification activity. In particular, look for large quantities of file modifications in user directories and under <code>C:\\Windows\\System32\\</code>.\n\nIn cloud environments, the occurrence of anomalous high-volume deletion events, such as the <code>DeleteDBCluster</code> and <code>DeleteGlobalCluster</code> events in AWS, or a high quantity of data deletion events, such as <code>DeleteBucket</code>, within a short period of time may indicate suspicious activity.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Snapshot: Snapshot Deletion",
        "Process: Process Creation",
        "File: File Deletion",
        "Image: Image Deletion",
        "Instance: Instance Deletion",
        "File: File Modification",
        "Volume: Volume Deletion",
        "Cloud Storage: Cloud Storage Deletion",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": []
}