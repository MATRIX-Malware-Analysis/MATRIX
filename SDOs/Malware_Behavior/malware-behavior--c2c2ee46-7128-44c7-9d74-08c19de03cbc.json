{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c2c2ee46-7128-44c7-9d74-08c19de03cbc",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.287759Z",
    "name": "System Information Discovery",
    "description": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.Tools such as Systeminfo can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the systemsetup configuration tool on macOS. As an example, adversaries with user-level access can execute the df -aH command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a Network Device CLI on network devices to gather detailed system information (e.g. show version).[1] System Information Discovery combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.[2][3]Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.[4][5][6]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1082",
            "external_id": "T1082"
        },
        {
            "source_name": "CAPEC 312",
            "external_id": "malware-behavior--3c1c5ebe-17f5-4d48-b73c-78ee7b9482eb"
        },
        {
            "source_name": "CAPEC 313",
            "external_id": "malware-behavior--e2837b5f-a1e1-4e05-9bb9-d3ab655651b1"
        },
        {
            "source_name": "CAPEC 580",
            "external_id": "malware-behavior--6e758443-fb1f-4786-8e43-bc966e315d2c"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1082",
            "external_id": "T1082"
        },
        {
            "source_name": "Amazon Describe Instance",
            "description": "Amazon. (n.d.). describe-instance-information. Retrieved March 3, 2020.",
            "url": "https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-information.html"
        },
        {
            "source_name": "Google Instances Resource",
            "description": "Google. (n.d.). Rest Resource: instance. Retrieved March 3, 2020.",
            "url": "https://cloud.google.com/compute/docs/reference/rest/v1/instances"
        },
        {
            "source_name": "Microsoft Virutal Machine API",
            "description": "Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019.",
            "url": "https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get"
        },
        {
            "source_name": "20 macOS Common Tools and Techniques",
            "description": "Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.",
            "url": "https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/"
        },
        {
            "source_name": "OSX.FairyTale",
            "description": "Phile Stokes. (2018, September 20). On the Trail of OSX.FairyTale | Adware Playing at Malware. Retrieved August 24, 2021.",
            "url": "https://www.sentinelone.com/blog/trail-osx-fairytale-adware-playing-malware/"
        },
        {
            "source_name": "US-CERT-TA18-106A",
            "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
            "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "windows"
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "api": "iphlpapi.GetAdaptersInfo"
                                            },
                                            {
                                                "or": [
                                                    {
                                                        "offset": "0x194 = IP_ADAPTER_INFO.Address"
                                                    },
                                                    {
                                                        "offset": "0x195 = IP_ADAPTER_INFO.Address+1"
                                                    },
                                                    {
                                                        "offset": "0x196 = IP_ADAPTER_INFO.Address+2"
                                                    },
                                                    {
                                                        "offset": "0x197 = IP_ADAPTER_INFO.Address+3"
                                                    },
                                                    {
                                                        "offset": "0x198 = IP_ADAPTER_INFO.Address+4"
                                                    },
                                                    {
                                                        "offset": "0x199 = IP_ADAPTER_INFO.Address+5"
                                                    }
                                                ]
                                            },
                                            {
                                                "optional": [
                                                    {
                                                        "string": "%02X-%02X-%02X-%02X-%02X-%02X"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "api": "iphlpapi.GetAdaptersAddresses"
                                            },
                                            {
                                                "offset": "0x2C = PhysicalAddress"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "michael.hunhoff@mandiant.com",
                        "echernofsky@google.com"
                    ],
                    "examples": [
                        "al-khaser_x64.exe_:0x14001A1BC"
                    ],
                    "name": "get MAC address on Windows",
                    "namespace": "collection/network",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/Shared/Utils.cpp#L128",
                        "https://evasions.checkpoint.com/techniques/network.html#check-if-mac-address-is-specific"
                    ],
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "property/read": "System.Environment::OSVersion"
                            },
                            {
                                "property/read": "System.Environment::Is64BitOperatingSystem"
                            },
                            {
                                "property/read": "System.OperatingSystem::Version"
                            },
                            {
                                "property/read": "Microsoft.VisualBasic.Devices.ComputerInfo::OSFullName"
                            },
                            {
                                "property/read": "System.Runtime.InteropServices.RuntimeInformation::OSDescription"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "get OS version in .NET",
                    "namespace": "host-interaction/os/version",
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "match": "interact with driver via IOCTL"
                                    },
                                    {
                                        "characteristic": "indirect call"
                                    }
                                ]
                            },
                            {
                                "number": "0x90064 = FSCTL_GET_NTFS_VOLUME_DATA"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "name": "get volume information via IOCTL",
                    "namespace": "host-interaction/hardware/storage",
                    "references": [
                        "https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-3/"
                    ],
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "number": "0x7FFE0260 = NtBuildNumber"
                            },
                            {
                                "number": "0x7FFE026C = NtMajorVersion"
                            },
                            {
                                "number": "0x7FFE0270 = NtMinorVersion"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "@mr-tz"
                    ],
                    "name": "get OS information via KUSER_SHARED_DATA",
                    "namespace": "host-interaction/os/version",
                    "references": [
                        "https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/api/ntexapi_x/kuser_shared_data/index.htm"
                    ],
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "michael.hunhoff@mandiant.com",
                        "echernofsky@google.com"
                    ],
                    "name": "get MAC address in .NET",
                    "namespace": "collection/network",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "linux"
                            },
                            {
                                "match": "host-interaction/file-system/read"
                            },
                            {
                                "description": "pseudo-file path like /sys/class/net/eth0/address",
                                "string": "/\\/sys\\/class\\/net\\/\\S+\\/address/"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "name": "get MAC address on Linux",
                    "namespace": "collection/network",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "match": "interact with driver via IOCTL"
                                    },
                                    {
                                        "characteristic": "indirect call"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "number": "0x70050 = IOCTL_DISK_GET_DRIVE_LAYOUT_EX"
                                    },
                                    {
                                        "number": "0x24050 = IOCTL_DISK_GET_DRIVE_GEOMETRY_EX"
                                    },
                                    {
                                        "number": "0x2d1080 = IOCTL_STORAGE_GET_DEVICE_NUMBER"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "name": "get disk information via IOCTL",
                    "namespace": "host-interaction/hardware/storage",
                    "references": [
                        "https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-3/",
                        "http://www.ioctls.net/"
                    ],
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "linux"
                            },
                            {
                                "or": [
                                    {
                                        "api": "sysconf"
                                    },
                                    {
                                        "and": [
                                            {
                                                "api": "system"
                                            },
                                            {
                                                "string": "lshw"
                                            }
                                        ]
                                    },
                                    {
                                        "api": "sysinfo"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "joakim@intezer.com",
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "get system information on Linux",
                    "namespace": "host-interaction/os/info",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "contain loop"
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "api": "kernel32.FindFirstVolume"
                                            },
                                            {
                                                "api": "kernel32.FindNextVolume"
                                            },
                                            {
                                                "optional": [
                                                    {
                                                        "api": "kernel32.FindVolumeClose"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "api": "kernel32.FindFirstVolumeMountPoint"
                                            },
                                            {
                                                "api": "kernel32.FindNextVolumeMountPoint"
                                            },
                                            {
                                                "optional": [
                                                    {
                                                        "api": "kernel32.FindVolumeMountPointClose"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "enumerate disk volumes",
                    "namespace": "host-interaction/hardware/storage",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "match": "PEB access"
                                    },
                                    {
                                        "or": [
                                            {
                                                "and": [
                                                    {
                                                        "arch": "i386"
                                                    },
                                                    {
                                                        "number": "0x64 = PEB->NumberOfProcessors"
                                                    }
                                                ]
                                            },
                                            {
                                                "and": [
                                                    {
                                                        "arch": "amd64"
                                                    },
                                                    {
                                                        "number": "0xB8 = PEB->NumberOfProcessors"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "property/read": "System.Environment::ProcessorCount"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x432CB0"
                    ],
                    "name": "get number of processors",
                    "namespace": "host-interaction/hardware/cpu",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"
                    ],
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "string": "/SELECT\\s+\\*\\s+FROM\\s+Win32_Processor/"
                            },
                            {
                                "string": "NumberOfCores"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x435BA0"
                    ],
                    "name": "get number of processor cores",
                    "namespace": "host-interaction/hardware/cpu",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L207"
                    ],
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "os": "windows"
                                    },
                                    {
                                        "match": "query or enumerate registry value"
                                    },
                                    {
                                        "string": "/Hardware\\\\Description\\\\System\\\\CentralProcessor/i"
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "os": "linux"
                                    },
                                    {
                                        "match": "host-interaction/file-system/read"
                                    },
                                    {
                                        "string": "/proc/cpuinfo"
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "os": "linux"
                                    },
                                    {
                                        "api": "system"
                                    },
                                    {
                                        "substring": "/proc/cpuinfo"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "joakim@intezer.com"
                    ],
                    "examples": [
                        "BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A"
                    ],
                    "name": "get CPU information",
                    "namespace": "host-interaction/hardware/cpu",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "basic block": [
                                    {
                                        "and": [
                                            {
                                                "api": "setupapi.SetupDiGetClassDevs"
                                            },
                                            {
                                                "bytes": "67 E9 36 4D 25 E3 CE 11 BF C1 08 00 2B E1 03 18 = GUID_DEVCLASS_DISKDRIVE"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "api": "setupapi.SetupDiEnumDeviceInfo"
                            },
                            {
                                "api": "setupapi.SetupDiGetDeviceRegistryProperty"
                            },
                            {
                                "optional": [
                                    {
                                        "api": "setupapi.SetupDiDestroyDeviceInfoList"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x4369B0"
                    ],
                    "name": "enumerate disk properties",
                    "namespace": "host-interaction/hardware/storage",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L518"
                    ],
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "kernel32.GetDriveType"
                            },
                            {
                                "api": "kernel32.GetLogicalDrives"
                            },
                            {
                                "api": "kernel32.GetVolumeInformation"
                            },
                            {
                                "api": "kernel32.GetVolumeNameForVolumeMountPoint"
                            },
                            {
                                "api": "kernel32.GetVolumePathNamesForVolumeName"
                            },
                            {
                                "api": "kernel32.GetLogicalDriveStrings"
                            },
                            {
                                "api": "kernel32.QueryDosDevice"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::VolumeLabel"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::DriveType"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::DriveFormat"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::Name"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "examples": [
                        "9324D1A8AE37A36AE560C37448C9705A:0x4052A0",
                        "972B219F18379907A045431303F4DA7D:0x41064E"
                    ],
                    "name": "get disk information",
                    "namespace": "host-interaction/hardware/storage",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "kernel32.GetDiskFreeSpace"
                            },
                            {
                                "api": "kernel32.GetDiskFreeSpaceEx"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::TotalSize"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::TotalFreeSpace"
                            },
                            {
                                "property/read": "System.IO.DriveInfo::AvailableFreeSpace"
                            },
                            {
                                "basic block": [
                                    {
                                        "and": [
                                            {
                                                "match": "interact with driver via IOCTL"
                                            },
                                            {
                                                "number": "0x7405C = IOCTL_DISK_GET_LENGTH_INFO"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "call": [
                                    {
                                        "and": [
                                            {
                                                "match": "interact with driver via IOCTL"
                                            },
                                            {
                                                "number": "0x7405C = IOCTL_DISK_GET_LENGTH_INFO"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "or": [
                                            {
                                                "string": "/SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i"
                                            },
                                            {
                                                "string": "/SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i"
                                            }
                                        ]
                                    },
                                    {
                                        "string": "Size"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x4343D0",
                        "al-khaser_x86.exe_:0x434010"
                    ],
                    "name": "get disk size",
                    "namespace": "host-interaction/hardware/storage",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    },
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347"
                    ]
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "kernel32.GlobalMemoryStatus"
                            },
                            {
                                "api": "kernel32.GlobalMemoryStatusEx"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com"
                    ],
                    "examples": [
                        "9324D1A8AE37A36AE560C37448C9705A:0x4052A0"
                    ],
                    "name": "get memory capacity",
                    "namespace": "host-interaction/hardware/memory",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "or": [
                                            {
                                                "os": "linux"
                                            },
                                            {
                                                "os": "android"
                                            }
                                        ]
                                    },
                                    {
                                        "match": "host-interaction/file-system/read"
                                    },
                                    {
                                        "string": "/proc/meminfo"
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "or": [
                                            {
                                                "os": "linux"
                                            },
                                            {
                                                "os": "android"
                                            }
                                        ]
                                    },
                                    {
                                        "api": "system"
                                    },
                                    {
                                        "or": [
                                            {
                                                "substring": "/proc/meminfo"
                                            },
                                            {
                                                "string": "/^free/"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "examples": [
                        "7351f8a40c5450557b24622417fc478d:0x405438"
                    ],
                    "name": "get memory information",
                    "namespace": "host-interaction/hardware/memory",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "query environment variable"
                            },
                            {
                                "or": [
                                    {
                                        "string": "COMSPEC"
                                    },
                                    {
                                        "string": "%COMSPEC%"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "matthew.williams@mandiant.com"
                    ],
                    "examples": [
                        "Practical Malware Analysis Lab 14-02.exe_:0x401880"
                    ],
                    "mbc": [
                        "Operating System::Environment Variable [C0034]"
                    ],
                    "name": "get COMSPEC environment variable",
                    "namespace": "host-interaction/environment-variable",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "kernel32.GetEnvironmentVariable"
                            },
                            {
                                "api": "kernel32.GetEnvironmentStrings"
                            },
                            {
                                "api": "kernel32.ExpandEnvironmentStrings"
                            },
                            {
                                "api": "msvcr90.getenv"
                            },
                            {
                                "api": "msvcrt.getenv"
                            },
                            {
                                "api": "System.Environment::GetEnvironmentVariable"
                            },
                            {
                                "api": "System.Environment::GetEnvironmentVariables"
                            },
                            {
                                "api": "System.Environment::ExpandEnvironmentVariables"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "@_re_fox"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "examples": [
                        "Practical Malware Analysis Lab 14-02.exe_:0x401880",
                        "0761142efbda6c4b1e801223de723578:0x65483490"
                    ],
                    "name": "query environment variable",
                    "namespace": "host-interaction/environment-variable",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "kernel32.GetComputerName"
                            },
                            {
                                "api": "kernel32.GetComputerNameEx"
                            },
                            {
                                "api": "GetComputerObjectName"
                            },
                            {
                                "api": "ws2_32.gethostname"
                            },
                            {
                                "api": "gethostname"
                            },
                            {
                                "property/read": "System.Environment::MachineName"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "joakim@intezer.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "examples": [
                        "9324D1A8AE37A36AE560C37448C9705A:0x4052A0",
                        "7351f8a40c5450557b24622417fc478d:0x405438"
                    ],
                    "name": "get hostname",
                    "namespace": "host-interaction/os/hostname",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "windows"
                            },
                            {
                                "or": [
                                    {
                                        "api": "kernel32.GetSystemInfo"
                                    },
                                    {
                                        "api": "kernel32.GetNativeSystemInfo"
                                    },
                                    {
                                        "api": "NtQuerySystemInformation"
                                    },
                                    {
                                        "api": "NtQuerySystemInformationEx"
                                    },
                                    {
                                        "api": "ntdll.RtlGetNativeSystemInformation"
                                    },
                                    {
                                        "api": "ZwQuerySystemInformation"
                                    },
                                    {
                                        "api": "ZwQuerySystemInformationEx"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "joakim@intezer.com"
                    ],
                    "examples": [
                        "563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280"
                    ],
                    "name": "get system information on Windows",
                    "namespace": "host-interaction/os/info",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "get OS version"
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "instruction": [
                                                    {
                                                        "mnemonic": "cmp"
                                                    },
                                                    {
                                                        "number": "5 = Windows 2000"
                                                    }
                                                ]
                                            },
                                            {
                                                "optional": [
                                                    {
                                                        "instruction": [
                                                            {
                                                                "mnemonic": "cmp"
                                                            },
                                                            {
                                                                "or": [
                                                                    {
                                                                        "number": 0
                                                                    },
                                                                    {
                                                                        "number": "1 = Windows XP"
                                                                    },
                                                                    {
                                                                        "number": "2 = Windows XP 64-bit / Windows Server 2003 / Windows Server 2003 R2"
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "instruction": [
                                                    {
                                                        "mnemonic": "cmp"
                                                    },
                                                    {
                                                        "number": "6 = Windows Vista / Windows Server 2008"
                                                    }
                                                ]
                                            },
                                            {
                                                "optional": [
                                                    {
                                                        "instruction": [
                                                            {
                                                                "mnemonic": "cmp"
                                                            },
                                                            {
                                                                "or": [
                                                                    {
                                                                        "number": 0
                                                                    },
                                                                    {
                                                                        "number": "1 = Windows Server 2008 R2 / Windows 7"
                                                                    },
                                                                    {
                                                                        "number": "2 = Windows Server 2012 / Windows 8"
                                                                    },
                                                                    {
                                                                        "number": "3 = Windows Server 2012 R2 / Windows 8.1"
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "instruction": [
                                                    {
                                                        "mnemonic": "cmp"
                                                    },
                                                    {
                                                        "number": "10 = Windows Server 2016 / Windows Server 2019 / Windows 10"
                                                    }
                                                ]
                                            },
                                            {
                                                "optional": [
                                                    {
                                                        "instruction": [
                                                            {
                                                                "mnemonic": "cmp"
                                                            },
                                                            {
                                                                "number": 0
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "johnk3r"
                    ],
                    "mbc": [
                        "Discovery::System Information Discovery [E1082]"
                    ],
                    "examples": [
                        "493167E85E45363D09495D0841C30648:0x401000"
                    ],
                    "namespace": "host-interaction/os/version",
                    "name": "check OS version",
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "linux"
                            },
                            {
                                "or": [
                                    {
                                        "api": "uname"
                                    },
                                    {
                                        "and": [
                                            {
                                                "api": "system"
                                            },
                                            {
                                                "string": "uname"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "examples": [
                        "7351f8a40c5450557b24622417fc478d:0x405438"
                    ],
                    "name": "get kernel version",
                    "namespace": "host-interaction/os/version",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "linux"
                            },
                            {
                                "match": "host-interaction/file-system/read"
                            },
                            {
                                "or": [
                                    {
                                        "string": "/etc/os-release"
                                    },
                                    {
                                        "string": "/etc/lsb-release"
                                    },
                                    {
                                        "string": "/etc/issue"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Information Discovery [T1082]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "examples": [
                        "7351f8a40c5450557b24622417fc478d:0x405438"
                    ],
                    "name": "get Linux distribution",
                    "namespace": "host-interaction/os/version",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects user data export activity.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": [
                        "User permissions export failed",
                        "User permissions export started",
                        "User permissions exported"
                    ],
                    "auditType.category": "Users and groups"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "5259cbf2-0a75-48bf-b57a-c54d6fabaef3",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://support.atlassian.com/security-and-access-policies/docs/export-user-accounts"
            ],
            "status": "experimental",
            "tags": [
                "attack.collection",
                "attack.reconnaissance",
                "attack.discovery",
                "attack.t1213",
                "attack.t1082",
                "attack.t1591.004"
            ],
            "title": "Bitbucket User Details Export Attempt Detected"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects user permission data export attempt.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": [
                        "User details export failed",
                        "User details export started",
                        "User details exported"
                    ],
                    "auditType.category": "Users and groups"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "87cc6698-3e07-4ba2-9b43-a85a73e151e2",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/users-and-groups-776640439.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.reconnaissance",
                "attack.t1213",
                "attack.t1082",
                "attack.t1591.004"
            ],
            "title": "Bitbucket User Permissions Export Attempt"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Find information about network devices that is not stored in config files",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "dir",
                    "show arp",
                    "show cdp",
                    "show clock",
                    "show ip interface",
                    "show ip route",
                    "show ip sockets",
                    "show processes",
                    "show ssh",
                    "show users",
                    "show version"
                ]
            },
            "falsepositives": [
                "Commonly used by administrators for troubleshooting"
            ],
            "id": "9705a6a1-6db6-4a16-a987-15b7151e299b",
            "level": "low",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "references": [
                "https://www.cisco.com/c/en/us/td/docs/server_nw_virtual/2-5_release/command_reference/show.html"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1083",
                "attack.t1201",
                "attack.t1057",
                "attack.t1018",
                "attack.t1082",
                "attack.t1016",
                "attack.t1049",
                "attack.t1033",
                "attack.t1124"
            ],
            "title": "Cisco Discovery"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/12/20",
            "description": "Detects the use of \"ioreg\" which will show I/O Kit registry information.\nThis process is used for system information discovery.\nIt has been observed in-the-wild by calling this process directly or using bash and grep to look for specific strings.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmd1": {
                    "CommandLine|contains": [
                        "-l",
                        "-c"
                    ]
                },
                "selection_cmd2": {
                    "CommandLine|contains": [
                        "AppleAHCIDiskDriver",
                        "IOPlatformExpertDevice",
                        "Oracle",
                        "Parallels",
                        "USB Vendor Name",
                        "VirtualBox",
                        "VMware"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "/ioreg"
                    },
                    {
                        "CommandLine|contains": "ioreg"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative activities"
            ],
            "id": "2d5e7a8b-f484-4a24-945d-7f0efd52eab0",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2024/01/02",
            "status": "experimental",
            "references": [
                "https://www.virustotal.com/gui/file/0373d78db6c3c0f6f6dcc409821bf89e1ad8c165d6f95c5c80ecdce2219627d7/behavior",
                "https://www.virustotal.com/gui/file/4ffdc72d1ff1ee8228e31691020fc275afd1baee5a985403a71ca8c7bd36e2e4/behavior",
                "https://www.virustotal.com/gui/file/5907d59ec1303cfb5c0a0f4aaca3efc0830707d86c732ba6b9e842b5730b95dc/behavior",
                "https://www.trendmicro.com/en_ph/research/20/k/new-macos-backdoor-connected-to-oceanlotus-surfaces.html"
            ],
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "System Information Discovery Using Ioreg"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/12/20",
            "description": "Detects the use of \"sw_vers\" for system information discovery",
            "detection": {
                "condition": "all of selection_*",
                "selection_image": {
                    "Image|endswith": "/sw_vers"
                },
                "selection_options": {
                    "CommandLine|contains": [
                        "-buildVersion",
                        "-productName",
                        "-productVersion"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative activities"
            ],
            "id": "5de06a6f-673a-4fc0-8d48-bcfe3837b033",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://www.virustotal.com/gui/file/d3fa64f63563fe958b75238742d1e473800cb5f49f5cb79d38d4aa3c93709026/behavior",
                "https://www.virustotal.com/gui/file/03b71eaceadea05bc0eea5cddecaa05f245126d6b16cfcd0f3ba0442ac58dab3/behavior",
                "https://ss64.com/osx/sw_vers.html"
            ],
            "status": "experimental",
            "title": "System Information Discovery Using sw_vers",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "Stephen Lincoln `@slincoln_aiq` (AttackIQ)",
            "date": "2024/01/02",
            "description": "Detects the execution of \"system_profiler\" with specific \"Data Types\" that have been seen being used by threat actors and malware. It provides system hardware and software configuration information.\nThis process is primarily used for system information discovery. However, \"system_profiler\" can also be used to determine if virtualization software is being run for defense evasion purposes.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmd": {
                    "CommandLine|contains": [
                        "SPApplicationsDataType",
                        "SPHardwareDataType",
                        "SPNetworkDataType",
                        "SPUSBDataType"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "/system_profiler"
                    },
                    {
                        "CommandLine|contains": "system_profiler"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative activities"
            ],
            "id": "4809c683-059b-4935-879d-36835986f8cf",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://www.trendmicro.com/en_za/research/20/k/new-macos-backdoor-connected-to-oceanlotus-surfaces.html",
                "https://www.sentinelone.com/wp-content/uploads/pdf-gen/1630910064/20-common-tools-techniques-used-by-macos-threat-actors-malware.pdf",
                "https://ss64.com/mac/system_profiler.html",
                "https://objective-see.org/blog/blog_0x62.html",
                "https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/",
                "https://gist.github.com/nasbench/9a1ba4bc7094ea1b47bc42bf172961af"
            ],
            "status": "experimental",
            "tags": [
                "attack.discovery",
                "attack.defense_evasion",
                "attack.t1082",
                "attack.t1497.001"
            ],
            "title": "System Information Discovery Using System_Profiler"
        },
        {
            "author": "Pratinav Chandra",
            "date": "2024/05/27",
            "description": "Detects the execution of \"sysctl\" with specific arguments that have been used by threat actors and malware. It provides system hardware information.\nThis process is primarily used to detect and avoid virtualization and analysis environments.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmd": {
                    "CommandLine|contains": [
                        "hw.",
                        "kern.",
                        "machdep."
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "/sysctl"
                    },
                    {
                        "CommandLine|contains": "sysctl"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative activities"
            ],
            "id": "6ff08e55-ea53-4f27-94a1-eff92e6d9d5c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://www.loobins.io/binaries/sysctl/#",
                "https://evasions.checkpoint.com/techniques/macos.html",
                "https://www.welivesecurity.com/2019/04/09/oceanlotus-macos-malware-update/",
                "https://www.sentinelone.com/labs/20-common-tools-techniques-used-by-macos-threat-actors-malware/",
                "https://objective-see.org/blog/blog_0x1E.html",
                "https://www.virustotal.com/gui/file/1c547a064494a35d6b5e6b459de183ab2720a22725e082bed6f6629211f7abc1/behavior",
                "https://www.virustotal.com/gui/file/b4b1fc65f87b3dcfa35e2dbe8e0a34ad9d8a400bec332025c0a2e200671038aa/behavior"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1497.001",
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "System Information Discovery Via Sysctl - MacOS"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/12/28",
            "description": "Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1",
            "detection": {
                "condition": "1 of selection*",
                "selection_obfuscated": {
                    "CommandLine|contains|all": [
                        "syscall:::return",
                        "lkd("
                    ]
                },
                "selection_plain": {
                    "CommandLine|contains": "lkd(0)",
                    "Image|endswith": "\\dtrace.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7124aebe-4cd7-4ccb-8df0-6d6b93c96795",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://twitter.com/0gtweet/status/1474899714290208777?s=12",
                "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/dtrace"
            ],
            "status": "test",
            "title": "Suspicious Kernel Dump Using Dtrace",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/01",
            "description": "Detects usage of the \"systeminfo\" command to retrieve information",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\systeminfo.exe"
                    },
                    {
                        "OriginalFileName": "sysinfo.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0ef56343-059e-4cb6-adc1-4c3c967c5e46",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/07/14",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-1---system-information-discovery",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/systeminfo"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "Suspicious Execution of Systeminfo"
        },
        {
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2023/12/04",
            "description": "Detects commandline keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "Offline_Winpwn",
                        "WinPwn ",
                        "WinPwn.exe",
                        "WinPwn.ps1"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d557dc06-62e8-4468-a8e8-7984124908ce",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/S3cur3Th1sSh1t/WinPwn",
                "https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841",
                "https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/",
                "https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md",
                "https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team"
            ],
            "related": [
                {
                    "id": "851fd622-b675-4d26-b803-14bc7baa517a",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.discovery",
                "attack.execution",
                "attack.privilege_escalation",
                "attack.t1046",
                "attack.t1082",
                "attack.t1106",
                "attack.t1518",
                "attack.t1548.002",
                "attack.t1552.001",
                "attack.t1555",
                "attack.t1555.003"
            ],
            "title": "HackTool - WinPwn Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2023/05/08",
            "description": "Detects the execution of System Informer, a task manager tool to view and manipulate processes, kernel options and other low level operations",
            "detection": {
                "condition": "1 of selection_*",
                "selection_hash_values": [
                    {
                        "md5": "19426363A37C03C3ED6FEDF57B6696EC"
                    },
                    {
                        "sha1": "8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC"
                    },
                    {
                        "sha256": "8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287"
                    },
                    {
                        "Imphash": "B68908ADAEB5D662F87F2528AF318F12"
                    }
                ],
                "selection_hashes": {
                    "Hashes|contains": [
                        "MD5=19426363A37C03C3ED6FEDF57B6696EC",
                        "SHA1=8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC",
                        "SHA256=8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287",
                        "IMPHASH=B68908ADAEB5D662F87F2528AF318F12"
                    ]
                },
                "selection_image": [
                    {
                        "Image|endswith": "\\SystemInformer.exe"
                    },
                    {
                        "OriginalFileName": "SystemInformer.exe"
                    },
                    {
                        "Description": "System Informer"
                    },
                    {
                        "Product": "System Informer"
                    }
                ]
            },
            "falsepositives": [
                "System Informer is regularly used legitimately by system administrators or developers. Apply additional filters accordingly"
            ],
            "id": "5722dff1-4bdd-4949-86ab-fbaf707e767a",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/winsiderss/systeminformer"
            ],
            "related": [
                {
                    "id": "811e0002-b13b-4a15-9d00-a613fce66e42",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.discovery",
                "attack.defense_evasion",
                "attack.t1082",
                "attack.t1564",
                "attack.t1543"
            ],
            "title": "PUA - System Informer Execution"
        },
        {
            "author": "Janantha Marasinghe",
            "date": "2022/11/18",
            "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
            "detection": {
                "condition": "selection_img and (1 of selection_flags_*)",
                "selection_flags_configure": {
                    "CommandLine|contains|all": [
                        "/configure",
                        "/db"
                    ]
                },
                "selection_flags_discovery": {
                    "CommandLine|contains|all": [
                        "/export",
                        "/cfg"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\secedit.exe"
                    },
                    {
                        "OriginalFileName": "SeCEdit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative use"
            ],
            "id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.privilege_escalation",
                "attack.t1562.002",
                "attack.t1547.001",
                "attack.t1505.005",
                "attack.t1556.002",
                "attack.t1562",
                "attack.t1574.007",
                "attack.t1564.002",
                "attack.t1546.008",
                "attack.t1546.007",
                "attack.t1547.014",
                "attack.t1547.010",
                "attack.t1547.002",
                "attack.t1557",
                "attack.t1082"
            ],
            "title": "Potential Suspicious Activity Using SeCEdit"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/07",
            "description": "Detects a set of suspicious network related commands often used in recon stages",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "nslookup",
                        "_ldap._tcp.dc._msdcs."
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "id": "e6313acd-208c-44fc-a0ff-db85d572e90e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1087",
                "attack.t1082",
                "car.2016-03-001"
            ],
            "title": "Network Reconnaissance Activity"
        },
        {
            "author": "Stephen Lincoln `@slincoln-aiq`(AttackIQ)",
            "date": "2024/02/02",
            "description": "An adversary might use WMI to discover information about the system, such as the volume name, size,\nfree space, and other disk information. This can be done using the `wmic` command-line utility and has been\nobserved being used by threat actors such as Volt Typhoon.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "volume",
                        "path win32_logicaldisk"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c79da740-5030-45ec-a2e0-479e824a562c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
            ],
            "related": [
                {
                    "id": "d85ecdd7-b855-4e6e-af59-d9c78b5b861e",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1047",
                "attack.t1082"
            ],
            "title": "System Disk And Volume Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali",
            "date": "2022/10/10",
            "description": "Detects suspicious use of PCHunter, a tool like Process Hacker to view and manipulate processes, kernel options and other low level stuff",
            "detection": {
                "condition": "1 of selection_*",
                "selection_hash_values": [
                    {
                        "md5": [
                            "228dd0c2e6287547e26ffbd973a40f14",
                            "987b65cd9b9f4e9a1afd8f8b48cf64a7"
                        ]
                    },
                    {
                        "sha1": [
                            "5f1cbc3d99558307bc1250d084fa968521482025",
                            "3fb89787cb97d902780da080545584d97fb1c2eb"
                        ]
                    },
                    {
                        "sha256": [
                            "2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32",
                            "55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c"
                        ]
                    },
                    {
                        "Imphash": [
                            "444d210cea1ff8112f256a4997eed7ff",
                            "0479f44df47cfa2ef1ccc4416a538663"
                        ]
                    }
                ],
                "selection_hashes": {
                    "Hashes|contains": [
                        "SHA1=5F1CBC3D99558307BC1250D084FA968521482025",
                        "MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7",
                        "SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32",
                        "IMPHASH=444D210CEA1FF8112F256A4997EED7FF",
                        "SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB",
                        "MD5=228DD0C2E6287547E26FFBD973A40F14",
                        "SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C",
                        "IMPHASH=0479F44DF47CFA2EF1CCC4416A538663"
                    ]
                },
                "selection_image": {
                    "Image|endswith": [
                        "\\PCHunter64.exe",
                        "\\PCHunter32.exe"
                    ]
                },
                "selection_pe": [
                    {
                        "OriginalFileName": "PCHunter.exe"
                    },
                    {
                        "Description": "Epoolsoft Windows Information View Tools"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "fca949cc-79ca-446e-8064-01aa7e52ece5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "http://www.xuetr.com/",
                "https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/",
                "https://www.hexacorn.com/blog/2018/04/20/kernel-hacking-tool-you-might-have-never-heard-of-xuetr-pchunter/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1082",
                "attack.t1057",
                "attack.t1012",
                "attack.t1083",
                "attack.t1007"
            ],
            "title": "HackTool - PCHunter Execution"
        },
        {
            "author": "Georg Lauenstein (sure[secure])",
            "date": "2022/09/19",
            "description": "WinPEAS is a script that search for possible paths to escalate privileges on Windows hosts. The checks are explained on book.hacktricks.xyz",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli_dl": {
                    "CommandLine|contains": "https://github.com/carlospolop/PEASS-ng/releases/latest/download/"
                },
                "selection_cli_option": {
                    "CommandLine|contains": [
                        " applicationsinfo",
                        " browserinfo",
                        " eventsinfo",
                        " fileanalysis",
                        " filesinfo",
                        " processinfo",
                        " servicesinfo",
                        " windowscreds"
                    ]
                },
                "selection_cli_specific": [
                    {
                        "ParentCommandLine|endswith": " -linpeas"
                    },
                    {
                        "CommandLine|endswith": " -linpeas"
                    }
                ],
                "selection_img": [
                    {
                        "OriginalFileName": "winPEAS.exe"
                    },
                    {
                        "Image|endswith": [
                            "\\winPEASany_ofs.exe",
                            "\\winPEASany.exe",
                            "\\winPEASx64_ofs.exe",
                            "\\winPEASx64.exe",
                            "\\winPEASx86_ofs.exe",
                            "\\winPEASx86.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "98b53e78-ebaf-46f8-be06-421aafd176d9",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/23",
            "references": [
                "https://github.com/carlospolop/PEASS-ng",
                "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation"
            ],
            "status": "test",
            "tags": [
                "attack.privilege_escalation",
                "attack.t1082",
                "attack.t1087",
                "attack.t1046"
            ],
            "title": "HackTool - winPEAS Execution"
        },
        {
            "author": "frack113",
            "date": "2022/01/01",
            "description": "Use of reg to get MachineGuid information",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "SOFTWARE\\Microsoft\\Cryptography",
                        "/v ",
                        "MachineGuid"
                    ],
                    "Image|endswith": "\\reg.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f5240972-3938-4e56-8e4b-e33893176c1f",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-8---windows-machineguid-discovery"
            ],
            "status": "test",
            "title": "Suspicious Query of MachineGUID",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/01",
            "description": "Use of hostname to get information",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\HOSTNAME.EXE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7be5fb68-f9ef-476d-8b51-0256ebece19e",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-6---hostname-discovery-windows",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/hostname"
            ],
            "status": "test",
            "title": "Suspicious Execution of Hostname",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "TropChaud",
            "date": "2023/01/26",
            "description": "Detects the use of the WMI command-line (WMIC) utility to identify and display various system information,\nincluding OS, CPU, GPU, and disk drive names; memory capacity; display resolution; and baseboard, BIOS,\nand GPU driver products/versions.\nSome of these commands were used by Aurora Stealer in late 2022/early 2023.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_commands": {
                    "CommandLine|contains": [
                        "LOGICALDISK get Name,Size,FreeSpace",
                        "os get Caption,OSArchitecture,Version"
                    ]
                },
                "selection_wmic": [
                    {
                        "Description": "WMI Commandline Utility"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    },
                    {
                        "Image|endswith": "\\WMIC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9d5a1274-922a-49d0-87f3-8c653483b909",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/19",
            "status": "experimental",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/a2ccd19c37d0278b4ffa8583add3cf52060a5418/atomics/T1082/T1082.md#atomic-test-25---system-information-discovery-with-wmic",
                "https://nwgat.ninja/getting-system-information-with-wmic-on-windows/",
                "https://blog.sekoia.io/aurora-a-rising-stealer-flying-under-the-radar",
                "https://blog.cyble.com/2023/01/18/aurora-a-stealer-using-shapeshifting-tactics/",
                "https://app.any.run/tasks/a6aa0057-82ec-451f-8f99-55650ca537da/",
                "https://www.virustotal.com/gui/file/d6f6bc10ae0e634ed4301d584f61418cee18e5d58ad9af72f8aa552dc4aaeca3/behavior"
            ],
            "related": [
                {
                    "id": "d85ecdd7-b855-4e6e-af59-d9c78b5b861e",
                    "type": "derived"
                }
            ],
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "Uncommon System Information Discovery Via Wmic.EXE"
        },
        {
            "id": "851fd622-b675-4d26-b803-14bc7baa517a",
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2023/12/04",
            "description": "Detects scriptblock text keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Offline_Winpwn",
                        "WinPwn ",
                        "WinPwn.exe",
                        "WinPwn.ps1"
                    ]
                }
            },
            "falsepositives": [
                "As the script block is a blob of text. False positive may occur with scripts that contain the keyword as a reference or simply use it for detection."
            ],
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/S3cur3Th1sSh1t/WinPwn",
                "https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841",
                "https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/",
                "https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md",
                "https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "d557dc06-62e8-4468-a8e8-7984124908ce"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.discovery",
                "attack.execution",
                "attack.privilege_escalation",
                "attack.t1046",
                "attack.t1082",
                "attack.t1106",
                "attack.t1518",
                "attack.t1548.002",
                "attack.t1552.001",
                "attack.t1555",
                "attack.t1555.003"
            ],
            "title": "HackTool - WinPwn Execution - ScriptBlock"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/06/02",
            "description": "Detects the use of grep to discover specific files created by the GobRAT malware",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "apached",
                        "frpc",
                        "sshd.sh",
                        "zone.arm"
                    ],
                    "Image|endswith": "/grep"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e34cfa0c-0a50-4210-9cb3-5632d08eb041",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.jpcert.or.jp/en/2023/05/gobrat.html",
                "https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection",
                "https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection"
            ],
            "status": "test",
            "title": "Potential GobRAT File Discovery Via Grep",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "Seth Hanford",
            "date": "2023/08/23",
            "description": "Detects listing of the inodes of the \"/\" directory to determine if the we are running inside of a container.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " -*i",
                        " -*d"
                    ],
                    "CommandLine|endswith": " /",
                    "Image|endswith": "/ls"
                }
            },
            "falsepositives": [
                "Legitimate system administrator usage of these commands",
                "Some container tools or deployments may use these techniques natively to determine how they proceed with execution, and will need to be filtered"
            ],
            "id": "43e26eb5-cd58-48d1-8ce9-a273f5d298d8",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blog.skyplabs.net/posts/container-detection/",
                "https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker"
            ],
            "status": "test",
            "title": "Potential Container Discovery Via Inodes Listing",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "Seth Hanford",
            "date": "2023/08/23",
            "description": "Detects potential container discovery via listing of certain kernel features in the \"/proc\" virtual filesystem",
            "detection": {
                "condition": "selection_tools and 1 of selection_procfs_*",
                "selection_procfs_kthreadd": {
                    "CommandLine|contains": "/proc/2/"
                },
                "selection_procfs_target": {
                    "CommandLine|contains": "/proc/",
                    "CommandLine|endswith": [
                        "/cgroup",
                        "/sched"
                    ]
                },
                "selection_tools": {
                    "Image|endswith": [
                        "awk",
                        "/cat",
                        "grep",
                        "/head",
                        "/less",
                        "/more",
                        "/nl",
                        "/tail"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate system administrator usage of these commands",
                "Some container tools or deployments may use these techniques natively to determine how they proceed with execution, and will need to be filtered"
            ],
            "id": "746c86fb-ccda-4816-8997-01386263acc4",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blog.skyplabs.net/posts/container-detection/",
                "https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker"
            ],
            "status": "test",
            "title": "Container Residence Discovery Via Proc Virtual FS",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "Seth Hanford",
            "date": "2023/08/23",
            "description": "Detects listing or file reading of \".dockerenv\" which can be a sing of potential container discovery",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|endswith": ".dockerenv",
                    "Image|endswith": [
                        "/cat",
                        "/dir",
                        "/find",
                        "/ls",
                        "/stat",
                        "/test",
                        "grep"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate system administrator usage of these commands",
                "Some container tools or deployments may use these techniques natively to determine how they proceed with execution, and will need to be filtered"
            ],
            "id": "11701de9-d5a5-44aa-8238-84252f131895",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blog.skyplabs.net/posts/container-detection/",
                "https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker"
            ],
            "status": "test",
            "title": "Docker Container Discovery Via Dockerenv Listing",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/06/02",
            "description": "Detects the use of grep to identify information about the operating system architecture. Often combined beforehand with the execution of \"uname\" or \"cat /proc/cpuinfo\"\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_architecture": {
                    "CommandLine|endswith": [
                        "aarch64",
                        "arm",
                        "i386",
                        "i686",
                        "mips",
                        "x86_64"
                    ]
                },
                "selection_process": {
                    "Image|endswith": "/grep"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d27ab432-2199-483f-a297-03633c05bae6",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.jpcert.or.jp/en/2023/05/gobrat.html",
                "https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/",
                "https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection",
                "https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection"
            ],
            "status": "test",
            "title": "OS Architecture Discovery Via Grep",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ]
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/08",
            "description": "Detects system information discovery commands",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/uname",
                        "/hostname",
                        "/uptime",
                        "/lspci",
                        "/dmidecode",
                        "/lscpu",
                        "/lsmod"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "42df45e7-e6e9-43b5-8f26-bec5b39cc239",
            "level": "informational",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2021/09/14",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md"
            ],
            "status": "stable",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "System Information Discovery"
        },
        {
            "author": "Pawel Mazur",
            "date": "2021/09/03",
            "description": "Detects System Information Discovery commands",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "name": [
                        "/etc/lsb-release",
                        "/etc/redhat-release",
                        "/etc/issue"
                    ],
                    "type": "PATH"
                },
                "selection_2": {
                    "a0": [
                        "uname",
                        "uptime",
                        "lsmod",
                        "hostname",
                        "env"
                    ],
                    "type": "EXECVE"
                },
                "selection_3": {
                    "a0": "grep",
                    "type": "EXECVE",
                    "a1|contains": [
                        "vbox",
                        "vm",
                        "xen",
                        "virtio",
                        "hv"
                    ]
                },
                "selection_4": {
                    "a0": "kmod",
                    "type": "EXECVE",
                    "a1": "list"
                }
            },
            "falsepositives": [
                "Likely"
            ],
            "id": "f34047d9-20d3-4e8b-8672-0a35cc50dc71",
            "level": "low",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2023/03/06",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f296668303c29d3f4c07e42bdd2b28d8dd6625f9/atomics/T1082/T1082.md"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "System Information Discovery - Auditd"
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/08",
            "description": "Detects system information discovery commands",
            "detection": {
                "condition": "selection",
                "selection": {
                    "name": [
                        "/sys/class/dmi/id/bios_version",
                        "/sys/class/dmi/id/product_name",
                        "/sys/class/dmi/id/chassis_vendor",
                        "/proc/scsi/scsi",
                        "/proc/ide/hd0/model",
                        "/proc/version",
                        "/etc/*version",
                        "/etc/*release",
                        "/etc/issue"
                    ],
                    "type": "PATH"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "1f358e2e-cb63-43c3-b575-dfb072a6814f",
            "level": "informational",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/11/26",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-4---linux-vm-check-via-hardware"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "42df45e7-e6e9-43b5-8f26-bec5b39cc239"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.discovery",
                "attack.t1082"
            ],
            "title": "System and Hardware Information Discovery"
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Linux",
        "macOS",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Maril Vernon @shewhohacks",
        "Praetorian",
        "Austin Clark, @c2defense"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "discovery"
        }
    ],
    "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to gather  detailed system information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use  commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nIn cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information. Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.5",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: OS API Execution",
        "Process: Process Creation",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": []
}