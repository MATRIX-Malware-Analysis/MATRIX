{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--d7ab6b6b-2a06-4c5f-84ab-9e912269dbf1",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:44.581411Z",
    "name": "Modify Authentication Process: Multi-Factor Authentication",
    "description": "Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts.Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as Multi-Factor Authentication Request Generation, adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality.[1][2]For example, modifying the Windows hosts file (C:\\windows\\system32\\drivers\\etc\\hosts) to redirect MFA calls to localhost instead of an MFA server may cause the MFA process to fail. If a 'fail open' policy is in place, any otherwise successful authentication attempt may be granted access without enforcing MFA. [3] Depending on the scope, goals, and privileges of the adversary, MFA defenses may be disabled for individual accounts or for all accounts tied to a larger group, such as all domain accounts in a victim's network environment.[3]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1556/006",
            "external_id": "T1556/006"
        },
        {
            "source_name": "CAPEC 578",
            "external_id": "malware-behavior--2f8f9894-8e67-43f6-99d5-2527cce30d1c"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/21",
            "description": "Detects when an attempt at deactivating  or resetting MFA.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventtype": [
                        "user.mfa.factor.deactivate",
                        "user.mfa.factor.reset_all"
                    ]
                }
            },
            "falsepositives": [
                "If a MFA reset or deactivated was performed by a system administrator."
            ],
            "id": "50e068d7-1e6b-4054-87e5-0a592c40c7e0",
            "level": "medium",
            "logsource": {
                "product": "okta",
                "service": "okta"
            },
            "modified": "2022/10/09",
            "references": [
                "https://developer.okta.com/docs/reference/api/system-log/",
                "https://developer.okta.com/docs/reference/api/event-types/"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.t1556.006"
            ],
            "title": "Okta MFA Reset or Deactivated"
        },
        {
            "author": "MikeDuddington, '@dudders1'",
            "date": "2022/07/27",
            "description": "Detect when users are authenticating without MFA being required.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AuthenticationRequirement": "singleFactorAuthentication",
                    "Status": "Success"
                }
            },
            "falsepositives": [
                "If this was approved by System Administrator."
            ],
            "id": "28eea407-28d7-4e42-b0be-575d5ba60b2c",
            "level": "low",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "references": [
                "https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1556.006"
            ],
            "title": "Azure AD Only Single Factor Authentication Required"
        }
    ]
}