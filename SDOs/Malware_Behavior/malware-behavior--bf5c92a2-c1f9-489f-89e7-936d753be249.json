{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--bf5c92a2-c1f9-489f-89e7-936d753be249",
    "created": "2020-12-04T00:00:00.000Z",
    "modified": "2024-04-30T00:00:00.000Z",
    "name": "Create Process",
    "description": "",
    "labels": [
        "malware-behavior"
    ],
    "object_marking_refs": [
        "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
    ],
    "x_mitre_platforms": [],
    "x_mitre_domains": [],
    "x_mitre_contributors": [],
    "kill_chain_phases": [],
    "x_mitre_detection": "",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "",
    "x_mitre_data_sources": [],
    "x_mitre_permissions_required": [],
    "external_references": [
        {
            "source_name": "falliere-stuxnet",
            "description": "N. Falliere, L. Murchu, and E. Chien, \"W32.Stuxnet Dossier,\" Symantec Security Response, Feb. 2011 [Online].",
            "url": "https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en"
        },
        {
            "source_name": "capa analysis",
            "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
            "url": "https://github.com/mandiant/capa-rules"
        }
    ],
    "obj_defn": {
        "description": "Malware creates a process.",
        "external_id": "C0017",
        "source_name": "mitre-mbc",
        "url": "https://github.com/MBCProject/mbc-markdown/blob/main/micro-behaviors/process/create-process.md"
    },
    "detection_rules": [
        {
            "api_fncs": [
                "kernel32.WinExec",
                "kernel32.CreateProcess",
                "shell32.ShellExecute",
                "shell32.ShellExecuteEx",
                "advapi32.CreateProcessAsUser",
                "advapi32.CreateProcessWithLogon",
                "advapi32.CreateProcessWithToken",
                "kernel32.CreateProcessInternal",
                "ntdll.NtCreateUserProcess",
                "ntdll.NtCreateProcess",
                "ntdll.NtCreateProcessEx",
                "ntdll.ZwCreateProcess",
                "ZwCreateProcessEx",
                "ntdll.ZwCreateUserProcess",
                "ntdll.RtlCreateUserProcess",
                "System.Diagnostics.Process::Start"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "create process on Windows",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/create/create-process-on-windows.yml"
        },
        {
            "api_fncs": [
                "execve",
                "execl",
                "execlp",
                "execle",
                "execv",
                "execvp",
                "execvpe",
                "posix_spawn",
                "posix_spawnp",
                "popen"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "create process on Linux",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/create/create-process-on-linux.yml"
        },
        {
            "api_fncs": [
                "system",
                "_system",
                "wsystem",
                "_wsystem"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "execute command",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/create/execute-command.yml"
        },
        {
            "api_fncs": [
                "kernel32.CreateProcess",
                "kernel32.CreateProcessInternal",
                "advapi32.CreateProcessAsUser",
                "advapi32.CreateProcessWithLogon",
                "advapi32.CreateProcessWithToken",
                "kernel32.GetStartupInfo",
                "System.Diagnostics.Process::Start"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "create a process with modified I/O handles and window",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/create/create-a-process-with-modified-io-handles-and-window.yml"
        },
        {
            "api_fncs": [
                "kernel32.CreateProcess",
                "advapi32.CreateProcessAsUser"
            ],
            "detect_ref": "malware-method--5bb7833c-f660-4ea5-b9be-f04c2122e722",
            "rule_name": "create process suspended",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/create/create-process-suspended.yml"
        },
        {
            "api_fncs": [
                "ShellExecuteExW",
                "CreateProcessInternalW"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "stealth_system_procname",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/stealth_system_procname.py"
        },
        {
            "api_fncs": [
                "NtCreateUserProcess",
                "CreateProcessInternalW"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "stack_pivot_process_create",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/stack_pivot_process_create.py"
        },
        {
            "api_fncs": [
                "NtCreateUserProcess",
                "CreateProcessInternalW"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "wmi_create_process",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/wmi_create_process.py"
        },
        {
            "api_fncs": [
                "NtCreateUserProcess",
                "CreateProcessInternalW"
            ],
            "detect_ref": "malware-method--8ba94a0a-1a37-43f0-bf49-dcbbd430bdb7",
            "rule_name": "wmi_create_process",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/wmi_create_process.py"
        },
        {
            "api_fncs": [
                "NtCreateUserProcess",
                "CreateProcessInternalW"
            ],
            "detect_ref": "malware-behavior--fb32a192-ac5d-43c9-af7a-34992a0efb21",
            "rule_name": "script_created_process",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/script_created_process.py"
        }
    ],
    "tags": []
}