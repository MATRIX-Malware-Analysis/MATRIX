{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--fff1e69f-6812-4a7e-9994-ae25e6e44df8",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.601443Z",
    "name": "Brute Force",
    "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.[1] Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism.[2] Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes.Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to Valid Accounts within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as OS Credential Dumping, Account Discovery, or Password Policy Discovery. Adversaries may also combine brute forcing activity with behaviors such as External Remote Services as part of Initial Access.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1110",
            "external_id": "T1110"
        },
        {
            "source_name": "CAPEC 112",
            "external_id": "malware-behavior--853b4522-b977-427a-95ef-a9548c70e3f4"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1110",
            "external_id": "T1110"
        },
        {
            "source_name": "TrendMicro Pawn Storm Dec 2020",
            "description": "Hacquebord, F., Remorin, L. (2020, December 17). Pawn Storm\u2019s Lack of Sophistication as a Strategy. Retrieved January 13, 2021.",
            "url": "https://www.trendmicro.com/en_us/research/20/l/pawn-storm-lack-of-sophistication-as-a-strategy.html"
        },
        {
            "source_name": "Dragos Crashoverride 2018",
            "description": "Joe Slowik. (2018, October 12). Anatomy of an Attack: Detecting and Defeating CRASHOVERRIDE. Retrieved December 18, 2020.",
            "url": "https://www.dragos.com/wp-content/uploads/CRASHOVERRIDE2018.pdf"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/07/08",
            "description": "Detects suspicious user agent strings user by hack tools in proxy logs",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-useragent|contains": [
                        "(hydra)",
                        " arachni/",
                        " BFAC ",
                        " brutus ",
                        " cgichk ",
                        "core-project/1.0",
                        " crimscanner/",
                        "datacha0s",
                        "dirbuster",
                        "domino hunter",
                        "dotdotpwn",
                        "FHScan Core",
                        "floodgate",
                        "get-minimal",
                        "gootkit auto-rooter scanner",
                        "grendel-scan",
                        " inspath ",
                        "internet ninja",
                        "jaascois",
                        " zmeu ",
                        "masscan",
                        " metis ",
                        "morfeus fucking scanner",
                        "n-stealth",
                        "nsauditor",
                        "pmafind",
                        "security scan",
                        "springenwerk",
                        "teh forest lobster",
                        "toata dragostea",
                        " vega/",
                        "voideye",
                        "webshag",
                        "webvulnscan",
                        " whcc/",
                        " Havij",
                        "absinthe",
                        "bsqlbf",
                        "mysqloit",
                        "pangolin",
                        "sql power injector",
                        "sqlmap",
                        "sqlninja",
                        "uil2pn",
                        "ruler",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ClientIP",
                "c-uri",
                "c-useragent"
            ],
            "id": "c42a3073-30fb-48ae-8c99-c23ada84b103",
            "level": "high",
            "logsource": {
                "category": "proxy"
            },
            "modified": "2022/07/07",
            "references": [
                "https://github.com/fastly/waf_testbed/blob/8bfc406551f3045e418cbaad7596cff8da331dfc/templates/default/scanners-user-agents.data.erb",
                "http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "attack.credential_access",
                "attack.t1110"
            ],
            "title": "Hack Tool User Agent"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects user authentication failure events.\nPlease note that this rule can be noisy and it is recommended to use with correlation based on \"author.name\" field.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "User login failed",
                    "auditType.category": "Authentication"
                }
            },
            "falsepositives": [
                "Legitimate user wrong password attempts."
            ],
            "id": "70ed1d26-0050-4b38-a599-92c53d57d45a",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110"
            ],
            "title": "Bitbucket User Login Failure"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects SSH user login access failures.\nPlease note that this rule can be noisy and is recommended to use with correlation based on \"author.name\" field.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "User login failed(SSH)",
                    "auditType.category": "Authentication"
                }
            },
            "falsepositives": [
                "Legitimate user wrong password attempts."
            ],
            "id": "d3f90469-fb05-42ce-b67d-0fded91bbef3",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/view-and-configure-the-audit-log-776640417.html",
                "https://confluence.atlassian.com/bitbucketserver/enable-ssh-access-to-git-repositories-776640358.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1021.004",
                "attack.t1110"
            ],
            "title": "Bitbucket User Login Failure Via SSH"
        },
        {
            "author": "Mark Morowczynski '@markmorow', Gloria Lee, '@gleeiamglo'",
            "date": "2023/09/03",
            "description": "Indicates that a password spray attack has been successfully performed.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "riskEventType": "passwordSpray"
                }
            },
            "falsepositives": [
                "We recommend investigating the sessions flagged by this detection in the context of other sign-ins from the user."
            ],
            "id": "28ecba0a-c743-4690-ad29-9a8f6f25a6f9",
            "logsource": {
                "product": "azure",
                "service": "riskdetection"
            },
            "level": "high",
            "references": [
                "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#password-spray",
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins"
            ],
            "tags": [
                "attack.t1110",
                "attack.credential_access"
            ],
            "title": "Password Spray Activity",
            "status": "test"
        },
        {
            "author": "Yochana Henderson, '@Yochana-H'",
            "date": "2022/06/17",
            "description": "Alert on when legacy authentication has been used on an account",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ActivityDetails": "Sign-ins",
                    "ClientApp": [
                        "Other client",
                        "IMAP",
                        "POP3",
                        "MAPI",
                        "SMTP",
                        "Exchange ActiveSync",
                        "Exchange Web Services"
                    ],
                    "Username": "UPN"
                }
            },
            "falsepositives": [
                "User has been put in acception group so they can use legacy authentication"
            ],
            "id": "60f6535a-760f-42a9-be3f-c9a0a025906e",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "level": "high",
            "references": [
                "https://learn.microsoft.com/en-gb/entra/architecture/security-operations-privileged-accounts"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110"
            ],
            "title": "Use of Legacy Authentication Protocols",
            "status": "test"
        },
        {
            "author": "Yochana Henderson, '@Yochana-H'",
            "date": "2022/06/01",
            "description": "Define a baseline threshold for failed sign-ins due to Conditional Access failures",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ResultType": 53003,
                    "Resultdescription": "Blocked by Conditional Access"
                }
            },
            "falsepositives": [
                "Service Account misconfigured",
                "Misconfigured Systems",
                "Vulnerability Scanners"
            ],
            "id": "b4a6d707-9430-4f5f-af68-0337f52d5c42",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "level": "high",
            "references": [
                "https://learn.microsoft.com/en-gb/entra/architecture/security-operations-privileged-accounts"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1110",
                "attack.t1078.004"
            ],
            "title": "Sign-in Failure Due to Conditional Access Requirements Not Met",
            "status": "test"
        },
        {
            "author": "AlertIQ",
            "date": "2021/10/10",
            "description": "Identifies user account which has been locked because the user tried to sign in too many times with an incorrect user ID or password.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ResultType": 50053
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2b7d6fc0-71ac-4cf7-8ed1-b5788ee5257a",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "modified": "2022/12/25",
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1110"
            ],
            "title": "Account Lockout"
        },
        {
            "author": "AlertIQ",
            "date": "2022/03/24",
            "description": "User has indicated they haven't instigated the MFA prompt and could indicate an attacker has the password for the account.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AuthenticationRequirement": "multiFactorAuthentication",
                    "Status|contains": "MFA Denied"
                }
            },
            "falsepositives": [
                "Users actually login but miss-click into the Deny button when MFA prompt."
            ],
            "id": "e40f4962-b02b-4192-9bfe-245f7ece1f99",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "references": [
                "https://www.microsoft.com/security/blog/2022/03/22/dev-0537-criminal-actor-targeting-organizations-for-data-exfiltration-and-destruction/"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110",
                "attack.t1621"
            ],
            "title": "Multifactor Authentication Denied",
            "status": "test"
        },
        {
            "author": "AlertIQ",
            "date": "2021/10/10",
            "description": "Detect access has been blocked by Conditional Access policies.\nThe access policy does not allow token issuance which might be sights\u2248 of unauthorizeed login to valid accounts.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ResultType": 53003
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9a60e676-26ac-44c3-814b-0c2a8b977adf",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "modified": "2022/12/25",
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.initial_access",
                "attack.t1110",
                "attack.t1078.004"
            ],
            "title": "User Access Blocked by Azure Conditional Access"
        },
        {
            "author": "MikeDuddington, '@dudders1'",
            "date": "2022/07/28",
            "description": "Detect successful authentications from countries you do not operate out of.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Location|contains": "<Countries you DO operate out of e,g GB, use OR for multiple>"
                },
                "selection": {
                    "Status": "Success"
                }
            },
            "falsepositives": [
                "If this was approved by System Administrator."
            ],
            "id": "8c944ecb-6970-4541-8496-be554b8e2846",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "references": [
                "https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110"
            ],
            "title": "Successful Authentications From Countries You Do Not Operate Out Of",
            "status": "test"
        },
        {
            "author": "MikeDuddington, '@dudders1'",
            "date": "2022/07/28",
            "description": "Detect failed authentications from countries you do not operate out of.",
            "detection": {
                "condition": "not selection and not selection1",
                "selection": {
                    "Status": "Success"
                },
                "selection1": {
                    "Location|contains": "<Countries you DO operate out of e,g GB, use OR for multiple>"
                }
            },
            "falsepositives": [
                "If this was approved by System Administrator."
            ],
            "id": "28870ae4-6a13-4616-bd1a-235a7fad7458",
            "level": "low",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "references": [
                "https://learn.microsoft.com/en-gb/entra/architecture/security-operations-user-accounts"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110"
            ],
            "title": "Failed Authentications From Countries You Do Not Operate Out Of",
            "status": "test"
        },
        {
            "author": "AlertIQ",
            "date": "2021/10/10",
            "description": "Identifies user login with multifactor authentication failures, which might be an indication an attacker has the password for the account but can't pass the MFA challenge.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_500121": {
                    "ResultDescription|contains": "Authentication failed during strong authentication request",
                    "ResultType": 500121
                },
                "selection_50074": {
                    "ResultDescription|contains": "Strong Auth required",
                    "ResultType": 50074
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5496ff55-42ec-4369-81cb-00f417029e25",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "modified": "2022/12/18",
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110",
                "attack.t1621"
            ],
            "status": "test",
            "title": "Multifactor Authentication Interrupted"
        },
        {
            "author": "Harjot Singh, '@cyb3rjy0t'",
            "date": "2023/03/20",
            "description": "Detects successful authentication from potential clients using legacy authentication via user agent strings. This could be a sign of MFA bypass using a password spray attack.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Status": "Success",
                    "userAgent|contains": [
                        "BAV2ROPC",
                        "CBAinPROD",
                        "CBAinTAR"
                    ]
                }
            },
            "falsepositives": [
                "Known Legacy Accounts"
            ],
            "id": "53bb4f7f-48a8-4475-ac30-5a82ddfdf6fc",
            "logsource": {
                "product": "azure",
                "service": "signinlogs"
            },
            "level": "high",
            "references": [
                "https://blooteem.com/march-2022",
                "https://www.microsoft.com/en-us/security/blog/2021/10/26/protect-your-business-from-password-sprays-with-microsoft-dart-recommendations/"
            ],
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1078.004",
                "attack.t1110"
            ],
            "title": "Potential MFA Bypass Using Legacy Client Authentication",
            "status": "test"
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects juniper BGP missing MD5 digest. Which may be indicative of brute force attacks to manipulate routing.",
            "detection": {
                "condition": "keywords_bgp_juniper",
                "keywords_bgp_juniper": {
                    "|all": [
                        ":179",
                        "missing MD5 digest"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "host"
            ],
            "id": "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
            "level": "low",
            "logsource": {
                "definition": "Requirements: juniper bgp logs need to be enabled and ingested",
                "product": "juniper",
                "service": "bgp"
            },
            "modified": "2023/01/23",
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ],
            "title": "Juniper BGP Missing MD5"
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects LDP failures which may be indicative of brute force attacks to manipulate MPLS labels",
            "detection": {
                "condition": "selection_protocol and selection_keywords",
                "selection_keywords": [
                    "SOCKET_TCP_PACKET_MD5_AUTHEN_FAIL",
                    "TCPMD5AuthenFail"
                ],
                "selection_protocol": [
                    "LDP"
                ]
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "tcpConnLocalAddress",
                "tcpConnRemAddress"
            ],
            "id": "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
            "level": "low",
            "logsource": {
                "definition": "Requirements: cisco ldp logs need to be enabled and ingested",
                "product": "cisco",
                "service": "ldp"
            },
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "title": "Cisco LDP Authentication Failures",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ]
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing",
            "detection": {
                "condition": "keywords_bgp_cisco",
                "keywords_bgp_cisco": {
                    "|all": [
                        ":179",
                        "IP-TCP-3-BADAUTH"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "tcpConnLocalAddress",
                "tcpConnRemAddress"
            ],
            "id": "56fa3cd6-f8d6-4520-a8c7-607292971886",
            "level": "low",
            "logsource": {
                "definition": "Requirements: cisco bgp logs need to be enabled and ingested",
                "product": "cisco",
                "service": "bgp"
            },
            "modified": "2023/01/23",
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ],
            "title": "Cisco BGP Authentication Failures"
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing.",
            "detection": {
                "condition": "keywords_bgp_huawei",
                "keywords_bgp_huawei": {
                    "|all": [
                        ":179",
                        "BGP_AUTH_FAILED"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "host",
                "PeeId"
            ],
            "id": "a557ffe6-ac54-43d2-ae69-158027082350",
            "level": "low",
            "logsource": {
                "definition": "Requirements: huawei bgp logs need to be enabled and ingested",
                "product": "huawei",
                "service": "bgp"
            },
            "modified": "2023/01/23",
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ],
            "title": "Huawei BGP Authentication Failures"
        },
        {
            "author": "Vasiliy Burov",
            "date": "2020/10/05",
            "description": "Detects command line parameters used by Hydra password guessing hack tool",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "^USER^",
                        "^PASS^"
                    ],
                    "CommandLine|contains|all": [
                        "-u ",
                        "-p "
                    ]
                }
            },
            "falsepositives": [
                "Software that uses the caret encased keywords PASS and USER in its command line"
            ],
            "id": "aaafa146-074c-11eb-adc1-0242ac120002",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/02/04",
            "references": [
                "https://github.com/vanhauser-thc/thc-hydra"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1110",
                "attack.t1110.001"
            ],
            "title": "HackTool - Hydra Password Bruteforce Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/25",
            "description": "This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.",
            "detection": {
                "condition": "1 of selection_* or all of part_localauth*",
                "part_localauth_1": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -p "
                    ]
                },
                "part_localauth_2": {
                    "CommandLine|contains|all": [
                        " 10.",
                        " 192.168.",
                        "/24 "
                    ]
                },
                "selection_binary": {
                    "Image|endswith": "\\crackmapexec.exe"
                },
                "selection_execute": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -x "
                    ]
                },
                "selection_hash": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -p ",
                        " -H 'NTHASH'"
                    ]
                },
                "selection_module_mssql": {
                    "CommandLine|contains|all": [
                        " mssql ",
                        " -u ",
                        " -p ",
                        " -M ",
                        " -d "
                    ]
                },
                "selection_module_smb1": {
                    "CommandLine|contains|all": [
                        " smb ",
                        " -u ",
                        " -H ",
                        " -M ",
                        " -o "
                    ]
                },
                "selection_module_smb2": {
                    "CommandLine|contains|all": [
                        " smb ",
                        " -u ",
                        " -p ",
                        " --local-auth"
                    ]
                },
                "selection_special": {
                    "CommandLine|contains": " -M pe_inject "
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine"
            ],
            "id": "42a993dd-bb3e-48c8-b372-4d6684c4106c",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/03/08",
            "references": [
                "https://mpgn.gitbook.io/crackmapexec/smb-protocol/authentication/checking-credentials-local",
                "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
                "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=mssql-mimikatz",
                "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-pe_inject"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.credential_access",
                "attack.discovery",
                "attack.t1047",
                "attack.t1053",
                "attack.t1059.003",
                "attack.t1059.001",
                "attack.t1110",
                "attack.t1201"
            ],
            "title": "HackTool - CrackMapExec Execution"
        },
        {
            "author": "frack113",
            "date": "2021/12/27",
            "description": "Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "-a ",
                        "-m 1000 ",
                        "-r "
                    ]
                },
                "selection_img": {
                    "Image|endswith": "\\hashcat.exe"
                }
            },
            "falsepositives": [
                "Tools that use similar command line flags and values"
            ],
            "id": "39b31e81-5f5f-4898-9c0e-2160cfc0f9bf",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/02/04",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1110.002/T1110.002.md#atomic-test-1---password-cracking-with-hashcat",
                "https://hashcat.net/wiki/doku.php?id=hashcat"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1110.002"
            ],
            "title": "HackTool - Hashcat Password Cracker Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), KevTheHermit, fuzzyf10w",
            "date": "2021/06/30",
            "description": "Detect Attempt PrintNightmare (CVE-2021-1675) Remote code execution in Windows Spooler Service",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 31017,
                    "ServerName|startswith": "\\1",
                    "UserName": ""
                }
            },
            "falsepositives": [
                "Account fallback reasons (after failed login with specific account)"
            ],
            "fields": [
                "Computer",
                "User"
            ],
            "id": "71886b70-d7b4-4dbf-acce-87d2ca135262",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "smbclient-security"
            },
            "modified": "2023/01/02",
            "references": [
                "https://twitter.com/KevTheHermit/status/1410203844064301056",
                "https://github.com/hhlxf/PrintNightmare",
                "https://github.com/afwu/PrintNightmare"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1110.001"
            ],
            "title": "Suspicious Rejected SMB Guest Logon From IP"
        },
        {
            "author": "Jerry Shockley '@jsh0x'",
            "date": "2022/02/02",
            "description": "Detects common NTLM brute force device names",
            "detection": {
                "condition": "selection and devicename",
                "devicename": {
                    "WorkstationName": [
                        "Rdesktop",
                        "Remmina",
                        "Freerdp",
                        "Windows7",
                        "Windows8",
                        "Windows2012",
                        "Windows2016",
                        "Windows2019"
                    ]
                },
                "selection": {
                    "EventID": 8004
                }
            },
            "falsepositives": [
                "Systems with names equal to the spoofed ones used by the brute force tools"
            ],
            "id": "9c8acf1a-cbf9-4db6-b63c-74baabe03e59",
            "level": "medium",
            "logsource": {
                "definition": "Requires events from Microsoft-Windows-NTLM/Operational",
                "product": "windows",
                "service": "ntlm"
            },
            "references": [
                "https://www.varonis.com/blog/investigate-ntlm-brute-force"
            ],
            "title": "NTLM Brute Force",
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1110"
            ]
        },
        {
            "author": "j4son",
            "date": "2023/10/11",
            "description": "Detects failed logon attempts from clients with external network IP to an MSSQL server. This can be a sign of a bruteforce attack.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_local_ips": {
                    "Data|contains": [
                        "CLIENT: 10.",
                        "CLIENT: 172.16.",
                        "CLIENT: 172.17.",
                        "CLIENT: 172.18.",
                        "CLIENT: 172.19.",
                        "CLIENT: 172.20.",
                        "CLIENT: 172.21.",
                        "CLIENT: 172.22.",
                        "CLIENT: 172.23.",
                        "CLIENT: 172.24.",
                        "CLIENT: 172.25.",
                        "CLIENT: 172.26.",
                        "CLIENT: 172.27.",
                        "CLIENT: 172.28.",
                        "CLIENT: 172.29.",
                        "CLIENT: 172.30.",
                        "CLIENT: 172.31.",
                        "CLIENT: 192.168.",
                        "CLIENT: 127.",
                        "CLIENT: 169.254."
                    ]
                },
                "selection": {
                    "EventID": 18456,
                    "Provider_Name|contains": "MSSQL"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ebfe73c2-5bc9-4ed9-aaa8-8b54b2b4777d",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: Must enable MSSQL authentication.",
                "product": "windows",
                "service": "application"
            },
            "modified": "2024/06/26",
            "status": "experimental",
            "references": [
                "https://cybersecthreat.com/2020/07/08/enable-mssql-authentication-log-to-eventlog/",
                "https://www.experts-exchange.com/questions/27800944/EventID-18456-Failed-to-open-the-explicitly-specified-database.html"
            ],
            "related": [
                {
                    "id": "218d2855-2bba-4f61-9c85-81d0ea63ac71",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1110"
            ],
            "title": "MSSQL Server Failed Logon From External Network"
        },
        {
            "id": "218d2855-2bba-4f61-9c85-81d0ea63ac71",
            "author": "Nasreddine Bencherchali (Nextron Systems), j4son",
            "date": "2023/10/11",
            "description": "Detects failed logon attempts from clients to MSSQL server.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 18456,
                    "Provider_Name|contains": "MSSQL"
                }
            },
            "falsepositives": [
                "This event could stem from users changing an account's password that's used to authenticate via a job or an automated process. Investigate the source of such events and mitigate them"
            ],
            "level": "low",
            "logsource": {
                "definition": "Requirements: Must enable MSSQL authentication.",
                "product": "windows",
                "service": "application"
            },
            "modified": "2024/06/26",
            "status": "experimental",
            "references": [
                "https://cybersecthreat.com/2020/07/08/enable-mssql-authentication-log-to-eventlog/",
                "https://www.experts-exchange.com/questions/27800944/EventID-18456-Failed-to-open-the-explicitly-specified-database.html"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "ebfe73c2-5bc9-4ed9-aaa8-8b54b2b4777d"
                }
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1110"
            ],
            "title": "MSSQL Server Failed Logon"
        },
        {
            "author": "Micah Babinski (@micahbabinski), Zach Mathis (@yamatosecurity)",
            "date": "2023/01/19",
            "description": "Detects successful logon from public IP address via SMB. This can indicate a publicly-exposed SMB port.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_empty": {
                    "IpAddress": "-"
                },
                "filter_main_local_ranges": {
                    "IpAddress|cidr": [
                        "::1/128",
                        "10.0.0.0/8",
                        "127.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "fc00::/7",
                        "fe80::/10"
                    ]
                },
                "selection": {
                    "EventID": 4624,
                    "LogonType": 3
                }
            },
            "falsepositives": [
                "Legitimate or intentional inbound connections from public IP addresses on the SMB port."
            ],
            "id": "78d5cab4-557e-454f-9fb9-a222bd0d5edc",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "level": "high",
            "modified": "2024/03/11",
            "references": [
                "https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html",
                "https://twitter.com/Purp1eW0lf/status/1616144561965002752"
            ],
            "related": [
                {
                    "id": "259a9cdf-c4dd-4fa2-b243-2269e5ab18a2",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1133",
                "attack.t1078",
                "attack.t1110"
            ],
            "title": "External Remote SMB Logon from Public IP"
        },
        {
            "id": "259a9cdf-c4dd-4fa2-b243-2269e5ab18a2",
            "author": "Micah Babinski (@micahbabinski), Zach Mathis (@yamatosecurity)",
            "date": "2023/01/19",
            "description": "Detects successful logon from public IP address via RDP. This can indicate a publicly-exposed RDP port.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_empty": {
                    "IpAddress": "-"
                },
                "filter_main_local_ranges": {
                    "IpAddress|cidr": [
                        "::1/128",
                        "10.0.0.0/8",
                        "127.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "fc00::/7",
                        "fe80::/10"
                    ]
                },
                "selection": {
                    "EventID": 4624,
                    "LogonType": 10
                }
            },
            "falsepositives": [
                "Legitimate or intentional inbound connections from public IP addresses on the RDP port."
            ],
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2024/03/11",
            "references": [
                "https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html",
                "https://twitter.com/Purp1eW0lf/status/1616144561965002752"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "78d5cab4-557e-454f-9fb9-a222bd0d5edc"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.credential_access",
                "attack.t1133",
                "attack.t1078",
                "attack.t1110"
            ],
            "title": "External Remote RDP Logon from Public IP"
        },
        {
            "author": "frack113",
            "date": "2021/12/27",
            "description": "Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts.\nWithout knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "System.DirectoryServices.Protocols.LdapDirectoryIdentifier",
                        "System.Net.NetworkCredential",
                        "System.DirectoryServices.Protocols.LdapConnection"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1883444f-084b-419b-ac62-e0d0c5b3693f",
            "level": "low",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1110.001/T1110.001.md#atomic-test-2---brute-force-credentials-of-single-active-directory-domain-user-via-ldap-against-domain-controller-ntlm-or-kerberos"
            ],
            "title": "Suspicious Connection to Remote Account",
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1110.001"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "Azure AD",
        "Office 365",
        "SaaS",
        "IaaS",
        "Linux",
        "macOS",
        "Google Workspace",
        "Containers",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "David Fiser, @anu4is, Trend Micro",
        "Alfredo Oliveira, Trend Micro",
        "Magno Logan, @magnologan, Trend Micro",
        "Yossi Weizman, Azure Defender Research Team",
        "Ed Williams, Trustwave, SpiderLabs",
        "Mohamed Kmal"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "credential-access"
        }
    ],
    "x_mitre_detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.5",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "User Account: User Account Authentication",
        "Command: Command Execution",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": []
}