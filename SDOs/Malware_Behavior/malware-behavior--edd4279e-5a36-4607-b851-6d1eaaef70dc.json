{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--edd4279e-5a36-4607-b851-6d1eaaef70dc",
    "created": "2024-08-13T14:46:36.635909Z",
    "modified": "2024-08-13T14:46:36.635909Z",
    "name": "Leverage Alternate Encoding",
    "description": "An adversary leverages the possibility to encode potentially harmful input or content used by applications such that the applications are ineffective at validating this encoding standard.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/267.html",
            "external_id": "267"
        },
        {
            "source_name": "CWE",
            "external_id": "173"
        },
        {
            "source_name": "CWE",
            "external_id": "172"
        },
        {
            "source_name": "CWE",
            "external_id": "180"
        },
        {
            "source_name": "CWE",
            "external_id": "181"
        },
        {
            "source_name": "CWE",
            "external_id": "73"
        },
        {
            "source_name": "CWE",
            "external_id": "74"
        },
        {
            "source_name": "CWE",
            "external_id": "20"
        },
        {
            "source_name": "CWE",
            "external_id": "697"
        },
        {
            "source_name": "CWE",
            "external_id": "692"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Authorization"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Accountability"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authentication"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Non-Repudiation"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Access Control"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Authorization"
        },
        {
            "impact": "Unreliable Execution",
            "scope": "Availability"
        },
        {
            "impact": "Resource Consumption",
            "scope": "Availability"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "Microsoft Internet Explorer 5.01 SP4, 6, 6 SP1, and 7 does not properly handle unspecified \"encoding strings,\" which allows remote adversaries to bypass the Same Origin Policy and obtain sensitive information via a crafted web site, aka \"Post Encoding Information Disclosure Vulnerability.\" Related Vulnerabilities CVE-2010-0488"
        },
        {
            "description": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Survey the application for user-controllable inputs] Using a browser, an automated tool or by inspecting the application, an adversary records all entry points to the application.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Use a spidering tool to follow and record all links and analyze the web pages to find entry points. Make special note of any links that include parameters in the URL.",
                "Use a proxy tool to record all user input entry points visited during a manual traversal of the web application.",
                "Use a browser to manually explore the website and analyze how it is constructed. Many browsers' plugins are available to facilitate the analysis or automate the discovery.",
                "Manually inspect the application to find entry points."
            ]
        },
        {
            "description": "[Probe entry points to locate vulnerabilities] The adversary uses the entry points gathered in the \"Explore\" phase as a target list and injects various payloads using a variety of different types of encodings to determine if an entry point actually represents a vulnerability with insufficient validation logic and to characterize the extent to which the vulnerability can be exploited.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Try to use different encodings of content in order to bypass validation routines."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Assume all input might use an improper representation. Use canonicalized data inside the application; all data must be converted into the representation used inside the application (UTF-8, UTF-16, etc.)"
        },
        {
            "description": "Assume all input is malicious. Create an allowlist that defines all valid input to the software system based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system. Test your decoding process against malicious input."
        }
    ]
}