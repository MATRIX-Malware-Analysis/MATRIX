{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--082a36d2-edc2-4fe7-81f6-23e65ec3179a",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.835968Z",
    "name": "Adversary-in-the-Middle",
    "description": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as Network Sniffing, Transmitted Data Manipulation, or replay attacks (Exploitation for Credential Access). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.[1]For example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware.[2][3][4] Adversaries may also manipulate DNS and leverage their position in order to intercept user credentials, including access tokens (Steal Application Access Token) and session cookies (Steal Web Session Cookie).[5][6] Downgrade Attacks can also be used to establish an AiTM position, such as by negotiating a less secure, deprecated, or weaker version of communication protocol (SSL/TLS) or encryption algorithm.[7][8][9]Adversaries may also leverage the AiTM position to attempt to monitor and/or modify traffic, such as in Transmitted Data Manipulation. Adversaries can setup a position similar to AiTM to prevent traffic from flowing to the appropriate destination, potentially to Impair Defenses and/or in support of a Network Denial of Service.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1557",
            "external_id": "T1557"
        },
        {
            "source_name": "CAPEC 94",
            "external_id": "malware-behavior--afdcdd88-7fe3-4034-bf03-e310409f3438"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1557",
            "external_id": "T1557"
        },
        {
            "source_name": "dns_changer_trojans",
            "description": "Abendan, O. (2012, June 14). How DNS Changer Trojans Direct Users to Threats. Retrieved October 28, 2021.",
            "url": "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/125/how-dns-changer-trojans-direct-users-to-threats"
        },
        {
            "source_name": "volexity_0day_sophos_FW",
            "description": "Adair, S., Lancaster, T., Volexity Threat Research. (2022, June 15). DriftingCloud: Zero-Day Sophos Firewall Exploitation and an Insidious Breach. Retrieved July 1, 2022.",
            "url": "https://www.volexity.com/blog/2022/06/15/driftingcloud-zero-day-sophos-firewall-exploitation-and-an-insidious-breach/"
        },
        {
            "source_name": "taxonomy_downgrade_att_tls",
            "description": "Alashwali, E. S., Rasmussen, K. (2019, January 26). What's in a Downgrade? A Taxonomy of Downgrade Attacks in the TLS Protocol and Application Protocols Using TLS. Retrieved December 7, 2021.",
            "url": "https://arxiv.org/abs/1809.05681"
        },
        {
            "source_name": "ad_blocker_with_miner",
            "description": "Kuzmenko, A.. (2021, March 10). Ad blocker with miner included. Retrieved October 28, 2021.",
            "url": "https://securelist.com/ad-blocker-with-miner-included/101105/"
        },
        {
            "source_name": "Token tactics",
            "description": "Microsoft Incident Response. (2022, November 16). Token tactics: How to prevent, detect, and respond to cloud token theft. Retrieved December 26, 2023.",
            "url": "https://www.microsoft.com/en-us/security/blog/2022/11/16/token-tactics-how-to-prevent-detect-and-respond-to-cloud-token-theft/"
        },
        {
            "source_name": "mitm_tls_downgrade_att",
            "description": "praetorian Editorial Team. (2014, August 19). Man-in-the-Middle TLS Protocol Downgrade Attack. Retrieved December 8, 2021.",
            "url": "https://www.praetorian.com/blog/man-in-the-middle-tls-ssl-protocol-downgrade-attack/"
        },
        {
            "source_name": "Rapid7 MiTM Basics",
            "description": "Rapid7. (n.d.). Man-in-the-Middle (MITM) Attacks. Retrieved March 2, 2020.",
            "url": "https://www.rapid7.com/fundamentals/man-in-the-middle-attacks/"
        },
        {
            "source_name": "tlseminar_downgrade_att",
            "description": "Team Cinnamon. (2017, February 3). Downgrade Attacks. Retrieved December 9, 2021.",
            "url": "https://tlseminar.github.io/downgrade-attacks/"
        },
        {
            "source_name": "ttint_rat",
            "description": "Tu, L. Ma, Y. Ye, G. (2020, October 1). Ttint: An IoT Remote Access Trojan spread through 2 0-day vulnerabilities. Retrieved October 28, 2021.",
            "url": "https://blog.netlab.360.com/ttint-an-iot-remote-control-trojan-spread-through-2-0-day-vulnerabilities/"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects juniper BGP missing MD5 digest. Which may be indicative of brute force attacks to manipulate routing.",
            "detection": {
                "condition": "keywords_bgp_juniper",
                "keywords_bgp_juniper": {
                    "|all": [
                        ":179",
                        "missing MD5 digest"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "host"
            ],
            "id": "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
            "level": "low",
            "logsource": {
                "definition": "Requirements: juniper bgp logs need to be enabled and ingested",
                "product": "juniper",
                "service": "bgp"
            },
            "modified": "2023/01/23",
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ],
            "title": "Juniper BGP Missing MD5"
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects LDP failures which may be indicative of brute force attacks to manipulate MPLS labels",
            "detection": {
                "condition": "selection_protocol and selection_keywords",
                "selection_keywords": [
                    "SOCKET_TCP_PACKET_MD5_AUTHEN_FAIL",
                    "TCPMD5AuthenFail"
                ],
                "selection_protocol": [
                    "LDP"
                ]
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "tcpConnLocalAddress",
                "tcpConnRemAddress"
            ],
            "id": "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
            "level": "low",
            "logsource": {
                "definition": "Requirements: cisco ldp logs need to be enabled and ingested",
                "product": "cisco",
                "service": "ldp"
            },
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "title": "Cisco LDP Authentication Failures",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ]
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing",
            "detection": {
                "condition": "keywords_bgp_cisco",
                "keywords_bgp_cisco": {
                    "|all": [
                        ":179",
                        "IP-TCP-3-BADAUTH"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "tcpConnLocalAddress",
                "tcpConnRemAddress"
            ],
            "id": "56fa3cd6-f8d6-4520-a8c7-607292971886",
            "level": "low",
            "logsource": {
                "definition": "Requirements: cisco bgp logs need to be enabled and ingested",
                "product": "cisco",
                "service": "bgp"
            },
            "modified": "2023/01/23",
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ],
            "title": "Cisco BGP Authentication Failures"
        },
        {
            "author": "@neu5ron, @Antonlovesdnb, Mike Remen",
            "date": "2021/08/17",
            "description": "Detects usage of the windows RPC library Encrypting File System Remote Protocol (MS-EFSRPC). Variations of this RPC are used within the attack refereed to as PetitPotam.\nThe usage of this RPC function should be rare if ever used at all.\nThus usage of this function is uncommon enough that any usage of this RPC function should warrant further investigation to determine if it is legitimate.\n View surrounding logs (within a few minutes before and after) from the Source IP to. Logs from from the Source IP would include dce_rpc, smb_mapping, smb_files, rdp, ntlm, kerberos, etc..'\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operation|startswith": "efs"
                }
            },
            "falsepositives": [
                "Uncommon but legitimate windows administrator or software tasks that make use of the Encrypting File System RPC Calls. Verify if this is common activity (see description)."
            ],
            "fields": [
                "id.orig_h",
                "id.resp_h",
                "id.resp_p",
                "operation",
                "endpoint",
                "named_pipe",
                "uid"
            ],
            "id": "4096842a-8f9f-4d36-92b4-d0b2a62f9b2a",
            "level": "medium",
            "logsource": {
                "product": "zeek",
                "service": "dce_rpc"
            },
            "modified": "2022/11/28",
            "references": [
                "https://github.com/topotam/PetitPotam/blob/d83ac8f2dd34654628c17490f99106eb128e7d1e/PetitPotam/PetitPotam.cpp",
                "https://msrc.microsoft.com/update-guide/vulnerability/ADV210003",
                "https://vx-underground.org/archive/Symantec/windows-vista-network-attack-07-en.pdf",
                "https://threatpost.com/microsoft-petitpotam-poc/168163/"
            ],
            "status": "test",
            "tags": [
                "attack.t1557.001",
                "attack.t1187"
            ],
            "title": "Potential PetitPotam Attack Via EFS RPC Calls"
        },
        {
            "author": "Tim Brown",
            "date": "2023/01/09",
            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing.",
            "detection": {
                "condition": "keywords_bgp_huawei",
                "keywords_bgp_huawei": {
                    "|all": [
                        ":179",
                        "BGP_AUTH_FAILED"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely. Except due to misconfigurations"
            ],
            "fields": [
                "host",
                "PeeId"
            ],
            "id": "a557ffe6-ac54-43d2-ae69-158027082350",
            "level": "low",
            "logsource": {
                "definition": "Requirements: huawei bgp logs need to be enabled and ingested",
                "product": "huawei",
                "service": "bgp"
            },
            "modified": "2023/01/23",
            "references": [
                "https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.collection",
                "attack.t1078",
                "attack.t1110",
                "attack.t1557"
            ],
            "title": "Huawei BGP Authentication Failures"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/07/24",
            "description": "Detects different hacktools used for relay attacks on Windows for privilege escalation",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_*",
                "filter_hotpotatoes": {
                    "Image|contains": [
                        "HotPotatoes6",
                        "HotPotatoes7",
                        "HotPotatoes "
                    ]
                },
                "selection_juicypotato_enum": {
                    "CommandLine|contains": ".exe -c \"{",
                    "CommandLine|endswith": "}\" -z"
                },
                "selection_pe": {
                    "Image|contains": [
                        "PetitPotam",
                        "RottenPotato",
                        "HotPotato",
                        "JuicyPotato",
                        "\\just_dce_",
                        "Juicy Potato",
                        "\\temp\\rot.exe",
                        "\\Potato.exe",
                        "\\SpoolSample.exe",
                        "\\Responder.exe",
                        "\\smbrelayx",
                        "\\ntlmrelayx",
                        "\\LocalPotato"
                    ]
                },
                "selection_script": {
                    "CommandLine|contains": [
                        "Invoke-Tater",
                        " smbrelay",
                        " ntlmrelay",
                        "cme smb ",
                        " /ntlm:NTLMhash ",
                        "Invoke-PetitPotam",
                        ".exe -t * -p "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate files with these rare hacktool names"
            ],
            "id": "5589ab4f-a767-433c-961d-c91f3f704db1",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/",
                "https://pentestlab.blog/2017/04/13/hot-potato/",
                "https://github.com/ohpe/juicy-potato",
                "https://hunter2.gitbook.io/darthsidious/other/war-stories/domain-admin-in-30-minutes",
                "https://hunter2.gitbook.io/darthsidious/execution/responder-with-ntlm-relay-and-empire",
                "https://www.localpotato.com/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1557.001"
            ],
            "title": "Potential SMB Relay Attack Tool Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/07/24",
            "description": "Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|contains": [
                            "\\goldenPac",
                            "\\karmaSMB",
                            "\\kintercept",
                            "\\ntlmrelayx",
                            "\\rpcdump",
                            "\\samrdump",
                            "\\secretsdump",
                            "\\smbexec",
                            "\\smbrelayx",
                            "\\wmiexec",
                            "\\wmipersist"
                        ]
                    },
                    {
                        "Image|endswith": [
                            "\\atexec_windows.exe",
                            "\\dcomexec_windows.exe",
                            "\\dpapi_windows.exe",
                            "\\findDelegation_windows.exe",
                            "\\GetADUsers_windows.exe",
                            "\\GetNPUsers_windows.exe",
                            "\\getPac_windows.exe",
                            "\\getST_windows.exe",
                            "\\getTGT_windows.exe",
                            "\\GetUserSPNs_windows.exe",
                            "\\ifmap_windows.exe",
                            "\\mimikatz_windows.exe",
                            "\\netview_windows.exe",
                            "\\nmapAnswerMachine_windows.exe",
                            "\\opdump_windows.exe",
                            "\\psexec_windows.exe",
                            "\\rdp_check_windows.exe",
                            "\\sambaPipe_windows.exe",
                            "\\smbclient_windows.exe",
                            "\\smbserver_windows.exe",
                            "\\sniff_windows.exe",
                            "\\sniffer_windows.exe",
                            "\\split_windows.exe",
                            "\\ticketer_windows.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of the impacket tools"
            ],
            "id": "4627c6ae-6899-46e2-aa0c-6ebcb1becd19",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/07",
            "references": [
                "https://github.com/ropnop/impacket_static_binaries/releases/tag/0.9.21-dev-binaries"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1557.001"
            ],
            "title": "HackTool - Impacket Tools Execution"
        },
        {
            "author": "Janantha Marasinghe",
            "date": "2022/11/18",
            "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
            "detection": {
                "condition": "selection_img and (1 of selection_flags_*)",
                "selection_flags_configure": {
                    "CommandLine|contains|all": [
                        "/configure",
                        "/db"
                    ]
                },
                "selection_flags_discovery": {
                    "CommandLine|contains|all": [
                        "/export",
                        "/cfg"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\secedit.exe"
                    },
                    {
                        "OriginalFileName": "SeCEdit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative use"
            ],
            "id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2022/12/30",
            "references": [
                "https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.privilege_escalation",
                "attack.t1562.002",
                "attack.t1547.001",
                "attack.t1505.005",
                "attack.t1556.002",
                "attack.t1562",
                "attack.t1574.007",
                "attack.t1564.002",
                "attack.t1546.008",
                "attack.t1546.007",
                "attack.t1547.014",
                "attack.t1547.010",
                "attack.t1547.002",
                "attack.t1557",
                "attack.t1082"
            ],
            "title": "Potential Suspicious Activity Using SeCEdit"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/07/31",
            "description": "Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " --adcs ",
                        " --port "
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "cd8c163e-a19b-402e-bdd5-419ff5859f12",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://github.com/bats3c/ADCSPwn"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1557.001"
            ],
            "title": "HackTool - ADCSPwn Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/07/30",
            "description": "Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection package for Windows",
            "detection": {
                "condition": "1 of selection*",
                "selection": {
                    "ImageLoaded|contains": [
                        "\\WinDivert.sys",
                        "\\WinDivert64.sys",
                        "\\NordDivert.sys",
                        "\\lingtiwfp.sys",
                        "\\eswfp.sys"
                    ]
                },
                "selection_hashes": {
                    "Imphash": [
                        "0604bb7cb4bb851e2168d5c7d9399087",
                        "2e5f0e649d97f32b03c09e4686d0574f",
                        "52f8aa269f69f0edad9e8fcdaedce276",
                        "c0e5d314da39dbf65a2dbff409cc2c76",
                        "58623490691babe8330adc81cd04a663",
                        "8ee39b48656e4d6b8459d7ba7da7438b",
                        "45ee545ae77e8d43fc70ede9efcd4c96",
                        "a1b2e245acd47e4a348e1a552a02859a",
                        "2a5f85fe4609461c6339637594fa9b0a",
                        "6b2c6f95233c2914d1d488ee27531acc",
                        "9f2fdd3f9ab922bbb0560a7df46f4342",
                        "d8a719865c448b1bd2ec241e46ac1c88",
                        "0ea54f8c9af4a2fe8367fa457f48ed38",
                        "9d519ae0a0864d6d6ae3f8b6c9c70af6",
                        "a74929edfc3289895e3f2885278947ae",
                        "a66b476c2d06c370f0a53b5537f2f11e",
                        "bdcd836a46bc2415773f6b5ea77a46e4",
                        "c28cd6ccd83179e79dac132a553693d9"
                    ]
                },
                "selection_sysmon": {
                    "Hashes|contains": [
                        "IMPHASH=0604bb7cb4bb851e2168d5c7d9399087",
                        "IMPHASH=2e5f0e649d97f32b03c09e4686d0574f",
                        "IMPHASH=52f8aa269f69f0edad9e8fcdaedce276",
                        "IMPHASH=c0e5d314da39dbf65a2dbff409cc2c76",
                        "IMPHASH=58623490691babe8330adc81cd04a663",
                        "IMPHASH=8ee39b48656e4d6b8459d7ba7da7438b",
                        "IMPHASH=45ee545ae77e8d43fc70ede9efcd4c96",
                        "IMPHASH=a1b2e245acd47e4a348e1a552a02859a",
                        "IMPHASH=2a5f85fe4609461c6339637594fa9b0a",
                        "IMPHASH=6b2c6f95233c2914d1d488ee27531acc",
                        "IMPHASH=9f2fdd3f9ab922bbb0560a7df46f4342",
                        "IMPHASH=d8a719865c448b1bd2ec241e46ac1c88",
                        "IMPHASH=0ea54f8c9af4a2fe8367fa457f48ed38",
                        "IMPHASH=9d519ae0a0864d6d6ae3f8b6c9c70af6",
                        "IMPHASH=a74929edfc3289895e3f2885278947ae",
                        "IMPHASH=a66b476c2d06c370f0a53b5537f2f11e",
                        "IMPHASH=bdcd836a46bc2415773f6b5ea77a46e4",
                        "IMPHASH=c28cd6ccd83179e79dac132a553693d9"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate WinDivert driver usage"
            ],
            "id": "679085d5-f427-4484-9f58-1dc30a7c426d",
            "level": "high",
            "logsource": {
                "category": "driver_load",
                "product": "windows"
            },
            "modified": "2022/11/19",
            "references": [
                "https://reqrypt.org/windivert-doc.html",
                "https://rastamouse.me/ntlm-relaying-via-cobalt-strike/"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.defense_evasion",
                "attack.t1599.001",
                "attack.t1557.001"
            ],
            "title": "WinDivert Driver Load"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/10/07",
            "description": "Detects the invocation of TabTip via CLSID as seen when JuicyPotatoNG is used on a system in brute force mode",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 10001,
                    "Provider_Name": "Microsoft-Windows-DistributedCOM",
                    "param1": "C:\\Program Files\\Common Files\\microsoft shared\\ink\\TabTip.exe",
                    "param2": 2147943140,
                    "param3": "{054AAE20-4BEA-4347-8A35-64A533254A9D}"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bc2e25ed-b92b-4daa-b074-b502bdd1982b",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2023/04/14",
            "references": [
                "https://github.com/antonioCoco/JuicyPotatoNG"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1557.001"
            ],
            "title": "Local Privilege Escalation Indicator TabTip"
        },
        {
            "author": "@SBousseaden, Florian Roth",
            "date": "2019/11/15",
            "description": "Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4624,
                    "IpAddress": [
                        "127.0.0.1",
                        "::1"
                    ],
                    "LogonType": 3,
                    "TargetUserName": "ANONYMOUS LOGON",
                    "WorkstationName": "-"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "16f5d8ca-44bd-47c8-acbe-6fc95a16c12f",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/12/22",
            "references": [
                "https://twitter.com/SBousseaden/status/1195284233729777665"
            ],
            "status": "test",
            "tags": [
                "attack.privilege_escalation",
                "attack.credential_access",
                "attack.t1557.001"
            ],
            "title": "RottenPotato Like Attack Pattern"
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "macOS",
        "Linux",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Mayuresh Dani, Qualys",
        "Daniil Yugoslavskiy, @yugoslavskiy, Atomic Threat Coverage project",
        "NEC"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "credential-access"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "collection"
        }
    ],
    "x_mitre_detection": "Monitor network traffic for anomalies associated with known AiTM behavior. Consider monitoring for modifications to system configuration files involved in shaping network traffic flow.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.4",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Application Log: Application Log Content",
        "Network Traffic: Network Traffic Content",
        "Windows Registry: Windows Registry Key Modification",
        "Network Traffic: Network Traffic Flow",
        "Service: Service Creation"
    ],
    "x_mitre_permissions_required": []
}