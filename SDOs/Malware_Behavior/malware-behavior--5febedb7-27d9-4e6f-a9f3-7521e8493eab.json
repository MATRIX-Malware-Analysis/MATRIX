{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--5febedb7-27d9-4e6f-a9f3-7521e8493eab",
    "created": "2024-08-13T14:46:36.621901Z",
    "modified": "2024-08-13T14:46:36.621901Z",
    "name": "Cause Web Server Misclassification",
    "description": "An attack of this type exploits a Web server's decision to take action based on filename or file extension. Because different file types are handled by different server processes, misclassification may force the Web server to take unexpected action, or expected actions in an unexpected sequence. This may cause the server to exhaust resources, supply debug or system data to the attacker, or bind an attacker to a remote process.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/11.html",
            "external_id": "11"
        },
        {
            "source_name": "CWE",
            "external_id": "430"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "J2EE application servers are supposed to execute Java Server Pages (JSP). There have been disclosure issues relating to Orion Application Server, where an attacker that appends either a period (.) or space characters to the end of a legitimate Http request, then the server displays the full source code in the attackers' web browser.\n               http://victim.site/login.jsp.\n               Since remote data and directory access may be accessed directly from the JSP, this is a potentially very serious issue.\n               [REF-6]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Footprint file input vectors] Manually or using an automated tool, an attacker searches for all input locations where a user has control over the filenames or MIME types of files submitted to the web server.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Attacker manually crawls application to identify file inputs",
                "Attacker uses an automated tool to crawl application identify file inputs",
                "Attacker manually assesses strength of access control protecting native application files from user control",
                "Attacker explores potential for submitting files directly to the web server via independently constructed HTTP Requests"
            ]
        },
        {
            "description": "[File misclassification shotgunning] An attacker makes changes to file extensions and MIME types typically processed by web servers and looks for abnormal behavior.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Attacker submits files with switched extensions (e.g. .php on a .jsp file) to web server.",
                "Attacker adds extra characters (e.g. adding an extra . after the file extension) to filenames of files submitted to web server."
            ]
        },
        {
            "description": "[File misclassification sniping] Understanding how certain file types are processed by web servers, an attacker crafts varying file payloads and modifies their file extension or MIME type to be that of the targeted type to see if the web server is vulnerable to misclassification of that type.",
            "phase": "Experiment",
            "step": "3",
            "techniques": [
                "Craft a malicious file payload, modify file extension to the targeted file type and submit it to the web server.",
                "Craft a malicious file payload, modify its associated MIME type to the targeted file type and submit it to the web server."
            ]
        },
        {
            "description": "[Disclose information] The attacker, by manipulating a file extension or MIME type is able to make the web server return raw information (not executed).",
            "phase": "Exploit",
            "step": "4",
            "techniques": [
                "Manipulate the file names that are explicitly sent to the server.",
                "Manipulate the MIME sent in order to confuse the web server."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Medium",
    "x_mitre_mitigations": [
        {
            "description": "Implementation: Server routines should be determined by content not determined by filename or file extension."
        }
    ]
}