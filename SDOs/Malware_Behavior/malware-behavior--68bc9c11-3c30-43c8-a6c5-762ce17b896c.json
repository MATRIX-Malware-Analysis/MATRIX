{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--68bc9c11-3c30-43c8-a6c5-762ce17b896c",
    "created": "2024-08-13T14:46:37.073859Z",
    "modified": "2024-08-13T14:46:45.839551Z",
    "name": "Boot or Logon Autostart Execution: Login Items",
    "description": "Adversaries may add login items to execute upon user login to gain persistence or escalate privileges. Login items are applications, documents, folders, or server connections that are automatically launched when a user logs in.[1] Login items can be added via a shared file list or Service Management Framework.[2] Shared file list login items can be set using scripting languages such as AppleScript, whereas the Service Management Framework uses the API call SMLoginItemSetEnabled.Login items installed using the Service Management Framework leverage launchd, are not visible in the System Preferences, and can only be removed by the application that created them.[2][3] Login items created using a shared file list are visible in System Preferences, can hide the application when it launches, and are executed through LaunchServices, not launchd, to open applications, documents, or URLs without using Finder.[4] Users and applications use login items to configure their user environment to launch commonly used services or applications, such as email, chat, and music applications.Adversaries can utilize AppleScript and Native API calls to create a login item to spawn malicious executables.[5] Prior to version 10.5 on macOS, adversaries can add login items by using AppleScript to send an Apple events to the 'System Events' process, which has an AppleScript dictionary for manipulating login items.[6] Adversaries can use a command such as tell application 'System Events' to make login item at end with properties /path/to/executable.[7][8][9] This command adds the path of the malicious executable to the login item file list located in ~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm.[7] Adversaries can also use login items to launch executables that can be used to control the victim system remotely or as a means to gain privilege escalation by prompting for user credentials.[10][11][12]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1547/015",
            "external_id": "T1547/015"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/07/22",
            "description": "Detects the creation or modification of the Windows Terminal Profile settings file \"settings.json\" by an uncommon process.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\wscript.exe"
                    ],
                    "TargetFilename|endswith": "\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_8wekyb3d8bbwe\\LocalState\\settings.json"
                }
            },
            "falsepositives": [
                "Some false positives may occur with admin scripts that set WT settings."
            ],
            "id": "9b64de98-9db3-4033-bd7a-f51430105f00",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1547.015/T1547.015.md#atomic-test-1---persistence-by-modifying-windows-terminal-profile",
                "https://twitter.com/nas_bench/status/1550836225652686848"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1547.015"
            ],
            "title": "Windows Terminal Profile Settings Modification By Uncommon Process"
        }
    ]
}