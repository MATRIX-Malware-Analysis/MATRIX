{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--a86e1a29-c540-4fa2-b51b-c786781e2f8e",
    "created": "2024-08-13T14:46:37.070035Z",
    "modified": "2024-08-13T14:46:48.592253Z",
    "name": "System Network Configuration Discovery: Internet Connection Discovery",
    "description": "Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using Ping, tracert, and GET requests to websites.Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1016/001",
            "external_id": "T1016/001"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetServerEnum"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "list domain servers",
                    "namespace": "host-interaction/domain",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "or": [
                                            {
                                                "api": "wininet.InternetGetConnectedState"
                                            },
                                            {
                                                "api": "wininet.InternetCheckConnection"
                                            }
                                        ]
                                    },
                                    {
                                        "optional": [
                                            {
                                                "instruction": [
                                                    {
                                                        "mnemonic": "cmp"
                                                    },
                                                    {
                                                        "or": [
                                                            {
                                                                "number": "0 = FALSE"
                                                            },
                                                            {
                                                                "number": "1 = TRUE"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "api": "wininet.InternetAttemptConnect"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001]"
                    ],
                    "authors": [
                        "matthew.williams@mandiant.com",
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "648FC498110B11B4313A47A776E6BA40:0x6633F0"
                    ],
                    "name": "check Internet connectivity via WinINet",
                    "namespace": "host-interaction/network/connectivity",
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "basic block"
                    }
                }
            }
        }
    ]
}