{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--3962a189-2181-464f-9a37-8a4211ac090a",
    "created": "2024-08-13T14:46:37.03058Z",
    "modified": "2024-08-13T14:46:45.56679Z",
    "name": "Create Account: Local Account",
    "description": "Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. For example, with a sufficient level of access, the Windows net user /add command can be used to create a local account. On macOS systems the dscl -create command can be used to create a local account. Local accounts may also be added to network devices, often via common Network Device CLI commands such as username, or to Kubernetes clusters using the kubectl utility.[1][2]Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1136/001",
            "external_id": "T1136/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Find local accounts being created or modified as well as remote authentication configurations",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "username",
                    "aaa"
                ]
            },
            "falsepositives": [
                "When remote authentication is in place, this should not change often"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "6d844f0f-1c18-41af-8f19-33e7654edfc3",
            "level": "high",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.001",
                "attack.t1098"
            ],
            "title": "Cisco Local Accounts"
        },
        {
            "author": "Alejandro Ortuno, oscd.community",
            "date": "2020/10/06",
            "description": "Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_dscl": {
                    "CommandLine|contains": "create",
                    "Image|endswith": "/dscl"
                },
                "selection_sysadminctl": {
                    "CommandLine|contains": "addUser",
                    "Image|endswith": "/sysadminctl"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "51719bf5-e4fd-4e44-8ba8-b830e7ac0731",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2023/02/18",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md",
                "https://ss64.com/osx/sysadminctl.html"
            ],
            "status": "test",
            "tags": [
                "attack.t1136.001",
                "attack.persistence"
            ],
            "title": "Creation Of A Local User Account"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/12",
            "description": "Detects creation of local users via the net.exe command with the option \"never expire\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "user",
                        "add",
                        "expires:never"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\net.exe",
                            "\\net1.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "net.exe",
                            "net1.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "b9f0e6f5-09b4-4358-bae4-08408705bd5c",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/02/21",
            "references": [
                "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/"
            ],
            "related": [
                {
                    "id": "cd219ff3-fa99-45d4-8380-a7d15116c6dc",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.001"
            ],
            "title": "New User Created Via Net.EXE With Never Expire Option"
        },
        {
            "id": "cd219ff3-fa99-45d4-8380-a7d15116c6dc",
            "author": "Endgame, JHasenbusch (adapted to Sigma for oscd.community)",
            "date": "2018/10/30",
            "description": "Identifies the creation of local users via the net.exe command.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "user",
                        "add"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\net.exe",
                            "\\net1.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "net.exe",
                            "net1.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate user creation.",
                "Better use event IDs for user creation rather than command line rules."
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://eqllib.readthedocs.io/en/latest/analytics/014c3f51-89c6-40f1-ac9c-5688f26090ab.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "b9f0e6f5-09b4-4358-bae4-08408705bd5c"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.001"
            ],
            "title": "New User Created Via Net.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/12/06",
            "description": "Detects addition of users to the local Remote Desktop Users group via \"Net\" or \"Add-LocalGroupMember\".",
            "detection": {
                "condition": "all of selection_*",
                "selection_group": {
                    "CommandLine|contains": [
                        "Remote Desktop Users",
                        "Utilisateurs du Bureau \u00e0 distance",
                        "Usuarios de escritorio remoto"
                    ]
                },
                "selection_main": [
                    {
                        "CommandLine|contains|all": [
                            "localgroup ",
                            " /add"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "Add-LocalGroupMember ",
                            " -Group "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "id": "ffa28e60-bdb1-46e0-9f82-05f7a61cc06e",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2022/09/09",
            "references": [
                "https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/"
            ],
            "related": [
                {
                    "id": "ad720b90-25ad-43ff-9b5e-5c841facc8e5",
                    "type": "similar"
                },
                {
                    "id": "10fb649c-3600-4d37-b1e6-56ea90bb7e09",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.lateral_movement",
                "attack.t1133",
                "attack.t1136.001",
                "attack.t1021.001"
            ],
            "title": "User Added to Remote Desktop Users Group"
        },
        {
            "author": "James Pemberton / @4A616D6573",
            "date": "2019/10/31",
            "description": "Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4720,
                    "SamAccountName|contains|all": [
                        "ANONYMOUS",
                        "LOGON"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1bbf25b9-8038-4154-a50b-118f2a32be27",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "level": "high",
            "modified": "2022/10/09",
            "references": [
                "https://twitter.com/SBousseaden/status/1189469425482829824"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.001",
                "attack.t1136.002"
            ],
            "title": "Suspicious Windows ANONYMOUS LOGON Local Account Created"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/05/03",
            "description": "Detects the creation of a local hidden user account which should not happen for event ID 4720.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_homegroup": {
                    "TargetUserName": "HomeGroupUser$"
                },
                "selection": {
                    "EventID": 4720,
                    "TargetUserName|endswith": "$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7b449a5e-1db5-4dd0-a2dc-4e3a67282538",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "level": "high",
            "modified": "2024/01/16",
            "references": [
                "https://twitter.com/SBousseaden/status/1387743867663958021"
            ],
            "status": "test",
            "title": "Hidden Local User Creation",
            "tags": [
                "attack.persistence",
                "attack.t1136.001"
            ]
        },
        {
            "author": "Patrick Bareiss",
            "date": "2019/04/18",
            "description": "Detects local user creation on Windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your Windows server logs and not on your DC logs.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4720
                }
            },
            "falsepositives": [
                "Domain Controller Logs",
                "Local accounts managed by privileged account management tools"
            ],
            "id": "66b6be3d-55d0-4f47-9855-d69df21740ea",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/01/17",
            "references": [
                "https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/"
            ],
            "status": "test",
            "title": "Local User Creation",
            "tags": [
                "attack.persistence",
                "attack.t1136.001"
            ]
        },
        {
            "author": "@ROxPinTeddy",
            "date": "2020/04/11",
            "description": "Detects creation of a local user via PowerShell",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": "New-LocalUser"
                }
            },
            "falsepositives": [
                "Legitimate user creation"
            ],
            "id": "243de76f-4725-4f2e-8225-a8a69b15ad61",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1059.001",
                "attack.persistence",
                "attack.t1136.001"
            ],
            "title": "PowerShell Create Local User"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/05/03",
            "description": "Sysmon registry detection of a local hidden user account.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\lsass.exe",
                    "TargetObject|contains": "\\SAM\\SAM\\Domains\\Account\\Users\\Names\\",
                    "TargetObject|endswith": "$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "460479f3-80b7-42da-9c43-2cc1d54dbccd",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "level": "high",
            "modified": "2022/08/05",
            "references": [
                "https://twitter.com/SBousseaden/status/1387530414185664538"
            ],
            "status": "test",
            "title": "Creation of a Local Hidden User Account by Registry",
            "tags": [
                "attack.persistence",
                "attack.t1136.001"
            ]
        },
        {
            "author": "Pawel Mazur",
            "date": "2022/12/21",
            "description": "Detects the addition of a new user to a privileged group such as \"root\" or \"sudo\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_new_user": [
                    "new user"
                ],
                "selection_uids_gids": [
                    "GID=0",
                    "UID=0",
                    "GID=10",
                    "GID=27"
                ]
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "id": "0ac15ec3-d24f-4246-aa2a-3077bb1cf90e",
            "logsource": {
                "definition": "/var/log/secure on REHL systems or /var/log/auth.log on debian like Systems needs to be collected in order for this detection to work",
                "product": "linux"
            },
            "level": "high",
            "references": [
                "https://digital.nhs.uk/cyber-alerts/2018/cc-2825",
                "https://linux.die.net/man/8/useradd",
                "https://github.com/redcanaryco/atomic-red-team/blob/25acadc0b43a07125a8a5b599b28bbc1a91ffb06/atomics/T1136.001/T1136.001.md#atomic-test-5---create-a-new-user-in-linux-with-root-uid-and-gid"
            ],
            "status": "test",
            "title": "Privileged User Has Been Created",
            "tags": [
                "attack.persistence",
                "attack.t1136.001",
                "attack.t1098"
            ]
        },
        {
            "author": "Marie Euler, Pawel Mazur",
            "date": "2020/05/18",
            "description": "Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_add_user_record_type": {
                    "type": "ADD_USER"
                },
                "selection_syscall_record_type": {
                    "exe|endswith": "/useradd",
                    "type": "SYSCALL"
                }
            },
            "falsepositives": [
                "Admin activity"
            ],
            "id": "759d0d51-bc99-4b5e-9add-8f5b2c8e7512",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/12/20",
            "references": [
                "https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-understanding_audit_log_files",
                "https://access.redhat.com/articles/4409591#audit-record-types-2",
                "https://www.youtube.com/watch?v=VmvY5SQm5-Y&ab_channel=M45C07"
            ],
            "status": "test",
            "tags": [
                "attack.t1136.001",
                "attack.persistence"
            ],
            "title": "Creation Of An User Account"
        }
    ]
}