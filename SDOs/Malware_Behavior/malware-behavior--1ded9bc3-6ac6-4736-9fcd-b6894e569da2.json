{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--1ded9bc3-6ac6-4736-9fcd-b6894e569da2",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.570332Z",
    "name": "Credentials from Password Stores: Keychain",
    "description": "Adversaries may acquire credentials from Keychain. Keychain (or Keychain Services) is the macOS credential management system that stores account names, passwords, private keys, certificates, sensitive application data, payment data, and secure notes. There are three types of Keychains: Login Keychain, System Keychain, and Local Items (iCloud) Keychain. The default Keychain is the Login Keychain, which stores user passwords and information. The System Keychain stores items accessed by the operating system, such as items shared among users on a host. The Local Items (iCloud) Keychain is used for items synced with Apple\u2019s iCloud service. Keychains can be viewed and edited through the Keychain Access application or using the command-line utility security. Keychain files are located in ~/Library/Keychains/, /Library/Keychains/, and /Network/Library/Keychains/.[1][2][3]Adversaries may gather user credentials from Keychain storage/memory. For example, the command security dump-keychain \u2013d will dump all Login Keychain credentials from ~/Library/Keychains/login.keychain-db. Adversaries may also directly read Login Keychain credentials from the ~/Library/Keychains/login.keychain file. Both methods require a password, where the default password for the Login Keychain is the current user\u2019s password to login to the macOS host.[4][5]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1555/001",
            "external_id": "T1555/001"
        },
        {
            "source_name": "CAPEC 545",
            "external_id": "malware-behavior--ce465a6d-609a-4bba-88db-45cc0ac62112"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Tim Ismilyaev, oscd.community, Florian Roth (Nextron Systems)",
            "date": "2020/10/19",
            "description": "Detects passwords dumps from Keychain",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "CommandLine|contains": [
                        "find-certificate",
                        " export "
                    ],
                    "Image": "/usr/bin/security"
                },
                "selection2": {
                    "CommandLine|contains": [
                        " dump-keychain ",
                        " login-keychain "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "b120b587-a4c2-4b94-875d-99c9807d6955",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.001/T1555.001.md",
                "https://gist.github.com/Capybara/6228955"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1555.001"
            ],
            "title": "Credentials from Password Stores - Keychain"
        }
    ]
}