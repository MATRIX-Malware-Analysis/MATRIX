{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--9ea5dfd9-f77a-49ff-bcca-f7b2a99a90ef",
    "created": "2024-08-13T14:46:36.960288Z",
    "modified": "2024-08-13T14:46:45.121215Z",
    "name": "Dynamic Resolution: Domain Generation Algorithms",
    "description": "Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify a destination domain for command and control traffic rather than relying on a list of static IP addresses or domains. This has the advantage of making it much harder for defenders to block, track, or take over the command and control channel, as there potentially could be thousands of domains that malware can check for instructions.[1][2][3]DGAs can take the form of apparently random or 'gibberish' strings (ex: istgmxdejdnxuyla.ru) when they construct domain names by generating each letter. Alternatively, some DGAs employ whole words as the unit by concatenating words together instead of letters (ex: cityjulydish.net). Many DGAs are time-based, generating a different domain for each time period (hourly, daily, monthly, etc). Others incorporate a seed value as well to make predicting future domains more difficult for defenders.[1][2][4][5]Adversaries may use DGAs for the purpose of Fallback Channels. When contact is lost with the primary command and control server malware may employ a DGA as a means to reestablishing command and control.[4][6][7]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1568/002",
            "external_id": "T1568/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/03",
            "description": "Detects an executable initiating a network connection to \"ngrok\" tunneling domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|contains": [
                        "tunnel.us.ngrok.com",
                        "tunnel.eu.ngrok.com",
                        "tunnel.ap.ngrok.com",
                        "tunnel.au.ngrok.com",
                        "tunnel.sa.ngrok.com",
                        "tunnel.jp.ngrok.com",
                        "tunnel.in.ngrok.com"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of the ngrok service."
            ],
            "id": "1d08ac94-400d-4469-a82f-daee9a908849",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/02/02",
            "references": [
                "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
                "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
            ],
            "related": [
                {
                    "id": "18249279-932f-45e2-b37a-8925f2597670",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567",
                "attack.t1568.002",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102",
                "attack.s0508"
            ],
            "title": "Communication To Ngrok Tunneling Service Initiated"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/03",
            "description": "Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|contains": [
                        "tunnel.us.ngrok.com",
                        "tunnel.eu.ngrok.com",
                        "tunnel.ap.ngrok.com",
                        "tunnel.au.ngrok.com",
                        "tunnel.sa.ngrok.com",
                        "tunnel.jp.ngrok.com",
                        "tunnel.in.ngrok.com"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of ngrok"
            ],
            "id": "19bf6fdb-7721-4f3d-867f-53467f6a5db6",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "linux"
            },
            "references": [
                "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
                "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
            ],
            "title": "Communication To Ngrok Tunneling Service - Linux",
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567",
                "attack.t1568.002",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102",
                "attack.s0508"
            ]
        }
    ]
}