{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--2b458c11-26f7-43f5-9a29-c91a9cd42598",
    "created": "2024-08-13T14:46:36.879199Z",
    "modified": "2024-08-13T14:46:44.73663Z",
    "name": "Data Encoding: Standard Encoding",
    "description": "Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.[1][2] Some data encoding systems may also result in data compression, such as gzip.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1132/001",
            "external_id": "T1132/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Daniil Yugoslavskiy, oscd.community",
            "date": "2019/10/24",
            "description": "Well-known DNS Exfiltration tools execution",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\iodine.exe"
                    },
                    {
                        "Image|contains": "\\dnscat2"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "98a96a5a-64a0-4c42-92c5-489da3866cb0",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/iagox86/dnscat2",
                "https://github.com/yarrick/iodine"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.001",
                "attack.command_and_control",
                "attack.t1071.004",
                "attack.t1132.001"
            ],
            "title": "DNS Exfiltration and Tunneling Tools Execution"
        },
        {
            "author": "frack113",
            "date": "2022/12/23",
            "description": "Detects attempts of decoding a base64 Gzip archive via PowerShell. This technique is often used as a method to load malicious content into memory afterward.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "FromBase64String",
                        "MemoryStream",
                        "H4sI"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative script"
            ],
            "id": "d75d6b6b-adb9-48f7-824b-ac2e786efe1f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=43"
            ],
            "related": [
                {
                    "id": "df69cb1d-b891-4cd9-90c7-d617d90100ce",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1132.001"
            ],
            "title": "Suspicious FromBase64String Usage On Gzip Archive - Process Creation"
        },
        {
            "author": "Hieu Tran",
            "date": "2023/03/13",
            "description": "Detects attempts of decoding encoded Gzip archives via PowerShell.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "GZipStream",
                        "::Decompress"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative scripts may use this functionality. Use \"ParentImage\" in combination with the script names and allowed users and applications to filter legitimate executions"
            ],
            "id": "98767d61-b2e8-4d71-b661-e36783ee24c1",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
            ],
            "status": "test",
            "title": "Gzip Archive Decode Via PowerShell",
            "tags": [
                "attack.command_and_control",
                "attack.t1132.001"
            ]
        },
        {
            "id": "df69cb1d-b891-4cd9-90c7-d617d90100ce",
            "author": "frack113",
            "date": "2022/12/23",
            "description": "Detects attempts of decoding a base64 Gzip archive in a PowerShell script. This technique is often used as a method to load malicious content into memory afterward.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "FromBase64String",
                        "MemoryStream",
                        "H4sI"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative script"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=43"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "d75d6b6b-adb9-48f7-824b-ac2e786efe1f"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1132.001"
            ],
            "title": "Suspicious FromBase64String Usage On Gzip Archive - Ps Script"
        }
    ]
}