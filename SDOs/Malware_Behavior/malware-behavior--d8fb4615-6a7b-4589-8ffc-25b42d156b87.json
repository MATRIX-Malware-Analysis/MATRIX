{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--d8fb4615-6a7b-4589-8ffc-25b42d156b87",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.388755Z",
    "name": "Obfuscated Files or Information: Binary Padding",
    "description": "Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations. Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures.[1] The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.[2] Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.[3]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1027/001",
            "external_id": "T1027/001"
        },
        {
            "source_name": "CAPEC 572",
            "external_id": "malware-behavior--35365303-c7a4-4111-83c3-bcdd9c00a85b"
        },
        {
            "source_name": "CAPEC 655",
            "external_id": "malware-behavior--ec28e995-6eaa-4887-b535-5b4b89e26162"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Igor Fits, Mikhail Larin, oscd.community",
            "date": "2020/10/19",
            "description": "Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This rule detect using dd and truncate to add a junk data to file.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_dd": {
                    "CommandLine|contains": [
                        "if=/dev/zero",
                        "if=/dev/random",
                        "if=/dev/urandom"
                    ],
                    "Image|endswith": "/dd"
                },
                "selection_truncate": {
                    "CommandLine|contains": "-s +",
                    "Image|endswith": "/truncate"
                }
            },
            "falsepositives": [
                "Legitimate script work"
            ],
            "id": "95361ce5-c891-4b0a-87ca-e24607884a96",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2023/02/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.001/T1027.001.md",
                "https://linux.die.net/man/1/truncate",
                "https://linux.die.net/man/1/dd"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1027.001"
            ],
            "title": "Binary Padding - MacOS"
        },
        {
            "author": "Thomas Patzke",
            "date": "2019/12/03",
            "description": "Detects code integrity failures such as missing page hashes or corrupted drivers due unauthorized modification. This could be a sign of tampered binaries.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        5038,
                        6281
                    ]
                }
            },
            "falsepositives": [
                "Disk device errors"
            ],
            "id": "470ec5fa-7b4e-4071-b200-4c753100f49b",
            "level": "informational",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/12/13",
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5038",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6281"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1027.001"
            ],
            "title": "Failed Code Integrity Checks"
        },
        {
            "author": "Igor Fits, oscd.community",
            "date": "2020/10/13",
            "description": "Adversaries may use binary padding to add junk data and change the on-disk representation of malware.\nThis rule detect using dd and truncate to add a junk data to file.\n",
            "detection": {
                "condition": "selection_execve and (keywords_truncate or (keywords_dd and not keywords_filter))",
                "keywords_dd": {
                    "|all": [
                        "dd",
                        "if="
                    ]
                },
                "keywords_filter": [
                    "of="
                ],
                "keywords_truncate": {
                    "|all": [
                        "truncate",
                        "-s"
                    ]
                },
                "selection_execve": {
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c52a914f-3d8b-4b2a-bb75-b3991e75f8ba",
            "level": "high",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2023/05/03",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.001/T1027.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1027.001"
            ],
            "title": "Binary Padding - Linux"
        }
    ]
}