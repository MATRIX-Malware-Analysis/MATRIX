{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--0c79b1db-092b-407f-ab1d-2bc4e98551e9",
    "created": "2024-08-13T14:46:37.028508Z",
    "modified": "2024-08-13T14:46:48.539608Z",
    "name": "Disk Wipe: Disk Structure Wipe",
    "description": "Adversaries may corrupt or wipe the disk data structures on a hard drive necessary to boot a system; targeting specific critical systems or in large numbers in a network to interrupt availability to system and network resources. Adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record (MBR) or partition table.[1][2][3][4][5] The data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk. If this information is not present, the computer will not be able to load an operating system during the boot process, leaving the computer unavailable. Disk Structure Wipe may be performed in isolation, or along with Disk Content Wipe if all sectors of a disk are wiped.On a network devices, adversaries may reformat the file system using Network Device CLI commands such as format.[6]To maximize impact on the target organization, malware designed for destroying disk structures may have worm-like features to propagate across a network by leveraging other techniques like Valid Accounts, OS Credential Dumping, and SMB/Windows Admin Shares.[1][2][3][4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1561/002",
            "external_id": "T1561/002"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "match": "interact with driver via IOCTL"
                                    },
                                    {
                                        "characteristic": "indirect call"
                                    }
                                ]
                            },
                            {
                                "number": "0x7c100 = IOCTL_DISK_DELETE_DRIVE_LAYOUT"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Impact::Disk Wipe::Disk Structure Wipe [T1561.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "36cc72c55f572fe02836f25516d18fed1de768e7f29af7bdf469b52a3fe2531f:0x401090"
                    ],
                    "mbc": [
                        "Impact::Disk Wipe [F0014]"
                    ],
                    "name": "delete drive layout via IOCTL",
                    "namespace": "impact/wipe-disk",
                    "references": [
                        "https://www.crowdstrike.com/blog/the-anatomy-of-wiper-malware-part-3/",
                        "http://www.ioctls.net/",
                        "https://tyleo.github.io/sharedlib/doc/winapi/winioctl/constant.IOCTL_DISK_DELETE_DRIVE_LAYOUT.html"
                    ],
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "string": "\\\\.\\PHYSICALDRIVE0"
                            },
                            {
                                "api": "kernel32.WriteFile"
                            },
                            {
                                "number": "0x200 = MBR/sector size in bytes"
                            },
                            {
                                "or": [
                                    {
                                        "number": "0x55 = MBR signature constant"
                                    },
                                    {
                                        "number": "0xAA = MBR signature constant"
                                    }
                                ]
                            },
                            {
                                "optional": [
                                    {
                                        "match": "create or open file"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Impact::Disk Wipe::Disk Structure Wipe [T1561.002]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x100070A0"
                    ],
                    "mbc": [
                        "Impact::Disk Wipe [F0014]"
                    ],
                    "name": "overwrite Master Boot Record (MBR)",
                    "namespace": "impact/wipe-disk/wipe-mbr",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "See what files are being deleted from flash file systems",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "erase",
                    "delete",
                    "format"
                ]
            },
            "falsepositives": [
                "Will be used sometimes by admins to clean up local flash space"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "71d65515-c436-43c0-841b-236b1f32c21e",
            "level": "medium",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1070.004",
                "attack.t1561.001",
                "attack.t1561.002"
            ],
            "title": "Cisco File Deletion"
        }
    ]
}