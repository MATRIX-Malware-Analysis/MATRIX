{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--37332048-2490-42e4-957b-e7dc454e83a8",
    "created": "2024-08-13T14:46:36.849032Z",
    "modified": "2024-08-13T14:46:44.544243Z",
    "name": "Account Manipulation: Device Registration",
    "description": "Adversaries may register a device to an adversary-controlled account. Devices may be registered in a multifactor authentication (MFA) system, which handles authentication to the network, or in a device management system, which handles device access and compliance.MFA systems, such as Duo or Okta, allow users to associate devices with their accounts in order to complete MFA requirements. An adversary that compromises a user\u2019s credentials may enroll a new device in order to bypass initial MFA requirements and gain persistent access to a network.[1][2] In some cases, the MFA self-enrollment process may require only a username and password to enroll the account's first device or to enroll a device to an inactive account. [3]Similarly, an adversary with existing access to a network may register a device to Azure AD and/or its device management system, Microsoft Intune, in order to access sensitive data or resources while bypassing conditional access policies.[4][5][6] Devices registered in Azure AD may be able to conduct Internal Spearphishing campaigns via intra-organizational emails, which are less likely to be treated as suspicious by the email client.[7] Additionally, an adversary may be able to perform a Service Exhaustion Flood on an Azure AD tenant by registering a large number of devices.[8]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1098/005",
            "external_id": "T1098/005"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "andrewdanis",
            "date": "2024/06/26",
            "description": "Detects when an account dumps the LAPS password from Entra ID.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "activityType|contains": "Recover device local administrator password",
                    "additionalDetails.additionalInfo|contains": "Successfully recovered local credential by device id",
                    "category": "Device"
                }
            },
            "falsepositives": [
                "Approved activity performed by an Administrator."
            ],
            "id": "a4b25073-8947-489c-a8dd-93b41c23f26d",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "references": [
                "https://twitter.com/NathanMcNulty/status/1785051227568632263",
                "https://www.cloudcoffee.ch/microsoft-365/configure-windows-laps-in-microsoft-intune/",
                "https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-windows-local-administrator-password-solution-with/ba-p/1942487"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1098.005"
            ],
            "title": "Windows LAPS Credential Dump From Entra ID"
        }
    ]
}