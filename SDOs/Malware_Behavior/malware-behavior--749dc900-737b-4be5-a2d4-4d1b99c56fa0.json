{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--749dc900-737b-4be5-a2d4-4d1b99c56fa0",
    "created": "2024-08-13T14:46:36.669928Z",
    "modified": "2024-08-13T14:46:36.669928Z",
    "name": "Altered Component Firmware",
    "description": "An adversary exploits systems features and/or improperly protected firmware of hardware components, such as Hard Disk Drives (HDD), with the goal of executing malicious code from within the component's Master Boot Record (MBR). Conducting this type of attack entails the adversary infecting the target with firmware altering malware, using known tools, and a payload. Once this malware is executed, the MBR is modified to include instructions to execute the payload at desired intervals and when the system is booted up. A successful attack will obtain persistence within the victim system even if the operating system is reinstalled and/or if the component is formatted or has its data erased.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/638.html",
            "external_id": "638"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Gain Privileges",
            "scope": "Authentication"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Authentication"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Authentication"
        },
        {
            "impact": "Hide Activities",
            "scope": "Authentication"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Authorization"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Authorization"
        },
        {
            "impact": "Hide Activities",
            "scope": "Authorization"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Modify Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Read Data",
            "scope": "Access Control"
        },
        {
            "impact": "Modify Data",
            "scope": "Access Control"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "In 2014, the Equation group was observed levering known malware tools to conduct component firmware alteration attacks against hard drives. In total, 12 HDD categories were shown to be vulnerable from manufacturers such as Western Digital, HGST, Samsung, and Seagate. Because of their complexity, only a few victims were targeted by these attacks. [REF-664]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Select Target] The adversary searches for a suitable target to attack, such as government and/or private industry organizations.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Conduct reconnaissance to determine potential targets to exploit."
            ]
        },
        {
            "description": "[Identify Components] After selecting a target, the adversary determines whether a vulnerable component, such as a specific make and model of a HDD, is contained within the target system.",
            "phase": "Explore",
            "step": "2",
            "techniques": [
                "[Remote Access Vector] The adversary gains remote access to the target, typically via additional malware, and explores the system to determine hardware components that are being leveraged.",
                "[Physical Access Vector] The adversary intercepts components in transit and determines if the component is vulnerable to attack."
            ]
        },
        {
            "description": "[Optional: Create Payload] If not using an already existing payload, the adversary creates their own to be executed at defined intervals and upon system boot processes. This payload may then be tested on the target system or a test system to confirm its functionality.",
            "phase": "Experiment",
            "step": "3",
            "techniques": []
        },
        {
            "description": "[Insert Firmware Altering Malware] Once a vulnerable component has been identified, the adversary leverages known malware tools to infect the component's firmware and drop the payload within the component's MBR. This allows the adversary to maintain persistence on the target and execute the payload without being detected.",
            "phase": "Exploit",
            "step": "4",
            "techniques": [
                "The adversary inserts the firmware altering malware on the target component, via the use of known malware tools.",
                "[Physical Access Vector] The adversary then sends the component to its original intended destination, where it will be installed onto a victim system."
            ]
        }
    ],
    "x_mitre_impact": "Very High",
    "x_mitre_likelihood_of_attack": "Low",
    "x_mitre_mitigations": [
        {
            "description": "Leverage hardware components known to not be susceptible to these types of attacks."
        },
        {
            "description": "Implement hardware RAID infrastructure."
        }
    ]
}