{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--121d1e3e-9fec-4518-aefb-46b63c26fbba",
    "created": "2020-10-13T00:00:00.000Z",
    "modified": "2024-02-06T00:00:00.000Z",
    "name": "Encrypt Data",
    "description": "",
    "labels": [
        "malware-behavior"
    ],
    "object_marking_refs": [
        "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
    ],
    "x_mitre_platforms": [],
    "x_mitre_domains": [],
    "x_mitre_contributors": [],
    "kill_chain_phases": [],
    "x_mitre_detection": "",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "",
    "x_mitre_data_sources": [],
    "x_mitre_permissions_required": [],
    "external_references": [
        {
            "source_name": "s2grupo",
            "description": "\"Evolution of Trickbot,\" S2 Grupo, report, Jun. 2017 [Online].",
            "url": "https://www.securityartwork.es/wp-content/uploads/2017/07/Trickbot-report-S2-Grupo.pdf"
        },
        {
            "source_name": "trendmicro-emotet",
            "description": "\"Exploring Emotet's Activities,\" Trend Micro Research, 2019 [Online].",
            "url": "https://documents.trendmicro.com/assets/white_papers/ExploringEmotetsActivities_Final.pdf"
        },
        {
            "source_name": "rascagneres-gravityrat",
            "description": "P. Rascagneres, \"GravityRAT - The Two-Year Evolution Of An APT Targeting India,\" Talos, blog, Apr. 26, 2018 [Online].",
            "url": "https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html"
        },
        {
            "source_name": "fireeye-poisonivy",
            "description": "\"Poison Ivy: Assessing Damange and Extracting Intelligence,\" FireEye, Special Report, 2014 [Online].",
            "url": "https://www.mandiant.com/sites/default/files/2021-09/rpt-poison-ivy.pdf"
        },
        {
            "source_name": "fireeye-apt28",
            "description": "\"APT28: A Window into Russia's Cyber Espionage Operations?\" FireEye, 2014 [Online].",
            "url": "https://www2.fireeye.com/rs/fireye/images/rpt-apt28.pdf"
        },
        {
            "source_name": "dong-matanbuchus",
            "description": "C. Dong, \"MATANBUCHUS: Another Loader as a Service Malware,\" Offset Training Solutions, blog, Feb. 15, 2022 [Online].",
            "url": "https://www.0ffset.net/reverse-engineering/matanbuchus-loader-analysis/"
        },
        {
            "source_name": "cohen-matabuchus",
            "description": "B. Cohen, \"Inside Matanbuchus: A Quirky Loader,\" CyberArk, blog, Jul. 26, 2022 [Online].",
            "url": "https://www.cyberark.com/resources/threat-research-blog/inside-matanbuchus-a-quirky-loader"
        },
        {
            "source_name": "capa analysis",
            "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
            "url": "https://github.com/mandiant/capa-rules"
        }
    ],
    "obj_defn": {
        "description": "Malware may encrypt data.",
        "external_id": "C0027",
        "source_name": "mitre-mbc",
        "url": "https://github.com/MBCProject/mbc-markdown/blob/main/micro-behaviors/cryptography/encrypt-data.md"
    },
    "detection_rules": [
        {
            "api_fncs": [
                "CryptEncrypt",
                "CryptDecrypt",
                "CryptAcquireContext",
                "CryptGenKey",
                "CryptImportKey"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "encrypt or decrypt via WinCrypt",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/encrypt-or-decrypt-via-wincrypt.yml"
        },
        {
            "api_fncs": [
                "memfrob"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "encrypt data using memfrob from glibc",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/encrypt-data-using-memfrob-from-glibc.yml"
        },
        {
            "detect_ref": "malware-method--d2acb9f7-69a8-4a9c-bac9-cee29bb3adca",
            "rule_name": "encrypt data using HC-128",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/hc-128/encrypt-data-using-hc-128.yml"
        },
        {
            "detect_ref": "malware-method--d2acb9f7-69a8-4a9c-bac9-cee29bb3adca",
            "rule_name": "encrypt data using HC-128 via WolfSSL",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/hc-128/encrypt-data-using-hc-128-via-wolfssl.yml"
        },
        {
            "detect_ref": "malware-method--0785f936-0191-4f9a-9893-bde79c43264a",
            "rule_name": "encrypt data using RC6",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/rc6/encrypt-data-using-rc6.yml"
        },
        {
            "detect_ref": "malware-method--fb594cc7-da65-45f2-b0a8-c025e68c7e7e",
            "rule_name": "encrypt data using twofish",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/twofish/encrypt-data-using-twofish.yml"
        },
        {
            "detect_ref": "malware-method--09f5879a-f89a-4af8-a584-d11369e74795",
            "rule_name": "encrypt data using AES MixColumns step",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/aes/encrypt-data-using-aes-mixcolumns-step.yml"
        },
        {
            "api_fncs": [
                "CryptGenKey",
                "CryptDeriveKey",
                "CryptImportKey",
                "CryptAcquireContext",
                "CryptEncrypt",
                "CryptDecrypt"
            ],
            "detect_ref": "malware-method--09f5879a-f89a-4af8-a584-d11369e74795",
            "rule_name": "encrypt data using AES via WinAPI",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/aes/encrypt-data-using-aes-via-winapi.yml"
        },
        {
            "detect_ref": "malware-method--09f5879a-f89a-4af8-a584-d11369e74795",
            "rule_name": "encrypt data using AES via .NET",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/aes/encrypt-data-using-aes-via-dotnet.yml"
        },
        {
            "detect_ref": "malware-method--09f5879a-f89a-4af8-a584-d11369e74795",
            "rule_name": "manually build AES constants",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/aes/manually-build-aes-constants.yml"
        },
        {
            "detect_ref": "malware-method--cec1571a-05fb-4533-86f2-5103d35830c5",
            "rule_name": "encrypt data using Sosemanuk",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/sosemanuk/encrypt-data-using-sosemanuk.yml"
        },
        {
            "detect_ref": "malware-method--67a14746-986d-495e-ae3a-a8256776caee",
            "rule_name": "encrypt data using Camellia",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/camellia/encrypt-data-using-camellia.yml"
        },
        {
            "rule_name": "encrypt data using vest",
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/vest/encrypt-data-using-vest.yml"
        },
        {
            "api_fncs": [
                "CryptProtectMemory",
                "CryptUnprotectMemory",
                "crypt32.CryptProtectData",
                "crypt32.CryptUnprotectData",
                "System.Security.Cryptography.ProtectedData::Unprotect",
                "System.Security.Cryptography.ProtectedData::Protect"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "encrypt data using DPAPI",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/dpapi/encrypt-data-using-dpapi.yml"
        },
        {
            "detect_ref": "malware-method--0e6d09cc-5967-498e-a19e-ad2f31edc323",
            "rule_name": "encrypt data using DES",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/des/encrypt-data-using-des.yml"
        },
        {
            "api_fncs": [
                "CryptGenKey",
                "CryptDeriveKey",
                "CryptImportKey",
                "CryptAcquireContext",
                "CryptEncrypt",
                "CryptDecrypt"
            ],
            "detect_ref": "malware-method--0e6d09cc-5967-498e-a19e-ad2f31edc323",
            "rule_name": "encrypt data using DES via WinAPI",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/des/encrypt-data-using-des-via-winapi.yml"
        },
        {
            "detect_ref": "malware-method--9f117095-5119-412b-bf1a-65545fae2d73",
            "rule_name": "encrypt data using RC4 PRGA",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/rc4/encrypt-data-using-rc4-prga.yml"
        },
        {
            "api_fncs": [
                "CryptImportKey",
                "CryptAcquireContext",
                "CryptEncrypt"
            ],
            "detect_ref": "malware-method--9f117095-5119-412b-bf1a-65545fae2d73",
            "rule_name": "encrypt data using RC4 with custom key via WinAPI",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/rc4/encrypt-data-using-rc4-with-custom-key-via-winapi.yml"
        },
        {
            "api_fncs": [
                "CryptGenKey",
                "CryptDeriveKey",
                "CryptImportKey",
                "CryptAcquireContext",
                "CryptEncrypt",
                "CryptDecrypt"
            ],
            "detect_ref": "malware-method--9f117095-5119-412b-bf1a-65545fae2d73",
            "rule_name": "encrypt data using RC4 via WinAPI",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/rc4/encrypt-data-using-rc4-via-winapi.yml"
        },
        {
            "detect_ref": "malware-method--9f117095-5119-412b-bf1a-65545fae2d73",
            "rule_name": "encrypt data using RC4 KSA",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/rc4/encrypt-data-using-rc4-ksa.yml"
        },
        {
            "detect_ref": "malware-method--69d77c2f-b4d8-490a-8fd1-bda00e72337e",
            "rule_name": "encrypt data using skipjack",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/skipjack/encrypt-data-using-skipjack.yml"
        },
        {
            "detect_ref": "malware-method--6bb3c2f8-94c8-4f0d-b8b4-84a859d27839",
            "rule_name": "encrypt data using blowfish",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/data-manipulation/encryption/blowfish/encrypt-data-using-blowfish.yml"
        },
        {
            "api_fncs": [
                "CryptEncrypt"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "mass_data_encryption",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/mass_data_encryption.py"
        },
        {
            "api_fncs": [
                "CryptEncrypt"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "encrypt_data_agenttesla_http",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/encrypt_data_agenttesla_http.py"
        },
        {
            "api_fncs": [
                "CryptEncrypt",
                "GetUserNameW",
                "GetComputerNameW"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "encrypt_data_agentteslat2_http",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/encrypt_data_agentteslat2_http.py"
        },
        {
            "api_fncs": [
                "CryptEncrypt",
                "GetUserNameW",
                "GetComputerNameW"
            ],
            "detect_ref": "malware-behavior--5562741b-dc9e-4a7c-b564-ac3e4089d17d",
            "rule_name": "encrypt_data_nanocore",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/encrypt_data_nanocore.py"
        }
    ],
    "tags": []
}