{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--fa89af67-6d05-4867-bcb9-9adf84417c6d",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:46.343585Z",
    "name": "Masquerading: Space after Filename",
    "description": "Adversaries can hide a program's true filetype by changing the extension of a file. With certain file types (specifically this does not work with .app extensions), appending a space to the end of a filename will change how the file is processed by the operating system.For example, if there is a Mach-O executable file called evil.bin, when it is double clicked by a user, it will launch Terminal.app and execute. If this file is renamed to evil.txt, then when double clicked by a user, it will launch with the default text editing application (not executing the binary). However, if the file is renamed to evil.txt  (note the space at the end), then when double clicked by a user, the true file type is determined by the OS and handled appropriately and the binary will be executed [1].Adversaries can use this feature to trick users into double clicking benign-looking files of any format and ultimately executing something malicious.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1036/006",
            "external_id": "T1036/006"
        },
        {
            "source_name": "CAPEC 11",
            "external_id": "malware-behavior--5febedb7-27d9-4e6f-a9f3-7521e8493eab"
        },
        {
            "source_name": "CAPEC 649",
            "external_id": "malware-behavior--c61f4008-3429-46a4-b534-59d69ee22e3b"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "remotephone",
            "date": "2021/11/20",
            "description": "Detects attempts to masquerade as legitimate files by adding a space to the end of the filename.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "CommandLine|endswith": " "
                },
                "selection2": {
                    "Image|endswith": " "
                }
            },
            "falsepositives": [
                "Mistyped commands or legitimate binaries named to match the pattern"
            ],
            "id": "b6e2a2e3-2d30-43b1-a4ea-071e36595690",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2023/01/04",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.006/T1036.006.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.006"
            ],
            "title": "Space After Filename - macOS"
        }
    ]
}