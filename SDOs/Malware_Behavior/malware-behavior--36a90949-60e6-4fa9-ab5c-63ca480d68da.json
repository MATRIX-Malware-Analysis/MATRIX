{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--36a90949-60e6-4fa9-ab5c-63ca480d68da",
    "created": "2024-08-13T14:46:37.029012Z",
    "modified": "2024-08-13T14:46:48.541411Z",
    "name": "Account Manipulation",
    "description": "Adversaries may manipulate accounts to maintain and/or elevate access to victim systems. Account manipulation may consist of any action that preserves or modifies adversary access to a compromised account, such as modifying credentials or permission groups.[1] These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged Valid Accounts.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1098",
            "external_id": "T1098"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1098",
            "external_id": "T1098"
        },
        {
            "source_name": "FireEye SMOKEDHAM June 2021",
            "description": "FireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate\u2019s Supply Chain Software Compromise. Retrieved September 22, 2021.",
            "url": "https://www.fireeye.com/blog/threat-research/2021/06/darkside-affiliate-supply-chain-software-compromise.html"
        },
        {
            "source_name": "Microsoft Security Event 4670",
            "description": "Franklin Smith, R. (n.d.). Windows Security Log Event ID 4670. Retrieved November 4, 2019.",
            "url": "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4670"
        },
        {
            "source_name": "Microsoft User Modified Event",
            "description": "Lich, B., Miroshnikov, A. (2017, April 5). 4738(S): A user account was changed. Retrieved June 30, 2017.",
            "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4738"
        },
        {
            "source_name": "InsiderThreat ChangeNTLM July 2017",
            "description": "Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017.",
            "url": "https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM"
        },
        {
            "source_name": "GitHub Mimikatz Issue 92 June 2017",
            "description": "Warren, J. (2017, June 22). lsadump::changentlm and lsadump::setntlm work, but generate Windows events #92. Retrieved December 4, 2017.",
            "url": "https://github.com/gentilkiwi/mimikatz/issues/92"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetUserChangePassword"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Account Manipulation [T1098]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "change user account password",
                    "namespace": "host-interaction/accounts",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetLocalGroupDelMembers"
                            },
                            {
                                "api": "netapi32.NetLocalGroupDelMember"
                            },
                            {
                                "api": "netapi32.NetGroupDelUser"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Account Manipulation [T1098]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "delete user account from group",
                    "namespace": "host-interaction/accounts",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetLocalGroupAddMembers"
                            },
                            {
                                "api": "netapi32.NetLocalGroupAddMember"
                            },
                            {
                                "api": "netapi32.NetGroupAddUser"
                            },
                            {
                                "api": "netapi32.NetGroupSetUsers"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Account Manipulation [T1098]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "add user account to group",
                    "namespace": "host-interaction/accounts",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetLocalGroupAdd"
                            },
                            {
                                "api": "netapi32.NetGroupAdd"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Account Manipulation [T1098]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "add user account group",
                    "namespace": "host-interaction/accounts",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetLocalGroupDel"
                            },
                            {
                                "api": "netapi32.NetGroupDel"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Account Manipulation [T1098]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "delete user account group",
                    "namespace": "host-interaction/accounts",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects global permissions change activity.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": [
                        "Global permission remove request",
                        "Global permission removed",
                        "Global permission granted",
                        "Global permission requested"
                    ],
                    "auditType.category": "Permissions"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "aac6c4f4-87c7-4961-96ac-c3fd3a42c310",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/global-permissions-776640369.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1098"
            ],
            "title": "Bitbucket Global Permission Changed"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2023/01/20",
            "description": "Detects when an organization member or an outside collaborator is added to or removed from a project board or has their permission level changed or when an owner removes an outside collaborator from an organization or when two-factor authentication is required in an organization and an outside collaborator does not use 2FA or disables 2FA.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action": [
                        "org.remove_outside_collaborator",
                        "project.update_user_permission"
                    ]
                }
            },
            "falsepositives": [
                "Validate the actor if permitted to access the repo.",
                "Validate the Multifactor Authentication changes."
            ],
            "id": "eaa9ac35-1730-441f-9587-25767bde99d7",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "references": [
                "https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#audit-log-actions",
                "https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-two-factor-authentication-for-your-organization/requiring-two-factor-authentication-in-your-organization"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.collection",
                "attack.t1098.001",
                "attack.t1098.003",
                "attack.t1213.003"
            ],
            "title": "Github Outside Collaborator Detected"
        },
        {
            "author": "kelnage",
            "date": "2023/09/07",
            "description": "Detects when a new identity provider is created for Okta.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventtype": "system.idp.lifecycle.create"
                }
            },
            "falsepositives": [
                "When an admin creates a new, authorised identity provider."
            ],
            "id": "969c7590-8c19-4797-8c1b-23155de6e7ac",
            "level": "medium",
            "logsource": {
                "product": "okta",
                "service": "okta"
            },
            "references": [
                "https://developer.okta.com/docs/reference/api/system-log/",
                "https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection"
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.t1098.001"
            ],
            "title": "Okta Identity Provider Created"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/12",
            "description": "Detects when an the Administrator role is assigned to an user or group.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventtype": [
                        "group.privilege.grant",
                        "user.account.privilege.grant"
                    ]
                }
            },
            "falsepositives": [
                "Administrator roles could be assigned to users or group by other admin users."
            ],
            "id": "413d4a81-6c98-4479-9863-014785fd579c",
            "level": "medium",
            "logsource": {
                "product": "okta",
                "service": "okta"
            },
            "modified": "2022/10/09",
            "status": "test",
            "references": [
                "https://developer.okta.com/docs/reference/api/system-log/",
                "https://developer.okta.com/docs/reference/api/event-types/"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098.003"
            ],
            "title": "Okta Admin Role Assigned to an User or Group"
        },
        {
            "author": "Bryan Lim",
            "date": "2024/01/12",
            "description": "Detects when an access policy that is applied to a GCP cloud resource is deleted.\nAn adversary would be able to remove access policies to gain access to a GCP cloud resource.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "data.protoPayload.authorizationInfo.granted": "true",
                    "data.protoPayload.authorizationInfo.permission": [
                        "accesscontextmanager.accessPolicies.delete",
                        "accesscontextmanager.accessPolicies.accessLevels.delete",
                        "accesscontextmanager.accessPolicies.accessZones.delete",
                        "accesscontextmanager.accessPolicies.authorizedOrgsDescs.delete"
                    ],
                    "data.protoPayload.serviceName": "accesscontextmanager.googleapis.com"
                }
            },
            "falsepositives": [
                "Legitimate administrative activities"
            ],
            "id": "32438676-1dba-4ac7-bf69-b86cba995e05",
            "level": "medium",
            "logsource": {
                "product": "gcp",
                "service": "gcp.audit"
            },
            "references": [
                "https://cloud.google.com/access-context-manager/docs/audit-logging",
                "https://cloud.google.com/logging/docs/audit/understanding-audit-logs",
                "https://cloud.google.com/logging/docs/reference/audit/auditlog/rest/Shared.Types/AuditLog"
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1098"
            ],
            "title": "GCP Access Policy Deleted"
        },
        {
            "author": "Bryan Lim",
            "date": "2024/01/12",
            "description": "Detects when an access level is changed for a Google workspace application.\nAn access level is part of BeyondCorp Enterprise which is Google Workspace's way of enforcing Zero Trust model.\nAn adversary would be able to remove access levels to gain easier access to Google workspace resources.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "CHANGE_APPLICATION_SETTING",
                    "eventService": "admin.googleapis.com",
                    "setting_name|startswith": "ContextAwareAccess"
                }
            },
            "falsepositives": [
                "Legitimate administrative activities changing the access levels for an application"
            ],
            "id": "22f2fb54-5312-435d-852f-7c74f81684ca",
            "level": "medium",
            "logsource": {
                "product": "gcp",
                "service": "google_workspace.admin"
            },
            "references": [
                "https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-application-settings",
                "https://support.google.com/a/answer/9261439"
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1098.003"
            ],
            "title": "Google Workspace Application Access Level Modified"
        },
        {
            "author": "Austin Songer",
            "date": "2021/08/23",
            "description": "Detects when an API access service account is granted domain authority.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "AUTHORIZE_API_CLIENT_ACCESS",
                    "eventService": "admin.googleapis.com"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "04e2a23a-9b29-4a5c-be3a-3542e3f982ba",
            "level": "medium",
            "logsource": {
                "product": "gcp",
                "service": "google_workspace.admin"
            },
            "modified": "2023/10/11",
            "status": "test",
            "references": [
                "https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3",
                "https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-domain-settings#AUTHORIZE_API_CLIENT_ACCESS"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "Google Workspace Granted Domain API Access"
        },
        {
            "author": "Austin Songer",
            "date": "2021/08/23",
            "description": "Detects when an Google Workspace user is granted admin privileges.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "GRANT_DELEGATED_ADMIN_PRIVILEGES",
                        "GRANT_ADMIN_PRIVILEGE"
                    ],
                    "eventService": "admin.googleapis.com"
                }
            },
            "falsepositives": [
                "Google Workspace admin role privileges, may be modified by system administrators."
            ],
            "id": "2d1b83e4-17c6-4896-a37b-29140b40a788",
            "level": "medium",
            "logsource": {
                "product": "gcp",
                "service": "google_workspace.admin"
            },
            "modified": "2023/10/11",
            "status": "test",
            "references": [
                "https://cloud.google.com/logging/docs/audit/gsuite-audit-logging#3",
                "https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-user-settings#GRANT_ADMIN_PRIVILEGE"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "Google Workspace User Granted Admin Privileges"
        },
        {
            "author": "faloker",
            "date": "2020/02/12",
            "description": "Detects AWS API key creation for a user by another user.\nBackdoored users can be used to obtain persistence in the AWS environment.\nAlso with this alert, you can detect a flow of AWS keys in your org.\n",
            "detection": {
                "condition": "selection_source and not filter",
                "filter": {
                    "userIdentity.arn|contains": "responseElements.accessKey.userName"
                },
                "selection_source": {
                    "eventName": "CreateAccessKey",
                    "eventSource": "iam.amazonaws.com"
                }
            },
            "falsepositives": [
                "Adding user keys to their own accounts (the filter cannot cover all possible variants of user naming)",
                "AWS API keys legitimate exchange workflows"
            ],
            "fields": [
                "userIdentity.arn",
                "responseElements.accessKey.userName",
                "errorCode",
                "errorMessage"
            ],
            "id": "0a5177f4-6ca9-44c2-aacf-d3f3d8b6e4d2",
            "level": "medium",
            "modified": "2022/10/09",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "status": "test",
            "references": [
                "https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/iam__backdoor_users_keys/main.py"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "AWS IAM Backdoor Users Keys"
        },
        {
            "author": "toffeebr33k",
            "date": "2021/08/09",
            "description": "Detects activity when someone is changing passwords on behalf of other users.\nAn attacker with the \"iam:UpdateLoginProfile\" permission on other users can change the password used to login to the AWS console on any user that already has a login profile setup.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_user_identity": {
                    "userIdentity.arn|fieldref": "requestParameters.userName"
                },
                "selection": {
                    "eventName": "UpdateLoginProfile",
                    "eventSource": "iam.amazonaws.com"
                }
            },
            "falsepositives": [
                "Legitimate user account administration"
            ],
            "id": "055fb148-60f8-462d-ad16-26926ce050f1",
            "level": "high",
            "modified": "2024/04/26",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "status": "test",
            "references": [
                "https://github.com/RhinoSecurityLabs/AWS-IAM-Privilege-Escalation"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "AWS User Login Profile Was Modified"
        },
        {
            "author": "Elastic, Austin Songer @austinsonger",
            "date": "2021/07/22",
            "description": "Detects when a request has been made to transfer a Route 53 domain to another AWS account.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "TransferDomainToAnotherAwsAccount",
                    "eventSource": "route53.amazonaws.com"
                }
            },
            "falsepositives": [
                "A domain may be transferred to another AWS account by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Domain transfers from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "b056de1a-6e6e-4e40-a67e-97c9808cf41b",
            "level": "low",
            "modified": "2022/10/09",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "status": "test",
            "references": [
                "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/integrations/aws/persistence_route_53_domain_transferred_to_another_account.toml"
            ],
            "tags": [
                "attack.persistence",
                "attack.credential_access",
                "attack.t1098"
            ],
            "title": "AWS Route 53 Domain Transferred to Another Account"
        },
        {
            "author": "Elastic, Austin Songer @austinsonger",
            "date": "2021/07/22",
            "description": "Detects when a transfer lock was removed from a Route 53 domain. It is recommended to refrain from performing this action unless intending to transfer the domain to a different registrar.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "DisableDomainTransferLock",
                    "eventSource": "route53.amazonaws.com"
                }
            },
            "falsepositives": [
                "A domain transfer lock may be disabled by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Activity from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "3940b5f1-3f46-44aa-b746-ebe615b879e0",
            "level": "low",
            "modified": "2022/10/09",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "status": "test",
            "references": [
                "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/integrations/aws/persistence_route_53_domain_transfer_lock_disabled.toml",
                "https://docs.aws.amazon.com/Route53/latest/APIReference/API_Operations_Amazon_Route_53.html",
                "https://docs.aws.amazon.com/Route53/latest/APIReference/API_domains_DisableDomainTransferLock.html"
            ],
            "tags": [
                "attack.persistence",
                "attack.credential_access",
                "attack.t1098"
            ],
            "title": "AWS Route 53 Domain Transfer Lock Disabled"
        },
        {
            "author": "Rapha\u00ebl CALVET, @MetallicHack",
            "date": "2021/10/04",
            "description": "User Added to an Administrator's Azure AD Role",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ModifiedProperties{}.NewValue|endswith": [
                        "Admins",
                        "Administrator"
                    ],
                    "Operation": "Add member to role.",
                    "Workload": "AzureActiveDirectory"
                }
            },
            "falsepositives": [
                "PIM (Privileged Identity Management) generates this event each time 'eligible role' is enabled."
            ],
            "id": "ebbeb024-5b1d-4e16-9c0c-917f86c708a7",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/10/09",
            "status": "test",
            "references": [
                "https://m365internals.com/2021/07/13/what-ive-learned-from-doing-a-year-of-cloud-forensics-in-azure-ad/"
            ],
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1098.003",
                "attack.t1078"
            ],
            "title": "User Added to an Administrator's Azure AD Role"
        },
        {
            "author": "sawwinnnaung",
            "date": "2020/05/07",
            "description": "Identifies IPs from which users grant access to other users on azure resources and alerts when a previously unseen source IP address is used.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Microsoft.Authorization/roleAssignments/write"
                ]
            },
            "falsepositives": [
                "Valid change"
            ],
            "id": "a622fcd2-4b5a-436a-b8a2-a4171161833c",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2023/10/11",
            "status": "test",
            "references": [
                "https://github.com/Azure/Azure-Sentinel/blob/e534407884b1ec5371efc9f76ead282176c9e8bb/Detections/AzureActivity/Granting_Permissions_To_Account_detection.yaml"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098.003"
            ],
            "title": "Granting Of Permissions To An Account"
        },
        {
            "author": "sawwinnnaung",
            "date": "2020/05/07",
            "description": "Number of VM creations or deployment activities occur in Azure via the azureactivity log.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Microsoft.Compute/virtualMachines/write",
                    "Microsoft.Resources/deployments/write"
                ]
            },
            "falsepositives": [
                "Valid change"
            ],
            "id": "d2d901db-7a75-45a1-bc39-0cbf00812192",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2023/10/11",
            "status": "test",
            "references": [
                "https://github.com/Azure/Azure-Sentinel/blob/e534407884b1ec5371efc9f76ead282176c9e8bb/Detections/AzureActivity/Creating_Anomalous_Number_Of_Resources_detection.yaml"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "Number Of Resource Creation Or Deployment Activities"
        },
        {
            "author": "Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'",
            "date": "2022/08/05",
            "description": "Detects when a user is removed from a privileged role. Bulk changes should be investigated.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "properties.message": [
                        "Remove eligible member (permanent)",
                        "Remove eligible member (eligible)"
                    ]
                }
            },
            "falsepositives": [
                "Legtimate administrator actions of removing members from a role"
            ],
            "id": "102e11e3-2db5-4c9e-bc26-357d42585d21",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-identity-management#azure-ad-roles-assignment"
            ],
            "status": "test",
            "title": "Bulk Deletion Changes To Privileged Account Permissions",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ]
        },
        {
            "author": "Mark Morowczynski '@markmorow', Bailey Bercik '@baileybercik'",
            "date": "2022/05/26",
            "description": "Detects when a new credential is added to an existing application. Any additional credentials added outside of expected processes could be a malicious actor using those credentials.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "properties.message": [
                        "Update Application-Certificates and secrets management",
                        "Update Service principal/Update Application"
                    ]
                }
            },
            "falsepositives": [
                "When credentials are added/removed as part of the normal working hours/workflows"
            ],
            "id": "cbb67ecc-fb70-4467-9350-c910bdf7c628",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-credentials"
            ],
            "status": "test",
            "tags": [
                "attack.t1098.001",
                "attack.persistence"
            ],
            "title": "Added Credentials to Existing Application"
        },
        {
            "author": "Bailey Bercik '@baileybercik', Mark Morowczynski '@markmorow'",
            "date": "2022/07/19",
            "description": "Detects when an app is assigned Azure AD roles, such as global administrator, or Azure RBAC roles, such as subscription owner.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "properties.message": [
                        "Add member to role",
                        "Add eligible member to role",
                        "Add scoped member to role"
                    ]
                }
            },
            "falsepositives": [
                "When the permission is legitimately needed for the app"
            ],
            "id": "b04934b2-0a68-4845-8a19-bdfed3a68a7a",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#service-principal-assigned-to-a-role"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1098.003"
            ],
            "title": "App Role Added"
        },
        {
            "author": "AlertIQ",
            "date": "2021/10/10",
            "description": "Change to authentication method could be an indicator of an attacker adding an auth method to the account so they can have continued access.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Category": "UserManagement",
                    "LoggedByService": "Authentication Methods",
                    "OperationName": "User registered security info"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4d78a000-ab52-4564-88a5-7ab5242b20c7",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "modified": "2022/12/25",
            "status": "test",
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-privileged-accounts"
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1556",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.t1098"
            ],
            "title": "Change to Authentication Method"
        },
        {
            "author": "andrewdanis",
            "date": "2024/06/26",
            "description": "Detects when an account dumps the LAPS password from Entra ID.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "activityType|contains": "Recover device local administrator password",
                    "additionalDetails.additionalInfo|contains": "Successfully recovered local credential by device id",
                    "category": "Device"
                }
            },
            "falsepositives": [
                "Approved activity performed by an Administrator."
            ],
            "id": "a4b25073-8947-489c-a8dd-93b41c23f26d",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "references": [
                "https://twitter.com/NathanMcNulty/status/1785051227568632263",
                "https://www.cloudcoffee.ch/microsoft-365/configure-windows-laps-in-microsoft-intune/",
                "https://techcommunity.microsoft.com/t5/microsoft-entra-blog/introducing-windows-local-administrator-password-solution-with/ba-p/1942487"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1098.005"
            ],
            "title": "Windows LAPS Credential Dump From Entra ID"
        },
        {
            "author": "Bailey Bercik '@baileybercik', Mark Morowczynski '@markmorow'",
            "date": "2022/07/28",
            "description": "Detects when administrator grants either application permissions (app roles) or highly privileged delegated permissions",
            "detection": {
                "condition": "selection",
                "selection": {
                    "properties.message": "Add app role assignment to service principal"
                }
            },
            "falsepositives": [
                "When the permission is legitimately needed for the app"
            ],
            "id": "5aecf3d5-f8a0-48e7-99be-3a759df7358f",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "auditlogs"
            },
            "modified": "2023/03/29",
            "status": "test",
            "references": [
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-applications#application-granted-highly-privileged-permissions"
            ],
            "related": [
                {
                    "id": "ba2a7c80-027b-460f-92e2-57d113897dbc",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1098.003"
            ],
            "title": "App Granted Privileged Delegated Or App Permissions"
        },
        {
            "author": "Mark Morowczynski '@markmorow', Gloria Lee, '@gleeiamglo'",
            "date": "2023/09/03",
            "description": "Indicates that there are anomalous patterns of behavior like suspicious changes to the directory.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "riskEventType": "anomalousUserActivity"
                }
            },
            "falsepositives": [
                "We recommend investigating the sessions flagged by this detection in the context of other sign-ins from the user."
            ],
            "id": "258b6593-215d-4a26-a141-c8e31c1299a6",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "riskdetection"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#anomalous-user-activity",
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins"
            ],
            "status": "test",
            "tags": [
                "attack.t1098",
                "attack.persistence"
            ],
            "title": "Anomalous User Activity"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Find local accounts being created or modified as well as remote authentication configurations",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "username",
                    "aaa"
                ]
            },
            "falsepositives": [
                "When remote authentication is in place, this should not change often"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "6d844f0f-1c18-41af-8f19-33e7654edfc3",
            "level": "high",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "status": "test",
            "modified": "2023/01/04",
            "tags": [
                "attack.persistence",
                "attack.t1136.001",
                "attack.t1098"
            ],
            "title": "Cisco Local Accounts"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/02/23",
            "description": "Detects addition of users to highly privileged groups via \"Net\" or \"Add-LocalGroupMember\".",
            "detection": {
                "condition": "all of selection_*",
                "selection_group": {
                    "CommandLine|contains": [
                        "Group Policy Creator Owners",
                        "Schema Admins"
                    ]
                },
                "selection_main": [
                    {
                        "CommandLine|contains|all": [
                            "localgroup ",
                            " /add"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "Add-LocalGroupMember ",
                            " -Group "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Administrative activity that must be investigated"
            ],
            "id": "10fb649c-3600-4d37-b1e6-56ea90bb7e09",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
            ],
            "related": [
                {
                    "id": "ffa28e60-bdb1-46e0-9f82-05f7a61cc06e",
                    "type": "similar"
                },
                {
                    "id": "ad720b90-25ad-43ff-9b5e-5c841facc8e5",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "User Added To Highly Privileged Group"
        },
        {
            "id": "ad720b90-25ad-43ff-9b5e-5c841facc8e5",
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/12",
            "description": "Detects addition of users to the local administrator group via \"Net\" or \"Add-LocalGroupMember\".",
            "detection": {
                "condition": "all of selection_*",
                "selection_group": {
                    "CommandLine|contains": [
                        " administrators ",
                        " administrateur"
                    ]
                },
                "selection_main": [
                    {
                        "CommandLine|contains|all": [
                            "localgroup ",
                            " /add"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "Add-LocalGroupMember ",
                            " -Group "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/02",
            "status": "test",
            "references": [
                "https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1"
            ],
            "related": [
                {
                    "id": "ffa28e60-bdb1-46e0-9f82-05f7a61cc06e",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "10fb649c-3600-4d37-b1e6-56ea90bb7e09"
                }
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "User Added to Local Administrators Group"
        },
        {
            "author": "@neu5ron",
            "date": "2017/07/30",
            "description": "Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.",
            "detection": {
                "condition": "all of selection*",
                "selection_base": {
                    "EventID": 4704
                },
                "selection_keywords": {
                    "PrivilegeList|contains": "SeEnableDelegationPrivilege"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "311b6ce2-7890-4383-a8c2-663a9f6b43cd",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change",
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/12/02",
            "status": "test",
            "references": [
                "https://blog.harmj0y.net/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "Enabled User Right in AD to Control User Objects"
        },
        {
            "author": "Samir Bousseaden, Roberto Rodriguez @Cyb3rWard0g, oscd.community, Tim Shelton, Maxence Fossat",
            "date": "2019/04/03",
            "description": "Backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_dns_object_class": {
                    "ObjectClass": [
                        "dnsNode",
                        "dnsZoneScope",
                        "dnsZone"
                    ]
                },
                "selection": {
                    "AttributeLDAPDisplayName": "ntSecurityDescriptor",
                    "AttributeValue|contains": [
                        "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
                        "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
                        "89e95b76-444d-4c62-991a-0facbeda640c"
                    ],
                    "EventID": 5136
                }
            },
            "falsepositives": [
                "New Domain Controller computer account, check user SIDs within the value attribute of event 5136 and verify if it's a regular user or DC computer account."
            ],
            "id": "2c99737c-585d-4431-b61a-c911d86ff32f",
            "level": "high",
            "logsource": {
                "definition": "Requirements: The \"Audit Directory Service Changes\" logging policy must be configured in order to receive events. Audit events are generated only for objects with configured system access control lists (SACLs). Audit events are generated only for objects with configured system access control lists (SACLs) and only when accessed in a manner that matches their SACL settings. This policy covers the following events ids - 5136, 5137, 5138, 5139, 5141. Note that the default policy does not cover User objects. For that a custom AuditRule need to be setup (See https://github.com/OTRF/Set-AuditRule)",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/08/16",
            "status": "test",
            "references": [
                "https://twitter.com/menasec1/status/1111556090137903104",
                "https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "Powerview Add-DomainObjectAcl DCSync AD Extend Right"
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/02/19",
            "description": "Detects potential attempts made to set the Directory Services Restore Mode administrator password.\nThe Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers.\nAttackers may change the password in order to obtain persistence.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4794
                }
            },
            "falsepositives": [
                "Initial installation of a domain controller."
            ],
            "id": "53ad8e36-f573-46bf-97e4-15ba5bf4bb51",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2020/08/23",
            "references": [
                "https://adsecurity.org/?p=1714",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4794"
            ],
            "related": [
                {
                    "id": "b61e87c0-50db-4b2e-8986-6a2be94b33b0",
                    "type": "similar"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "Password Change on Directory Service Restore Mode (DSRM) Account"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/03/14",
            "description": "Detects the addition of a new member to the local administrator group, which could be legitimate activity or a sign of privilege escalation activity",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "filter_main_computer_accounts": {
                    "SubjectUserName|endswith": "$"
                },
                "selection_eid": {
                    "EventID": 4732
                },
                "selection_group": [
                    {
                        "TargetUserName|startswith": "Administr"
                    },
                    {
                        "TargetSid": "S-1-5-32-544"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "id": "c265cf08-3f99-46c1-8d59-328247057d57",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/01/17",
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4732",
                "https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers"
            ],
            "status": "stable",
            "tags": [
                "attack.privilege_escalation",
                "attack.t1078",
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "User Added to Local Administrator Group"
        },
        {
            "author": "@neu5ron",
            "date": "2017/04/13",
            "description": "Detects scenarios where one can control another users or computers account without having to use their credentials.",
            "detection": {
                "condition": "(selection1 and not 1 of filter_*) or 1 of selection_5136_*",
                "filter_empty": {
                    "AllowedToDelegateTo": [
                        "",
                        "-"
                    ]
                },
                "filter_null": {
                    "AllowedToDelegateTo": null
                },
                "selection1": {
                    "EventID": 4738
                },
                "selection_5136_1": {
                    "AttributeLDAPDisplayName": "msDS-AllowedToDelegateTo",
                    "EventID": 5136
                },
                "selection_5136_2": {
                    "AttributeLDAPDisplayName": "servicePrincipalName",
                    "EventID": 5136,
                    "ObjectClass": "user"
                },
                "selection_5136_3": {
                    "AttributeLDAPDisplayName": "msDS-AllowedToActOnBehalfOfOtherIdentity",
                    "EventID": 5136
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "300bac00-e041-4ee2-9c36-e262656a6ecc",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management, DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes",
                "product": "windows",
                "service": "security"
            },
            "modified": "2024/02/26",
            "status": "test",
            "references": [
                "https://msdn.microsoft.com/en-us/library/cc220234.aspx",
                "https://adsecurity.org/?p=3466",
                "https://blog.harmj0y.net/redteaming/another-word-on-delegation/"
            ],
            "tags": [
                "attack.t1098",
                "attack.persistence"
            ],
            "title": "Active Directory User Backdoors"
        },
        {
            "author": "Thomas Patzke",
            "date": "2019/12/03",
            "description": "Addition of domains is seldom and should be verified for legitimacy.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4706
                }
            },
            "falsepositives": [
                "Legitimate extension of domain structure"
            ],
            "id": "0255a820-e564-4e40-af2b-6ac61160335c",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2024/01/16",
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4706"
            ],
            "status": "stable",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "A New Trust Was Created To A Domain"
        },
        {
            "author": "Alexandr Yampolskyi, SOC Prime",
            "date": "2023/04/26",
            "description": "Detects activity when a member is removed from a security-enabled global group",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        633,
                        4729
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "02c39d30-02b5-45d2-b435-8aebfe5a8629",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://www.cisecurity.org/controls/cis-controls-list/",
                "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
                "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4729",
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=633"
            ],
            "related": [
                {
                    "id": "9cf01b6c-e723-4841-a868-6d7f8245ca6e",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "A Member Was Removed From a Security-Enabled Global Group"
        },
        {
            "author": "Alexandr Yampolskyi, SOC Prime",
            "date": "2023/04/26",
            "description": "Detects activity when a security-enabled global group is deleted",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4730,
                        634
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b237c54b-0f15-4612-a819-44b735e0de27",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://www.cisecurity.org/controls/cis-controls-list/",
                "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
                "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4730",
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=634"
            ],
            "related": [
                {
                    "id": "9cf01b6c-e723-4841-a868-6d7f8245ca6e",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "A Security-Enabled Global Group Was Deleted"
        },
        {
            "author": "Alexandr Yampolskyi, SOC Prime",
            "date": "2023/04/26",
            "description": "Detects activity when a member is added to a security-enabled global group",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4728,
                        632
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c43c26be-2e87-46c7-8661-284588c5a53e",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://www.cisecurity.org/controls/cis-controls-list/",
                "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
                "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4728",
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=632"
            ],
            "related": [
                {
                    "id": "9cf01b6c-e723-4841-a868-6d7f8245ca6e",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ],
            "title": "A Member Was Added to a Security-Enabled Global Group"
        },
        {
            "author": "frack113",
            "date": "2021/12/28",
            "description": "Adversaries may manipulate accounts to maintain access to victim systems.\nAccount manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Disable-LocalUser",
                        "Enable-LocalUser",
                        "Get-LocalUser",
                        "Set-LocalUser",
                        "New-LocalUser",
                        "Rename-LocalUser",
                        "Remove-LocalUser"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative script"
            ],
            "id": "4fdc44df-bfe9-4fcc-b041-68f5a2d3031c",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1098/T1098.md#atomic-test-1---admin-account-manipulate",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.localaccounts/?view=powershell-5.1"
            ],
            "status": "test",
            "title": "Powershell LocalAccount Manipulation",
            "tags": [
                "attack.persistence",
                "attack.t1098"
            ]
        },
        {
            "author": "Pawel Mazur",
            "date": "2022/12/21",
            "description": "Detects the addition of a new user to a privileged group such as \"root\" or \"sudo\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_new_user": [
                    "new user"
                ],
                "selection_uids_gids": [
                    "GID=0",
                    "UID=0",
                    "GID=10",
                    "GID=27"
                ]
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "id": "0ac15ec3-d24f-4246-aa2a-3077bb1cf90e",
            "level": "high",
            "logsource": {
                "definition": "/var/log/secure on REHL systems or /var/log/auth.log on debian like Systems needs to be collected in order for this detection to work",
                "product": "linux"
            },
            "references": [
                "https://digital.nhs.uk/cyber-alerts/2018/cc-2825",
                "https://linux.die.net/man/8/useradd",
                "https://github.com/redcanaryco/atomic-red-team/blob/25acadc0b43a07125a8a5b599b28bbc1a91ffb06/atomics/T1136.001/T1136.001.md#atomic-test-5---create-a-new-user-in-linux-with-root-uid-and-gid"
            ],
            "status": "test",
            "title": "Privileged User Has Been Created",
            "tags": [
                "attack.persistence",
                "attack.t1136.001",
                "attack.t1098"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "Azure AD",
        "Office 365",
        "IaaS",
        "Linux",
        "macOS",
        "Google Workspace",
        "SaaS",
        "Network",
        "Containers"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Jannie Li, Microsoft Threat Intelligence\u202fCenter\u202f(MSTIC)",
        "Praetorian",
        "Tim MalcomVetter",
        "Wojciech Lesicki",
        "Arad Inbar, Fidelis Security"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "privilege-escalation"
        }
    ],
    "x_mitre_detection": "Collect events that correlate with changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670.(Citation: Microsoft User Modified Event)(Citation: Microsoft Security Event 4670)(Citation: Microsoft Security Event 4670) Monitor for modification of accounts in correlation with other suspicious activity. Changes may occur at unusual times or from unusual systems. Especially flag events where the subject and target accounts differ(Citation: InsiderThreat ChangeNTLM July 2017) or that include additional flags such as changing a password without knowledge of the old password.(Citation: GitHub Mimikatz Issue 92 June 2017)\n\nMonitor for use of credentials at unusual times or to unusual systems or services. This may also correlate with other suspicious activity.\n\nMonitor for unusual permissions changes that may indicate excessively broad permissions being granted to compromised accounts. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged [Valid Accounts](https://attack.mitre.org/techniques/T1078)",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.6",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "Process: Process Creation",
        "Active Directory: Active Directory Object Modification",
        "File: File Modification",
        "Group: Group Modification",
        "User Account: User Account Modification"
    ],
    "x_mitre_permissions_required": []
}