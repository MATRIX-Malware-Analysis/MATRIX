{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--ee1a071b-c691-4ea6-abf9-9338b5ae0f01",
    "created": "2024-08-13T14:46:37.174297Z",
    "modified": "2024-08-13T14:46:48.721178Z",
    "name": "Impair Defenses",
    "description": "Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.Adversaries may also impair routine operations that contribute to defensive hygiene, such as blocking users from logging out of a computer or stopping it from being shut down. These restrictions can further enable malicious operations as well as the continued propagation of incidents.[1]Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1562",
            "external_id": "T1562"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1562",
            "external_id": "T1562"
        },
        {
            "source_name": "Emotet shutdown",
            "description": "The DFIR Report. (2022, November 8). Emotet Strikes Again \u2013 LNK File Leads to Domain Wide Ransomware. Retrieved March 6, 2023.",
            "url": "https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "iphlpapi.SetTcpEntry"
                            },
                            {
                                "number": "12 = MIB_TCP_STATE_DELETE_TCB"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Impair Defenses [T1562]"
                    ],
                    "authors": [
                        "@johnk3r"
                    ],
                    "description": "The SetTcpEntry function sets the state of a TCP connection.",
                    "examples": [
                        "883bf161937f8dc6e766b07000110254:0x403150"
                    ],
                    "name": "set TCP connection state",
                    "namespace": "host-interaction/network/connectivity",
                    "references": [
                        "https://unit42.paloaltonetworks.com/evilgrab-delivered-by-watering-hole-attack-on-president-of-myanmars-website",
                        "https://github.com/magisterquis/EDRSniper/blob/master/edrsniper.c"
                    ],
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects Bitbucket global secret scanning rule deletion activity.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "Global secret scanning rule deleted",
                    "auditType.category": "Global administration"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "e16cf0f0-ee88-4901-bd0b-4c8d13d9ee05",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Basic\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Bitbucket Global Secret Scanning Rule Deleted"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects changes to the bitbucket audit log configuration.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "Audit log configuration updated",
                    "auditType.category": "Auditing"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "6aa12161-235a-4dfb-9c74-fe08df8d8da1",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Basic\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/view-and-configure-the-audit-log-776640417.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Bitbucket Audit Log Configuration Updated"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects when a repository is exempted from secret scanning feature.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "Secret scanning exempt repository added",
                    "auditType.category": "Repositories"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "b91e8d5e-0033-44fe-973f-b730316f23a1",
            "level": "high",
            "logsource": {
                "definition": "Requirements: \"Basic\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Bitbucket Secret Scanning Exempt Repository Added"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects when secret scanning rule is deleted for the project or repository.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": [
                        "Project secret scanning rule deleted",
                        "Repository secret scanning rule deleted"
                    ],
                    "auditType.category": [
                        "Projects",
                        "Repositories"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "ff91e3f0-ad15-459f-9a85-1556390c138d",
            "level": "low",
            "logsource": {
                "definition": "Requirements: \"Basic\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Bitbucket Secret Scanning Rule Deleted"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects Bitbucket global SSH access configuration changes.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "SSH settings changed",
                    "auditType.category": "Global administration"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "16ab6143-510a-44e2-a615-bdb80b8317fc",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: \"Advance\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/enable-ssh-access-to-git-repositories-776640358.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.lateral_movement",
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1021.004"
            ],
            "title": "Bitbucket Global SSH Settings Changed"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/02/25",
            "description": "Detects when a secret scanning allowlist rule is added for projects.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "auditType.action": "Project secret scanning allowlist rule added",
                    "auditType.category": "Projects"
                }
            },
            "falsepositives": [
                "Legitimate user activity."
            ],
            "id": "42ccce6d-7bd3-4930-95cd-e4d83fa94a30",
            "level": "low",
            "logsource": {
                "definition": "Requirements: \"Basic\" log level is required to receive these audit events.",
                "product": "bitbucket",
                "service": "audit"
            },
            "references": [
                "https://confluence.atlassian.com/bitbucketserver/audit-log-events-776640423.html",
                "https://confluence.atlassian.com/bitbucketserver/secret-scanning-1157471613.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Bitbucket Project Secret Scanning Allowlist Added"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/03/07",
            "description": "Detects if the push protection feature is disabled for an organization, enterprise, repositories or custom pattern rules.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action": [
                        "business_secret_scanning_custom_pattern_push_protection.disabled",
                        "business_secret_scanning_push_protection.disable",
                        "business_secret_scanning_push_protection.disabled_for_new_repos",
                        "org.secret_scanning_custom_pattern_push_protection_disabled",
                        "org.secret_scanning_push_protection_disable",
                        "org.secret_scanning_push_protection_new_repos_disable",
                        "repository_secret_scanning_custom_pattern_push_protection.disabled"
                    ]
                }
            },
            "falsepositives": [
                "Allowed administrative activities."
            ],
            "id": "ccd55945-badd-4bae-936b-823a735d37dd",
            "level": "high",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "references": [
                "https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/push-protection-for-repositories-and-organizations",
                "https://thehackernews.com/2024/03/github-rolls-out-default-secret.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Github Push Protection Disabled"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/03/07",
            "description": "Detects when a user bypasses the push protection on a secret detected by secret scanning.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action|contains": "secret_scanning_push_protection.bypass"
                }
            },
            "falsepositives": [
                "Allowed administrative activities."
            ],
            "id": "02cf536a-cf21-4876-8842-4159c8aee3cc",
            "level": "low",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "references": [
                "https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/push-protection-for-repositories-and-organizations",
                "https://thehackernews.com/2024/03/github-rolls-out-default-secret.html"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Github Push Protection Bypass Detected"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2024/03/07",
            "description": "Detects if the secret scanning feature is disabled for an enterprise or repository.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action": [
                        "business_secret_scanning.disable",
                        "business_secret_scanning.disabled_for_new_repos",
                        "repository_secret_scanning.disable",
                        "secret_scanning_new_repos.disable",
                        "secret_scanning.disable"
                    ]
                }
            },
            "falsepositives": [
                "Allowed administrative activities."
            ],
            "id": "3883d9a0-fd0f-440f-afbb-445a2a799bb8",
            "level": "high",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "modified": "2024/07/19",
            "status": "experimental",
            "references": [
                "https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/about-secret-scanning"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Github Secret Scanning Feature Disabled"
        },
        {
            "author": "kelnage",
            "date": "2023/09/07",
            "description": "Detects when an Okta user session starts where the user is behind an anonymising proxy service.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventtype": "user.session.start",
                    "securitycontext.isproxy": "true"
                }
            },
            "falsepositives": [
                "If a user requires an anonymising proxy due to valid justifications."
            ],
            "id": "bde30855-5c53-4c18-ae90-1ff79ebc9578",
            "level": "high",
            "logsource": {
                "product": "okta",
                "service": "okta"
            },
            "references": [
                "https://developer.okta.com/docs/reference/api/system-log/",
                "https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.006"
            ],
            "title": "Okta User Session Start Via An Anonymising Proxy Service"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/13",
            "description": "Detects  when a firewall rule is modified or deleted in Google Cloud Platform (GCP).",
            "detection": {
                "condition": "selection",
                "selection": {
                    "gcp.audit.method_name": [
                        "v*.Compute.Firewalls.Delete",
                        "v*.Compute.Firewalls.Patch",
                        "v*.Compute.Firewalls.Update",
                        "v*.Compute.Firewalls.Insert"
                    ]
                }
            },
            "falsepositives": [
                "Firewall rules being modified or deleted may be performed by a system administrator. Verify that the firewall configuration change was expected.",
                "Exceptions can be added to this rule to filter expected behavior."
            ],
            "id": "fe513c69-734c-4d4a-8548-ac5f609be82b",
            "level": "medium",
            "logsource": {
                "product": "gcp",
                "service": "gcp.audit"
            },
            "modified": "2022/10/09",
            "references": [
                "https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging",
                "https://developers.google.com/resources/api-libraries/documentation/compute/v1/java/latest/com/google/api/services/compute/Compute.Firewalls.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Google Cloud Firewall Modified or Deleted"
        },
        {
            "author": "faloker",
            "date": "2020/02/11",
            "description": "Detects updates of the GuardDuty list of trusted IPs, perhaps to disable security alerts against malicious IPs.",
            "detection": {
                "condition": "selection_source",
                "selection_source": {
                    "eventName": "CreateIPSet",
                    "eventSource": "guardduty.amazonaws.com"
                }
            },
            "falsepositives": [
                "Valid change in the GuardDuty (e.g. to ignore internal scanners)"
            ],
            "id": "6e61ee20-ce00-4f8d-8aee-bedd8216f7e3",
            "level": "high",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/guardduty__whitelist_ip/main.py#L9"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "AWS GuardDuty Important Change"
        },
        {
            "author": "vitaliy0x1",
            "date": "2020/01/21",
            "description": "Detects disabling, deleting and updating of a Trail",
            "detection": {
                "condition": "selection_source",
                "selection_source": {
                    "eventName": [
                        "StopLogging",
                        "UpdateTrail",
                        "DeleteTrail"
                    ],
                    "eventSource": "cloudtrail.amazonaws.com"
                }
            },
            "falsepositives": [
                "Valid change in a Trail"
            ],
            "id": "4db60cc0-36fb-42b7-9b58-a5b53019fb74",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "AWS CloudTrail Important Change"
        },
        {
            "author": "vitaliy0x1",
            "date": "2020/01/21",
            "description": "Detects AWS Config Service disabling",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "DeleteDeliveryChannel",
                        "StopConfigurationRecorder"
                    ],
                    "eventSource": "config.amazonaws.com"
                }
            },
            "falsepositives": [
                "Valid change in AWS Config Service"
            ],
            "id": "07330162-dba1-4746-8121-a9647d49d297",
            "level": "high",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://docs.aws.amazon.com/config/latest/developerguide/cloudtrail-log-files-for-aws-config.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "AWS Config Disabling Channel/Recorder"
        },
        {
            "author": "Sittikorn S",
            "date": "2021/06/28",
            "description": "Detects the modification of the findings on SecurityHub.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "BatchUpdateFindings",
                        "DeleteInsight",
                        "UpdateFindings",
                        "UpdateInsight"
                    ],
                    "eventSource": "securityhub.amazonaws.com"
                }
            },
            "falsepositives": [
                "System or Network administrator behaviors",
                "DEV, UAT, SAT environment. You should apply this rule with PROD environment only."
            ],
            "fields": [
                "sourceIPAddress",
                "userIdentity.arn"
            ],
            "id": "a607e1fe-74bf-4440-a3ec-b059b9103157",
            "level": "high",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "references": [
                "https://docs.aws.amazon.com/cli/latest/reference/securityhub/"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "AWS SecurityHub Findings Evasion"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/02",
            "description": "Identifies when a Firewall Policy is Modified or Deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/WRITE",
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/JOIN/ACTION",
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/CERTIFICATES/ACTION",
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/DELETE"
                    ]
                }
            },
            "falsepositives": [
                "Firewall Policy being modified or deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Firewall Policy modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "83c17918-746e-4bd9-920b-8e098bf88c23",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1562.007"
            ],
            "title": "Azure Network Firewall Policy Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/08",
            "description": "Identifies when a firewall is created, modified, or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/WRITE",
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/DELETE"
                    ]
                }
            },
            "falsepositives": [
                "Firewall being modified or deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Firewall modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "512cf937-ea9b-4332-939c-4c2c94baadcd",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Azure Firewall Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/07/24",
            "description": "Detects when Events are deleted in Azure Kubernetes. An adversary may delete events in Azure Kubernetes in an attempt to evade detection.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": "MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/EVENTS.K8S.IO/EVENTS/DELETE"
                }
            },
            "falsepositives": [
                "Event deletions may be done by a system or network administrator. Verify whether the username, hostname, and/or resource name should be making changes in your environment. Events deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "225d8b09-e714-479c-a0e4-55e6f29adf35",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes",
                "https://github.com/elastic/detection-rules/blob/da3852b681cf1a33898b1535892eab1f3a76177a/rules/integrations/azure/defense_evasion_kubernetes_events_deleted.toml"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562",
                "attack.t1562.001"
            ],
            "title": "Azure Kubernetes Events Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/08",
            "description": "Identifies when Rule Collections (Application, NAT, and Network) is being modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/APPLICATIONRULECOLLECTIONS/WRITE",
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/APPLICATIONRULECOLLECTIONS/DELETE",
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/NATRULECOLLECTIONS/WRITE",
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/NATRULECOLLECTIONS/DELETE",
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/NETWORKRULECOLLECTIONS/WRITE",
                        "MICROSOFT.NETWORK/AZUREFIREWALLS/NETWORKRULECOLLECTIONS/DELETE"
                    ]
                }
            },
            "falsepositives": [
                "Rule Collections (Application, NAT, and Network) being modified or deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Rule Collections (Application, NAT, and Network) modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "025c9fe7-db72-49f9-af0d-31341dd7dd57",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Azure Firewall Rule Collection Modified or Deleted"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/11",
            "description": "Turn off logging locally or remote",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "no logging",
                    "no aaa new-model"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "src",
                "CmdSet",
                "User",
                "Privilege_Level",
                "Remote_Address"
            ],
            "id": "9e8f6035-88bf-4a63-96b6-b17c0508257e",
            "level": "high",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "references": [
                "https://www.cisco.com/en/US/docs/ios/security/command/reference/sec_a2.pdf"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Cisco Disabling Logging"
        },
        {
            "author": "Daniil Yugoslavskiy, oscd.community",
            "date": "2020/10/19",
            "description": "Detects disabling security tools",
            "detection": {
                "condition": "(launchctl_unload and security_plists) or disable_gatekeeper",
                "disable_gatekeeper": {
                    "CommandLine|contains": "disable",
                    "Image": "/usr/sbin/spctl"
                },
                "launchctl_unload": {
                    "CommandLine|contains": "unload",
                    "Image": "/bin/launchctl"
                },
                "security_plists": {
                    "CommandLine|contains": [
                        "com.objective-see.lulu.plist",
                        "com.objective-see.blockblock.plist",
                        "com.google.santad.plist",
                        "com.carbonblack.defense.daemon.plist",
                        "com.carbonblack.daemon.plist",
                        "at.obdev.littlesnitchd.plist",
                        "com.tenablesecurity.nessusagent.plist",
                        "com.opendns.osx.RoamingClientConfigUpdater.plist",
                        "com.crowdstrike.falcond.plist",
                        "com.crowdstrike.userdaemon.plist",
                        "osquery",
                        "filebeat",
                        "auditbeat",
                        "packetbeat",
                        "td-agent"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate activities"
            ],
            "id": "ff39f1a6-84ac-476f-a1af-37fcdf53d7c0",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable Security Tools"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/07",
            "description": "Detects the use of SysmonEnte, a tool to attack the integrity of Sysmon",
            "detection": {
                "condition": "( selection_sysmon and not 1 of filter_main_* ) or selection_calltrace",
                "filter_main_generic": {
                    "SourceImage|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "filter_main_msdefender": {
                    "SourceImage|contains": ":\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                    "SourceImage|endswith": "\\MsMpEng.exe"
                },
                "selection_calltrace": {
                    "CallTrace": "Ente"
                },
                "selection_sysmon": {
                    "GrantedAccess": "0x1400",
                    "TargetImage|contains": [
                        ":\\Windows\\Sysmon.exe",
                        ":\\Windows\\Sysmon64.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d29ada0f-af45-4f27-8f32-f7b77c3dbc4e",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/28",
            "references": [
                "https://codewhitesec.blogspot.com/2022/09/attacks-on-sysmon-revisited-sysmonente.html",
                "https://github.com/codewhitesec/SysmonEnte/",
                "https://github.com/codewhitesec/SysmonEnte/blob/main/screens/1.png"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "HackTool - SysmonEnte Execution"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/08/04",
            "description": "Detects a typical pattern of a CobaltStrike BOF which inject into other processes",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallTrace|re": "^C:\\\\Windows\\\\SYSTEM32\\\\ntdll\\.dll\\+[a-z0-9]{4,6}\\|C:\\\\Windows\\\\System32\\\\KERNELBASE\\.dll\\+[a-z0-9]{4,6}\\|UNKNOWN\\([A-Z0-9]{16}\\)$",
                    "GrantedAccess": [
                        "0x1028",
                        "0x1fffff"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "09706624-b7f6-455d-9d02-adee024cee1d",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/28",
            "references": [
                "https://github.com/boku7/injectAmsiBypass",
                "https://github.com/boku7/spawn"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1106",
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "HackTool - CobaltStrike BOF Injection Pattern"
        },
        {
            "author": "Tim Burrell",
            "date": "2020/01/02",
            "description": "Detects suspicious access to the \"svchost\" process such as that used by Invoke-Phantom to kill the thread of the Windows event logging service.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_msbuild": {
                    "CallTrace|contains": [
                        "Microsoft.Build.ni.dll",
                        "System.ni.dll"
                    ],
                    "SourceImage|contains": ":\\Program Files\\Microsoft Visual Studio\\",
                    "SourceImage|endswith": "\\MSBuild\\Current\\Bin\\MSBuild.exe"
                },
                "selection": {
                    "CallTrace|contains": "UNKNOWN",
                    "GrantedAccess": "0x1F3FFF",
                    "TargetImage|endswith": ":\\Windows\\System32\\svchost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "166e9c50-8cd9-44af-815d-d1f0c0e90dde",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/01/30",
            "references": [
                "https://github.com/hlldz/Invoke-Phant0m",
                "https://twitter.com/timbmsft/status/900724491076214784"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Suspicious Svchost Process Access"
        },
        {
            "author": "Luc G\u00e9naux",
            "date": "2023/11/28",
            "description": "Detects the load of RstrtMgr DLL (Restart Manager) by a suspicious process.\nThis library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\nIt could also be used for anti-analysis purposes by shut downing specific processes.\n",
            "detection": {
                "condition": "selection_img and 1 of selection_folders_*",
                "selection_folders_1": {
                    "Image|contains": [
                        ":\\Perflogs\\",
                        ":\\Users\\Public\\",
                        "\\Temporary Internet"
                    ]
                },
                "selection_folders_2": [
                    {
                        "Image|contains|all": [
                            ":\\Users\\",
                            "\\Favorites\\"
                        ]
                    },
                    {
                        "Image|contains|all": [
                            ":\\Users\\",
                            "\\Favourites\\"
                        ]
                    },
                    {
                        "Image|contains|all": [
                            ":\\Users\\",
                            "\\Contacts\\"
                        ]
                    }
                ],
                "selection_img": [
                    {
                        "ImageLoaded|endswith": "\\RstrtMgr.dll"
                    },
                    {
                        "OriginalFileName": "RstrtMgr.dll"
                    }
                ]
            },
            "falsepositives": [
                "Processes related to software installation"
            ],
            "id": "b48492dc-c5ef-4572-8dff-32bc241c15c8",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "references": [
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-1/",
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-2/",
                "https://www.swascan.com/cactus-ransomware-malware-analysis/",
                "https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html"
            ],
            "related": [
                {
                    "id": "3669afd2-9891-4534-a626-e5cf03810a61",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1486",
                "attack.t1562.001"
            ],
            "title": "Load Of RstrtMgr.DLL By A Suspicious Process"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/07",
            "description": "Detects the load of EvtMuteHook.dll, a key component of SharpEvtHook, a tool that tampers with the Windows event logs",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Hashes|contains": "IMPHASH=330768A4F172E10ACB6287B87289D83B"
                    },
                    {
                        "Imphash": "330768a4f172e10acb6287b87289d83b"
                    }
                ]
            },
            "falsepositives": [
                "Other DLLs with the same Imphash"
            ],
            "id": "49329257-089d-46e6-af37-4afce4290685",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2023/02/17",
            "references": [
                "https://github.com/bats3c/EvtMute"
            ],
            "related": [
                {
                    "id": "bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "HackTool - SharpEvtMute DLL Load"
        },
        {
            "id": "3669afd2-9891-4534-a626-e5cf03810a61",
            "author": "Luc G\u00e9naux",
            "date": "2023/11/28",
            "description": "Detects the load of RstrtMgr DLL (Restart Manager) by an uncommon process.\nThis library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\nIt could also be used for anti-analysis purposes by shut downing specific processes.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_admin_software_installations": {
                    "Image|contains": ":\\Windows\\Temp\\"
                },
                "filter_main_generic": {
                    "Image|contains": [
                        ":\\$WINDOWS.~BT\\",
                        ":\\$WinREAgent\\",
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\ProgramData\\",
                        ":\\Windows\\explorer.exe",
                        ":\\Windows\\SoftwareDistribution\\",
                        ":\\Windows\\SysNative\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\",
                        ":\\Windows\\WinSxS\\",
                        ":\\WUDownloadCache\\"
                    ]
                },
                "filter_main_user_software_installations": {
                    "Image|contains|all": [
                        ":\\Users\\",
                        "\\AppData\\Local\\Temp\\is-",
                        ".tmp\\"
                    ],
                    "Image|endswith": ".tmp"
                },
                "selection": [
                    {
                        "ImageLoaded|endswith": "\\RstrtMgr.dll"
                    },
                    {
                        "OriginalFileName": "RstrtMgr.dll"
                    }
                ]
            },
            "falsepositives": [
                "Other legitimate Windows processes not currently listed",
                "Processes related to software installation"
            ],
            "level": "low",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "references": [
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-1/",
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-2/",
                "https://www.swascan.com/cactus-ransomware-malware-analysis/",
                "https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "b48492dc-c5ef-4572-8dff-32bc241c15c8"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1486",
                "attack.t1562.001"
            ],
            "title": "Load Of RstrtMgr.DLL By An Uncommon Process"
        },
        {
            "author": "xknow (@xknow_infosec), xorxes (@xor_xes)",
            "date": "2019/04/08",
            "description": "Detects the creation of the PROCEXP152.sys file in the application-data local temporary folder.\nThis driver is used by Sysinternals Process Explorer but also by KDU (https://github.com/hfiref0x/KDU) or Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU.\n",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|contains": [
                        "\\procexp64.exe",
                        "\\procexp.exe",
                        "\\procmon64.exe",
                        "\\procmon.exe"
                    ]
                },
                "selection": {
                    "TargetFilename|contains": "\\AppData\\Local\\Temp\\",
                    "TargetFilename|endswith": "PROCEXP152.sys"
                }
            },
            "falsepositives": [
                "Other legimate tools using this driver and filename (like Sysinternals). Note - Clever attackers may easily bypass this detection by just renaming the driver filename. Therefore just Medium-level and don't rely on it."
            ],
            "id": "3da70954-0f2c-4103-adff-b7440368f50e",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/11/22",
            "references": [
                "https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/"
            ],
            "status": "test",
            "tags": [
                "attack.t1562.001",
                "attack.defense_evasion"
            ],
            "title": "Suspicious PROCEXP152.sys File Created In TMP"
        },
        {
            "author": "D3F7A5105",
            "date": "2023/01/02",
            "description": "Detects the creation of new files with the \".evtx\" extension in non-common or non-standard location.\nThis could indicate tampering with default EVTX locations in order to evade security controls or simply exfiltration of event log to search for sensitive information within.\nNote that backup software and legitimate administrator might perform similar actions during troubleshooting.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_baseimage": {
                    "TargetFilename|endswith": "\\Windows\\System32\\winevt\\Logs\\",
                    "TargetFilename|startswith": "C:\\ProgramData\\Microsoft\\Windows\\Containers\\BaseImages\\"
                },
                "filter_main_path": {
                    "TargetFilename|startswith": "C:\\Windows\\System32\\winevt\\Logs\\"
                },
                "selection": {
                    "TargetFilename|endswith": ".evtx"
                }
            },
            "falsepositives": [
                "Administrator or backup activity",
                "An unknown bug seems to trigger the Windows \"svchost\" process to drop EVTX files in the \"C:\\Windows\\Temp\" directory in the form \"<log_name\">_<uuid>.evtx\". See https://superuser.com/questions/1371229/low-disk-space-after-filling-up-c-windows-temp-with-evtx-and-txt-files"
            ],
            "id": "65236ec7-ace0-4f0c-82fd-737b04fd4dcb",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows",
                "definition": "Requirements: The \".evtx\" extension should be monitored via a Sysmon configuration. Example: <TargetFilename condition=\"end with\">.evtx<TargetFilename>"
            },
            "modified": "2024/03/26",
            "status": "experimental",
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "EVTX Created In Uncommon Location"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/23",
            "description": "Detects suspicious execution of Sysinternals PsSuspend, where the utility is used to suspend critical processes such as AV or EDR to bypass defenses",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "msmpeng.exe"
                },
                "selection_img": [
                    {
                        "OriginalFileName": "pssuspend.exe"
                    },
                    {
                        "Image|endswith": [
                            "\\pssuspend.exe",
                            "\\pssuspend64.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "4beb6ae0-f85b-41e2-8f18-8668abc8af78",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/pssuspend",
                "https://twitter.com/0gtweet/status/1638069413717975046"
            ],
            "related": [
                {
                    "id": "48bbc537-b652-4b4e-bd1d-281172df448f",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Sysinternals PsSuspend Suspicious Execution"
        },
        {
            "author": "Sander Wiebing, Jonhnathan Ribeiro, Daniil Yugoslavskiy, oscd.community",
            "date": "2020/05/25",
            "description": "Detects Netsh command execution that whitelists a program located in a suspicious location in the Windows Firewall",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": [
                    {
                        "CommandLine|contains|all": [
                            "firewall",
                            "add",
                            "allowedprogram"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "advfirewall",
                            "firewall",
                            "add",
                            "rule",
                            "action=allow",
                            "program="
                        ]
                    }
                ],
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        ":\\$Recycle.bin\\",
                        ":\\RECYCLER.BIN\\",
                        ":\\RECYCLERS.BIN\\",
                        ":\\SystemVolumeInformation\\",
                        ":\\Temp\\",
                        ":\\Users\\Default\\",
                        ":\\Users\\Desktop\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\addins\\",
                        ":\\Windows\\cursors\\",
                        ":\\Windows\\debug\\",
                        ":\\Windows\\drivers\\",
                        ":\\Windows\\fonts\\",
                        ":\\Windows\\help\\",
                        ":\\Windows\\system32\\tasks\\",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        "\\Downloads\\",
                        "\\Local Settings\\Temporary Internet Files\\",
                        "\\Temporary Internet Files\\Content.Outlook\\",
                        "%Public%\\",
                        "%TEMP%",
                        "%TMP%"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a35f5a72-f347-4e36-8895-9869b0d5fc6d",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/11",
            "references": [
                "https://www.virusradar.com/en/Win32_Kasidet.AD/description",
                "https://www.hybrid-analysis.com/sample/07e789f4f2f3259e7559fdccb36e96814c2dbff872a21e1fa03de9ee377d581f?environmentId=100"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE"
        },
        {
            "author": "Ilya Krestinichev, Florian Roth (Nextron Systems)",
            "date": "2022/09/13",
            "description": "Detects one of the possible scenarios for disabling Symantec Endpoint Protection.\nSymantec Endpoint Protection antivirus software services incorrectly implement the protected service mechanism.\nAs a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command several times ccSvcHst.exe /f, thereby killing the process belonging to the service, and thus shutting down the service.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "taskkill",
                        " /F ",
                        " /IM ",
                        "ccSvcHst.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4a6713f6-3331-11ed-a261-0242ac120002",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.exploit-db.com/exploits/37525",
                "https://community.spiceworks.com/topic/2195015-batch-script-to-uninstall-symantec-endpoint-protection",
                "https://community.broadcom.com/symantecenterprise/communities/community-home/digestviewer/viewthread?MessageKey=6ce94b67-74e1-4333-b16f-000b7fd874f0&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=digestviewer"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Taskkill Symantec Endpoint Protection"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/12/18",
            "description": "Detects the use of CleanWipe a tool usually used to delete Symantec antivirus.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "Image|endswith": "\\SepRemovalToolNative_x64.exe"
                },
                "selection2": {
                    "CommandLine|contains": "--uninstall",
                    "Image|endswith": "\\CATClean.exe"
                },
                "selection3": {
                    "CommandLine|contains": "-r",
                    "Image|endswith": "\\NetInstaller.exe"
                },
                "selection4": {
                    "CommandLine|contains|all": [
                        "/uninstall",
                        "/enterprise"
                    ],
                    "Image|endswith": "\\WFPUnins.exe"
                }
            },
            "falsepositives": [
                "Legitimate administrative use (Should be investigated either way)"
            ],
            "id": "f44800ac-38ec-471f-936e-3fa7d9c53100",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/CleanWipe"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "PUA - CleanWipe Execution"
        },
        {
            "author": "Sreeman",
            "date": "2021/06/11",
            "description": "Detects applications trying to modify the registry in order to disable any write-protect property for storage devices.\nThis could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "\\System\\CurrentControlSet\\Control",
                        "Write Protection",
                        "0",
                        "storage"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/18",
            "references": [
                "https://www.manageengine.com/products/desktop-central/os-imaging-deployment/media-is-write-protected.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Write Protect For Storage Disabled"
        },
        {
            "author": "Sander Wiebing",
            "date": "2020/05/23",
            "description": "Detects usage of the netsh command to open and allow connections to port 3389 (RDP). As seen used by Sarwent Malware",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "portopening",
                        "allow"
                    ],
                    "CommandLine|contains|all": [
                        "firewall ",
                        "add ",
                        "tcp ",
                        "3389"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administration activity"
            ],
            "id": "01aeb693-138d-49d2-9403-c4f52d7d3d62",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/11",
            "references": [
                "https://labs.sentinelone.com/sarwent-malware-updates-command-detonation/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "RDP Connection Allowed Via Netsh.EXE"
        },
        {
            "author": "ok @securonix invrep-de, oscd.community, frack113",
            "date": "2020/10/12",
            "description": "Detects attackers attempting to disable Windows Defender using Powershell",
            "detection": {
                "condition": "all of selection_pwsh_* or (selection_sc_binary and 1 of selection_sc_tamper_*)",
                "selection_pwsh_binary": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll"
                        ]
                    }
                ],
                "selection_pwsh_cli": {
                    "CommandLine|contains": [
                        "-DisableBehaviorMonitoring $true",
                        "-DisableRuntimeMonitoring $true"
                    ]
                },
                "selection_sc_binary": [
                    {
                        "Image|endswith": "\\sc.exe"
                    },
                    {
                        "OriginalFileName": "sc.exe"
                    }
                ],
                "selection_sc_tamper_cmd_delete": {
                    "CommandLine|contains|all": [
                        "delete",
                        "WinDefend"
                    ]
                },
                "selection_sc_tamper_cmd_disabled": {
                    "CommandLine|contains|all": [
                        "config",
                        "WinDefend",
                        "start=disabled"
                    ]
                },
                "selection_sc_tamper_cmd_stop": {
                    "CommandLine|contains|all": [
                        "stop",
                        "WinDefend"
                    ]
                }
            },
            "falsepositives": [
                "Minimal, for some older versions of dev tools, such as pycharm, developers were known to sometimes disable Windows Defender to improve performance, but this generally is not considered a good security practice."
            ],
            "id": "a7ee1722-c3c5-aeff-3212-c777e4733217",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/11/18",
            "references": [
                "https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/",
                "https://rvsec0n.wordpress.com/2020/01/24/malwares-that-bypass-windows-defender/",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable Windows Defender AV Security Monitoring"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/01",
            "description": "Detect the use of \"sc.exe\" to change the startup type of a service to \"disabled\" or \"demand\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "disabled",
                        "demand"
                    ],
                    "CommandLine|contains|all": [
                        " config ",
                        "start"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\sc.exe"
                    },
                    {
                        "OriginalFileName": "sc.exe"
                    }
                ]
            },
            "falsepositives": [
                "False positives may occur with troubleshooting scripts"
            ],
            "id": "85c312b7-f44d-4a51-a024-d671c40b49fc",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/04",
            "references": [
                "https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Service StartupType Change Via Sc.EXE"
        },
        {
            "author": "frack113",
            "date": "2022/01/09",
            "description": "Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union)",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "set",
                        "config",
                        "section:httplogging",
                        "dontLog:true"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\appcmd.exe"
                    },
                    {
                        "OriginalFileName": "appcmd.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/22",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.002/T1562.002.md#atomic-test-1---disable-windows-iis-http-logging"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Disable Windows IIS HTTP Logging"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "Detects changes to environment variables related to ETW logging via the CommandLine.\nThis could indicate potential adversaries stopping ETW providers recording loaded .NET assemblies.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "COMPlus_ETWEnabled",
                        "COMPlus_ETWFlags"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "41421f44-58f9-455d-838a-c398859841d4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/09",
            "references": [
                "https://twitter.com/_xpn_/status/1268712093928378368",
                "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
                "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
                "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
                "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
                "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
                "https://bunnyinside.com/?term=f71e8cb9c76a",
                "http://managed670.rssing.com/chan-5590147/all_p1.html",
                "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
                "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "ETW Logging Tamper In .NET Processes Via CommandLine"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/04",
            "description": "Detects base64 encoded \"MpPreference\" PowerShell cmdlet code that tries to modifies or tamper with Windows Defender AV",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "CommandLine|base64offset|contains": [
                            "Add-MpPreference ",
                            "Set-MpPreference ",
                            "add-mppreference ",
                            "set-mppreference "
                        ]
                    },
                    {
                        "CommandLine|contains": [
                            "QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                            "EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                            "BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA",
                            "UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                            "MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                            "TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA",
                            "YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                            "EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                            "hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA",
                            "cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                            "MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                            "zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c6fb44c6-71f5-49e6-9462-1425d328aee3",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/30",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-antivirus",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://twitter.com/AdamTheAnalyst/status/1483497517119590403"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Powershell Base64 Encoded MpPreference Cmdlet"
        },
        {
            "author": "Janantha Marasinghe (https://github.com/blueteam0ps)",
            "date": "2021/02/02",
            "description": "Threat actors can use auditpol binary to change audit policy configuration to impair detection capability.\nThis can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "disable",
                        "clear",
                        "remove",
                        "restore"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\auditpol.exe"
                    },
                    {
                        "OriginalFileName": "AUDITPOL.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Administrator or administrator scripts might leverage the flags mentioned in the detection section. Either way, it should always be monitored"
            ],
            "id": "0a13e132-651d-11eb-ae93-0242ac130002",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/22",
            "references": [
                "https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/"
            ],
            "related": [
                {
                    "id": "c6c56ada-612b-42d1-9a29-adad3c5c2c1e",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Audit Policy Tampering Via Auditpol"
        },
        {
            "author": "Tim Rauch, Elastic (idea)",
            "date": "2022/09/14",
            "description": "Detects attempts to disable the Windows Firewall using PowerShell",
            "detection": {
                "condition": "all of selection_*",
                "selection_args": {
                    "CommandLine|contains|all": [
                        "Set-NetFirewallProfile ",
                        " -Enabled ",
                        " False"
                    ]
                },
                "selection_name": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\powershell_ise.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll"
                        ]
                    }
                ],
                "selection_opt": {
                    "CommandLine|contains": [
                        " -All ",
                        "Public",
                        "Domain",
                        "Private"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "12f6b752-042d-483e-bf9c-915a6d06ad75",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html"
            ],
            "related": [
                {
                    "id": "488b44e7-3781-4a71-888d-c95abfacf44d",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Windows Firewall Disabled via PowerShell"
        },
        {
            "author": "pH-T (Nextron Systems)",
            "date": "2023/04/17",
            "description": "Detects Stracciatella which executes a Powershell runspace from within C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled based on PE metadata characteristics.",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\Stracciatella.exe"
                    },
                    {
                        "OriginalFileName": "Stracciatella.exe"
                    },
                    {
                        "Description": "Stracciatella"
                    },
                    {
                        "Hashes|contains": [
                            "SHA256=9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956",
                            "SHA256=fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a"
                        ]
                    },
                    {
                        "sha256": [
                            "9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956",
                            "fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "7a4d9232-92fc-404d-8ce1-4c92e7caf539",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/mgeeky/Stracciatella"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1059",
                "attack.t1562.001"
            ],
            "title": "HackTool - Stracciatella Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Tim Shelton",
            "date": "2022/08/08",
            "description": "Detects execution of \"reg.exe\" commands with the \"delete\" flag on safe boot registry keys. Often used by attacker to prevent safeboot execution of security products",
            "detection": {
                "condition": "all of selection_*",
                "selection_delete": {
                    "CommandLine|contains|all": [
                        " delete ",
                        "\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "fc0e89b5-adb0-43c1-b749-c12a10ec37de",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html"
            ],
            "related": [
                {
                    "id": "d7662ff6-9e97-4596-a61d-9839e32dee8d",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "SafeBoot Registry Key Deleted Via Reg.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/01/28",
            "description": "Detects commands that temporarily turn off Volume Snapshots",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "\\Services\\VSS\\Diag",
                        "/d Disabled"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration"
            ],
            "id": "dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/15",
            "references": [
                "https://twitter.com/0gtweet/status/1354766164166115331"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disabled Volume Snapshots"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/03",
            "description": "Detects requests to disable Microsoft Defender features using PowerShell commands",
            "detection": {
                "condition": "all of selection_cli_* or 1 of selection_encoded_*",
                "selection_cli_cmdlet": {
                    "CommandLine|contains": [
                        "Add-MpPreference ",
                        "Set-MpPreference "
                    ]
                },
                "selection_cli_option": {
                    "CommandLine|contains": [
                        "DisableArchiveScanning ",
                        "DisableRealtimeMonitoring ",
                        "DisableIOAVProtection ",
                        "DisableBehaviorMonitoring ",
                        "DisableBlockAtFirstSeen ",
                        "DisableCatchupFullScan ",
                        "DisableCatchupQuickScan "
                    ]
                },
                "selection_cli_value": {
                    "CommandLine|contains": [
                        "$true",
                        " 1 "
                    ]
                },
                "selection_encoded_direct": {
                    "CommandLine|contains": [
                        "RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                        "QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                        "EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA",
                        "RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA",
                        "QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA",
                        "EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA",
                        "RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                        "QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                        "EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA",
                        "RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA",
                        "QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA",
                        "EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA",
                        "ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                        "QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                        "kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA",
                        "ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA",
                        "QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA",
                        "kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA",
                        "ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                        "QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                        "kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA",
                        "ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA",
                        "QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA",
                        "kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA",
                        "RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA",
                        "RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA",
                        "RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA"
                    ]
                },
                "selection_encoded_modifier": {
                    "CommandLine|base64offset|contains": [
                        "disablearchivescanning ",
                        "DisableArchiveScanning ",
                        "disablebehaviormonitoring ",
                        "DisableBehaviorMonitoring ",
                        "disableblockatfirstseen ",
                        "DisableBlockAtFirstSeen ",
                        "disablecatchupfullscan ",
                        "DisableCatchupFullScan ",
                        "disablecatchupquickscan ",
                        "DisableCatchupQuickScan ",
                        "disableioavprotection ",
                        "DisableIOAVProtection ",
                        "disablerealtimemonitoring ",
                        "DisableRealtimeMonitoring "
                    ]
                }
            },
            "falsepositives": [
                "Possible administrative activity",
                "Other Cmdlets that may use the same parameters"
            ],
            "id": "1ec65a5f-9473-4f12-97da-622044d6df21",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/02",
            "references": [
                "https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps",
                "https://www.virustotal.com/gui/file/d609799091731d83d75ec5d1f030571af20c45efeeb94840b67ea09a3283ab65/behavior/C2AE",
                "https://www.virustotal.com/gui/search/content%253A%2522Set-MpPreference%2520-Disable%2522/files"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Powershell Defender Disable Scan Feature"
        },
        {
            "author": "Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/03/22",
            "description": "Detects the usage of \"reg.exe\" to tamper with different Windows Defender registry keys in order to disable some important features related to protection and detection",
            "detection": {
                "condition": "all of selection_root_* and 1 of selection_dword_*",
                "selection_dword_0": {
                    "CommandLine|contains": [
                        "DisallowExploitProtectionOverride",
                        "EnableControlledFolderAccess",
                        "MpEnablePus",
                        "PUAProtection",
                        "SpynetReporting",
                        "SubmitSamplesConsent",
                        "TamperProtection"
                    ],
                    "CommandLine|contains|all": [
                        " add ",
                        "d 0"
                    ]
                },
                "selection_dword_1": {
                    "CommandLine|contains": [
                        "DisableAntiSpyware",
                        "DisableAntiSpywareRealtimeProtection",
                        "DisableAntiVirus",
                        "DisableArchiveScanning",
                        "DisableBehaviorMonitoring",
                        "DisableBlockAtFirstSeen",
                        "DisableConfig",
                        "DisableEnhancedNotifications",
                        "DisableIntrusionPreventionSystem",
                        "DisableIOAVProtection",
                        "DisableOnAccessProtection",
                        "DisablePrivacyMode",
                        "DisableRealtimeMonitoring",
                        "DisableRoutinelyTakingAction",
                        "DisableScanOnRealtimeEnable",
                        "DisableScriptScanning",
                        "Notification_Suppress",
                        "SignatureDisableUpdateOnStartupWithoutEngine"
                    ],
                    "CommandLine|contains|all": [
                        " add ",
                        "d 1"
                    ]
                },
                "selection_root_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ],
                "selection_root_path": {
                    "CommandLine|contains": [
                        "SOFTWARE\\Microsoft\\Windows Defender\\",
                        "SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center",
                        "SOFTWARE\\Policies\\Microsoft\\Windows Defender\\"
                    ]
                }
            },
            "falsepositives": [
                "Rare legitimate use by administrators to test software (should always be investigated)"
            ],
            "id": "452bce90-6fb0-43cc-97a5-affc283139b3",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/06/05",
            "references": [
                "https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/",
                "https://github.com/swagkarna/Defeat-Defender-V1.2.0",
                "https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Suspicious Windows Defender Registry Key Tampering Via Reg.EXE"
        },
        {
            "author": "Ecco, Daniil Yugoslavskiy, oscd.community, D3F7A5105",
            "date": "2019/09/26",
            "description": "Detects the clearing or configuration tampering of EventLog using utilities such as \"wevtutil\", \"powershell\" and \"wmic\".\nThis technique were seen used by threat actors and ransomware strains in order to evade defenses.\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_*",
                "filter_msiexec": {
                    "CommandLine|contains": " sl ",
                    "ParentImage": [
                        "C:\\Windows\\SysWOW64\\msiexec.exe",
                        "C:\\Windows\\System32\\msiexec.exe"
                    ]
                },
                "selection_other_ps": {
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ],
                    "CommandLine|contains": [
                        "Clear-EventLog ",
                        "Remove-EventLog ",
                        "Limit-EventLog ",
                        "Clear-WinEvent "
                    ]
                },
                "selection_other_wmi": {
                    "CommandLine|contains": "ClearEventLog",
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\wmic.exe"
                    ]
                },
                "selection_wevtutil": {
                    "CommandLine|contains": [
                        "clear-log ",
                        " cl ",
                        "set-log ",
                        " sl ",
                        "lfn:"
                    ],
                    "Image|endswith": "\\wevtutil.exe"
                }
            },
            "falsepositives": [
                "Admin activity",
                "Scripts and administrative tools used in the monitored environment",
                "Maintenance activity"
            ],
            "id": "cc36992a-4671-4f21-a91d-6c2b72a2edf5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/07/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.001/T1070.001.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
                "https://gist.github.com/fovtran/ac0624983c7722e80a8f5a4babb170ee",
                "https://jdhnet.wordpress.com/2017/12/19/changing-the-location-of-the-windows-event-logs/"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.001",
                "attack.t1562.002",
                "car.2016-04-002"
            ],
            "title": "Suspicious Eventlog Clearing or Configuration Change Activity"
        },
        {
            "author": "frack113",
            "date": "2022/01/16",
            "description": "Deployment Image Servicing and Management tool. DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images",
            "detection": {
                "condition": "1 of selection_*",
                "selection_dism": {
                    "CommandLine|contains|all": [
                        "/Online",
                        "/Disable-Feature"
                    ],
                    "Image|endswith": "\\Dism.exe"
                },
                "selection_dismhost": {
                    "Image|endswith": "\\DismHost.exe",
                    "ParentCommandLine|contains|all": [
                        "/Online",
                        "/Disable-Feature"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate script"
            ],
            "id": "43e32da2-fdd0-4156-90de-50dfd62636f9",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/08/26",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md#atomic-test-26---disable-windows-defender-with-dism",
                "https://www.trendmicro.com/en_us/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Dism Remove Online Package"
        },
        {
            "author": "Florian Roth (Nextron Systems), John Lambert (idea), elhoim",
            "date": "2021/07/14",
            "description": "Detects execution of \"reg.exe\" to disable security services such as Windows Defender.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli_reg_start": {
                    "CommandLine|contains": [
                        "\\AppIDSvc",
                        "\\MsMpSvc",
                        "\\NisSrv",
                        "\\SecurityHealthService",
                        "\\Sense",
                        "\\UsoSvc",
                        "\\WdBoot",
                        "\\WdFilter",
                        "\\WdNisDrv",
                        "\\WdNisSvc",
                        "\\WinDefend",
                        "\\wscsvc",
                        "\\wuauserv"
                    ],
                    "CommandLine|contains|all": [
                        "d 4",
                        "v Start"
                    ]
                },
                "selection_reg_add": {
                    "CommandLine|contains|all": [
                        "reg",
                        "add"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "5e95028c-5229-4214-afae-d653d573d0ec",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/06/05",
            "references": [
                "https://twitter.com/JohnLaTwC/status/1415295021041979392",
                "https://github.com/gordonbay/Windows-On-Reins/blob/e587ac7a0407847865926d575e3c46f68cf7c68d/wor.ps1",
                "https://vms.drweb.fr/virus/?i=24144899",
                "https://bidouillesecurity.com/disable-windows-defender-in-powershell/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Security Service Disabled Via Reg.EXE"
        },
        {
            "id": "d7662ff6-9e97-4596-a61d-9839e32dee8d",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/02",
            "description": "Detects execution of \"reg.exe\" commands with the \"add\" or \"copy\" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not",
            "detection": {
                "condition": "all of selection*",
                "selection_flag": {
                    "CommandLine|contains": [
                        " copy ",
                        " add "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ],
                "selection_safeboot": {
                    "CommandLine|contains": "\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/19",
            "references": [
                "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "fc0e89b5-adb0-43c1-b749-c12a10ec37de"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Add SafeBoot Keys Via Reg Utility"
        },
        {
            "id": "bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/07",
            "description": "Detects the use of SharpEvtHook, a tool that tampers with the Windows event logs",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\SharpEvtMute.exe"
                    },
                    {
                        "Description": "SharpEvtMute"
                    },
                    {
                        "CommandLine|contains": [
                            "--Filter \"rule ",
                            "--Encoded --Filter \\\""
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://github.com/bats3c/EvtMute"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "49329257-089d-46e6-af37-4afce4290685"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "HackTool - SharpEvtMute Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/11/29",
            "description": "Detects the execution of the tool PowerTool which has the ability to kill a process, delete its process file, unload drivers, and delete the driver files",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": [
                            "\\PowerTool.exe",
                            "\\PowerTool64.exe"
                        ]
                    },
                    {
                        "OriginalFileName": "PowerTool.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "a34f79a3-8e5f-4cc3-b765-de00695452c2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/",
                "https://www.trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html",
                "https://twitter.com/gbti_sa/status/1249653895900602375?lang=en",
                "https://www.softpedia.com/get/Antivirus/Removal-Tools/ithurricane-PowerTool.shtml"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "HackTool - PowerTool Execution"
        },
        {
            "author": "Kirill Kiryanov, oscd.community",
            "date": "2019/10/23",
            "description": "Detects possible Sysmon filter driver unloaded via fltmc.exe",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "unload",
                        "sysmon"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\fltMC.exe"
                    },
                    {
                        "OriginalFileName": "fltMC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "4d7cda18-1b12-4e52-b45c-d28653210df8",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon"
            ],
            "related": [
                {
                    "id": "4931188c-178e-4ee7-a348-39e8a7a56821",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562",
                "attack.t1562.002"
            ],
            "title": "Sysmon Driver Unloaded Via Fltmc.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/04",
            "description": "Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "if(0){{{0}}}' -f $(0 -as [char]) +",
                        "#<NULL>"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "92a974db-ab84-457f-9ec0-55db83d7a825",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/09",
            "references": [
                "https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-bypass-using-null-bits-satoshi"
            ],
            "related": [
                {
                    "id": "fa2559c8-1197-471d-9cdd-05a0273d4522",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Potential AMSI Bypass Using NULL Bits"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/01/21",
            "description": "Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "CommandLine|contains|all": [
                        "taskkill ",
                        "RaccineSettings.exe"
                    ]
                },
                "selection2": {
                    "CommandLine|contains|all": [
                        "reg.exe",
                        "delete",
                        "Raccine Tray"
                    ]
                },
                "selection3": {
                    "CommandLine|contains|all": [
                        "schtasks",
                        "/DELETE",
                        "Raccine Rules Updater"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate deinstallation by administrative staff"
            ],
            "id": "a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/Neo23x0/Raccine"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Raccine Uninstall"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/06/19",
            "description": "Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "CommandLine|contains|all": [
                        " -name IEHarden ",
                        " -value 0 "
                    ]
                },
                "selection2": {
                    "CommandLine|contains|all": [
                        " -name DEPOff ",
                        " -value 1 "
                    ]
                },
                "selection3": {
                    "CommandLine|contains|all": [
                        " -name DisableFirstRunCustomize ",
                        " -value 2 "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "fb50eb7a-5ab1-43ae-bcc9-091818cb8424",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disabled IE Security Features"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/19",
            "description": "Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys",
            "detection": {
                "condition": "all of selection_*",
                "selection_path": {
                    "CommandLine|contains": [
                        "\\AppDataLow\\Software\\Microsoft\\",
                        "\\Policies\\Microsoft\\Windows\\OOBE",
                        "\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
                        "\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon",
                        "\\CurrentControlSet\\Control\\SecurityProviders\\WDigest",
                        "\\Microsoft\\Windows Defender\\"
                    ]
                },
                "selection_reg": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Rare legitimate add to registry via cli (to these locations)"
            ],
            "id": "b7e2a8d4-74bb-4b78-adc9-3f92af2d4829",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/10",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md",
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md",
                "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562.001"
            ],
            "title": "Reg Add Suspicious Paths"
        },
        {
            "author": "Janantha Marasinghe",
            "date": "2022/11/18",
            "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
            "detection": {
                "condition": "selection_img and (1 of selection_flags_*)",
                "selection_flags_configure": {
                    "CommandLine|contains|all": [
                        "/configure",
                        "/db"
                    ]
                },
                "selection_flags_discovery": {
                    "CommandLine|contains|all": [
                        "/export",
                        "/cfg"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\secedit.exe"
                    },
                    {
                        "OriginalFileName": "SeCEdit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative use"
            ],
            "id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.privilege_escalation",
                "attack.t1562.002",
                "attack.t1547.001",
                "attack.t1505.005",
                "attack.t1556.002",
                "attack.t1562",
                "attack.t1574.007",
                "attack.t1564.002",
                "attack.t1546.008",
                "attack.t1546.007",
                "attack.t1547.014",
                "attack.t1547.010",
                "attack.t1547.002",
                "attack.t1557",
                "attack.t1082"
            ],
            "title": "Potential Suspicious Activity Using SeCEdit"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/01",
            "description": "Detects execution of \"reg.exe\" commands with the \"delete\" flag on services registry key. Often used by attacker to remove AV software services",
            "detection": {
                "condition": "all of selection_*",
                "selection_delete": {
                    "CommandLine|contains": " delete "
                },
                "selection_img": [
                    {
                        "Image|endswith": "reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ],
                "selection_key": {
                    "CommandLine|contains": "\\SYSTEM\\CurrentControlSet\\services\\"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "05b2aa93-1210-42c8-8d9a-2fcc13b284f5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Service Registry Key Deleted Via Reg.EXE"
        },
        {
            "id": "4931188c-178e-4ee7-a348-39e8a7a56821",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/13",
            "description": "Detect filter driver unloading activity via fltmc.exe",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_avira": {
                    "CommandLine|endswith": "unload rtp_filesystem_filter",
                    "ParentImage|contains": "\\AppData\\Local\\Temp\\",
                    "ParentImage|endswith": "\\endpoint-protection-installer-x64.tmp",
                    "ParentImage|startswith": "C:\\Users\\"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\fltMC.exe"
                    },
                    {
                        "OriginalFileName": "fltMC.exe"
                    }
                ],
                "filter_optional_manageengine": {
                    "CommandLine|endswith": "unload DFMFilter",
                    "ParentImage": "C:\\Program Files (x86)\\ManageEngine\\uems_agent\\bin\\dcfaservice64.exe"
                },
                "selection_cli": {
                    "CommandLine|contains": "unload"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/24",
            "references": [
                "https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon",
                "https://www.cybereason.com/blog/threat-analysis-report-lockbit-2.0-all-paths-lead-to-ransom"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "4d7cda18-1b12-4e52-b45c-d28653210df8"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562",
                "attack.t1562.002"
            ],
            "title": "Filter Driver Unloaded Via Fltmc.EXE"
        },
        {
            "author": "@gott_cyber",
            "date": "2024/01/02",
            "description": "Detects the execution of EDRSilencer, a tool that leverages Windows Filtering Platform (WFP) to block Endpoint Detection and Response (EDR) agents from reporting security events to the server based on PE metadata information.\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\EDRSilencer.exe"
                    },
                    {
                        "OriginalFileName": "EDRSilencer.exe"
                    },
                    {
                        "Description|contains": "EDRSilencer"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "eb2d07d4-49cb-4523-801a-da002df36602",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/netero1010/EDRSilencer"
            ],
            "status": "experimental",
            "title": "HackTool - EDRSilencer Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/02/11",
            "description": "Detects the execution of \"logman\" utility in order to disable or delete Windows trace sessions",
            "detection": {
                "condition": "all of selection*",
                "selection_action": {
                    "CommandLine|contains": [
                        "stop ",
                        "delete "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\logman.exe"
                    },
                    {
                        "OriginalFileName": "Logman.exe"
                    }
                ],
                "selection_service": {
                    "CommandLine|contains": [
                        "Circular Kernel Context Logger",
                        "EventLog-",
                        "SYSMON TRACE",
                        "SysmonDnsEtwSession"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate deactivation by administrative staff",
                "Installer tools that disable services, e.g. before log collection agent installation"
            ],
            "id": "cd1f961e-0b96-436b-b7c6-38da4583ec00",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://twitter.com/0gtweet/status/1359039665232306183?s=21",
                "https://ss64.com/nt/logman.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1070.001"
            ],
            "title": "Suspicious Windows Trace ETW Session Tamper Via Logman.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/04/29",
            "description": "Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets",
            "detection": {
                "condition": "all of selection*",
                "selection1": {
                    "CommandLine|contains": [
                        "Add-MpPreference ",
                        "Set-MpPreference "
                    ]
                },
                "selection2": {
                    "CommandLine|contains": [
                        " -ExclusionPath ",
                        " -ExclusionExtension ",
                        " -ExclusionProcess ",
                        " -ExclusionIpAddress "
                    ]
                }
            },
            "falsepositives": [
                "Possible Admin Activity",
                "Other Cmdlets that may use the same parameters"
            ],
            "id": "17769c90-230e-488b-a463-e05c08e9d48f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/05/12",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-antivirus",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://twitter.com/AdamTheAnalyst/status/1483497517119590403"
            ],
            "related": [
                {
                    "id": "c1344fa2-323b-4d2e-9176-84b4d4821c88",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Powershell Defender Exclusion"
        },
        {
            "author": "frack113",
            "date": "2022/01/09",
            "description": "Adversaries may modify system firewalls in order to bypass controls limiting network usage",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "advfirewall",
                        "firewall",
                        "set",
                        "rule",
                        "group=",
                        "new",
                        "enable=Yes"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administration activity"
            ],
            "id": "347906f3-e207-4d18-ae5b-a9403d6bcdef",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-3---allow-smb-and-rdp-on-microsoft-defender-firewall",
                "https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Netsh Allow Group Policy on Microsoft Defender Firewall"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/22",
            "description": "Detects the usage of the \"reg.exe\" utility to disable PPL protection on the LSA process",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "SYSTEM\\CurrentControlSet\\Control\\Lsa",
                    "CommandLine|contains|all": [
                        " add ",
                        " /d 0",
                        " /v RunAsPPL "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "8c0eca51-0f88-4db2-9183-fdfb10c703f9",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/26",
            "references": [
                "https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.010"
            ],
            "title": "LSA PPL Protection Disabled Via Reg.EXE"
        },
        {
            "id": "c6c56ada-612b-42d1-9a29-adad3c5c2c1e",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/12/18",
            "description": "Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability.\nThis can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "/logon:none",
                        "/system:none",
                        "/sam:none",
                        "/privilege:none",
                        "/object:none",
                        "/process:none",
                        "/policy:none"
                    ]
                }
            },
            "falsepositives": [
                "The old auditpol utility isn't available by default on recent versions of Windows as it was replaced by a newer version. The FP rate should be very low except for tools that use a similar flag structure"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows%202000%20Resource%20Kit%20Tools/AuditPol"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "0a13e132-651d-11eb-ae93-0242ac130002"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Audit Policy Tampering Via NT Resource Kit Auditpol"
        },
        {
            "author": "frack113",
            "date": "2021/07/07",
            "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by removing Windows Defender Definition Files",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " -RemoveDefinitions",
                        " -All"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\MpCmdRun.exe"
                    },
                    {
                        "OriginalFileName": "MpCmdRun.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "9719a8aa-401c-41af-8108-ced7ec9cd75c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/07/18",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Definition Files Removed"
        },
        {
            "author": "Markus Neis, Sander Wiebing",
            "date": "2019/01/29",
            "description": "Detects the addition of a new rule to the Windows firewall via netsh",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_dropbox": {
                    "CommandLine|contains": [
                        "advfirewall firewall add rule name=Dropbox dir=in action=allow \"program=?:\\Program Files (x86)\\Dropbox\\Client\\Dropbox.exe\" enable=yes profile=Any",
                        "advfirewall firewall add rule name=Dropbox dir=in action=allow \"program=?:\\Program Files\\Dropbox\\Client\\Dropbox.exe\" enable=yes profile=Any"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " firewall ",
                        " add "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activity",
                "Software installations"
            ],
            "id": "cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/10",
            "references": [
                "https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-RAT-and-Staging-Report.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004",
                "attack.s0246"
            ],
            "title": "New Firewall Rule Added Via Netsh.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/04",
            "description": "Detects the use of the PowerShell \"Set-Service\" cmdlet to change the startup type of a service to \"disabled\" or \"manual\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "Disabled",
                        "Manual"
                    ],
                    "CommandLine|contains|all": [
                        "Set-Service",
                        "-StartupType"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\powershell.exe"
                    },
                    {
                        "OriginalFileName": "PowerShell.EXE"
                    }
                ]
            },
            "falsepositives": [
                "False positives may occur with troubleshooting scripts"
            ],
            "id": "62b20d44-1546-4e61-afce-8e175eb9473c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955"
            ],
            "status": "test",
            "title": "Service StartupType Change Via PowerShell Set-Service",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1562.001"
            ]
        },
        {
            "author": "Markus Neis, @Kostastsale",
            "date": "2018/08/17",
            "description": "Detects Request to \"amsiInitFailed\" that can be used to disable AMSI Scanning",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "CommandLine|contains": [
                        "System.Management.Automation.AmsiUtils",
                        "amsiInitFailed"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains|all": [
                        "[Ref].Assembly.GetType",
                        "SetValue($null,$true)",
                        "NonPublic,Static"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "30edb182-aa75-42c0-b0a9-e998bb29067c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://s3cur3th1ssh1t.github.io/Bypass_AMSI_by_manual_modification/",
                "https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/"
            ],
            "related": [
                {
                    "id": "4f927692-68b5-4267-871b-073c45f4f6fe",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Potential AMSI Bypass Via .NET Reflection"
        },
        {
            "author": "frack113",
            "date": "2022/02/13",
            "description": "Detects the usage of \"reg.exe\" to add Defender folder exclusions. Qbot has been seen using this technique to add exclusions for folders within AppData and ProgramData.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\reg.exe",
                    "CommandLine|contains": [
                        "SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths",
                        "SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths"
                    ],
                    "CommandLine|contains|all": [
                        "ADD ",
                        "/t ",
                        "REG_DWORD ",
                        "/v ",
                        "/d ",
                        "0"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "48917adc-a28e-4f5d-b729-11e75da8941f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/",
                "https://redcanary.com/threat-detection-report/threats/qbot/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/05",
            "description": "Detects attempts to remove Windows Defender configurations using the 'MpPreference' cmdlet",
            "detection": {
                "condition": "all of selection_*",
                "selection_remove": {
                    "CommandLine|contains": "Remove-MpPreference"
                },
                "selection_tamper": {
                    "CommandLine|contains": [
                        "-ControlledFolderAccessProtectedFolders ",
                        "-AttackSurfaceReductionRules_Ids ",
                        "-AttackSurfaceReductionRules_Actions ",
                        "-CheckForSignaturesBeforeRunningScan "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "07e3cb2c-0608-410d-be4b-1511cb1a0448",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088"
            ],
            "related": [
                {
                    "id": "ae2bdd58-0681-48ac-be7f-58ab4e593458",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Tamper Windows Defender Remove-MpPreference"
        },
        {
            "author": "Fatih Sirin",
            "date": "2019/11/01",
            "description": "Detects netsh commands that turns off the Windows firewall",
            "detection": {
                "condition": "selection_img and 1 of selection_cli_*",
                "selection_cli_1": {
                    "CommandLine|contains|all": [
                        "firewall",
                        "set",
                        "opmode",
                        "disable"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ],
                "selection_cli_2": {
                    "CommandLine|contains|all": [
                        "advfirewall",
                        "set",
                        "state",
                        "off"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activity"
            ],
            "id": "57c4bf16-227f-4394-8ec7-1b745ee061c3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "https://www.winhelponline.com/blog/enable-and-disable-windows-firewall-quickly-using-command-line/",
                "https://app.any.run/tasks/210244b9-0b6b-4a2c-83a3-04bd3175d017/",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-1---disable-microsoft-defender-firewall"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004",
                "attack.s0108"
            ],
            "title": "Firewall Disabled via Netsh.EXE"
        },
        {
            "author": "frack113",
            "date": "2021/07/12",
            "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "\\WindowsSensor.exe",
                        " /uninstall",
                        " /quiet"
                    ]
                }
            },
            "falsepositives": [
                "Administrator might leverage the same command line for debugging or other purposes. However this action must be always investigated"
            ],
            "id": "f0f7be61-9cf5-43be-9836-99d6ef448a18",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/09",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Uninstall Crowdstrike Falcon Sensor"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/01/30",
            "description": "Detects uninstallation or termination of security products using the WMIC utility",
            "detection": {
                "condition": "1 of selection_cli_* and selection_product",
                "selection_cli_1": {
                    "CommandLine|contains|all": [
                        "wmic",
                        "product where ",
                        "call",
                        "uninstall",
                        "/nointeractive"
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains": [
                        "call delete",
                        "call terminate"
                    ],
                    "CommandLine|contains|all": [
                        "wmic",
                        "caption like "
                    ]
                },
                "selection_cli_3": {
                    "CommandLine|contains|all": [
                        "process ",
                        "where ",
                        "delete"
                    ]
                },
                "selection_product": {
                    "CommandLine|contains": [
                        "%carbon%",
                        "%cylance%",
                        "%endpoint%",
                        "%eset%",
                        "%malware%",
                        "%Sophos%",
                        "%symantec%",
                        "Antivirus",
                        "AVG ",
                        "Carbon Black",
                        "CarbonBlack",
                        "Cb Defense Sensor 64-bit",
                        "Crowdstrike Sensor",
                        "Cylance ",
                        "Dell Threat Defense",
                        "DLP Endpoint",
                        "Endpoint Detection",
                        "Endpoint Protection",
                        "Endpoint Security",
                        "Endpoint Sensor",
                        "ESET File Security",
                        "LogRhythm System Monitor Service",
                        "Malwarebytes",
                        "McAfee Agent",
                        "Microsoft Security Client",
                        "Sophos Anti-Virus",
                        "Sophos AutoUpdate",
                        "Sophos Credential Store",
                        "Sophos Management Console",
                        "Sophos Management Database",
                        "Sophos Management Server",
                        "Sophos Remote Management System",
                        "Sophos Update Manager",
                        "Threat Protection",
                        "VirusScan",
                        "Webroot SecureAnywhere",
                        "Windows Defender"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration"
            ],
            "id": "847d5ff3-8a31-4737-a970-aeae8fe21765",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://twitter.com/cglyer/status/1355171195654709249",
                "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
                "https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions",
                "https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/",
                "https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html"
            ],
            "related": [
                {
                    "id": "b53317a0-8acf-4fd1-8de8-a5401e776b96",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Potential Tampering With Security Products Via WMIC"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/09",
            "description": "Detects updates to Sysmon's configuration. Attackers might update or replace the Sysmon configuration with a bare bone one to avoid monitoring without shutting down the service completely",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|windash": "-c"
                },
                "selection_pe": [
                    {
                        "Image|endswith": [
                            "\\Sysmon64.exe",
                            "\\Sysmon.exe"
                        ]
                    },
                    {
                        "Description": "System activity monitor"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrators might use this command to update Sysmon configuration."
            ],
            "id": "87911521-7098-470b-a459-9a57fc80bdfd",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Sysmon Configuration Update"
        },
        {
            "author": "frack113",
            "date": "2022/01/12",
            "description": "Detects the removal of Sysmon, which could be a potential attempt at defense evasion",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|windash": "-u"
                },
                "selection_pe": [
                    {
                        "Image|endswith": [
                            "\\Sysmon64.exe",
                            "\\Sysmon.exe"
                        ]
                    },
                    {
                        "Description": "System activity monitor"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrators might use this command to remove Sysmon for debugging purposes"
            ],
            "id": "6a5f68d1-c4b5-46b9-94ee-5324892ea939",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md#atomic-test-11---uninstall-sysmon"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Uninstall Sysinternals Sysmon"
        },
        {
            "author": "frack113",
            "date": "2022/08/14",
            "description": "Detects the removal of a port or application rule in the Windows Firewall configuration using netsh",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_dropbox": {
                    "CommandLine|contains": "name=Dropbox",
                    "ParentImage|endswith": "\\Dropbox.exe"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "firewall",
                        "delete "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activity",
                "Software installations and removal"
            ],
            "id": "1a5fefe6-734f-452e-a07d-fc1c35bce4b2",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/10",
            "references": [
                "https://app.any.run/tasks/8bbd5b4c-b82d-4e6d-a3ea-d454594a37cc/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Firewall Rule Deleted Via Netsh.EXE"
        },
        {
            "author": "@neu5ron, Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
            "date": "2019/03/22",
            "description": "Detects command line activity that tries to clear or disable any ETW trace log which could be a sign of logging evasion.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_clear_1": {
                    "CommandLine|contains|all": [
                        "cl",
                        "/Trace"
                    ]
                },
                "selection_clear_2": {
                    "CommandLine|contains|all": [
                        "clear-log",
                        "/Trace"
                    ]
                },
                "selection_disable_1": {
                    "CommandLine|contains|all": [
                        "sl",
                        "/e:false"
                    ]
                },
                "selection_disable_2": {
                    "CommandLine|contains|all": [
                        "set-log",
                        "/e:false"
                    ]
                },
                "selection_disable_3": {
                    "CommandLine|contains|all": [
                        "logman",
                        "update",
                        "trace",
                        "--p",
                        "-ets"
                    ]
                },
                "selection_pwsh_remove": {
                    "CommandLine|contains": "Remove-EtwTraceProvider"
                },
                "selection_pwsh_set": {
                    "CommandLine|contains|all": [
                        "Set-EtwTraceProvider",
                        "0x11"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a238b5d0-ce2d-4414-a676-7a531b3d13d6",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/06/28",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
                "https://abuse.io/lockergoga.txt",
                "https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562.006",
                "car.2016-04-002"
            ],
            "title": "ETW Trace Evasion Activity"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Christopher Peacock '@securepeacock' (Update)",
            "date": "2023/03/28",
            "description": "Detects issues with Windows Defender Real-Time Protection features",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_network_inspection": {
                    "Feature_Name": "%%886",
                    "Reason": [
                        "%%892",
                        "%%858"
                    ]
                },
                "selection": {
                    "EventID": [
                        3002,
                        3007
                    ]
                }
            },
            "falsepositives": [
                "Some crashes can occur sometimes and the event doesn't provide enough information to tune out these cases. Manual exception is required"
            ],
            "id": "dd80db93-6ec2-4f4c-a017-ad40da6ffe81",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2023/05/05",
            "references": [
                "Internal Research",
                "https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/",
                "https://gist.github.com/nasbench/33732d6705cbdc712fae356f07666346"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Real-Time Protection Failure/Restart"
        },
        {
            "author": "Bhabesh Raj, Nasreddine Bencherchali",
            "date": "2021/07/05",
            "description": "Detects blocked attempts to change any of Defender's settings such as \"Real Time Monitoring\" and \"Behavior Monitoring\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5013,
                    "Value|endswith": [
                        "\\Windows Defender\\DisableAntiSpyware",
                        "\\Windows Defender\\DisableAntiVirus",
                        "\\Windows Defender\\Scan\\DisableArchiveScanning",
                        "\\Windows Defender\\Scan\\DisableScanningNetworkFiles",
                        "\\Real-Time Protection\\DisableRealtimeMonitoring",
                        "\\Real-Time Protection\\DisableBehaviorMonitoring",
                        "\\Real-Time Protection\\DisableIOAVProtection",
                        "\\Real-Time Protection\\DisableScriptScanning"
                    ]
                }
            },
            "falsepositives": [
                "Administrator might try to disable defender features during testing (must be investigated)"
            ],
            "id": "49e5bc24-8b86-49f1-b743-535f332c2856",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2022/12/06",
            "references": [
                "https://bhabeshraj.com/post/tampering-with-microsoft-defenders-tamper-protection",
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Microsoft Defender Tamper Protection Trigger"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/06",
            "description": "Detects disabling of the \"Automatic Sample Submission\" feature of Windows Defender.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5007,
                    "NewValue|contains": "\\Real-Time Protection\\SubmitSamplesConsent = 0x0"
                }
            },
            "falsepositives": [
                "Administrator activity (must be investigated)"
            ],
            "id": "91903aba-1088-42ee-b680-d6d94fe002b0",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide",
                "https://bidouillesecurity.com/disable-windows-defender-in-powershell/#DisableAntiSpyware"
            ],
            "related": [
                {
                    "id": "1321dc4e-a1fe-481d-a016-52c45f0c8b4f",
                    "type": "similar"
                },
                {
                    "id": "a3ab73f1-bd46-4319-8f06-4b20d0617886",
                    "type": "similar"
                },
                {
                    "id": "801bd44f-ceed-4eb6-887c-11544633c0aa",
                    "type": "similar"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Submit Sample Feature Disabled"
        },
        {
            "id": "801bd44f-ceed-4eb6-887c-11544633c0aa",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/06",
            "description": "Detects suspicious changes to the Windows Defender configuration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5007,
                    "NewValue|contains": [
                        "\\Windows Defender\\DisableAntiSpyware ",
                        "\\Windows Defender\\Scan\\DisableRemovableDriveScanning ",
                        "\\Windows Defender\\Scan\\DisableScanningMappedNetworkDrivesForFullScan ",
                        "\\Windows Defender\\SpyNet\\DisableBlockAtFirstSeen ",
                        "\\Real-Time Protection\\SpyNetReporting "
                    ]
                }
            },
            "falsepositives": [
                "Administrator activity (must be investigated)"
            ],
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide",
                "https://bidouillesecurity.com/disable-windows-defender-in-powershell/#DisableAntiSpyware"
            ],
            "modified": "2023/11/24",
            "related": [
                {
                    "id": "1321dc4e-a1fe-481d-a016-52c45f0c8b4f",
                    "type": "similar"
                },
                {
                    "id": "a3ab73f1-bd46-4319-8f06-4b20d0617886",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "91903aba-1088-42ee-b680-d6d94fe002b0"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Configuration Changes"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd, frack113",
            "date": "2020/07/28",
            "description": "Detects the expiration of the grace period of Windows Defender. This means protection against viruses, spyware, and other potentially unwanted software is disabled.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5101
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "360a1340-398a-46b6-8d06-99b905dc69d2",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2023/11/22",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5101",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/"
            ],
            "related": [
                {
                    "id": "fe34868f-6e0e-4882-81f6-c43aa8f15b62",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Grace Period Expired"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/06",
            "description": "Detects the restoration of files from the defender quarantine",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1009
                }
            },
            "falsepositives": [
                "Legitimate administrator activity restoring a file"
            ],
            "id": "bc92ca75-cd42-4d61-9a37-9d5aa259c88b",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Win Defender Restored Quarantine File"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd, frack113",
            "date": "2020/07/28",
            "description": "Detects disabling of the Windows Defender feature of scanning for malware and other potentially unwanted software",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5010
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bc275be9-0bec-4d77-8c8f-281a2df6710f",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2023/11/22",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5010",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/"
            ],
            "related": [
                {
                    "id": "fe34868f-6e0e-4882-81f6-c43aa8f15b62",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Malware And PUA Scanning Disabled"
        },
        {
            "id": "a3ab73f1-bd46-4319-8f06-4b20d0617886",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/05",
            "description": "Detects when someone is adding or removing applications or folders from exploit guard \"ProtectedFolders\" or \"AllowedApplications\"\n",
            "detection": {
                "allowed_apps_key": {
                    "EventID": 5007,
                    "NewValue|contains": "\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\AllowedApplications\\"
                },
                "allowed_apps_path": {
                    "NewValue|contains": [
                        "\\Users\\Public\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\Desktop\\",
                        "\\PerfLogs\\",
                        "\\Windows\\Temp\\"
                    ]
                },
                "condition": "all of allowed_apps* or protected_folders",
                "protected_folders": {
                    "EventID": 5007,
                    "OldValue|contains": "\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\ProtectedFolders\\"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "references": [
                "https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088"
            ],
            "modified": "2022/12/06",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Exploit Guard Tamper"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd, frack113",
            "date": "2020/07/28",
            "description": "Detects disabling of the Windows Defender virus scanning feature",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5012
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "686c0b4b-9dd3-4847-9077-d6c1bbe36fcb",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2023/11/22",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5012",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/"
            ],
            "related": [
                {
                    "id": "fe34868f-6e0e-4882-81f6-c43aa8f15b62",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Virus Scanning Feature Disabled"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd, frack113",
            "date": "2020/07/28",
            "description": "Detects disabling of Windows Defender Real-time Protection. As this event doesn't contain a lot of information on who initaited this action you might want to reduce it to a \"medium\" level if this occurs too many times in your environment\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5001
                }
            },
            "falsepositives": [
                "Administrator actions (should be investigated)",
                "Seen being triggered occasionally during Windows 8 Defender Updates"
            ],
            "id": "b28e58e4-2a72-4fae-bdee-0fbe904db642",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2023/11/22",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus?view=o365-worldwide#event-id-5001",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://craigclouditpro.wordpress.com/2020/03/04/hunting-malicious-windows-defender-activity/"
            ],
            "related": [
                {
                    "id": "fe34868f-6e0e-4882-81f6-c43aa8f15b62",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Real-time Protection Disabled"
        },
        {
            "id": "1321dc4e-a1fe-481d-a016-52c45f0c8b4f",
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/07/06",
            "description": "Detects the Setting of Windows Defender Exclusions",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5007,
                    "NewValue|contains": "\\Microsoft\\Windows Defender\\Exclusions"
                }
            },
            "falsepositives": [
                "Administrator actions"
            ],
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2022/12/06",
            "references": [
                "https://twitter.com/_nullbind/status/1204923340810543109"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Exclusions Added"
        },
        {
            "author": "Tim Shelton",
            "date": "2022/04/26",
            "description": "Detects application popup reporting a failure of the Sysmon service",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Caption": [
                        "sysmon64.exe - Application Error",
                        "sysmon.exe - Application Error"
                    ],
                    "EventID": 26,
                    "Provider_Name": "Application Popup"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4d7f1827-1637-4def-8d8a-fd254f9454df",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2024/01/17",
            "references": [
                "https://github.com/nasbench/EVTX-ETW-Resources/blob/f1b010ce0ee1b71e3024180de1a3e67f99701fe4/ETWProvidersManifests/Windows10/1803/W10_1803_Pro_19700101_17134.1/WEPExplorer/Application%20Popup.xml#L36"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Sysmon Application Crashed"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd, frack113",
            "date": "2020/07/28",
            "description": "Detects when the \"Windows Defender Threat Protection\" service is disabled.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7036,
                    "Provider_Name": "Service Control Manager",
                    "param1": [
                        "Windows Defender Antivirus Service",
                        "Service antivirus Microsoft Defender"
                    ],
                    "param2": [
                        "stopped",
                        "arr\u00eat\u00e9"
                    ]
                }
            },
            "falsepositives": [
                "Administrator actions",
                "Auto updates of Windows Defender causes restarts"
            ],
            "id": "6c0a7755-6d31-44fa-80e1-133e57752680",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2024/07/02",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
            ],
            "related": [
                {
                    "id": "fe34868f-6e0e-4882-81f6-c43aa8f15b62",
                    "type": "derived"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Threat Detection Service Disabled"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/05/09",
            "description": "This rule detects a suspicious crash of the Microsoft Malware Protection Engine",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Data|contains|all": [
                        "MsMpEng.exe",
                        "mpengine.dll"
                    ],
                    "EventID": 1001,
                    "Provider_Name": "Windows Error Reporting"
                }
            },
            "falsepositives": [
                "MsMpEng might crash if the \"C:\\\" partition is full"
            ],
            "id": "6c82cf5c-090d-4d57-9188-533577631108",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "modified": "2023/04/14",
            "references": [
                "https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5",
                "https://technet.microsoft.com/en-us/library/security/4022344"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1211",
                "attack.t1562.001"
            ],
            "title": "Microsoft Malware Protection Engine Crash - WER"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/05/09",
            "description": "This rule detects a suspicious crash of the Microsoft Malware Protection Engine",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Data|contains|all": [
                        "MsMpEng.exe",
                        "mpengine.dll"
                    ],
                    "EventID": 1000,
                    "Provider_Name": "Application Error"
                }
            },
            "falsepositives": [
                "MsMpEng might crash if the \"C:\\\" partition is full"
            ],
            "id": "545a5da6-f103-4919-a519-e9aec1026ee4",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "modified": "2023/04/14",
            "references": [
                "https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5",
                "https://technet.microsoft.com/en-us/library/security/4022344"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "6c82cf5c-090d-4d57-9188-533577631108"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1211",
                "attack.t1562.001"
            ],
            "title": "Microsoft Malware Protection Engine Crash"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/06/20",
            "description": "Detects scenarios where system auditing for important events such as \"Process Creation\" or \"Logon\" events is disabled.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_state_success_and_failure": {
                    "AuditPolicyChanges|contains": [
                        "%%8448",
                        "%%8450"
                    ],
                    "EventID": 4719,
                    "SubcategoryGuid": [
                        "{0CCE9210-69AE-11D9-BED3-505054503030}",
                        "{0CCE9211-69AE-11D9-BED3-505054503030}",
                        "{0CCE9212-69AE-11D9-BED3-505054503030}",
                        "{0CCE9215-69AE-11D9-BED3-505054503030}",
                        "{0CCE921B-69AE-11D9-BED3-505054503030}",
                        "{0CCE922B-69AE-11D9-BED3-505054503030}",
                        "{0CCE922F-69AE-11D9-BED3-505054503030}",
                        "{0CCE9230-69AE-11D9-BED3-505054503030}",
                        "{0CCE9235-69AE-11D9-BED3-505054503030}",
                        "{0CCE9236-69AE-11D9-BED3-505054503030}",
                        "{0CCE9237-69AE-11D9-BED3-505054503030}",
                        "{0CCE923F-69AE-11D9-BED3-505054503030}",
                        "{0CCE9240-69AE-11D9-BED3-505054503030}",
                        "{0CCE9242-69AE-11D9-BED3-505054503030}"
                    ]
                },
                "selection_state_success_only": {
                    "AuditPolicyChanges|contains": "%%8448",
                    "EventID": 4719,
                    "SubcategoryGuid": "{0CCE9217-69AE-11D9-BED3-505054503030}"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "ab4561b1-6c7e-48a7-ad08-087cfb9ce8f1",
            "level": "high",
            "logsource": {
                "definition": "dfd8c0f4-e6ad-4e07-b91b-f2fca0ddef64",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/11/17",
            "references": [
                "https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit",
                "https://github.com/SigmaHQ/sigma/blob/master/documentation/logsource-guides/windows/service/security.md"
            ],
            "related": [
                {
                    "id": "69aeb277-f15f-4d2d-b32a-55e883609563",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Important Windows Event Auditing Disabled"
        },
        {
            "author": "Thodoris Polyzos (@SmoothDeploy)",
            "date": "2024/01/29",
            "description": "Detects execution of EDRSilencer, a tool that abuses the Windows Filtering Platform (WFP) to block the outbound traffic of running EDR agents based on specific hardcoded filter names.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        5441,
                        5447
                    ],
                    "FilterName|contains": "Custom Outbound Filter"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "98054878-5eab-434c-85d4-72d4e5a3361b",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Filtering Platform Policy Change needs to be enabled",
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://github.com/netero1010/EDRSilencer"
            ],
            "modified": "2024/01/30",
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "HackTool - EDRSilencer Execution - Filter Added"
        },
        {
            "id": "69aeb277-f15f-4d2d-b32a-55e883609563",
            "author": "@neu5ron, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2017/11/19",
            "description": "Detects scenarios where system auditing (i.e.: Windows event log auditing) is disabled.\nThis may be used in a scenario where an entity would want to bypass local logging to evade detection when Windows event logging is enabled and reviewed.\nAlso, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\".\nPlease note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications - however, it is recommended to perform these modifications in Active Directory anyways.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_guid": {
                    "SubcategoryGuid": [
                        "{0CCE9210-69AE-11D9-BED3-505054503030}",
                        "{0CCE9211-69AE-11D9-BED3-505054503030}",
                        "{0CCE9212-69AE-11D9-BED3-505054503030}",
                        "{0CCE9215-69AE-11D9-BED3-505054503030}",
                        "{0CCE9217-69AE-11D9-BED3-505054503030}",
                        "{0CCE921B-69AE-11D9-BED3-505054503030}",
                        "{0CCE922B-69AE-11D9-BED3-505054503030}",
                        "{0CCE922F-69AE-11D9-BED3-505054503030}",
                        "{0CCE9230-69AE-11D9-BED3-505054503030}",
                        "{0CCE9235-69AE-11D9-BED3-505054503030}",
                        "{0CCE9236-69AE-11D9-BED3-505054503030}",
                        "{0CCE9237-69AE-11D9-BED3-505054503030}",
                        "{0CCE923F-69AE-11D9-BED3-505054503030}",
                        "{0CCE9240-69AE-11D9-BED3-505054503030}",
                        "{0CCE9242-69AE-11D9-BED3-505054503030}"
                    ]
                },
                "selection": {
                    "AuditPolicyChanges|contains": [
                        "%%8448",
                        "%%8450"
                    ],
                    "EventID": 4719
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "low",
            "logsource": {
                "definition": "dfd8c0f4-e6ad-4e07-b91b-f2fca0ddef64",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/11/15",
            "references": [
                "https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "ab4561b1-6c7e-48a7-ad08-087cfb9ce8f1"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Windows Event Auditing Disabled"
        },
        {
            "author": "@BarryShooshooga",
            "date": "2019/10/26",
            "description": "Detects when a Windows Defender exclusion has been deleted. This could indicate an attacker trying to delete their tracks by removing the added exclusions\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4660,
                    "ObjectName|contains": "\\Microsoft\\Windows Defender\\Exclusions\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a33f8808-2812-4373-ae95-8cfb82134978",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: Audit Policy : Security Settings/Local Policies/Audit Policy, Registry System Access Control (SACL): Auditing/User",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/11/11",
            "references": [
                "https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/"
            ],
            "related": [
                {
                    "id": "e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d",
                    "type": "derived"
                },
                {
                    "id": "46a68649-f218-4f86-aea1-16a759d81820",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Exclusion Deleted"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/06/05",
            "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_complus": {
                    "EventID": 4657,
                    "NewValue": 0,
                    "ObjectName|contains": "\\Environment",
                    "ObjectValueName": [
                        "COMPlus_ETWEnabled",
                        "COMPlus_ETWFlags"
                    ]
                },
                "selection_etw_enabled": {
                    "EventID": 4657,
                    "NewValue": 0,
                    "ObjectName|endswith": "\\SOFTWARE\\Microsoft\\.NETFramework",
                    "ObjectValueName": "ETWEnabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/12/20",
            "references": [
                "https://twitter.com/_xpn_/status/1268712093928378368",
                "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
                "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
                "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
                "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
                "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
                "https://bunnyinside.com/?term=f71e8cb9c76a",
                "http://managed670.rssing.com/chan-5590147/all_p1.html",
                "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
                "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
            ],
            "related": [
                {
                    "id": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ],
            "title": "ETW Logging Disabled In .NET Processes - Registry"
        },
        {
            "id": "46a68649-f218-4f86-aea1-16a759d81820",
            "author": "@BarryShooshooga",
            "date": "2019/10/26",
            "description": "Detects modifications to the Windows Defender exclusion registry key. This could indicate a potentially suspicious or even malicious activity by an attacker trying to add a new exclusion in order to bypass security.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4657,
                    "ObjectName|contains": "\\Microsoft\\Windows Defender\\Exclusions\\"
                }
            },
            "falsepositives": [
                "Intended exclusions by administrators"
            ],
            "level": "medium",
            "logsource": {
                "definition": "Requirements: Audit Policy : Security Settings/Local Policies/Audit Policy, Registry System Access Control (SACL): Auditing/User",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/11/11",
            "references": [
                "https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/"
            ],
            "related": [
                {
                    "id": "e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d",
                    "type": "derived"
                },
                {
                    "type": "derived",
                    "id": "a33f8808-2812-4373-ae95-8cfb82134978"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Exclusion List Modified"
        },
        {
            "author": "@neu5ron",
            "date": "2017/07/30",
            "description": "Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.",
            "detection": {
                "condition": "selection and ((newuac_des and not olduac_des) or (newuac_preauth and not olduac_preauth) or (newuac_encrypted and not olduac_encrypted))",
                "newuac_des": {
                    "NewUacValue|endswith": [
                        "8???",
                        "9???",
                        "A???",
                        "B???",
                        "C???",
                        "D???",
                        "E???",
                        "F???"
                    ]
                },
                "newuac_encrypted": {
                    "NewUacValue|endswith": [
                        "8??",
                        "9??",
                        "A??",
                        "B??",
                        "C??",
                        "D??",
                        "E??",
                        "F??"
                    ]
                },
                "newuac_preauth": {
                    "NewUacValue|endswith": [
                        "1????",
                        "3????",
                        "5????",
                        "7????",
                        "9????",
                        "B????",
                        "D????",
                        "F????"
                    ]
                },
                "olduac_des": {
                    "OldUacValue|endswith": [
                        "8???",
                        "9???",
                        "A???",
                        "B???",
                        "C???",
                        "D???",
                        "E???",
                        "F???"
                    ]
                },
                "olduac_encrypted": {
                    "OldUacValue|endswith": [
                        "8??",
                        "9??",
                        "A??",
                        "B??",
                        "C??",
                        "D??",
                        "E??",
                        "F??"
                    ]
                },
                "olduac_preauth": {
                    "OldUacValue|endswith": [
                        "1????",
                        "3????",
                        "5????",
                        "7????",
                        "9????",
                        "B????",
                        "D????",
                        "F????"
                    ]
                },
                "selection": {
                    "EventID": 4738
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f6de9536-0441-4b3f-a646-f4e00f300ffd",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management",
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/11/27",
            "references": [
                "https://adsecurity.org/?p=2053",
                "https://blog.harmj0y.net/redteaming/another-word-on-delegation/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Weak Encryption Enabled and Kerberoast"
        },
        {
            "author": "xknow (@xknow_infosec), xorxes (@xor_xes)",
            "date": "2019/04/08",
            "description": "Detects the usage of the 'SeLoadDriverPrivilege' privilege. This privilege is required to load or unload a device driver.\nWith this privilege, the user can dynamically load and unload device drivers or other code in to kernel mode.\nThis user right does not apply to Plug and Play device drivers.\nIf you exclude privileged users/admins and processes, which are allowed to do so, you are maybe left with bad programs trying to load malicious kernel drivers.\nThis will detect Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs) and the usage of Sysinternals and various other tools. So you have to work with a whitelist to find the bad stuff.\n",
            "detection": {
                "condition": "selection_1 and not 1 of filter_*",
                "filter_endswith": {
                    "ProcessName|endswith": [
                        "\\procexp64.exe",
                        "\\procexp.exe",
                        "\\procmon64.exe",
                        "\\procmon.exe",
                        "\\Google\\Chrome\\Application\\chrome.exe",
                        "\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"
                    ]
                },
                "filter_exact": {
                    "ProcessName": [
                        "C:\\Windows\\System32\\Dism.exe",
                        "C:\\Windows\\System32\\rundll32.exe",
                        "C:\\Windows\\System32\\fltMC.exe",
                        "C:\\Windows\\HelpPane.exe",
                        "C:\\Windows\\System32\\mmc.exe",
                        "C:\\Windows\\System32\\svchost.exe",
                        "C:\\Windows\\System32\\wimserv.exe",
                        "C:\\Windows\\System32\\RuntimeBroker.exe",
                        "C:\\Windows\\System32\\SystemSettingsBroker.exe",
                        "C:\\Windows\\explorer.exe"
                    ]
                },
                "filter_startswith": {
                    "ProcessName|startswith": "C:\\Program Files\\WindowsApps\\Microsoft"
                },
                "selection_1": {
                    "EventID": 4673,
                    "PrivilegeList": "SeLoadDriverPrivilege",
                    "Service": "-"
                }
            },
            "falsepositives": [
                "Other legimate tools loading drivers. Including but not limited to, Sysinternals, CPU-Z, AVs etc. A baseline needs to be created according to the used products and allowed tools. A good thing to do is to try and exclude users who are allowed to load drivers."
            ],
            "id": "f63508a0-c809-4435-b3be-ed819394d612",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/01/20",
            "references": [
                "https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4673"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Potential Privileged System Service Operation - SeLoadDriverPrivilege"
        },
        {
            "author": "Florian Roth (Nextron Systems), wagga",
            "date": "2018/03/20",
            "description": "Detects NetNTLM downgrade attack",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4657,
                    "ObjectName|contains|all": [
                        "\\REGISTRY\\MACHINE\\SYSTEM",
                        "ControlSet",
                        "\\Control\\Lsa"
                    ],
                    "ObjectValueName": [
                        "LmCompatibilityLevel",
                        "NtlmMinClientSec",
                        "RestrictSendingNTLMTraffic"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d3abac66-f11c-4ed0-8acb-50cc29c97eed",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Policy : Object Access > Audit Registry (Success)",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/10/09",
            "references": [
                "https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks"
            ],
            "related": [
                {
                    "id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1112"
            ],
            "title": "NetNTLM Downgrade Attack"
        },
        {
            "id": "e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d",
            "author": "@BarryShooshooga, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/10/26",
            "description": "Detects write access requests to the Windows Defender exclusions registry keys. This could be an indication of an attacker trying to request a handle or access the object to write new exclusions in order to bypass security.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AccessList|contains": [
                        "%%4417",
                        "%%4418"
                    ],
                    "EventID": [
                        4656,
                        4663
                    ],
                    "ObjectName|contains": "\\Microsoft\\Windows Defender\\Exclusions\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "definition": "Requirements: Audit Policy : Security Settings/Local Policies/Audit Policy, Registry System Access Control (SACL): Auditing/User",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/11/11",
            "references": [
                "https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/"
            ],
            "related": [
                {
                    "id": "46a68649-f218-4f86-aea1-16a759d81820",
                    "type": "derived"
                },
                {
                    "type": "derived",
                    "id": "a33f8808-2812-4373-ae95-8cfb82134978"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Exclusion Reigstry Key - Write Access Requested"
        },
        {
            "author": "@gott_cyber",
            "date": "2024/01/08",
            "description": "Detects a Windows Filtering Platform (WFP) blocked connection event involving common Endpoint Detection and Response (EDR) agents.\nAdversaries may use WFP filters to prevent Endpoint Detection and Response (EDR) agents from reporting security events.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Application|endswith": [
                        "\\AmSvc.exe",
                        "\\cb.exe",
                        "\\CETASvc.exe",
                        "\\CNTAoSMgr.exe",
                        "\\CrAmTray.exe",
                        "\\CrsSvc.exe",
                        "\\CSFalconContainer.exe",
                        "\\CSFalconService.exe",
                        "\\CybereasonAV.exe",
                        "\\CylanceSvc.exe",
                        "\\cyserver.exe",
                        "\\CyveraService.exe",
                        "\\CyvrFsFlt.exe",
                        "\\EIConnector.exe",
                        "\\elastic-agent.exe",
                        "\\elastic-endpoint.exe",
                        "\\EndpointBasecamp.exe",
                        "\\ExecutionPreventionSvc.exe",
                        "\\filebeat.exe",
                        "\\fortiedr.exe",
                        "\\hmpalert.exe",
                        "\\hurukai.exe",
                        "\\LogProcessorService.exe",
                        "\\mcsagent.exe",
                        "\\mcsclient.exe",
                        "\\MsMpEng.exe",
                        "\\MsSense.exe",
                        "\\Ntrtscan.exe",
                        "\\PccNTMon.exe",
                        "\\QualysAgent.exe",
                        "\\RepMgr.exe",
                        "\\RepUtils.exe",
                        "\\RepUx.exe",
                        "\\RepWAV.exe",
                        "\\RepWSC.exe",
                        "\\sedservice.exe",
                        "\\SenseCncProxy.exe",
                        "\\SenseIR.exe",
                        "\\SenseNdr.exe",
                        "\\SenseSampleUploader.exe",
                        "\\SentinelAgent.exe",
                        "\\SentinelAgentWorker.exe",
                        "\\SentinelBrowserNativeHost.exe",
                        "\\SentinelHelperService.exe",
                        "\\SentinelServiceHost.exe",
                        "\\SentinelStaticEngine.exe",
                        "\\SentinelStaticEngineScanner.exe",
                        "\\sfc.exe",
                        "\\sophos ui.exe",
                        "\\sophosfilescanner.exe",
                        "\\sophosfs.exe",
                        "\\sophoshealth.exe",
                        "\\sophosips.exe",
                        "\\sophosLivequeryservice.exe",
                        "\\sophosnetfilter.exe",
                        "\\sophosntpservice.exe",
                        "\\sophososquery.exe",
                        "\\sspservice.exe",
                        "\\TaniumClient.exe",
                        "\\TaniumCX.exe",
                        "\\TaniumDetectEngine.exe",
                        "\\TMBMSRV.exe",
                        "\\TmCCSF.exe",
                        "\\TmListen.exe",
                        "\\TmWSCSvc.exe",
                        "\\Traps.exe",
                        "\\winlogbeat.exe",
                        "\\WSCommunicator.exe",
                        "\\xagt.exe"
                    ],
                    "EventID": 5157
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "bacf58c6-e199-4040-a94f-95dea0f1e45a",
            "level": "high",
            "logsource": {
                "definition": "Requirements: Audit Filtering Platform Connection needs to be enabled",
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://github.com/netero1010/EDRSilencer",
                "https://github.com/amjcyber/EDRNoiseMaker",
                "https://ghoulsec.medium.com/misc-series-4-forensics-on-edrsilencer-events-428b20b3f983"
            ],
            "status": "experimental",
            "title": "Windows Filtering Platform Blocked Connection From EDR Agent Binary",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ]
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/05/10",
            "description": "Detects the addition of a new \"Allow\" firewall rule by the WMI process (WmiPrvSE.EXE).\nThis can occur if an attacker leverages PowerShell cmdlets such as \"New-NetFirewallRule\", or directly uses WMI CIM classes such as \"MSFT_NetFirewallRule\".\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Action": 3,
                    "EventID": [
                        2004,
                        2071,
                        2097
                    ],
                    "ModifyingApplication|endswith": ":\\Windows\\System32\\wbem\\WmiPrvSE.exe"
                }
            },
            "falsepositives": [
                "Administrator scripts or activity."
            ],
            "id": "eca81e8d-09e1-4d04-8614-c91f44fd0519",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md#atomic-test-24---set-a-firewall-rule-using-new-netfirewallrule",
                "https://malware.news/t/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/72170",
                "https://cybersecuritynews.com/rhysida-ransomware-attacking-windows/"
            ],
            "status": "experimental",
            "title": "New Firewall Rule Added In Windows Firewall Exception List Via WmiPrvSE.EXE",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/19",
            "description": "Detects when a rule has been added to the Windows Firewall exception list",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_block": {
                    "Action": 2
                },
                "filter_main_covered_paths": {
                    "ApplicationPath|contains": [
                        ":\\PerfLogs\\",
                        ":\\Temp\\",
                        ":\\Tmp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        "\\AppData\\Local\\Temp\\"
                    ]
                },
                "filter_main_generic": {
                    "ApplicationPath|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\",
                        ":\\Windows\\WinSxS\\"
                    ]
                },
                "filter_optional_msmpeng": {
                    "ModifyingApplication|contains|all": [
                        ":\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                        "\\MsMpEng.exe"
                    ]
                },
                "selection": {
                    "EventID": [
                        2004,
                        2071,
                        2097
                    ]
                }
            },
            "id": "cde0a575-7d3d-4a49-9817-b8004a7bf105",
            "level": "medium",
            "modified": "2024/05/10",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)"
            ],
            "status": "experimental",
            "title": "Uncommon New Firewall Rule Added In Windows Firewall Exception List",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/19",
            "description": "Detects activity when The Windows Defender Firewall service failed to load Group Policy",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 2009
                }
            },
            "id": "7ec15688-fd24-4177-ba43-1a950537ee39",
            "level": "low",
            "modified": "2023/01/17",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)"
            ],
            "status": "test",
            "title": "The Windows Defender Firewall Service Failed To Load Group Policy",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/17",
            "description": "Detects when a all the rules have been deleted from the Windows Defender Firewall configuration",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_svchost": {
                    "ModifyingApplication|endswith": ":\\Windows\\System32\\svchost.exe"
                },
                "selection": {
                    "EventID": [
                        2033,
                        2059
                    ]
                },
                "filter_optional_msmpeng": {
                    "ModifyingApplication|contains|all": [
                        ":\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                        "\\MsMpEng.exe"
                    ]
                }
            },
            "id": "79609c82-a488-426e-abcf-9f341a39365d",
            "level": "high",
            "modified": "2024/01/22",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)"
            ],
            "status": "experimental",
            "title": "All Rules Have Been Deleted From The Windows Firewall Configuration",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/19",
            "description": "Detects when a single rules or all of the rules have been deleted from the Windows Defender Firewall",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_empty": {
                    "ModifyingApplication": ""
                },
                "filter_main_generic": {
                    "ModifyingApplication|startswith": [
                        "C:\\Program Files\\",
                        "C:\\Program Files (x86)\\"
                    ]
                },
                "filter_main_null": {
                    "ModifyingApplication": null
                },
                "filter_main_svchost": {
                    "ModifyingApplication": "C:\\Windows\\System32\\svchost.exe"
                },
                "filter_optional_msmpeng": {
                    "ModifyingApplication|endswith": "\\MsMpEng.exe",
                    "ModifyingApplication|startswith": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\"
                },
                "selection": {
                    "EventID": [
                        2006,
                        2052
                    ]
                }
            },
            "id": "c187c075-bb3e-4c62-b4fa-beae0ffc211f",
            "level": "medium",
            "modified": "2023/06/12",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)"
            ],
            "status": "test",
            "title": "A Rule Has Been Deleted From The Windows Firewall Exception List",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/19",
            "description": "Detects activity when Windows Defender Firewall has been reset to its default configuration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        2032,
                        2060
                    ]
                }
            },
            "id": "04b60639-39c0-412a-9fbe-e82499c881a3",
            "level": "low",
            "modified": "2023/04/21",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)"
            ],
            "status": "test",
            "title": "Windows Defender Firewall Has Been Reset To Its Default Configuration",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/02/19",
            "description": "Detects activity when the settings of the Windows firewall have been changed",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        2002,
                        2083,
                        2003,
                        2082,
                        2008
                    ]
                }
            },
            "id": "00bb5bd5-1379-4fcf-a965-a5b6f7478064",
            "level": "low",
            "modified": "2023/04/21",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)"
            ],
            "status": "test",
            "title": "Windows Firewall Settings Have Been Changed",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "frack113",
            "date": "2023/02/26",
            "description": "Detects the addition of a new rule to the Windows Firewall exception list for an application located in a potentially suspicious location.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_block": {
                    "Action": 2
                },
                "selection": {
                    "ApplicationPath|contains": [
                        ":\\PerfLogs\\",
                        ":\\Temp\\",
                        ":\\Tmp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        "\\AppData\\Local\\Temp\\"
                    ],
                    "EventID": [
                        2004,
                        2071,
                        2097
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9e2575e7-2cb9-4da1-adc8-ed94221dca5e",
            "level": "high",
            "modified": "2024/05/10",
            "logsource": {
                "product": "windows",
                "service": "firewall-as"
            },
            "status": "experimental",
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/dd364427(v=ws.10)",
                "https://app.any.run/tasks/7123e948-c91e-49e0-a813-00e8d72ab393/#"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "cde0a575-7d3d-4a49-9817-b8004a7bf105"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "New Firewall Rule Added In Windows Firewall Exception List For Potential Suspicious Application"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/06/07",
            "description": "Attempting to disable scheduled scanning and other parts of Windows Defender ATP or set default actions to allow.",
            "detection": {
                "condition": "selection_set_mppreference and 1 of selection_options_*",
                "selection_options_actions_func": {
                    "Data|contains": [
                        "HighThreatDefaultAction Allow",
                        "htdefac Allow",
                        "LowThreatDefaultAction Allow",
                        "ltdefac Allow",
                        "ModerateThreatDefaultAction Allow",
                        "mtdefac Allow",
                        "SevereThreatDefaultAction Allow",
                        "stdefac Allow"
                    ]
                },
                "selection_options_bool_allow": {
                    "Data|contains": [
                        "-dbaf $true",
                        "-dbaf 1",
                        "-dbm $true",
                        "-dbm 1",
                        "-dips $true",
                        "-dips 1",
                        "-DisableArchiveScanning $true",
                        "-DisableArchiveScanning 1",
                        "-DisableBehaviorMonitoring $true",
                        "-DisableBehaviorMonitoring 1",
                        "-DisableBlockAtFirstSeen $true",
                        "-DisableBlockAtFirstSeen 1",
                        "-DisableCatchupFullScan $true",
                        "-DisableCatchupFullScan 1",
                        "-DisableCatchupQuickScan $true",
                        "-DisableCatchupQuickScan 1",
                        "-DisableIntrusionPreventionSystem $true",
                        "-DisableIntrusionPreventionSystem 1",
                        "-DisableIOAVProtection $true",
                        "-DisableIOAVProtection 1",
                        "-DisableRealtimeMonitoring $true",
                        "-DisableRealtimeMonitoring 1",
                        "-DisableRemovableDriveScanning $true",
                        "-DisableRemovableDriveScanning 1",
                        "-DisableScanningMappedNetworkDrivesForFullScan $true",
                        "-DisableScanningMappedNetworkDrivesForFullScan 1",
                        "-DisableScanningNetworkFiles $true",
                        "-DisableScanningNetworkFiles 1",
                        "-DisableScriptScanning $true",
                        "-DisableScriptScanning 1",
                        "-MAPSReporting $false",
                        "-MAPSReporting 0",
                        "-drdsc $true",
                        "-drdsc 1",
                        "-drtm $true",
                        "-drtm 1",
                        "-dscrptsc $true",
                        "-dscrptsc 1",
                        "-dsmndf $true",
                        "-dsmndf 1",
                        "-dsnf $true",
                        "-dsnf 1",
                        "-dss $true",
                        "-dss 1"
                    ]
                },
                "selection_set_mppreference": {
                    "Data|contains": "Set-MpPreference"
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts that disable Windows Defender for troubleshooting purposes. Must be investigated."
            ],
            "id": "ec19ebab-72dc-40e1-9728-4c0b805d722c",
            "level": "high",
            "logsource": {
                "category": "ps_classic_provider_start",
                "product": "windows"
            },
            "modified": "2024/01/02",
            "status": "experimental",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
            ],
            "related": [
                {
                    "id": "14c71865-6cd3-44ae-adaa-1db923fae5f2",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Tamper Windows Defender - PSClassic"
        },
        {
            "author": "frack113",
            "date": "2022/09/10",
            "description": "Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.\nSimilar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images\n",
            "detection": {
                "condition": "all of selection*",
                "selection_cmd": {
                    "ScriptBlockText|contains|all": [
                        "Disable-WindowsOptionalFeature",
                        "-Online",
                        "-FeatureName"
                    ]
                },
                "selection_feature": {
                    "ScriptBlockText|contains": [
                        "Windows-Defender-Gui",
                        "Windows-Defender-Features",
                        "Windows-Defender",
                        "Windows-Defender-ApplicationGuard"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "99c4658d-2c5e-4d87-828d-7c066ca537c3",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/5b67c9b141fa3918017f8fa44f2f88f0b1ecb9e1/atomics/T1562.001/T1562.001.md",
                "https://learn.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable-WindowsOptionalFeature Command PowerShell"
        },
        {
            "id": "14c71865-6cd3-44ae-adaa-1db923fae5f2",
            "author": "frack113, elhoim, Tim Shelton (fps, alias support), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/16",
            "description": "Detects PowerShell scripts attempting to disable scheduled scanning and other parts of Windows Defender ATP or set default actions to allow.",
            "detection": {
                "condition": "all of selection_options_disabling_* or all of selection_other_default_actions_*",
                "selection_options_disabling_function": {
                    "ScriptBlockText|contains": [
                        "-dbaf $true",
                        "-dbaf 1",
                        "-dbm $true",
                        "-dbm 1",
                        "-dips $true",
                        "-dips 1",
                        "-DisableArchiveScanning $true",
                        "-DisableArchiveScanning 1",
                        "-DisableBehaviorMonitoring $true",
                        "-DisableBehaviorMonitoring 1",
                        "-DisableBlockAtFirstSeen $true",
                        "-DisableBlockAtFirstSeen 1",
                        "-DisableCatchupFullScan $true",
                        "-DisableCatchupFullScan 1",
                        "-DisableCatchupQuickScan $true",
                        "-DisableCatchupQuickScan 1",
                        "-DisableIntrusionPreventionSystem $true",
                        "-DisableIntrusionPreventionSystem 1",
                        "-DisableIOAVProtection $true",
                        "-DisableIOAVProtection 1",
                        "-DisableRealtimeMonitoring $true",
                        "-DisableRealtimeMonitoring 1",
                        "-DisableRemovableDriveScanning $true",
                        "-DisableRemovableDriveScanning 1",
                        "-DisableScanningMappedNetworkDrivesForFullScan $true",
                        "-DisableScanningMappedNetworkDrivesForFullScan 1",
                        "-DisableScanningNetworkFiles $true",
                        "-DisableScanningNetworkFiles 1",
                        "-DisableScriptScanning $true",
                        "-DisableScriptScanning 1",
                        "-MAPSReporting $false",
                        "-MAPSReporting 0",
                        "-drdsc $true",
                        "-drdsc 1",
                        "-drtm $true",
                        "-drtm 1",
                        "-dscrptsc $true",
                        "-dscrptsc 1",
                        "-dsmndf $true",
                        "-dsmndf 1",
                        "-dsnf $true",
                        "-dsnf 1",
                        "-dss $true",
                        "-dss 1"
                    ]
                },
                "selection_options_disabling_preference": {
                    "ScriptBlockText|contains": "Set-MpPreference"
                },
                "selection_other_default_actions_allow": {
                    "ScriptBlockText|contains": "Set-MpPreference"
                },
                "selection_other_default_actions_func": {
                    "ScriptBlockText|contains": [
                        "HighThreatDefaultAction Allow",
                        "htdefac Allow",
                        "LowThreatDefaultAction Allow",
                        "ltdefac Allow",
                        "ModerateThreatDefaultAction Allow",
                        "mtdefac Allow",
                        "SevereThreatDefaultAction Allow",
                        "stdefac Allow"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts that disable Windows Defender for troubleshooting purposes. Must be investigated."
            ],
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2024/01/02",
            "status": "experimental",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps",
                "https://bidouillesecurity.com/disable-windows-defender-in-powershell/"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "ec19ebab-72dc-40e1-9728-4c0b805d722c"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Tamper Windows Defender - ScriptBlockLogging"
        },
        {
            "id": "488b44e7-3781-4a71-888d-c95abfacf44d",
            "author": "Austin Songer @austinsonger",
            "date": "2021/10/12",
            "description": "Detects when a user disables the Windows Firewall via a Profile to help evade defense.",
            "detection": {
                "condition": "all of selection*",
                "selection_args": {
                    "ScriptBlockText|contains|all": [
                        "Set-NetFirewallProfile ",
                        " -Enabled ",
                        " False"
                    ]
                },
                "selection_opt": {
                    "ScriptBlockText|contains": [
                        " -All ",
                        "Public",
                        "Domain",
                        "Private"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/30",
            "references": [
                "https://learn.microsoft.com/en-us/powershell/module/netsecurity/set-netfirewallprofile?view=windowsserver2022-ps",
                "https://www.tutorialspoint.com/how-to-get-windows-firewall-profile-settings-using-powershell",
                "http://powershellhelp.space/commands/set-netfirewallrule-psv5.php",
                "http://woshub.com/manage-windows-firewall-powershell/",
                "https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "12f6b752-042d-483e-bf9c-915a6d06ad75"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Windows Firewall Profile Disabled"
        },
        {
            "id": "fa2559c8-1197-471d-9cdd-05a0273d4522",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/04",
            "description": "Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "if(0){{{0}}}' -f $(0 -as [char]) +",
                        "#<NULL>"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2023/05/09",
            "references": [
                "https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-bypass-using-null-bits-satoshi"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "92a974db-ab84-457f-9ec0-55db83d7a825"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Potential AMSI Bypass Script Using NULL Bits"
        },
        {
            "id": "ae2bdd58-0681-48ac-be7f-58ab4e593458",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/05",
            "description": "Detects attempts to remove Windows Defender configuration using the 'MpPreference' cmdlet",
            "detection": {
                "condition": "all of selection_*",
                "selection_remove": {
                    "ScriptBlockText|contains": "Remove-MpPreference"
                },
                "selection_tamper": {
                    "ScriptBlockText|contains": [
                        "-ControlledFolderAccessProtectedFolders ",
                        "-AttackSurfaceReductionRules_Ids ",
                        "-AttackSurfaceReductionRules_Actions ",
                        "-CheckForSignaturesBeforeRunningScan "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "07e3cb2c-0608-410d-be4b-1511cb1a0448"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Tamper Windows Defender Remove-MpPreference - ScriptBlockLogging"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/09",
            "description": "Detects code fragments found in small and obfuscated AMSI bypass PowerShell scripts",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "[Ref].Assembly.GetType",
                        "SetValue($null,$true)",
                        "NonPublic,Static"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e0d6c087-2d1c-47fd-8799-3904103c5a98",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/",
                "https://twitter.com/cyb3rops/status/1588574518057979905?s=20&t=A7hh93ONM7ni1Rj1jO5OaA"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.execution"
            ],
            "title": "AMSI Bypass Pattern Assembly GetType"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of powershell cmdlets to disable or remove ETW trace sessions",
            "detection": {
                "condition": "1 of selection*",
                "selection_pwsh_remove": {
                    "ScriptBlockText|contains": "Remove-EtwTraceProvider "
                },
                "selection_pwsh_set": {
                    "ScriptBlockText|contains|all": [
                        "Set-EtwTraceProvider ",
                        "0x11"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "115fdba9-f017-42e6-84cf-d5573bf2ddf8",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/11/25",
            "references": [
                "https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "a238b5d0-ce2d-4414-a676-7a531b3d13d6"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562.006",
                "car.2016-04-002"
            ],
            "title": "Disable of ETW Trace - Powershell"
        },
        {
            "id": "c1344fa2-323b-4d2e-9176-84b4d4821c88",
            "author": "Tim Rauch, Elastic (idea)",
            "date": "2022/09/16",
            "description": "Detects modifications to the Windows Defender configuration settings using PowerShell to add exclusions",
            "detection": {
                "condition": "all of selection*",
                "selection_args_exc": {
                    "ScriptBlockText|contains": [
                        " -ExclusionPath ",
                        " -ExclusionExtension ",
                        " -ExclusionProcess ",
                        " -ExclusionIpAddress "
                    ]
                },
                "selection_args_pref": {
                    "ScriptBlockText|contains": [
                        "Add-MpPreference ",
                        "Set-MpPreference "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/11/26",
            "references": [
                "https://www.elastic.co/guide/en/security/current/windows-defender-exclusions-added-via-powershell.html"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "17769c90-230e-488b-a463-e05c08e9d48f"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562",
                "attack.execution",
                "attack.t1059"
            ],
            "title": "Windows Defender Exclusions Added - PowerShell"
        },
        {
            "author": "Ilyas Ochkov, oscd.community",
            "date": "2019/10/25",
            "description": "Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "EventType": "CreateKey",
                        "TargetObject": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"
                    },
                    {
                        "NewName": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "EventID",
                "Image",
                "TargetObject",
                "NewName"
            ],
            "id": "919f2ef0-be2d-4a7a-b635-eb2b41fde044",
            "level": "high",
            "modified": "2021/11/27",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://twitter.com/0gtweet/status/1182516740955226112"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1112"
            ],
            "title": "Disable Security Events Logging Adding Reg Key MiniNt"
        },
        {
            "id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
            "author": "Florian Roth (Nextron Systems), wagga",
            "date": "2018/03/20",
            "description": "Detects NetNTLM downgrade attack",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains|all": [
                        "SYSTEM\\",
                        "ControlSet",
                        "\\Control\\Lsa"
                    ],
                    "TargetObject|endswith": [
                        "\\lmcompatibilitylevel",
                        "\\NtlmMinClientSec",
                        "\\RestrictSendingNTLMTraffic"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "modified": "2022/11/29",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "references": [
                "https://web.archive.org/web/20171113231705/https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks"
            ],
            "status": "test",
            "title": "NetNTLM Downgrade Attack - Registry",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1112"
            ]
        },
        {
            "author": "X__Junior (Nextron Systems)",
            "date": "2023/11/03",
            "description": "Detects enabling of the \"AllowAnonymousCallback\" registry value, which allows a remote connection between computers that do not have a trust relationship.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|contains": "\\Microsoft\\WBEM\\CIMOM\\AllowAnonymousCallback"
                }
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "id": "4d431012-2ab5-4db7-a84e-b29809da2172",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/wmisdk/connecting-to-wmi-remotely-starting-with-vista"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/26",
            "description": "Detects when the \"index\" value of a scheduled task is removed or deleted from the registry. Which effectively hides it from any tooling such as \"schtasks /query\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "DeleteKey",
                    "TargetObject|contains|all": [
                        "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\",
                        "Index"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "526cc8bc-1cdc-48ad-8b26-f19bff969cec",
            "level": "medium",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments"
            ],
            "related": [
                {
                    "id": "acd74772-5f88-45c7-956b-6a7b36c294d2",
                    "type": "similar"
                },
                {
                    "id": "5b16df71-8615-4f7f-ac9b-6c43c0509e61",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Removal Of Index Value to Hide Schedule Task - Registry"
        },
        {
            "id": "acd74772-5f88-45c7-956b-6a7b36c294d2",
            "author": "Sittikorn S",
            "date": "2022/04/15",
            "description": "Remove SD (Security Descriptor) value in \\Schedule\\TaskCache\\Tree registry hive to hide schedule task. This technique is used by Tarrask malware",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "DeleteKey",
                    "TargetObject|contains|all": [
                        "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\",
                        "SD"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "526cc8bc-1cdc-48ad-8b26-f19bff969cec"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Removal Of SD Value to Hide Schedule Task - Registry"
        },
        {
            "author": "frack113",
            "date": "2021/06/07",
            "description": "Detects the deletion of AMSI provider registry key entries in HKLM\\Software\\Microsoft\\AMSI. This technique could be used by an attacker in order to disable AMSI inspection.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "DeleteKey",
                    "TargetObject|endswith": [
                        "{2781761E-28E0-4109-99FE-B9D127C57AFE}",
                        "{A7C452EF-8E9F-42EB-9F2B-245613CA0DC9}"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "41d1058a-aea7-4952-9293-29eaaf516465",
            "level": "high",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://seclists.org/fulldisclosure/2020/Mar/45"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Removal Of AMSI Provider Registry Keys"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/05",
            "description": "Detects the removal of folders from the \"ProtectedFolders\" list of of exploit guard. This could indicate an attacker trying to launch an encryption process or trying to manipulate data inside of the protected folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "DeleteValue",
                    "TargetObject|contains": "SOFTWARE\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\ProtectedFolders"
                }
            },
            "falsepositives": [
                "Legitimate administrators removing applications (should always be investigated)"
            ],
            "id": "272e55a4-9e6b-4211-acb6-78f51f0b1b40",
            "level": "high",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Folder Removed From Exploit Guard ProtectedFolders List - Registry"
        },
        {
            "author": "frack113",
            "date": "2022/10/02",
            "description": "Detects registry modifications that disable Privacy Settings Experience",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": "\\SOFTWARE\\Policies\\Microsoft\\Windows\\OOBE\\DisablePrivacyExperience"
                }
            },
            "falsepositives": [
                "Legitimate admin script"
            ],
            "id": "0372e1f9-0fd2-40f7-be1b-a7b2b848fa7b",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1562.001/T1562.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable Privacy Settings Experience in Registry"
        },
        {
            "author": "D3F7A5105",
            "date": "2023/01/02",
            "description": "Detects tampering with EventLog service \"file\" key. In order to change the default location of an Evtx file. This technique is used to tamper with log collection and alerting",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Details|contains": "\\System32\\Winevt\\Logs\\"
                },
                "selection": {
                    "TargetObject|contains": "\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\",
                    "TargetObject|endswith": "\\File"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0cb8d736-995d-4ce7-a31e-1e8d452a1459",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Potential EventLog File Location Tampering"
        },
        {
            "id": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/06/05",
            "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_complus": {
                    "Details": [
                        0,
                        "DWORD (0x00000000)"
                    ],
                    "TargetObject|endswith": [
                        "\\COMPlus_ETWEnabled",
                        "\\COMPlus_ETWFlags"
                    ]
                },
                "selection_etw_enabled": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": "SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/_xpn_/status/1268712093928378368",
                "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
                "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
                "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
                "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
                "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
                "https://bunnyinside.com/?term=f71e8cb9c76a",
                "http://managed670.rssing.com/chan-5590147/all_p1.html",
                "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
                "https://blog.xpnsec.com/hiding-your-dotnet-complus-etwenabled/",
                "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ],
            "title": "ETW Logging Disabled In .NET Processes - Sysmon Registry"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/04",
            "description": "Detects changes to the AMSI come server registry key in order disable AMSI scanning functionalities. When AMSI attempts to starts its COM component, it will query its registered CLSID and return a non-existent COM server. This causes a load failure and prevents any scanning methods from being accessed, ultimately rendering AMSI useless",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Details": "%windir%\\system32\\amsi.dll"
                },
                "selection": {
                    "TargetObject|endswith": "\\CLSID\\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\\InProcServer32\\(Default)"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "160d2780-31f7-4922-8b3a-efce30e63e96",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://enigma0x3.net/2017/07/19/bypassing-amsi-via-com-server-hijacking/",
                "https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-comreg-bypass"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Potential AMSI COM Server Hijacking"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/04",
            "description": "Detects disabling Windows Defender PUA protection",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "\\Policies\\Microsoft\\Windows Defender\\PUAProtection"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8ffc5407-52e3-478f-9596-0a7371eafe13",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable PUA Protection on Windows Defender"
        },
        {
            "author": "frack113",
            "date": "2022/09/17",
            "description": "Detects tampering with the \"ChannelAccess\" registry key in order to change access to Windows event channel.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_tiworker": {
                    "Image|endswith": "\\TiWorker.exe",
                    "Image|startswith": "C:\\Windows\\WinSxS\\"
                },
                "filter_main_trustedinstaller": {
                    "Image": "C:\\Windows\\servicing\\TrustedInstaller.exe"
                },
                "selection": {
                    "Details|contains": [
                        "(A;;0x1;;;LA)",
                        "(A;;0x1;;;SY)",
                        "(A;;0x5;;;BA)"
                    ],
                    "TargetObject|contains": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\",
                    "TargetObject|endswith": "\\ChannelAccess"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7d9263bd-dc47-4a58-bc92-5474abab390c",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "status": "experimental",
            "references": [
                "https://app.any.run/tasks/77b2e328-8f36-46b2-b2e2-8a80398217ab/",
                "https://learn.microsoft.com/en-us/windows/win32/api/winevt/",
                "https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Change Winevt Channel Access Permission Via Registry"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/02",
            "description": "Detects tamper attempts to sophos av functionality via registry key modification",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": [
                        "\\Sophos Endpoint Defense\\TamperProtection\\Config\\SAVEnabled",
                        "\\Sophos Endpoint Defense\\TamperProtection\\Config\\SEDEnabled",
                        "\\Sophos\\SAVService\\TamperProtection\\Enabled"
                    ]
                }
            },
            "falsepositives": [
                "Some FP may occur when the feature is disabled by the AV itself, you should always investigate if the action was legitimate"
            ],
            "id": "9f4662ac-17ca-43aa-8f12-5d7b989d0101",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Tamper With Sophos AV Registry Keys"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/09",
            "description": "Detects changes to the \"ExtErrorInformation\" key in order to disable ETW logging for rpcrt4.dll",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": [
                        "DWORD (0x00000000)",
                        "DWORD (0x00000002)"
                    ],
                    "TargetObject|endswith": "\\Microsoft\\Windows NT\\Rpc\\ExtErrorInformation"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "90f342e1-1aaa-4e43-b092-39fda57ed11e",
            "level": "low",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html"
            ],
            "status": "test",
            "title": "ETW Logging Disabled For rpcrt4.dll",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ]
        },
        {
            "author": "AlertIQ, J\u00e1n Tren\u010dansk\u00fd, frack113, Nasreddine Bencherchali, Swachchhanda Shrawan Poudel",
            "date": "2022/08/01",
            "description": "Detects when attackers or tools disable Windows Defender functionalities via the Windows registry",
            "detection": {
                "condition": "selection_main and 1 of selection_dword_* and not 1 of filter_optional_*",
                "filter_optional_symantec": {
                    "Image|endswith": "\\sepWscSvc64.exe",
                    "Image|startswith": "C:\\Program Files\\Symantec\\Symantec Endpoint Protection\\"
                },
                "selection_dword_0": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\App and Browser protection\\DisallowExploitProtectionOverride",
                        "\\Features\\TamperProtection",
                        "\\MpEngine\\MpEnablePus",
                        "\\PUAProtection",
                        "\\Signature Update\\ForceUpdateFromMU",
                        "\\SpyNet\\SpynetReporting",
                        "\\SpyNet\\SubmitSamplesConsent",
                        "\\Windows Defender Exploit Guard\\Controlled Folder Access\\EnableControlledFolderAccess"
                    ]
                },
                "selection_dword_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": [
                        "\\DisableAntiSpyware",
                        "\\DisableAntiVirus",
                        "\\Real-Time Protection\\DisableBehaviorMonitoring",
                        "\\Real-Time Protection\\DisableIntrusionPreventionSystem",
                        "\\Real-Time Protection\\DisableIOAVProtection",
                        "\\Real-Time Protection\\DisableOnAccessProtection",
                        "\\Real-Time Protection\\DisableRealtimeMonitoring",
                        "\\Real-Time Protection\\DisableScanOnRealtimeEnable",
                        "\\Real-Time Protection\\DisableScriptScanning",
                        "\\Reporting\\DisableEnhancedNotifications",
                        "\\SpyNet\\DisableBlockAtFirstSeen"
                    ]
                },
                "selection_main": {
                    "TargetObject|contains": [
                        "\\SOFTWARE\\Microsoft\\Windows Defender\\",
                        "\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\",
                        "\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\"
                    ]
                }
            },
            "falsepositives": [
                "Administrator actions via the Windows Defender interface",
                "Third party Antivirus"
            ],
            "id": "0eb46774-f1ab-4a74-8238-1155855f2263",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/07/03",
            "references": [
                "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
                "https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105",
                "https://admx.help/?Category=Windows_7_2008R2&Policy=Microsoft.Policies.WindowsDefender::SpyNetReporting",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
                "https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html",
                "https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html",
                "https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-antivirus.html"
            ],
            "related": [
                {
                    "id": "a64e4198-c1c8-46a5-bc9c-324c86455fd4",
                    "type": "obsoletes"
                },
                {
                    "id": "fd115e64-97c7-491f-951c-fc8da7e042fa",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable Windows Defender Functionalities Via Registry Keys"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/07/05",
            "description": "Detects changes to the \"DisableHypervisorEnforcedPagingTranslation\" registry value. Where the it is set to \"1\" in order to disable the Hypervisor Enforced Paging Translation feature.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\DisableHypervisorEnforcedPagingTranslation"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7f2954d2-99c2-4d42-a065-ca36740f187b",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://twitter.com/standa_t/status/1808868985678803222",
                "https://github.com/AaLl86/WindowsInternals/blob/070dc4f317726dfb6ffd2b7a7c121a33a8659b5e/Slides/Hypervisor-enforced%20Paging%20Translation%20-%20The%20end%20of%20non%20data-driven%20Kernel%20Exploits%20(Recon2024).pdf"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Hypervisor Enforced Paging Translation Disabled"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/07/06",
            "description": "Detects the Setting of Windows Defender Exclusions",
            "detection": {
                "condition": "selection2",
                "selection2": {
                    "TargetObject|contains": "\\Microsoft\\Windows Defender\\Exclusions"
                }
            },
            "falsepositives": [
                "Administrator actions"
            ],
            "id": "a982fc9c-6333-4ffb-a51d-addb04e8b529",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/_nullbind/status/1204923340810543109"
            ],
            "related": [
                {
                    "id": "1321dc4e-a1fe-481d-a016-52c45f0c8b4f",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Exclusions Added - Registry"
        },
        {
            "id": "5b16df71-8615-4f7f-ac9b-6c43c0509e61",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/26",
            "description": "Detects when the \"index\" value of a scheduled task is modified from the registry\nWhich effectively hides it from any tooling such as \"schtasks /query\" (Read the referenced link for more information about the effects of this technique)\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains|all": [
                        "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\",
                        "Index"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments"
            ],
            "related": [
                {
                    "id": "acd74772-5f88-45c7-956b-6a7b36c294d2",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "526cc8bc-1cdc-48ad-8b26-f19bff969cec"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ],
            "title": "Hide Schedule Task Via Index Value Tamper"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/07/04",
            "description": "Detects the disabling of the Windows Defender eventlog as seen in relation to Lockbit 3.0 infections",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Windows Defender/Operational\\Enabled"
                }
            },
            "falsepositives": [
                "Other Antivirus software installations could cause Windows to disable that eventlog (unknown)"
            ],
            "id": "fcddca7c-b9c0-4ddf-98da-e1e2d18b0157",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/WhichbufferArda/status/1543900539280293889/photo/2"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disabled Windows Defender Eventlog"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/09",
            "description": "Detects changes to the \"TracingDisabled\" key in order to disable ETW logging for services.exe (SCM)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "Software\\Microsoft\\Windows NT\\CurrentVersion\\Tracing\\SCM\\Regular\\TracingDisabled"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4f281b83-0200-4b34-bf35-d24687ea57c2",
            "level": "low",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html"
            ],
            "status": "test",
            "title": "ETW Logging Disabled For SCM",
            "tags": [
                "attack.defense_evasion",
                "attack.t1112",
                "attack.t1562"
            ]
        },
        {
            "author": "xknow (@xknow_infosec), xorxes (@xor_xes)",
            "date": "2019/04/08",
            "description": "Detects installation of NalDrv or PROCEXP152 services via registry-keys to non-system32 folders.\nBoth services are used in the tool Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU (https://github.com/hfiref0x/KDU)\n",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Details|contains": "\\WINDOWS\\system32\\Drivers\\PROCEXP152.SYS",
                    "Image|endswith": [
                        "\\procexp64.exe",
                        "\\procexp.exe",
                        "\\procmon64.exe",
                        "\\procmon.exe",
                        "\\handle.exe",
                        "\\handle64.exe"
                    ]
                },
                "selection": {
                    "TargetObject": [
                        "HKLM\\System\\CurrentControlSet\\Services\\NalDrv\\ImagePath",
                        "HKLM\\System\\CurrentControlSet\\Services\\PROCEXP152\\ImagePath"
                    ]
                }
            },
            "falsepositives": [
                "Other legimate tools using this service names and drivers. Note - clever attackers may easily bypass this detection by just renaming the services. Therefore just Medium-level and don't rely on it."
            ],
            "id": "f2485272-a156-4773-82d7-1d178bc4905b",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://web.archive.org/web/20200419024230/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/"
            ],
            "status": "test",
            "tags": [
                "attack.t1562.001",
                "attack.defense_evasion"
            ],
            "title": "Suspicious Service Installed"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/04",
            "description": "Detects disabling Windows Defender Exploit Guard Network Protection",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (00000001)",
                    "TargetObject|contains": "SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and Browser protection\\DisallowExploitProtectionOverride"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bf9e1387-b040-4393-9851-1598f8ecfae9",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable Exploit Guard Network Protection on Windows Defender"
        },
        {
            "author": "X__Junior (Nextron Systems)",
            "date": "2023/11/21",
            "description": "Detects usage of Windows Input Method Editor (IME) keyboard layout feature, which allows an attacker to load a DLL into the process after sending the WM_INPUTLANGCHANGEREQUEST message.\nBefore doing this, the client needs to register the DLL in a special registry key that is assumed to implement this keyboard layout. This registry key should store a value named \"Ime File\" with a DLL path.\nIMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_known_extension": {
                    "Details|endswith": ".ime"
                },
                "selection": {
                    "TargetObject|contains|all": [
                        "\\Control\\Keyboard Layouts\\",
                        "Ime File"
                    ]
                }
            },
            "falsepositives": [
                "IMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean."
            ],
            "id": "b888e3f2-224d-4435-b00b-9dd66e9ea1f1",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://www.linkedin.com/pulse/guntior-story-advanced-bootkit-doesnt-rely-windows-disk-baranov-wue8e/"
            ],
            "related": [
                {
                    "id": "9d8f9bb8-01af-4e15-a3a2-349071530530",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Uncommon Extension In Keyboard Layout IME File Registry Value"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/05",
            "description": "Detects applications being added to the \"allowed applications\" list of exploit guard in order to bypass controlled folder settings",
            "detection": {
                "condition": "all of selection_*",
                "selection_key": {
                    "TargetObject|contains": "SOFTWARE\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\AllowedApplications"
                },
                "selection_paths": {
                    "TargetObject|contains": [
                        "\\Users\\Public\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\Desktop\\",
                        "\\PerfLogs\\",
                        "\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "42205c73-75c8-4a63-9db1-e3782e06fda0",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Suspicious Application Allowed Through Exploit Guard"
        },
        {
            "author": "frack113",
            "date": "2022/01/09",
            "description": "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\",
                    "TargetObject|endswith": "\\EnableFirewall"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "974515da-6cc5-4c95-ae65-f97f9150ec7f",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-2---disable-microsoft-defender-firewall-via-registry"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Disable Microsoft Defender Firewall via Registry"
        },
        {
            "author": "frack113",
            "date": "2022/08/19",
            "description": "Detect set EnableFirewall to 0 to disable the Windows firewall",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\\EnableFirewall",
                        "\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\EnableFirewall"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e78c408a-e2ea-43cd-b5ea-51975cf358c0",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.004/T1562.004.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Disable Windows Firewall by Registry"
        },
        {
            "author": "Christopher Peacock @securepeacock, SCYTHE @scythe_io",
            "date": "2022/06/15",
            "description": "Detects enabling TurnOffCheck which can be used to bypass defense of MSDT Follina vulnerability",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics\\TurnOffCheck"
                }
            },
            "falsepositives": [
                "Administrator actions"
            ],
            "id": "7d995e63-ec83-4aa3-89d5-8a17b5c87c86",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://twitter.com/wdormann/status/1537075968568877057?s=20&t=0lr18OAnmAGoGpma6grLUw"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Scripted Diagnostics Turn Off Check Enabled - Registry"
        },
        {
            "id": "9d8f9bb8-01af-4e15-a3a2-349071530530",
            "author": "X__Junior (Nextron Systems)",
            "date": "2023/11/21",
            "description": "Detects usage of Windows Input Method Editor (IME) keyboard layout feature, which allows an attacker to load a DLL into the process after sending the WM_INPUTLANGCHANGEREQUEST message.\nBefore doing this, the client needs to register the DLL in a special registry key that is assumed to implement this keyboard layout. This registry key should store a value named \"Ime File\" with a DLL path.\nIMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean.\n",
            "detection": {
                "condition": "selection_registry and 1 of selection_folders_*",
                "selection_folders_1": {
                    "Details|contains": [
                        ":\\Perflogs\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Temp\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\",
                        "\\Temporary Internet"
                    ]
                },
                "selection_folders_2": [
                    {
                        "Details|contains|all": [
                            ":\\Users\\",
                            "\\Favorites\\"
                        ]
                    },
                    {
                        "Details|contains|all": [
                            ":\\Users\\",
                            "\\Favourites\\"
                        ]
                    },
                    {
                        "Details|contains|all": [
                            ":\\Users\\",
                            "\\Contacts\\"
                        ]
                    }
                ],
                "selection_registry": {
                    "TargetObject|contains|all": [
                        "\\Control\\Keyboard Layouts\\",
                        "Ime File"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://www.linkedin.com/pulse/guntior-story-advanced-bootkit-doesnt-rely-windows-disk-baranov-wue8e/"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "b888e3f2-224d-4435-b00b-9dd66e9ea1f1"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Suspicious Path In Keyboard Layout IME File Registry Value"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd, frack113, AlertIQ, Nasreddine Bencherchali",
            "date": "2022/08/01",
            "description": "Detects when an attacker or tool disables the  Windows Defender service (WinDefend) via the registry",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000004)",
                    "TargetObject|endswith": "\\Services\\WinDefend\\Start"
                }
            },
            "falsepositives": [
                "Administrator actions"
            ],
            "id": "e1aa95de-610a-427d-b9e7-9b46cfafbe6a",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "status": "experimental",
            "references": [
                "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
                "https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Windows Defender Service Disabled - Registry"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Anish Bogati",
            "date": "2023/03/14",
            "description": "Detects changes to the HypervisorEnforcedCodeIntegrity registry key and the \"Enabled\" value being set to 0 in order to disable the Hypervisor Enforced Code Integrity feature. This allows an attacker to load unsigned and untrusted code to be run in the kernel\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\Microsoft\\Windows\\DeviceGuard\\HypervisorEnforcedCodeIntegrity",
                        "\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity",
                        "\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\\Enabled"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8b7273a4-ba5d-4d8a-b04f-11f2900d043a",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/07/05",
            "status": "experimental",
            "references": [
                "https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/",
                "https://github.com/redcanaryco/atomic-red-team/blob/04e487c1828d76df3e834621f4f893ea756d5232/atomics/T1562.001/T1562.001.md#atomic-test-43---disable-hypervisor-enforced-code-integrity-hvci"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Hypervisor Enforced Code Integrity Disabled"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/04",
            "description": "Detects tampering with the \"Enabled\" registry key in order to disable Windows logging of a Windows event channel",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_iis": {
                    "Image|endswith": "\\TiWorker.exe",
                    "Image|startswith": "C:\\Windows\\winsxs\\"
                },
                "filter_main_svchost": {
                    "Image": "C:\\Windows\\System32\\svchost.exe",
                    "TargetObject|contains": [
                        "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-FileInfoMinifilter",
                        "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-ASN1\\",
                        "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Kernel-AppCompat\\",
                        "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Runtime\\Error\\",
                        "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-CAPI2/Operational\\"
                    ]
                },
                "filter_main_trusted_installer": {
                    "Image": "C:\\Windows\\servicing\\TrustedInstaller.exe",
                    "TargetObject|contains": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Compat-Appraiser"
                },
                "filter_main_wevutil": {
                    "Image": "C:\\Windows\\system32\\wevtutil.exe"
                },
                "filter_optional_empty": {
                    "Image": ""
                },
                "filter_optional_null": {
                    "Image": null
                },
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\",
                    "TargetObject|endswith": "\\Enabled"
                }
            },
            "falsepositives": [
                "Rare falsepositives may occur from legitimate administrators disabling specific event log for troubleshooting"
            ],
            "id": "2f78da12-f7c7-430b-8b19-a28f269b77a3",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "status": "experimental",
            "references": [
                "https://twitter.com/WhichbufferArda/status/1543900539280293889",
                "https://github.com/DebugPrivilege/CPP/blob/c39d365617dbfbcb01fffad200d52b6239b2918c/Windows%20Defender/RestoreDefenderConfig.cpp"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.002"
            ],
            "title": "Disable Windows Event Logging Via Registry"
        },
        {
            "author": "B.Talebi",
            "date": "2022/07/28",
            "description": "Detects changes in Sysmon driver altitude value.\nIf the Sysmon driver is configured to load at an altitude of another registered service, it will fail to load at boot.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "\\Services\\",
                    "TargetObject|endswith": "\\Instances\\Sysmon Instance\\Altitude"
                }
            },
            "falsepositives": [
                "Legitimate driver altitude change to hide sysmon"
            ],
            "id": "4916a35e-bfc4-47d0-8e25-a003d7067061",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "status": "experimental",
            "references": [
                "https://posts.specterops.io/shhmon-silencing-sysmon-via-driver-unload-682b5be57650",
                "https://youtu.be/zSihR3lTf7g"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Sysmon Driver Altitude Change"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/06/08",
            "description": "Detects changes to Microsoft Office protected view registry keys with which the attacker disables this feature.",
            "detection": {
                "condition": "selection_path and 1 of selection_values_*",
                "selection_path": {
                    "TargetObject|contains|all": [
                        "\\SOFTWARE\\Microsoft\\Office\\",
                        "\\Security\\ProtectedView\\"
                    ]
                },
                "selection_values_0": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\enabledatabasefileprotectedview",
                        "\\enableforeigntextfileprotectedview"
                    ]
                },
                "selection_values_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": [
                        "\\DisableAttachementsInPV",
                        "\\DisableInternetFilesInPV",
                        "\\DisableIntranetCheck",
                        "\\DisableUnsafeLocationsInPV"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "a5c7a43f-6009-4a8c-80c5-32abf1c53ecc",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/",
                "https://yoroi.company/research/cyber-criminal-espionage-operation-insists-on-italian-manufacturing/",
                "https://admx.help/HKCU/software/policies/microsoft/office/16.0/excel/security/protectedview"
            ],
            "related": [
                {
                    "id": "7c637634-c95d-4bbf-b26c-a82510874b34",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Microsoft Office Protected View Disabled"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/04",
            "description": "Detects disabling Windows Defender Tamper Protection",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_msmpeng_client": {
                    "Image|endswith": "\\MsMpEng.exe",
                    "Image|startswith": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\"
                },
                "filter_msmpeng_domain_controller": {
                    "Image": "C:\\Program Files\\Windows Defender\\MsMpEng.exe"
                },
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "\\Microsoft\\Windows Defender\\Features\\TamperProtection"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "93d298a1-d28f-47f1-a468-d971e7796679",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-antivirus.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001"
            ],
            "title": "Disable Tamper Protection on Windows Defender"
        },
        {
            "author": "Tuan Le (NCSGroup)",
            "date": "2023/03/16",
            "description": "Detects usage of command line tools such as \"kill\", \"pkill\" or \"killall\" to terminate or signal a running process.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/kill",
                        "/pkill",
                        "/killall"
                    ]
                }
            },
            "falsepositives": [
                "Likely"
            ],
            "id": "64c41342-6b27-523b-5d3f-c265f3efcdb3",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html",
                "https://www.cyberciti.biz/faq/how-force-kill-process-linux/"
            ],
            "status": "test",
            "title": "Terminate Linux Process Via Kill",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562"
            ]
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/01/18",
            "description": "Detect use of iptables to flush all firewall rules, tables and chains and allow all network traffic",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": {
                    "Image|endswith": [
                        "/iptables",
                        "/xtables-legacy-multi",
                        "/iptables-legacy-multi",
                        "/ip6tables",
                        "/ip6tables-legacy-multi"
                    ]
                },
                "selection_params": {
                    "CommandLine|contains": [
                        "-F",
                        "-Z",
                        "-X"
                    ]
                },
                "selection_ufw": {
                    "CommandLine|contains": [
                        "ufw-logging-deny",
                        "ufw-logging-allow",
                        "ufw6-logging-deny",
                        "ufw6-logging-allow"
                    ]
                }
            },
            "falsepositives": [
                "Network administrators"
            ],
            "id": "3be619f4-d9ec-4ea8-a173-18fdd01996ab",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.blackberry.com/",
                "https://www.cyberciti.biz/tips/linux-iptables-how-to-flush-all-rules.html",
                "https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144"
            ],
            "status": "test",
            "title": "Flush Iptables Ufw Chain",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "\u00d6mer G\u00fcnal, Alejandro Ortuno, oscd.community",
            "date": "2020/06/17",
            "description": "Detects disabling security tools",
            "detection": {
                "condition": "1 of selection*",
                "selection_carbonblack_1": {
                    "CommandLine|contains|all": [
                        "cbdaemon",
                        "stop"
                    ],
                    "Image|endswith": "/service"
                },
                "selection_carbonblack_2": {
                    "CommandLine|contains|all": [
                        "cbdaemon",
                        "off"
                    ],
                    "Image|endswith": "/chkconfig"
                },
                "selection_carbonblack_3": {
                    "CommandLine|contains|all": [
                        "cbdaemon",
                        "stop"
                    ],
                    "Image|endswith": "/systemctl"
                },
                "selection_carbonblack_4": {
                    "CommandLine|contains|all": [
                        "cbdaemon",
                        "disable"
                    ],
                    "Image|endswith": "/systemctl"
                },
                "selection_crowdstrike_1": {
                    "CommandLine|contains|all": [
                        "stop",
                        "falcon-sensor"
                    ],
                    "Image|endswith": "/systemctl"
                },
                "selection_crowdstrike_2": {
                    "CommandLine|contains|all": [
                        "disable",
                        "falcon-sensor"
                    ],
                    "Image|endswith": "/systemctl"
                },
                "selection_firewall_1": {
                    "CommandLine|contains|all": [
                        "firewalld",
                        "stop"
                    ],
                    "Image|endswith": "/systemctl"
                },
                "selection_firewall_2": {
                    "CommandLine|contains|all": [
                        "firewalld",
                        "disable"
                    ],
                    "Image|endswith": "/systemctl"
                },
                "selection_iptables_1": {
                    "CommandLine|contains|all": [
                        "iptables",
                        "stop"
                    ],
                    "Image|endswith": "/service"
                },
                "selection_iptables_2": {
                    "CommandLine|contains|all": [
                        "ip6tables",
                        "stop"
                    ],
                    "Image|endswith": "/service"
                },
                "selection_iptables_3": {
                    "CommandLine|contains|all": [
                        "iptables",
                        "stop"
                    ],
                    "Image|endswith": "/chkconfig"
                },
                "selection_iptables_4": {
                    "CommandLine|contains|all": [
                        "ip6tables",
                        "stop"
                    ],
                    "Image|endswith": "/chkconfig"
                },
                "selection_selinux": {
                    "CommandLine|contains": "0",
                    "Image|endswith": "/setenforce"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "e3a8a052-111f-4606-9aee-f28ebeb76776",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Disabling Security Tools"
        },
        {
            "author": "Cedric Maurugeon",
            "date": "2023/09/04",
            "description": "Detects changes to the ESXi syslog configuration via \"esxcli\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": " set",
                    "CommandLine|contains|all": [
                        "system",
                        "syslog",
                        "config"
                    ],
                    "Image|endswith": "/esxcli"
                }
            },
            "falsepositives": [
                "Legitimate administrative activities"
            ],
            "id": "38eb1dbb-011f-40b1-a126-cf03a0210563",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://support.solarwinds.com/SuccessCenter/s/article/Configure-ESXi-Syslog-to-LEM?language=en_US",
                "https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_system.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1562.003"
            ],
            "title": "ESXi Syslog Configuration Change Via ESXCLI"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/01/18",
            "description": "Detects attempts to force stop the ufw using ufw-init",
            "detection": {
                "condition": "1 of selection_*",
                "selection_init": {
                    "CommandLine|contains|all": [
                        "-ufw-init",
                        "force-stop"
                    ]
                },
                "selection_ufw": {
                    "CommandLine|contains|all": [
                        "ufw",
                        "disable"
                    ]
                }
            },
            "falsepositives": [
                "Network administrators"
            ],
            "id": "84c9e83c-599a-458a-a0cb-0ecce44e807a",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.blackberry.com/",
                "https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144"
            ],
            "status": "test",
            "title": "Ufw Force Stop Using Ufw-Init",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "\u00d6mer G\u00fcnal, Alejandro Ortuno, oscd.community",
            "date": "2020/06/17",
            "description": "Detects disabling security tools",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "stopping iptables",
                    "stopping ip6tables",
                    "stopping firewalld",
                    "stopping cbdaemon",
                    "stopping falcon-sensor"
                ]
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "49f5dfc1-f92e-4d34-96fa-feba3f6acf36",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "syslog"
            },
            "modified": "2022/11/26",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "e3a8a052-111f-4606-9aee-f28ebeb76776"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ],
            "title": "Disabling Security Tools - Builtin"
        },
        {
            "author": "IAI",
            "date": "2023/03/06",
            "description": "Detects the removal of system firewall rules. Adversaries may only delete or modify a specific system firewall rule to bypass controls limiting network usage or access.\nDetection rules that match only on the disabling of firewalls will miss this.\n",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "a0": "iptables",
                    "a1|contains": "DROP",
                    "type": "EXECVE"
                },
                "selection2": {
                    "a0": "firewall-cmd",
                    "a1|contains": "remove",
                    "type": "EXECVE"
                },
                "selection3": {
                    "a0": "ufw",
                    "a1|contains": "delete",
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Legitimate admin activity"
            ],
            "id": "323ff3f5-0013-4847-bbd4-250b5edb62cc",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "references": [
                "https://www.trendmicro.com/en_us/research/22/c/cyclops-blink-sets-sights-on-asus-routers--.html",
                "https://blog.aquasec.com/container-security-tnt-container-attack"
            ],
            "related": [
                {
                    "id": "53059bc0-1472-438b-956a-7508a94a91f0",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.t1562.004",
                "attack.defense_evasion"
            ],
            "title": "Modify System Firewall"
        },
        {
            "author": "Mikhail Larin, oscd.community",
            "date": "2019/10/25",
            "description": "Detect changes of syslog daemons configuration files",
            "detection": {
                "condition": "selection",
                "selection": {
                    "name": [
                        "/etc/syslog.conf",
                        "/etc/rsyslog.conf",
                        "/etc/syslog-ng/syslog-ng.conf"
                    ],
                    "type": "PATH"
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "fields": [
                "exe",
                "comm",
                "key"
            ],
            "id": "c830f15d-6f6e-430f-8074-6f73d6807841",
            "level": "high",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "self experience"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.006"
            ],
            "title": "Logging Configuration Changes on Linux Host"
        },
        {
            "author": "Rafal Piasecki",
            "date": "2022/08/10",
            "description": "All TCP traffic on particular port from attacker is routed to different port. ex. '/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport 22 -j REDIRECT --to-ports 42392'\nThe traffic looks like encrypted SSH communications going to TCP port 22, but in reality is being directed to the shell port once it hits the iptables rule for the attacker host only.\n",
            "detection": {
                "cmd": {
                    "a0|endswith": "iptables",
                    "a1": "-t",
                    "type": "EXECVE",
                    "a2": "nat"
                },
                "condition": "cmd and keywords",
                "keywords": [
                    "--to-ports 42",
                    "--to-ports 43"
                ]
            },
            "falsepositives": [
                "Legitimate ports redirect"
            ],
            "id": "70b4156e-50fc-4523-aa50-c9dddf1993fc",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "references": [
                "https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/",
                "https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor"
            ],
            "status": "test",
            "title": "Bpfdoor TCP Ports Redirect",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.004"
            ]
        },
        {
            "author": "Mikhail Larin, oscd.community",
            "date": "2019/10/25",
            "description": "Detect changes in auditd configuration files",
            "detection": {
                "condition": "selection",
                "selection": {
                    "name": [
                        "/etc/audit/*",
                        "/etc/libaudit.conf",
                        "/etc/audisp/*"
                    ],
                    "type": "PATH"
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "fields": [
                "exe",
                "comm",
                "key"
            ],
            "id": "977ef627-4539-4875-adf4-ed8f780c4922",
            "level": "high",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://github.com/Neo23x0/auditd/blob/master/audit.rules",
                "Self Experience"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.006"
            ],
            "title": "Auditing Configuration Changes on Linux Host"
        },
        {
            "id": "53059bc0-1472-438b-956a-7508a94a91f0",
            "author": "Pawel Mazur",
            "date": "2022/01/22",
            "description": "Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "type": "SERVICE_STOP",
                    "unit": [
                        "firewalld",
                        "iptables",
                        "ufw"
                    ]
                }
            },
            "falsepositives": [
                "Admin activity"
            ],
            "level": "high",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md",
                "https://firewalld.org/documentation/man-pages/firewall-cmd.html"
            ],
            "status": "test",
            "title": "Disable System Firewall",
            "tags": [
                "attack.t1562.004",
                "attack.defense_evasion"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "Office 365",
        "IaaS",
        "Linux",
        "macOS",
        "Containers",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "x_mitre_detection": "Monitor processes and command-line arguments to see if security tools or logging services are killed or stop running. Monitor Registry edits for modifications to services and startup programs that correspond to security tools.  Lack of log events may be suspicious.\n\nMonitor environment variables and APIs that can be leveraged to disable security measures.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.5",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "File: File Modification",
        "Cloud Service: Cloud Service Disable",
        "Firewall: Firewall Rule Modification",
        "Command: Command Execution",
        "Script: Script Execution",
        "Process: Process Modification",
        "Windows Registry: Windows Registry Key Deletion",
        "Process: Process Termination",
        "Service: Service Metadata",
        "Cloud Service: Cloud Service Modification",
        "User Account: User Account Modification",
        "File: File Deletion",
        "Sensor Health: Host Status",
        "Process: OS API Execution",
        "Process: Process Creation",
        "Windows Registry: Windows Registry Key Modification",
        "Driver: Driver Load",
        "Firewall: Firewall Disable"
    ],
    "x_mitre_permissions_required": []
}