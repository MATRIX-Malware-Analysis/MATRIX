{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--b677b14c-21eb-48c9-9a7f-41e0b28049a8",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.749531Z",
    "name": "Masquerading: Rename System Utilities",
    "description": "Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing. [1] It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename rundll32.exe). [2] An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. [3]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1036/003",
            "external_id": "T1036/003"
        },
        {
            "source_name": "CAPEC 165",
            "external_id": "malware-behavior--fdb4528a-3200-40e1-9f04-2b4537d804a1"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Micah Babinski, @micahbabinski",
            "date": "2023/05/08",
            "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_lower": {
                    "TargetFilename|contains": [
                        "\u0430",
                        "\u0435",
                        "\u043e",
                        "\u0440",
                        "\u0441",
                        "\u0445",
                        "\u0455",
                        "\u0456",
                        "\u04cf",
                        "\u0458",
                        "\u04bb",
                        "\u0501",
                        "\u051b",
                        "\u051d",
                        "\u03bf"
                    ]
                },
                "selection_upper": {
                    "TargetFilename|contains": [
                        "\u0410",
                        "\u0412",
                        "\u0415",
                        "\u041a",
                        "\u041c",
                        "\u041d",
                        "\u041e",
                        "\u0420",
                        "\u0421",
                        "\u0422",
                        "\u0425",
                        "\u0405",
                        "\u0406",
                        "\u0408",
                        "\u04ae",
                        "\u04c0",
                        "\u050c",
                        "\u051a",
                        "\u051c",
                        "\u0391",
                        "\u0392",
                        "\u0395",
                        "\u0396",
                        "\u0397",
                        "\u0399",
                        "\u039a",
                        "\u039c",
                        "\u039d",
                        "\u039f",
                        "\u03a1",
                        "\u03a4",
                        "\u03a5",
                        "\u03a7"
                    ]
                }
            },
            "falsepositives": [
                "File names with legitimate Cyrillic text. Will likely require tuning (or not be usable) in countries where these alphabets are in use."
            ],
            "id": "4f1707b1-b50b-45b4-b5a2-3978b5a5d0d6",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish",
                "http://www.irongeek.com/homoglyph-attack-generator.php"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1036.003"
            ],
            "title": "Potential Homoglyph Attack Using Lookalike Characters in Filename"
        },
        {
            "author": "Matthew Green @mgreen27, Ecco, James Pemberton @4A616D6573, oscd.community, Andreas Hunkeler (@Karneades)",
            "date": "2019/06/15",
            "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\conhost.exe",
                        "\\7z.exe",
                        "\\WinRAR.exe",
                        "\\wevtutil.exe",
                        "\\net.exe",
                        "\\net1.exe",
                        "\\netsh.exe",
                        "\\InstallUtil.exe"
                    ]
                },
                "selection": {
                    "OriginalFileName": [
                        "Cmd.Exe",
                        "CONHOST.EXE",
                        "7z.exe",
                        "WinRAR.exe",
                        "wevtutil.exe",
                        "net.exe",
                        "net1.exe",
                        "netsh.exe",
                        "InstallUtil.exe"
                    ]
                }
            },
            "falsepositives": [
                "Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist"
            ],
            "id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/18",
            "status": "test",
            "references": [
                "https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html",
                "https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1036.003/T1036.003.md#atomic-test-1---masquerading-as-windows-lsass-process"
            ],
            "related": [
                {
                    "id": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Potential Defense Evasion Via Binary Rename"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file to a suspicious target folder",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_folder": {
                    "CommandLine|contains": [
                        ":\\Perflogs",
                        ":\\ProgramData\\",
                        ":\\Temp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\",
                        "\\Desktop\\",
                        "%ProgramData%",
                        "%public%"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2ddef153-167b-4e89-86b6-757a9e65dcac",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/30",
            "status": "test",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File Download Via Bitsadmin To A Suspicious Target Folder"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file using an URL that contains an IP",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "filter_seven_zip": {
                    "CommandLine|contains": "://7-"
                },
                "selection_extension": {
                    "CommandLine|contains": [
                        "://1",
                        "://2",
                        "://3",
                        "://4",
                        "://5",
                        "://6",
                        "://7",
                        "://8",
                        "://9"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "99c840f2-2012-46fd-9141-c761987550ef",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
            ],
            "modified": "2023/02/15",
            "related": [
                {
                    "id": "90f138c1-f578-4ac3-8c49-eecfd847c8b7",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "Suspicious Download From Direct IP Via Bitsadmin"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/29",
            "description": "Detects a suspicious copy operation that tries to copy a known LOLBIN from system (System32, SysWOW64, WinSxS) directories to another on disk in order to bypass detections based on locations.\n",
            "detection": {
                "condition": "1 of selection_tools_* and all of selection_target_*",
                "selection_target_lolbin": {
                    "CommandLine|contains": [
                        "\\bitsadmin.exe",
                        "\\calc.exe",
                        "\\certutil.exe",
                        "\\cmdl32.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\rundll32.exe",
                        "\\wscript.exe"
                    ]
                },
                "selection_target_path": {
                    "CommandLine|contains": [
                        "\\System32",
                        "\\SysWOW64",
                        "\\WinSxS"
                    ]
                },
                "selection_tools_cmd": {
                    "CommandLine|contains": "copy ",
                    "Image|endswith": "\\cmd.exe"
                },
                "selection_tools_other": [
                    {
                        "Image|endswith": [
                            "\\robocopy.exe",
                            "\\xcopy.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "robocopy.exe",
                            "XCOPY.EXE"
                        ]
                    }
                ],
                "selection_tools_pwsh": {
                    "CommandLine|contains": [
                        "copy-item",
                        " copy ",
                        "cpi ",
                        " cp "
                    ],
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f5d19838-41b5-476c-98d8-ba8af4929ee2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120",
                "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
                "https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/"
            ],
            "related": [
                {
                    "id": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
                    "type": "derived"
                }
            ],
            "status": "test",
            "title": "LOL-Binary Copied From System Directory",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file to uncommon target folder",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_folder": {
                    "CommandLine|contains": [
                        "%AppData%",
                        "%temp%",
                        "%tmp%",
                        "\\AppData\\Local\\",
                        "C:\\Windows\\Temp\\"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "6e30c82f-a9f8-4aab-b79c-7c12bce6f248",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
            ],
            "modified": "2023/02/15",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File Download Via Bitsadmin To An Uncommon Target Folder"
        },
        {
            "author": "Max Altgelt (Nextron Systems)",
            "date": "2022/06/02",
            "description": "Detects process creation with a renamed BrowserCore.exe (used to extract Azure tokens)",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_realbrowsercore": {
                    "Image|endswith": "\\BrowserCore.exe"
                },
                "selection": {
                    "OriginalFileName": "BrowserCore.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8a4519e8-e64a-40b6-ae85-ba8ad2177559",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "status": "test",
            "references": [
                "https://twitter.com/mariuszbit/status/1531631015139102720"
            ],
            "tags": [
                "attack.t1528",
                "attack.t1036.003"
            ],
            "title": "Renamed BrowserCore.EXE Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file from a suspicious domain",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_domain": {
                    "CommandLine|contains": [
                        ".githubusercontent.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cdn.discordapp.com/attachments/",
                        "ddns.net",
                        "dl.dropboxusercontent.com",
                        "ghostbin.co",
                        "glitch.me",
                        "gofile.io",
                        "hastebin.com",
                        "mediafire.com",
                        "mega.nz",
                        "onrender.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "privatlab.com",
                        "privatlab.net",
                        "send.exploit.in",
                        "sendspace.com",
                        "storage.googleapis.com",
                        "storjshare.io",
                        "supabase.co",
                        "temp.sh",
                        "transfer.sh",
                        "ufile.io"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Some legitimate apps use this, but limited."
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/02/09",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
                "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
                "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "Suspicious Download From File-Sharing Website Via Bitsadmin"
        },
        {
            "id": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
            "author": "Matthew Green - @mgreen27, Florian Roth (Nextron Systems), frack113",
            "date": "2019/06/15",
            "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": [
                        "\\certutil.exe",
                        "\\cmstp.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\msiexec.exe",
                        "\\powershell_ise.exe",
                        "\\powershell.exe",
                        "\\psexec.exe",
                        "\\psexec64.exe",
                        "\\PSEXESVC.exe",
                        "\\pwsh.exe",
                        "\\reg.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\wermgr.exe",
                        "\\wmic.exe",
                        "\\wscript.exe"
                    ]
                },
                "selection": [
                    {
                        "Description": "Execute processes remotely"
                    },
                    {
                        "Product": "Sysinternals PsExec"
                    },
                    {
                        "Description|startswith": [
                            "Windows PowerShell",
                            "pwsh"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "certutil.exe",
                            "cmstp.exe",
                            "cscript.exe",
                            "mshta.exe",
                            "msiexec.exe",
                            "powershell_ise.exe",
                            "powershell.exe",
                            "psexec.c",
                            "psexec.exe",
                            "psexesvc.exe",
                            "pwsh.dll",
                            "reg.exe",
                            "regsvr32.exe",
                            "rundll32.exe",
                            "WerMgr",
                            "wmic.exe",
                            "wscript.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist",
                "PsExec installed via Windows Store doesn't contain original filename field (False negative)"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/08/23",
            "status": "test",
            "references": [
                "https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html",
                "https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html",
                "https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks",
                "https://twitter.com/christophetd/status/1164506034720952320",
                "https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142"
                },
                {
                    "id": "2569ed8c-1147-498a-9b8c-2ad3656b10ed",
                    "type": "derived"
                },
                {
                    "id": "a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2",
                    "type": "obsoletes"
                },
                {
                    "id": "d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20",
                    "type": "obsoletes"
                },
                {
                    "id": "d4d2574f-ac17-4d9e-b986-aeeae0dc8fe2",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003",
                "car.2013-05-009"
            ],
            "title": "Potential Defense Evasion Via Rename Of Highly Relevant Binaries"
        },
        {
            "author": "pH-T (Nextron Systems)",
            "date": "2022/06/03",
            "description": "Detects the execution of a renamed \"Msdt.exe\" binary",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": "\\msdt.exe"
                },
                "selection": {
                    "OriginalFileName": "msdt.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "bd1c6866-65fc-44b2-be51-5588fcff82b9",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Msdt/"
            ],
            "title": "Renamed Msdt.EXE Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "id": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
            "author": "Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/07/03",
            "description": "Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\nOften used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\n",
            "detection": {
                "condition": "1 of selection_* and target",
                "selection_cmd": {
                    "CommandLine|contains": "copy ",
                    "Image|endswith": "\\cmd.exe"
                },
                "selection_other": [
                    {
                        "Image|endswith": [
                            "\\robocopy.exe",
                            "\\xcopy.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "robocopy.exe",
                            "XCOPY.EXE"
                        ]
                    }
                ],
                "selection_pwsh": {
                    "CommandLine|contains": [
                        "copy-item",
                        " copy ",
                        "cpi ",
                        " cp "
                    ],
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                },
                "target": {
                    "CommandLine|contains": [
                        "\\System32",
                        "\\SysWOW64",
                        "\\WinSxS"
                    ]
                }
            },
            "falsepositives": [
                "Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)",
                "When cmd.exe and xcopy.exe are called directly",
                "When the command contains the keywords but not in the correct order"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120",
                "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
                "https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/"
            ],
            "modified": "2023/08/29",
            "status": "test",
            "related": [
                {
                    "id": "855bc8b5-2ae8-402e-a9ed-b889e6df1900",
                    "type": "derived"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Suspicious Copy From or To System Directory"
        },
        {
            "author": "Micah Babinski",
            "date": "2022/12/11",
            "description": "Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion.",
            "detection": {
                "condition": "all of selection_*",
                "selection_attributes": {
                    "CommandLine|contains": [
                        "OriginalFileName",
                        "CompanyName",
                        "FileDescription",
                        "ProductName",
                        "ProductVersion",
                        "LegalCopyright"
                    ]
                },
                "selection_flags": {
                    "CommandLine|contains": "--set-"
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\rcedit-x64.exe",
                            "\\rcedit-x86.exe"
                        ]
                    },
                    {
                        "Description": "Edit resources of exe"
                    },
                    {
                        "Product": "rcedit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of the tool by administrators or users to update metadata of a binary"
            ],
            "id": "0c92f2e6-f08f-4b73-9216-ecb0ca634689",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "status": "test",
            "references": [
                "https://security.stackexchange.com/questions/210843/is-it-possible-to-change-original-filename-of-an-exe",
                "https://www.virustotal.com/gui/file/02e8e8c5d430d8b768980f517b62d7792d690982b9ba0f7e04163cbc1a6e7915",
                "https://github.com/electron/rcedit"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003",
                "attack.t1036",
                "attack.t1027.005",
                "attack.t1027"
            ],
            "title": "PUA - Potential PE Metadata Tamper Using Rcedit"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file with a suspicious extension",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_extension": {
                    "CommandLine|contains": [
                        ".7z",
                        ".asax",
                        ".ashx",
                        ".asmx",
                        ".asp",
                        ".aspx",
                        ".bat",
                        ".cfm",
                        ".cgi",
                        ".chm",
                        ".cmd",
                        ".dll",
                        ".gif",
                        ".jpeg",
                        ".jpg",
                        ".jsp",
                        ".jspx",
                        ".log",
                        ".png",
                        ".ps1",
                        ".psm1",
                        ".rar",
                        ".scf",
                        ".sct",
                        ".txt",
                        ".vbe",
                        ".vbs",
                        ".war",
                        ".wsf",
                        ".wsh",
                        ".xll",
                        ".zip"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5b80a791-ad9b-4b75-bcc1-ad4e1e89c200",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/30",
            "status": "test",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File With Suspicious Extension Downloaded Via Bitsadmin"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/11/18",
            "description": "Detects the execution of a renamed ProcDump executable.\nThis often done by attackers or malware in order to evade defensive mechanisms.\n",
            "detection": {
                "condition": "(selection_ofn or all of selection_cli_*) and not 1 of filter_main_*",
                "filter_main_known_names": {
                    "Image|endswith": [
                        "\\procdump.exe",
                        "\\procdump64.exe"
                    ]
                },
                "selection_cli_dump_flag": {
                    "CommandLine|contains|windash": [
                        " -ma ",
                        " -mp "
                    ]
                },
                "selection_cli_eula_flag": {
                    "CommandLine|contains|windash": " /accepteula"
                },
                "selection_ofn": {
                    "OriginalFileName": "procdump"
                }
            },
            "falsepositives": [
                "Procdump illegally bundled with legitimate software.",
                "Administrators who rename binaries (should be investigated)."
            ],
            "id": "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/25",
            "status": "test",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
            ],
            "related": [
                {
                    "id": "03795938-1387-481b-9f4c-3f6241e604fe",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Renamed ProcDump Execution"
        },
        {
            "author": "vburov",
            "date": "2019/02/23",
            "description": "Detect suspicious parent processes of well-known Windows processes",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_msmpeng": {
                    "ParentImage|contains": [
                        "\\Windows Defender\\",
                        "\\Microsoft Security Client\\"
                    ],
                    "ParentImage|endswith": "\\MsMpEng.exe"
                },
                "filter_null": [
                    {
                        "ParentImage": null
                    },
                    {
                        "ParentImage": "-"
                    }
                ],
                "filter_sys": [
                    {
                        "ParentImage|endswith": [
                            "\\SavService.exe",
                            "\\ngen.exe"
                        ]
                    },
                    {
                        "ParentImage|contains": [
                            "\\System32\\",
                            "\\SysWOW64\\"
                        ]
                    }
                ],
                "selection": {
                    "Image|endswith": [
                        "\\svchost.exe",
                        "\\taskhost.exe",
                        "\\lsm.exe",
                        "\\lsass.exe",
                        "\\services.exe",
                        "\\lsaiso.exe",
                        "\\csrss.exe",
                        "\\wininit.exe",
                        "\\winlogon.exe"
                    ]
                }
            },
            "falsepositives": [
                "Some security products seem to spawn these"
            ],
            "id": "96036718-71cc-4027-a538-d1587e0006a7",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/02/14",
            "status": "test",
            "references": [
                "https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2",
                "https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/",
                "https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003",
                "attack.t1036.005"
            ],
            "title": "Windows Processes Suspicious Parent Directory"
        },
        {
            "author": "Micah Babinski, @micahbabinski",
            "date": "2023/05/07",
            "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_lower": {
                    "CommandLine|contains": [
                        "\u0430",
                        "\u0435",
                        "\u043e",
                        "\u0440",
                        "\u0441",
                        "\u0445",
                        "\u0455",
                        "\u0456",
                        "\u04cf",
                        "\u0458",
                        "\u04bb",
                        "\u0501",
                        "\u051b",
                        "\u051d",
                        "\u03bf"
                    ]
                },
                "selection_upper": {
                    "CommandLine|contains": [
                        "\u0410",
                        "\u0412",
                        "\u0415",
                        "\u041a",
                        "\u041c",
                        "\u041d",
                        "\u041e",
                        "\u0420",
                        "\u0421",
                        "\u0422",
                        "\u0425",
                        "\u0405",
                        "\u0406",
                        "\u0408",
                        "\u04ae",
                        "\u04c0",
                        "\u050c",
                        "\u051a",
                        "\u051c",
                        "\u0391",
                        "\u0392",
                        "\u0395",
                        "\u0396",
                        "\u0397",
                        "\u0399",
                        "\u039a",
                        "\u039c",
                        "\u039d",
                        "\u039f",
                        "\u03a1",
                        "\u03a4",
                        "\u03a5",
                        "\u03a7"
                    ]
                }
            },
            "falsepositives": [
                "Commandlines with legitimate Cyrillic text; will likely require tuning (or not be usable) in countries where these alphabets are in use."
            ],
            "id": "32e280f1-8ad4-46ef-9e80-910657611fbc",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish",
                "http://www.irongeek.com/homoglyph-attack-generator.php"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1036.003"
            ],
            "title": "Potential Homoglyph Attack Using Lookalike Characters"
        },
        {
            "author": "Markus Neis, Swisscom",
            "date": "2019/06/04",
            "description": "Detects the execution of a renamed \"jusched.exe\" as seen used by the cobalt group",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": "\\jusched.exe"
                },
                "selection": {
                    "Description": [
                        "Java Update Scheduler",
                        "Java(TM) Update Scheduler"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "edd8a48c-1b9f-4ba1-83aa-490338cd1ccb",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "status": "test",
            "references": [
                "https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf"
            ],
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Renamed Jusched.EXE Execution"
        },
        {
            "author": "Michael Haag, FPT.EagleEye",
            "date": "2017/03/09",
            "description": "Detects usage of bitsadmin downloading a file",
            "detection": {
                "condition": "selection_img and (selection_cmd or all of selection_cli_*)",
                "selection_cli_1": {
                    "CommandLine|contains": [
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains": "http"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ],
                "selection_cmd": {
                    "CommandLine|contains": " /transfer "
                }
            },
            "falsepositives": [
                "Some legitimate apps use this, but limited."
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
            ],
            "modified": "2023/02/15",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File Download Via Bitsadmin"
        },
        {
            "author": "frack113",
            "date": "2022/01/15",
            "description": "Powershell use PassThru option to start in background",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Start-Process",
                        "-PassThru ",
                        "-FilePath "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "0718cd72-f316-4aa2-988f-838ea8533277",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.003/T1036.003.md",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Start-Process?view=powershell-5.1&viewFallbackFrom=powershell-7"
            ],
            "status": "test",
            "title": "Suspicious Start-Process PassThru",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "X__Junior",
            "date": "2023/05/18",
            "description": "Detects potential WerFault \"ReflectDebugger\" registry value abuse for persistence.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "SetValue",
                    "TargetObject|endswith": "\\Microsoft\\Windows\\Windows Error Reporting\\Hangs\\ReflectDebugger"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0cf2e1c6-8d10-4273-8059-738778f981ad",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html",
                "https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/"
            ],
            "related": [
                {
                    "id": "fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd",
                    "type": "derived"
                }
            ],
            "status": "test",
            "title": "Potential WerFault ReflectDebugger Registry Value Abuse",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "frack113",
            "date": "2023/01/27",
            "description": "Detect changes to the \"PendingFileRenameOperations\" registry key from uncommon or suspicious images locations to stage currently used files for rename or deletion after reboot.\n",
            "detection": {
                "condition": "selection_main and 1 of selection_susp_*",
                "selection_main": {
                    "EventType": "SetValue",
                    "TargetObject|contains": "\\CurrentControlSet\\Control\\Session Manager\\PendingFileRenameOperations"
                },
                "selection_susp_images": {
                    "Image|endswith": [
                        "\\reg.exe",
                        "\\regedit.exe"
                    ]
                },
                "selection_susp_paths": {
                    "Image|contains": [
                        "\\AppData\\Local\\Temp\\",
                        "\\Users\\Public\\"
                    ]
                }
            },
            "falsepositives": [
                "Installers and updaters may set currently in use files for rename or deletion after a reboot."
            ],
            "id": "4eec988f-7bf0-49f1-8675-1e6a510b3a2a",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/07/03",
            "status": "test",
            "references": [
                "https://any.run/report/3ecd4763ffc944fdc67a9027e459cd4f448b1a8d1b36147977afaf86bbf2a261/64b0ba45-e7ce-423b-9a1d-5b4ea59521e6",
                "https://devblogs.microsoft.com/scripting/determine-pending-reboot-statuspowershell-style-part-1/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc960241(v=technet.10)?redirectedfrom=MSDN",
                "https://www.trendmicro.com/en_us/research/21/j/purplefox-adds-new-backdoor-that-uses-websockets.html",
                "https://www.trendmicro.com/en_us/research/19/i/purple-fox-fileless-malware-with-rookit-component-delivered-by-rig-exploit-kit-now-abuses-powershell.html"
            ],
            "title": "Potential PendingFileRenameOperations Tampering",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "Timur Zinniatullin, oscd.community",
            "date": "2019/10/21",
            "description": "Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.\nSeveral different variations of this technique have been observed.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0": "cp",
                    "a1": "/bin/sh",
                    "a2|endswith": "/crond",
                    "type": "execve"
                }
            },
            "id": "9d4548fa-bba0-4e88-bd66-5d5bf516cda0",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "level": "medium",
            "modified": "2023/08/22",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/8a82e9b66a5b4f4bc5b91089e9f24e0544f20ad7/atomics/T1036.003/T1036.003.md#atomic-test-2---masquerading-as-linux-crond-process"
            ],
            "status": "test",
            "title": "Masquerading as Linux Crond Process",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        }
    ]
}