{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c46fa196-2f41-4974-88c9-f69fdcb22baf",
    "created": "2024-08-13T14:46:36.681488Z",
    "modified": "2024-08-13T14:46:36.681488Z",
    "name": "System Location Discovery",
    "description": "An adversary collects information about the target system in an attempt to identify the system's geographical location.\n            Information gathered could include keyboard layout, system language, and timezone. This information may benefit an adversary in confirming the desired target and/or tailoring further attacks.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/694.html",
            "external_id": "694"
        },
        {
            "source_name": "CWE",
            "external_id": "497"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[System Locale Information Discovery] The adversary examines system information from various sources such as registry and native API functions and correlates the gathered information to infer the geographical location of the target system",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Registry Query: Query the registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\ContentIndex\\Language\\Language_Dialect on Windows to obtain system language, Computer\\HKEY_CURRENT_USER\\Keyboard Layout\\Preload to obtain the hexadecimal language IDs of the current user's preloaded keyboard layouts, and Computer\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation to obtain the system timezone configuration",
                "Native API Requests: Parse the outputs of Windows API functions GetTimeZoneInformation, GetUserDefaultUILanguage, GetSystemDefaultUILanguage, GetKeyboardLayoutList and GetUserDefaultLangID to obtain information about languages, keyboard layouts, and timezones installed on the system or on macOS or Linux systems, query locale to obtain the $LANG environment variable and view keyboard layout information or use timeanddatectl status to show the system clock settings.",
                "Read Configuration Files: For macOS and Linux-based systems, view the /etc/vconsole.conf file to get information about the keyboard mapping and console font."
            ]
        }
    ],
    "x_mitre_impact": "Very Low",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "To reduce the amount of information gathered, one could disable various geolocation features of the operating system not required for system operation."
        }
    ]
}