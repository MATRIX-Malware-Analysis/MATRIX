{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--006b5263-0d4a-4f3d-af68-df0b44e8bbac",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.563243Z",
    "name": "Browser Information Discovery",
    "description": "Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure.[1]Browser information may also highlight additional targets after an adversary has access to valid credentials, especially Credentials In Files associated with logins cached by a browser.Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., %APPDATA%/Google/Chrome).[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1217",
            "external_id": "T1217"
        },
        {
            "source_name": "CAPEC 169",
            "external_id": "malware-behavior--cc974994-1ed1-4e9c-a001-33a87d4ef3fb"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1217",
            "external_id": "T1217"
        },
        {
            "source_name": "Chrome Roaming Profiles",
            "description": "Chrome Enterprise and Education Help. (n.d.). Use Chrome Browser with Roaming User Profiles. Retrieved March 28, 2023.",
            "url": "https://support.google.com/chrome/a/answer/7349337"
        },
        {
            "source_name": "Kaspersky Autofill",
            "description": "Golubev, S. (n.d.). How malware steals autofill data from browsers. Retrieved March 28, 2023.",
            "url": "https://www.kaspersky.com/blog/browser-data-theft/27871/"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113",
            "date": "2021/12/13",
            "description": "Detects usage of the \"dir\" command part of Widows CMD with the \"/S\" command line flag in order to enumerate files in a specified directory and all subdirectories.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|windash": "dir*-s"
                },
                "selection_cmd": [
                    {
                        "Image|endswith": "\\cmd.exe"
                    },
                    {
                        "OriginalFileName": "Cmd.Exe"
                    }
                ]
            },
            "falsepositives": [
                "Likely"
            ],
            "id": "7c9340a9-e2ee-4e43-94c5-c54ebbea1006",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/04/14",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1217"
            ],
            "title": "File And SubFolder Enumeration Via Dir Command"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/12/13",
            "description": "Adversaries may enumerate browser bookmarks to learn more about compromised hosts.\nBrowser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about\ninternal network resources such as servers, tools/dashboards, or other related infrastructure.\n",
            "detection": {
                "condition": "all of where_*",
                "where_exe": [
                    {
                        "Image|endswith": "\\where.exe"
                    },
                    {
                        "OriginalFileName": "where.exe"
                    }
                ],
                "where_opt": {
                    "CommandLine|contains": [
                        "places.sqlite",
                        "cookies.sqlite",
                        "formhistory.sqlite",
                        "logins.json",
                        "key4.db",
                        "key3.db",
                        "sessionstore.jsonlz4",
                        "History",
                        "Bookmarks",
                        "Cookies",
                        "Login Data"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "725a9768-0f5e-4cb3-aec2-bc5719c6831a",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/06/29",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1217"
            ],
            "title": "Suspicious Where Execution"
        },
        {
            "author": "frack113",
            "date": "2021/12/13",
            "description": "Adversaries may enumerate browser bookmarks to learn more about compromised hosts.\nBrowser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about\ninternal network resources such as servers, tools/dashboards, or other related infrastructure.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Get-ChildItem",
                        " -Recurse ",
                        " -Path ",
                        " -Filter Bookmarks",
                        " -ErrorAction SilentlyContinue",
                        " -Force"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e0565f5d-d420-4e02-8a68-ac00d864f9cf",
            "level": "low",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1217"
            ],
            "title": "Automated Collection Bookmarks Using Get-ChildItem PowerShell"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "Windows",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Mike Kemmerer",
        "Manikantan Srinivasan, NEC Corporation India",
        "Yinon Engelsman, Talon Cyber Security",
        "Yonatan Gotlib, Talon Cyber Security"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "discovery"
        }
    ],
    "x_mitre_detection": "Monitor processes and command-line arguments for actions that could be taken to gather browser bookmark information. Remote access tools with built-in features may interact directly using APIs to gather information. Information may also be acquired through system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nSystem and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.0",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Command: Command Execution",
        "File: File Access"
    ],
    "x_mitre_permissions_required": []
}