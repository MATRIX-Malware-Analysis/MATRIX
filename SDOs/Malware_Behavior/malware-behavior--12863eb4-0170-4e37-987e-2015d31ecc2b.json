{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--12863eb4-0170-4e37-987e-2015d31ecc2b",
    "created": "2024-08-13T14:46:37.0407Z",
    "modified": "2024-08-13T14:46:45.631817Z",
    "name": "Dead Drop Resolver: ",
    "description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1102/001",
            "external_id": "T1102/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/04/15",
            "description": "Detects downloads from PwnDrp web servers developed for red team testing and most likely also used for criminal activity",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri|contains": "/pwndrop/"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ClientIP",
                "c-uri",
                "c-useragent"
            ],
            "id": "2b1ee7e4-89b6-4739-b7bb-b811b6607e5e",
            "level": "critical",
            "logsource": {
                "category": "proxy"
            },
            "modified": "2021/11/27",
            "references": [
                "https://breakdev.org/pwndrop/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1071.001",
                "attack.t1102.001",
                "attack.t1102.003"
            ],
            "title": "PwnDrp Access"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/12/05",
            "description": "Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri|contains": [
                        ".paste.ee/r/",
                        ".pastebin.com/raw/",
                        ".hastebin.com/raw/",
                        ".ghostbin.co/paste/*/raw/",
                        "pastetext.net/",
                        "pastebin.pl/",
                        "paste.ee/"
                    ]
                }
            },
            "falsepositives": [
                "User activity (e.g. developer that shared and copied code snippets and used the raw link instead of just copy & paste)"
            ],
            "id": "5468045b-4fcc-4d1a-973c-c9c9578edacb",
            "level": "high",
            "modified": "2023/01/19",
            "logsource": {
                "category": "proxy"
            },
            "references": [
                "https://www.virustotal.com/gui/domain/paste.ee/relations"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1071.001",
                "attack.t1102.001",
                "attack.t1102.003",
                "attack.defense_evasion"
            ],
            "title": "Raw Paste Service Access"
        },
        {
            "author": "Sorina Ionescu, X__Junior (Nextron Systems)",
            "date": "2022/08/17",
            "description": "Detects an executable, which is not an internet browser or known application, initiating network connections to legit popular websites, which were seen to be used as dead drop resolvers in previous attacks.\nIn this context attackers leverage known websites such as \"facebook\", \"youtube\", etc. In order to pass through undetected.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_avant": {
                    "Image|endswith": "\\avant.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Avant Browser\\",
                        "C:\\Program Files\\Avant Browser\\"
                    ]
                },
                "filter_main_brave": {
                    "Image|endswith": "\\brave.exe",
                    "Image|startswith": "C:\\Program Files\\BraveSoftware\\"
                },
                "filter_main_chrome": {
                    "Image": [
                        "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                        "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                    ]
                },
                "filter_main_chrome_appdata": {
                    "Image|endswith": "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe",
                    "Image|startswith": "C:\\Users\\"
                },
                "filter_main_defender": {
                    "Image|contains": [
                        "C:\\Program Files\\Windows Defender Advanced Threat Protection\\",
                        "C:\\Program Files\\Windows Defender\\",
                        "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\"
                    ],
                    "Image|endswith": [
                        "\\MsMpEng.exe",
                        "\\MsSense.exe"
                    ]
                },
                "filter_main_discord": {
                    "DestinationHostname|endswith": [
                        "discord.com",
                        "cdn.discordapp.com"
                    ],
                    "Image|contains": "\\AppData\\Local\\Discord\\",
                    "Image|endswith": "\\Discord.exe"
                },
                "filter_main_dropbox": {
                    "DestinationHostname|endswith": "dropbox.com",
                    "Image|endswith": [
                        "\\Dropbox.exe",
                        "\\DropboxInstaller.exe"
                    ],
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Dropbox\\Client\\",
                        "C:\\Program Files\\Dropbox\\Client\\"
                    ]
                },
                "filter_main_edge_1": [
                    {
                        "Image|startswith": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\"
                    },
                    {
                        "Image|endswith": "\\WindowsApps\\MicrosoftEdge.exe"
                    },
                    {
                        "Image": [
                            "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                            "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                        ]
                    }
                ],
                "filter_main_edge_2": {
                    "Image|endswith": [
                        "\\msedge.exe",
                        "\\msedgewebview2.exe"
                    ],
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                        "C:\\Program Files\\Microsoft\\EdgeCore\\"
                    ]
                },
                "filter_main_empty": {
                    "Image": ""
                },
                "filter_main_falkon": {
                    "Image|endswith": "\\falkon.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Falkon\\",
                        "C:\\Program Files (x86)\\Falkon\\"
                    ]
                },
                "filter_main_firefox": {
                    "Image": [
                        "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                        "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                    ]
                },
                "filter_main_firefox_appdata": {
                    "Image|endswith": "\\AppData\\Local\\Mozilla Firefox\\firefox.exe",
                    "Image|startswith": "C:\\Users\\"
                },
                "filter_main_flock": {
                    "Image|contains": "\\AppData\\Local\\Flock\\",
                    "Image|endswith": "\\Flock.exe"
                },
                "filter_main_googledrive": {
                    "DestinationHostname|endswith": "drive.google.com",
                    "Image|contains": [
                        "C:\\Program Files\\Google\\Drive File Stream\\",
                        "C:\\Program Files (x86)\\Google\\Drive File Stream\\"
                    ],
                    "Image|endswith": "GoogleDriveFS.exe"
                },
                "filter_main_ie": {
                    "Image": [
                        "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                        "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                    ]
                },
                "filter_main_maxthon": {
                    "Image|contains": "\\AppData\\Local\\Maxthon\\",
                    "Image|endswith": "\\maxthon.exe"
                },
                "filter_main_mega": {
                    "DestinationHostname|endswith": [
                        "mega.co.nz",
                        "mega.nz"
                    ],
                    "Image|endswith": [
                        "\\MEGAsync.exe",
                        "\\MEGAsyncSetup32_*RC.exe",
                        "\\MEGAsyncSetup32.exe",
                        "\\MEGAsyncSetup64.exe",
                        "\\MEGAupdater.exe"
                    ]
                },
                "filter_main_midori": {
                    "Image|contains": "\\AppData\\Local\\Programs\\midori-ng\\",
                    "Image|endswith": "\\Midori Next Generation.exe"
                },
                "filter_main_null": {
                    "Image": null
                },
                "filter_main_onedrive": {
                    "DestinationHostname|endswith": "onedrive.com",
                    "Image|contains": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                    "Image|endswith": "\\OneDrive.exe"
                },
                "filter_main_opera": {
                    "Image|contains": "\\AppData\\Local\\Programs\\Opera\\",
                    "Image|endswith": "\\opera.exe"
                },
                "filter_main_phoebe": {
                    "Image|contains": "\\AppData\\Local\\Phoebe\\",
                    "Image|endswith": "\\Phoebe.exe"
                },
                "filter_main_prtg": {
                    "Image|endswith": [
                        "C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe",
                        "C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe"
                    ]
                },
                "filter_main_qtweb": {
                    "Image|endswith": "\\QtWeb.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\QtWeb\\",
                        "C:\\Program Files\\QtWeb\\"
                    ]
                },
                "filter_main_safari": {
                    "Image|contains": [
                        "C:\\Program Files (x86)\\Safari\\",
                        "C:\\Program Files\\Safari\\"
                    ],
                    "Image|endswith": "\\safari.exe"
                },
                "filter_main_seamonkey": {
                    "Image|endswith": "\\seamonkey.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SeaMonkey\\",
                        "C:\\Program Files (x86)\\SeaMonkey\\"
                    ]
                },
                "filter_main_slimbrowser": {
                    "Image|endswith": "\\slimbrowser.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SlimBrowser\\",
                        "C:\\Program Files (x86)\\SlimBrowser\\"
                    ]
                },
                "filter_main_telegram": {
                    "DestinationHostname|endswith": ".t.me",
                    "Image|contains": "\\AppData\\Roaming\\Telegram Desktop\\",
                    "Image|endswith": "\\Telegram.exe"
                },
                "filter_main_vivaldi": {
                    "Image|contains": "\\AppData\\Local\\Vivaldi\\",
                    "Image|endswith": "\\vivaldi.exe"
                },
                "filter_main_whale": {
                    "Image|endswith": "\\whale.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Naver\\Naver Whale\\",
                        "C:\\Program Files (x86)\\Naver\\Naver Whale\\"
                    ]
                },
                "filter_main_whaterfox": {
                    "Image|endswith": "\\Waterfox.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Waterfox\\",
                        "C:\\Program Files (x86)\\Waterfox\\"
                    ]
                },
                "filter_main_whatsapp": {
                    "DestinationHostname|endswith": "facebook.com",
                    "Image|endswith": "\\WhatsApp.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\WindowsApps\\",
                        "C:\\Program Files\\WindowsApps\\"
                    ]
                },
                "selection": {
                    "DestinationHostname|endswith": [
                        ".t.me",
                        "4shared.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cloudflare.com",
                        "ddns.net",
                        "discord.com",
                        "docs.google.com",
                        "drive.google.com",
                        "dropbox.com",
                        "dropmefiles.com",
                        "facebook.com",
                        "feeds.rapidfeeds.com",
                        "fotolog.com",
                        "ghostbin.co/",
                        "githubusercontent.com",
                        "gofile.io",
                        "hastebin.com",
                        "imgur.com",
                        "livejournal.com",
                        "mediafire.com",
                        "mega.co.nz",
                        "mega.nz",
                        "onedrive.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "privatlab.com",
                        "privatlab.net",
                        "reddit.com",
                        "send.exploit.in",
                        "sendspace.com",
                        "steamcommunity.com",
                        "storage.googleapis.com",
                        "technet.microsoft.com",
                        "temp.sh",
                        "transfer.sh",
                        "twitter.com",
                        "ufile.io",
                        "abuse.ch",
                        "vimeo.com",
                        "wetransfer.com",
                        "youtube.com"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "One might need to exclude other internet browsers found in it's network or other applications like ones mentioned above from Microsoft Defender.",
                "Ninite contacting githubusercontent.com"
            ],
            "id": "297ae038-edc2-4b2e-bb3e-7c5fc94dd5c7",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/07/16",
            "references": [
                "https://content.fireeye.com/apt-41/rpt-apt41",
                "https://securelist.com/the-tetrade-brazilian-banking-malware/97779/",
                "https://blog.bushidotoken.net/2021/04/dead-drop-resolvers-espionage-inspired.html",
                "https://github.com/kleiton0x00/RedditC2",
                "https://twitter.com/kleiton0x7e/status/1600567316810551296",
                "https://www.linkedin.com/posts/kleiton-kurti_github-kleiton0x00redditc2-abusing-reddit-activity-7009939662462984192-5DbI/?originalSubdomain=al"
            ],
            "related": [
                {
                    "id": "d7b09985-95a3-44be-8450-b6eadf49833e",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1102",
                "attack.t1102.001"
            ],
            "title": "Potential Dead Drop Resolvers"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/06/24",
            "description": "Detects an initiated network connection by a non browser process on the system to \"azurewebsites.net\". The latter was often used by threat actors as a malware hosting and exfiltration site.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_avant": {
                    "Image|endswith": "\\avant.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Avant Browser\\",
                        "C:\\Program Files\\Avant Browser\\"
                    ]
                },
                "filter_main_brave": {
                    "Image|endswith": "\\brave.exe",
                    "Image|startswith": "C:\\Program Files\\BraveSoftware\\"
                },
                "filter_main_chrome": {
                    "Image": [
                        "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                        "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                    ]
                },
                "filter_main_chrome_appdata": {
                    "Image|endswith": "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe",
                    "Image|startswith": "C:\\Users\\"
                },
                "filter_main_defender": {
                    "Image|contains": [
                        "C:\\Program Files\\Windows Defender Advanced Threat Protection\\",
                        "C:\\Program Files\\Windows Defender\\",
                        "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\"
                    ],
                    "Image|endswith": [
                        "\\MsMpEng.exe",
                        "\\MsSense.exe"
                    ]
                },
                "filter_main_discord": {
                    "Image|contains": "\\AppData\\Local\\Discord\\",
                    "Image|endswith": "\\Discord.exe"
                },
                "filter_main_edge_1": [
                    {
                        "Image|startswith": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\"
                    },
                    {
                        "Image|endswith": "\\WindowsApps\\MicrosoftEdge.exe"
                    },
                    {
                        "Image": [
                            "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                            "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                        ]
                    }
                ],
                "filter_main_edge_2": {
                    "Image|endswith": [
                        "\\msedge.exe",
                        "\\msedgewebview2.exe"
                    ],
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                        "C:\\Program Files\\Microsoft\\EdgeCore\\"
                    ]
                },
                "filter_main_empty": {
                    "Image": ""
                },
                "filter_main_falkon": {
                    "Image|endswith": "\\falkon.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Falkon\\",
                        "C:\\Program Files (x86)\\Falkon\\"
                    ]
                },
                "filter_main_firefox": {
                    "Image": [
                        "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                        "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                    ]
                },
                "filter_main_firefox_appdata": {
                    "Image|endswith": "\\AppData\\Local\\Mozilla Firefox\\firefox.exe",
                    "Image|startswith": "C:\\Users\\"
                },
                "filter_main_flock": {
                    "Image|contains": "\\AppData\\Local\\Flock\\",
                    "Image|endswith": "\\Flock.exe"
                },
                "filter_main_ie": {
                    "Image": [
                        "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                        "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                    ]
                },
                "filter_main_maxthon": {
                    "Image|contains": "\\AppData\\Local\\Maxthon\\",
                    "Image|endswith": "\\maxthon.exe"
                },
                "filter_main_null": {
                    "Image": null
                },
                "filter_main_opera": {
                    "Image|contains": "\\AppData\\Local\\Programs\\Opera\\",
                    "Image|endswith": "\\opera.exe"
                },
                "filter_main_phoebe": {
                    "Image|contains": "\\AppData\\Local\\Phoebe\\",
                    "Image|endswith": "\\Phoebe.exe"
                },
                "filter_main_prtg": {
                    "Image|endswith": [
                        "C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe",
                        "C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe"
                    ]
                },
                "filter_main_qtweb": {
                    "Image|endswith": "\\QtWeb.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\QtWeb\\",
                        "C:\\Program Files\\QtWeb\\"
                    ]
                },
                "filter_main_safari": {
                    "Image|contains": [
                        "C:\\Program Files (x86)\\Safari\\",
                        "C:\\Program Files\\Safari\\"
                    ],
                    "Image|endswith": "\\safari.exe"
                },
                "selection": {
                    "DestinationHostname|endswith": "azurewebsites.net",
                    "Initiated": "true"
                },
                "filter_main_seamonkey": {
                    "Image|endswith": "\\seamonkey.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SeaMonkey\\",
                        "C:\\Program Files (x86)\\SeaMonkey\\"
                    ]
                },
                "filter_main_slimbrowser": {
                    "Image|endswith": "\\slimbrowser.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SlimBrowser\\",
                        "C:\\Program Files (x86)\\SlimBrowser\\"
                    ]
                },
                "filter_main_vivaldi": {
                    "Image|contains": "\\AppData\\Local\\Vivaldi\\",
                    "Image|endswith": "\\vivaldi.exe"
                },
                "filter_main_whale": {
                    "Image|endswith": "\\whale.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Naver\\Naver Whale\\",
                        "C:\\Program Files (x86)\\Naver\\Naver Whale\\"
                    ]
                },
                "filter_main_whaterfox": {
                    "Image|endswith": "\\Waterfox.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Waterfox\\",
                        "C:\\Program Files (x86)\\Waterfox\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5c80b618-0dbb-46e6-acbb-03d90bcb6d83",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/07/16",
            "references": [
                "https://www.sentinelone.com/labs/wip26-espionage-threat-actors-abuse-cloud-infrastructure-in-targeted-telco-attacks/",
                "https://symantec-enterprise-blogs.security.com/threat-intelligence/harvester-new-apt-attacks-asia",
                "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
                "https://intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/"
            ],
            "related": [
                {
                    "id": "e043f529-8514-4205-8ab0-7f7d2927b400",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.t1102",
                "attack.t1102.001"
            ],
            "title": "Network Connection Initiated To AzureWebsites.NET By Non-Browser Process"
        }
    ]
}