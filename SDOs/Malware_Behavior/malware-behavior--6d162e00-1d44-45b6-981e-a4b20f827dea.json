{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6d162e00-1d44-45b6-981e-a4b20f827dea",
    "created": "2024-08-13T14:46:37.04449Z",
    "modified": "2024-08-13T14:46:45.656032Z",
    "name": "Exploit Public-Facing Application",
    "description": "Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network. The weakness in the system can be a software bug, a temporary glitch, or a misconfiguration.Exploited applications are often websites/web servers, but can also include databases (like SQL), standard services (like SMB or SSH), network device administration and management protocols (like SNMP and Smart Install), and any other system with Internet accessible open sockets.[1][2][3][4][5] Depending on the flaw being exploited this may also involve Exploitation for Defense Evasion or Exploitation for Client Execution.If an application is hosted on cloud-based infrastructure and/or is containerized, then exploiting it may lead to compromise of the underlying instance or container. This can allow an adversary a path to access the cloud or container APIs, exploit container host access via Escape to Host, or take advantage of weak identity and access management policies.Adversaries may also exploit edge network infrastructure and related appliances, specifically targeting devices that do not support robust host-based defenses.[6][7]For websites and databases, the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.[8][9]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1190",
            "external_id": "T1190"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1190",
            "external_id": "T1190"
        },
        {
            "source_name": "CWE top 25",
            "description": "Christey, S., Brown, M., Kirby, D., Martin, B., Paller, A.. (2011, September 13). 2011 CWE/SANS Top 25 Most Dangerous Software Errors. Retrieved April 10, 2019.",
            "url": "https://cwe.mitre.org/top25/index.html"
        },
        {
            "source_name": "CIS Multiple SMB Vulnerabilities",
            "description": "CIS. (2017, May 15). Multiple Vulnerabilities in Microsoft Windows SMB Server Could Allow for Remote Code Execution. Retrieved April 3, 2018.",
            "url": "https://www.cisecurity.org/advisory/multiple-vulnerabilities-in-microsoft-windows-smb-server-could-allow-for-remote-code-execution/"
        },
        {
            "source_name": "Wired Russia Cyberwar",
            "description": "Greenberg, A. (2022, November 10). Russia\u2019s New Cyberwarfare in Ukraine Is Fast, Dirty, and Relentless. Retrieved March 22, 2023.",
            "url": "https://www.wired.com/story/russia-ukraine-cyberattacks-mandiant/"
        },
        {
            "source_name": "Mandiant Fortinet Zero Day",
            "description": "Marvi, A. et al.. (2023, March 16). Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation. Retrieved March 22, 2023.",
            "url": "https://www.mandiant.com/resources/blog/fortinet-malware-ecosystem"
        },
        {
            "source_name": "NVD CVE-2016-6662",
            "description": "National Vulnerability Database. (2017, February 2). CVE-2016-6662 Detail. Retrieved April 3, 2018.",
            "url": "https://nvd.nist.gov/vuln/detail/CVE-2016-6662"
        },
        {
            "source_name": "NVD CVE-2014-7169",
            "description": "National Vulnerability Database. (2017, September 24). CVE-2014-7169 Detail. Retrieved April 3, 2018.",
            "url": "https://nvd.nist.gov/vuln/detail/CVE-2014-7169"
        },
        {
            "source_name": "Cisco Blog Legacy Device Attacks",
            "description": "Omar Santos. (2020, October 19). Attackers Continue to Target Legacy Devices. Retrieved October 20, 2020.",
            "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954"
        },
        {
            "source_name": "OWASP Top 10",
            "description": "OWASP. (2018, February 23). OWASP Top Ten Project. Retrieved April 3, 2018.",
            "url": "https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project"
        },
        {
            "source_name": "US-CERT TA18-106A Network Infrastructure Devices 2018",
            "description": "US-CERT. (2018, April 20). Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
            "url": "https://us-cert.cisa.gov/ncas/alerts/TA18-106A"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "@juju4",
            "date": "2022/12/27",
            "description": "Detects suspicious SQL query keywrods that are often used during recon, exfiltration or destructive activities. Such as dropping tables and selecting wildcard fields",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "drop",
                    "truncate",
                    "dump",
                    "select \\*"
                ]
            },
            "falsepositives": [
                "Inventory and monitoring activity",
                "Vulnerability scanners",
                "Legitimate applications"
            ],
            "id": "d84c0ded-edd7-4123-80ed-348bb3ccc4d5",
            "level": "medium",
            "logsource": {
                "category": "database",
                "definition": "Requirements: Must be able to log the SQL queries"
            },
            "references": [
                "https://github.com/sqlmapproject/sqlmap"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.initial_access",
                "attack.privilege_escalation",
                "attack.t1190",
                "attack.t1505.001"
            ],
            "title": "Suspicious SQL Query"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Thurein Oo",
            "date": "2023/11/08",
            "description": "Detects POST requests to the F5 BIG-IP iControl Rest API \"bash\" endpoint, which allows the execution of commands on the BIG-IP",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri|endswith": "/mgmt/tm/util/bash",
                    "cs-method": "POST"
                }
            },
            "falsepositives": [
                "Legitimate usage of the BIG IP REST API to execute command for administration purposes"
            ],
            "id": "b59c98c6-95e8-4d65-93ee-f594dfb96b17",
            "level": "medium",
            "logsource": {
                "category": "proxy"
            },
            "references": [
                "https://f5-sdk.readthedocs.io/en/latest/apidoc/f5.bigip.tm.util.html#module-f5.bigip.tm.util.bash",
                "https://community.f5.com/t5/technical-forum/icontrolrest-11-5-execute-bash-command/td-p/203029",
                "https://community.f5.com/t5/technical-forum/running-bash-commands-via-rest-api/td-p/272516"
            ],
            "related": [
                {
                    "id": "85254a62-22be-4239-b79c-2ec17e566c37",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "F5 BIG-IP iControl Rest API Command Execution - Proxy"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/07/08",
            "description": "Detects suspicious user agent strings user by hack tools in proxy logs",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-useragent|contains": [
                        "(hydra)",
                        " arachni/",
                        " BFAC ",
                        " brutus ",
                        " cgichk ",
                        "core-project/1.0",
                        " crimscanner/",
                        "datacha0s",
                        "dirbuster",
                        "domino hunter",
                        "dotdotpwn",
                        "FHScan Core",
                        "floodgate",
                        "get-minimal",
                        "gootkit auto-rooter scanner",
                        "grendel-scan",
                        " inspath ",
                        "internet ninja",
                        "jaascois",
                        " zmeu ",
                        "masscan",
                        " metis ",
                        "morfeus fucking scanner",
                        "n-stealth",
                        "nsauditor",
                        "pmafind",
                        "security scan",
                        "springenwerk",
                        "teh forest lobster",
                        "toata dragostea",
                        " vega/",
                        "voideye",
                        "webshag",
                        "webvulnscan",
                        " whcc/",
                        " Havij",
                        "absinthe",
                        "bsqlbf",
                        "mysqloit",
                        "pangolin",
                        "sql power injector",
                        "sqlmap",
                        "sqlninja",
                        "uil2pn",
                        "ruler",
                        "Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ClientIP",
                "c-uri",
                "c-useragent"
            ],
            "id": "c42a3073-30fb-48ae-8c99-c23ada84b103",
            "logsource": {
                "category": "proxy"
            },
            "level": "high",
            "status": "test",
            "modified": "2022/07/07",
            "references": [
                "https://github.com/fastly/waf_testbed/blob/8bfc406551f3045e418cbaad7596cff8da331dfc/templates/default/scanners-user-agents.data.erb",
                "http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "attack.credential_access",
                "attack.t1110"
            ],
            "title": "Hack Tool User Agent"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/01/22",
            "description": "Detects an issue in apache logs that reports threading related errors",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "__pthread_tpp_change_priority: Assertion `new_prio == -1 || (new_prio >= fifo_min_prio && new_prio <= fifo_max_prio)"
                ]
            },
            "falsepositives": [
                "3rd party apache modules - https://bz.apache.org/bugzilla/show_bug.cgi?id=46185"
            ],
            "id": "e9a2b582-3f6a-48ac-b4a1-6849cdc50b3c",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: Must be able to collect the error.log file",
                "service": "apache"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://github.com/hannob/apache-uaf/blob/da40f2be3684c8095ec6066fa68eb5c07a086233/README.md"
            ],
            "tags": [
                "attack.initial_access",
                "attack.lateral_movement",
                "attack.t1190",
                "attack.t1210"
            ],
            "title": "Apache Threading Error"
        },
        {
            "author": "frack113",
            "date": "2021/10/06",
            "description": "When IIS uses an old .Net Framework it's possible to enumerate folders with the symbol \"~\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "cs-method": [
                        "GET",
                        "OPTIONS"
                    ],
                    "cs-uri-query|contains": "~1",
                    "cs-uri-query|endswith": "a.aspx",
                    "sc-status": [
                        200,
                        301
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7cb02516-6d95-4ffc-8eee-162075e111ac",
            "level": "medium",
            "logsource": {
                "category": "webserver"
            },
            "modified": "2023/01/02",
            "status": "test",
            "references": [
                "https://github.com/projectdiscovery/nuclei-templates/blob/9d2889356eebba661c8407038e430759dfd4ec31/fuzzing/iis-shortname.yaml",
                "https://www.exploit-db.com/exploits/19525",
                "https://github.com/lijiejie/IIS_shortname_Scanner"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Successful IIS Shortname Fuzzing Scan"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Tim Shelton",
            "date": "2022/07/19",
            "description": "Detects known suspicious (default) user-agents related to scanning/recon tools",
            "detection": {
                "condition": "selection",
                "selection": {
                    "cs-user-agent|contains": [
                        "Wfuzz/",
                        "WPScan v",
                        "Recon-ng/v",
                        "GIS - AppSec Team - Project Vision"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "19aa4f58-94ca-45ff-bc34-92e533c0994a",
            "level": "medium",
            "logsource": {
                "category": "webserver"
            },
            "modified": "2023/01/02",
            "status": "test",
            "references": [
                "https://github.com/wpscanteam/wpscan/blob/196fbab5b1ce3870a43515153d4f07878a89d410/lib/wpscan/browser.rb",
                "https://github.com/xmendez/wfuzz/blob/1b695ee9a87d66a7d7bf6cae70d60a33fae51541/docs/user/basicusage.rst",
                "https://github.com/lanmaster53/recon-ng/blob/9e907dfe09fce2997f0301d746796408e01a60b7/recon/core/base.py#L92"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Suspicious User-Agents Related To Recon Tools"
        },
        {
            "author": "Subhash Popuri (@pbssubhash), Florian Roth (Nextron Systems), Thurein Oo, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/09/25",
            "description": "Detects path traversal exploitation attempts",
            "detection": {
                "condition": "selection",
                "selection": {
                    "cs-uri-query|contains": [
                        "../../../../../lib/password",
                        "../../../../windows/",
                        "../../../etc/",
                        "..%252f..%252f..%252fetc%252f",
                        "..%c0%af..%c0%af..%c0%afetc%c0%af",
                        "%252e%252e%252fetc%252f"
                    ]
                }
            },
            "falsepositives": [
                "Expected to be continuously seen on systems exposed to the Internet",
                "Internal vulnerability scanners"
            ],
            "id": "7745c2ea-24a5-4290-b680-04359cb84b35",
            "level": "medium",
            "logsource": {
                "category": "webserver"
            },
            "modified": "2023/08/31",
            "status": "test",
            "references": [
                "https://github.com/projectdiscovery/nuclei-templates",
                "https://book.hacktricks.xyz/pentesting-web/file-inclusion"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Path Traversal Exploitation Attempts"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/12/12",
            "description": "Detects exploitation attempt using the JNDI-Exploit-Kit",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "/Basic/Command/Base64/",
                    "/Basic/ReverseShell/",
                    "/Basic/TomcatMemshell",
                    "/Basic/JettyMemshell",
                    "/Basic/WeblogicMemshell",
                    "/Basic/JBossMemshell",
                    "/Basic/WebsphereMemshell",
                    "/Basic/SpringMemshell",
                    "/Deserialization/URLDNS/",
                    "/Deserialization/CommonsCollections1/Dnslog/",
                    "/Deserialization/CommonsCollections2/Command/Base64/",
                    "/Deserialization/CommonsBeanutils1/ReverseShell/",
                    "/Deserialization/Jre8u20/TomcatMemshell",
                    "/TomcatBypass/Dnslog/",
                    "/TomcatBypass/Command/",
                    "/TomcatBypass/ReverseShell/",
                    "/TomcatBypass/TomcatMemshell",
                    "/TomcatBypass/SpringMemshell",
                    "/GroovyBypass/Command/",
                    "/WebsphereBypass/Upload/"
                ]
            },
            "falsepositives": [
                "Legitimate apps the use these paths"
            ],
            "id": "412d55bc-7737-4d25-9542-5b396867ce55",
            "logsource": {
                "category": "webserver"
            },
            "level": "high",
            "modified": "2022/12/25",
            "status": "test",
            "references": [
                "https://github.com/pimps/JNDI-Exploit-Kit",
                "https://githubmemory.com/repo/FunctFan/JNDIExploit"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "JNDIExploit Pattern"
        },
        {
            "id": "85254a62-22be-4239-b79c-2ec17e566c37",
            "author": "Nasreddine Bencherchali (Nextron Systems), Thurein Oo",
            "date": "2023/11/08",
            "description": "Detects POST requests to the F5 BIG-IP iControl Rest API \"bash\" endpoint, which allows the execution of commands on the BIG-IP",
            "detection": {
                "condition": "selection",
                "selection": {
                    "cs-method": "POST",
                    "cs-uri-query|endswith": "/mgmt/tm/util/bash"
                }
            },
            "falsepositives": [
                "Legitimate usage of the BIG IP REST API to execute command for administration purposes"
            ],
            "level": "medium",
            "logsource": {
                "category": "webserver"
            },
            "references": [
                "https://f5-sdk.readthedocs.io/en/latest/apidoc/f5.bigip.tm.util.html#module-f5.bigip.tm.util.bash",
                "https://community.f5.com/t5/technical-forum/icontrolrest-11-5-execute-bash-command/td-p/203029",
                "https://community.f5.com/t5/technical-forum/running-bash-commands-via-rest-api/td-p/272516"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "b59c98c6-95e8-4d65-93ee-f594dfb96b17"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.t1190"
            ],
            "title": "F5 BIG-IP iControl Rest API Command Execution - Webserver"
        },
        {
            "author": "frack113, Harjot Singh, \"@cyb3rjy0t\" (update)",
            "date": "2022/06/04",
            "description": "Detects possible Java payloads in web access logs",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "%24%7B%28%23a%3D%40",
                    "${(#a=@",
                    "%24%7B%40java",
                    "${@java",
                    "u0022java",
                    "%2F%24%7B%23",
                    "/${#",
                    "new+java.",
                    "getRuntime().exec(",
                    "getRuntime%28%29.exec%28"
                ]
            },
            "falsepositives": [
                "Legitimate apps"
            ],
            "id": "583aa0a2-30b1-4d62-8bf3-ab73689efe6c",
            "logsource": {
                "category": "webserver"
            },
            "level": "high",
            "modified": "2023/01/19",
            "status": "test",
            "references": [
                "https://www.rapid7.com/blog/post/2022/06/02/active-exploitation-of-confluence-cve-2022-26134/",
                "https://www.rapid7.com/blog/post/2021/09/02/active-exploitation-of-confluence-server-cve-2021-26084/",
                "https://github.com/httpvoid/writeups/blob/62d3751945289d088ccfdf4d0ffbf61598a2cd7d/Confluence-RCE.md",
                "https://twitter.com/httpvoid0x2f/status/1532924261035384832",
                "https://medium.com/geekculture/text4shell-exploit-walkthrough-ebc02a01f035"
            ],
            "tags": [
                "cve.2022.26134",
                "cve.2021.26084",
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Java Payload Strings"
        },
        {
            "author": "Saw Win Naung, Nasreddine Bencherchali (Nextron Systems), Thurein Oo (Yoma Bank)",
            "date": "2020/02/22",
            "description": "Detects potential SQL injection attempts via GET requests in access logs.",
            "detection": {
                "condition": "selection and keywords and not 1 of filter_main_*",
                "filter_main_status": {
                    "sc-status": 404
                },
                "keywords": [
                    "@@version",
                    "%271%27%3D%271",
                    "=select ",
                    "=select(",
                    "=select%20",
                    "concat_ws(",
                    "CONCAT(0x",
                    "from mysql.innodb_table_stats",
                    "from%20mysql.innodb_table_stats",
                    "group_concat(",
                    "information_schema.tables",
                    "json_arrayagg(",
                    "or 1=1#",
                    "or%201=1#",
                    "order by ",
                    "order%20by%20",
                    "select * ",
                    "select database()",
                    "select version()",
                    "select%20*%20",
                    "select%20database()",
                    "select%20version()",
                    "select%28sleep%2810%29",
                    "SELECTCHAR(",
                    "table_schema",
                    "UNION ALL SELECT",
                    "UNION SELECT",
                    "UNION%20ALL%20SELECT",
                    "UNION%20SELECT",
                    "'1'='1"
                ],
                "selection": {
                    "cs-method": "GET"
                }
            },
            "falsepositives": [
                "Java scripts and CSS Files",
                "User searches in search boxes of the respective website",
                "Internal vulnerability scanners can cause some serious FPs when used, if you experience a lot of FPs due to this think of adding more filters such as \"User Agent\" strings and more response codes"
            ],
            "id": "5513deaf-f49a-46c2-a6c8-3f111b5cb453",
            "logsource": {
                "category": "webserver"
            },
            "level": "high",
            "modified": "2023/09/04",
            "status": "test",
            "references": [
                "https://www.acunetix.com/blog/articles/exploiting-sql-injection-example/",
                "https://www.acunetix.com/blog/articles/using-logs-to-investigate-a-web-application-attack/",
                "https://brightsec.com/blog/sql-injection-payloads/",
                "https://github.com/payloadbox/sql-injection-payload-list",
                "https://book.hacktricks.xyz/pentesting-web/sql-injection/mysql-injection"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "SQL Injection Strings In URI"
        },
        {
            "author": "jamesc-grafana",
            "date": "2024/07/11",
            "description": "Detects the addition of a new network route to a route table in AWS.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "CreateRoute",
                    "eventSource": "ec2.amazonaws.com"
                }
            },
            "falsepositives": [
                "New VPC Creation requiring setup of a new route table",
                "New subnets added requiring routing setup"
            ],
            "id": "c803b2ce-c4a2-4836-beae-b112010390b1",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "references": [
                "https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/"
            ],
            "status": "test",
            "title": "New Network Route Added",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "jamesc-grafana",
            "date": "2024/07/11",
            "description": "Detects changes to the security groups associated with an Elastic Load Balancer (ELB) or Application Load Balancer (ALB).\nThis can indicate that a misconfiguration allowing more traffic into the system than required, or could indicate that an attacker is attempting to enable new connections into a VPC or subnet controlled by the account.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "ApplySecurityGroupsToLoadBalancer",
                        "SetSecurityGroups"
                    ],
                    "eventSource": "elasticloadbalancing.amazonaws.com"
                }
            },
            "falsepositives": [
                "Repurposing of an ELB or ALB to serve a different or additional application",
                "Changes to security groups to allow for new services to be deployed"
            ],
            "id": "7a4409fc-f8ca-45f6-8006-127d779eaad9",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "references": [
                "https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/"
            ],
            "status": "test",
            "title": "LoadBalancer Security Group Modification",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "jamesc-grafana",
            "date": "2024/07/11",
            "description": "Detects when an account makes changes to the ingress or egress rules of a security group.\nThis can indicate that an attacker is attempting to open up new attack vectors in the account, that they are trying to exfiltrate data over the network, or that they are trying to allow machines in that VPC/Subnet to contact a C&C server.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "AuthorizeSecurityGroupEgress",
                        "AuthorizeSecurityGroupIngress",
                        "RevokeSecurityGroupEgress",
                        "RevokeSecurityGroupIngress"
                    ],
                    "eventSource": "ec2.amazonaws.com"
                }
            },
            "falsepositives": [
                "New VPCs and Subnets being setup requiring a different security profile to those already defined",
                "A single port being opened for a new service that is known to be deploying",
                "Administrators closing unused ports to reduce the attack surface"
            ],
            "id": "6fb77778-040f-4015-9440-572aa9b6b580",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "references": [
                "https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/"
            ],
            "status": "test",
            "title": "Ingress/Egress Security Group Modification",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "jamesc-grafana",
            "date": "2024/07/11",
            "description": "Detects changes to the security group entries for RDS databases.\nThis can indicate that a misconfiguration has occurred which potentially exposes the database to the public internet, a wider audience within the VPC or that removal of valid rules has occurred which could impact the availability of the database to legitimate services and users.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "AuthorizeDBSecurityGroupIngress",
                        "CreateDBSecurityGroup",
                        "DeleteDBSecurityGroup",
                        "RevokeDBSecurityGroupIngress"
                    ],
                    "eventSource": "rds.amazonaws.com"
                }
            },
            "falsepositives": [
                "Creation of a new Database that needs new security group rules"
            ],
            "id": "14f3f1c8-02d5-43a2-a191-91ffb52d3015",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "references": [
                "https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/"
            ],
            "status": "test",
            "title": "RDS Database Security Group Modification",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "jamesc-grafana",
            "date": "2024/07/11",
            "description": "Detects that network ACL entries have been added to a route table which could indicate that new attack vectors have been opened up in the AWS account.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "CreateNetworkAclEntry",
                    "eventSource": "ec2.amazonaws.com"
                }
            },
            "falsepositives": [
                "Legitimate use of ACLs to enable customer and staff access from the public internet into a public VPC"
            ],
            "id": "e1f7febb-7b94-4234-b5c6-00fb8500f5dd",
            "level": "low",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "references": [
                "https://www.gorillastack.com/blog/real-time-events/important-aws-cloudtrail-security-events-tracking/"
            ],
            "status": "test",
            "title": "New Network ACL Entry Added",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/08/06",
            "description": "Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "ActionController::InvalidAuthenticityToken",
                    "ActionController::InvalidCrossOriginRequest",
                    "ActionController::MethodNotAllowed",
                    "ActionController::BadRequest",
                    "ActionController::ParameterMissing"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "0d2c3d4c-4b48-4ac3-8f23-ea845746bb1a",
            "level": "medium",
            "logsource": {
                "category": "application",
                "product": "ruby_on_rails"
            },
            "modified": "2020/09/01",
            "references": [
                "http://edgeguides.rubyonrails.org/security.html",
                "http://guides.rubyonrails.org/action_controller_overview.html",
                "https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception",
                "https://github.com/rails/rails/blob/cd08e6bcc4cd8948fe01e0be1ea0c7ca60373a25/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb"
            ],
            "status": "stable",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Ruby on Rails Framework Exceptions"
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects potential SpEL Injection exploitation, which may lead to RCE.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "org.springframework.expression.ExpressionException"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "e9edd087-89d8-48c9-b0b4-5b9bb10896b8",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "spring"
            },
            "level": "high",
            "references": [
                "https://owasp.org/www-community/vulnerabilities/Expression_Language_Injection",
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "title": "Potential SpEL Injection In Spring Framework",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/08/06",
            "description": "Detects suspicious Spring framework exceptions that could indicate exploitation attempts",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "AccessDeniedException",
                    "CsrfException",
                    "InvalidCsrfTokenException",
                    "MissingCsrfTokenException",
                    "CookieTheftException",
                    "InvalidCookieException",
                    "RequestRejectedException"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "ae48ab93-45f7-4051-9dfe-5d30a3f78e33",
            "level": "medium",
            "logsource": {
                "category": "application",
                "product": "spring"
            },
            "modified": "2020/09/01",
            "references": [
                "https://docs.spring.io/spring-security/site/docs/current/api/overview-tree.html"
            ],
            "status": "stable",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Spring Framework Exceptions"
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/08/05",
            "description": "Detects suspicious Django web application framework exceptions that could indicate exploitation attempts",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "SuspiciousOperation",
                    "DisallowedHost",
                    "DisallowedModelAdminLookup",
                    "DisallowedModelAdminToField",
                    "DisallowedRedirect",
                    "InvalidSessionKey",
                    "RequestDataTooBig",
                    "SuspiciousFileOperation",
                    "SuspiciousMultipartForm",
                    "SuspiciousSession",
                    "TooManyFieldsSent",
                    "PermissionDenied"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "fd435618-981e-4a7c-81f8-f78ce480d616",
            "level": "medium",
            "logsource": {
                "category": "application",
                "product": "django"
            },
            "modified": "2020/09/01",
            "references": [
                "https://docs.djangoproject.com/en/1.11/ref/exceptions/",
                "https://docs.djangoproject.com/en/1.11/topics/logging/#django-security"
            ],
            "status": "stable",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Django Framework Exceptions"
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects process execution related errors in NodeJS. If the exceptions are caused due to user input then they may suggest an RCE vulnerability.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "node:child_process"
                ]
            },
            "falsepositives": [
                "Puppeteer invocation exceptions often contain child_process related errors, that doesn't necessarily mean that the app is vulnerable."
            ],
            "id": "97661d9d-2beb-4630-b423-68985291a8af",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "nodejs"
            },
            "level": "high",
            "references": [
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "title": "Potential RCE Exploitation Attempt In NodeJS",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Bjoern Kimminich",
            "date": "2017/11/27",
            "description": "Detects SQL error messages that indicate probing for an injection attack",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "quoted string not properly terminated",
                    "You have an error in your SQL syntax",
                    "Unclosed quotation mark",
                    "near \"*\": syntax error",
                    "SELECTs to the left and right of UNION do not have the same number of result columns"
                ]
            },
            "falsepositives": [
                "A syntax error in MySQL also occurs in non-dynamic (safe) queries if there is an empty in() clause, that may often be the case."
            ],
            "id": "8a670c6d-7189-4b1c-8017-a417ca84a086",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL ERROR and above)",
                "product": "sql"
            },
            "level": "high",
            "modified": "2023/02/12",
            "status": "test",
            "references": [
                "http://www.sqlinjection.net/errors"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Suspicious SQL Error Messages"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where an HTTP service on an OpenCanary node has had login attempt via Form POST.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 3001
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "af1ac430-df6b-4b38-b976-0b52f07a0252",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "level": "high",
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "title": "OpenCanary - HTTP POST Login Attempt",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where an FTP service on an OpenCanary node has had a login attempt.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 2000
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "6991bc2b-ae2e-447f-bc55-3a1ba04c14e5",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "level": "high",
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "tags": [
                "attack.initial_access",
                "attack.exfiltration",
                "attack.t1190",
                "attack.t1021"
            ],
            "title": "OpenCanary - FTP Login Attempt"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where an HTTP service on an OpenCanary node has received a GET request.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 3000
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "af6c3078-84cd-4c68-8842-08b76bd81b13",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "level": "high",
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "title": "OpenCanary - HTTP GET Request",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects exceptions in velocity template renderer, this most likely happens due to dynamic rendering of user input and may lead to RCE.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "ParseErrorException",
                    "VelocityException",
                    "TemplateInitException"
                ]
            },
            "falsepositives": [
                "Application bugs",
                "Missing .vm files"
            ],
            "id": "16c86189-b556-4ee8-b4c7-7e350a195a4f",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "velocity"
            },
            "level": "high",
            "references": [
                "https://antgarsil.github.io/posts/velocity/",
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "title": "Potential Server Side Template Injection In Velocity",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/08/12",
            "description": "Generic rule for SQL exceptions in Python according to PEP 249",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "DataError",
                    "IntegrityError",
                    "ProgrammingError",
                    "OperationalError"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "19aefed0-ffd4-47dc-a7fc-f8b1425e84f9",
            "level": "medium",
            "logsource": {
                "category": "application",
                "product": "python"
            },
            "modified": "2020/09/01",
            "references": [
                "https://www.python.org/dev/peps/pep-0249/#exceptions"
            ],
            "status": "stable",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Python SQL Exceptions"
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects potential local file read vulnerability in JVM based apps.\nIf the exceptions are caused due to user input and contain path traversal payloads then it's a red flag.\n",
            "detection": {
                "condition": "keywords_local_file_read",
                "keywords_local_file_read": {
                    "|all": [
                        "FileNotFoundException",
                        "/../../.."
                    ]
                }
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "e032f5bc-4563-4096-ae3b-064bab588685",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "jvm"
            },
            "level": "high",
            "references": [
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "title": "Potential Local File Read Vulnerability In JVM Based Application",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects potential OGNL Injection exploitation, which may lead to RCE.\nOGNL is an expression language that is supported in many JVM based systems.\nOGNL Injection is the reason for some high profile RCE's such as Apache Struts (CVE-2017-5638) and Confluence (CVE-2022-26134)\n",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "org.apache.commons.ognl.OgnlException",
                    "ExpressionSyntaxException"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "4d0af518-828e-4a04-a751-a7d03f3046ad",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "jvm"
            },
            "level": "high",
            "references": [
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "cve.2017.5638",
                "cve.2022.26134"
            ],
            "title": "Potential OGNL Injection Exploitation In JVM Based Application"
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects potential JNDI Injection exploitation. Often coupled with Log4Shell exploitation.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "com.sun.jndi.ldap.",
                    "org.apache.logging.log4j.core.net.JndiManager"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "bb0e9cec-d4da-46f5-997f-22efc59f3dca",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "jvm"
            },
            "level": "high",
            "references": [
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs",
                "https://secariolabs.com/research/analysing-and-reproducing-poc-for-log4j-2-15-0"
            ],
            "status": "test",
            "title": "Potential JNDI Injection Exploitation In JVM Based Application",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects XML parsing issues, if the application expects to work with XML make sure that the parser is initialized safely.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "SAXParseException",
                    "DOMException"
                ]
            },
            "falsepositives": [
                "If the application expects to work with XML there may be parsing issues that don't necessarily mean XXE."
            ],
            "id": "c4e06896-e27c-4583-95ac-91ce2279345d",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "jvm"
            },
            "level": "high",
            "references": [
                "https://rules.sonarsource.com/java/RSPEC-2755",
                "https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing",
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "title": "Potential XXE Exploitation Attempt In JVM Based Application",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Moti Harmats",
            "date": "2023/02/11",
            "description": "Detects process execution related exceptions in JVM based apps, often relates to RCE",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Cannot run program",
                    "java.lang.ProcessImpl",
                    "java.lang.ProcessBuilder"
                ]
            },
            "falsepositives": [
                "Application bugs"
            ],
            "id": "d65f37da-a26a-48f8-8159-3dde96680ad2",
            "logsource": {
                "category": "application",
                "definition": "Requirements: application error logs must be collected (with LOG_LEVEL=ERROR and above)",
                "product": "jvm"
            },
            "level": "high",
            "references": [
                "https://www.wix.engineering/post/threat-and-vulnerability-hunting-with-application-server-error-logs"
            ],
            "status": "test",
            "title": "Process Execution Error In JVM Based Application",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Matt Kelly (list of domains)",
            "date": "2022/06/07",
            "description": "Detects suspicious DNS queries to external service interaction domains often used for out-of-band interactions after successful RCE",
            "detection": {
                "condition": "selection",
                "selection": {
                    "query|contains": [
                        ".interact.sh",
                        ".oast.pro",
                        ".oast.live",
                        ".oast.site",
                        ".oast.online",
                        ".oast.fun",
                        ".oast.me",
                        ".burpcollaborator.net",
                        ".oastify.com",
                        ".canarytokens.com",
                        ".requestbin.net",
                        ".dnslog.cn"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "aff715fa-4dd5-497a-8db3-910bea555566",
            "logsource": {
                "category": "dns"
            },
            "level": "high",
            "references": [
                "https://twitter.com/breakersall/status/1533493587828260866"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "attack.reconnaissance",
                "attack.t1595.002"
            ],
            "title": "DNS Query to External Service Interaction Domains"
        },
        {
            "author": "Nate Guagenti (neu5ron)",
            "date": "2021/09/20",
            "description": "Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request.\nVerify, successful, exploitation by viewing the HTTP client (request) body to see what was passed to the server (using PCAP).\nWithin the client body is where the code execution would occur. Additionally, check the endpoint logs to see if suspicious commands or activity occurred within the timeframe of this HTTP request.\n",
            "detection": {
                "auth_header": {
                    "client_header_names|contains": "AUTHORIZATION"
                },
                "condition": "selection and not auth_header and not too_small_http_client_body",
                "selection": {
                    "method": "POST",
                    "status_code": 200,
                    "uri": "/wsman"
                },
                "too_small_http_client_body": {
                    "request_body_len": 0
                }
            },
            "falsepositives": [
                "Exploits that were attempted but unsuccessful.",
                "Scanning attempts with the abnormal use of the HTTP POST method with no indication of code execution within the HTTP Client (Request) body. An example would be vulnerability scanners trying to identify unpatched versions while not actually exploiting the vulnerability. See description for investigation tips."
            ],
            "fields": [
                "id.orig_h",
                "id.resp_h",
                "id.resp_p",
                "status_code",
                "method",
                "uri",
                "request_body_len",
                "response_body_len",
                "user_agent"
            ],
            "id": "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
            "level": "high",
            "logsource": {
                "definition": "Enable the builtin Zeek script that logs all HTTP header names by adding \"@load policy/protocols/http/header-names\" to your local.zeek config file. The script can be seen here for reference https://github.com/zeek/zeek/blob/d957f883df242ef159cfd846884e673addeea7a5/scripts/policy/protocols/http/header-names.zeek",
                "product": "zeek",
                "service": "http"
            },
            "modified": "2019/09/20",
            "status": "stable",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://twitter.com/neu5ron/status/1438987292971053057?s=20"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.lateral_movement",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203",
                "attack.t1021.006",
                "attack.t1210"
            ],
            "title": "OMIGOD HTTP No Authentication RCE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/10/04",
            "description": "Detects suspicious file type dropped by an Exchange component in IIS",
            "detection": {
                "condition": "all of selection*",
                "selection": {
                    "CommandLine|contains": "MSExchange",
                    "Image|endswith": "\\w3wp.exe"
                },
                "selection_types": {
                    "TargetFilename|endswith": [
                        ".aspx",
                        ".asp",
                        ".ashx",
                        ".ps1",
                        ".bat",
                        ".exe",
                        ".dll",
                        ".vbs"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6b269392-9eba-40b5-acb6-55c882b20ba6",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/",
                "https://www.gteltsc.vn/blog/canh-bao-chien-dich-tan-cong-su-dung-lo-hong-zero-day-tren-microsoft-exchange-server-12714.html",
                "https://en.gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dang-duoc-su-dung-de-tan-cong-cac-to-chuc-tai-viet-nam-9685.html"
            ],
            "related": [
                {
                    "id": "bd1212e5-78da-431e-95fa-c58e3237a8e6",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1190",
                "attack.initial_access",
                "attack.t1505.003"
            ],
            "title": "Suspicious File Drop by Exchange"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/25",
            "description": "Detects suspicious activity in which the MSExchangeMailboxReplication process writes .asp and .apsx files to disk, which could be a sign of ProxyShell exploitation",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\MSExchangeMailboxReplication.exe",
                    "TargetFilename|endswith": [
                        ".aspx",
                        ".asp"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7280c9f3-a5af-45d0-916a-bc01cb4151c9",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "level": "high",
            "references": [
                "https://redcanary.com/blog/blackbyte-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "attack.persistence",
                "attack.t1505.003"
            ],
            "title": "Suspicious MSExchangeMailboxReplication ASPX Write"
        },
        {
            "author": "FPT.EagleEye Team, wagga",
            "date": "2020/12/11",
            "description": "Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection.",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_datev": {
                    "CommandLine|startswith": "\"C:\\Windows\\system32\\cmd.exe\" ",
                    "Image": "C:\\Windows\\System32\\cmd.exe",
                    "ParentImage|endswith": "DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe",
                    "ParentImage|startswith": "C:\\Program Files\\Microsoft SQL Server\\"
                },
                "selection": {
                    "Image|endswith": [
                        "\\bash.exe",
                        "\\bitsadmin.exe",
                        "\\cmd.exe",
                        "\\netstat.exe",
                        "\\nltest.exe",
                        "\\ping.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\sh.exe",
                        "\\systeminfo.exe",
                        "\\tasklist.exe",
                        "\\wsl.exe"
                    ],
                    "ParentImage|endswith": "\\sqlservr.exe"
                }
            },
            "id": "869b9ca7-9ea2-4a5a-8325-e80e62f75445",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/04",
            "level": "high",
            "references": [
                "Internal Research"
            ],
            "related": [
                {
                    "id": "344482e4-a477-436c-aa70-7536d18a48c7",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.t1505.003",
                "attack.t1190",
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation"
            ],
            "title": "Suspicious Child Process Of SQL Server"
        },
        {
            "author": "Thomas Patzke, Florian Roth (Nextron Systems), Zach Stanford @svch0st, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/01/16",
            "description": "Detects potentially suspicious processes being spawned by a web server process which could be the result of a successfully placed web shell or exploitation\n",
            "detection": {
                "condition": "1 of selection_webserver_* and selection_anomaly_children and not 1 of filter_main_*",
                "filter_main_fp_1": {
                    "CommandLine|endswith": "Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager \"Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt",
                    "ParentImage|endswith": "\\java.exe"
                },
                "filter_main_fp_2": {
                    "CommandLine|contains|all": [
                        "sc query",
                        "ADManager Plus"
                    ],
                    "ParentImage|endswith": "\\java.exe"
                },
                "selection_anomaly_children": {
                    "Image|endswith": [
                        "\\arp.exe",
                        "\\at.exe",
                        "\\bash.exe",
                        "\\bitsadmin.exe",
                        "\\certutil.exe",
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\dsget.exe",
                        "\\hostname.exe",
                        "\\nbtstat.exe",
                        "\\net.exe",
                        "\\net1.exe",
                        "\\netdom.exe",
                        "\\netsh.exe",
                        "\\nltest.exe",
                        "\\ntdutil.exe",
                        "\\powershell_ise.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\qprocess.exe",
                        "\\query.exe",
                        "\\qwinsta.exe",
                        "\\reg.exe",
                        "\\rundll32.exe",
                        "\\sc.exe",
                        "\\sh.exe",
                        "\\wmic.exe",
                        "\\wscript.exe",
                        "\\wusa.exe"
                    ]
                },
                "selection_webserver_characteristics_tomcat1": {
                    "ParentImage|contains": [
                        "-tomcat-",
                        "\\tomcat"
                    ],
                    "ParentImage|endswith": [
                        "\\java.exe",
                        "\\javaw.exe"
                    ]
                },
                "selection_webserver_characteristics_tomcat2": {
                    "ParentCommandLine|contains": [
                        "CATALINA_HOME",
                        "catalina.home",
                        "catalina.jar"
                    ],
                    "ParentImage|endswith": [
                        "\\java.exe",
                        "\\javaw.exe"
                    ]
                },
                "selection_webserver_image": {
                    "ParentImage|endswith": [
                        "\\caddy.exe",
                        "\\httpd.exe",
                        "\\nginx.exe",
                        "\\php-cgi.exe",
                        "\\php.exe",
                        "\\tomcat.exe",
                        "\\UMWorkerProcess.exe",
                        "\\w3wp.exe",
                        "\\ws_TomcatService.exe"
                    ]
                }
            },
            "falsepositives": [
                "Particular web applications may spawn a shell process legitimately"
            ],
            "id": "8202070f-edeb-4d31-a010-a26c72ac5600",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/11/11",
            "status": "test",
            "references": [
                "https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF"
            ],
            "tags": [
                "attack.persistence",
                "attack.t1505.003",
                "attack.t1190"
            ],
            "title": "Suspicious Process By Web Server Process"
        },
        {
            "author": "Andreas Hunkeler (@Karneades), Markus Neis",
            "date": "2021/05/20",
            "description": "Detects suspicious processes including shells spawnd from WinRM host process",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\sh.exe",
                        "\\bash.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\wsl.exe",
                        "\\schtasks.exe",
                        "\\certutil.exe",
                        "\\whoami.exe",
                        "\\bitsadmin.exe"
                    ],
                    "ParentImage|endswith": "\\wsmprovhost.exe"
                }
            },
            "falsepositives": [
                "Legitimate WinRM usage"
            ],
            "id": "5cc2cda8-f261-4d88-a2de-e9e193c86716",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "references": [
                "Internal Research"
            ],
            "modified": "2022/07/14",
            "status": "test",
            "tags": [
                "attack.t1190",
                "attack.initial_access",
                "attack.persistence",
                "attack.privilege_escalation"
            ],
            "title": "Suspicious Processes Spawned by WinRM"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/05/22",
            "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_img": {
                    "Image|endswith": [
                        "\\rdpclip.exe",
                        ":\\Windows\\System32\\csrss.exe",
                        ":\\Windows\\System32\\wininit.exe",
                        ":\\Windows\\System32\\winlogon.exe"
                    ]
                },
                "filter_null": {
                    "Image": null
                },
                "selection": {
                    "ParentCommandLine|contains|all": [
                        "\\svchost.exe",
                        "termsvcs"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1012f107-b8f1-4271-af30-5aed2de89b39",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/01/25",
            "status": "test",
            "references": [
                "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "attack.lateral_movement",
                "attack.t1210",
                "car.2013-07-002"
            ],
            "title": "Terminal Service Process Spawn"
        },
        {
            "author": "Jason Rathbun (Blackpoint Cyber)",
            "date": "2024/02/26",
            "description": "Detects potential web shell execution from the ScreenConnect server process.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\csc.exe"
                    ],
                    "ParentImage|endswith": "\\ScreenConnect.Service.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "b19146a3-25d4-41b4-928b-1e2a92641b1b",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "references": [
                "https://blackpointcyber.com/resources/blog/breaking-through-the-screen/",
                "https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8"
            ],
            "status": "experimental",
            "title": "Remote Access Tool - ScreenConnect Server Web Shell Execution",
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ]
        },
        {
            "author": "NVISO",
            "date": "2020/05/06",
            "description": "Detects a failed logon attempt from a public IP. A login from a public IP can indicate a misconfigured firewall or network boundary.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_ip_unknown": {
                    "IpAddress|contains": "-"
                },
                "filter_main_local_ranges": {
                    "IpAddress|cidr": [
                        "::1/128",
                        "10.0.0.0/8",
                        "127.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "fc00::/7",
                        "fe80::/10"
                    ]
                },
                "selection": {
                    "EventID": 4625
                }
            },
            "falsepositives": [
                "Legitimate logon attempts over the internet",
                "IPv4-to-IPv6 mapped IPs"
            ],
            "id": "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2024/03/11",
            "status": "test",
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625"
            ],
            "tags": [
                "attack.initial_access",
                "attack.persistence",
                "attack.t1078",
                "attack.t1190",
                "attack.t1133"
            ],
            "title": "Failed Logon From Public IP"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute any UNIX/Linux script using the /bin/sh shell.\nScript being executed gets created as a temp file in /tmp folder with a scx* prefix.\nThen it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.\nThe file in that directory has the same prefix scx*. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/etc/opt/microsoft/scx/conf/tmpdir/scx",
                    "CurrentDirectory": "/var/opt/microsoft/scx/tmp",
                    "LogonId": 0,
                    "User": "root"
                }
            },
            "falsepositives": [
                "Legitimate use of SCX RunAsProvider ExecuteScript."
            ],
            "id": "6eea1bf6-f8d2-488a-a742-e6ef6c1b67db",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "high",
            "modified": "2022/10/05",
            "status": "test",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://github.com/Azure/Azure-Sentinel/pull/3059"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203"
            ],
            "title": "OMIGOD SCX RunAsProvider ExecuteScript"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/03",
            "description": "Detects spawning of suspicious child processes by Atlassian Confluence server which may indicate successful exploitation of CVE-2022-26134",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "/bin/sh",
                        "bash",
                        "dash",
                        "ksh",
                        "zsh",
                        "csh",
                        "fish",
                        "curl",
                        "wget",
                        "python"
                    ],
                    "ParentImage|endswith": "/java",
                    "ParentImage|startswith": "/opt/atlassian/confluence/"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7fb14105-530e-4e2e-8cfb-99f7d8700b66",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "high",
            "references": [
                "https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/"
            ],
            "related": [
                {
                    "id": "245f92e3-c4da-45f1-9070-bc552e06db11",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.execution",
                "attack.t1190",
                "attack.t1059",
                "cve.2022.26134"
            ],
            "title": "Atlassian Confluence CVE-2022-26134"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/bin/sh",
                    "CurrentDirectory": "/var/opt/microsoft/scx/tmp",
                    "LogonId": 0,
                    "User": "root"
                }
            },
            "falsepositives": [
                "Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand."
            ],
            "id": "21541900-27a9-4454-9c4c-3f0a4240344a",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "high",
            "modified": "2022/10/05",
            "status": "test",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://github.com/Azure/Azure-Sentinel/pull/3059"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203"
            ],
            "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/20",
            "description": "Detects attempts to exploit an apache spark server via CVE-2014-6287 from a commandline perspective",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "id -Gn `",
                        "id -Gn '"
                    ],
                    "ParentImage|endswith": "\\bash"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "c8a5f584-cdc8-42cc-8cce-0398e4265de3",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "high",
            "references": [
                "https://github.com/W01fh4cker/cve-2022-33891/blob/fd973b56e78bca8822caa3a2e3cf1b5aff5d0950/cve_2022_33891_poc.py",
                "https://sumsec.me/2022/CVE-2022-33891%20Apache%20Spark%20shell%20command%20injection.html",
                "https://github.com/apache/spark/pull/36315/files"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1190",
                "cve.2022.33891"
            ],
            "title": "Apache Spark Shell Command Injection - ProcessCreation"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/02/20",
            "description": "Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    " dropping source port zero packet from ",
                    " denied AXFR from ",
                    " exiting (due to fatal error)"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c8e35e96-19ce-4f16-aeb6-fd5588dc5365",
            "logsource": {
                "product": "linux",
                "service": "syslog"
            },
            "level": "high",
            "modified": "2022/10/05",
            "status": "test",
            "references": [
                "https://github.com/ossec/ossec-hids/blob/1ecffb1b884607cb12e619f9ab3c04f530801083/etc/rules/named_rules.xml"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Suspicious Named Error"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/06/30",
            "description": "Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "unexpected internal error",
                    "unknown or unsupported key type",
                    "invalid certificate signing key",
                    "invalid elliptic curve value",
                    "incorrect signature",
                    "error in libcrypto",
                    "unexpected bytes remain after decoding",
                    "fatal: buffer_get_string: bad string",
                    "Local: crc32 compensation attack",
                    "bad client public DH value",
                    "Corrupted MAC on input"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e76b413a-83d0-4b94-8e4c-85db4a5b8bdc",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "sshd"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://github.com/openssh/openssh-portable/blob/c483a5c0fb8e8b8915fad85c5f6113386a4341ca/ssherr.c",
                "https://github.com/ossec/ossec-hids/blob/1ecffb1b884607cb12e619f9ab3c04f530801083/etc/rules/sshd_rules.xml"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Suspicious OpenSSH Daemon Error"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/07/05",
            "description": "Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Connection refused: too many sessions for this address.",
                    "Connection refused: tcp_wrappers denial.",
                    "Bad HTTP verb.",
                    "port and pasv both active",
                    "pasv and port both active",
                    "Transfer done (but failed to open directory).",
                    "Could not set file modification time.",
                    "bug: pid active in ptrace_sandbox_free",
                    "PTRACE_SETOPTIONS failure",
                    "weird status:",
                    "couldn't handle sandbox event",
                    "syscall * out of bounds",
                    "syscall not permitted:",
                    "syscall validate failed:",
                    "Input line too long.",
                    "poor buffer accounting in str_netfd_alloc",
                    "vsf_sysutil_read_loop"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "377f33a1-4b36-4ee1-acee-1dbe4b43cfbe",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "vsftpd"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://github.com/dagwieers/vsftpd/"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1190"
            ],
            "title": "Suspicious VSFTPD Error Messages"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2021/09/17",
            "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager.\nMicrosoft Azure, and Microsoft Operations Management Suite.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "comm": "sh",
                    "cwd": "/var/opt/microsoft/scx/tmp",
                    "syscall": "execve",
                    "type": "SYSCALL",
                    "uid": 0
                }
            },
            "falsepositives": [
                "Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand."
            ],
            "id": "045b5f9c-49f7-4419-a236-9854fb3c827a",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "level": "high",
            "modified": "2022/11/26",
            "status": "test",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://github.com/Azure/Azure-Sentinel/pull/3059"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203"
            ],
            "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand - Auditd"
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "IaaS",
        "Network",
        "Linux",
        "macOS",
        "Containers"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Yossi Weizman, Azure Defender Research Team",
        "Praetorian"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "initial-access"
        }
    ],
    "x_mitre_detection": "Monitor application logs for abnormal behavior that may indicate attempted or successful exploitation. Use deep packet inspection to look for artifacts of common exploit traffic, such as SQL injection. Web Application Firewalls may detect improper inputs attempting exploitation.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.5",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": []
}