{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--625f0775-7d0a-40fd-bbbf-5a58d6b891c6",
    "created": "2024-08-13T14:46:36.950056Z",
    "modified": "2024-08-13T14:46:45.071801Z",
    "name": "User Execution: Malicious Link",
    "description": "An adversary may rely upon a user clicking a malicious link in order to gain execution. Users may be subjected to social engineering to get them to click on a link that will lead to code execution. This user action will typically be observed as follow-on behavior from Spearphishing Link. Clicking on a link may also lead to other execution techniques such as exploitation of a browser or application vulnerability via Exploitation for Client Execution. Links may also lead users to download files that require execution via Malicious File.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1204/001",
            "external_id": "T1204/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Tim Rauch (rule), Elastic (idea)",
            "date": "2022/10/21",
            "description": "Detects when the macOS Script Editor utility spawns an unusual child process.",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "Image|endswith": [
                            "/curl",
                            "/bash",
                            "/sh",
                            "/zsh",
                            "/dash",
                            "/fish",
                            "/osascript",
                            "/mktemp",
                            "/chmod",
                            "/php",
                            "/nohup",
                            "/openssl",
                            "/plutil",
                            "/PlistBuddy",
                            "/xattr",
                            "/sqlite",
                            "/funzip",
                            "/popen"
                        ]
                    },
                    {
                        "Image|contains": [
                            "python",
                            "perl"
                        ]
                    }
                ],
                "selection_parent": {
                    "ParentImage|endswith": "/Script Editor"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/12/28",
            "references": [
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-7f541fbc4a4a28a92970e8bf53effea5bd934604429112c920affb457f5b2685",
                "https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/"
            ],
            "status": "test",
            "tags": [
                "attack.t1566",
                "attack.t1566.002",
                "attack.initial_access",
                "attack.t1059",
                "attack.t1059.002",
                "attack.t1204",
                "attack.t1204.001",
                "attack.execution",
                "attack.persistence",
                "attack.t1553",
                "attack.defense_evasion"
            ],
            "title": "Suspicious Execution via macOS Script Editor"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/04/05",
            "description": "Detects suspicious command lines that look as if they would create symbolic links to /etc/passwd",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "ln -s -f /etc/passwd",
                    "ln -s /etc/passwd"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c67fc22a-0be5-4b4f-aad5-2b32c4b69523",
            "level": "high",
            "logsource": {
                "product": "linux"
            },
            "modified": "2021/11/27",
            "references": [
                "https://www.qualys.com/2021/05/04/21nails/21nails.txt"
            ],
            "status": "test",
            "tags": [
                "attack.t1204.001",
                "attack.execution"
            ],
            "title": "Symlink Etc Passwd"
        }
    ]
}