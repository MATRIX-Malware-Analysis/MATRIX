{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--3a6ff13e-042b-40d4-95c2-89b170d4daa4",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.285757Z",
    "name": "Process Discovery",
    "description": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from Process Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.In Windows environments, adversaries could obtain details on running processes using the Tasklist utility via cmd or Get-Process via PowerShell. Information about processes can also be extracted from the output of Native API calls such as CreateToolhelp32Snapshot. In Mac and Linux, this is accomplished with the ps command. Adversaries may also opt to enumerate processes via /proc. On network devices, Network Device CLI commands such as show processes can be used to display current running processes.[1][2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1057",
            "external_id": "T1057"
        },
        {
            "source_name": "CAPEC 573",
            "external_id": "malware-behavior--591e670e-1551-4f57-abf8-ded8e379404d"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1057",
            "external_id": "T1057"
        },
        {
            "source_name": "show_processes_cisco_cmd",
            "description": "Cisco. (2022, August 16). show processes - . Retrieved July 13, 2022.",
            "url": "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/fundamentals/command/cf_command_ref/show_monitor_permit_list_through_show_process_memory.html#wp3599497760"
        },
        {
            "source_name": "US-CERT-TA18-106A",
            "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.",
            "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "compiled with Go"
                            },
                            {
                                "or": [
                                    {
                                        "string": "github.com/mitchellh/go-ps.FindProcess"
                                    },
                                    {
                                        "string": "github.com/mitchellh/go-ps.Processes"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]",
                        "Discovery::Software Discovery [T1518]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "description": "Enumerating processes using a Go library",
                    "name": "linked against Go process enumeration library",
                    "namespace": "host-interaction/process/list",
                    "references": [
                        "https://pkg.go.dev/github.com/mitchellh/go-ps"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "linux"
                            },
                            {
                                "match": "host-interaction/file-system/files/list"
                            },
                            {
                                "string": "/proc"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]",
                        "Discovery::Software Discovery [T1518]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "name": "enumerate processes via procfs",
                    "namespace": "host-interaction/process/list",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "System.Diagnostics.Process::GetProcessesByName"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "name": "find process by name",
                    "namespace": "host-interaction/process/list",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "kernel32.Thread32First"
                            },
                            {
                                "api": "kernel32.Thread32Next"
                            },
                            {
                                "optional": [
                                    {
                                        "basic block": [
                                            {
                                                "and": [
                                                    {
                                                        "or": [
                                                            {
                                                                "number": "0x4 = TH32CS_SNAPTHREAD"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "api": "kernel32.CreateToolhelp32Snapshot"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "call": [
                                            {
                                                "and": [
                                                    {
                                                        "or": [
                                                            {
                                                                "number": "0x4 = TH32CS_SNAPTHREAD"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "api": "kernel32.CreateToolhelp32Snapshot"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com"
                    ],
                    "examples": [
                        "Practical Malware Analysis Lab 05-01.dll_:0x10006BD5"
                    ],
                    "mbc": [
                        "Process::Enumerate Threads [C0064]"
                    ],
                    "name": "enumerate threads",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    },
                    "namespace": "host-interaction/thread/list"
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "PEB access"
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "arch": "i386"
                                            },
                                            {
                                                "number": "0x18 = PEB->ProcessHeap"
                                            },
                                            {
                                                "or": [
                                                    {
                                                        "number": "0x40 = ProcessHeap->HeapFlags >= Vista"
                                                    },
                                                    {
                                                        "number": "0xC = ProcessHeap->HeapFlags < Vista"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "arch": "amd64"
                                            },
                                            {
                                                "number": "0x30 = PEB->ProcessHeap"
                                            },
                                            {
                                                "or": [
                                                    {
                                                        "number": "0x70 = ProcessHeap->HeapFlags >= Vista"
                                                    },
                                                    {
                                                        "number": "0x14 = ProcessHeap->HeapFlags < Vista"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x425470"
                    ],
                    "name": "get process heap flags",
                    "namespace": "host-interaction/process",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13"
                    ],
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "PEB access"
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "arch": "i386"
                                            },
                                            {
                                                "number": "0x18 = PEB->ProcessHeap"
                                            },
                                            {
                                                "or": [
                                                    {
                                                        "number": "0x44 = ProcessHeap->ForceFlags >= Vista"
                                                    },
                                                    {
                                                        "number": "0x10 = ProcessHeap->ForceFlags < Vista"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "arch": "amd64"
                                            },
                                            {
                                                "number": "0x30 = PEB->ProcessHeap"
                                            },
                                            {
                                                "or": [
                                                    {
                                                        "number": "0x74 = ProcessHeap->ForceFlags >= Vista"
                                                    },
                                                    {
                                                        "number": "0x18 = ProcessHeap->ForceFlags < Vista"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x425470"
                    ],
                    "name": "get process heap force flags",
                    "namespace": "host-interaction/process",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14"
                    ],
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "optional": [
                                            {
                                                "or": [
                                                    {
                                                        "api": "kernel32.OpenProcess"
                                                    },
                                                    {
                                                        "api": "kernel32.CloseHandle"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "or": [
                                            {
                                                "api": "kernel32.K32EnumProcessModules"
                                            },
                                            {
                                                "api": "kernel32.K32EnumProcessModulesEx"
                                            },
                                            {
                                                "api": "kernel32.K32EnumProcesses"
                                            },
                                            {
                                                "api": "EnumProcessModules"
                                            },
                                            {
                                                "api": "EnumProcessModulesEx"
                                            },
                                            {
                                                "api": "EnumProcesses"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "api": "kernel32.Module32First"
                                    },
                                    {
                                        "api": "kernel32.Module32Next"
                                    },
                                    {
                                        "optional": [
                                            {
                                                "basic block": [
                                                    {
                                                        "and": [
                                                            {
                                                                "or": [
                                                                    {
                                                                        "number": "0x8 = TH32CS_SNAPMODULE"
                                                                    },
                                                                    {
                                                                        "number": "0x10 = TH32CS_SNAPMODULE32"
                                                                    },
                                                                    {
                                                                        "number": "0x18 = TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "api": "kernel32.CreateToolhelp32Snapshot"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "call": [
                                                    {
                                                        "and": [
                                                            {
                                                                "or": [
                                                                    {
                                                                        "number": "0x8 = TH32CS_SNAPMODULE"
                                                                    },
                                                                    {
                                                                        "number": "0x10 = TH32CS_SNAPMODULE32"
                                                                    },
                                                                    {
                                                                        "number": "0x18 = TH32CS_SNAPMODULE | TH32CS_SNAPMODULE32"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "api": "kernel32.CreateToolhelp32Snapshot"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "property/read": "System.Diagnostics.Process::Modules"
                                    },
                                    {
                                        "property/read": "System.Diagnostics.ProcessModuleCollection::Item"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "examples": [
                        "6F99A2C8944CB02FF28C6F9CED59B161:0x419FF8",
                        "9B2FD471274C41626B75DDBB5C897877:0x100046B0"
                    ],
                    "name": "enumerate process modules",
                    "namespace": "host-interaction/process/modules/list",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "GetShellWindow"
                            },
                            {
                                "api": "GetWindowThreadProcessId"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x86.exe_:0x425210"
                    ],
                    "name": "get Explorer PID",
                    "namespace": "host-interaction/process/list",
                    "references": [
                        "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/ParentProcess.cpp"
                    ],
                    "scopes": {
                        "dynamic": "thread",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "System.Diagnostics.Process::GetProcesses"
                            },
                            {
                                "and": [
                                    {
                                        "api": "kernel32.Process32First"
                                    },
                                    {
                                        "api": "kernel32.Process32Next"
                                    },
                                    {
                                        "optional": [
                                            {
                                                "basic block": [
                                                    {
                                                        "and": [
                                                            {
                                                                "or": [
                                                                    {
                                                                        "number": "0xF = TH32CS_SNAPALL"
                                                                    },
                                                                    {
                                                                        "number": "0x2 = TH32CS_SNAPPROCESS"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "api": "kernel32.CreateToolhelp32Snapshot"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "call": [
                                                    {
                                                        "and": [
                                                            {
                                                                "or": [
                                                                    {
                                                                        "number": "0xF = TH32CS_SNAPALL"
                                                                    },
                                                                    {
                                                                        "number": "0x2 = TH32CS_SNAPPROCESS"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "api": "kernel32.CreateToolhelp32Snapshot"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]",
                        "Discovery::Software Discovery [T1518]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com",
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "2D3EDC218A90F03089CC01715A9F047F:0x403DAB",
                        "35d04ecd797041eee796f4ddaa96cae8:0x10004F34"
                    ],
                    "name": "enumerate processes",
                    "namespace": "host-interaction/process/list",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "api": "wtsapi32.WTSEnumerateProcesses"
                                    },
                                    {
                                        "api": "wtsapi32.WTSEnumerateProcessesEx"
                                    }
                                ]
                            },
                            {
                                "optional": [
                                    {
                                        "or": [
                                            {
                                                "api": "wtsapi32.WTSFreeMemory"
                                            },
                                            {
                                                "api": "wtsapi32.WTSOpenServer"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "6f99a2c8944cb02ff28c6f9ced59b161:0x414B70"
                    ],
                    "name": "enumerate processes on remote desktop session host",
                    "namespace": "host-interaction/process/list",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "api": "ntoskrnl.PsLookupProcessByProcessId"
                                    },
                                    {
                                        "api": "System.Diagnostics.Process::GetProcessById"
                                    }
                                ]
                            },
                            {
                                "optional": [
                                    {
                                        "api": "ntoskrnl.ObfDereferenceObject"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "examples": [
                        "493167E85E45363D09495D0841C30648:0x404B00"
                    ],
                    "name": "find process by PID",
                    "namespace": "host-interaction/process/list",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "number": "0x5 = SYSTEM_PROCESS_INFORMATION"
                            },
                            {
                                "or": [
                                    {
                                        "api": "NtQuerySystemInformation"
                                    },
                                    {
                                        "api": "NtQuerySystemInformationEx"
                                    },
                                    {
                                        "api": "ZwQuerySystemInformation"
                                    },
                                    {
                                        "api": "ZwQuerySystemInformationEx"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Discovery::Process Discovery [T1057]",
                        "Discovery::Software Discovery [T1518]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "31bd8dd48ac0de3d4da340bf29f4d280:0x00401be3"
                    ],
                    "name": "enumerate processes via NtQuerySystemInformation",
                    "namespace": "host-interaction/process/list",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Find information about network devices that is not stored in config files",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "dir",
                    "show arp",
                    "show cdp",
                    "show clock",
                    "show ip interface",
                    "show ip route",
                    "show ip sockets",
                    "show processes",
                    "show ssh",
                    "show users",
                    "show version"
                ]
            },
            "falsepositives": [
                "Commonly used by administrators for troubleshooting"
            ],
            "id": "9705a6a1-6db6-4a16-a987-15b7151e299b",
            "level": "low",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "references": [
                "https://www.cisco.com/c/en/us/td/docs/server_nw_virtual/2-5_release/command_reference/show.html"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.t1083",
                "attack.t1201",
                "attack.t1057",
                "attack.t1018",
                "attack.t1082",
                "attack.t1016",
                "attack.t1049",
                "attack.t1033",
                "attack.t1124"
            ],
            "title": "Cisco Discovery"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2023/07/06",
            "description": "Detects the execution of a potential recon command where the results are piped to \"findstr\". This is meant to trigger on inline calls of \"cmd.exe\" via the \"/c\" or \"/k\" for example.\nAttackers often time use this technique to extract specific information they require in their reconnaissance phase.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "ipconfig*|*find",
                        "net*|*find",
                        "netstat*|*find",
                        "ping*|*find",
                        "systeminfo*|*find",
                        "tasklist*|*find",
                        "whoami*|*find"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ccb5742c-c248-4982-8c5c-5571b9275ad3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/02cb591f75064ffe1e0df9ac3ed5972a2e491c97/atomics/T1057/T1057.md#atomic-test-6---discover-specific-process---tasklist",
                "https://www.hhs.gov/sites/default/files/manage-engine-vulnerability-sector-alert-tlpclear.pdf",
                "https://www.trendmicro.com/en_us/research/22/d/spring4shell-exploited-to-deploy-cryptocurrency-miners.html"
            ],
            "related": [
                {
                    "id": "fe63010f-8823-4864-a96b-a7b4a0f7b929",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.discovery",
                "attack.t1057"
            ],
            "title": "Recon Command Output Piped To Findstr.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali",
            "date": "2022/10/10",
            "description": "Detects suspicious use of PCHunter, a tool like Process Hacker to view and manipulate processes, kernel options and other low level stuff",
            "detection": {
                "condition": "1 of selection_*",
                "selection_hash_values": [
                    {
                        "md5": [
                            "228dd0c2e6287547e26ffbd973a40f14",
                            "987b65cd9b9f4e9a1afd8f8b48cf64a7"
                        ]
                    },
                    {
                        "sha1": [
                            "5f1cbc3d99558307bc1250d084fa968521482025",
                            "3fb89787cb97d902780da080545584d97fb1c2eb"
                        ]
                    },
                    {
                        "sha256": [
                            "2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32",
                            "55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c"
                        ]
                    },
                    {
                        "Imphash": [
                            "444d210cea1ff8112f256a4997eed7ff",
                            "0479f44df47cfa2ef1ccc4416a538663"
                        ]
                    }
                ],
                "selection_hashes": {
                    "Hashes|contains": [
                        "SHA1=5F1CBC3D99558307BC1250D084FA968521482025",
                        "MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7",
                        "SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32",
                        "IMPHASH=444D210CEA1FF8112F256A4997EED7FF",
                        "SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB",
                        "MD5=228DD0C2E6287547E26FFBD973A40F14",
                        "SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C",
                        "IMPHASH=0479F44DF47CFA2EF1CCC4416A538663"
                    ]
                },
                "selection_image": {
                    "Image|endswith": [
                        "\\PCHunter64.exe",
                        "\\PCHunter32.exe"
                    ]
                },
                "selection_pe": [
                    {
                        "OriginalFileName": "PCHunter.exe"
                    },
                    {
                        "Description": "Epoolsoft Windows Information View Tools"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "fca949cc-79ca-446e-8064-01aa7e52ece5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "http://www.xuetr.com/",
                "https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/",
                "https://www.hexacorn.com/blog/2018/04/20/kernel-hacking-tool-you-might-have-never-heard-of-xuetr-pchunter/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1082",
                "attack.t1057",
                "attack.t1012",
                "attack.t1083",
                "attack.t1007"
            ],
            "title": "HackTool - PCHunter Execution"
        },
        {
            "author": "frack113",
            "date": "2022/03/17",
            "description": "Get the processes that are running on the local computer.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": "Get-Process"
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "af4c87ce-bdda-4215-b998-15220772e993",
            "level": "low",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1057/T1057.md#atomic-test-3---process-discovery---get-process",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process?view=powershell-7.4"
            ],
            "status": "test",
            "title": "Suspicious Process Discovery With Get-Process",
            "tags": [
                "attack.discovery",
                "attack.t1057"
            ]
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/06",
            "description": "Detects process discovery commands. Adversaries may attempt to get information about running processes on a system.\nInformation obtained could be used to gain an understanding of common software/applications running on systems within the network\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/ps",
                        "/top"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "4e2f5868-08d4-413d-899f-dc2f1508627b",
            "level": "informational",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/07/07",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1057/T1057.md"
            ],
            "status": "stable",
            "title": "Process Discovery",
            "tags": [
                "attack.discovery",
                "attack.t1057"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Austin Clark, @c2defense"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "discovery"
        }
    ],
    "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events that look like process discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nFor network infrastructure devices, collect AAA logging to monitor for `show` commands being run by non-standard users from non-standard locations.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.5",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Process: OS API Execution",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": []
}