{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--3db94503-befa-463b-8013-587383f93e62",
    "created": "2024-08-13T14:46:37.087846Z",
    "modified": "2024-08-13T14:46:45.929634Z",
    "name": "Exfiltration Over Web Service: Exfiltration to Code Repository",
    "description": "Adversaries may exfiltrate data to a code repository rather than over their primary command and control channel. Code repositories are often accessible via an API (ex: https://api.github.com). Access to these APIs are often over HTTPS, which gives the adversary an additional level of protection.Exfiltration to a code repository can also provide a significant amount of cover to the adversary if it is a popular service already used by hosts within the network.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1567/001",
            "external_id": "T1567/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Kamran Saifullah, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/05/27",
            "description": "Detects network connections to Cloudflared tunnels domains initiated by a process on the system.\nAttackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        ".v2.argotunnel.com",
                        "protocol-v2.argotunnel.com",
                        "trycloudflare.com",
                        "update.argotunnel.com"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of cloudflare tunnels will also trigger this."
            ],
            "id": "7cd1dcdc-6edf-4896-86dc-d1f19ad64903",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://defr0ggy.github.io/research/Abusing-Cloudflared-A-Proxy-Service-To-Host-Share-Applications/",
                "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/",
                "Internal Research"
            ],
            "related": [
                {
                    "id": "a1d9eec5-33b2-4177-8d24-27fe754d0812",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To Cloudflared Tunnels Domains"
        },
        {
            "author": "Kamran Saifullah",
            "date": "2023/11/20",
            "description": "Detects network connections to Visual Studio Code tunnel domains initiated by a process on a system. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": ".tunnels.api.visualstudio.com",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of Visual Studio Code tunnel will also trigger this."
            ],
            "id": "4b657234-038e-4ad5-997c-4be42340bce4",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://ipfyx.fr/post/visual-studio-code-tunnel/",
                "https://badoption.eu/blog/2023/01/31/code_c2.html",
                "https://cydefops.com/vscode-data-exfiltration"
            ],
            "related": [
                {
                    "id": "9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4",
                    "type": "similar"
                },
                {
                    "id": "b3e6418f-7c7a-4fad-993a-93b65027a9f1",
                    "type": "similar"
                },
                {
                    "id": "1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To Visual Studio Code Tunnels Domain"
        },
        {
            "id": "9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4",
            "author": "Kamran Saifullah",
            "date": "2023/11/20",
            "description": "Detects network connections to Devtunnels domains initiated by a process on a system. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": ".devtunnels.ms",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of Devtunnels will also trigger this."
            ],
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://blueteamops.medium.com/detecting-dev-tunnels-16f0994dc3e2",
                "https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/security",
                "https://cydefops.com/devtunnels-unleashed"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "4b657234-038e-4ad5-997c-4be42340bce4"
                },
                {
                    "id": "b3e6418f-7c7a-4fad-993a-93b65027a9f1",
                    "type": "similar"
                },
                {
                    "id": "1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To DevTunnels Domain"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/07/16",
            "description": "Detects an executable initiating a network connection to \"ngrok\" domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        ".ngrok-free.app",
                        ".ngrok-free.dev",
                        ".ngrok.app",
                        ".ngrok.dev",
                        ".ngrok.io"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of the ngrok service."
            ],
            "id": "18249279-932f-45e2-b37a-8925f2597670",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2023/11/17",
            "references": [
                "https://ngrok.com/",
                "https://ngrok.com/blog-post/new-ngrok-domains",
                "https://www.virustotal.com/gui/file/cca0c1182ac114b44dc52dd2058fcd38611c20bb6b5ad84710681d38212f835a/",
                "https://www.rnbo.gov.ua/files/2023_YEAR/CYBERCENTER/november/APT29%20attacks%20Embassies%20using%20CVE-2023-38831%20-%20report%20en.pdf"
            ],
            "related": [
                {
                    "id": "1d08ac94-400d-4469-a82f-daee9a908849",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Process Initiated Network  Connection To Ngrok Domain"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/12/06",
            "description": "Detects a network connection initiated by a binary to \"api.mega.co.nz\".\nAttackers were seen abusing file sharing websites similar to \"mega.nz\" in order to upload/download additional payloads.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        "mega.co.nz",
                        "mega.nz"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate MEGA installers and utilities are expected to communicate with this domain. Exclude hosts that are known to be allowed to use this tool."
            ],
            "id": "fdeebdf0-9f3f-4d08-84a6-4c4d13e39fe4",
            "level": "low",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/05/31",
            "references": [
                "https://megatools.megous.com/",
                "https://www.mandiant.com/resources/russian-targeting-gov-business"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To Mega.nz"
        }
    ]
}