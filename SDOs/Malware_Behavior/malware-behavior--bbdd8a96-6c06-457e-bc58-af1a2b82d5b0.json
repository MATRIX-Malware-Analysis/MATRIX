{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--bbdd8a96-6c06-457e-bc58-af1a2b82d5b0",
    "created": "2024-08-13T14:46:37.063055Z",
    "modified": "2024-08-13T14:46:48.58468Z",
    "name": "Boot or Logon Initialization Scripts: RC Scripts",
    "description": "Adversaries may establish persistence by modifying RC scripts which are executed during a Unix-like system\u2019s startup. These files allow system administrators to map and start custom services at startup for different run levels. RC scripts require root privileges to modify.Adversaries can establish persistence by adding a malicious binary path or shell commands to rc.local, rc.common, and other RC scripts specific to the Unix-like distribution.[1][2] Upon reboot, the system executes the script's contents as root, resulting in persistence.Adversary abuse of RC scripts is especially effective for lightweight Unix-like distributions using the root user as default, such as IoT or embedded systems.[3]Several Unix-like systems have moved to Systemd and deprecated the use of RC scripts. This is now a deprecated mechanism in macOS in favor of Launchd. [4][5] This technique can be used on Mac OS X Panther v10.3 and earlier versions which still execute the RC scripts.[6] To maintain backwards compatibility some systems, such as Ubuntu, will execute the RC scripts if they exist with the correct file permissions.[7]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1037/004",
            "external_id": "T1037/004"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "linux"
                            },
                            {
                                "match": "host-interaction/file-system/write"
                            },
                            {
                                "or": [
                                    {
                                        "substring": "/etc/init.d/"
                                    },
                                    {
                                        "string": "/\\/etc\\/rc[0-9].d\\//"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Boot or Logon Initialization Scripts::RC Scripts [T1037.004]"
                    ],
                    "authors": [
                        "joakim@intezer.com"
                    ],
                    "examples": [
                        "7351f8a40c5450557b24622417fc478d:0x407D11"
                    ],
                    "name": "persist via rc script",
                    "namespace": "persistence/service",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ]
}