{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--86cf6581-cbe7-4468-b6a7-fa247ba1da8f",
    "created": "2019-08-01T00:00:00.000Z",
    "modified": "2023-05-08T00:00:00.000Z",
    "name": "Executable Code Virtualization",
    "description": "",
    "labels": [
        "malware-behavior"
    ],
    "object_marking_refs": [
        "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
    ],
    "x_mitre_platforms": [],
    "x_mitre_domains": [],
    "x_mitre_contributors": [],
    "kill_chain_phases": [],
    "x_mitre_detection": "",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "",
    "x_mitre_data_sources": [],
    "x_mitre_permissions_required": [],
    "external_references": [
        {
            "source_name": "xu-ming-fu-wu",
            "description": "D. Xu, J. Ming, Y. Fu, and D. Wu, \"Verifiable Approach to Partially-Virtualized Binary Code Simplification,\" in 2018 ACM SIGSAC Conference on Computer and Communications Security (CCS \u201918),Toronto, ON, Canada, pp. 442-458, [Online]. ",
            "url": "https://doi.org/10.1145/3243734.3243827"
        },
        {
            "source_name": "hr\u010dka",
            "description": "V. Hr\u010dka, \"Under the hood of Wslink\u2019s multilayered virtual machine,\" welivesecurity.com, 28 March 2022 [Online].",
            "url": "https://www.welivesecurity.com/2022/03/28/under-hood-wslink-multilayered-virtual-machine"
        },
        {
            "source_name": "malwarebytes-locky-bart",
            "description": "\"Locky Bart ransomware and backend server analysis,\" Malwarebytes Labs, blog, Jan. 31, 2017 [Online].",
            "url": "https://blog.malwarebytes.com/threat-analysis/2017/01/locky-bart-ransomware-and-backend-server-analysis/"
        }
    ],
    "obj_defn": {
        "description": "Code virtualization obfuscates code to hinder static analysis and reverse engineering of the binary, allowing successful masking of the code\u2019s malicious behavior.  Code virtualization selects specific parts of original executable code and transforms them \u201cto bytecode in a new, custom virtual instruction set architecture (ISA)\u201d[1].  As explained further in [1], \u201cAt execution time, the bytecode is emulated by an embedded virtual machine (or interpreter) on the real machine. The new ISA can be designed independently, and thus the bytecode and interpreter greatly differ from those in every protected instance. In this way, the program\u2019s original code never reappears.\u201d \n\nWhile malicious actors can create a custom VM-based obfuscator as observed in Wslink [2], other options are available to them such as Themida, a commercial tool, and VMProtect, an open source tool.",
        "external_id": "B0008",
        "source_name": "mitre-mbc",
        "url": "https://github.com/MBCProject/mbc-markdown/blob/main/anti-static-analysis/executable-code-virtualization.md"
    },
    "detection_rules": [],
    "tags": {
        "Anti-Analysis-Type": "Evasion"
    }
}