{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--cd0f4255-d48b-4b77-9c66-270fdc6c7a4f",
    "created": "2024-08-13T14:46:37.134109Z",
    "modified": "2024-08-13T14:46:46.220307Z",
    "name": "Remote Service Session Hijacking: RDP Hijacking",
    "description": "Adversaries may hijack a legitimate user\u2019s remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).[1]Adversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, c:\\windows\\system32\\tscon.exe [session number to be stolen], an adversary can hijack a session without the need for credentials or prompts to the user.[2] This can be done remotely or locally and with active or disconnected sessions.[3] It can also lead to Remote System Discovery and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in red teaming tools.[4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1563/002",
            "external_id": "T1563/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/01/24",
            "description": "Detects RDP session hijacking by using MSTSC shadowing",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "noconsentprompt",
                        "shadow:"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6ba5a05f-b095-4f0a-8654-b825f4f16334",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/05",
            "references": [
                "https://twitter.com/kmkz_security/status/1220694202301976576",
                "https://github.com/kmkz/Pentesting/blob/47592e5e160d3b86c2024f09ef04ceb87d204995/Post-Exploitation-Cheat-Sheet"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1563.002"
            ],
            "title": "Potential MSTSC Shadowing Activity"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/03/17",
            "description": "Detects a suspicious RDP session redirect using tscon.exe",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": " /dest:rdp-tcp#"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/16",
            "references": [
                "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html",
                "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6",
                "https://www.hackingarticles.in/rdp-session-hijacking-with-tscon/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1563.002",
                "attack.t1021.001",
                "car.2013-07-002"
            ],
            "title": "Suspicious RDP Redirect Using TSCON"
        }
    ]
}