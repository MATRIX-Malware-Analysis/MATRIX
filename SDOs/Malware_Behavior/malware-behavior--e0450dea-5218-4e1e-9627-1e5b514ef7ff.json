{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--e0450dea-5218-4e1e-9627-1e5b514ef7ff",
    "created": "2024-08-13T14:46:36.652346Z",
    "modified": "2024-08-13T14:46:36.652346Z",
    "name": "Kerberoasting",
    "description": "Through the exploitation of how service accounts leverage Kerberos authentication with Service Principal Names (SPNs), the adversary obtains and subsequently cracks the hashed credentials of a service account target to exploit its privileges. The Kerberos authentication protocol centers around a ticketing system which is used to request/grant access to services and to then access the requested services. As an authenticated user, the adversary may request Active Directory and obtain a service ticket with portions encrypted via RC4 with the private key of the authenticated account. By extracting the local ticket and saving it disk, the adversary can brute force the hashed value to reveal the target account credentials.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/509.html",
            "external_id": "509"
        },
        {
            "source_name": "CWE",
            "external_id": "522"
        },
        {
            "source_name": "CWE",
            "external_id": "308"
        },
        {
            "source_name": "CWE",
            "external_id": "309"
        },
        {
            "source_name": "CWE",
            "external_id": "294"
        },
        {
            "source_name": "CWE",
            "external_id": "263"
        },
        {
            "source_name": "CWE",
            "external_id": "262"
        },
        {
            "source_name": "CWE",
            "external_id": "521"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "PowerSploit's Invoke-Kerberoast module can be leveraged to request Ticket Granting Service (TGS) tickets and return crackable ticket hashes. [REF-585] [REF-586]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "Scan for user accounts with set SPN values",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "These can be found via Powershell or LDAP queries, as well as enumerating startup name accounts and other means."
            ]
        },
        {
            "description": "Request service tickets",
            "phase": "Explore",
            "step": "2",
            "techniques": [
                "Using user account's SPN value, request other service tickets from Active Directory"
            ]
        },
        {
            "description": "Extract ticket and save to disk",
            "phase": "Experiment",
            "step": "3",
            "techniques": [
                "Certain tools like Mimikatz can extract local tickets and save them to memory/disk."
            ]
        },
        {
            "description": "Crack the encrypted ticket to harvest plain text credentials",
            "phase": "Exploit",
            "step": "4",
            "techniques": [
                "Leverage a brute force application/script on the hashed value offline until cracked. The shorter the password, the easier it is to crack."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Unknown",
    "x_mitre_mitigations": [
        {
            "description": "Monitor system and domain logs for abnormal access."
        },
        {
            "description": "Employ a robust password policy for service accounts. Passwords should be of adequate length and complexity, and they should expire after a period of time."
        },
        {
            "description": "Employ the principle of least privilege: limit service accounts privileges to what is required for functionality and no more."
        },
        {
            "description": "Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible."
        }
    ]
}