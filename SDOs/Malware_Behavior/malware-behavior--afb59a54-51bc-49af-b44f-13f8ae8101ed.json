{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--afb59a54-51bc-49af-b44f-13f8ae8101ed",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.940075Z",
    "name": "Hijack Execution Flow: Path Interception by Search Order Hijacking",
    "description": "Adversaries may execute their own malicious payloads by hijacking the search order used to load other programs. Because some programs do not call other programs using the full path, adversaries may place their own file in the directory where the calling program is located, causing the operating system to launch their malicious software at the request of the calling program.Search order hijacking occurs when an adversary abuses the order in which Windows searches for programs that are not given a path. Unlike DLL Search Order Hijacking, the search order differs depending on the method that is used to execute the program. [1] [2] [3] However, it is common for Windows to search in the directory of the initiating program before searching through the Windows system directory. An adversary who finds a program vulnerable to search order hijacking (i.e., a program that does not specify the path to an executable) may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory.For example, 'example.exe' runs 'cmd.exe' with the command-line argument net user. An adversary may place a program called 'net.exe' within the same directory as example.exe, 'net.exe' will be run instead of the Windows system utility net. In addition, if an adversary places a program called 'net.com' in the same directory as 'net.exe', then cmd.exe /C net user will execute 'net.com' instead of 'net.exe' due to the order of executable extensions defined under PATHEXT. [4]Search order hijacking is also a common practice for hijacking DLL loads and is covered in DLL Search Order Hijacking.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1574/008",
            "external_id": "T1574/008"
        },
        {
            "source_name": "CAPEC 159",
            "external_id": "malware-behavior--6b064593-b3ed-428a-bf12-1423018331bd"
        },
        {
            "source_name": "CAPEC 471",
            "external_id": "malware-behavior--d0720e03-d221-4ec6-a5ef-a30b15d442af"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Anton Kutepov, oscd.community",
            "date": "2020/02/05",
            "description": "Detects using SettingSyncHost.exe to run hijacked binary",
            "detection": {
                "condition": "not system_utility and parent_is_settingsynchost",
                "parent_is_settingsynchost": {
                    "ParentCommandLine|contains|all": [
                        "cmd.exe /c",
                        "RoamDiag.cmd",
                        "-outputpath"
                    ]
                },
                "system_utility": {
                    "Image|startswith": [
                        "C:\\Windows\\System32\\",
                        "C:\\Windows\\SysWOW64\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "TargetFilename",
                "Image"
            ],
            "id": "b2ddd389-f676-4ac4-845a-e00781a48e5f",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://www.hexacorn.com/blog/2020/02/02/settingsynchost-exe-as-a-lolbin"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1574.008"
            ],
            "title": "Using SettingSyncHost.exe as LOLBin"
        }
    ]
}