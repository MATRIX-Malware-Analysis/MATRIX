{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6966cf5f-a25e-412d-9427-5e47a2da0cec",
    "created": "2024-08-13T14:46:36.677834Z",
    "modified": "2024-08-13T14:46:36.677834Z",
    "name": "Key Negotiation of Bluetooth Attack (KNOB)",
    "description": "An adversary can exploit a flaw in Bluetooth key negotiation allowing them to decrypt information sent between two devices communicating via Bluetooth. The adversary uses an Adversary in the Middle setup to modify packets sent between the two devices during the authentication process, specifically the entropy bits. Knowledge of the number of entropy bits will allow the attacker to easily decrypt information passing over the line of communication.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/668.html",
            "external_id": "668"
        },
        {
            "source_name": "CWE",
            "external_id": "425"
        },
        {
            "source_name": "CWE",
            "external_id": "285"
        },
        {
            "source_name": "CWE",
            "external_id": "693"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Confidentiality"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Access Control"
        },
        {
            "impact": "Bypass Protection Mechanism",
            "scope": "Authorization"
        },
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "Given users Alice, Bob and Charlie (Charlie being the attacker), Alice and Bob begin to agree on an encryption key when connecting. While Alice sends a message to Bob that an encryption key with 16 bytes of entropy should be used, Charlie changes this to 1 and forwards the request to Bob and continues forwarding these packets until authentication is successful."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Discovery] Using an established Person in the Middle setup, search for Bluetooth devices beginning the authentication process.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Use packet capture tools."
            ]
        },
        {
            "description": "[Change the entropy bits] Upon recieving the initial key negotiation packet from the master, the adversary modifies the entropy bits requested to 1 to allow for easy decryption before it is forwarded.",
            "phase": "Experiment",
            "step": "2",
            "techniques": []
        },
        {
            "description": "[Capture and decrypt data] Once the entropy of encryption is known, the adversary can capture data and then decrypt on their device.",
            "phase": "Exploit",
            "step": "3",
            "techniques": []
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Low",
    "x_mitre_mitigations": [
        {
            "description": "Newer Bluetooth firmwares ensure that the KNOB is not negotaited in plaintext. Update your device."
        }
    ]
}