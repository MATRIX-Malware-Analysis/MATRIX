{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--ac474ec6-b3c3-4af2-9b56-9f3210a70109",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.362021Z",
    "name": "Clipboard Data",
    "description": "Adversaries may collect data stored in the clipboard from users copying information within or between applications. For example, on Windows adversaries can access clipboard data by using clip.exe or Get-Clipboard.[1][2][3] Additionally, adversaries may monitor then replace users\u2019 clipboard with their data (e.g., Transmitted Data Manipulation).[4]macOS and Linux also have commands, such as pbpaste, to grab clipboard contents.[5]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1115",
            "external_id": "T1115"
        },
        {
            "source_name": "CAPEC 637",
            "external_id": "malware-behavior--69fb1959-2d17-4cce-8fc2-1ffb6e8935e9"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1115",
            "external_id": "T1115"
        },
        {
            "source_name": "CISA_AA21_200B",
            "description": "CISA. (2021, August 20). Alert (AA21-200B) Chinese State-Sponsored Cyber Operations: Observed TTPs. Retrieved June 21, 2022.",
            "url": "https://www.cisa.gov/uscert/ncas/alerts/aa21-200b"
        },
        {
            "source_name": "mining_ruby_reversinglabs",
            "description": "Maljic, T. (2020, April 16). Mining for malicious Ruby gems. Retrieved October 15, 2022.",
            "url": "https://blog.reversinglabs.com/blog/mining-for-malicious-ruby-gems"
        },
        {
            "source_name": "clip_win_server",
            "description": "Microsoft, JasonGerend, et al. (2023, February 3). clip. Retrieved June 21, 2022.",
            "url": "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/clip"
        },
        {
            "source_name": "MSDN Clipboard",
            "description": "Microsoft. (n.d.). About the Clipboard. Retrieved March 29, 2016.",
            "url": "https://msdn.microsoft.com/en-us/library/ms649012"
        },
        {
            "source_name": "Operating with EmPyre",
            "description": "rvrsh3ll. (2016, May 18). Operating with EmPyre. Retrieved July 12, 2017.",
            "url": "https://medium.com/rvrsh3ll/operating-with-empyre-ea764eda3363"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "compiled to the .NET platform"
                            },
                            {
                                "string": "SharpClipboard"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "@johnk3r"
                    ],
                    "examples": [
                        "387f15043f0198fd3a637b0758c2b6dde9ead795c3ed70803426fc355731b173"
                    ],
                    "mbc": [
                        "Collection::Input Capture [E1056]"
                    ],
                    "name": "use .NET library SharpClipboard",
                    "namespace": "collection",
                    "references": [
                        "https://www.welivesecurity.com/2021/04/06/janeleiro-time-traveler-new-old-banking-trojan-brazil/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "shell32.DragQueryFile"
                            },
                            {
                                "and": [
                                    {
                                        "api": "user32.GetClipboardData"
                                    },
                                    {
                                        "number": "0xF = HDROP"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "list drag and drop files",
                    "namespace": "host-interaction/clipboard",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "System.Windows.Forms.Clipboard::ContainsAudio"
                            },
                            {
                                "api": "System.Windows.Forms.Clipboard::ContainsData"
                            },
                            {
                                "api": "System.Windows.Forms.Clipboard::ContainsFileDropList"
                            },
                            {
                                "api": "System.Windows.Forms.Clipboard::ContainsImage"
                            },
                            {
                                "api": "System.Windows.Forms.Clipboard::ContainsText"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "name": "check clipboard data",
                    "namespace": "host-interaction/clipboard",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "user32.AddClipboardFormatListener"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "monitor clipboard content",
                    "namespace": "host-interaction/clipboard",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "System.Windows.Forms.Clipboard::Clear"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "name": "clear clipboard data",
                    "namespace": "host-interaction/clipboard",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "optional": [
                                    {
                                        "match": "open clipboard"
                                    },
                                    {
                                        "match": "contain loop"
                                    },
                                    {
                                        "api": "kernel32.GlobalAlloc"
                                    },
                                    {
                                        "api": "kernel32.GlobalLock"
                                    },
                                    {
                                        "api": "kernel32.GlobalUnlock"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "basic block": [
                                            {
                                                "and": [
                                                    {
                                                        "api": "user32.GetClipboardData"
                                                    },
                                                    {
                                                        "optional": [
                                                            {
                                                                "number": "0x1 = CF_TEXT"
                                                            },
                                                            {
                                                                "number": "0x7 = CF_OEMTEXT"
                                                            },
                                                            {
                                                                "number": "0xD = CF_UNICODETEXT"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "call": [
                                            {
                                                "and": [
                                                    {
                                                        "api": "user32.GetClipboardData"
                                                    },
                                                    {
                                                        "optional": [
                                                            {
                                                                "number": "0x1 = CF_TEXT"
                                                            },
                                                            {
                                                                "number": "0x7 = CF_OEMTEXT"
                                                            },
                                                            {
                                                                "number": "0xD = CF_UNICODETEXT"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "api": "System.Windows.Forms.Clipboard::GetAudioStream"
                                    },
                                    {
                                        "api": "System.Windows.Forms.Clipboard::GetData"
                                    },
                                    {
                                        "api": "System.Windows.Forms.Clipboard::GetDataObject"
                                    },
                                    {
                                        "api": "System.Windows.Forms.Clipboard::GetFileDropList"
                                    },
                                    {
                                        "api": "System.Windows.Forms.Clipboard::GetImage"
                                    },
                                    {
                                        "api": "System.Windows.Forms.Clipboard::GetText"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com",
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "examples": [
                        "C91887D861D9BD4A5872249B641BC9F9:0x40156F",
                        "93dfc146f60bd796eb28d4e4f348f2e4:0x401050"
                    ],
                    "name": "read clipboard data",
                    "namespace": "host-interaction/clipboard",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    },
                    "references": [
                        "https://learn.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard"
                    ]
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "user32.OpenClipboard"
                            },
                            {
                                "optional": [
                                    {
                                        "api": "user32.CloseClipboard"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Collection::Clipboard Data [T1115]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "6f99a2c8944cb02ff28c6f9ced59b161:0x403180"
                    ],
                    "name": "open clipboard",
                    "namespace": "host-interaction/clipboard",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Sohan G (D4rkCiph3r)",
            "date": "2023/01/31",
            "description": "Detects possible collection of data from the clipboard via execution of the osascript binary",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "osascript",
                        " -e ",
                        "clipboard"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "fields": [
                "CommandLine"
            ],
            "id": "7794fa3c-edea-4cff-bec7-267dd4770fd7",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://www.sentinelone.com/blog/how-offensive-actors-use-applescript-for-attacking-macos/"
            ],
            "related": [
                {
                    "id": "1bc2e6c5-0885-472b-bed6-be5ea8eace55",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.execution",
                "attack.t1115",
                "attack.t1059.002"
            ],
            "title": "Clipboard Data Collection Via OSAScript"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/05/02",
            "description": "Detects usage of the 'Get-Clipboard' cmdlet via CLI",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "Get-Clipboard"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b9aeac14-2ffd-4ad3-b967-1354a4e628c3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/16",
                "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md"
            ],
            "related": [
                {
                    "id": "4cbd4f12-2e22-43e3-882f-bff3247ffb78",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1115"
            ],
            "title": "PowerShell Get-Clipboard Cmdlet Via CLI"
        },
        {
            "author": "frack113",
            "date": "2021/07/27",
            "description": "Detects the execution of clip.exe in order to copy data to the clipboard. Adversaries may collect data stored in the clipboard from users copying information within or between applications.",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\clip.exe"
                    },
                    {
                        "OriginalFileName": "clip.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ddeff553-5233-4ae9-bbab-d64d2bd634be",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/clip",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1115/T1115.md"
            ],
            "status": "test",
            "title": "Data Copied To Clipboard Via Clip.EXE",
            "tags": [
                "attack.collection",
                "attack.t1115"
            ]
        },
        {
            "id": "4cbd4f12-2e22-43e3-882f-bff3247ffb78",
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "A General detection for the Get-Clipboard commands in PowerShell logs. This could be an adversary capturing clipboard contents.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Payload|contains": "Get-Clipboard"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_module",
                "product": "windows",
                "definition": "0ad03ef1-f21b-4a79-8ce8-e6900c54b65b"
            },
            "modified": "2023/01/04",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/16",
                "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/7.A.2_F4609F7E-C4DB-4327-91D4-59A58C962A02.md"
            ],
            "status": "test",
            "title": "PowerShell Get Clipboard",
            "tags": [
                "attack.collection",
                "attack.t1115"
            ]
        },
        {
            "author": "Pawel Mazur, Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed.\nHighly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "-sel",
                        "clip",
                        "-o"
                    ],
                    "Image|contains": "xclip"
                }
            },
            "falsepositives": [
                "Legitimate usage of xclip tools."
            ],
            "id": "ec127035-a636-4b9a-8555-0efd4e59f316",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://www.packetlabs.net/posts/clipboard-data-security/"
            ],
            "status": "test",
            "title": "Clipboard Collection with Xclip Tool",
            "tags": [
                "attack.collection",
                "attack.t1115"
            ]
        },
        {
            "author": "Pawel Mazur",
            "date": "2021/09/24",
            "description": "Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool.\nXclip has to be installed.\nHighly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0": "xclip",
                    "a1": [
                        "-selection",
                        "-sel"
                    ],
                    "a2": [
                        "clipboard",
                        "clip"
                    ],
                    "a3": "-o",
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Legitimate usage of xclip tools"
            ],
            "id": "214e7e6c-f21b-47ff-bb6f-551b2d143fcf",
            "level": "low",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/11/26",
            "references": [
                "https://linux.die.net/man/1/xclip",
                "https://www.cyberciti.biz/faq/xclip-linux-insert-files-command-output-intoclipboard/"
            ],
            "status": "test",
            "title": "Clipboard Collection with Xclip Tool - Auditd",
            "tags": [
                "attack.collection",
                "attack.t1115"
            ]
        },
        {
            "author": "Pawel Mazur",
            "date": "2021/10/01",
            "description": "Detects attempts to collect image data stored in the clipboard from users with the usage of xclip tool.\nXclip has to be installed.\nHighly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0": "xclip",
                    "a1": [
                        "-selection",
                        "-sel"
                    ],
                    "a2": [
                        "clipboard",
                        "clip"
                    ],
                    "a3": "-t",
                    "type": "EXECVE",
                    "a4|startswith": "image/",
                    "a5": "-o"
                }
            },
            "falsepositives": [
                "Legitimate usage of xclip tools"
            ],
            "id": "f200dc3f-b219-425d-a17e-c38467364816",
            "level": "low",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/10/09",
            "references": [
                "https://linux.die.net/man/1/xclip"
            ],
            "status": "test",
            "title": "Clipboard Collection of Image Data with Xclip Tool",
            "tags": [
                "attack.collection",
                "attack.t1115"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "Windows",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "collection"
        }
    ],
    "x_mitre_detection": "Access to the clipboard is a legitimate function of many applications on an operating system. If an organization chooses to monitor for this behavior, then the data will likely need to be correlated against other suspicious or non-user-driven activity.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: OS API Execution",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": []
}