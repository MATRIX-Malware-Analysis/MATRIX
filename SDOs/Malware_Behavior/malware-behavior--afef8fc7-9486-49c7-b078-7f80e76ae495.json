{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--afef8fc7-9486-49c7-b078-7f80e76ae495",
    "created": "2024-08-13T14:46:36.895709Z",
    "modified": "2024-08-13T14:46:44.840726Z",
    "name": "Exploitation for Client Execution",
    "description": "Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.Several types exist:Browser-based ExploitationWeb browsers are a common target through Drive-by Compromise and Spearphishing Link. Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.Office ApplicationsCommon office and productivity applications such as Microsoft Office are also targeted through Phishing. Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.Common Third-party ApplicationsOther applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1203",
            "external_id": "T1203"
        },
        {
            "source_name": "mitre-attack",
            "external_id": "T1203",
            "url": "https://attack.mitre.org/techniques/T1203"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems), Arnim Rupp",
            "date": "2018/09/09",
            "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Signature|contains": [
                        "Backdoor.Cobalt",
                        "Brutel",
                        "BruteR",
                        "CobaltStr",
                        "CobaltStrike",
                        "COBEACON",
                        "Cometer",
                        "Exploit.Script.CVE",
                        "IISExchgSpawnCMD",
                        "Metasploit",
                        "Meterpreter",
                        "MeteTool",
                        "Mpreter",
                        "MsfShell",
                        "PowerSploit",
                        "Razy",
                        "Rozena",
                        "Sbelt",
                        "Seatbelt",
                        "Sliver",
                        "Swrort"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
            "level": "critical",
            "logsource": {
                "category": "antivirus"
            },
            "modified": "2024/07/17",
            "references": [
                "https://www.nextron-systems.com/?s=antivirus",
                "https://www.virustotal.com/gui/file/925b0b28472d4d79b4bf92050e38cc2b8f722691c713fc28743ac38551bc3797",
                "https://www.virustotal.com/gui/file/8f8daabe1c8ceb5710949283818e16c4aa8059bf2ce345e2f2c90b8692978424",
                "https://www.virustotal.com/gui/file/d9669f7e3eb3a9cdf6a750eeb2ba303b5ae148a43e36546896f1d1801e912466"
            ],
            "status": "stable",
            "tags": [
                "attack.execution",
                "attack.t1203",
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Antivirus Exploitation Framework Detection"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/11/07",
            "description": "Detects download of certain file types from hosts in suspicious TLDs",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri-extension": [
                        "exe",
                        "vbs",
                        "bat",
                        "rar",
                        "ps1",
                        "doc",
                        "docm",
                        "xls",
                        "xlsm",
                        "pptm",
                        "rtf",
                        "hta",
                        "dll",
                        "ws",
                        "wsf",
                        "sct",
                        "zip"
                    ],
                    "cs-host|endswith": [
                        ".country",
                        ".stream",
                        ".gdn",
                        ".mom",
                        ".xin",
                        ".kim",
                        ".men",
                        ".loan",
                        ".download",
                        ".racing",
                        ".online",
                        ".science",
                        ".ren",
                        ".gb",
                        ".win",
                        ".top",
                        ".review",
                        ".vip",
                        ".party",
                        ".tech",
                        ".xyz",
                        ".date",
                        ".faith",
                        ".zip",
                        ".cricket",
                        ".space",
                        ".info",
                        ".vn",
                        ".cm",
                        ".am",
                        ".cc",
                        ".asia",
                        ".ws",
                        ".tk",
                        ".biz",
                        ".su",
                        ".st",
                        ".ro",
                        ".ge",
                        ".ms",
                        ".pk",
                        ".nu",
                        ".me",
                        ".ph",
                        ".to",
                        ".tt",
                        ".name",
                        ".tv",
                        ".kz",
                        ".tc",
                        ".mobi",
                        ".study",
                        ".click",
                        ".link",
                        ".trade",
                        ".accountant",
                        ".cf",
                        ".gq",
                        ".ml",
                        ".ga",
                        ".pw"
                    ]
                }
            },
            "falsepositives": [
                "All kinds of software downloads"
            ],
            "fields": [
                "ClientIP",
                "c-uri"
            ],
            "id": "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
            "level": "low",
            "logsource": {
                "category": "proxy"
            },
            "modified": "2023/05/18",
            "references": [
                "https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap",
                "https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf",
                "https://www.spamhaus.org/statistics/tlds/",
                "https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/"
            ],
            "related": [
                {
                    "id": "b5de2919-b74a-4805-91a7-5049accbaefe",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1566",
                "attack.execution",
                "attack.t1203",
                "attack.t1204.002"
            ],
            "title": "Download From Suspicious TLD - Blacklist"
        },
        {
            "id": "b5de2919-b74a-4805-91a7-5049accbaefe",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/03/13",
            "description": "Detects executable downloads from suspicious remote systems",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "cs-host|endswith": [
                        ".com",
                        ".org",
                        ".net",
                        ".edu",
                        ".gov",
                        ".uk",
                        ".ca",
                        ".de",
                        ".jp",
                        ".fr",
                        ".au",
                        ".us",
                        ".ch",
                        ".it",
                        ".nl",
                        ".se",
                        ".no",
                        ".es"
                    ]
                },
                "selection": {
                    "c-uri-extension": [
                        "exe",
                        "vbs",
                        "bat",
                        "rar",
                        "ps1",
                        "doc",
                        "docm",
                        "xls",
                        "xlsm",
                        "pptm",
                        "rtf",
                        "hta",
                        "dll",
                        "ws",
                        "wsf",
                        "sct",
                        "zip"
                    ]
                }
            },
            "falsepositives": [
                "All kind of software downloads"
            ],
            "fields": [
                "ClientIP",
                "c-uri"
            ],
            "level": "low",
            "logsource": {
                "category": "proxy"
            },
            "modified": "2023/05/18",
            "references": [
                "Internal Research"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "00d0b5ab-1f55-4120-8e83-487c0a7baf19"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1566",
                "attack.execution",
                "attack.t1203",
                "attack.t1204.002"
            ],
            "title": "Download From Suspicious TLD - Whitelist"
        },
        {
            "author": "Nate Guagenti (neu5ron)",
            "date": "2021/09/20",
            "description": "Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request.\nVerify, successful, exploitation by viewing the HTTP client (request) body to see what was passed to the server (using PCAP).\nWithin the client body is where the code execution would occur. Additionally, check the endpoint logs to see if suspicious commands or activity occurred within the timeframe of this HTTP request.\n",
            "detection": {
                "auth_header": {
                    "client_header_names|contains": "AUTHORIZATION"
                },
                "condition": "selection and not auth_header and not too_small_http_client_body",
                "selection": {
                    "method": "POST",
                    "status_code": 200,
                    "uri": "/wsman"
                },
                "too_small_http_client_body": {
                    "request_body_len": 0
                }
            },
            "falsepositives": [
                "Exploits that were attempted but unsuccessful.",
                "Scanning attempts with the abnormal use of the HTTP POST method with no indication of code execution within the HTTP Client (Request) body. An example would be vulnerability scanners trying to identify unpatched versions while not actually exploiting the vulnerability. See description for investigation tips."
            ],
            "fields": [
                "id.orig_h",
                "id.resp_h",
                "id.resp_p",
                "status_code",
                "method",
                "uri",
                "request_body_len",
                "response_body_len",
                "user_agent"
            ],
            "id": "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
            "level": "high",
            "logsource": {
                "definition": "Enable the builtin Zeek script that logs all HTTP header names by adding \"@load policy/protocols/http/header-names\" to your local.zeek config file. The script can be seen here for reference https://github.com/zeek/zeek/blob/d957f883df242ef159cfd846884e673addeea7a5/scripts/policy/protocols/http/header-names.zeek",
                "product": "zeek",
                "service": "http"
            },
            "modified": "2019/09/20",
            "status": "stable",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://twitter.com/neu5ron/status/1438987292971053057?s=20"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.lateral_movement",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203",
                "attack.t1021.006",
                "attack.t1210"
            ],
            "title": "OMIGOD HTTP No Authentication RCE"
        },
        {
            "author": "Sohan G (D4rkCiph3r)",
            "date": "2023/04/05",
            "description": "Detects suspicious child processes spawned from browsers. This could be a result of a potential web browser exploitation.",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_chrome": {
                    "CommandLine|contains": [
                        "/Volumes/Google Chrome/Google Chrome.app/Contents/Frameworks/*/Resources/install.sh",
                        "/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_preflight.sh",
                        "/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/*/Resources/keystone_promote_postflight.sh"
                    ],
                    "ParentImage|contains": [
                        "Google Chrome Helper",
                        "Google Chrome"
                    ]
                },
                "filter_main_chromerecovery": {
                    "CommandLine|contains|all": [
                        "/Users/",
                        "/Library/Application Support/Google/Chrome/recovery/",
                        "/ChromeRecovery"
                    ],
                    "ParentImage|contains": [
                        "Google Chrome Helper",
                        "Google Chrome"
                    ]
                },
                "filter_main_generic": {
                    "CommandLine|contains": "--defaults-torrc"
                },
                "filter_main_ms_autoupdate": {
                    "CommandLine|contains": "/Library/Application Support/Microsoft/MAU*/Microsoft AutoUpdate.app/Contents/MacOS/msupdate"
                },
                "filter_main_ms_edge": {
                    "CommandLine|contains": [
                        "IOPlatformExpertDevice",
                        "hw.model"
                    ],
                    "ParentImage|contains": "Microsoft Edge"
                },
                "filter_optional_empty": {
                    "CommandLine": ""
                },
                "filter_optional_null": {
                    "CommandLine": null
                },
                "selection": {
                    "Image|endswith": [
                        "/bash",
                        "/curl",
                        "/dash",
                        "/ksh",
                        "/osascript",
                        "/perl",
                        "/php",
                        "/pwsh",
                        "/python",
                        "/sh",
                        "/tcsh",
                        "/wget",
                        "/zsh"
                    ],
                    "ParentImage|contains": [
                        "com.apple.WebKit.WebContent",
                        "firefox",
                        "Google Chrome Helper",
                        "Google Chrome",
                        "Microsoft Edge",
                        "Opera",
                        "Safari",
                        "Tor Browser"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate browser install, update and recovery scripts"
            ],
            "id": "0250638a-2b28-4541-86fc-ea4c558fa0c6",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://fr.slideshare.net/codeblue_jp/cb19-recent-apt-attack-on-crypto-exchange-employees-by-heungsoo-kang",
                "https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/execution_initial_access_suspicious_browser_childproc.toml"
            ],
            "tags": [
                "attack.initial_access",
                "attack.execution",
                "attack.t1189",
                "attack.t1203",
                "attack.t1059"
            ],
            "title": "Suspicious Browser Child Process - MacOS",
            "status": "test"
        },
        {
            "author": "Max Altgelt (Nextron Systems)",
            "date": "2022/04/14",
            "description": "Detects network connections from the Equation Editor process \"eqnedt32.exe\".",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\eqnedt32.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "a66bc059-c370-472c-a0d7-f8fd1bf9d583",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "level": "high",
            "modified": "2024/05/31",
            "references": [
                "https://twitter.com/forensicitguy/status/1513538712986079238",
                "https://forensicitguy.github.io/xloader-formbook-velvetsweatshop-spreadsheet/",
                "https://news.sophos.com/en-us/2019/07/18/a-new-equation-editor-exploit-goes-commercial-as-maldoc-attacks-using-it-spike/"
            ],
            "tags": [
                "attack.execution",
                "attack.t1203"
            ],
            "title": "Network Connection Initiated By Eqnedt32.EXE",
            "status": "test"
        },
        {
            "author": "Christopher Peacock '@securepeacock', SCYTHE '@scythe_io', Florian Roth (Nextron Systems), Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/11/10",
            "description": "Detects an office application (Word, Excel, PowerPoint)  that initiate a network connection to a non-private IP addresses.\nThis rule aims to detect traffic similar to one seen exploited in CVE-2021-42292.\nThis rule will require an initial baseline and tuning that is specific to your organization.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_local_ranges": {
                    "DestinationIp|cidr": [
                        "127.0.0.0/8",
                        "10.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "::1/128",
                        "fe80::/10",
                        "fc00::/7"
                    ]
                },
                "filter_main_msrange_exchange_1": {
                    "DestinationIp|cidr": [
                        "13.107.6.152/31",
                        "13.107.18.10/31",
                        "13.107.128.0/22",
                        "23.103.160.0/20",
                        "40.96.0.0/13",
                        "40.104.0.0/15",
                        "52.96.0.0/14",
                        "131.253.33.215/32",
                        "132.245.0.0/16",
                        "150.171.32.0/22",
                        "204.79.197.215/32",
                        "2603:1006::/40",
                        "2603:1016::/36",
                        "2603:1026::/36",
                        "2603:1036::/36",
                        "2603:1046::/36",
                        "2603:1056::/36",
                        "2620:1ec:4::152/128",
                        "2620:1ec:4::153/128",
                        "2620:1ec:c::10/128",
                        "2620:1ec:c::11/128",
                        "2620:1ec:d::10/128",
                        "2620:1ec:d::11/128",
                        "2620:1ec:8f0::/46",
                        "2620:1ec:900::/46",
                        "2620:1ec:a92::152/128",
                        "2620:1ec:a92::153/128"
                    ],
                    "DestinationPort": [
                        80,
                        443
                    ]
                },
                "filter_main_msrange_exchange_2": {
                    "DestinationIp|cidr": [
                        "13.107.6.152/31",
                        "13.107.18.10/31",
                        "13.107.128.0/22",
                        "23.103.160.0/20",
                        "40.96.0.0/13",
                        "40.104.0.0/15",
                        "52.96.0.0/14",
                        "131.253.33.215/32",
                        "132.245.0.0/16",
                        "150.171.32.0/22",
                        "204.79.197.215/32",
                        "2603:1006::/40",
                        "2603:1016::/36",
                        "2603:1026::/36",
                        "2603:1036::/36",
                        "2603:1046::/36",
                        "2603:1056::/36",
                        "2620:1ec:4::152/128",
                        "2620:1ec:4::153/128",
                        "2620:1ec:c::10/128",
                        "2620:1ec:c::11/128",
                        "2620:1ec:d::10/128",
                        "2620:1ec:d::11/128",
                        "2620:1ec:8f0::/46",
                        "2620:1ec:900::/46",
                        "2620:1ec:a92::152/128",
                        "2620:1ec:a92::153/128"
                    ],
                    "DestinationPort": [
                        143,
                        587,
                        993,
                        995
                    ],
                    "Protocol": "tcp"
                },
                "filter_main_msrange_exchange_3": {
                    "DestinationIp|cidr": [
                        "40.92.0.0/15",
                        "40.107.0.0/16",
                        "52.100.0.0/14",
                        "52.238.78.88/32",
                        "104.47.0.0/17",
                        "2a01:111:f400::/48",
                        "2a01:111:f403::/48"
                    ],
                    "DestinationPort": 443
                },
                "filter_main_msrange_exchange_4": {
                    "DestinationIp|cidr": [
                        "40.92.0.0/15",
                        "40.107.0.0/16",
                        "52.100.0.0/14",
                        "52.238.78.88/32",
                        "104.47.0.0/17",
                        "2a01:111:f400::/48",
                        "2a01:111:f403::/48"
                    ],
                    "DestinationPort": 25
                },
                "filter_main_msrange_generic": {
                    "DestinationIp|cidr": [
                        "20.184.0.0/13",
                        "20.192.0.0/10",
                        "23.72.0.0/13",
                        "40.76.0.0/14",
                        "51.10.0.0/15",
                        "51.103.0.0/16",
                        "51.104.0.0/15",
                        "51.142.136.0/22",
                        "52.160.0.0/11",
                        "204.79.197.0/24"
                    ]
                },
                "filter_main_msrange_office_1": {
                    "DestinationIp|cidr": [
                        "13.107.6.171/32",
                        "13.107.18.15/32",
                        "13.107.140.6/32",
                        "52.108.0.0/14",
                        "52.244.37.168/32",
                        "2603:1006:1400::/40",
                        "2603:1016:2400::/40",
                        "2603:1026:2400::/40",
                        "2603:1036:2400::/40",
                        "2603:1046:1400::/40",
                        "2603:1056:1400::/40",
                        "2603:1063:2000::/38",
                        "2620:1ec:c::15/128",
                        "2620:1ec:8fc::6/128",
                        "2620:1ec:a92::171/128",
                        "2a01:111:f100:2000::a83e:3019/128",
                        "2a01:111:f100:2002::8975:2d79/128",
                        "2a01:111:f100:2002::8975:2da8/128",
                        "2a01:111:f100:7000::6fdd:6cd5/128",
                        "2a01:111:f100:a004::bfeb:88cf/128"
                    ],
                    "DestinationPort": [
                        80,
                        443
                    ],
                    "Protocol": "tcp"
                },
                "filter_main_msrange_office_2": {
                    "DestinationIp|cidr": [
                        "20.20.32.0/19",
                        "20.190.128.0/18",
                        "20.231.128.0/19",
                        "40.126.0.0/18",
                        "2603:1006:2000::/48",
                        "2603:1007:200::/48",
                        "2603:1016:1400::/48",
                        "2603:1017::/48",
                        "2603:1026:3000::/48",
                        "2603:1027:1::/48",
                        "2603:1036:3000::/48",
                        "2603:1037:1::/48",
                        "2603:1046:2000::/48",
                        "2603:1047:1::/48",
                        "2603:1056:2000::/48",
                        "2603:1057:2::/48"
                    ],
                    "DestinationPort": [
                        80,
                        443
                    ],
                    "Protocol": "tcp"
                },
                "filter_main_msrange_office_3": {
                    "DestinationIp|cidr": [
                        "13.107.6.192/32",
                        "13.107.9.192/32",
                        "52.108.0.0/14",
                        "2620:1ec:4::192/128",
                        "2620:1ec:a92::192/128"
                    ],
                    "DestinationPort": 443,
                    "Protocol": "tcp"
                },
                "filter_main_msrange_sharepoint_1": {
                    "DestinationIp|cidr": [
                        "13.107.136.0/22",
                        "40.108.128.0/17",
                        "52.104.0.0/14",
                        "104.146.128.0/17",
                        "150.171.40.0/22",
                        "2603:1061:1300::/40",
                        "2620:1ec:8f8::/46",
                        "2620:1ec:908::/46",
                        "2a01:111:f402::/48"
                    ],
                    "DestinationPort": [
                        80,
                        443
                    ],
                    "Protocol": "tcp"
                },
                "selection": {
                    "Image|endswith": [
                        "\\excel.exe",
                        "\\outlook.exe",
                        "\\powerpnt.exe",
                        "\\winword.exe",
                        "\\wordview.exe"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "You may have to tune certain domains out that Excel may call out to, such as microsoft or other business use case domains.",
                "Office documents commonly have templates that refer to external addresses, like \"sharepoint.ourcompany.com\" may have to be tuned.",
                "It is highly recommended to baseline your activity and tune out common business use cases."
            ],
            "id": "75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/07/02",
            "references": [
                "https://corelight.com/blog/detecting-cve-2021-42292",
                "https://learn.microsoft.com/de-de/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide"
            ],
            "tags": [
                "attack.execution",
                "attack.t1203"
            ],
            "title": "Office Application Initiated Network Connection To Non-Local IP",
            "status": "test"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/01/16",
            "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect",
            "detection": {
                "condition": "all of selection_* and not exclusion",
                "exclusion": {
                    "CommandLine|contains": [
                        "address=127.0.0.1",
                        "address=localhost"
                    ]
                },
                "selection_jdwp_transport": {
                    "CommandLine|contains": "transport=dt_socket,address="
                },
                "selection_old_jvm_version": {
                    "CommandLine|contains": [
                        "jre1.",
                        "jdk1."
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "8f88e3f6-2a49-48f5-a5c4-2f7eedf78710",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/01",
            "references": [
                "https://dzone.com/articles/remote-debugging-java-applications-with-jdwp"
            ],
            "status": "test",
            "tags": [
                "attack.t1203",
                "attack.execution"
            ],
            "title": "Java Running with Remote Debugging"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/31",
            "description": "Detects potentially suspicious child processes of WinRAR.exe.",
            "detection": {
                "condition": "all of selection_*",
                "selection_binaries": [
                    {
                        "Image|endswith": [
                            "\\cmd.exe",
                            "\\cscript.exe",
                            "\\mshta.exe",
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\wscript.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "Cmd.Exe",
                            "cscript.exe",
                            "mshta.exe",
                            "PowerShell.EXE",
                            "pwsh.dll",
                            "regsvr32.exe",
                            "RUNDLL32.EXE",
                            "wscript.exe"
                        ]
                    }
                ],
                "selection_parent": {
                    "ParentImage|endswith": "\\WinRAR.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "146aace8-9bd6-42ba-be7a-0070d8027b76",
            "level": "medium",
            "references": [
                "https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/",
                "https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md"
            ],
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "related": [
                {
                    "id": "ec3a3c2f-9bb0-4a9b-8f4b-5ec386544343",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.execution",
                "attack.t1203"
            ],
            "title": "Potentially Suspicious Child Process Of WinRAR.EXE",
            "status": "test"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/10/24",
            "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\gbb.exe",
                    "ParentImage|endswith": "\\Hwp.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "023394c4-29d5-46ab-92b8-6a534c6f447b",
            "level": "high",
            "modified": "2021/11/27",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/",
                "https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1",
                "https://twitter.com/cyberwar_15/status/1187287262054076416",
                "https://blog.alyac.co.kr/1901",
                "https://en.wikipedia.org/wiki/Hangul_(word_processor)"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001",
                "attack.execution",
                "attack.t1203",
                "attack.t1059.003",
                "attack.g0032"
            ],
            "title": "Suspicious HWP Sub Processes",
            "status": "test"
        },
        {
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2024/05/13",
            "description": "Detects potentially suspicious child processes of KeyScrambler.exe",
            "detection": {
                "condition": "all of selection_*",
                "selection_binaries": [
                    {
                        "Image|endswith": [
                            "\\cmd.exe",
                            "\\cscript.exe",
                            "\\mshta.exe",
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\wscript.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "Cmd.Exe",
                            "cscript.exe",
                            "mshta.exe",
                            "PowerShell.EXE",
                            "pwsh.dll",
                            "regsvr32.exe",
                            "RUNDLL32.EXE",
                            "wscript.exe"
                        ]
                    }
                ],
                "selection_parent": {
                    "ParentImage|endswith": "\\KeyScrambler.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ca5583e9-8f80-46ac-ab91-7f314d13b984",
            "level": "medium",
            "references": [
                "https://twitter.com/DTCERT/status/1712785421845790799"
            ],
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "related": [
                {
                    "id": "d2451be2-b582-4e15-8701-4196ac180260",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.t1203",
                "attack.t1574.002"
            ],
            "title": "Potentially Suspicious Child Process of KeyScrambler.exe"
        },
        {
            "author": "Justin C. (@endisphotic), @dreadphones (detection), Thomas Patzke (Sigma rule)",
            "date": "2021/07/11",
            "description": "Detects suspicious print spool service (spoolsv.exe) child processes.",
            "detection": {
                "condition": "spoolsv and ( suspicious_unrestricted or (suspicious_net and not suspicious_net_filter) or (suspicious_cmd and not suspicious_cmd_filter) or (suspicious_netsh and not suspicious_netsh_filter) or (suspicious_powershell and not suspicious_powershell_filter) or all of suspicious_rundll32_* )",
                "spoolsv": {
                    "IntegrityLevel": "System",
                    "ParentImage|endswith": "\\spoolsv.exe"
                },
                "suspicious_cmd": {
                    "Image|endswith": "\\cmd.exe"
                },
                "suspicious_cmd_filter": {
                    "CommandLine|contains": [
                        ".spl",
                        "route add",
                        "program files"
                    ]
                },
                "suspicious_net": {
                    "Image|endswith": [
                        "\\net.exe",
                        "\\net1.exe"
                    ]
                },
                "suspicious_net_filter": {
                    "CommandLine|contains": "start"
                },
                "suspicious_netsh": {
                    "Image|endswith": "\\netsh.exe"
                },
                "suspicious_netsh_filter": {
                    "CommandLine|contains": [
                        "add portopening",
                        "rule name"
                    ]
                },
                "suspicious_powershell": {
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                },
                "suspicious_powershell_filter": {
                    "CommandLine|contains": ".spl"
                },
                "suspicious_rundll32_cli": {
                    "CommandLine|endswith": "rundll32.exe"
                },
                "suspicious_rundll32_img": [
                    {
                        "Image|endswith": "\\rundll32.exe"
                    },
                    {
                        "OriginalFileName": "RUNDLL32.EXE"
                    }
                ],
                "suspicious_unrestricted": {
                    "Image|endswith": [
                        "\\gpupdate.exe",
                        "\\whoami.exe",
                        "\\nltest.exe",
                        "\\taskkill.exe",
                        "\\wmic.exe",
                        "\\taskmgr.exe",
                        "\\sc.exe",
                        "\\findstr.exe",
                        "\\curl.exe",
                        "\\wget.exe",
                        "\\certutil.exe",
                        "\\bitsadmin.exe",
                        "\\accesschk.exe",
                        "\\wevtutil.exe",
                        "\\bcdedit.exe",
                        "\\fsutil.exe",
                        "\\cipher.exe",
                        "\\schtasks.exe",
                        "\\write.exe",
                        "\\wuauclt.exe",
                        "\\systeminfo.exe",
                        "\\reg.exe",
                        "\\query.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "Image",
                "CommandLine"
            ],
            "id": "dcdbc940-0bff-46b2-95f3-2d73f848e33b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/09",
            "references": [
                "https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/efa17a600b43c897b4b7463cc8541daa1987eeb4/Exploits/Print%20Spooler%20RCE/Suspicious%20Spoolsv%20Child%20Process.md"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1203",
                "attack.privilege_escalation",
                "attack.t1068"
            ],
            "title": "Suspicious Spool Service Child Process"
        },
        {
            "author": "Florian Roth (Nextron Systems), Zach Mathis",
            "date": "2020/01/15",
            "description": "Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited.\nMS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\nUnfortunately, that is about the only instance of CVEs being written to this log.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1,
                    "Provider_Name": [
                        "Microsoft-Windows-Audit-CVE",
                        "Audit-CVE"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
            "level": "critical",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "modified": "2022/10/22",
            "references": [
                "https://twitter.com/VM_vivisector/status/1217190929330655232",
                "https://twitter.com/DidierStevens/status/1217533958096924676",
                "https://twitter.com/FlemmingRiis/status/1217147415482060800",
                "https://www.youtube.com/watch?v=ebmW42YYveI",
                "https://nullsec.us/windows-event-log-audit-cve/"
            ],
            "tags": [
                "attack.execution",
                "attack.t1203",
                "attack.privilege_escalation",
                "attack.t1068",
                "attack.defense_evasion",
                "attack.t1211",
                "attack.credential_access",
                "attack.t1212",
                "attack.lateral_movement",
                "attack.t1210",
                "attack.impact",
                "attack.t1499.004"
            ],
            "title": "Audit CVE Event",
            "status": "test"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute any UNIX/Linux script using the /bin/sh shell.\nScript being executed gets created as a temp file in /tmp folder with a scx* prefix.\nThen it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.\nThe file in that directory has the same prefix scx*. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/etc/opt/microsoft/scx/conf/tmpdir/scx",
                    "CurrentDirectory": "/var/opt/microsoft/scx/tmp",
                    "LogonId": 0,
                    "User": "root"
                }
            },
            "falsepositives": [
                "Legitimate use of SCX RunAsProvider ExecuteScript."
            ],
            "id": "6eea1bf6-f8d2-488a-a742-e6ef6c1b67db",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "high",
            "modified": "2022/10/05",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://github.com/Azure/Azure-Sentinel/pull/3059"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203"
            ],
            "title": "OMIGOD SCX RunAsProvider ExecuteScript",
            "status": "test"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/bin/sh",
                    "CurrentDirectory": "/var/opt/microsoft/scx/tmp",
                    "LogonId": 0,
                    "User": "root"
                }
            },
            "falsepositives": [
                "Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand."
            ],
            "id": "21541900-27a9-4454-9c4c-3f0a4240344a",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "high",
            "modified": "2022/10/05",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://github.com/Azure/Azure-Sentinel/pull/3059"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203"
            ],
            "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand",
            "status": "test"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2021/09/17",
            "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager.\nMicrosoft Azure, and Microsoft Operations Management Suite.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "comm": "sh",
                    "cwd": "/var/opt/microsoft/scx/tmp",
                    "syscall": "execve",
                    "type": "SYSCALL",
                    "uid": 0
                }
            },
            "falsepositives": [
                "Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand."
            ],
            "id": "045b5f9c-49f7-4419-a236-9854fb3c827a",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "level": "high",
            "modified": "2022/11/26",
            "references": [
                "https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure",
                "https://github.com/Azure/Azure-Sentinel/pull/3059"
            ],
            "tags": [
                "attack.privilege_escalation",
                "attack.initial_access",
                "attack.execution",
                "attack.t1068",
                "attack.t1190",
                "attack.t1203"
            ],
            "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand - Auditd",
            "status": "test"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "Windows",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        }
    ],
    "x_mitre_detection": "Detecting software exploitation may be difficult depending on the tools available. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the browser or Office processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.4",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": []
}