{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--7ac7c944-7266-492f-8c55-3b91108d9a71",
    "created": "2024-08-13T14:46:36.659715Z",
    "modified": "2024-08-13T14:46:36.659715Z",
    "name": "Use of Known Domain Credentials",
    "description": "An adversary guesses or obtains (i.e. steals or purchases) legitimate credentials (e.g. userID/password) to achieve authentication and to perform authorized actions under the guise of an authenticated user or service.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/560.html",
            "external_id": "560"
        },
        {
            "source_name": "CWE",
            "external_id": "522"
        },
        {
            "source_name": "CWE",
            "external_id": "307"
        },
        {
            "source_name": "CWE",
            "external_id": "308"
        },
        {
            "source_name": "CWE",
            "external_id": "309"
        },
        {
            "source_name": "CWE",
            "external_id": "262"
        },
        {
            "source_name": "CWE",
            "external_id": "263"
        },
        {
            "source_name": "CWE",
            "external_id": "654"
        },
        {
            "source_name": "CWE",
            "external_id": "1273"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authentication"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Read Data",
            "scope": "Authorization"
        },
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "Throughout 2015 and 2016, APT28 \u2014 also known as Pawn Storm, Sednit, Fancy Bear, Sofacy, and STRONTIUM \u2014 leveraged stolen credentials to infiltrate the Democratic National Committee (DNC), the United States Army, the World Anti-Doping Agency (WADA), the Court of Arbitration for Sport (TAS-CAS), and more. In most cases, the legitimate credentials were obtained via calculated spearphishing, tabnabbing, and DNS attacks targeted at corporate webmail systems. APT28 also executed several watering hole attacks, in addition to exploiting several zero-day vulnerabilities within Flash and Windows. The stolen credentials were then utilized to maintain authenticated access, laterally move within the local network, and exfiltrate sensitive information including DNC emails and personal medical records of numerous athletes. [REF-571]"
        },
        {
            "description": "In early 2019, FIN6 exploited stolen credentials from an organization within the engineering industry to laterally move within an environment via the Windows\u2019 Remote Desktop Protocol (RDP). Multiple servers were subsequently infected with malware to create malware distribution servers, which were used to distribute the LockerGoga ransomware. [REF-573]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Acquire known credentials] The adversary must obtain known credentials in order to access the target system, application, or service.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "An adversary purchases breached username/password combinations or leaked hashed passwords from the dark web.",
                "An adversary leverages a key logger or phishing attack to steal user credentials as they are provided.",
                "An adversary conducts a sniffing attack to steal credentials as they are transmitted.",
                "An adversary gains access to a database and exfiltrates password hashes.",
                "An adversary examines outward-facing configuration and properties files to discover hardcoded credentials."
            ]
        },
        {
            "description": "[Determine target's password policy] Determine the password policies of the target system/application to determine if the known credentials fit within the specified criteria.",
            "phase": "Explore",
            "step": "2",
            "techniques": [
                "Determine minimum and maximum allowed password lengths.",
                "Determine format of allowed passwords (whether they are required or allowed to contain numbers, special characters, etc., or whether they are allowed to contain words from the dictionary).",
                "Determine account lockout policy (a strict account lockout policy will prevent brute force attacks if multiple passwords are known for a single user account)."
            ]
        },
        {
            "description": "[Attempt authentication] Try each credential until the target grants access.",
            "phase": "Experiment",
            "step": "3",
            "techniques": [
                "Manually or automatically enter each credential through the target's interface."
            ]
        },
        {
            "description": "[Impersonate] An adversary can use successful experiments or authentications to impersonate an authorized user or system, or to laterally move within a system or application",
            "phase": "Exploit",
            "step": "4",
            "techniques": []
        },
        {
            "description": "[Spoofing] Malicious data can be injected into the target system or into a victim user's system by an adversary. The adversary can also pose as a legitimate user to perform social engineering attacks.",
            "phase": "Exploit",
            "step": "5",
            "techniques": []
        },
        {
            "description": "[Data Exfiltration] The adversary can obtain sensitive data contained within the system or application.",
            "phase": "Exploit",
            "step": "6",
            "techniques": []
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Leverage multi-factor authentication for all authentication services and prior to granting an entity access to the domain network."
        },
        {
            "description": "Create a strong password policy and ensure that your system enforces this policy."
        },
        {
            "description": "Ensure users are not reusing username/password combinations for multiple systems, applications, or services."
        },
        {
            "description": "Do not reuse local administrator account credentials across systems."
        },
        {
            "description": "Deny remote use of local admin credentials to log into domain systems."
        },
        {
            "description": "Do not allow accounts to be a local administrator on more than one system."
        },
        {
            "description": "Implement an intelligent password throttling mechanism. Care must be taken to assure that these mechanisms do not excessively enable account lockout attacks such as CAPEC-2."
        },
        {
            "description": "Monitor system and domain logs for abnormal credential access."
        }
    ]
}