{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--eb4ee065-753f-4302-b63c-0c75c3eb6a4d",
    "created": "2020-08-14T00:00:00.000Z",
    "modified": "2024-04-28T00:00:00.000Z",
    "name": "Self Deletion",
    "description": "",
    "labels": [
        "malware-behavior"
    ],
    "object_marking_refs": [
        "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
    ],
    "x_mitre_platforms": [],
    "x_mitre_domains": [],
    "x_mitre_contributors": [],
    "kill_chain_phases": [],
    "x_mitre_detection": "",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "",
    "x_mitre_data_sources": [],
    "x_mitre_permissions_required": [],
    "external_references": [
        {
            "source_name": "ong-termrat",
            "description": "G. Ong, N. Villeneuve, and C. Hwa, \"Evasive Tactics: Terminator RAT,\" FireEye Labs, 2013 [Online].",
            "url": "https://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2013/FireEye-Terminator_RAT.pdf"
        },
        {
            "source_name": "levene-cozycar",
            "description": "B. Levene, R. Falcone, and R. Wartell, \"Tracking MiniDionis: CozyCar's New Ride Is Related to Seaduke,\" Unit 42 by Palo Alto Networks, Jul 14, 2015 [Online].",
            "url": "https://unit42.paloaltonetworks.com/tracking-minidionis-cozycars-new-ride-is-related-to-seaduke"
        },
        {
            "source_name": "reed-mac",
            "description": "T. Reed, \"Mac malware intercepts encrypted web traffic for ad injection,\" Malwarebytes Labs, blog, Oct. 24, 2018 [Online].",
            "url": "https://www.malwarebytes.com/blog/news/2018/10/mac-malware-intercepts-encrypted-web-traffic-for-ad-injection"
        },
        {
            "source_name": "berry-wannacry",
            "description": "A. Berry, J. Homan, and R. Eitzman, \"WannaCry Malware Profile,\" Mandiant, blog, Nov. 5, 2021 [Online].",
            "url": "https://www.mandiant.com/resources/blog/wannacry-malware-profile"
        }
    ],
    "obj_defn": {
        "description": "Malware may remove itself from an infected system, typically after it has achieved its primary objective. This is done to evade detection, remove evidence of its presence, and make forensic analysis more difficult. The malware may use built-in commands, scripts, or other methods to delete its files, processes, or registry entries. \n\nSee ATT&CK: **Indicator Removal on Host: Uninstall Malicious Application ([T1630.001](https://attack.mitre.org/techniques/T1630/001/)), Indicator Removal on Host: File Deletion ([T1070.004](https://attack.mitre.org/techniques/T1070/004/))**.",
        "external_id": "F0007",
        "source_name": "mitre-mbc",
        "url": "https://github.com/MBCProject/mbc-markdown/blob/main/defense-evasion/self-deletion.md"
    },
    "detection_rules": [
        {
            "detect_ref": "malware-method--3efd36ca-dfde-434d-9dec-2fe7d1b92a47",
            "rule_name": "self delete",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-forensic/self-deletion/self-delete.yml"
        },
        {
            "api_fncs": [
                "DeleteFileW"
            ],
            "detect_ref": "malware-behavior--27107c4a-baf6-403b-a6b0-7e0f0008bcf8",
            "rule_name": "trickbot_task_delete",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/trickbot_files.py"
        },
        {
            "rule_name": "deletes_executed_files",
            "detect_ref": "malware-behavior--27107c4a-baf6-403b-a6b0-7e0f0008bcf8",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/deletes_executed.py"
        },
        {
            "api_fncs": [
                "NtDeleteFile",
                "DeleteFileW",
                "DeleteFileA",
                "MoveFileWithProgressW",
                "MoveFileWithProgressTransactedW"
            ],
            "detect_ref": "malware-behavior--27107c4a-baf6-403b-a6b0-7e0f0008bcf8",
            "rule_name": "deletes_self",
            "rule_type": "cape",
            "url": "https://github.com/CAPESandbox/community/tree/master/modules/signatures/windows/deletes_self.py"
        }
    ],
    "tags": []
}