{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--2c6f22f7-f86d-46ff-93b6-47d5b1b5431d",
    "created": "2024-08-13T14:46:36.899652Z",
    "modified": "2024-08-13T14:46:44.86608Z",
    "name": "System Binary Proxy Execution: Regsvcs/Regasm",
    "description": "Adversaries may abuse Regsvcs and Regasm to proxy execution of code through a trusted Windows utility. Regsvcs and Regasm are Windows command-line utilities that are used to register .NET Component Object Model (COM) assemblies. Both are binaries that may be digitally signed by Microsoft. [1] [2]Both utilities may be used to bypass application control through use of attributes within the binary to specify code that should be run before registration or unregistration: [ComRegisterFunction] or [ComUnregisterFunction] respectively. The code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute. [3][4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1218/009",
            "external_id": "T1218/009"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113",
            "date": "2024/04/25",
            "description": "Detects \"RegAsm.exe\" initiating a network connection to public IP adresses",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_local_ranges": {
                    "DestinationIp|cidr": [
                        "127.0.0.0/8",
                        "10.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "::1/128",
                        "fe80::/10",
                        "fc00::/7"
                    ]
                },
                "selection": {
                    "Image|endswith": "\\regasm.exe",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0531e43a-d77d-47c2-b89f-5fe50321c805",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://app.any.run/tasks/ec207948-4916-47eb-a0f4-4c6abb2e7668/",
                "https://research.splunk.com/endpoint/07921114-6db4-4e2e-ae58-3ea8a52ae93f/",
                "https://lolbas-project.github.io/lolbas/Binaries/Regasm/"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.009"
            ],
            "title": "RegAsm.EXE Initiating Network Connection To Public IP"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/25",
            "description": "Detects potentially suspicious execution of the Regasm/Regsvcs utilities from a potentially suspicious location",
            "detection": {
                "condition": "all of selection_*",
                "selection_dir": {
                    "CommandLine|contains": [
                        "\\AppData\\Local\\Temp\\",
                        "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                        "\\PerfLogs\\",
                        "\\Users\\Public\\",
                        "\\Windows\\Temp\\"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\Regsvcs.exe",
                            "\\Regasm.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "RegSvcs.exe",
                            "RegAsm.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "cc368ed0-2411-45dc-a222-510ace303cb2",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "https://www.fortiguard.com/threat-signal-report/4718?s=09",
                "https://lolbas-project.github.io/lolbas/Binaries/Regasm/",
                "https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/"
            ],
            "related": [
                {
                    "id": "e9f8f8cc-07cc-4e81-b724-f387db9175e4",
                    "type": "derived"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.009"
            ],
            "status": "test",
            "title": "Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon Location"
        },
        {
            "id": "e9f8f8cc-07cc-4e81-b724-f387db9175e4",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/13",
            "description": "Detects potentially suspicious execution of the Regasm/Regsvcs utilities with an uncommon extension.",
            "detection": {
                "condition": "all of selection_*",
                "selection_extension": {
                    "CommandLine|contains": [
                        ".dat",
                        ".gif",
                        ".jpeg",
                        ".jpg",
                        ".png",
                        ".txt"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\Regsvcs.exe",
                            "\\Regasm.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "RegSvcs.exe",
                            "RegAsm.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "related": [
                {
                    "type": "derived",
                    "id": "cc368ed0-2411-45dc-a222-510ace303cb2"
                }
            ],
            "references": [
                "https://www.fortiguard.com/threat-signal-report/4718?s=09",
                "https://lolbas-project.github.io/lolbas/Binaries/Regasm/",
                "https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.009"
            ],
            "status": "test",
            "title": "Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon Extension"
        }
    ]
}