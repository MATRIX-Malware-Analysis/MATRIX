{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6862374a-93f5-455c-bc0c-2a3903e8bc08",
    "created": "2019-08-01T00:00:00.000Z",
    "modified": "2024-04-30T00:00:00.000Z",
    "name": "Conditional Execution",
    "description": "",
    "labels": [
        "malware-behavior"
    ],
    "object_marking_refs": [
        "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
    ],
    "x_mitre_platforms": [],
    "x_mitre_domains": [],
    "x_mitre_contributors": [],
    "kill_chain_phases": [],
    "x_mitre_detection": "",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "",
    "x_mitre_data_sources": [],
    "x_mitre_permissions_required": [],
    "external_references": [
        {
            "source_name": "mcafee-webcobra",
            "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
            "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
        },
        {
            "source_name": "rcketcalf",
            "description": "RcketCalf, \"Debugging malware that will only run as a service,\" Stack Exchange, May 7, 2013 [Online].",
            "url": "https://reverseengineering.stackexchange.com/questions/2019/debugging-malware-that-will-only-run-as-a-service"
        },
        {
            "source_name": "proofpoint-ursnif",
            "description": "\"Ursnif Banking Trojan Campaign Ups the Ante with New Sandbox Evasion Techniques,\" Proofpoint, Sep. 20, 2016 [Online].",
            "url": "https://www.proofpoint.com/us/threat-insight/post/ursnif-banking-trojan-campaign-sandbox-evasion-techniques"
        },
        {
            "source_name": "webroot-mebromi",
            "description": "\"Mebromi: the first BIOS rootkit in the wild,\" Webroot, blog, Sep. 13, 2011 [Online].",
            "url": "https://www.webroot.com/blog/2011/09/13/mebromi-the-first-bios-rootkit-in-the-wild/"
        },
        {
            "source_name": "porras",
            "description": "P. Porras, H. Saidi, V. Yegneswaran, \"An Analysis of Conficker's Logic and Redenzvous Points,\" SRI International, Mar. 19, 2009 [Online].",
            "url": "http://www.csl.sri.com/users/vinod/papers/Conficker/"
        },
        {
            "source_name": "falliere-stuxnet",
            "description": "N. Falliere, L. Murchu, and E. Chien, \"W32.Stuxnet Dossier,\" Symantec Security Response, Feb. 2011 [Online].",
            "url": "https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en"
        },
        {
            "source_name": "capa analysis",
            "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
            "url": "https://github.com/mandiant/capa-rules"
        },
        {
            "source_name": "wikipedia-conficker",
            "description": "\"Conficker,\" Wikipedia [Online].",
            "url": "https://en.wikipedia.org/wiki/Conficker"
        }
    ],
    "obj_defn": {
        "description": "Malware checks system environment conditions or characteristics to determine its execution path. For example, malware may not run or may be dormant unless system conditions are favorable, or a file that is dropped may vary its behavior according to the execution environment. Conditional execution in malware happens autonomously, not because of an attacker's command. Such execution is realized when control flow of the malicious program changes with branching instructions in the code, e.g., conditional/unconditional jumps or \u2018if\u2019 statements.\n\nThis behavior is related to the **Dynamic Analysis Evasion ([B0003](https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/dynamic-analysis-evasion.md))** behavior that obstructs dynamic analysis in a sandbox, emulator, or virtual machine.\n\nSome aspects of this Conditional Execution behavior are related to the [Execution Guardrails (T1480)](https://attack.mitre.org/techniques/T1480) ATT&CK technique; however, the ATT&CK technique is not focused on anti-behavioral analysis behaviors.",
        "external_id": "B0025",
        "source_name": "mitre-mbc",
        "url": "https://github.com/MBCProject/mbc-markdown/blob/main/execution/conditional-execution.md"
    },
    "detection_rules": [
        {
            "api_fncs": [
                "RegisterServiceCtrlHandler",
                "RegisterServiceCtrlHandlerEx",
                "StartServiceCtrlDispatcher",
                "System.ServiceProcess.ServiceBase::Run"
            ],
            "detect_ref": "malware-method--769b4655-a854-4130-a36b-f916c8b69704",
            "rule_name": "run as service",
            "rule_type": "capa",
            "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/service/run-as-service.yml"
        }
    ],
    "tags": {
        "Anti-Analysis-Type": "Evasion"
    }
}