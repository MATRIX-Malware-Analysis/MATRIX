{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--68d18190-9edc-4a12-8641-1222bc0bff4c",
    "created": "2024-08-13T14:46:36.875876Z",
    "modified": "2024-08-13T14:46:48.333937Z",
    "name": "System Shutdown/Reboot",
    "description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine or network device. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer or network device via Network Device CLI (e.g. reload).[1][2]Shutting down or rebooting systems may disrupt access to computer resources for legitimate users while also impeding incident response/recovery.Adversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as Disk Structure Wipe or Inhibit System Recovery, to hasten the intended effects on system availability.[3][4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1529",
            "external_id": "T1529"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1529",
            "external_id": "T1529"
        },
        {
            "source_name": "Talos Nyetya June 2017",
            "description": "Chiu, A. (2016, June 27). New Ransomware Variant \"Nyetya\" Compromises Systems Worldwide. Retrieved March 26, 2019.",
            "url": "https://blog.talosintelligence.com/2017/06/worldwide-ransomware-variant.html"
        },
        {
            "source_name": "alert_TA18_106A",
            "description": "CISA. (2018, April 20). Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved February 14, 2022.",
            "url": "https://www.cisa.gov/uscert/ncas/alerts/TA18-106A"
        },
        {
            "source_name": "Talos Olympic Destroyer 2018",
            "description": "Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.",
            "url": "https://blog.talosintelligence.com/2018/02/olympic-destroyer.html"
        },
        {
            "source_name": "Microsoft Shutdown Oct 2017",
            "description": "Microsoft. (2017, October 15). Shutdown. Retrieved October 4, 2019.",
            "url": "https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "user32.ExitWindowsEx"
                            },
                            {
                                "api": "user32.ExitWindows"
                            },
                            {
                                "api": "advapi32.InitiateSystemShutdownEx"
                            },
                            {
                                "api": "advapi32.InitiateSystemShutdown"
                            },
                            {
                                "api": "advapi32.InitiateShutdown"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Impact::System Shutdown/Reboot [T1529]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10008D60"
                    ],
                    "name": "shutdown system",
                    "namespace": "host-interaction/os",
                    "scopes": {
                        "dynamic": "call",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Clark",
            "date": "2019/08/15",
            "description": "Detect a system being shutdown or put into different boot mode",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "shutdown",
                    "config-register 0x2100",
                    "config-register 0x2142"
                ]
            },
            "falsepositives": [
                "Legitimate administrators may run these commands, though rarely."
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "d94a35f0-7a29-45f6-90a0-80df6159967c",
            "level": "medium",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1495",
                "attack.t1529",
                "attack.t1565.001"
            ],
            "title": "Cisco Denial of Service"
        },
        {
            "author": "Igor Fits, Mikhail Larin, oscd.community",
            "date": "2020/10/19",
            "description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/shutdown",
                        "/reboot",
                        "/halt"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "id": "40b1fbe2-18ea-4ee7-be47-0294285811de",
            "level": "informational",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/11/26",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1529"
            ],
            "title": "System Shutdown/Reboot - MacOs"
        },
        {
            "author": "frack113",
            "date": "2022/01/01",
            "description": "Use of the commandline to shutdown or reboot windows",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "/r ",
                        "/s "
                    ],
                    "Image|endswith": "\\shutdown.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "34ebb878-1b15-4895-b352-ca2eeb99b274",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown"
            ],
            "status": "test",
            "title": "Suspicious Execution of Shutdown",
            "tags": [
                "attack.impact",
                "attack.t1529"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/10/01",
            "description": "Detects the rare use of the command line tool shutdown to logoff a user",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/l",
                    "Image|endswith": "\\shutdown.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ec290c06-9b6b-4338-8b6b-095c0f284f10",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1529/T1529.md",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown"
            ],
            "status": "test",
            "title": "Suspicious Execution of Shutdown to Log Out",
            "tags": [
                "attack.impact",
                "attack.t1529"
            ]
        },
        {
            "author": "Alina Stepchenkova, Group-IB, oscd.community",
            "date": "2019/11/01",
            "description": "Detects Silence EmpireDNSAgent as described in the Group-IP report",
            "detection": {
                "condition": "empire and dnscat",
                "dnscat": {
                    "ScriptBlockText|contains|all": [
                        "set type=$LookupType`nserver",
                        "$Command | nslookup 2>&1 | Out-String",
                        "New-RandomDNSField",
                        "[Convert]::ToString($SYNOptions, 16)",
                        "$Session.Dead = $True",
                        "$Session[\"Driver\"] -eq"
                    ]
                },
                "empire": {
                    "ScriptBlockText|contains|all": [
                        "System.Diagnostics.Process",
                        "Stop-Computer",
                        "Restart-Computer",
                        "Exception in execution",
                        "$cmdargs",
                        "Close-Dnscat2Tunnel"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3ceb2083-a27f-449a-be33-14ec1b7cc973",
            "level": "critical",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2023/04/03",
            "references": [
                "https://www.group-ib.com/resources/threat-research/silence_2.0.going_global.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1059.001",
                "attack.command_and_control",
                "attack.t1071.004",
                "attack.t1572",
                "attack.impact",
                "attack.t1529",
                "attack.g0091",
                "attack.s0363"
            ],
            "title": "Silence.EDA Detection"
        },
        {
            "author": "Igor Fits, oscd.community",
            "date": "2020/10/15",
            "description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.",
            "detection": {
                "condition": "execve and (shutdowncmd or (init and initselection))",
                "execve": {
                    "type": "EXECVE"
                },
                "init": [
                    "init",
                    "telinit"
                ],
                "initselection": [
                    0,
                    6
                ],
                "shutdowncmd": [
                    "shutdown",
                    "reboot",
                    "halt",
                    "poweroff"
                ]
            },
            "falsepositives": [
                "Legitimate administrative activity"
            ],
            "id": "4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f",
            "level": "informational",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/11/26",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1529"
            ],
            "title": "System Shutdown/Reboot - Linux"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Austin Clark, @c2defense",
        "Hubert Mank"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "impact"
        }
    ],
    "x_mitre_detection": "Use process monitoring to monitor the execution and command line parameters of binaries involved in shutting down or rebooting systems. Windows event logs may also designate activity associated with a shutdown/reboot, ex. Event ID 1074 and 6006. Unexpected or unauthorized commands from network cli on network devices may also be associated with shutdown/reboot, e.g. the <code>reload</code> command.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.3",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Sensor Health: Host Status",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": []
}