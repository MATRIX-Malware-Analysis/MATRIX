{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--afdcdd88-7fe3-4034-bf03-e310409f3438",
    "created": "2024-08-13T14:46:36.683836Z",
    "modified": "2024-08-13T14:46:36.683836Z",
    "name": "Adversary in the Middle (AiTM)",
    "description": "An adversary targets the communication between two components (typically client and server), in order to alter or obtain data from transactions. A general approach entails the adversary placing themself within the communication channel between the two components.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/94.html",
            "external_id": "94"
        },
        {
            "source_name": "CWE",
            "external_id": "300"
        },
        {
            "source_name": "CWE",
            "external_id": "290"
        },
        {
            "source_name": "CWE",
            "external_id": "593"
        },
        {
            "source_name": "CWE",
            "external_id": "287"
        },
        {
            "source_name": "CWE",
            "external_id": "294"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "In 2017, security researcher Jerry Decime discovered that Equifax mobile applications were not leveraging HTTPS in all areas. Although authentication was properly utilizing HTTPS, in addition to validating the root of trust of the server certificate, other areas of the application were using HTTP to communicate. Adversaries could then conduct MITM attacks on rogue WiFi or cellular networks and hijack the UX. This further allowed the adversaries to prompt users for sensitive data, which could then be obtained in the plaintext response. [REF-636]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Determine Communication Mechanism] The adversary determines the nature and mechanism of communication between two components, looking for opportunities to exploit.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Perform a sniffing attack and observe communication to determine a communication protocol.",
                "Look for application documentation that might describe a communication mechanism used by a target."
            ]
        },
        {
            "description": "[Position In Between Targets] The adversary inserts themself into the communication channel initially acting as a routing proxy between the two targeted components.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Install spyware on a client that will intercept outgoing packets and route them to their destination as well as route incoming packets back to the client.",
                "Exploit a weakness in an encrypted communication mechanism to gain access to traffic. Look for outdated mechanisms such as SSL."
            ]
        },
        {
            "description": "[Use Intercepted Data Maliciously] The adversary observes, filters, or alters passed data of its choosing to gain access to sensitive information or to manipulate the actions of the two target components for their own purposes.",
            "phase": "Exploit",
            "step": "3",
            "techniques": [
                "Prevent some messages from reaching their destination, causing a denial of service."
            ]
        }
    ],
    "x_mitre_impact": "Very High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Ensure Public Keys are signed by a Certificate Authority"
        },
        {
            "description": "Encrypt communications using cryptography (e.g., SSL/TLS)"
        },
        {
            "description": "Use Strong mutual authentication to always fully authenticate both ends of any communications channel."
        },
        {
            "description": "Exchange public keys using a secure channel"
        }
    ]
}