{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--0f2b1679-07fd-4179-bb47-1896e6053050",
    "created": "2024-08-13T14:46:36.883177Z",
    "modified": "2024-08-13T14:46:44.760923Z",
    "name": "Archive Collected Data",
    "description": "An adversary may compress and/or encrypt data that is collected prior to exfiltration. Compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network.[1] Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender.Both compression and encryption are done prior to exfiltration, and can be performed using a utility, 3rd party library, or custom method.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1560",
            "external_id": "T1560"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1560",
            "external_id": "T1560"
        },
        {
            "source_name": "DOJ GRU Indictment Jul 2018",
            "description": "Mueller, R. (2018, July 13). Indictment - United States of America vs. VIKTOR BORISOVICH NETYKSHO, et al. Retrieved September 13, 2018.",
            "url": "https://www.justice.gov/file/1080281/download"
        },
        {
            "source_name": "Wikipedia File Header Signatures",
            "description": "Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016.",
            "url": "https://en.wikipedia.org/wiki/List_of_file_signatures"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Various protocols maybe used to put data on the device for exfil or infil",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "tftp",
                    "rcp",
                    "puts",
                    "copy",
                    "configure replace",
                    "archive tar"
                ]
            },
            "falsepositives": [
                "Generally used to copy configs or IOS images"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "5e51acb2-bcbe-435b-99c6-0e3cd5e2aa59",
            "level": "low",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.lateral_movement",
                "attack.command_and_control",
                "attack.exfiltration",
                "attack.t1074",
                "attack.t1105",
                "attack.t1560.001"
            ],
            "title": "Cisco Stage Data"
        },
        {
            "author": "frack113",
            "date": "2021/07/27",
            "description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities",
            "detection": {
                "condition": "all of selection_*",
                "selection_action": {
                    "CommandLine|contains": [
                        " a ",
                        " u "
                    ]
                },
                "selection_img": [
                    {
                        "Description|contains": "7-Zip"
                    },
                    {
                        "Image|endswith": [
                            "\\7z.exe",
                            "\\7zr.exe",
                            "\\7za.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "7z.exe",
                            "7za.exe"
                        ]
                    }
                ],
                "selection_password": {
                    "CommandLine|contains": " -p"
                }
            },
            "falsepositives": [
                "Legitimate activity is expected since compressing files with a password is common."
            ],
            "id": "9fbf5927-5261-4284-a71d-f681029ea574",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Compress Data and Lock With Password for Exfiltration With 7-ZIP"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/27",
            "description": "Detects execution of 7z in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration.",
            "detection": {
                "condition": "all of selection_*",
                "selection_extension": {
                    "CommandLine|contains": [
                        ".dmp",
                        ".dump",
                        ".hdmp"
                    ]
                },
                "selection_img": [
                    {
                        "Description|contains": "7-Zip"
                    },
                    {
                        "Image|endswith": [
                            "\\7z.exe",
                            "\\7zr.exe",
                            "\\7za.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "7z.exe",
                            "7za.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of 7z with a command line in which \".dmp\" or \".dump\" appears accidentally",
                "Legitimate use of 7z to compress WER \".dmp\" files for troubleshooting"
            ],
            "id": "ec570e53-4c76-45a9-804d-dc3f355ff7a7",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/09/12",
            "references": [
                "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
            ],
            "related": [
                {
                    "id": "1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "7Zip Compressing Dump Files"
        },
        {
            "author": "frack113",
            "date": "2021/07/27",
            "description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities",
            "detection": {
                "condition": "all of selection*",
                "selection_other": {
                    "CommandLine|contains": [
                        " -min ",
                        " -a "
                    ]
                },
                "selection_password": {
                    "CommandLine|contains": "-s\""
                },
                "selection_winzip": {
                    "CommandLine|contains": [
                        "winzip.exe",
                        "winzip64.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e2e80da2-8c66-4e00-ae3c-2eebd29f6b6d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Compress Data and Lock With Password for Exfiltration With WINZIP"
        },
        {
            "author": "@ROxPinTeddy",
            "date": "2020/05/12",
            "description": "Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions.",
            "detection": {
                "condition": "selection_password and selection_other",
                "selection_other": {
                    "CommandLine|contains": [
                        " -m",
                        " a "
                    ]
                },
                "selection_password": {
                    "CommandLine|contains": " -hp"
                }
            },
            "falsepositives": [
                "Legitimate use of Winrar command line version",
                "Other command line tools, that use these flags"
            ],
            "id": "faa48cae-6b25-4f00-a094-08947fef582f",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/03/16",
            "references": [
                "https://labs.sentinelone.com/the-anatomy-of-an-apt-attack-and-cobaltstrike-beacons-encoded-configuration/",
                "https://ss64.com/bash/rar.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Rar Usage with Password and Compression Level"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/01",
            "description": "Detects suspicious manipulations of default accounts such as 'administrator' and 'guest'. For example 'enable' or 'disable' accounts or change the password...etc",
            "detection": {
                "condition": "all of selection_* and not filter",
                "filter": {
                    "CommandLine|contains|all": [
                        "guest",
                        "/active no"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\net.exe",
                            "\\net1.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "net.exe",
                            "net1.exe"
                        ]
                    }
                ],
                "selection_user_option": {
                    "CommandLine|contains": " user "
                },
                "selection_username": {
                    "CommandLine|contains": [
                        " J\u00e4rjestelm\u00e4nvalvoja ",
                        " Rendszergazda ",
                        " \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 ",
                        " Administrateur ",
                        " Administrador ",
                        " Administrat\u00f6r ",
                        " Administrator ",
                        " guest ",
                        " DefaultAccount ",
                        " \"J\u00e4rjestelm\u00e4nvalvoja\" ",
                        " \"Rendszergazda\" ",
                        " \"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\" ",
                        " \"Administrateur\" ",
                        " \"Administrador\" ",
                        " \"Administrat\u00f6r\" ",
                        " \"Administrator\" ",
                        " \"guest\" ",
                        " \"DefaultAccount\" ",
                        " 'J\u00e4rjestelm\u00e4nvalvoja' ",
                        " 'Rendszergazda' ",
                        " '\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440' ",
                        " 'Administrateur' ",
                        " 'Administrador' ",
                        " 'Administrat\u00f6r' ",
                        " 'Administrator' ",
                        " 'guest' ",
                        " 'DefaultAccount' "
                    ]
                }
            },
            "falsepositives": [
                "Some false positives could occur with the admin or guest account. It depends on the scripts being used by the admins in your env. If you experience a lot of FP you could reduce the level to medium"
            ],
            "id": "5b768e71-86f2-4879-b448-81061cbae951",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html",
                "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/",
                "https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Suspicious Manipulation Of Default Accounts Via Net.EXE"
        },
        {
            "author": "Timur Zinniatullin, E.M. Anhaus, oscd.community",
            "date": "2019/10/21",
            "description": "Detects usage of \"rar\" to add files to an archive for potential compression. An adversary may compress data (e.g. sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": " a ",
                    "Image|endswith": "\\rar.exe"
                }
            },
            "falsepositives": [
                "Highly likely if rar is a default archiver in the monitored environment."
            ],
            "id": "6f3e2987-db24-4c78-a860-b4f4095a7095",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2023/02/05",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/1ec33c93-3d0b-4a28-8014-dbdaae5c60ae.html"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Files Added To An Archive Using Rar.EXE"
        },
        {
            "id": "1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/04",
            "description": "Detects execution of WinRAR in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration.",
            "detection": {
                "condition": "all of selection_*",
                "selection_extension": {
                    "CommandLine|contains": [
                        ".dmp",
                        ".dump",
                        ".hdmp"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\rar.exe",
                            "\\winrar.exe"
                        ]
                    },
                    {
                        "Description": "Command line RAR"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of WinRAR with a command line in which \".dmp\" or \".dump\" appears accidentally",
                "Legitimate use of WinRAR to compress WER \".dmp\" files for troubleshooting"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/09/12",
            "references": [
                "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "ec570e53-4c76-45a9-804d-dc3f355ff7a7"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Winrar Compressing Dump Files"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), AdmU3",
            "date": "2023/12/19",
            "description": "Detects execution of \"tar.exe\" in order to create a compressed file.\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_create": {
                    "CommandLine|contains": [
                        "-c",
                        "-r",
                        "-u"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\tar.exe"
                    },
                    {
                        "OriginalFileName": "bsdtar"
                    }
                ]
            },
            "falsepositives": [
                "Likely"
            ],
            "id": "418a3163-3247-4b7b-9933-dcfcb7c52ea9",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "references": [
                "https://unit42.paloaltonetworks.com/chromeloader-malware/",
                "https://lolbas-project.github.io/lolbas/Binaries/Tar/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage"
            ],
            "tags": [
                "attack.collection",
                "attack.exfiltration",
                "attack.t1560",
                "attack.t1560.001"
            ],
            "title": "Compressed File Creation Via Tar.EXE",
            "status": "experimental"
        },
        {
            "author": "Florian Roth (Nextron Systems), Tigzy",
            "date": "2021/11/17",
            "description": "Detects a suspicious winrar execution in a folder which is not the default installation folder",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_path": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\WinRAR\\",
                        ":\\Program Files\\WinRAR\\"
                    ]
                },
                "filter_main_unrar": {
                    "Image|endswith": "\\UnRAR.exe"
                },
                "filter_optional_temp": {
                    "Image|contains": ":\\Windows\\Temp\\"
                },
                "selection": [
                    {
                        "Image|endswith": [
                            "\\rar.exe",
                            "\\winrar.exe"
                        ]
                    },
                    {
                        "Description": "Command line RAR"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of WinRAR in a folder of a software that bundles WinRAR"
            ],
            "id": "4ede543c-e098-43d9-a28f-dd784a13132f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/08/31",
            "references": [
                "https://twitter.com/cyb3rops/status/1460978167628406785"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1560.001"
            ],
            "title": "Winrar Execution in Non-Standard Folder"
        },
        {
            "author": "AdmU3",
            "date": "2023/12/19",
            "description": "Detects execution of \"tar.exe\" in order to extract compressed file.\nAdversaries may abuse various utilities in order to decompress data to avoid detection.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_extract": {
                    "CommandLine|contains": "-x"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\tar.exe"
                    },
                    {
                        "OriginalFileName": "bsdtar"
                    }
                ]
            },
            "falsepositives": [
                "Likely"
            ],
            "id": "bf361876-6620-407a-812f-bfe11e51e924",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "references": [
                "https://unit42.paloaltonetworks.com/chromeloader-malware/",
                "https://lolbas-project.github.io/lolbas/Binaries/Tar/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage"
            ],
            "tags": [
                "attack.collection",
                "attack.exfiltration",
                "attack.t1560",
                "attack.t1560.001"
            ],
            "title": "Compressed File Extraction Via Tar.EXE",
            "status": "experimental"
        },
        {
            "author": "Timur Zinniatullin, oscd.community",
            "date": "2019/10/21",
            "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "a0": "zip",
                    "type": "execve"
                },
                "selection2": {
                    "a0": "gzip",
                    "type": "execve",
                    "a1": "-k"
                },
                "selection3": {
                    "a0": "tar",
                    "type": "execve",
                    "a1|contains": "-c"
                }
            },
            "falsepositives": [
                "Legitimate use of archiving tools by legitimate user."
            ],
            "id": "a3b5e3e9-1b49-4119-8b8e-0344a01f21ee",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "level": "low",
            "modified": "2023/07/28",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/a78b9ed805ab9ea2e422e1aa7741e9407d82d7b1/atomics/T1560.001/T1560.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1560.001"
            ],
            "title": "Data Compressed"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "collection"
        }
    ],
    "x_mitre_detection": "Archival software and archived files can be detected in many ways. Common utilities that may be present on the system or brought in by an adversary may be detectable through process monitoring and monitoring for command-line arguments for known archival utilities. This may yield a significant number of benign events, depending on how systems in the environment are typically used.\n\nA process that loads the Windows DLL crypt32.dll may be used to perform encryption, decryption, or verification of file signatures.\n\nConsider detecting writing of files with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.(Citation: Wikipedia File Header Signatures)",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "Script: Script Execution",
        "Process: Process Creation",
        "File: File Creation"
    ],
    "x_mitre_permissions_required": []
}