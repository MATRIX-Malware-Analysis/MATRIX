{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c44379f8-5f15-4a2a-8f33-07026e8e9dff",
    "created": "2024-08-13T14:46:36.861511Z",
    "modified": "2024-08-13T14:46:48.31601Z",
    "name": "Ingress Tool Transfer",
    "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as ftp. Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. Lateral Tool Transfer). On Windows, adversaries may use various utilities to download tools, such as copy, finger, certutil, and PowerShell commands such as IEX(New-Object Net.WebClient).downloadString() and Invoke-WebRequest. On Linux and macOS systems, a variety of utilities also exist, such as curl, scp, sftp, tftp, rsync, finger, and wget.[1]Adversaries may also abuse installers and package managers, such as yum or winget, to download tools to victim hosts. Adversaries have also abused file application features, such as the Windows search-ms protocol handler, to deliver malicious files to victims through remote file searches invoked by User Execution (typically after interacting with Phishing lures).[2]Files can also be transferred using various Web Services as well as native or otherwise present tools on the victim system.[3] In some cases, adversaries may be able to leverage services that sync between a web-based and an on-premises client, such as Dropbox or OneDrive, to transfer files onto victim systems. For example, by compromising a cloud account and logging into the service's web portal, an adversary may be able to trigger an automatic syncing process that transfers the file onto the victim's machine.[4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1105",
            "external_id": "T1105"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1105",
            "external_id": "T1105"
        },
        {
            "source_name": "T1105: Trellix_search-ms",
            "description": " Mathanraj Thangaraju, Sijo Jacob. (2023, July 26). Beyond File Search: A Novel Method for Exploiting the \"search-ms\" URI Protocol Handler. Retrieved March 15, 2024.",
            "url": "https://www.trellix.com/blogs/research/beyond-file-search-a-novel-method/"
        },
        {
            "source_name": "Dropbox Malware Sync",
            "description": "David Talbot. (2013, August 21). Dropbox and Similar Services Can Sync Malware. Retrieved May 31, 2023.",
            "url": "https://www.technologyreview.com/2013/08/21/83143/dropbox-and-similar-services-can-sync-malware/"
        },
        {
            "source_name": "University of Birmingham C2",
            "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
            "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
        },
        {
            "source_name": "t1105_lolbas",
            "description": "LOLBAS. (n.d.). LOLBAS Mapped to T1105. Retrieved March 11, 2022.",
            "url": "https://lolbas-project.github.io/#t1105"
        },
        {
            "source_name": "PTSecurity Cobalt Dec 2016",
            "description": "Positive Technologies. (2016, December 16). Cobalt Snatch. Retrieved October 9, 2018.",
            "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "receive data"
                            },
                            {
                                "match": "host-interaction/file-system/write"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Command and Control::Ingress Tool Transfer [T1105]"
                    ],
                    "authors": [
                        "moritz.raabe@mandiant.com"
                    ],
                    "examples": [
                        "5D7C34B6854D48D3DA4F96B71550A221:0x401346"
                    ],
                    "maec/malware-category": "downloader",
                    "mbc": [
                        "Command and Control::C2 Communication::Server to Client File Transfer [B0030.003]"
                    ],
                    "name": "download and write a file",
                    "namespace": "communication/c2/file-transfer",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/11/08",
            "description": "Detects download of certain file types from hosts with dynamic DNS names (selected list)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-uri-extension": [
                        "exe",
                        "vbs",
                        "bat",
                        "rar",
                        "ps1",
                        "doc",
                        "docm",
                        "xls",
                        "xlsm",
                        "pptm",
                        "rtf",
                        "hta",
                        "dll",
                        "ws",
                        "wsf",
                        "sct",
                        "zip"
                    ],
                    "cs-host|endswith": [
                        ".hopto.org",
                        ".no-ip.org",
                        ".no-ip.info",
                        ".no-ip.biz",
                        ".no-ip.com",
                        ".noip.com",
                        ".ddns.name",
                        ".myftp.org",
                        ".myftp.biz",
                        ".serveblog.net",
                        ".servebeer.com",
                        ".servemp3.com",
                        ".serveftp.com",
                        ".servequake.com",
                        ".servehalflife.com",
                        ".servehttp.com",
                        ".servegame.com",
                        ".servepics.com",
                        ".myvnc.com",
                        ".ignorelist.com",
                        ".jkub.com",
                        ".dlinkddns.com",
                        ".jumpingcrab.com",
                        ".ddns.info",
                        ".mooo.com",
                        ".dns-dns.com",
                        ".strangled.net",
                        ".adultdns.net",
                        ".craftx.biz",
                        ".ddns01.com",
                        ".dns53.biz",
                        ".dnsapi.info",
                        ".dnsd.info",
                        ".dnsdynamic.com",
                        ".dnsdynamic.net",
                        ".dnsget.org",
                        ".fe100.net",
                        ".flashserv.net",
                        ".ftp21.net",
                        ".http01.com",
                        ".http80.info",
                        ".https443.com",
                        ".imap01.com",
                        ".kadm5.com",
                        ".mysq1.net",
                        ".ns360.info",
                        ".ntdll.net",
                        ".ole32.com",
                        ".proxy8080.com",
                        ".sql01.com",
                        ".ssh01.com",
                        ".ssh22.net",
                        ".tempors.com",
                        ".tftpd.net",
                        ".ttl60.com",
                        ".ttl60.org",
                        ".user32.com",
                        ".voip01.com",
                        ".wow64.net",
                        ".x64.me",
                        ".xns01.com",
                        ".dyndns.org",
                        ".dyndns.info",
                        ".dyndns.tv",
                        ".dyndns-at-home.com",
                        ".dnsomatic.com",
                        ".zapto.org",
                        ".webhop.net",
                        ".25u.com",
                        ".slyip.net"
                    ]
                }
            },
            "falsepositives": [
                "Software downloads"
            ],
            "fields": [
                "cs-ip",
                "c-uri"
            ],
            "id": "195c1119-ef07-4909-bb12-e66f5e07bf3c",
            "level": "medium",
            "logsource": {
                "category": "proxy"
            },
            "modified": "2023/05/18",
            "references": [
                "https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.command_and_control",
                "attack.t1105",
                "attack.t1568"
            ],
            "title": "Download from Suspicious Dyndns Hosts"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Various protocols maybe used to put data on the device for exfil or infil",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "tftp",
                    "rcp",
                    "puts",
                    "copy",
                    "configure replace",
                    "archive tar"
                ]
            },
            "falsepositives": [
                "Generally used to copy configs or IOS images"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "5e51acb2-bcbe-435b-99c6-0e3cd5e2aa59",
            "level": "low",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.lateral_movement",
                "attack.command_and_control",
                "attack.exfiltration",
                "attack.t1074",
                "attack.t1105",
                "attack.t1560.001"
            ],
            "title": "Cisco Stage Data"
        },
        {
            "author": "SOC Prime, Adam Swan",
            "date": "2020/05/01",
            "description": "Detects executable access via webdav6. Can be seen in APT 29 such as from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/",
            "detection": {
                "condition": "selection_webdav and selection_executable",
                "selection_executable": [
                    {
                        "resp_mime_types|contains": "dosexec"
                    },
                    {
                        "c-uri|endswith": ".exe"
                    }
                ],
                "selection_webdav": [
                    {
                        "c-useragent|contains": "WebDAV"
                    },
                    {
                        "c-uri|contains": "webdav"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "aac2fd97-bcba-491b-ad66-a6edf89c71bf",
            "logsource": {
                "product": "zeek",
                "service": "http"
            },
            "level": "medium",
            "modified": "2021/11/27",
            "references": [
                "http://carnal0wnage.attackresearch.com/2012/06/webdav-server-to-download-custom.html",
                "https://github.com/OTRF/detection-hackathon-apt29"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Executable from Webdav"
        },
        {
            "author": "Daniel Cortez",
            "date": "2024/06/04",
            "description": "Detects the execution of the nscurl utility in order to download files.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "--download ",
                        "--download-directory ",
                        "--output ",
                        "-dir ",
                        "-dl ",
                        "-ld",
                        "-o "
                    ],
                    "Image|endswith": "/nscurl"
                }
            },
            "falsepositives": [
                "Legitimate usage of nscurl by administrators and users."
            ],
            "id": "6d8a7cf1-8085-423b-b87d-7e880faabbdf",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "level": "medium",
            "references": [
                "https://www.loobins.io/binaries/nscurl/",
                "https://www.agnosticdev.com/content/how-diagnose-app-transport-security-issues-using-nscurl-and-openssl",
                "https://gist.github.com/nasbench/ca6ef95db04ae04ffd1e0b1ce709cadd"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download Via Nscurl - MacOS"
        },
        {
            "author": "Sohan G (D4rkCiph3r), Red Canary (idea)",
            "date": "2023/08/22",
            "description": "Detects potential in-memory downloading and compiling of applets using curl and osacompile as seen used by XCSSET malware",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "osacompile",
                        "curl"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "13db8d2e-7723-4c2c-93c1-a4d36994f7ef",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "level": "medium",
            "references": [
                "https://redcanary.com/blog/mac-application-bundles/"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.execution",
                "attack.t1059.007",
                "attack.t1105"
            ],
            "title": "Potential In-Memory Download And Compile Of Payloads",
            "status": "test"
        },
        {
            "author": "frack113",
            "date": "2021/11/24",
            "description": "Detects DNS queries made by \"AppInstaller.EXE\". The AppInstaller is the default handler for the \"ms-appinstaller\" URI. It attempts to load/install a package from the referenced URL\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\AppInstaller.exe",
                    "Image|startswith": "C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppInstaller_"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7cff77e1-9663-46a3-8260-17f2e1aa9d0a",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/11/09",
            "references": [
                "https://twitter.com/notwhickey/status/1333900137232523264",
                "https://lolbas-project.github.io/lolbas/Binaries/AppInstaller/"
            ],
            "related": [
                {
                    "id": "180c7c5c-d64b-4a63-86e9-68910451bc8b",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "AppX Package Installation Attempts Via AppInstaller.EXE"
        },
        {
            "author": "frack113",
            "date": "2022/01/22",
            "description": "Detects a network connection initiated by IMEWDBLD.EXE. This might indicate potential abuse of the utility as a LOLBIN in order to download arbitrary files or additional payloads.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\IMEWDBLD.exe",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8d7e392e-9b28-49e1-831d-5949c6281228",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2023/11/09",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-10---windows---powershell-download",
                "https://lolbas-project.github.io/lolbas/Binaries/IMEWDBLD/"
            ],
            "related": [
                {
                    "id": "863218bd-c7d0-4c52-80cd-0a96c09f54af",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Network Connection Initiated By IMEWDBLD.EXE"
        },
        {
            "author": "frack113, Florian Roth (Nextron Systems)",
            "date": "2022/08/28",
            "description": "Detects a script interpreter wscript/cscript opening a network connection to a non-local network. Adversaries may use script to download malicious payloads.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_local_ranges": {
                    "DestinationIp|cidr": [
                        "127.0.0.0/8",
                        "10.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "::1/128",
                        "fe80::/10",
                        "fc00::/7"
                    ]
                },
                "filter_main_ms_ranges": {
                    "DestinationIp|cidr": "20.0.0.0/11"
                },
                "selection": {
                    "Image|endswith": [
                        "\\wscript.exe",
                        "\\cscript.exe"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate scripts"
            ],
            "id": "992a6cae-db6a-43c8-9cec-76d7195c96fc",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"
            ],
            "related": [
                {
                    "id": "08249dc0-a28d-4555-8ba5-9255a198e08c",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Outbound Network Connection Initiated By Script Interpreter"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/04/20",
            "description": "Detects an executable that isn't dropbox but communicates with the Dropbox API",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_legit_dropbox": {
                    "Image|contains": "\\Dropbox"
                },
                "selection": {
                    "DestinationHostname|endswith": [
                        "api.dropboxapi.com",
                        "content.dropboxapi.com"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of the API with a tool that the author wasn't aware of"
            ],
            "id": "25eabf56-22f0-4915-a1ed-056b8dae0a68",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://app.any.run/tasks/7e906adc-9d11-447f-8641-5f40375ecebb",
                "https://www.zscaler.com/blogs/security-research/new-espionage-attack-molerats-apt-targeting-users-middle-east"
            ],
            "title": "Suspicious Dropbox API Usage",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2018/08/30",
            "description": "Detects executables located in potentially suspicious directories initiating network connections towards file sharing domains.",
            "detection": {
                "condition": "all of selection_*",
                "selection_domains": {
                    "DestinationHostname|endswith": [
                        ".githubusercontent.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cdn.discordapp.com/attachments/",
                        "ddns.net",
                        "dl.dropboxusercontent.com",
                        "ghostbin.co",
                        "glitch.me",
                        "gofile.io",
                        "hastebin.com",
                        "mediafire.com",
                        "mega.co.nz",
                        "mega.nz",
                        "onrender.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "privatlab.com",
                        "privatlab.net",
                        "send.exploit.in",
                        "sendspace.com",
                        "storage.googleapis.com",
                        "storjshare.io",
                        "supabase.co",
                        "temp.sh",
                        "transfer.sh",
                        "ufile.io"
                    ],
                    "Initiated": "true"
                },
                "selection_paths": {
                    "Image|contains": [
                        ":\\$Recycle.bin",
                        ":\\Perflogs\\",
                        ":\\Temp\\",
                        ":\\Users\\Default\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Fonts\\",
                        ":\\Windows\\IME\\",
                        ":\\Windows\\System32\\Tasks\\",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        "\\AppData\\Temp\\",
                        "\\config\\systemprofile\\",
                        "\\Windows\\addins\\"
                    ]
                }
            },
            "falsepositives": [
                "Some installers located in the temp directory might communicate with the Github domains in order to download additional software. Baseline these cases or move the github domain to a lower level hunting rule."
            ],
            "id": "e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/05/31",
            "references": [
                "https://twitter.com/M_haggis/status/900741347035889665",
                "https://twitter.com/M_haggis/status/1032799638213066752",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
                "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
                "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/exfil/Invoke-ExfilDataToGitHub.ps1"
            ],
            "related": [
                {
                    "id": "635dbb88-67b3-4b41-9ea5-a3af2dd88153",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Network Communication Initiated To File Sharing Domains From Process Located In Suspicious Folder"
        },
        {
            "author": "frack113, Florian Roth (Nextron Systems)",
            "date": "2022/09/02",
            "description": "Detects a network connection initiated by the certutil.exe utility.\nAttackers can abuse the utility in order to download malware or additional payloads.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationPort": [
                        80,
                        135,
                        443,
                        445
                    ],
                    "Image|endswith": "\\certutil.exe",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0dba975d-a193-4ed1-a067-424df57570d1",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/05/31",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Uncommon Network Connection Initiated By Certutil.EXE"
        },
        {
            "id": "08249dc0-a28d-4555-8ba5-9255a198e08c",
            "author": "frack113",
            "date": "2022/08/28",
            "description": "Detects a script interpreter (Wscript/Cscript) initiating a local network connection to download or execute a script hosted on a shared folder.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\wscript.exe",
                        "\\cscript.exe"
                    ],
                    "DestinationIp|cidr": [
                        "127.0.0.0/8",
                        "10.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16",
                        "::1/128",
                        "fe80::/10",
                        "fc00::/7"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate scripts"
            ],
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2024/05/31",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "992a6cae-db6a-43c8-9cec-76d7195c96fc"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Local Network Connection Initiated By Script Interpreter"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2017/03/19",
            "description": "Detects a network connection initiated by programs or processes running from suspicious or uncommon files system locations.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_domains": {
                    "DestinationHostname|endswith": [
                        ".githubusercontent.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cdn.discordapp.com/attachments/",
                        "ddns.net",
                        "dl.dropboxusercontent.com",
                        "ghostbin.co",
                        "glitch.me",
                        "gofile.io",
                        "hastebin.com",
                        "mediafire.com",
                        "mega.co.nz",
                        "mega.nz",
                        "onrender.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "portmap.io",
                        "privatlab.com",
                        "privatlab.net",
                        "send.exploit.in",
                        "sendspace.com",
                        "storage.googleapis.com",
                        "storjshare.io",
                        "supabase.co",
                        "temp.sh",
                        "transfer.sh",
                        "ufile.io"
                    ]
                },
                "selection": {
                    "Image|contains": [
                        ":\\$Recycle.bin",
                        ":\\Perflogs\\",
                        ":\\Temp\\",
                        ":\\Users\\Default\\",
                        ":\\Windows\\Fonts\\",
                        ":\\Windows\\IME\\",
                        ":\\Windows\\System32\\Tasks\\",
                        ":\\Windows\\Tasks\\",
                        "\\config\\systemprofile\\",
                        "\\Windows\\addins\\"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7b434893-c57d-4f41-908d-6a17bf1ae98f",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/05/31",
            "references": [
                "https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/07/03",
            "description": "Detects a suspicious Microsoft desktopimgdownldr file creation that stores a file to a suspicious location or contains a file with a suspicious extension",
            "detection": {
                "condition": "selection and not filter1 and not filter2",
                "filter1": {
                    "TargetFilename|contains": "C:\\Windows\\"
                },
                "filter2": {
                    "TargetFilename|contains": [
                        ".jpg",
                        ".jpeg",
                        ".png"
                    ]
                },
                "selection": {
                    "Image|endswith": "\\svchost.exe",
                    "TargetFilename|contains": "\\Personalization\\LockScreenImage\\"
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "fc4f4817-0c53-4683-a4ee-b17a64bc1039",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/06/02",
            "references": [
                "https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/",
                "https://twitter.com/SBousseaden/status/1278977301745741825"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Desktopimgdownldr Target File"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/07/03",
            "description": "Detects a suspicious curl process start on Windows and outputs the requested document to a local file",
            "detection": {
                "condition": "selection_curl and 1 of selection_susp_* and not 1 of filter_optional_*",
                "filter_optional_git_windows": {
                    "CommandLine|contains|all": [
                        "--silent --show-error --output ",
                        "gfw-httpget-",
                        "AppData"
                    ],
                    "Image": "C:\\Program Files\\Git\\mingw64\\bin\\curl.exe",
                    "ParentImage": "C:\\Program Files\\Git\\usr\\bin\\sh.exe"
                },
                "selection_curl": [
                    {
                        "Image|endswith": "\\curl.exe"
                    },
                    {
                        "Product": "The curl executable"
                    }
                ],
                "selection_susp_extensions": {
                    "CommandLine|endswith": [
                        ".dll",
                        ".gif",
                        ".jpeg",
                        ".jpg",
                        ".png",
                        ".temp",
                        ".tmp",
                        ".txt",
                        ".vbe",
                        ".vbs"
                    ]
                },
                "selection_susp_locations": {
                    "CommandLine|contains": [
                        "%AppData%",
                        "%Public%",
                        "%Temp%",
                        "%tmp%",
                        "\\AppData\\",
                        "\\Desktop\\",
                        "\\Temp\\",
                        "\\Users\\Public\\",
                        "C:\\PerfLogs\\",
                        "C:\\ProgramData\\",
                        "C:\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e218595b-bbe7-4ee5-8a96-f32a24ad3468",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://twitter.com/max_mal_/status/1542461200797163522",
                "https://web.archive.org/web/20200128160046/https://twitter.com/reegun21/status/1222093798009790464",
                "https://github.com/pr0xylife/Qakbot/blob/4f0795d79dabee5bc9dd69f17a626b48852e7869/Qakbot_AA_23.06.2022.txt",
                "https://www.volexity.com/blog/2022/07/28/sharptongue-deploys-clever-mail-stealing-browser-extension-sharpext/",
                "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1105/T1105.md#atomic-test-18---curl-download-file"
            ],
            "related": [
                {
                    "id": "bbeaed61-1990-4773-bf57-b81dbad7db2d",
                    "type": "derived"
                },
                {
                    "id": "9a517fca-4ba3-4629-9278-a68694697b81",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Curl.EXE Download"
        },
        {
            "author": "Victor Sergeev, oscd.community",
            "date": "2020/10/09",
            "description": "Detects execution of GfxDownloadWrapper.exe with a URL as an argument to download file.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_known_urls": {
                    "CommandLine|contains": "https://gameplayapi.intel.com/"
                },
                "selection": {
                    "CommandLine|contains": [
                        "http://",
                        "https://"
                    ],
                    "Image|endswith": "\\GfxDownloadWrapper.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "eee00933-a761-4cd0-be70-c42fe91731e7",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/10/18",
            "references": [
                "https://lolbas-project.github.io/lolbas/HonorableMentions/GfxDownloadWrapper/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Arbitrary File Download Via GfxDownloadWrapper.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/24",
            "description": "Detects suspicious ways to download files or content using PowerShell",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        ".DownloadString(",
                        ".DownloadFile(",
                        "Invoke-WebRequest ",
                        "iwr "
                    ]
                }
            },
            "falsepositives": [
                "Scripts or tools that download files"
            ],
            "id": "6e897651-f157-4d8f-aaeb-df8151488385",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/01/05",
            "references": [
                "https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/88e8eca34464a547c90d9140d70e9866dcbc6a12/Download-Cradles.cmd"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.execution",
                "attack.t1059.001",
                "attack.t1105"
            ],
            "title": "PowerShell Web Download"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/10",
            "description": "Detects execution of the Notepad++ updater (gup) from a process other than Notepad++ to download files.",
            "detection": {
                "condition": "all of selection* and not filter",
                "filter": {
                    "ParentImage|endswith": "\\notepad++.exe"
                },
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " -unzipTo ",
                        "http"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\GUP.exe"
                    },
                    {
                        "OriginalFileName": "gup.exe"
                    }
                ]
            },
            "falsepositives": [
                "Other parent processes other than notepad++ using GUP that are not currently identified"
            ],
            "id": "44143844-0631-49ab-97a0-96387d6b2d7c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/02",
            "references": [
                "https://twitter.com/nas_bench/status/1535322182863179776"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download Using Notepad++ GUP Utility"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/05/16",
            "description": "Detects execution of the IEExec utility to download and execute files",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "http://",
                        "https://"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\IEExec.exe"
                    },
                    {
                        "OriginalFileName": "IEExec.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9801abb8-e297-4dbf-9fbd-57dde0e830ad",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/09",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Ieexec/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download And Execution Via IEExec.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/08/28",
            "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "powershell",
                        ".DownloadFile",
                        "System.Net.WebClient"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8f70ac5f-1f6f-4f8e-b454-db19561216c5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1059.001",
                "attack.command_and_control",
                "attack.t1104",
                "attack.t1105"
            ],
            "title": "PowerShell DownloadFile"
        },
        {
            "author": "frack113",
            "date": "2022/05/02",
            "description": "Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " -f",
                        ".zip"
                    ],
                    "Image|endswith": "\\PrintBrm.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "cafeeba3-01da-4ab4-b6c4-a31b1d9730c7",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/PrintBrm/"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1105",
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "PrintBrm ZIP Creation of Extraction",
            "status": "test"
        },
        {
            "author": "Florian Roth (Nextron Systems), omkar72, oscd.community",
            "date": "2021/02/24",
            "description": "Detects execution of the \"finger.exe\" utility.\nFinger.EXE or \"TCPIP Finger Command\" is an old utility that is still present on modern Windows installation. It Displays information about users on a specified remote computer (typically a UNIX computer) that is running the finger service or daemon.\nDue to the old nature of this utility and the rareness of machines having the finger service. Any execution of \"finger.exe\" can be considered \"suspicious\" and worth investigating.\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "OriginalFileName": "finger.exe"
                    },
                    {
                        "Image|endswith": "\\finger.exe"
                    }
                ]
            },
            "falsepositives": [
                "Admin activity (unclear what they do nowadays with finger.exe)"
            ],
            "id": "af491bca-e752-4b44-9c86-df5680533dbc",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://twitter.com/bigmacjpg/status/1349727699863011328?s=12",
                "https://app.any.run/tasks/40115012-a919-4208-bfed-41e82cb3dadf/",
                "http://hyp3rlinx.altervista.org/advisories/Windows_TCPIP_Finger_Command_C2_Channel_and_Bypassing_Security_Software.txt"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Finger.EXE Execution"
        },
        {
            "author": "Tim Rauch, Elastic (idea)",
            "date": "2022/09/27",
            "description": "Detects the desktopimgdownldr utility being used to download a remote file. An adversary may use desktopimgdownldr to download arbitrary files as an alternative to certutil.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "/lockscreenurl:http",
                    "Image|endswith": "\\desktopimgdownldr.exe",
                    "ParentImage|endswith": "\\desktopimgdownldr.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "214641c2-c579-4ecb-8427-0cf19df6842e",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://www.elastic.co/guide/en/security/current/remote-file-download-via-desktopimgdownldr-utility.html"
            ],
            "title": "Remote File Download Via Desktopimgdownldr Utility",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "author": "Sreeman, Florian Roth (Nextron Systems)",
            "date": "2022/01/04",
            "description": "Detects execution of chromium based browser in headless mode using the \"dump-dom\" command line to download files",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "--headless",
                        "dump-dom",
                        "http"
                    ],
                    "Image|endswith": [
                        "\\brave.exe",
                        "\\chrome.exe",
                        "\\msedge.exe",
                        "\\opera.exe",
                        "\\vivaldi.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0e8cfe08-02c9-4815-a2f8-0d157b7ed33e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/12",
            "references": [
                "https://twitter.com/mrd0x/status/1478234484881436672?s=12",
                "https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html"
            ],
            "related": [
                {
                    "id": "ef9dcfed-690c-4c5d-a9d1-482cd422225c",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download with Headless Browser"
        },
        {
            "author": "frack113",
            "date": "2021/11/26",
            "description": "Download or Copy file with Extrac32",
            "detection": {
                "condition": "all of selection_*",
                "selection_archive": {
                    "CommandLine|contains": ".cab"
                },
                "selection_lolbas": [
                    {
                        "CommandLine|contains": "extrac32.exe"
                    },
                    {
                        "Image|endswith": "\\extrac32.exe"
                    },
                    {
                        "OriginalFileName": "extrac32.exe"
                    }
                ],
                "selection_options": {
                    "CommandLine|contains": [
                        "/C",
                        "/Y",
                        " \\\\\\\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "aa8e035d-7be4-48d3-a944-102aec04400d",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2022/08/13",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Extrac32/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Extrac32 Execution"
        },
        {
            "author": "frack113",
            "date": "2021/11/26",
            "description": "Download and compress a remote file and store it in a cab file on local machine.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "diantz.exe",
                        " \\\\\\\\",
                        ".cab"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "185d7418-f250-42d0-b72e-0c8b70661e93",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2022/08/13",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Diantz/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Diantz Download and Compress Into a CAB File"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/02",
            "description": "Detects a suspicious call to Invoke-WebRequest cmdlet where the and output is located in a suspicious location",
            "detection": {
                "condition": "all of selection_*",
                "selection_commands": {
                    "CommandLine|contains": [
                        "curl ",
                        "Invoke-WebRequest",
                        "iwr ",
                        "wget "
                    ]
                },
                "selection_flags": {
                    "CommandLine|contains": [
                        " -ur",
                        " -o"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll"
                        ]
                    }
                ],
                "selection_susp_locations": {
                    "CommandLine|contains": [
                        "\\AppData\\",
                        "\\Desktop\\",
                        "\\Temp\\",
                        "\\Users\\Public\\",
                        "%AppData%",
                        "%Public%",
                        "%Temp%",
                        "%tmp%",
                        ":\\Windows\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5e3cc4d8-3e68-43db-8656-eaaeefdec9cc",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/02/23",
            "status": "experimental",
            "references": [
                "https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "e218595b-bbe7-4ee5-8a96-f32a24ad3468"
                }
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Invoke-WebRequest Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
            "date": "2019/01/16",
            "description": "Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "http",
                        "://",
                        "%AppData%"
                    ],
                    "Image|endswith": "\\cmd.exe"
                }
            },
            "falsepositives": [
                "High"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "1ac8666b-046f-4201-8aba-1951aaec03a3",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2021/11/27",
            "references": [
                "https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100",
                "https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.command_and_control",
                "attack.t1059.003",
                "attack.t1059.001",
                "attack.t1105"
            ],
            "title": "Command Line Execution with Suspicious URL and AppData Strings"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/12/27",
            "description": "Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents",
            "detection": {
                "condition": "all of selection_*",
                "selection_domains": {
                    "CommandLine|contains": [
                        "https://attachment.outlook.live.net/owa/",
                        "https://onenoteonlinesync.onenote.com/onenoteonlinesync/"
                    ]
                },
                "selection_download": [
                    {
                        "Image|endswith": [
                            "\\curl.exe",
                            "\\wget.exe"
                        ]
                    },
                    {
                        "CommandLine|contains": [
                            "Invoke-WebRequest",
                            "iwr ",
                            "curl ",
                            "wget ",
                            "Start-BitsTransfer",
                            ".DownloadFile(",
                            ".DownloadString("
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Scripts or tools that download attachments from these domains (OneNote, Outlook 365)"
            ],
            "id": "00d49ed5-4491-4271-a8db-650a4ef6f8c1",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/08/02",
            "references": [
                "https://twitter.com/an0n_r0/status/1474698356635193346?s=12",
                "https://twitter.com/mrd0x/status/1475085452784844803?s=12"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105",
                "attack.t1608"
            ],
            "title": "Suspicious Download from Office Domain"
        },
        {
            "author": "frack113",
            "date": "2022/08/28",
            "description": "Detects the usage of nimgrab, a tool bundled with the Nim programming framework and used for downloading files.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_hash": [
                    {
                        "md5": "2DD44C3C29D667F5C0EF5F9D7C7FFB8B"
                    },
                    {
                        "sha256": "F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559"
                    },
                    {
                        "Imphash": "C07FDDD21D123EA9B3A08EEF44AAAC45"
                    }
                ],
                "selection_hashes": {
                    "Hashes|contains": [
                        "MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B",
                        "SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559",
                        "IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45"
                    ]
                },
                "selection_name": {
                    "Image|endswith": "\\nimgrab.exe"
                }
            },
            "falsepositives": [
                "Legitimate use of Nim on a developer systems"
            ],
            "id": "74a12f18-505c-4114-8d0b-8448dd5485c6",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "PUA - Nimgrab Execution"
        },
        {
            "author": "Matthew Matchen",
            "date": "2020/09/04",
            "description": "Detects the use of Windows Defender MpCmdRun.EXE to download files",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "DownloadFile",
                        "url"
                    ]
                },
                "selection_img": [
                    {
                        "OriginalFileName": "MpCmdRun.exe"
                    },
                    {
                        "Image|endswith": "\\MpCmdRun.exe"
                    },
                    {
                        "CommandLine|contains": "MpCmdRun.exe"
                    },
                    {
                        "Description": "Microsoft Malware Protection Command Line Utility"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "46123129-1024-423e-9fae-43af4a0fa9a5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/09",
            "references": [
                "https://web.archive.org/web/20200903194959/https://twitter.com/djmtshepana/status/1301608169496612866",
                "https://lolbas-project.github.io/lolbas/Binaries/MpCmdRun/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download Via Windows Defender MpCmpRun.EXE"
        },
        {
            "id": "ef9dcfed-690c-4c5d-a9d1-482cd422225c",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/09/12",
            "description": "Detects execution of Chromium based browser in headless mode",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "--headless",
                    "Image|endswith": [
                        "\\brave.exe",
                        "\\chrome.exe",
                        "\\msedge.exe",
                        "\\opera.exe",
                        "\\vivaldi.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "related": [
                {
                    "type": "derived",
                    "id": "0e8cfe08-02c9-4815-a2f8-0d157b7ed33e"
                }
            ],
            "references": [
                "https://twitter.com/mrd0x/status/1478234484881436672?s=12",
                "https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Browser Execution In Headless Mode"
        },
        {
            "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/05",
            "description": "Detects execution of \"findstr\" with specific flags and a remote share path. This specific set of CLI flags would allow \"findstr\" to download the content of the file located on the remote share as described in the LOLBAS entry.\n",
            "detection": {
                "condition": "selection_findstr and all of selection_cli_download_*",
                "selection_cli_download_1": {
                    "CommandLine|contains|windash": " -v "
                },
                "selection_cli_download_2": {
                    "CommandLine|contains|windash": " -l "
                },
                "selection_cli_download_3": {
                    "CommandLine|contains": "\\\\\\\\"
                },
                "selection_findstr": [
                    {
                        "CommandLine|contains": "findstr"
                    },
                    {
                        "Image|endswith": "findstr.exe"
                    },
                    {
                        "OriginalFileName": "FINDSTR.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "587254ee-a24b-4335-b3cd-065c0f1f4baa",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2024/03/05",
            "status": "experimental",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
                "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "related": [
                {
                    "id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1564.004",
                "attack.t1552.001",
                "attack.t1105"
            ],
            "title": "Remote File Download Via Findstr.EXE"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/11/24",
            "description": "Detects a suspicious certreq execution taken from the LOLBAS examples, which can be abused to download (small) files",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " -Post ",
                        " -config ",
                        " http",
                        " C:\\windows\\win.ini "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\certreq.exe"
                    },
                    {
                        "OriginalFileName": "CertReq.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "4480827a-9799-4232-b2c4-ccc6c4e9e12b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/06/13",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Certreq/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Certreq Command to Download"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/14",
            "description": "Detects usage of the \"type\" command to download/upload data from WebDAV server",
            "detection": {
                "condition": "1 of selection_*",
                "selection_download": {
                    "CommandLine|contains|all": [
                        "type \\\\\\\\",
                        " > "
                    ]
                },
                "selection_upload": {
                    "CommandLine|contains|all": [
                        "type ",
                        " > \\\\\\\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "aa0b3a82-eacc-4ec3-9150-b5a9a3e3f82f",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://mr0range.com/a-new-lolbin-using-the-windows-type-command-to-upload-download-files-81d7b6179e22"
            ],
            "title": "Potential Download/Upload Activity Using Type Command",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/12/25",
            "description": "Detects usage of COM objects that can be abused to download files in PowerShell by CLSID",
            "detection": {
                "condition": "all of selection_*",
                "selection_1": {
                    "CommandLine|contains": "[Type]::GetTypeFromCLSID("
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "0002DF01-0000-0000-C000-000000000046",
                        "F6D90F16-9C73-11D3-B32E-00C04F990BB4",
                        "F5078F35-C551-11D3-89B9-0000F81FE221",
                        "88d96a0a-f192-11d4-a65f-0040963251e5",
                        "AFBA6B42-5692-48EA-8141-DC517DCF0EF1",
                        "AFB40FFD-B609-40A3-9828-F88BBE11E4E3",
                        "88d96a0b-f192-11d4-a65f-0040963251e5",
                        "2087c2f4-2cef-4953-a8ab-66779b670495",
                        "000209FF-0000-0000-C000-000000000046",
                        "00024500-0000-0000-C000-000000000046"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of the library"
            ],
            "id": "02b64f1b-3f33-4e67-aede-ef3b0a5a8fcf",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://learn.microsoft.com/en-us/dotnet/api/system.type.gettypefromclsid?view=net-7.0",
                "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=57"
            ],
            "related": [
                {
                    "id": "3c7d1587-3b13-439f-9941-7d14313dbdfe",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Potential COM Objects Download Cradles Usage - Process Creation"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/10/18",
            "description": "Detects when a user downloads a file from an IP based URL using CertOC.exe",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains": "-GetCACAPS"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\certoc.exe"
                    },
                    {
                        "OriginalFileName": "CertOC.exe"
                    }
                ],
                "selection_ip": {
                    "CommandLine|re": "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b86f6dea-0b2f-41f5-bdcc-a057bd19cd6a",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"
            ],
            "related": [
                {
                    "id": "70ad0861-d1fe-491c-a45f-fa48148a300d",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.execution",
                "attack.t1105"
            ],
            "title": "File Download From IP Based URL Via CertOC.EXE"
        },
        {
            "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/05",
            "description": "Detects execution of findstr with the \"s\" and \"i\" flags for a \"subfolder\" and \"insensitive\" search respectively. Attackers sometimes leverage this built-in utility to search the system for interesting files or filter through results of commands.\n",
            "detection": {
                "condition": "selection_findstr and all of selection_cli_search_*",
                "selection_cli_search_insensitive": {
                    "CommandLine|contains|windash": " -i "
                },
                "selection_cli_search_subfolder": {
                    "CommandLine|contains|windash": " -s "
                },
                "selection_findstr": [
                    {
                        "CommandLine|contains": "findstr"
                    },
                    {
                        "Image|endswith": "findstr.exe"
                    },
                    {
                        "OriginalFileName": "FINDSTR.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Administrative or software activity"
            ],
            "id": "04936b66-3915-43ad-a8e5-809eadfd1141",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2024/03/05",
            "status": "experimental",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
                "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "related": [
                {
                    "id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1564.004",
                "attack.t1552.001",
                "attack.t1105"
            ],
            "title": "Insensitive Subfolder Search Via Findstr.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/07/03",
            "description": "Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet",
            "detection": {
                "condition": "( selection1 and not selection1_filter ) or selection_reg",
                "selection1": {
                    "CommandLine|contains": " /lockscreenurl:"
                },
                "selection1_filter": {
                    "CommandLine|contains": [
                        ".jpg",
                        ".jpeg",
                        ".png"
                    ]
                },
                "selection_reg": {
                    "CommandLine|contains|all": [
                        "reg delete",
                        "\\PersonalizationCSP"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "bb58aa4a-b80b-415a-a2c0-2f65a4c81009",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/",
                "https://twitter.com/SBousseaden/status/1278977301745741825"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Suspicious Desktopimgdownldr Command"
        },
        {
            "author": "Florian Roth (Nextron Systems), Hieu Tran",
            "date": "2023/03/13",
            "description": "Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest cmdlet",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "Invoke-WebRequest ",
                        "IWR "
                    ],
                    "CommandLine|contains|all": [
                        "http",
                        "OutFile",
                        ".dll"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0f0450f3-8b47-441e-a31b-15a91dc243e2",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
            ],
            "title": "Potential DLL File Download Via PowerShell Invoke-WebRequest",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.execution",
                "attack.t1059.001",
                "attack.t1105"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/04/21",
            "description": "Detects calls to PowerShell with Invoke-WebRequest cmdlet using direct IP access",
            "detection": {
                "condition": "all of selection_*",
                "selection_commands": {
                    "CommandLine|contains": [
                        "curl ",
                        "Invoke-WebRequest",
                        "iwr ",
                        "wget "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll"
                        ]
                    }
                ],
                "selection_ip": {
                    "CommandLine|contains": [
                        "://1",
                        "://2",
                        "://3",
                        "://4",
                        "://5",
                        "://6",
                        "://7",
                        "://8",
                        "://9"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1edff897-9146-48d2-9066-52e8d8f80a2f",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software"
            ],
            "title": "Suspicious Invoke-WebRequest Execution With DirectIP",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "id": "70ad0861-d1fe-491c-a45f-fa48148a300d",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/05/16",
            "description": "Detects when a user downloads a file by using CertOC.exe",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "-GetCACAPS",
                        "http"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\certoc.exe"
                    },
                    {
                        "OriginalFileName": "CertOC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"
            ],
            "modified": "2023/10/18",
            "related": [
                {
                    "type": "similar",
                    "id": "b86f6dea-0b2f-41f5-bdcc-a057bd19cd6a"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download via CertOC.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/02/09",
            "description": "Detects suspicious msiexec process starts with web addresses as parameter",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " msiexec",
                        "://"
                    ]
                }
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "id": "f7b5f842-a6af-4da5-9e95-e32478f3cd2f",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2022/01/07",
            "references": [
                "https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/"
            ],
            "related": [
                {
                    "id": "8150732a-0c9d-4a99-82b9-9efb9b90c40c",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.007",
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "MsiExec Web Install"
        },
        {
            "author": "Sreeman, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/01/13",
            "description": "Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "curl ",
                        "http",
                        "-o",
                        "&"
                    ],
                    "CommandLine|contains|windash": " -c "
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "21dd6d38-2b18-4453-9404-a0fe4a0cc288",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "references": [
                "https://medium.com/@reegun/curl-exe-is-the-new-rundll32-exe-lolbin-3f79c5f35983"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Curl Download And Execute Combination"
        },
        {
            "author": "@gott_cyber",
            "date": "2022/09/02",
            "description": "Detects the execution of \"Ldifde.exe\" with the import flag \"-i\". The can be abused to include HTTP-based arguments which will allow the arbitrary download of files from a remote server.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "-i",
                        "-f"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\ldifde.exe"
                    },
                    {
                        "OriginalFileName": "ldifde.exe"
                    }
                ]
            },
            "falsepositives": [
                "Since the content of the files are unknown, false positives are expected"
            ],
            "id": "6f535e01-ca1f-40be-ab8d-45b19c0c8b7f",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/03/14",
            "references": [
                "https://twitter.com/0gtweet/status/1564968845726580736",
                "https://strontic.github.io/xcyclopedia/library/ldifde.exe-979DE101F5059CEC1D2C56967CA2BAC0.html",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1105"
            ],
            "title": "Import LDAP Data Interchange Format File Via Ldifde.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/11",
            "description": "Detects execution of a browser process with a URL argument pointing to a file with a potentially interesting extension. This can be abused to download arbitrary files or to hide from the user for example by launching the browser in a minimized state.",
            "detection": {
                "condition": "all of selection_*",
                "selection_extensions": {
                    "CommandLine|endswith": [
                        ".7z",
                        ".dat",
                        ".dll",
                        ".exe",
                        ".hta",
                        ".ps1",
                        ".psm1",
                        ".txt",
                        ".vbe",
                        ".vbs",
                        ".zip"
                    ]
                },
                "selection_http": {
                    "CommandLine|contains": "http"
                },
                "selection_img": {
                    "Image|endswith": [
                        "\\brave.exe",
                        "\\chrome.exe",
                        "\\msedge.exe",
                        "\\opera.exe",
                        "\\vivaldi.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "94771a71-ba41-4b6e-a757-b531372eaab6",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/11/09",
            "references": [
                "https://twitter.com/mrd0x/status/1478116126005641220",
                "https://lolbas-project.github.io/lolbas/Binaries/Msedge/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "File Download From Browser Process Via Inline URL"
        },
        {
            "author": "frack113",
            "date": "2022/03/06",
            "description": "Detects the use of Replace.exe which can be used to replace file with another file",
            "detection": {
                "argument": {
                    "CommandLine|contains|windash": "-a"
                },
                "condition": "selection and argument",
                "selection": {
                    "Image|endswith": "\\replace.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9292293b-8496-4715-9db6-37028dcda4b3",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2024/03/13",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Replace/",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/replace"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Replace.exe Usage"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/05/09",
            "description": "Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened.",
            "detection": {
                "condition": "selection and selection_filename",
                "selection": {
                    "EventID": 5379,
                    "TargetName|contains": "Microsoft_Windows_Shell_ZipFolder:filename"
                },
                "selection_filename": {
                    "TargetName|contains": [
                        "invoice",
                        "new order",
                        "rechnung",
                        "factura",
                        "delivery",
                        "purchase",
                        "order",
                        "payment"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate used of encrypted ZIP files"
            ],
            "id": "54f0434b-726f-48a1-b2aa-067df14516e4",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://twitter.com/sbousseaden/status/1523383197513379841"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.defense_evasion",
                "attack.t1027",
                "attack.t1105",
                "attack.t1036"
            ],
            "title": "Password Protected ZIP File Opened (Suspicious Filenames)",
            "status": "test"
        },
        {
            "id": "3c7d1587-3b13-439f-9941-7d14313dbdfe",
            "author": "frack113",
            "date": "2022/12/25",
            "description": "Detects usage of COM objects that can be abused to download files in PowerShell by CLSID",
            "detection": {
                "condition": "all of selection_*",
                "selection_1": {
                    "ScriptBlockText|contains": "[Type]::GetTypeFromCLSID("
                },
                "selection_2": {
                    "ScriptBlockText|contains": [
                        "0002DF01-0000-0000-C000-000000000046",
                        "F6D90F16-9C73-11D3-B32E-00C04F990BB4",
                        "F5078F35-C551-11D3-89B9-0000F81FE221",
                        "88d96a0a-f192-11d4-a65f-0040963251e5",
                        "AFBA6B42-5692-48EA-8141-DC517DCF0EF1",
                        "AFB40FFD-B609-40A3-9828-F88BBE11E4E3",
                        "88d96a0b-f192-11d4-a65f-0040963251e5",
                        "2087c2f4-2cef-4953-a8ab-66779b670495",
                        "000209FF-0000-0000-C000-000000000046",
                        "00024500-0000-0000-C000-000000000046"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of the library"
            ],
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Script Block Logging must be enable"
            },
            "level": "medium",
            "references": [
                "https://learn.microsoft.com/en-us/dotnet/api/system.type.gettypefromclsid?view=net-7.0",
                "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=57"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "02b64f1b-3f33-4e67-aede-ef3b0a5a8fcf"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Potential COM Objects Download Cradles Usage - PS Script"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/06/01",
            "description": "Detects Pandemic Windows Implant",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "\\SYSTEM\\CurrentControlSet\\services\\null\\Instance"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "47e0852a-cf81-4494-a8e6-31864f8c86ed",
            "level": "critical",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://wikileaks.org/vault7/#Pandemic",
                "https://twitter.com/MalwareJake/status/870349480356454401"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Pandemic Registry Key"
        },
        {
            "author": "frack113",
            "date": "2022/05/28",
            "description": "Detects setting a custom URL for OneDriveStandaloneUpdater.exe to download a file from the Internet without executing any\nanomalous executables with suspicious arguments. The downloaded file will be in C:\\Users\\redacted\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdaterreSignInSettingsConfig.json\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\OneDrive\\UpdateOfficeConfig\\UpdateRingSettingURLFromOC"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3aff0be0-7802-4a7e-a4fa-c60c74bc5e1d",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/OneDriveStandaloneUpdater/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ],
            "title": "Lolbas OneDriveStandaloneUpdater.exe Proxy Download"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/06/02",
            "description": "Detects the use of wget to download content in a temporary directory such as \"/tmp\" or \"/var/tmp\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "/wget",
                    "TargetFilename|startswith": [
                        "/tmp/",
                        "/var/tmp/"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate downloads of files in the tmp folder."
            ],
            "id": "35a05c60-9012-49b6-a11f-6bab741c9f74",
            "logsource": {
                "category": "file_event",
                "product": "linux"
            },
            "level": "medium",
            "references": [
                "https://blogs.jpcert.or.jp/en/2023/05/gobrat.html",
                "https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/",
                "https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection",
                "https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection"
            ],
            "title": "Wget Creating Files in Tmp Directory",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/06/02",
            "description": "Detects the use of wget to download content to a suspicious directory",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": {
                    "Image|endswith": "/wget"
                },
                "selection_output": [
                    {
                        "CommandLine|re": "\\s-O\\s"
                    },
                    {
                        "CommandLine|contains": "--output-document"
                    }
                ],
                "selection_path": {
                    "CommandLine|contains": "/tmp/"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "cf610c15-ed71-46e1-bdf8-2bd1a99de6c4",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "medium",
            "references": [
                "https://blogs.jpcert.or.jp/en/2023/05/gobrat.html",
                "https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/",
                "https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection",
                "https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection"
            ],
            "title": "Download File To Potentially Suspicious Directory Via Wget",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Cedric MAURUGEON (Update)",
            "date": "2022/09/15",
            "description": "Detects a suspicious curl process start the adds a file to a web request",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_localhost": {
                    "CommandLine|contains": [
                        "://localhost",
                        "://127.0.0.1"
                    ]
                },
                "selection_cli": [
                    {
                        "CommandLine|contains": [
                            " --form",
                            " --upload-file ",
                            " --data ",
                            " --data-"
                        ]
                    },
                    {
                        "CommandLine|re": "\\s-[FTd]\\s"
                    }
                ],
                "selection_img": {
                    "Image|endswith": "/curl"
                }
            },
            "falsepositives": [
                "Scripts created by developers and admins"
            ],
            "id": "00b90cc1-17ec-402c-96ad-3a8117d7a582",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "medium",
            "modified": "2023/05/02",
            "references": [
                "https://twitter.com/d1r4c/status/1279042657508081664",
                "https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file",
                "https://curl.se/docs/manpage.html",
                "https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html"
            ],
            "related": [
                {
                    "id": "00bca14a-df4e-4649-9054-3f2aa676bc04",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567",
                "attack.t1105"
            ],
            "title": "Suspicious Curl File Upload - Linux"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/15",
            "description": "Detects a curl process start on linux, which indicates a file download from a remote location or a simple web request to a remote server",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "/curl"
                }
            },
            "falsepositives": [
                "Scripts created by developers and admins",
                "Administrative activity"
            ],
            "id": "ea34fb97-e2c4-4afb-810f-785e4459b194",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "low",
            "references": [
                "https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html"
            ],
            "title": "Curl Usage on Linux",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105"
            ]
        },
        {
            "author": "\u00d6mer G\u00fcnal",
            "date": "2020/06/18",
            "description": "Detects the use of tools that copy files from or to remote systems",
            "detection": {
                "condition": "tools and filter",
                "filter": [
                    "@",
                    ":"
                ],
                "tools": [
                    "scp ",
                    "rsync ",
                    "sftp "
                ]
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "7a14080d-a048-4de8-ae58-604ce58a795b",
            "logsource": {
                "product": "linux"
            },
            "level": "low",
            "references": [
                "https://attack.mitre.org/techniques/T1105/"
            ],
            "status": "stable",
            "tags": [
                "attack.command_and_control",
                "attack.lateral_movement",
                "attack.t1105"
            ],
            "title": "Remote File Copy"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "John Page (aka hyp3rlinx), ApparitionSec",
        "Mark Wee",
        "Shailesh Tiwary (Indian Army)",
        "The DFIR Report",
        "Alain Homewood",
        "Joe Wise",
        "Jeremy Hedges",
        "Selena Larson, @selenalarson"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "command-and-control"
        }
    ],
    "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as [ftp](https://attack.mitre.org/software/S0095), that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Specifically, for the finger utility on Windows and Linux systems, monitor command line or terminal execution for the finger command. Monitor network activity for TCP port 79, which is used by the finger utility, and Windows <code>netsh interface portproxy</code> modifications to well-known ports such as 80 and 443. Furthermore, monitor file system for the download/creation and execution of suspicious files, which may indicate adversary-downloaded payloads. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.4",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "File: File Creation",
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Traffic Flow",
        "Command: Command Execution",
        "Network Traffic: Network Connection Creation"
    ],
    "x_mitre_permissions_required": []
}