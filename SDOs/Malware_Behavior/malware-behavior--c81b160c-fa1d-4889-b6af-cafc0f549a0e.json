{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c81b160c-fa1d-4889-b6af-cafc0f549a0e",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.577453Z",
    "name": "OS Credential Dumping",
    "description": "Adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password. Credentials can be obtained from OS caches, memory, or structures.[1] Credentials can then be used to perform Lateral Movement and access restricted information.Several of the tools mentioned in associated sub-techniques may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1003",
            "external_id": "T1003"
        },
        {
            "source_name": "CAPEC 150",
            "external_id": "malware-behavior--4957199e-511b-4bf9-8caf-797dc1ba8a7b"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1003",
            "external_id": "T1003"
        },
        {
            "source_name": "Medium Detecting Attempts to Steal Passwords from Memory",
            "description": "French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.",
            "url": "https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea"
        },
        {
            "source_name": "AdSecurity DCSync Sept 2015",
            "description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017.",
            "url": "https://adsecurity.org/?p=1729"
        },
        {
            "source_name": "Microsoft DRSR Dec 2017",
            "description": "Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017.",
            "url": "https://msdn.microsoft.com/library/cc228086.aspx"
        },
        {
            "source_name": "Microsoft NRPC Dec 2017",
            "description": "Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017.",
            "url": "https://msdn.microsoft.com/library/cc237008.aspx"
        },
        {
            "source_name": "Microsoft GetNCCChanges",
            "description": "Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017.",
            "url": "https://msdn.microsoft.com/library/dd207691.aspx"
        },
        {
            "source_name": "Microsoft SAMR",
            "description": "Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017.",
            "url": "https://msdn.microsoft.com/library/cc245496.aspx"
        },
        {
            "source_name": "Powersploit",
            "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
            "url": "https://github.com/mattifestation/PowerSploit"
        },
        {
            "source_name": "Samba DRSUAPI",
            "description": "SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017.",
            "url": "https://wiki.samba.org/index.php/DRSUAPI"
        },
        {
            "source_name": "Harmj0y DCSync Sept 2015",
            "description": "Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017.",
            "url": "http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/"
        },
        {
            "source_name": "Brining MimiKatz to Unix",
            "description": "Tim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.",
            "url": "https://labs.portcullis.co.uk/download/eu-18-Wadhwa-Brown-Where-2-worlds-collide-Bringing-Mimikatz-et-al-to-UNIX.pdf"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/09/09",
            "description": "Detects a highly relevant Antivirus alert that reports a password dumper.",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Signature|startswith": "PWS"
                    },
                    {
                        "Signature|contains": [
                            "DumpCreds",
                            "DumpLsass",
                            "HTool/WCE",
                            "Kekeo",
                            "LsassDump",
                            "Mimikatz",
                            "Outflank",
                            "PShlSpy",
                            "PSWTool",
                            "PWCrack",
                            "PWDump",
                            "PWS.",
                            "PWSX",
                            "Rubeus",
                            "SecurityTool",
                            "SharpDump"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "78cc2dd2-7d20-4d32-93ff-057084c38b93",
            "level": "critical",
            "logsource": {
                "category": "antivirus"
            },
            "modified": "2024/07/17",
            "references": [
                "https://www.nextron-systems.com/?s=antivirus",
                "https://www.virustotal.com/gui/file/5fcda49ee7f202559a6cbbb34edb65c33c9a1e0bde9fa2af06a6f11b55ded619",
                "https://www.virustotal.com/gui/file/a4edfbd42595d5bddb442c82a02cf0aaa10893c1bf79ea08b9ce576f82749448"
            ],
            "status": "stable",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1558",
                "attack.t1003.001",
                "attack.t1003.002"
            ],
            "title": "Antivirus Password Dumper Detection"
        },
        {
            "author": "sawwinnnaung",
            "date": "2020/05/07",
            "description": "Identifies IPs from which users grant access to other users on azure resources and alerts when a previously unseen source IP address is used.",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "Microsoft.DocumentDB/databaseAccounts/listKeys/action",
                    "Microsoft.Maps/accounts/listKeys/action",
                    "Microsoft.Media/mediaservices/listKeys/action",
                    "Microsoft.CognitiveServices/accounts/listKeys/action",
                    "Microsoft.Storage/storageAccounts/listKeys/action",
                    "Microsoft.Compute/snapshots/write",
                    "Microsoft.Network/networkSecurityGroups/write"
                ]
            },
            "falsepositives": [
                "Valid change"
            ],
            "id": "c1182e02-49a3-481c-b3de-0fadc4091488",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2023/10/11",
            "references": [
                "https://github.com/Azure/Azure-Sentinel/blob/e534407884b1ec5371efc9f76ead282176c9e8bb/Detections/AzureActivity/RareOperations.yaml"
            ],
            "status": "test",
            "tags": [
                "attack.t1003"
            ],
            "title": "Rare Subscription-level Operations In Azure"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where a MySQL service on an OpenCanary node has had a login attempt.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 8001
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "e7d79a1b-25ed-4956-bd56-bd344fa8fd06",
            "level": "high",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.collection",
                "attack.t1003",
                "attack.t1213"
            ],
            "title": "OpenCanary - MySQL Login Attempt"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where an MSSQL service on an OpenCanary node has had a login attempt using SQLAuth.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 9001
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "3ec9a16d-0b4f-4967-9542-ebf38ceac7dd",
            "level": "high",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.collection",
                "attack.t1003",
                "attack.t1213"
            ],
            "title": "OpenCanary - MSSQL Login Attempt Via SQLAuth"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where an MSSQL service on an OpenCanary node has had a login attempt using Windows Authentication.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 9002
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "6e78f90f-0043-4a01-ac41-f97681613a66",
            "level": "high",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.collection",
                "attack.t1003",
                "attack.t1213"
            ],
            "title": "OpenCanary - MSSQL Login Attempt Via Windows Authentication"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where a REDIS service on an OpenCanary node has had an action command attempted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 17001
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "547dfc53-ebf6-4afe-8d2e-793d9574975d",
            "level": "high",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.collection",
                "attack.t1003",
                "attack.t1213"
            ],
            "title": "OpenCanary - REDIS Action Command Attempt"
        },
        {
            "author": "@neu5ron, Teymur Kheirkhabarov, oscd.community",
            "date": "2020/04/02",
            "description": "Transferring files with well-known filenames (sensitive files with credential data) using network shares",
            "detection": {
                "condition": "selection",
                "selection": {
                    "name": [
                        "\\mimidrv",
                        "\\lsass",
                        "\\windows\\minidump\\",
                        "\\hiberfil",
                        "\\sqldmpr",
                        "\\sam",
                        "\\ntds.dit",
                        "\\security"
                    ]
                }
            },
            "falsepositives": [
                "Transferring sensitive files for legitimate administration work by legitimate administrator"
            ],
            "id": "2e69f167-47b5-4ae7-a390-47764529eff5",
            "level": "medium",
            "logsource": {
                "product": "zeek",
                "service": "smb_files"
            },
            "modified": "2021/11/27",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "related": [
                {
                    "id": "910ab938-668b-401b-b08c-b596e80fdca5",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.001",
                "attack.t1003.003"
            ],
            "title": "Transferring Files with Credential Data via Network Shares - Zeek"
        },
        {
            "author": "Samir Bousseaden, @neu5ron",
            "date": "2020/03/19",
            "description": "Detect AD credential dumping using impacket secretdump HKTL. Based on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml",
            "detection": {
                "condition": "selection",
                "selection": {
                    "name|contains": "SYSTEM32\\",
                    "name|endswith": ".tmp",
                    "path|contains|all": [
                        "\\",
                        "ADMIN$"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "92dae1ed-1c9d-4eff-a567-33acbd95b00e",
            "level": "high",
            "logsource": {
                "product": "zeek",
                "service": "smb_files"
            },
            "modified": "2021/11/27",
            "references": [
                "https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.003"
            ],
            "title": "Possible Impacket SecretDump Remote Activity - Zeek"
        },
        {
            "author": "Samir Bousseaden (original elastic rule), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/29",
            "description": "Detects suspicious access to LSASS handle via a call trace to \"seclogon.dll\" with a suspicious access right.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallTrace|contains": "seclogon.dll",
                    "GrantedAccess": "0x14c0",
                    "SourceImage|endswith": "\\svchost.exe",
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "472159c5-31b9-4f56-b794-b766faa8b0a7",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "references": [
                "https://twitter.com/SBousseaden/status/1541920424635912196",
                "https://github.com/elastic/detection-rules/blob/2bc1795f3d7bcc3946452eb4f07ae799a756d94e/rules/windows/credential_access_lsass_handle_via_malseclogon.toml",
                "https://splintercod3.blogspot.com/p/the-hidden-side-of-seclogon-part-3.html"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Suspicious LSASS Access Via MalSecLogon"
        },
        {
            "author": "Florian Roth, Roberto Rodriguez, Dimitrios Slamaris, Mark Russinovich, Thomas Patzke, Teymur Kheirkhabarov, Sherif Eldeeb, James Dickenson, Aleksey Potapov, oscd.community",
            "date": "2021/11/22",
            "description": "Detects process access requests to LSASS process with potentially suspicious access flags",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_explorer": {
                    "GrantedAccess": "0x401",
                    "SourceImage|endswith": "\\explorer.exe"
                },
                "filter_main_generic": {
                    "SourceImage|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "filter_main_windefend_1": {
                    "SourceImage|contains": ":\\ProgramData\\Microsoft\\Windows Defender\\",
                    "SourceImage|endswith": "\\MsMpEng.exe"
                },
                "filter_main_windefend_2": {
                    "CallTrace|contains|all": [
                        "|?:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\{",
                        "}\\mpengine.dll+"
                    ],
                    "GrantedAccess": "0x1418"
                },
                "filter_main_windefend_3": {
                    "CallTrace|contains": [
                        "|c:\\program files\\windows defender\\mprtp.dll",
                        "|c:\\program files\\windows defender\\MpClient.dll"
                    ]
                },
                "filter_optional_malwarebytes": {
                    "SourceImage|endswith": ":\\ProgramData\\MALWAREBYTES\\MBAMSERVICE\\ctlrupdate\\mbupdatr.exe"
                },
                "filter_optional_mbami": {
                    "GrantedAccess": "0x40",
                    "SourceImage|endswith": "\\MBAMInstallerService.exe"
                },
                "filter_optional_nextron": {
                    "GrantedAccess": "0x40",
                    "SourceImage|endswith": [
                        "\\aurora-agent-64.exe",
                        "\\aurora-agent.exe",
                        "\\thor.exe",
                        "\\thor64.exe"
                    ]
                },
                "filter_optional_steam_apps": {
                    "SourceImage|contains": "\\SteamLibrary\\steamapps\\"
                },
                "filter_optional_sysinternals_handle": {
                    "GrantedAccess": "0x40",
                    "SourceImage|endswith": [
                        "\\handle.exe",
                        "\\handle64.exe"
                    ]
                },
                "filter_optional_sysinternals_process_explorer": {
                    "GrantedAccess": "0x40",
                    "SourceImage|endswith": [
                        "\\PROCEXP64.EXE",
                        "\\PROCEXP.EXE"
                    ]
                },
                "filter_optional_vmwaretools": {
                    "SourceImage|contains": ":\\ProgramData\\VMware\\VMware Tools\\",
                    "SourceImage|endswith": "\\vmtoolsd.exe"
                },
                "filter_optional_vscode": {
                    "SourceImage|endswith": "\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe"
                },
                "filter_optional_webex": {
                    "GrantedAccess": "0x401",
                    "SourceImage|endswith": "\\AppData\\Local\\WebEx\\WebexHost.exe"
                },
                "selection_access": [
                    {
                        "GrantedAccess|endswith": [
                            "30",
                            "50",
                            "70",
                            "90",
                            "B0",
                            "D0",
                            "F0",
                            "18",
                            "38",
                            "58",
                            "78",
                            "98",
                            "B8",
                            "D8",
                            "F8",
                            "1A",
                            "3A",
                            "5A",
                            "7A",
                            "9A",
                            "BA",
                            "DA",
                            "FA",
                            "0x14C2"
                        ]
                    },
                    {
                        "GrantedAccess|startswith": [
                            "0x100000",
                            "0x1418",
                            "0x1438",
                            "0x143a",
                            "0x1f0fff",
                            "0x1f1fff",
                            "0x1f2fff",
                            "0x1f3fff",
                            "0x40"
                        ]
                    }
                ],
                "selection_target": {
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Legitimate software such as AV and EDR"
            ],
            "id": "a18dd26b-6450-46de-8c91-9659150cf088",
            "level": "medium",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "status": "experimental",
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights",
                "https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow",
                "https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html",
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf"
            ],
            "related": [
                {
                    "id": "32d0d3e2-e58d-4d41-926b-18b520b2b32d",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0002"
            ],
            "title": "Potentially Suspicious GrantedAccess Flags On LSASS"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2012/06/27",
            "description": "Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz, Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll or dbgcore.dll for win10, server2016 and up.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "GrantedAccess": "0x1FFFFF",
                    "SourceImage|endswith": "\\WerFault.exe",
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Actual failures in lsass.exe that trigger a crash dump (unlikely)",
                "Unknown cases in which WerFault accesses lsass.exe"
            ],
            "id": "e5b33f7d-eb93-48b6-9851-09e1e610b6d7",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "references": [
                "https://github.com/helpsystems/nanodump/commit/578116faea3d278d53d70ea932e2bbfe42569507"
            ],
            "status": "test",
            "title": "Credential Dumping Attempt Via WerFault",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0002"
            ]
        },
        {
            "author": "Bhabesh Raj (rule), @thefLinkk",
            "date": "2022/06/27",
            "description": "Detects HandleKatz opening LSASS to duplicate its handle to later dump the memory without opening any new handles",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallTrace|contains": "|UNKNOWN(",
                    "CallTrace|endswith": ")",
                    "CallTrace|startswith": "C:\\Windows\\System32\\ntdll.dll+",
                    "TargetImage|endswith": "\\lsass.exe",
                    "GrantedAccess": "0x1440"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b1bd3a59-c1fd-4860-9f40-4dd161a7d1f5",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/28",
            "references": [
                "https://github.com/codewhitesec/HandleKatz"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1106",
                "attack.defense_evasion",
                "attack.t1003.001"
            ],
            "title": "HackTool - HandleKatz Duplicating LSASS Handle"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/10",
            "description": "Detects a possible process memory dump that uses a white-listed filename like TrolleyExpress.exe as a way to dump the LSASS process memory without Microsoft Defender interference\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "GrantedAccess|endswith": [
                        "10",
                        "30",
                        "50",
                        "70",
                        "90",
                        "B0",
                        "D0",
                        "F0",
                        "18",
                        "38",
                        "58",
                        "78",
                        "98",
                        "B8",
                        "D8",
                        "F8",
                        "1A",
                        "3A",
                        "5A",
                        "7A",
                        "9A",
                        "BA",
                        "DA",
                        "FA",
                        "0x14C2",
                        "FF"
                    ],
                    "SourceImage|endswith": [
                        "\\TrolleyExpress.exe",
                        "\\ProcessDump.exe",
                        "\\dump64.exe"
                    ],
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4be8b654-0c01-4c9d-a10c-6b28467fc651",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "references": [
                "https://twitter.com/_xpn_/status/1491557187168178176",
                "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz",
                "https://twitter.com/mrd0x/status/1460597833917251595"
            ],
            "status": "test",
            "title": "LSASS Access From Potentially White-Listed Processes",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0002"
            ]
        },
        {
            "author": "Patryk Prauze - ING Tech",
            "date": "2019/05/20",
            "description": "Detects remote access to the LSASS process via WinRM. This could be a sign of credential dumping from tools like mimikatz.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_access": {
                    "GrantedAccess": "0x80000000"
                },
                "selection": {
                    "SourceImage|endswith": ":\\Windows\\system32\\wsmprovhost.exe",
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "aa35a627-33fb-4d04-a165-d33b4afca3e8",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "references": [
                "https://pentestlab.blog/2018/05/15/lateral-movement-winrm/"
            ],
            "status": "stable",
            "tags": [
                "attack.credential_access",
                "attack.execution",
                "attack.t1003.001",
                "attack.t1059.001",
                "attack.lateral_movement",
                "attack.t1021.006",
                "attack.s0002"
            ],
            "title": "Remote LSASS Process Access Through Windows Remote Management"
        },
        {
            "author": "Bhabesh Raj, Jonhnathan Ribeiro",
            "date": "2023/11/27",
            "description": "Detects LSASS process access for potential credential dumping by a Python-like tool such as LaZagne or Pypykatz.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallTrace|contains": [
                        "python27.dll+",
                        "python3*.dll+"
                    ],
                    "GrantedAccess": "0x1FFFFF",
                    "CallTrace|contains|all": [
                        "_ctypes.pyd+",
                        ":\\Windows\\System32\\KERNELBASE.dll+",
                        ":\\Windows\\SYSTEM32\\ntdll.dll+"
                    ],
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f8be3e82-46a3-4e4e-ada5-8e538ae8b9c9",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "references": [
                "https://twitter.com/bh4b3sh/status/1303674603819081728",
                "https://github.com/skelsec/pypykatz"
            ],
            "related": [
                {
                    "id": "4b9a8556-99c4-470b-a40c-9c8d02c77ed0",
                    "type": "obsoletes"
                },
                {
                    "id": "7186e989-4ed7-4f4e-a656-4674b9e3e48b",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0349"
            ],
            "title": "Credential Dumping Activity By Python Based Tool"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/10",
            "description": "Detects LSASS process access requests from a source process with the \"dump\" keyword in its image name.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "GrantedAccess|endswith": [
                        "10",
                        "30",
                        "50",
                        "70",
                        "90",
                        "B0",
                        "D0",
                        "F0",
                        "18",
                        "38",
                        "58",
                        "78",
                        "98",
                        "B8",
                        "D8",
                        "F8",
                        "1A",
                        "3A",
                        "5A",
                        "7A",
                        "9A",
                        "BA",
                        "DA",
                        "FA",
                        "0x14C2",
                        "FF"
                    ],
                    "SourceImage|contains": "dump",
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Rare programs that contain the word dump in their name and access lsass"
            ],
            "id": "9bd012ee-0dff-44d7-84a0-aa698cfd87a3",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "references": [
                "https://twitter.com/_xpn_/status/1491557187168178176",
                "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz"
            ],
            "status": "test",
            "title": "LSASS Memory Access by Tool With Dump Keyword In Name",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0002"
            ]
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/10/20",
            "description": "Detects adversaries leveraging the MiniDump export function from comsvcs.dll via rundll32 to perform a memory dump from lsass.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CallTrace|contains": "comsvcs.dll",
                    "SourceImage|endswith": "\\rundll32.exe",
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a49fa4d5-11db-418c-8473-1e014a8dd462",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2023/11/29",
            "references": [
                "https://twitter.com/shantanukhande/status/1229348874298388484",
                "https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Lsass Memory Dump via Comsvcs DLL"
        },
        {
            "author": "Samir Bousseaden, Michael Haag",
            "date": "2019/04/03",
            "description": "Detects process access requests to the LSASS process with specific call trace calls and access masks.\nThis behaviour is expressed by many credential dumping tools such as Mimikatz, NanoDump, Invoke-Mimikatz, Procdump and even the Taskmgr dumping feature.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_system_user": {
                    "SourceUser|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "filter_optional_sysmon": {
                    "SourceImage|endswith": ":\\Windows\\Sysmon64.exe"
                },
                "filter_optional_thor": {
                    "CallTrace|contains|all": [
                        ":\\Windows\\Temp\\asgard2-agent\\",
                        "\\thor\\thor64.exe+",
                        "|UNKNOWN("
                    ],
                    "GrantedAccess": "0x103800"
                },
                "selection": {
                    "CallTrace|contains": [
                        "dbgcore.dll",
                        "dbghelp.dll",
                        "kernel32.dll",
                        "kernelbase.dll",
                        "ntdll.dll"
                    ],
                    "GrantedAccess|contains": [
                        "0x1038",
                        "0x1438",
                        "0x143a",
                        "0x1fffff"
                    ],
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5ef9853e-4d0e-4a70-846f-a9ca37d876da",
            "level": "medium",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "modified": "2024/03/02",
            "status": "experimental",
            "references": [
                "https://blog.menasec.net/2019/02/threat-hunting-21-procdump-or-taskmgr.html",
                "https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.001/T1003.001.md",
                "https://research.splunk.com/endpoint/windows_possible_credential_dumping/"
            ],
            "title": "Potential Credential Dumping Activity Via LSASS",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0002"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel",
            "date": "2023/11/27",
            "description": "Detects process access requests from hacktool processes based on their default image name",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "SourceImage|endswith": [
                            "\\Akagi.exe",
                            "\\Akagi64.exe",
                            "\\atexec_windows.exe",
                            "\\Certify.exe",
                            "\\Certipy.exe",
                            "\\CoercedPotato.exe",
                            "\\crackmapexec.exe",
                            "\\CreateMiniDump.exe",
                            "\\dcomexec_windows.exe",
                            "\\dpapi_windows.exe",
                            "\\findDelegation_windows.exe",
                            "\\GetADUsers_windows.exe",
                            "\\GetNPUsers_windows.exe",
                            "\\getPac_windows.exe",
                            "\\getST_windows.exe",
                            "\\getTGT_windows.exe",
                            "\\GetUserSPNs_windows.exe",
                            "\\gmer.exe",
                            "\\hashcat.exe",
                            "\\htran.exe",
                            "\\ifmap_windows.exe",
                            "\\impersonate.exe",
                            "\\Inveigh.exe",
                            "\\LocalPotato.exe",
                            "\\mimikatz_windows.exe",
                            "\\mimikatz.exe",
                            "\\netview_windows.exe",
                            "\\nmapAnswerMachine_windows.exe",
                            "\\opdump_windows.exe",
                            "\\PasswordDump.exe",
                            "\\Potato.exe",
                            "\\PowerTool.exe",
                            "\\PowerTool64.exe",
                            "\\psexec_windows.exe",
                            "\\PurpleSharp.exe",
                            "\\pypykatz.exe",
                            "\\QuarksPwDump.exe",
                            "\\rdp_check_windows.exe",
                            "\\Rubeus.exe",
                            "\\SafetyKatz.exe",
                            "\\sambaPipe_windows.exe",
                            "\\SelectMyParent.exe",
                            "\\SharpChisel.exe",
                            "\\SharPersist.exe",
                            "\\SharpEvtMute.exe",
                            "\\SharpImpersonation.exe",
                            "\\SharpLDAPmonitor.exe",
                            "\\SharpLdapWhoami.exe",
                            "\\SharpUp.exe",
                            "\\SharpView.exe",
                            "\\smbclient_windows.exe",
                            "\\smbserver_windows.exe",
                            "\\sniff_windows.exe",
                            "\\sniffer_windows.exe",
                            "\\split_windows.exe",
                            "\\SpoolSample.exe",
                            "\\Stracciatella.exe",
                            "\\SysmonEOP.exe",
                            "\\temp\\rot.exe",
                            "\\ticketer_windows.exe",
                            "\\TruffleSnout.exe",
                            "\\winPEASany_ofs.exe",
                            "\\winPEASany.exe",
                            "\\winPEASx64_ofs.exe",
                            "\\winPEASx64.exe",
                            "\\winPEASx86_ofs.exe",
                            "\\winPEASx86.exe",
                            "\\xordump.exe"
                        ]
                    },
                    {
                        "SourceImage|contains": [
                            "\\goldenPac",
                            "\\just_dce_",
                            "\\karmaSMB",
                            "\\kintercept",
                            "\\LocalPotato",
                            "\\ntlmrelayx",
                            "\\rpcdump",
                            "\\samrdump",
                            "\\secretsdump",
                            "\\smbexec",
                            "\\smbrelayx",
                            "\\wmiexec",
                            "\\wmipersist",
                            "HotPotato",
                            "Juicy Potato",
                            "JuicyPotato",
                            "PetitPotam",
                            "RottenPotato"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "d0d2f720-d14f-448d-8242-51ff396a334e",
            "level": "high",
            "logsource": {
                "category": "process_access",
                "product": "windows"
            },
            "references": [
                "https://jsecurity101.medium.com/bypassing-access-mask-auditing-strategies-480fb641c158",
                "https://www.splunk.com/en_us/blog/security/you-bet-your-lsass-hunting-lsass-access.html"
            ],
            "status": "experimental",
            "title": "HackTool - Generic Process Access",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0002"
            ]
        },
        {
            "author": "oscd.community, Natalia Shornikova",
            "date": "2020/10/06",
            "description": "Detects remote thread creation by PowerShell processes into \"lsass.exe\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "SourceImage|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ],
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "fb656378-f909-47c1-8747-278bf09f4f4f",
            "level": "high",
            "logsource": {
                "category": "create_remote_thread",
                "product": "windows"
            },
            "modified": "2022/12/18",
            "references": [
                "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
            ],
            "related": [
                {
                    "id": "3f07b9d1-2082-4c56-9277-613a621983cc",
                    "type": "obsoletes"
                },
                {
                    "id": "0f920ebe-7aea-4c54-b202-9aa0c609cfe5",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Potential Credential Dumping Attempt Via PowerShell Remote Thread"
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/02/19",
            "description": "Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage.\nThe process in field Process is the malicious program. A single execution can lead to hundreds of events.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "StartModule": "",
                    "TargetImage|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Antivirus products"
            ],
            "id": "f239b326-2f41-4d6b-9dfa-c846a60ef505",
            "level": "high",
            "logsource": {
                "category": "create_remote_thread",
                "product": "windows"
            },
            "modified": "2021/06/21",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm"
            ],
            "status": "stable",
            "tags": [
                "attack.credential_access",
                "attack.s0005",
                "attack.t1003.001"
            ],
            "title": "Password Dumper Remote Thread in LSASS"
        },
        {
            "author": "Ensar \u015eamil, @sblmsrsn, @oscd_initiative",
            "date": "2020/10/06",
            "description": "Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ImageLoaded|endswith": [
                        "\\ttdrecord.dll",
                        "\\ttdwriter.dll",
                        "\\ttdloader.dll"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate usage by software developers/testers"
            ],
            "id": "e76c8240-d68f-4773-8880-5c6f63595aaf",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2022/12/02",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Tttracer/",
                "https://twitter.com/mattifestation/status/1196390321783025666",
                "https://twitter.com/oulusoyum/status/1191329746069655553"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.t1218",
                "attack.t1003.001"
            ],
            "title": "Time Travel Debugging Utility Usage - Image"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/14",
            "description": "Detects rundll32 loading a renamed comsvcs.dll to dump process memory",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "ImageLoaded|endswith": "\\comsvcs.dll"
                },
                "selection": {
                    "Hashes|contains": [
                        "IMPHASH=eed93054cb555f3de70eaa9787f32ebb",
                        "IMPHASH=5e0dbdec1fce52daae251a110b4f309d",
                        "IMPHASH=eadbccbb324829acb5f2bbe87e5549a8",
                        "IMPHASH=407ca0f7b523319d758a40d7c0193699",
                        "IMPHASH=281d618f4e6271e527e6386ea6f748de"
                    ],
                    "Image|endswith": "\\rundll32.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "8cde342c-ba48-4b74-b615-172c330f2e93",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2023/02/17",
            "references": [
                "https://twitter.com/sbousseaden/status/1555200155351228419"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.t1003.001"
            ],
            "title": "Suspicious Renamed Comsvcs DLL Loaded By Rundll32"
        },
        {
            "author": "Perez Diego (@darkquassar), oscd.community, Ecco",
            "date": "2019/10/27",
            "description": "Detects the load of dbghelp/dbgcore DLL (used to make memory dumps) by suspicious processes.\nTools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll.\nAs an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and transfer it over the network back to the attacker's machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ImageLoaded|endswith": [
                        "\\dbghelp.dll",
                        "\\dbgcore.dll"
                    ],
                    "Signed": "false"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bdc64095-d59a-42a2-8588-71fd9c9d9abc",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2022/12/09",
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpapiset-minidumpwritedump",
                "https://www.pinvoke.net/default.aspx/dbghelp/MiniDumpWriteDump.html",
                "https://medium.com/@fsx30/bypass-edrs-memory-protection-introduction-to-hooking-2efb21acffd6"
            ],
            "related": [
                {
                    "id": "0e277796-5f23-4e49-a490-483131d4f6e1",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded"
        },
        {
            "author": "Teymur Kheirkhabarov, oscd.community",
            "date": "2019/10/22",
            "description": "Loading unsigned image (DLL, EXE) into LSASS process",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\lsass.exe",
                    "Signed": "false"
                }
            },
            "falsepositives": [
                "Valid user connecting using RDP"
            ],
            "id": "857c8db3-c89b-42fb-882b-f681c7cf4da2",
            "level": "medium",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Unsigned Image Loaded Into LSASS Process"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/11",
            "description": "Detects suspicious processes based on name and location that access the windows credential manager and vault.\nWhich can be a sign of credential stealing. Example case would be usage of mimikatz \"dpapi::cred\" function\n",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_system_folders": {
                    "Image|contains": [
                        ":\\Program Files\\",
                        ":\\Program Files (x86)\\",
                        ":\\Windows\\system32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "selection": {
                    "FileName|contains": [
                        "\\AppData\\Local\\Microsoft\\Credentials\\",
                        "\\AppData\\Roaming\\Microsoft\\Credentials\\",
                        "\\AppData\\Local\\Microsoft\\Vault\\",
                        "\\ProgramData\\Microsoft\\Vault\\"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate software installed by the users for example in the \"AppData\" directory may access these files (for any reason)."
            ],
            "id": "407aecb1-e762-4acf-8c7b-d087bcff3bb6",
            "level": "medium",
            "logsource": {
                "category": "file_access",
                "product": "windows",
                "definition": "Requirements: Microsoft-Windows-Kernel-File ETW provider"
            },
            "modified": "2023/12/18",
            "status": "experimental",
            "references": [
                "https://hunter2.gitbook.io/darthsidious/privilege-escalation/mimikatz",
                "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
            ],
            "tags": [
                "attack.t1003",
                "attack.credential_access"
            ],
            "title": "Credential Manager Access By Uncommon Application"
        },
        {
            "author": "frack113",
            "date": "2022/04/09",
            "description": "Detects file access requests to browser credential stores by uncommon processes.\nCould indicate potential attempt of credential stealing.\nRequires heavy baselining before usage\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\system32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "filter_main_system": {
                    "Image": "System"
                },
                "filter_optional_defender": {
                    "Image|contains": ":\\ProgramData\\Microsoft\\Windows Defender\\",
                    "Image|endswith": [
                        "\\MpCopyAccelerator.exe",
                        "\\MsMpEng.exe"
                    ]
                },
                "filter_optional_thor": {
                    "Image|endswith": [
                        "\\thor64.exe",
                        "\\thor.exe"
                    ]
                },
                "selection_chromium": {
                    "FileName|contains": [
                        "\\Appdata\\Local\\Chrome\\User Data\\Default\\Login Data",
                        "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Network\\Cookies",
                        "\\AppData\\Local\\Google\\Chrome\\User Data\\Local State"
                    ]
                },
                "selection_firefox": {
                    "FileName|endswith": [
                        "\\cookies.sqlite",
                        "release\\key3.db",
                        "release\\key4.db",
                        "release\\logins.json"
                    ]
                },
                "selection_ie": {
                    "FileName|endswith": "\\Appdata\\Local\\Microsoft\\Windows\\WebCache\\WebCacheV01.dat"
                }
            },
            "falsepositives": [
                "Antivirus, Anti-Spyware, Anti-Malware Software",
                "Backup software",
                "Legitimate software installed on partitions other than \"C:\\\"",
                "Searching software such as \"everything.exe\""
            ],
            "id": "91cb43db-302a-47e3-b3c8-7ede481e27bf",
            "level": "medium",
            "logsource": {
                "category": "file_access",
                "product": "windows",
                "definition": "Requirements: Microsoft-Windows-Kernel-File ETW provider"
            },
            "modified": "2023/12/18",
            "status": "experimental",
            "references": [
                "https://www.zscaler.com/blogs/security-research/ffdroider-stealer-targeting-social-media-platform-users",
                "https://github.com/lclevy/firepwd"
            ],
            "tags": [
                "attack.t1003",
                "attack.credential_access"
            ],
            "title": "Access To Browser Credential Files By Uncommon Application"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/11/15",
            "description": "Detects creation of files with names used by different memory dumping tools to create a memory dump of the LSASS process memory, which contains user credentials.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "TargetFilename|endswith": [
                        "\\lsass.dmp",
                        "\\lsass.zip",
                        "\\lsass.rar",
                        "\\Andrew.dmp",
                        "\\Coredump.dmp",
                        "\\NotLSASS.zip",
                        "\\PPLBlade.dmp"
                    ]
                },
                "selection_2": {
                    "TargetFilename|contains": [
                        "\\lsass_2",
                        "\\lsassdump",
                        "\\lsassdmp"
                    ]
                },
                "selection_3": {
                    "TargetFilename|contains|all": [
                        "\\lsass",
                        ".dmp"
                    ]
                },
                "selection_4": {
                    "TargetFilename|contains": "SQLDmpr",
                    "TargetFilename|endswith": ".mdmp"
                },
                "selection_5": {
                    "TargetFilename|endswith": ".dmp",
                    "TargetFilename|startswith": "nanodump"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a5a2d357-1ab8-4675-a967-ef9990a59391",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/09/05",
            "references": [
                "https://www.google.com/search?q=procdump+lsass",
                "https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf",
                "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml",
                "https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/",
                "https://github.com/helpsystems/nanodump",
                "https://github.com/CCob/MirrorDump"
            ],
            "related": [
                {
                    "id": "db2110f3-479d-42a6-94fb-d35bc1e46492",
                    "type": "obsoletes"
                },
                {
                    "id": "5e3d3601-0662-4af0-b1d2-36a05e90c40a",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "LSASS Process Memory Dump Files"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/03/11",
            "description": "Detects file creation events with filename patterns used by CrackMapExec.",
            "detection": {
                "condition": "selection_path and 1 of selection_names_*",
                "selection_names_re": [
                    {
                        "TargetFilename|re": "\\\\[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\.txt$"
                    },
                    {
                        "TargetFilename|re": "\\\\[a-zA-Z]{8}\\.tmp$"
                    }
                ],
                "selection_names_str": {
                    "TargetFilename|endswith": [
                        "\\temp.ps1",
                        "\\msol.ps1"
                    ]
                },
                "selection_path": {
                    "TargetFilename|startswith": "C:\\Windows\\Temp\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "736ffa74-5f6f-44ca-94ef-1c0df4f51d2a",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "status": "experimental",
            "references": [
                "https://github.com/byt3bl33d3r/CrackMapExec/"
            ],
            "related": [
                {
                    "id": "9433ff9c-5d3f-4269-99f8-95fc826ea489",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - CrackMapExec File Indicators"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/11",
            "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database) by an uncommon parent process or directory",
            "detection": {
                "condition": "selection_file and 1 of selection_process_*",
                "selection_file": {
                    "TargetFilename|endswith": "\\ntds.dit"
                },
                "selection_process_parent": {
                    "ParentImage|endswith": [
                        "\\cscript.exe",
                        "\\httpd.exe",
                        "\\nginx.exe",
                        "\\php-cgi.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\w3wp.exe",
                        "\\wscript.exe"
                    ]
                },
                "selection_process_parent_path": {
                    "ParentImage|contains": [
                        "\\apache",
                        "\\tomcat",
                        "\\AppData\\",
                        "\\Temp\\",
                        "\\Public\\",
                        "\\PerfLogs\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4e7050dd-e548-483f-b7d6-527ab4fa784d",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows",
                "definition": "Requirements: The \"ParentImage\" field is not available by default on EID 11 of Sysmon logs. To be able to use this rule to the full extent you need to enrich the log with additional ParentImage data"
            },
            "modified": "2023/01/05",
            "references": [
                "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
                "https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/",
                "https://pentestlab.blog/tag/ntds-dit/",
                "https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1"
            ],
            "related": [
                {
                    "id": "11b1ed55-154d-4e82-8ad7-83739298f720",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ],
            "title": "NTDS.DIT Creation By Uncommon Parent Process"
        },
        {
            "author": "@pbssubhash",
            "date": "2022/12/08",
            "description": "Detects the presence of an LSASS dump file in the \"CrashDumps\" folder. This could be a sign of LSASS credential dumping. Techniques such as the LSASS Shtinkering have been seen abusing the Windows Error Reporting to dump said process.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "lsass.exe.",
                    "TargetFilename|endswith": ".dmp",
                    "TargetFilename|startswith": "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\CrashDumps\\"
                }
            },
            "falsepositives": [
                "Rare legitimate dump of the process by the operating system due to a crash of lsass"
            ],
            "id": "6902955a-01b7-432c-b32a-6f5f81d8f625",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/deepinstinct/Lsass-Shtinkering",
                "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "LSASS Process Dump Artefact In CrashDumps Folder"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/27",
            "description": "Detects WerFault creating a dump file with a name that indicates that the dump file could be an LSASS process memory, which contains user credentials",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image": "C:\\WINDOWS\\system32\\WerFault.exe",
                    "TargetFilename|contains": [
                        "\\lsass",
                        "lsass.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c3e76af5-4ce0-4a14-9c9a-25ceb8fda182",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/helpsystems/nanodump"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "WerFault LSASS Process Memory Dump"
        },
        {
            "id": "11b1ed55-154d-4e82-8ad7-83739298f720",
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/11",
            "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database) by an uncommon process or a process located in a suspicious directory",
            "detection": {
                "condition": "selection_ntds and 1 of selection_process_*",
                "selection_ntds": {
                    "TargetFilename|endswith": "\\ntds.dit"
                },
                "selection_process_img": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\wscript.exe",
                        "\\wsl.exe",
                        "\\wt.exe"
                    ]
                },
                "selection_process_paths": {
                    "Image|contains": [
                        "\\AppData\\",
                        "\\Temp\\",
                        "\\Public\\",
                        "\\PerfLogs\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/07/14",
            "references": [
                "https://stealthbits.com/blog/extracting-password-hashes-from-the-ntds-dit-file/",
                "https://adsecurity.org/?p=2398"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "4e7050dd-e548-483f-b7d6-527ab4fa784d"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.003"
            ],
            "title": "NTDS.DIT Creation By Uncommon Process"
        },
        {
            "author": "SecurityAura",
            "date": "2022/11/16",
            "description": "Detects default filenames output from the execution of CrackMapExec and Impacket-secretsdump against an endpoint.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\svchost.exe",
                    "TargetFilename|re": "\\\\Windows\\\\System32\\\\[a-zA-Z0-9]{8}\\.tmp$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6e2a900a-ced9-4e4a-a9c2-13e706f9518a",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://github.com/Porchetta-Industries/CrackMapExec",
                "https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "HackTool - Potential Remote Credential Dumping Activity Via CrackMapExec Or Impacket-Secretsdump"
        },
        {
            "author": "Teymur Kheirkhabarov, oscd.community",
            "date": "2019/11/01",
            "description": "Files with well-known filenames (parts of credential dump software or files produced by them) creation",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "TargetFilename|contains": [
                            "\\fgdump-log",
                            "\\kirbi",
                            "\\pwdump",
                            "\\pwhashes",
                            "\\wce_ccache",
                            "\\wce_krbtkts"
                        ]
                    },
                    {
                        "TargetFilename|endswith": [
                            "\\cachedump.exe",
                            "\\cachedump64.exe",
                            "\\DumpExt.dll",
                            "\\DumpSvc.exe",
                            "\\Dumpy.exe",
                            "\\fgexec.exe",
                            "\\lsremora.dll",
                            "\\lsremora64.dll",
                            "\\NTDS.out",
                            "\\procdump64.exe",
                            "\\pstgdump.exe",
                            "\\pwdump.exe",
                            "\\SAM.out",
                            "\\SECURITY.out",
                            "\\servpw.exe",
                            "\\servpw64.exe",
                            "\\SYSTEM.out",
                            "\\test.pwd",
                            "\\wceaux.dll"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate Administrator using tool for password recovery"
            ],
            "id": "8fbf3271-1ef6-4e94-8210-03c2317947f6",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/09/21",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.t1003.002",
                "attack.t1003.003",
                "attack.t1003.004",
                "attack.t1003.005"
            ],
            "title": "Cred Dump Tools Dropped Files"
        },
        {
            "author": "Markus Neis",
            "date": "2018/07/24",
            "description": "Detects default lsass dump filename generated by SafetyKatz.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "\\Temp\\debug.bin"
                }
            },
            "falsepositives": [
                "Rare legitimate files with similar filename structure"
            ],
            "id": "e074832a-eada-4fd7-94a1-10642b130e16",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://github.com/GhostPack/SafetyKatz",
                "https://github.com/GhostPack/SafetyKatz/blob/715b311f76eb3a4c8d00a1bd29c6cd1899e450b7/SafetyKatz/Program.cs#L63"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - SafetyKatz Dump Indicator"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/02/04",
            "description": "Detects the creation of the default dump file used by Outflank Dumpert tool. A process dumper, which dumps the lsass process memory",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "dumpert.dmp"
                }
            },
            "falsepositives": [
                "Very unlikely"
            ],
            "id": "93d94efc-d7ad-4161-ad7d-1638c4f908d8",
            "level": "critical",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/05/09",
            "references": [
                "https://github.com/outflanknl/Dumpert",
                "https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/"
            ],
            "related": [
                {
                    "id": "2704ab9e-afe2-4854-a3b1-0c0706d03578",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - Dumpert Process Dumper Default File"
        },
        {
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2023/10/19",
            "description": "Detects the creation of an \"lsass.dmp\" file by the taskmgr process. This indicates a manual dumping of the LSASS.exe process memory using Windows Task Manager.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        ":\\Windows\\system32\\taskmgr.exe",
                        ":\\Windows\\SysWOW64\\taskmgr.exe"
                    ],
                    "TargetFilename|contains|all": [
                        "\\AppData\\Local\\Temp\\",
                        "\\lsass",
                        ".DMP"
                    ]
                }
            },
            "falsepositives": [
                "Rare case of troubleshooting by an administrator or support that has to be investigated regardless"
            ],
            "id": "69ca12af-119d-44ed-b50f-a47af0ebc364",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/987e3ca988ae3cff4b9f6e388c139c05bf44bbb8/atomics/T1003.001/T1003.001.md#L1"
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "LSASS Process Memory Dump Creation Via Taskmgr.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/11",
            "description": "Detects creation of files with specific name patterns seen used in various tools that export the NTDS.DIT for exfiltration.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": [
                        "\\All.cab",
                        ".ntds.cleartext"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3a8da4e0-36c1-40d2-8b29-b3e890d5172a",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/05/05",
            "references": [
                "https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/modules/post/windows/gather/ntds_grabber.rb",
                "https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/data/post/powershell/NTDSgrab.ps1",
                "https://github.com/SecureAuthCorp/impacket/blob/7d2991d78836b376452ca58b3d14daa61b67cb40/impacket/examples/secretsdump.py#L2405"
            ],
            "status": "test",
            "title": "NTDS Exfiltration Filename Patterns",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/02/10",
            "description": "Detects a dump file written by QuarksPwDump password dumper",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains|all": [
                        "\\AppData\\Local\\Temp\\SAM-",
                        ".dmp"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "847def9e-924d-4e90-b7c4-5f581395a2b4",
            "level": "critical",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "HackTool - QuarksPwDump Dump File"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/11",
            "description": "Detects the creation of files that look like exports of the local SAM (Security Account Manager)",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "TargetFilename|endswith": [
                            "\\Temp\\sam",
                            "\\sam.sav",
                            "\\Intel\\sam",
                            "\\sam.hive",
                            "\\Perflogs\\sam",
                            "\\ProgramData\\sam",
                            "\\Users\\Public\\sam",
                            "\\AppData\\Local\\sam",
                            "\\AppData\\Roaming\\sam",
                            "_ShadowSteal.zip",
                            "\\Documents\\SAM.export",
                            ":\\sam"
                        ]
                    },
                    {
                        "TargetFilename|contains": [
                            "\\hive_sam_",
                            "\\sam.save",
                            "\\sam.export",
                            "\\~reg_sam.save",
                            "\\sam_backup",
                            "\\sam.bck",
                            "\\sam.backup"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Rare cases of administrative activity"
            ],
            "id": "4e87b8e2-2ee9-4b2a-a715-4727d297ece0",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/01/05",
            "references": [
                "https://github.com/search?q=CVE-2021-36934",
                "https://github.com/cube0x0/CVE-2021-36934",
                "https://www.google.com/search?q=%22reg.exe+save%22+sam",
                "https://github.com/HuskyHacks/ShadowSteal",
                "https://github.com/FireFart/hivenightmare"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "Potential SAM Database Dump"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/05",
            "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "ntds.dit"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0b8baa3f-575c-46ee-8715-d6f28cc7d33c",
            "level": "low",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "title": "NTDS.DIT Created",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Modexp, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/02/18",
            "description": "Detects a process memory dump via \"comsvcs.dll\" using rundll32, covering multiple different techniques (ordinal, minidump function, etc.)",
            "detection": {
                "condition": "(selection_img and 1 of selection_cli_*) or selection_generic",
                "selection_cli_1": {
                    "CommandLine|contains": [
                        "#-",
                        "#+",
                        "#24",
                        "24 ",
                        "MiniDump"
                    ],
                    "CommandLine|contains|all": [
                        "comsvcs",
                        "full"
                    ]
                },
                "selection_generic": {
                    "CommandLine|contains": [
                        " #",
                        ",#",
                        ", #"
                    ],
                    "CommandLine|contains|all": [
                        "24",
                        "comsvcs",
                        "full"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\rundll32.exe"
                    },
                    {
                        "OriginalFileName": "RUNDLL32.EXE"
                    },
                    {
                        "CommandLine|contains": "rundll32"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "646ea171-dded-4578-8a4d-65e9822892e3",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/16",
            "references": [
                "https://twitter.com/shantanukhande/status/1229348874298388484",
                "https://twitter.com/pythonresponder/status/1385064506049630211?s=21",
                "https://twitter.com/Hexacorn/status/1224848930795552769",
                "https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/",
                "https://twitter.com/SBousseaden/status/1167417096374050817",
                "https://twitter.com/Wietze/status/1542107456507203586",
                "https://github.com/Hackndo/lsassy/blob/14d8f8ae596ecf22b449bfe919829173b8a07635/lsassy/dumpmethod/comsvcs.py"
            ],
            "related": [
                {
                    "id": "09e6d5c0-05b8-4ff8-9eeb-043046ec774c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.t1036",
                "attack.t1003.001",
                "car.2013-05-009"
            ],
            "title": "Process Memory Dump Via Comsvcs.DLL"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/07/29",
            "description": "Detects suspicious PowerShell scripts accessing SAM hives",
            "detection": {
                "condition": "all of selection*",
                "selection_1": {
                    "CommandLine|contains|all": [
                        "\\HarddiskVolumeShadowCopy",
                        "System32\\config\\sam"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "Copy-Item",
                        "cp $_.",
                        "cpi $_.",
                        "copy $_.",
                        ".File]::Copy("
                    ]
                }
            },
            "falsepositives": [
                "Some rare backup scenarios",
                "PowerShell scripts fixing HiveNightmare / SeriousSAM ACLs"
            ],
            "id": "1af57a4b-460a-4738-9034-db68b880c665",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/06",
            "references": [
                "https://twitter.com/splinter_code/status/1420546784250769408"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "PowerShell SAM Copy"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/14",
            "description": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database to a suspicious directory.",
            "detection": {
                "condition": "all of selection_*",
                "selection_flag": {
                    "CommandLine|contains": "snapshot"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\ADExplorer.exe"
                    },
                    {
                        "OriginalFileName": "AdExp"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        "\\Downloads\\",
                        "\\Users\\Public\\",
                        "\\AppData\\",
                        "\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ef61af62-bc74-4f58-b49b-626448227652",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html"
            ],
            "related": [
                {
                    "id": "9212f354-7775-4e28-9c9f-8f0a4544e664",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001",
                "attack.t1003.003"
            ],
            "title": "Suspicious Active Directory Database Snapshot Via ADExplorer"
        },
        {
            "author": "Teymur Kheirkhabarov, oscd.community, David ANDRE (additional keywords), Tim Shelton",
            "date": "2019/10/22",
            "description": "Detection well-known mimikatz command line arguments",
            "detection": {
                "condition": "1 of selection_*",
                "selection_function_names": {
                    "CommandLine|contains": [
                        "::aadcookie",
                        "::detours",
                        "::memssp",
                        "::mflt",
                        "::ncroutemon",
                        "::ngcsign",
                        "::printnightmare",
                        "::skeleton",
                        "::preshutdown",
                        "::mstsc",
                        "::multirdp"
                    ]
                },
                "selection_module_names": {
                    "CommandLine|contains": [
                        "rpc::",
                        "token::",
                        "crypto::",
                        "dpapi::",
                        "sekurlsa::",
                        "kerberos::",
                        "lsadump::",
                        "privilege::",
                        "process::",
                        "vault::"
                    ]
                },
                "selection_tools_name": {
                    "CommandLine|contains": [
                        "DumpCreds",
                        "mimikatz"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "a642964e-bead-4bed-8910-1bb4d63e3b4d",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "https://tools.thehacker.recipes/mimikatz/modules"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.005",
                "attack.t1003.006"
            ],
            "title": "HackTool - Mimikatz Execution"
        },
        {
            "author": "Teymur Kheirkhabarov, oscd.community",
            "date": "2019/10/22",
            "description": "Shadow Copies storage symbolic link creation using operating systems utilities",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "mklink",
                        "HarddiskVolumeShadowCopy"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrator working with shadow copies, access for backup purposes"
            ],
            "id": "40b19fa6-d835-400c-b301-41f3a2baacaf",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/06",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "status": "stable",
            "title": "VolumeShadowCopy Symlink Creation Via Mklink",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.003"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/05",
            "description": "Detects the usage of \"pypykatz\" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "live",
                        "registry"
                    ],
                    "Image|endswith": [
                        "\\pypykatz.exe",
                        "\\python.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a29808fd-ef50-49ff-9c7a-59a9b040b404",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/05",
            "references": [
                "https://github.com/skelsec/pypykatz",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-2---registry-parse-with-pypykatz"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "HackTool - Pypykatz Credentials Dumping Activity"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/12/31",
            "description": "Detects the use of Windows Credential Editor (WCE)",
            "detection": {
                "condition": "1 of selection_* and not filter",
                "filter": {
                    "Image|endswith": "\\clussvc.exe"
                },
                "selection_1": [
                    {
                        "Imphash": [
                            "a53a02b997935fd8eedcb5f7abab9b9f",
                            "e96a73c7bf33a464c510ede582318bf2"
                        ]
                    },
                    {
                        "Hashes|contains": [
                            "IMPHASH=a53a02b997935fd8eedcb5f7abab9b9f",
                            "IMPHASH=e96a73c7bf33a464c510ede582318bf2"
                        ]
                    }
                ],
                "selection_2": {
                    "CommandLine|endswith": ".exe -S",
                    "ParentImage|endswith": "\\services.exe"
                }
            },
            "falsepositives": [
                "Another service that uses a single -s command line switch"
            ],
            "id": "7aa7009a-28b9-4344-8c1f-159489a390df",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://www.ampliasecurity.com/research/windows-credentials-editor/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0005"
            ],
            "title": "HackTool - Windows Credential Editor (WCE) Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/14",
            "description": "Detects execution of ntdsutil.exe to perform different actions such as restoring snapshots...etc.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": [
                    {
                        "CommandLine|contains|all": [
                            "snapshot",
                            "mount "
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "ac",
                            " i",
                            " ntds"
                        ]
                    }
                ],
                "selection_img": [
                    {
                        "Image|endswith": "\\ntdsutil.exe"
                    },
                    {
                        "OriginalFileName": "ntdsutil.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate usage to restore snapshots",
                "Legitimate admin activity"
            ],
            "id": "a58353df-af43-4753-bad0-cd83ef35eef5",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731620(v=ws.11)",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments"
            ],
            "related": [
                {
                    "id": "2afafd61-6aae-4df4-baed-139fa1f4c345",
                    "type": "derived"
                }
            ],
            "status": "test",
            "title": "Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/12",
            "description": "Detects suspicious process patterns found in logs when CrackMapExec is used",
            "detection": {
                "condition": "1 of selection*",
                "selection_lsass_dump1": {
                    "CommandLine|contains": [
                        "cmd.exe /c ",
                        "cmd.exe /r ",
                        "cmd.exe /k ",
                        "cmd /c ",
                        "cmd /r ",
                        "cmd /k "
                    ],
                    "CommandLine|contains|all": [
                        "tasklist /fi ",
                        "Imagename eq lsass.exe"
                    ],
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "selection_lsass_dump2": {
                    "CommandLine|contains|all": [
                        "do rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump",
                        "\\Windows\\Temp\\",
                        " full",
                        "%%B"
                    ]
                },
                "selection_procdump": {
                    "CommandLine|contains|all": [
                        "tasklist /v /fo csv",
                        "findstr /i \"lsass\""
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f26307d8-14cd-47e3-a26b-4b4769f24af6",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "references": [
                "https://mpgn.gitbook.io/crackmapexec/smb-protocol/obtaining-credentials/dump-lsass"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - CrackMapExec Process Patterns"
        },
        {
            "author": "jmallette, Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/01/16",
            "description": "Detects usage of cmdkey to look for cached credentials on the system",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains|windash": " -l"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\cmdkey.exe"
                    },
                    {
                        "OriginalFileName": "cmdkey.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative tasks"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "User"
            ],
            "id": "07f8bdc2-c9b3-472a-9817-5a670b872f53",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "status": "test",
            "references": [
                "https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation",
                "https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx",
                "https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1003.005/T1003.005.md#atomic-test-1---cached-credential-dump-via-cmdkey"
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1003.005"
            ],
            "title": "Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/23",
            "description": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "\\System\\CurrentControlSet\\Services\\",
                        "\\NetworkProvider"
                    ]
                }
            },
            "falsepositives": [
                "Other legitimate network providers used and not filtred in this rule"
            ],
            "id": "baef1ec6-2ca9-47a3-97cc-4cf2bda10b77",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/02",
            "references": [
                "https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade",
                "https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy"
            ],
            "related": [
                {
                    "id": "0442defa-b4a2-41c9-ae2c-ea7042fc4701",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "Potential Credential Dumping Attempt Using New NetworkProvider - CLI"
        },
        {
            "author": "Florian Roth (Nextron Systems), David ANDRE (additional keywords)",
            "date": "2021/12/20",
            "description": "Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)",
            "detection": {
                "condition": "all of selection* and not 1 of filter_*",
                "filter_config_mgr": {
                    "ParentImage|contains": ":\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\"
                },
                "filter_java": {
                    "CommandLine|contains": " -ma ",
                    "Image|contains": [
                        ":\\Program Files (x86)\\Java\\",
                        ":\\Program Files\\Java\\"
                    ],
                    "Image|endswith": "\\bin\\jp2launcher.exe",
                    "ParentImage|contains": [
                        ":\\Program Files (x86)\\Java\\",
                        ":\\Program Files\\Java\\"
                    ],
                    "ParentImage|endswith": "\\bin\\javaws.exe"
                },
                "filter_main_ping": {
                    "CommandLine|contains": "ping 127.0.0.1 -n"
                },
                "filter_vs": {
                    "Image|endswith": "\\PING.EXE",
                    "ParentCommandLine|contains": "\\DismFoDInstall.cmd"
                },
                "selection": {
                    "IntegrityLevel": "System",
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "selection_special": [
                    {
                        "Image|endswith": [
                            "\\calc.exe",
                            "\\cscript.exe",
                            "\\forfiles.exe",
                            "\\hh.exe",
                            "\\mshta.exe",
                            "\\ping.exe",
                            "\\wscript.exe"
                        ]
                    },
                    {
                        "CommandLine|contains": [
                            " -NoP ",
                            " -W Hidden ",
                            " -decode ",
                            " /decode ",
                            " /urlcache ",
                            " -urlcache ",
                            " -e* JAB",
                            " -e* SUVYI",
                            " -e* SQBFAFgA",
                            " -e* aWV4I",
                            " -e* IAB",
                            " -e* PAA",
                            " -e* aQBlAHgA",
                            "vssadmin delete shadows",
                            "reg SAVE HKLM",
                            " -ma ",
                            "Microsoft\\Windows\\CurrentVersion\\Run",
                            ".downloadstring(",
                            ".downloadfile(",
                            " /ticket:",
                            "dpapi::",
                            "event::clear",
                            "event::drop",
                            "id::modify",
                            "kerberos::",
                            "lsadump::",
                            "misc::",
                            "privilege::",
                            "rpc::",
                            "sekurlsa::",
                            "sid::",
                            "token::",
                            "vault::cred",
                            "vault::list",
                            " p::d ",
                            ";iex(",
                            "MiniDump",
                            "net user "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Administrative activity",
                "Scripts and administrative tools used in the monitored environment",
                "Monitoring activity"
            ],
            "id": "2617e7ed-adb7-40ba-b0f3-8f9945fe6c09",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/07/22",
            "references": [
                "Internal Research",
                "https://tools.thehacker.recipes/mimikatz/modules"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.t1134",
                "attack.t1003",
                "attack.t1027"
            ],
            "title": "Suspicious SYSTEM User Process Creation"
        },
        {
            "id": "2704ab9e-afe2-4854-a3b1-0c0706d03578",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2020/02/04",
            "description": "Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Hashes|contains": "09D278F9DE118EF09163C6140255C690"
                    },
                    {
                        "CommandLine|contains": "Dumpert.dll"
                    }
                ]
            },
            "falsepositives": [
                "Very unlikely"
            ],
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://github.com/outflanknl/Dumpert",
                "https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - Dumpert Process Dumper Execution"
        },
        {
            "author": "Julia Fomina, oscd.community",
            "date": "2020/10/09",
            "description": "Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process.",
            "detection": {
                "condition": "use_rpcping and remote_server and ntlm_auth",
                "ntlm_auth": [
                    {
                        "CommandLine|contains|all|windash": [
                            "-u",
                            "NTLM"
                        ]
                    },
                    {
                        "CommandLine|contains|all|windash": [
                            "-t",
                            "ncacn_np"
                        ]
                    }
                ],
                "remote_server": {
                    "CommandLine|contains|windash": "-s"
                },
                "use_rpcping": {
                    "Image|endswith": "\\rpcping.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "93671f99-04eb-4ab4-a161-70d446a84003",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Rpcping/",
                "https://twitter.com/vysecurity/status/974806438316072960",
                "https://twitter.com/vysecurity/status/873181705024266241",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875578(v=ws.11)"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "Capture Credentials with Rpcping.exe"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/04",
            "description": "Detects uses of the createdump.exe LOLOBIN utility to dump process memory",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        " -u ",
                        " --full ",
                        " -f ",
                        " --name ",
                        ".dmp "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\createdump.exe"
                    },
                    {
                        "OriginalFileName": "FX_VER_INTERNALNAME_STR"
                    }
                ]
            },
            "falsepositives": [
                "Command lines that use the same flags"
            ],
            "id": "515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/08/19",
            "references": [
                "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
                "https://twitter.com/bopin2020/status/1366400799199272960"
            ],
            "related": [
                {
                    "id": "1a1ed54a-2ba4-4221-94d5-01dee560d71e",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ],
            "title": "CreateDump Process Dump"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/09",
            "description": "Detects execution of \"AdPlus.exe\", a binary that is part of the Windows SDK that can be used as a LOLBIN in order to dump process memory and execute arbitrary commands.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        " -hang ",
                        " -pn ",
                        " -pmn ",
                        " -p ",
                        " -po ",
                        " -c ",
                        " -sc "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\adplus.exe"
                    },
                    {
                        "OriginalFileName": "Adplus.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate usage of Adplus for debugging purposes"
            ],
            "id": "2f869d59-7f6a-4931-992c-cce556ff2d53",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/06/23",
            "references": [
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Adplus/",
                "https://twitter.com/nas_bench/status/1534916659676422152",
                "https://twitter.com/nas_bench/status/1534915321856917506"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1003.001"
            ],
            "title": "Potential Adplus.EXE Abuse"
        },
        {
            "id": "1a1ed54a-2ba4-4221-94d5-01dee560d71e",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/20",
            "description": "Detects uses of a renamed legitimate createdump.exe LOLOBIN utility to dump process memory",
            "detection": {
                "condition": "1 of selection_* and not filter",
                "filter": {
                    "Image|endswith": "\\createdump.exe"
                },
                "selection_cli": [
                    {
                        "CommandLine|contains|all": [
                            " -u ",
                            " -f ",
                            ".dmp"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            " --full ",
                            " --name ",
                            ".dmp"
                        ]
                    }
                ],
                "selection_pe": {
                    "OriginalFileName": "FX_VER_INTERNALNAME_STR"
                }
            },
            "falsepositives": [
                "Command lines that use the same flags"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
                "https://twitter.com/bopin2020/status/1366400799199272960"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ],
            "title": "Renamed CreateDump Utility Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/05",
            "description": "Detects usage of the Quarks PwDump tool via commandline arguments",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli": {
                    "CommandLine": [
                        " -dhl",
                        " --dump-hash-local",
                        " -dhdc",
                        " --dump-hash-domain-cached",
                        " --dump-bitlocker",
                        " -dhd ",
                        " --dump-hash-domain ",
                        "--ntds-file"
                    ]
                },
                "selection_img": {
                    "Image|endswith": "\\QuarksPwDump.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "0685b176-c816-4837-8e7b-1216f346636b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/05",
            "references": [
                "https://github.com/quarkslab/quarkspwdump",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/seedworm-apt-iran-middle-east"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "HackTool - Quarks PwDump Execution"
        },
        {
            "author": "@pbssubhash , Nasreddine Bencherchali",
            "date": "2022/12/08",
            "description": "Detects potential credential dumping via Windows Error Reporting LSASS Shtinkering technique which uses the Windows Error Reporting to dump lsass",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "filter_lsass": {
                    "ParentImage": "C:\\Windows\\System32\\lsass.exe"
                },
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " -u -p ",
                        " -ip ",
                        " -s "
                    ],
                    "ParentUser|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ],
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\Werfault.exe"
                    },
                    {
                        "OriginalFileName": "WerFault.exe"
                    }
                ]
            },
            "falsepositives": [
                "Windows Error Reporting might produce similar behavior. In that case, check the PID associated with the \"-p\" parameter in the CommandLine."
            ],
            "id": "9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/deepinstinct/Lsass-Shtinkering",
                "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf"
            ],
            "modified": "2022/12/09",
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Potential Credential Dumping Via WER"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/12/19",
            "description": "Detects the execution of the hacktool Rubeus via PE information of command line parameters",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\Rubeus.exe"
                    },
                    {
                        "OriginalFileName": "Rubeus.exe"
                    },
                    {
                        "Description": "Rubeus"
                    },
                    {
                        "CommandLine|contains": [
                            "asreproast ",
                            "dump /service:krbtgt ",
                            "dump /luid:0x",
                            "kerberoast ",
                            "createnetonly /program:",
                            "ptt /ticket:",
                            "/impersonateuser:",
                            "renew /ticket:",
                            "asktgt /user:",
                            "harvest /interval:",
                            "s4u /user:",
                            "s4u /ticket:",
                            "hash /password:",
                            "golden /aes256:",
                            "silver /user:"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "7ec2c172-dceb-4c10-92c9-87c1881b7e18",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/20",
            "references": [
                "https://blog.harmj0y.net/redteaming/from-kekeo-to-rubeus",
                "https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html",
                "https://github.com/GhostPack/Rubeus"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "7ec2c172-dceb-4c10-92c9-87c1881b7e18"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1558.003",
                "attack.lateral_movement",
                "attack.t1550.003"
            ],
            "title": "HackTool - Rubeus Execution"
        },
        {
            "id": "9212f354-7775-4e28-9c9f-8f0a4544e664",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/14",
            "description": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "snapshot"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\ADExplorer.exe"
                    },
                    {
                        "OriginalFileName": "AdExp"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "ef61af62-bc74-4f58-b49b-626448227652"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001",
                "attack.t1003.003"
            ],
            "title": "Active Directory Database Snapshot Via ADExplorer"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/11",
            "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration",
            "detection": {
                "condition": "1 of selection* or all of set1*",
                "selection_oneliner_1": {
                    "CommandLine|contains|all": [
                        "ac i ntds",
                        "create full"
                    ]
                },
                "selection_onliner_2": {
                    "CommandLine|contains|all": [
                        "/c copy ",
                        "\\windows\\ntds\\ntds.dit"
                    ]
                },
                "selection_onliner_3": {
                    "CommandLine|contains|all": [
                        "activate instance ntds",
                        "create full"
                    ]
                },
                "selection_powershell": {
                    "CommandLine|contains|all": [
                        "powershell",
                        "ntds.dit"
                    ]
                },
                "selection_tool": [
                    {
                        "Image|endswith": [
                            "\\NTDSDump.exe",
                            "\\NTDSDumpEx.exe"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "ntds.dit",
                            "system.hiv"
                        ]
                    },
                    {
                        "CommandLine|contains": "NTDSgrab.ps1"
                    }
                ],
                "set1_selection_image_folder": [
                    {
                        "ParentImage|contains": [
                            "\\apache",
                            "\\tomcat",
                            "\\AppData\\",
                            "\\Temp\\",
                            "\\Public\\",
                            "\\PerfLogs\\"
                        ]
                    },
                    {
                        "Image|contains": [
                            "\\apache",
                            "\\tomcat",
                            "\\AppData\\",
                            "\\Temp\\",
                            "\\Public\\",
                            "\\PerfLogs\\"
                        ]
                    }
                ],
                "set1_selection_ntds_dit": {
                    "CommandLine|contains": "ntds.dit"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8bc64091-6875-4881-aaf9-7bd25b5dda08",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/11/10",
            "references": [
                "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
                "https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/",
                "https://pentestlab.blog/tag/ntds-dit/",
                "https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1",
                "https://github.com/zcgonvh/NTDSDumpEx",
                "https://github.com/rapid7/metasploit-framework/blob/d297adcebb5c1df6fe30b12ca79b161deb71571c/data/post/powershell/NTDSgrab.ps1",
                "https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1"
            ],
            "status": "test",
            "title": "Suspicious Process Patterns NTDS.DIT Exfil",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2024/02/12",
            "description": "Detects the enumeration and query of interesting and in some cases sensitive services on the system via \"sc.exe\".\nAttackers often try to enumerate the services currently running on a system in order to find different attack vectors.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "query"
                },
                "selection_cmd": {
                    "CommandLine|contains": "termservice"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\sc.exe"
                    },
                    {
                        "OriginalFileName": "sc.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e83e8899-c9b2-483b-b355-5decc942b959",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/",
                "https://pentestlab.blog/tag/svchost/"
            ],
            "status": "experimental",
            "title": "Interesting Service Enumeration Via Sc.EXE",
            "tags": [
                "attack.t1003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/04/06",
            "description": "Detects suspicious ways to use the \"DumpMinitool.exe\" binary",
            "detection": {
                "cmd_has_flags": {
                    "CommandLine|contains": [
                        " Full",
                        " Mini",
                        " WithHeap"
                    ]
                },
                "condition": "selection and ( ( not filter_folder ) or susp_flags or ( cmd_has_flags and not filter_cmd_misses_flags ) )",
                "filter_cmd_misses_flags": {
                    "CommandLine|contains": "--dumpType"
                },
                "filter_folder": {
                    "Image|contains": [
                        "\\Microsoft Visual Studio\\",
                        "\\Extensions\\"
                    ]
                },
                "selection": [
                    {
                        "Image|endswith": [
                            "\\DumpMinitool.exe",
                            "\\DumpMinitool.x86.exe",
                            "\\DumpMinitool.arm64.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "DumpMinitool.exe",
                            "DumpMinitool.x86.exe",
                            "DumpMinitool.arm64.exe"
                        ]
                    }
                ],
                "susp_flags": {
                    "CommandLine|contains": ".txt"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "eb1c4225-1c23-4241-8dd4-051389fde4ce",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "references": [
                "https://twitter.com/mrd0x/status/1511415432888131586",
                "https://twitter.com/mrd0x/status/1511489821247684615",
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/"
            ],
            "status": "test",
            "title": "Suspicious DumpMinitool Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Cedric MAURUGEON, Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/09/24",
            "description": "Detects the use of the Microsoft Windows Resource Leak Diagnostic tool \"rdrleakdiag.exe\" to dump process memory",
            "detection": {
                "condition": "all of selection_cli_* or (selection_img and selection_cli_dump)",
                "selection_cli_dump": {
                    "CommandLine|contains": [
                        "fullmemdmp",
                        "/memdmp",
                        "-memdmp"
                    ]
                },
                "selection_cli_output": {
                    "CommandLine|contains": [
                        " -o ",
                        " /o "
                    ]
                },
                "selection_cli_process": {
                    "CommandLine|contains": [
                        " -p ",
                        " /p "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\rdrleakdiag.exe"
                    },
                    {
                        "OriginalFileName": "RdrLeakDiag.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "edadb1e5-5919-4e4c-8462-a9e643b02c4b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/24",
            "references": [
                "https://www.pureid.io/dumping-abusing-windows-credentials-part-1/",
                "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
                "https://lolbas-project.github.io/lolbas/Binaries/Rdrleakdiag/",
                "https://twitter.com/0gtweet/status/1299071304805560321?s=21"
            ],
            "related": [
                {
                    "id": "6355a919-2e97-4285-a673-74645566340d",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Process Memory Dump via RdrLeakDiag.EXE"
        },
        {
            "author": "Ensar \u015eamil, @sblmsrsn, @oscd_initiative",
            "date": "2020/10/06",
            "description": "Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ParentImage|endswith": "\\tttracer.exe"
                }
            },
            "falsepositives": [
                "Legitimate usage by software developers/testers"
            ],
            "id": "0b4ae027-2a2d-4b93-8c7e-962caaba5b2a",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Tttracer/",
                "https://twitter.com/mattifestation/status/1196390321783025666",
                "https://twitter.com/oulusoyum/status/1191329746069655553"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "e76c8240-d68f-4773-8880-5c6f63595aaf"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.t1218",
                "attack.t1003.001"
            ],
            "title": "Time Travel Debugging Utility Usage"
        },
        {
            "author": "E.M. Anhaus, Tony Lambert, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/10/24",
            "description": "Detects the presence of the keywords \"lsass\" and \".dmp\" in the commandline, which could indicate a potential attempt to dump or create a dump of the lsass process.\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "CommandLine|contains": [
                            "lsass.dmp",
                            "lsass.zip",
                            "lsass.rar",
                            "Andrew.dmp",
                            "Coredump.dmp",
                            "NotLSASS.zip",
                            "lsass_2",
                            "lsassdump",
                            "lsassdmp"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "lsass",
                            ".dmp"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "SQLDmpr",
                            ".mdmp"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            "nanodump",
                            ".dmp"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "ffa6861c-4461-4f59-8a41-578c39f3f23e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/08/29",
            "references": [
                "https://github.com/Hackndo/lsassy",
                "https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf",
                "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml",
                "https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/",
                "https://github.com/helpsystems/nanodump",
                "https://github.com/CCob/MirrorDump"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "a5a2d357-1ab8-4675-a967-ef9990a59391"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "LSASS Dump Keyword In CommandLine"
        },
        {
            "author": "sam0x90",
            "date": "2021/08/06",
            "description": "Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "esentutl",
                        " /p"
                    ]
                }
            },
            "falsepositives": [
                "To be determined"
            ],
            "fields": [
                "User",
                "CommandLine",
                "ParentCommandLine",
                "CurrentDirectory"
            ],
            "id": "7df1713a-1a5b-4a4b-a071-dc83b144a101",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "status": "test",
            "references": [
                "https://twitter.com/vxunderground/status/1423336151860002816",
                "https://attack.mitre.org/software/S0404/",
                "https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/"
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1003.003"
            ],
            "title": "Esentutl Gather Credentials"
        },
        {
            "author": "Furkan Caliskan (@caliskanfurkan_)",
            "date": "2020/07/04",
            "description": "Detects the use of Ditsnap tool, an inspection tool for Active Directory database, ntds.dit.",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\ditsnap.exe"
                    },
                    {
                        "CommandLine|contains": "ditsnap.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate admin usage"
            ],
            "id": "d3b70aad-097e-409c-9df2-450f80dc476b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://thedfirreport.com/2020/06/21/snatch-ransomware/",
                "https://web.archive.org/web/20201124182207/https://github.com/yosqueoy/ditsnap"
            ],
            "status": "test",
            "title": "PUA - DIT Snapshot Viewer",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2024/05/10",
            "description": "Detects the dump of highly sensitive files such as \"NTDS.DIT\" and \"SECURITY\" hive.\nAttackers can leverage the \"wbadmin\" utility in order to dump sensitive files that might contain credential or sensitive information.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_backup": {
                    "CommandLine|contains": [
                        "start",
                        "backup"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wbadmin.exe"
                    },
                    {
                        "OriginalFileName": "WBADMIN.EXE"
                    }
                ],
                "selection_path": {
                    "CommandLine|contains": [
                        "\\config\\SAM",
                        "\\config\\SECURITY",
                        "\\config\\SYSTEM",
                        "\\Windows\\NTDS\\NTDS.dit"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate backup operation by authorized administrators. Matches must be investigated and allowed on a case by case basis."
            ],
            "id": "8b93a509-1cb8-42e1-97aa-ee24224cdc15",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml",
                "https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup"
            ],
            "status": "experimental",
            "title": "Sensitive File Dump Via Wbadmin.EXE",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/12/22",
            "description": "Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\CreateMiniDump.exe"
                    },
                    {
                        "Imphash": "4a07f944a83e8a7c2525efa35dd30e2f"
                    },
                    {
                        "Hashes|contains": "IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "36d88494-1d43-4dc0-b3fa-35c8fea0ca9d",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsass-passwords-without-mimikatz-minidumpwritedump-av-signature-bypass"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - CreateMiniDump Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/10/30",
            "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process.\nThis way we are also able to catch cases in which the attacker has renamed the procdump executable.\n",
            "detection": {
                "condition": "all of selection*",
                "selection_flags": {
                    "CommandLine|contains|windash": " -ma "
                },
                "selection_process": {
                    "CommandLine|contains": " ls"
                }
            },
            "falsepositives": [
                "Unlikely, because no one should dump an lsass process memory",
                "Another tool that uses command line flags similar to ProcDump"
            ],
            "id": "5afee48e-67dd-4e03-a783-f74259dcf998",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.credential_access",
                "attack.t1003.001",
                "car.2013-05-009"
            ],
            "title": "Potential LSASS Process Dump Via Procdump"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/20",
            "description": "Detects the execution of the hacktool SafetyKatz via PE information and default Image name",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\SafetyKatz.exe"
                    },
                    {
                        "OriginalFileName": "SafetyKatz.exe"
                    },
                    {
                        "Description": "SafetyKatz"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "b1876533-4ed5-4a83-90f3-b8645840a413",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://github.com/GhostPack/SafetyKatz"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - SafetyKatz Execution"
        },
        {
            "author": "Tim Rauch, Elastic (idea)",
            "date": "2022/09/28",
            "description": "Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command.",
            "detection": {
                "condition": "all of selection*",
                "selection_args": {
                    "CommandLine|contains|all": [
                        "connectionStrings",
                        " -pdf"
                    ]
                },
                "selection_name": [
                    {
                        "Image|endswith": "\\aspnet_regiis.exe"
                    },
                    {
                        "OriginalFileName": "aspnet_regiis.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "97dbf6e2-e436-44d8-abee-4261b24d3e41",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://www.elastic.co/guide/en/security/current/microsoft-iis-connection-strings-decryption.html"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "Microsoft IIS Connection Strings Decryption"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/03",
            "description": "Detects usage of \"cmdkey.exe\" to add generic credentials.\nAs an example, this can be used before connecting to an RDP session via command line interface.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli_generic": {
                    "CommandLine|contains|windash": " -g"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\cmdkey.exe"
                    },
                    {
                        "OriginalFileName": "cmdkey.exe"
                    }
                ],
                "selection_cli_password": {
                    "CommandLine|contains|windash": " -p"
                },
                "selection_cli_user": {
                    "CommandLine|contains|windash": " -u"
                }
            },
            "falsepositives": [
                "Legitimate usage for administration purposes"
            ],
            "id": "b1ec66c6-f4d1-4b5c-96dd-af28ccae7727",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md#t1021001---remote-desktop-protocol"
            ],
            "modified": "2024/03/05",
            "status": "test",
            "title": "New Generic Credentials Added Via Cmdkey.EXE",
            "tags": [
                "attack.credential_access",
                "attack.t1003.005"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/04",
            "description": "Detects the execution of different Windows based hacktools via their import hash (imphash) even if the files have been renamed",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Imphash": [
                            "bcca3c247b619dcd13c8cdff5f123932",
                            "3a19059bd7688cb88e70005f18efc439",
                            "bf6223a49e45d99094406777eb6004ba",
                            "23867a89c2b8fc733be6cf5ef902f2d1",
                            "a37ff327f8d48e8a4d2f757e1b6e70bc",
                            "f9a28c458284584a93b14216308d31bd",
                            "6118619783fc175bc7ebecff0769b46e",
                            "959a83047e80ab68b368fdb3f4c6e4ea",
                            "563233bfa169acc7892451f71ad5850a",
                            "87575cb7a0e0700eb37f2e3668671a08",
                            "13f08707f759af6003837a150a371ba1",
                            "1781f06048a7e58b323f0b9259be798b",
                            "233f85f2d4bc9d6521a6caae11a1e7f5",
                            "24af2584cbf4d60bbe5c6d1b31b3be6d",
                            "632969ddf6dbf4e0f53424b75e4b91f2",
                            "713c29b396b907ed71a72482759ed757",
                            "749a7bb1f0b4c4455949c0b2bf7f9e9f",
                            "8628b2608957a6b0c6330ac3de28ce2e",
                            "8b114550386e31895dfab371e741123d",
                            "94cb940a1a6b65bed4d5a8f849ce9793",
                            "9d68781980370e00e0bd939ee5e6c141",
                            "b18a1401ff8f444056d29450fbc0a6ce",
                            "cb567f9498452721d77a451374955f5f",
                            "730073214094cd328547bf1f72289752",
                            "17b461a082950fc6332228572138b80c",
                            "dc25ee78e2ef4d36faa0badf1e7461c9",
                            "819b19d53ca6736448f9325a85736792",
                            "829da329ce140d873b4a8bde2cbfaa7e",
                            "c547f2e66061a8dffb6f5a3ff63c0a74",
                            "0588081ab0e63ba785938467e1b10cca",
                            "0d9ec08bac6c07d9987dfd0f1506587c",
                            "bc129092b71c89b4d4c8cdf8ea590b29",
                            "4da924cf622d039d58bce71cdf05d242",
                            "e7a3a5c377e2d29324093377d7db1c66",
                            "9a9dbec5c62f0380b4fa5fd31deffedf",
                            "af8a3976ad71e5d5fdfb67ddb8dadfce",
                            "0c477898bbf137bbd6f2a54e3b805ff4",
                            "0ca9f02b537bcea20d4ea5eb1a9fe338",
                            "3ab3655e5a14d4eefc547f4781bf7f9e",
                            "e6f9d5152da699934b30daab206471f6",
                            "3ad59991ccf1d67339b319b15a41b35d",
                            "ffdd59e0318b85a3e480874d9796d872",
                            "0cf479628d7cc1ea25ec7998a92f5051",
                            "07a2d4dcbd6cb2c6a45e6b101f0b6d51",
                            "d6d0f80386e1380d05cb78e871bc72b1",
                            "38d9e015591bbfd4929e0d0f47fa0055",
                            "0e2216679ca6e1094d63322e3412d650",
                            "ada161bf41b8e5e9132858cb54cab5fb",
                            "2a1bc4913cd5ecb0434df07cb675b798",
                            "11083e75553baae21dc89ce8f9a195e4",
                            "a23d29c9e566f2fa8ffbb79267f5df80",
                            "4a07f944a83e8a7c2525efa35dd30e2f",
                            "767637c23bb42cd5d7397cf58b0be688",
                            "14c4e4c72ba075e9069ee67f39188ad8",
                            "3c782813d4afce07bbfc5a9772acdbdc",
                            "7d010c6bb6a3726f327f7e239166d127",
                            "89159ba4dd04e4ce5559f132a9964eb3",
                            "6f33f4a5fc42b8cec7314947bd13f30f",
                            "5834ed4291bdeb928270428ebbaf7604",
                            "5a8a8a43f25485e7ee1b201edcbc7a38",
                            "dc7d30b90b2d8abf664fbed2b1b59894",
                            "41923ea1f824fe63ea5beb84db7a3e74",
                            "3de09703c8e79ed2ca3f01074719906b",
                            "a53a02b997935fd8eedcb5f7abab9b9f",
                            "e96a73c7bf33a464c510ede582318bf2",
                            "32089b8851bbf8bc2d014e9f37288c83",
                            "09D278F9DE118EF09163C6140255C690",
                            "03866661686829d806989e2fc5a72606",
                            "e57401fbdadcd4571ff385ab82bd5d6d",
                            "84B763C45C0E4A3E7CA5548C710DB4EE",
                            "19584675d94829987952432e018d5056",
                            "330768a4f172e10acb6287b87289d83b",
                            "885c99ccfbe77d1cbfcb9c4e7c1a3313",
                            "22a22bc9e4e0d2f189f1ea01748816ac",
                            "7fa30e6bb7e8e8a69155636e50bf1b28",
                            "96df3a3731912449521f6f8d183279b1",
                            "7e6cf3ff4576581271ac8a313b2aab46",
                            "51791678f351c03a0eb4e2a7b05c6e17",
                            "25ce42b079282632708fc846129e98a5",
                            "021bcca20ba3381b11bdde26b4e62f20",
                            "59223b5f52d8799d38e0754855cbdf42",
                            "81e75d8f1d276c156653d3d8813e4a43",
                            "17244e8b6b8227e57fe709ccad421420",
                            "5b76da3acdedc8a5cdf23a798b5936b4",
                            "cb2b65bb77d995cc1c0e5df1c860133c",
                            "40445337761d80cf465136fafb1f63e6",
                            "8a790f401b29fa87bc1e56f7272b3aa6",
                            "b50199e952c875241b9ce06c971ce3c1"
                        ]
                    },
                    {
                        "Hashes|contains": [
                            "IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932",
                            "IMPHASH=3A19059BD7688CB88E70005F18EFC439",
                            "IMPHASH=bf6223a49e45d99094406777eb6004ba",
                            "IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1",
                            "IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC",
                            "IMPHASH=F9A28C458284584A93B14216308D31BD",
                            "IMPHASH=6118619783FC175BC7EBECFF0769B46E",
                            "IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA",
                            "IMPHASH=563233BFA169ACC7892451F71AD5850A",
                            "IMPHASH=87575CB7A0E0700EB37F2E3668671A08",
                            "IMPHASH=13F08707F759AF6003837A150A371BA1",
                            "IMPHASH=1781F06048A7E58B323F0B9259BE798B",
                            "IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5",
                            "IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D",
                            "IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2",
                            "IMPHASH=713C29B396B907ED71A72482759ED757",
                            "IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F",
                            "IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E",
                            "IMPHASH=8B114550386E31895DFAB371E741123D",
                            "IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793",
                            "IMPHASH=9D68781980370E00E0BD939EE5E6C141",
                            "IMPHASH=B18A1401FF8F444056D29450FBC0A6CE",
                            "IMPHASH=CB567F9498452721D77A451374955F5F",
                            "IMPHASH=730073214094CD328547BF1F72289752",
                            "IMPHASH=17B461A082950FC6332228572138B80C",
                            "IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9",
                            "IMPHASH=819B19D53CA6736448F9325A85736792",
                            "IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E",
                            "IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74",
                            "IMPHASH=0588081AB0E63BA785938467E1B10CCA",
                            "IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C",
                            "IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29",
                            "IMPHASH=4DA924CF622D039D58BCE71CDF05D242",
                            "IMPHASH=E7A3A5C377E2D29324093377D7DB1C66",
                            "IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF",
                            "IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE",
                            "IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4",
                            "IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338",
                            "IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E",
                            "IMPHASH=E6F9D5152DA699934B30DAAB206471F6",
                            "IMPHASH=3AD59991CCF1D67339B319B15A41B35D",
                            "IMPHASH=FFDD59E0318B85A3E480874D9796D872",
                            "IMPHASH=0CF479628D7CC1EA25EC7998A92F5051",
                            "IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51",
                            "IMPHASH=D6D0F80386E1380D05CB78E871BC72B1",
                            "IMPHASH=38D9E015591BBFD4929E0D0F47FA0055",
                            "IMPHASH=0E2216679CA6E1094D63322E3412D650",
                            "IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB",
                            "IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798",
                            "IMPHASH=11083E75553BAAE21DC89CE8F9A195E4",
                            "IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80",
                            "IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F",
                            "IMPHASH=767637C23BB42CD5D7397CF58B0BE688",
                            "IMPHASH=14C4E4C72BA075E9069EE67F39188AD8",
                            "IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC",
                            "IMPHASH=7D010C6BB6A3726F327F7E239166D127",
                            "IMPHASH=89159BA4DD04E4CE5559F132A9964EB3",
                            "IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F",
                            "IMPHASH=5834ED4291BDEB928270428EBBAF7604",
                            "IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38",
                            "IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894",
                            "IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74",
                            "IMPHASH=3DE09703C8E79ED2CA3F01074719906B",
                            "IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F",
                            "IMPHASH=E96A73C7BF33A464C510EDE582318BF2",
                            "IMPHASH=32089B8851BBF8BC2D014E9F37288C83",
                            "IMPHASH=09D278F9DE118EF09163C6140255C690",
                            "IMPHASH=03866661686829d806989e2fc5a72606",
                            "IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d",
                            "IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE",
                            "IMPHASH=19584675D94829987952432E018D5056",
                            "IMPHASH=330768A4F172E10ACB6287B87289D83B",
                            "IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313",
                            "IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC",
                            "IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28",
                            "IMPHASH=96DF3A3731912449521F6F8D183279B1",
                            "IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46",
                            "IMPHASH=51791678F351C03A0EB4E2A7B05C6E17",
                            "IMPHASH=25CE42B079282632708FC846129E98A5",
                            "IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20",
                            "IMPHASH=59223B5F52D8799D38E0754855CBDF42",
                            "IMPHASH=81E75D8F1D276C156653D3D8813E4A43",
                            "IMPHASH=17244E8B6B8227E57FE709CCAD421420",
                            "IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4",
                            "IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C",
                            "IMPHASH=40445337761D80CF465136FAFB1F63E6",
                            "IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6",
                            "IMPHASH=B50199E952C875241B9CE06C971CE3C1"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of one of these tools"
            ],
            "id": "24e3e58a-646b-4b50-adef-02ef935b9fc8",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "modified": "2024/02/07",
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1588.002",
                "attack.t1003"
            ],
            "title": "Hacktool Execution - Imphash"
        },
        {
            "author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
            "date": "2019/10/22",
            "description": "Shadow Copies creation using operating systems utilities, possible credential access",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "shadow",
                        "create"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\wmic.exe",
                            "\\vssadmin.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll",
                            "wmic.exe",
                            "VSSADMIN.EXE"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrator working with shadow copies, access for backup purposes"
            ],
            "id": "b17ea6f7-6e90-447e-a799-e6c0a493d6ce",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/11/10",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/tutorial-for-ntds-goodness-vssadmin-wmis-ntdsdit-system/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1003.002",
                "attack.t1003.003"
            ],
            "title": "Shadow Copies Creation Using Operating Systems Utilities"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/08/18",
            "description": "Detects the use of HandleKatz, a tool that demonstrates the usage of cloned handles to Lsass in order to create an obfuscated memory dump of the same",
            "detection": {
                "condition": "1 of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        ".dmp",
                        "lsass",
                        ".obf",
                        "dump"
                    ],
                    "CommandLine|contains|all": [
                        "--pid:",
                        "--outfile:"
                    ]
                },
                "selection_loader_img": {
                    "CommandLine|contains": "--pid:",
                    "Image|endswith": "\\loader.exe"
                },
                "selection_loader_imphash": [
                    {
                        "Imphash": [
                            "38d9e015591bbfd4929e0d0f47fa0055",
                            "0e2216679ca6e1094d63322e3412d650"
                        ]
                    },
                    {
                        "Hashes|contains": [
                            "IMPHASH=38D9E015591BBFD4929E0D0F47FA0055",
                            "IMPHASH=0E2216679CA6E1094D63322E3412D650"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ca621ba5-54ab-4035-9942-d378e6fcde3c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/04/15",
            "references": [
                "https://github.com/codewhitesec/HandleKatz"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - HandleKatz LSASS Dumper Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
            "date": "2022/04/06",
            "description": "Detects the use of \"DumpMinitool.exe\" a tool that allows the dump of process memory via the use of the \"MiniDumpWriteDump\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        " Full",
                        " Mini",
                        " WithHeap"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\DumpMinitool.exe",
                            "\\DumpMinitool.x86.exe",
                            "\\DumpMinitool.arm64.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "DumpMinitool.exe",
                            "DumpMinitool.x86.exe",
                            "DumpMinitool.arm64.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dee0a7a3-f200-4112-a99b-952196d81e42",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "references": [
                "https://twitter.com/mrd0x/status/1511415432888131586",
                "https://twitter.com/mrd0x/status/1511489821247684615",
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/",
                "https://gist.github.com/nasbench/6d58c3c125e2fa1b8f7a09754c1b087f"
            ],
            "status": "test",
            "title": "DumpMinitool Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Samir Bousseaden",
            "date": "2021/11/27",
            "description": "Detects a suspicious LSASS process process clone that could be a sign of credential dumping activity",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\Windows\\System32\\lsass.exe",
                    "ParentImage|endswith": "\\Windows\\System32\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c8da0dfd-4ed0-4b68-962d-13c9c884384e",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/02",
            "references": [
                "https://www.matteomalvica.com/blog/2019/12/02/win-defender-atp-cred-bypass/",
                "https://twitter.com/Hexacorn/status/1420053502554951689",
                "https://twitter.com/SBousseaden/status/1464566846594691073?s=20"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1003.001"
            ],
            "title": "Potential Credential Dumping Via LSASS Process Clone"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/04/27",
            "description": "Detects the execution of different Windows based hacktools via PE metadata (company, product, etc.) even if the files have been renamed",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Company": "Cube0x0"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "37c1333a-a0db-48be-b64b-7393b2386e3b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/15",
            "references": [
                "https://github.com/cube0x0",
                "https://www.virustotal.com/gui/search/metadata%253ACube0x0/files"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1588.002",
                "attack.t1003"
            ],
            "title": "Hacktool Execution - PE Metadata"
        },
        {
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2024/02/12",
            "description": "Detects the enumeration of a specific DLL or EXE being used by a binary via \"tasklist.exe\".\nThis is often used by attackers in order to find the specific process identifier (PID) that is using the DLL in question.\nIn order to dump the process memory or perform other nefarious actions.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains|windash": "-m"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\tasklist.exe"
                    },
                    {
                        "OriginalFileName": "tasklist.exe"
                    }
                ],
                "selection_module": {
                    "CommandLine|contains": "rdpcorets.dll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "34275eb8-fa19-436b-b959-3d9ecd53fa1f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/",
                "https://pentestlab.blog/tag/svchost/"
            ],
            "modified": "2024/03/13",
            "status": "experimental",
            "tags": [
                "attack.t1003"
            ],
            "title": "Loaded Module Enumeration Via Tasklist.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2024/05/10",
            "description": "Detects the dump of highly sensitive files such as \"NTDS.DIT\" and \"SECURITY\" hive.\nAttackers can leverage the \"wbadmin\" utility in order to dump sensitive files that might contain credential or sensitive information.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_backup": {
                    "CommandLine|contains": [
                        "\\config\\SAM",
                        "\\config\\SECURITY",
                        "\\config\\SYSTEM",
                        "\\Windows\\NTDS\\NTDS.dit"
                    ],
                    "CommandLine|contains|all": [
                        " recovery",
                        "recoveryTarget",
                        "itemtype:File"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wbadmin.exe"
                    },
                    {
                        "OriginalFileName": "WBADMIN.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "84972c80-251c-4c3a-9079-4f00aad93938",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml",
                "https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup"
            ],
            "related": [
                {
                    "id": "6fe4aa1e-0531-4510-8be2-782154b73b48",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "title": "Sensitive File Recovery From Backup Via Wbadmin.EXE",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/11",
            "description": "Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "CommandLine|contains": [
                        "copy procdump",
                        "move procdump"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "2.dmp",
                        "lsass",
                        "out.dmp"
                    ],
                    "CommandLine|contains|all": [
                        "copy ",
                        ".dmp "
                    ]
                },
                "selection_3": {
                    "CommandLine|contains": [
                        "copy lsass.exe_",
                        "move lsass.exe_"
                    ]
                }
            },
            "falsepositives": [
                "False positives are expected in cases in which ProcDump just gets copied to a different directory without any renaming"
            ],
            "id": "79b06761-465f-4f88-9ef2-150e24d3d737",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/09",
            "references": [
                "https://twitter.com/mrd0x/status/1480785527901204481"
            ],
            "status": "test",
            "title": "Potential SysInternals ProcDump Evasion",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "id": "2afafd61-6aae-4df4-baed-139fa1f4c345",
            "author": "Thomas Patzke",
            "date": "2019/01/16",
            "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\ntdsutil.exe"
                }
            },
            "falsepositives": [
                "NTDS maintenance"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/03/11",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/ntdsutil.htm"
            ],
            "status": "test",
            "title": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/28",
            "description": "Detects suspicious use of XORDump process memory dumping utility",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\xordump.exe"
                    },
                    {
                        "CommandLine|contains": [
                            " -process lsass.exe ",
                            " -m comsvcs ",
                            " -m dbghelp ",
                            " -m dbgcore "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Another tool that uses the command line switches of XORdump"
            ],
            "id": "66e563f9-1cbd-4a22-a957-d8b7c0f44372",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://github.com/audibleblink/xordump"
            ],
            "status": "test",
            "title": "HackTool - XORDump Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Tim Rauch, Janantha Marasinghe, Elastic (original idea)",
            "date": "2022/11/08",
            "description": "Detects the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords",
            "detection": {
                "condition": "all of selection_base_* and (selection_standalone or all of selection_cmd_*)",
                "selection_base_list": {
                    "CommandLine|contains": "list "
                },
                "selection_base_name": [
                    {
                        "Image|endswith": "\\appcmd.exe"
                    },
                    {
                        "OriginalFileName": "appcmd.exe"
                    }
                ],
                "selection_cmd_flags": {
                    "CommandLine|contains": [
                        " /@t",
                        " /text",
                        " /show",
                        " -@t",
                        " -text",
                        " -show"
                    ]
                },
                "selection_cmd_grep": {
                    "CommandLine|contains": [
                        ":\\*",
                        "password"
                    ]
                },
                "selection_standalone": {
                    "CommandLine|contains": [
                        " /config",
                        " /xml",
                        " -config",
                        " -xml"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2d3cdeec-c0db-45b4-aa86-082f7eb75701",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/22",
            "references": [
                "https://www.elastic.co/guide/en/security/current/microsoft-iis-service-account-password-dumped.html",
                "https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA",
                "https://www.netspi.com/blog/technical/network-penetration-testing/decrypting-iis-passwords-to-break-out-of-the-dmz-part-2/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "Microsoft IIS Service Account Password Dumped"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/08/16",
            "description": "Detects usage of the SysInternals Procdump utility",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\procdump.exe",
                        "\\procdump64.exe"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of procdump by a developer or administrator"
            ],
            "id": "2e65275c-8288-4ab4-aeb7-6274f58b6b20",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/28",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
            ],
            "status": "test",
            "title": "Procdump Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Teymur Kheirkhabarov, Endgame, JHasenbusch, Daniil Yugoslavskiy, oscd.community, frack113",
            "date": "2019/10/22",
            "description": "Detects the usage of \"reg.exe\" in order to dump sensitive registry hives. This includes SAM, SYSTEM and SECURITY hives.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli_flag": {
                    "CommandLine|contains": [
                        " save ",
                        " export ",
                        " \u02e2ave ",
                        " e\u02e3port "
                    ]
                },
                "selection_cli_hive": {
                    "CommandLine|contains": [
                        "\\system",
                        "\\sam",
                        "\\security",
                        "\\\u02e2ystem",
                        "\\sy\u02e2tem",
                        "\\\u02e2y\u02e2tem",
                        "\\\u02e2am",
                        "\\\u02e2ecurity"
                    ]
                },
                "selection_cli_hklm": {
                    "CommandLine|contains": [
                        "hklm",
                        "hk\u02eam",
                        "hkey_local_machine",
                        "hkey_\u02eaocal_machine",
                        "hkey_loca\u02ea_machine",
                        "hkey_\u02eaoca\u02ea_machine"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Dumping hives for legitimate purpouse i.e. backup or forensic investigation"
            ],
            "id": "fd877b94-9bb5-4191-bb25-d79cbd93c167",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/13",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "https://eqllib.readthedocs.io/en/latest/analytics/aed95fc6-5e3f-49dc-8b35-06508613f979.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003/T1003.md",
                "https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-1---registry-dump-of-sam-creds-and-secrets"
            ],
            "related": [
                {
                    "id": "038cd51c-3ad8-41c5-ba8f-5d1c92f3cc1e",
                    "type": "obsoletes"
                },
                {
                    "id": "4d6c9da1-318b-4edf-bcea-b6c93fa98fd0",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.005",
                "car.2013-07-001"
            ],
            "title": "Dumping of Sensitive Hives Via Reg.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/10",
            "description": "Detects a possible process memory dump that uses the white-listed Citrix TrolleyExpress.exe filename as a way to dump the lsass process memory",
            "detection": {
                "condition": "selection or ( renamed and not 1 of filter* )",
                "filter_empty": {
                    "OriginalFileName": null
                },
                "filter_renamed": {
                    "OriginalFileName|contains": "CtxInstall"
                },
                "renamed": {
                    "Image|endswith": "\\TrolleyExpress.exe"
                },
                "selection": {
                    "CommandLine|contains": [
                        "\\TrolleyExpress 7",
                        "\\TrolleyExpress 8",
                        "\\TrolleyExpress 9",
                        "\\TrolleyExpress.exe 7",
                        "\\TrolleyExpress.exe 8",
                        "\\TrolleyExpress.exe 9",
                        "\\TrolleyExpress.exe -ma "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "4c0aaedc-154c-4427-ada0-d80ef9c9deb6",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/05/13",
            "status": "test",
            "references": [
                "https://twitter.com/_xpn_/status/1491557187168178176",
                "https://www.youtube.com/watch?v=Ie831jF0bb0"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.011",
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Process Access via TrolleyExpress Exclusion"
        },
        {
            "author": "frack113",
            "date": "2021/12/20",
            "description": "Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using DelegateExecute key",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "CommandLine|contains|all": [
                        "reg",
                        "add",
                        "hkcu\\software\\classes\\ms-settings\\shell\\open\\command",
                        "/ve ",
                        "/d"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains|all": [
                        "reg",
                        "add",
                        "hkcu\\software\\classes\\ms-settings\\shell\\open\\command",
                        "/v",
                        "DelegateExecute"
                    ]
                },
                "selection_3": {
                    "CommandLine|contains|all": [
                        "reg",
                        "delete",
                        "hkcu\\software\\classes\\ms-settings"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dd3ee8cc-f751-41c9-ba53-5a32ed47e563",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/25",
            "references": [
                "https://thedfirreport.com/2021/12/13/diavol-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "Suspicious Reg Add Open Command"
        },
        {
            "author": "Austin Songer @austinsonger, Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2021/11/26",
            "description": "Detects when a user is potentially trying to bypass the Windows Defender AV by renaming a tool to dump64.exe and placing it in the Visual Studio folder.\nCurrently the rule is covering only usage of procdump but other utilities can be added in order to increase coverage.\n",
            "detection": {
                "condition": "selection_dump and 1 of selection_tools_*",
                "selection_dump": {
                    "Image|contains": "\\Microsoft Visual Studio\\",
                    "Image|endswith": "\\dump64.exe",
                    "Image|startswith": ":\\Program Files"
                },
                "selection_tools_procdump": [
                    {
                        "OriginalFileName": "procdump"
                    },
                    {
                        "CommandLine|contains": [
                            " -ma ",
                            " -mp "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "129966c9-de17-4334-a123-8b58172e664d",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/21",
            "references": [
                "https://twitter.com/mrd0x/status/1460597833917251595"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Potential Windows Defender AV Bypass Via Dump64.EXE Rename"
        },
        {
            "author": "Kirill Kiryanov, oscd.community",
            "date": "2020/10/08",
            "description": "Detects process dump via legitimate sqldumper.exe binary",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "0x0110",
                        "0x01100:40"
                    ],
                    "Image|endswith": "\\sqldumper.exe"
                }
            },
            "falsepositives": [
                "Legitimate MSSQL Server actions"
            ],
            "id": "23ceaf5c-b6f1-4a32-8559-f2ff734be516",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://twitter.com/countuponsec/status/910977826853068800",
                "https://twitter.com/countuponsec/status/910969424215232518",
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqldumper/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Dumping Process via Sqldumper.exe"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/24",
            "description": "Detects the use of Inveigh a cross-platform .NET IPv4/IPv6 machine-in-the-middle tool",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\Inveigh.exe"
                    },
                    {
                        "OriginalFileName": [
                            "\\Inveigh.exe",
                            "\\Inveigh.dll"
                        ]
                    },
                    {
                        "Description": "Inveigh"
                    },
                    {
                        "CommandLine|contains": [
                            " -SpooferIP",
                            " -ReplyToIPs ",
                            " -ReplyToDomains ",
                            " -ReplyToMACs ",
                            " -SnifferIP"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Very unlikely"
            ],
            "id": "b99a1518-1ad5-4f65-bc95-1ffff97a8fd0",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "references": [
                "https://github.com/Kevin-Robertson/Inveigh",
                "https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "HackTool - Inveigh Execution"
        },
        {
            "author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
            "date": "2019/10/22",
            "description": "Files with well-known filenames (sensitive files with credential data) copying",
            "detection": {
                "condition": "all of selection_esent_* or selection_susp_paths",
                "selection_esent_cli": {
                    "CommandLine|contains|windash": [
                        "vss",
                        " /m ",
                        " /y "
                    ]
                },
                "selection_esent_img": [
                    {
                        "Image|endswith": "\\esentutl.exe"
                    },
                    {
                        "OriginalFileName": "\\esentutl.exe"
                    }
                ],
                "selection_susp_paths": {
                    "CommandLine|contains": [
                        "\\config\\RegBack\\sam",
                        "\\config\\RegBack\\security",
                        "\\config\\RegBack\\system",
                        "\\config\\sam",
                        "\\config\\security",
                        "\\config\\system ",
                        "\\repair\\sam",
                        "\\repair\\security",
                        "\\repair\\system",
                        "\\windows\\ntds\\ntds.dit"
                    ]
                }
            },
            "falsepositives": [
                "Copying sensitive files for legitimate use (eg. backup) or forensic investigation by legitimate incident responder or forensic investigator."
            ],
            "id": "e7be6119-fc37-43f0-ad4f-1f3f99be2f9f",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/04",
            "references": [
                "https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/",
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "https://dfironthemountain.wordpress.com/2018/12/06/locked-file-access-using-esentutl-exe/",
                "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Esentutl.yml"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.003",
                "car.2013-07-001",
                "attack.s0404"
            ],
            "title": "Copying Sensitive Files with Credential Data"
        },
        {
            "author": "Teymur Kheirkhabarov, oscd.community",
            "date": "2019/11/01",
            "description": "Detects well-known credential dumping tools execution via specific named pipe creation",
            "detection": {
                "condition": "selection",
                "selection": {
                    "PipeName|contains": [
                        "\\cachedump",
                        "\\lsadump",
                        "\\wceservicepipe"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate Administrator using tool for password recovery"
            ],
            "id": "961d0ba2-3eea-4303-a930-2cf78bbfcc5e",
            "level": "critical",
            "logsource": {
                "category": "pipe_created",
                "product": "windows",
                "definition": "Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
            },
            "modified": "2023/08/07",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "https://image.slidesharecdn.com/zeronights2017kheirkhabarov-171118103000/75/hunting-for-credentials-dumping-in-windows-environment-57-2048.jpg?cb=1666035799"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.005"
            ],
            "title": "HackTool - Credential Dumping Tools Named Pipe Created"
        },
        {
            "author": "Florian Roth (Nextron Systems), David ANDRE (additional keywords)",
            "date": "2017/01/10",
            "description": "This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)",
            "detection": {
                "condition": "keywords and not filter",
                "filter": {
                    "EventID": 15
                },
                "keywords": [
                    "dpapi::masterkey",
                    "eo.oe.kiwi",
                    "event::clear",
                    "event::drop",
                    "gentilkiwi.com",
                    "kerberos::golden",
                    "kerberos::ptc",
                    "kerberos::ptt",
                    "kerberos::tgt",
                    "Kiwi Legit Printer",
                    "lsadump::",
                    "mimidrv.sys",
                    "\\mimilib.dll",
                    "misc::printnightmare",
                    "misc::shadowcopies",
                    "misc::skeleton",
                    "privilege::backup",
                    "privilege::debug",
                    "privilege::driver",
                    "sekurlsa::"
                ]
            },
            "falsepositives": [
                "Naughty administrators",
                "AV Signature updates",
                "Files with Mimikatz in their filename"
            ],
            "id": "06d71506-7beb-4f22-8888-e2e5e2ca7fd8",
            "level": "high",
            "logsource": {
                "product": "windows"
            },
            "modified": "2022/01/05",
            "references": [
                "https://tools.thehacker.recipes/mimikatz/modules"
            ],
            "status": "test",
            "tags": [
                "attack.s0002",
                "attack.lateral_movement",
                "attack.credential_access",
                "car.2013-07-001",
                "car.2019-04-004",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.001",
                "attack.t1003.006"
            ],
            "title": "Mimikatz Use"
        },
        {
            "author": "Markus Neis",
            "date": "2018/08/26",
            "description": "Detects Access to LSASS Process",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_begins": {
                    "ProcessName|startswith": [
                        "C:\\Windows\\System32\\DriverStore\\",
                        "C:\\WINDOWS\\Installer\\",
                        "C:\\Program Files\\",
                        "C:\\Program Files (x86)\\"
                    ]
                },
                "filter_exact": {
                    "ProcessName": [
                        "C:\\Windows\\System32\\atiesrxx.exe",
                        "C:\\Windows\\System32\\CompatTelRunner.exe",
                        "C:\\Windows\\System32\\msiexec.exe",
                        "C:\\Windows\\System32\\nvwmi64.exe",
                        "C:\\Windows\\System32\\svchost.exe",
                        "C:\\Windows\\System32\\Taskmgr.exe",
                        "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
                        "C:\\Windows\\SysWOW64\\msiexec.exe"
                    ]
                },
                "filter_thor": {
                    "ProcessName|endswith": [
                        "\\thor64.exe",
                        "\\thor.exe"
                    ],
                    "ProcessName|startswith": "C:\\Windows\\Temp\\asgard2-agent\\"
                },
                "selection": {
                    "EventID": 1121,
                    "Path|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Google Chrome GoogleUpdate.exe",
                "Some Taskmgr.exe related activity"
            ],
            "id": "a0a278fe-2c0e-4de2-ac3c-c68b08a9ba98",
            "level": "high",
            "logsource": {
                "definition": "Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)",
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2022/08/13",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "LSASS Access Detected via Attack Surface Reduction"
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)",
            "date": "2020/10/20",
            "description": "Detects volume shadow copy mount via Windows event log",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DeviceName|contains": "HarddiskVolumeShadowCopy",
                    "EventID": 98,
                    "Provider_Name": "Microsoft-Windows-Ntfs"
                }
            },
            "falsepositives": [
                "Legitimate use of volume shadow copy mounts (backups maybe)."
            ],
            "id": "f512acbf-e662-4903-843e-97ce4652b740",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "Volume Shadow Copy Mount"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/05/15",
            "description": "Detects events from the Kernel-General ETW indicating that the access bits of a hive with a system like hive name located in the temp directory have been reset.\nThis occurs when an application tries to access a hive and the hive has not be recognized since the last 7 days (by default).\nRegistry hive dumping utilities such as QuarksPwDump were seen emitting this behavior.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 16,
                    "HiveName|contains": [
                        "\\Temp\\SAM",
                        "\\Temp\\SECURITY"
                    ],
                    "Provider_Name": "Microsoft-Windows-Kernel-General"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "39f919f3-980b-4e6f-a975-8af7e507ef2b",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2024/01/18",
            "references": [
                "https://github.com/nasbench/Misc-Research/blob/b20da2336de0f342d31ef4794959d28c8d3ba5ba/ETW/Microsoft-Windows-Kernel-General.md"
            ],
            "related": [
                {
                    "id": "839dd1e8-eda8-4834-8145-01beeee33acd",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "Critical Hive In Suspicious Location Access Bits Cleared"
        },
        {
            "author": "Florian Roth (Nextron Systems), Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
            "date": "2017/03/05",
            "description": "Detects well-known credential dumping tools execution via service execution events",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7045,
                    "ImagePath|contains": [
                        "cachedump",
                        "dumpsvc",
                        "fgexec",
                        "gsecdump",
                        "mimidrv",
                        "pwdump",
                        "servpw"
                    ],
                    "Provider_Name": "Service Control Manager"
                }
            },
            "falsepositives": [
                "Legitimate Administrator using credential dumping tool for password recovery"
            ],
            "id": "4976aa50-8f41-45c6-8b15-ab3fc10e79ed",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2022/11/29",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.execution",
                "attack.t1003.001",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.005",
                "attack.t1003.006",
                "attack.t1569.002",
                "attack.s0005"
            ],
            "title": "Credential Dumping Tools Service Execution - System"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/14",
            "description": "Detects potential abuse of ntdsutil to dump ntds.dit database",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Data|contains": "ntds.dit",
                    "EventID": [
                        216,
                        325,
                        326,
                        327
                    ],
                    "Provider_Name": "ESENT"
                }
            },
            "falsepositives": [
                "Legitimate backup operation/creating shadow copies"
            ],
            "id": "e6e88853-5f20-4c4a-8d26-cd469fd8d31f",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "references": [
                "https://twitter.com/mgreen27/status/1558223256704122882",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj574207(v=ws.11)"
            ],
            "status": "test",
            "title": "Ntdsutil Abuse",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/12/07",
            "description": "Detects Windows error reporting event where the process that crashed is lsass. This could be the cause of an intentional crash by techniques such as Lsass-Shtinkering to dump credential",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AppName": "lsass.exe",
                    "EventID": 1000,
                    "ExceptionCode": "c0000001",
                    "Provider_Name": "Application Error"
                }
            },
            "falsepositives": [
                "Rare legitimate crashing of the lsass process"
            ],
            "id": "a18e0862-127b-43ca-be12-1a542c75c7c5",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "references": [
                "https://github.com/deepinstinct/Lsass-Shtinkering",
                "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf",
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-erref/596a1078-e883-4972-9bbc-49e60bebca55"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Potential Credential Dumping Via WER - Application"
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g",
            "date": "2019/08/10",
            "description": "Detects anyone attempting a backup for the DPAPI Master Key. This events gets generated at the source and not the Domain Controller.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4692
                }
            },
            "falsepositives": [
                "If a computer is a member of a domain, DPAPI has a backup mechanism to allow unprotection of the data. Which will trigger this event."
            ],
            "fields": [
                "ComputerName",
                "SubjectDomainName",
                "SubjectUserName"
            ],
            "id": "39a94fd1-8c9a-4ff6-bf22-c058762f8014",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/03/15",
            "status": "test",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html"
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1003.004"
            ],
            "title": "DPAPI Domain Master Key Backup Attempt"
        },
        {
            "id": "910ab938-668b-401b-b08c-b596e80fdca5",
            "author": "Teymur Kheirkhabarov, oscd.community",
            "date": "2019/10/22",
            "description": "Transferring files with well-known filenames (sensitive files with credential data) using network shares",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5145,
                    "RelativeTargetName|contains": [
                        "\\mimidrv",
                        "\\lsass",
                        "\\windows\\minidump\\",
                        "\\hiberfil",
                        "\\sqldmpr",
                        "\\sam",
                        "\\ntds.dit",
                        "\\security"
                    ]
                }
            },
            "falsepositives": [
                "Transferring sensitive files for legitimate administration work by legitimate administrator"
            ],
            "level": "medium",
            "modified": "2021/11/30",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "2e69f167-47b5-4ae7-a390-47764529eff5"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.001",
                "attack.t1003.003"
            ],
            "title": "Transferring Files with Credential Data via Network Shares"
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/06/14",
            "description": "Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4656,
                        4658,
                        4660,
                        4663
                    ],
                    "ObjectName|endswith": "\\wceaux.dll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1de68c67-af5c-4097-9c85-fe5578e09e67",
            "level": "critical",
            "modified": "2021/11/27",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
                "https://jpcertcc.github.io/ToolAnalysisResultSheet"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.s0005"
            ],
            "title": "WCE wceaux.dll Access"
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g",
            "date": "2019/06/20",
            "description": "Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AccessMask": "0x2",
                    "EventID": 4662,
                    "ObjectName|contains": "BCKUPKEY",
                    "ObjectType": "SecretObject"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4ac1f50b-3bd0-4968-902d-868b4647937e",
            "level": "high",
            "modified": "2022/02/24",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "status": "test",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html"
            ],
            "title": "DPAPI Domain Backup Key Extraction",
            "tags": [
                "attack.credential_access",
                "attack.t1003.004"
            ]
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)",
            "date": "2020/10/20",
            "description": "Detects the registration of the security event source VSSAudit. It would usually trigger when volume shadow copy operations happen.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AuditSourceName": "VSSAudit",
                    "EventID": [
                        4904,
                        4905
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of VSSVC. Maybe backup operations. It would usually be done by C:\\Windows\\System32\\VSSVC.exe."
            ],
            "id": "e9faba72-4974-4ab2-a4c5-46e25ad59e9b",
            "level": "informational",
            "modified": "2022/04/28",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "VSSAudit Security Event Source Registration"
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g",
            "date": "2019/07/26",
            "description": "Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.",
            "detection": {
                "condition": "selection and not filter",
                "filter": [
                    {
                        "SubjectUserName|endswith": "$"
                    },
                    {
                        "SubjectUserName|startswith": "MSOL_"
                    }
                ],
                "selection": {
                    "AccessMask": "0x100",
                    "EventID": 4662,
                    "Properties|contains": [
                        "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
                        "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
                        "89e95b76-444d-4c62-991a-0facbeda640c"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ComputerName",
                "SubjectDomainName",
                "SubjectUserName"
            ],
            "id": "17d619c1-e020-4347-957e-1d1207455c93",
            "level": "critical",
            "modified": "2021/11/27",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "status": "test",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/180815-ADObjectAccessReplication/notebook.html",
                "https://threathunterplaybook.com/library/windows/active_directory_replication.html",
                "https://threathunterplaybook.com/hunts/windows/190101-ADModDirectoryReplication/notebook.html"
            ],
            "tags": [
                "attack.credential_access",
                "attack.t1003.006"
            ],
            "title": "Active Directory Replication from Non Machine Account"
        },
        {
            "author": "sigma",
            "date": "2017/02/12",
            "description": "Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AccessMask": "0x705",
                    "EventID": 4656,
                    "ObjectType": "SAM_DOMAIN",
                    "ProcessName|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c",
            "level": "high",
            "modified": "2022/10/09",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://twitter.com/jackcr/status/807385668833968128"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Password Dumper Activity on LSASS"
        },
        {
            "author": "Florian Roth (Nextron Systems), Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
            "date": "2017/03/05",
            "description": "Detects well-known credential dumping tools execution via service execution events",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4697,
                    "ServiceFileName|contains": [
                        "cachedump",
                        "dumpsvc",
                        "fgexec",
                        "gsecdump",
                        "mimidrv",
                        "pwdump",
                        "servpw"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate Administrator using credential dumping tool for password recovery"
            ],
            "id": "f0d1feba-4344-4ca9-8121-a6c97bd6df52",
            "level": "high",
            "logsource": {
                "definition": "The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/11/29",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "4976aa50-8f41-45c6-8b15-ab3fc10e79ed"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.execution",
                "attack.t1003.001",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.005",
                "attack.t1003.006",
                "attack.t1569.002",
                "attack.s0005"
            ],
            "title": "Credential Dumping Tools Service Execution - Security"
        },
        {
            "author": "Samir Bousseaden, wagga",
            "date": "2019/04/03",
            "description": "Detect AD credential dumping using impacket secretdump HKTL",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5145,
                    "RelativeTargetName|contains|all": [
                        "SYSTEM32\\",
                        ".tmp"
                    ],
                    "ShareName": "\\\\\\\\\\*\\\\ADMIN$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "252902e3-5830-4cf6-bf21-c22083dfd5cf",
            "level": "high",
            "logsource": {
                "definition": "The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/08/11",
            "references": [
                "https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002",
                "attack.t1003.004",
                "attack.t1003.003"
            ],
            "title": "Possible Impacket SecretDump Remote Activity"
        },
        {
            "author": "Benjamin Delpy, Florian Roth (Nextron Systems), Scott Dermott, Sorina Ionescu",
            "date": "2018/06/03",
            "description": "Detects Mimikatz DC sync security events",
            "detection": {
                "condition": "selection and not 1 of filter*",
                "filter1": {
                    "SubjectDomainName": "Window Manager"
                },
                "filter2": {
                    "SubjectUserName|startswith": [
                        "NT AUT",
                        "MSOL_"
                    ]
                },
                "filter3": {
                    "SubjectUserName|endswith": "$"
                },
                "selection": {
                    "AccessMask": "0x100",
                    "EventID": 4662,
                    "Properties|contains": [
                        "Replicating Directory Changes All",
                        "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
                        "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
                        "9923a32a-3607-11d2-b9be-0000f87a36b2",
                        "89e95b76-444d-4c62-991a-0facbeda640c"
                    ]
                }
            },
            "falsepositives": [
                "Valid DC Sync that is not covered by the filters; please report",
                "Local Domain Admin account used for Azure AD Connect"
            ],
            "id": "611eab06-a145-4dfa-a295-3ccc5c20f59a",
            "level": "high",
            "modified": "2022/04/26",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://twitter.com/gentilkiwi/status/1003236624925413376",
                "https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2",
                "https://blog.blacklanternsecurity.com/p/detecting-dcsync?s=r",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.s0002",
                "attack.t1003.006"
            ],
            "title": "Mimikatz DC Sync"
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g",
            "date": "2019/06/20",
            "description": "Detects potential mimikatz-like tools accessing LSASS from non system account",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "ProcessName|contains": [
                        ":\\Program Files\\",
                        ":\\Program Files (x86)\\"
                    ]
                },
                "filter_main_service_account": {
                    "SubjectUserName|endswith": "$"
                },
                "filter_main_wmiprvse": {
                    "AccessMask": "0x1410",
                    "ProcessName": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"
                },
                "filter_optional_steam": {
                    "ProcessName|contains": "\\SteamLibrary\\steamapps\\"
                },
                "selection": {
                    "AccessMask": [
                        "0x100000",
                        "0x1010",
                        "0x1400",
                        "0x1410",
                        "0x1418",
                        "0x1438",
                        "0x143a",
                        "0x1f0fff",
                        "0x1f1fff",
                        "0x1f2fff",
                        "0x1f3fff",
                        "0x40",
                        "143a",
                        "1f0fff",
                        "1f1fff",
                        "1f2fff",
                        "1f3fff"
                    ],
                    "EventID": [
                        4663,
                        4656
                    ],
                    "ObjectName|endswith": "\\lsass.exe",
                    "ObjectType": "Process"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "962fe167-e48d-4fd6-9974-11e5b9a5d6d1",
            "level": "medium",
            "modified": "2023/12/11",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://threathunterplaybook.com/hunts/windows/170105-LSASSMemoryReadAccess/notebook.html"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "LSASS Access From Non System Account"
        },
        {
            "author": "Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)",
            "date": "2019/11/01",
            "description": "Detects process handle on LSASS process with certain access mask",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_aurora": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|contains": ":\\Windows\\Temp\\asgard2-agent-sc\\aurora\\",
                    "ProcessName|endswith": "\\aurora-agent-64.exe"
                },
                "filter_main_avira1": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|contains|all": [
                        ":\\Users\\",
                        "\\AppData\\Local\\Temp\\is-"
                    ],
                    "ProcessName|endswith": "\\avira_system_speedup.tmp"
                },
                "filter_main_avira2": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|contains": ":\\Windows\\Temp\\",
                    "ProcessName|endswith": "\\avira_speedup_setup_update.tmp"
                },
                "filter_main_exact": {
                    "ProcessName|endswith": [
                        ":\\Windows\\System32\\taskhostw.exe",
                        ":\\Windows\\System32\\msiexec.exe",
                        ":\\Windows\\CCM\\CcmExec.exe"
                    ]
                },
                "filter_main_generic": {
                    "ProcessName|contains": ":\\Program Files"
                },
                "filter_main_googleupdate": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|contains": ":\\Windows\\SystemTemp\\",
                    "ProcessName|endswith": "\\GoogleUpdate.exe"
                },
                "filter_main_scenarioengine": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|endswith": "\\x64\\SCENARIOENGINE.EXE"
                },
                "filter_main_snmp": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|endswith": ":\\Windows\\System32\\snmp.exe"
                },
                "filter_main_specific": {
                    "ProcessName|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                        ":\\Windows\\SysNative\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWow64\\",
                        ":\\Windows\\Temp\\asgard2-agent\\"
                    ],
                    "ProcessName|endswith": [
                        "\\csrss.exe",
                        "\\GamingServices.exe",
                        "\\lsm.exe",
                        "\\MicrosoftEdgeUpdate.exe",
                        "\\minionhost.exe",
                        "\\MRT.exe",
                        "\\MsMpEng.exe",
                        "\\perfmon.exe",
                        "\\procexp.exe",
                        "\\procexp64.exe",
                        "\\svchost.exe",
                        "\\taskmgr.exe",
                        "\\thor.exe",
                        "\\thor64.exe",
                        "\\vmtoolsd.exe",
                        "\\VsTskMgr.exe",
                        "\\wininit.exe",
                        "\\wmiprvse.exe",
                        "RtkAudUService64"
                    ]
                },
                "filter_main_sysmon": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|endswith": ":\\Windows\\Sysmon64.exe"
                },
                "filter_optional_procmon": {
                    "AccessList|contains": "%%4484",
                    "ProcessName|endswith": [
                        "\\procmon64.exe",
                        "\\procmon.exe"
                    ]
                },
                "selection_1": {
                    "AccessMask|contains": [
                        "0x40",
                        "0x1400",
                        "0x100000",
                        "0x1410",
                        "0x1010",
                        "0x1438",
                        "0x143a",
                        "0x1418",
                        "0x1f0fff",
                        "0x1f1fff",
                        "0x1f2fff",
                        "0x1f3fff"
                    ],
                    "EventID": 4656,
                    "ObjectName|endswith": "\\lsass.exe"
                },
                "selection_2": {
                    "AccessList|contains": [
                        "4484",
                        "4416"
                    ],
                    "EventID": 4663,
                    "ObjectName|endswith": "\\lsass.exe"
                }
            },
            "falsepositives": [
                "Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it"
            ],
            "id": "4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76",
            "level": "medium",
            "modified": "2023/12/19",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "status": "experimental",
            "references": [
                "https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html",
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
            ],
            "tags": [
                "attack.credential_access",
                "car.2019-04-004",
                "attack.t1003.001"
            ],
            "title": "Potentially Suspicious AccessMask Requested From LSASS"
        },
        {
            "author": "Christian Burkard (Nextron Systems), Florian Roth (Nextron Systems)",
            "date": "2023/04/27",
            "description": "Detects the execution of the hacktool Rubeus using specific command line flags",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "asreproast ",
                        "dump /service:krbtgt ",
                        "dump /luid:0x",
                        "kerberoast ",
                        "createnetonly /program:",
                        "ptt /ticket:",
                        "/impersonateuser:",
                        "renew /ticket:",
                        "asktgt /user:",
                        "harvest /interval:",
                        "s4u /user:",
                        "s4u /ticket:",
                        "hash /password:",
                        "golden /aes256:",
                        "silver /user:"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "3245cd30-e015-40ff-a31d-5cadd5f377ec",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://blog.harmj0y.net/redteaming/from-kekeo-to-rubeus",
                "https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html",
                "https://github.com/GhostPack/Rubeus"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "7ec2c172-dceb-4c10-92c9-87c1881b7e18"
                }
            ],
            "status": "test",
            "title": "HackTool - Rubeus Execution - ScriptBlock",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1558.003",
                "attack.lateral_movement",
                "attack.t1550.003"
            ]
        },
        {
            "author": "Tim Rauch, Elastic (idea)",
            "date": "2022/09/28",
            "description": "Detects Invoke-Mimikatz PowerShell script and alike. Mimikatz is a credential dumper capable of obtaining plaintext Windows account logins and passwords.",
            "detection": {
                "condition": "1 of selection*",
                "selection_1": {
                    "ScriptBlockText|contains|all": [
                        "DumpCreds",
                        "DumpCerts"
                    ]
                },
                "selection_2": {
                    "ScriptBlockText|contains": "sekurlsa::logonpasswords"
                },
                "selection_3": {
                    "ScriptBlockText|contains|all": [
                        "crypto::certificates",
                        "CERT_SYSTEM_STORE_LOCAL_MACHINE"
                    ]
                }
            },
            "falsepositives": [
                "Mimikatz can be useful for testing the security of networks"
            ],
            "id": "189e3b02-82b2-4b90-9662-411eb64486d4",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows"
            },
            "references": [
                "https://www.elastic.co/guide/en/security/current/potential-invoke-mimikatz-powershell-script.html#potential-invoke-mimikatz-powershell-script"
            ],
            "status": "test",
            "title": "Potential Invoke-Mimikatz PowerShell Script",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ]
        },
        {
            "author": "Max Altgelt (Nextron Systems)",
            "date": "2021/09/21",
            "description": "Detects usage of a PowerShell command to dump the live memory of a Windows machine",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Get-StorageDiagnosticInfo",
                        "-IncludeLiveDump"
                    ]
                }
            },
            "falsepositives": [
                "Diagnostics"
            ],
            "id": "cd185561-4760-45d6-a63e-a51325112cae",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://learn.microsoft.com/en-us/powershell/module/storage/get-storagediagnosticinfo?view=windowsserver2022-ps"
            ],
            "status": "test",
            "tags": [
                "attack.t1003"
            ],
            "title": "Live Memory Dump Using Powershell"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/04/23",
            "description": "Detects a Get-Process command on lsass process, which is in almost all cases a sign of malicious activity",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": "Get-Process lsass"
                }
            },
            "falsepositives": [
                "Legitimate certificate exports invoked by administrators or users (depends on processes in the environment - filter if unusable)"
            ],
            "id": "84c174ab-d3ef-481f-9c86-a50d0b8e3edb",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://twitter.com/PythonResponder/status/1385064506049630211"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "PowerShell Get-Process LSASS in ScriptBlock"
        },
        {
            "author": "frack113",
            "date": "2022/02/06",
            "description": "The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory.\nThese include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Get-ADReplAccount",
                        "-All ",
                        "-Server "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "060c3ef1-fd0a-4091-bf46-e7d625f60b73",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://www.powershellgallery.com/packages/DSInternals",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.006/T1003.006.md#atomic-test-2---run-dsinternals-get-adreplaccount"
            ],
            "status": "test",
            "title": "Suspicious Get-ADReplAccount",
            "tags": [
                "attack.credential_access",
                "attack.t1003.006"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/12",
            "description": "Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Win32_ShadowCopy",
                        ").Create(",
                        "ClientAccessible"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "afd12fed-b0ec-45c9-a13d-aa86625dac81",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://attack.mitre.org/datasources/DS0005/",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1&viewFallbackFrom=powershell-7"
            ],
            "status": "test",
            "title": "Create Volume Shadow Copy with Powershell",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/16",
            "description": "Detects suspicious invocation of the Get-ADDBAccount script that reads from a ntds.dit file and may be used to get access to credentials without using any credential dumpers",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Payload|contains|all": [
                        "Get-ADDBAccount",
                        "BootKey ",
                        "DatabasePath "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b140afd9-474b-4072-958e-2ebb435abd68",
            "level": "high",
            "logsource": {
                "category": "ps_module",
                "product": "windows",
                "definition": "0ad03ef1-f21b-4a79-8ce8-e6900c54b65b"
            },
            "references": [
                "https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/",
                "https://github.com/MichaelGrafnetter/DSInternals/blob/7ba59c12ee9a1cb430d7dc186a3366842dd612c8/Documentation/PowerShell/Get-ADDBAccount.md"
            ],
            "status": "test",
            "title": "Suspicious Get-ADDBAccount Usage",
            "tags": [
                "attack.credential_access",
                "attack.t1003.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/02/26",
            "description": "Detects changes to the Registry in which a monitor program gets registered to dump the memory of the lsass.exe process",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\lsass.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "55e29995-75e7-451a-bef0-6225e2f13597",
            "level": "critical",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2022/12/19",
            "references": [
                "https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/",
                "https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/"
            ],
            "related": [
                {
                    "id": "36803969-5421-41ec-b92f-8500f79c23b0",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Potential Credential Dumping Via LSASS SilentProcessExit Technique"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/10/20",
            "description": "Detects the volume shadow copy service initialization and processing via esentutl. Registry keys such as HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\VSS\\\\Diag\\\\VolSnap\\\\Volume are captured.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "TargetObject|contains": "System\\CurrentControlSet\\Services\\VSS\\Start"
                },
                "selection": {
                    "Image|endswith": "esentutl.exe",
                    "TargetObject|contains": "System\\CurrentControlSet\\Services\\VSS"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5aad0995-46ab-41bd-a9ff-724f41114971",
            "level": "high",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.002"
            ],
            "title": "Esentutl Volume Shadow Copy Service Keys"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/12/31",
            "description": "Detects the use of Windows Credential Editor (WCE)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "Services\\WCESERVICE\\Start"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a6b33c02-8305-488f-8585-03cb2a7763f2",
            "level": "critical",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://www.ampliasecurity.com/research/windows-credentials-editor/"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001",
                "attack.s0005"
            ],
            "title": "Windows Credential Editor Registry"
        },
        {
            "author": "@pbssubhash",
            "date": "2022/12/08",
            "description": "Detects the setting of the \"DumpType\" registry value to \"2\" which stands for a \"Full Dump\". Technique such as LSASS Shtinkering requires this value to be \"2\" in order to dump LSASS.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000002)",
                    "TargetObject|contains": [
                        "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\LocalDumps\\DumpType",
                        "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\LocalDumps\\lsass.exe\\DumpType"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate application that needs to do a full dump of their process"
            ],
            "id": "33efc23c-6ea2-4503-8cfe-bdf82ce8f719",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/deepinstinct/Lsass-Shtinkering",
                "https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps",
                "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003.001"
            ],
            "title": "Lsass Full Dump Request Via DumpType Registry Settings"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/23",
            "description": "Detects the registration of a new ODBC driver where the driver is located in a potentially suspicious location",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|contains": [
                        ":\\PerfLogs\\",
                        ":\\ProgramData\\",
                        ":\\Temp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Registration\\CRMLog",
                        ":\\Windows\\System32\\com\\dmp\\",
                        ":\\Windows\\System32\\FxsTmp\\",
                        ":\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\",
                        ":\\Windows\\System32\\spool\\drivers\\color\\",
                        ":\\Windows\\System32\\spool\\PRINTERS\\",
                        ":\\Windows\\System32\\spool\\SERVERS\\",
                        ":\\Windows\\System32\\Tasks_Migrated\\",
                        ":\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                        ":\\Windows\\SysWOW64\\com\\dmp\\",
                        ":\\Windows\\SysWOW64\\FxsTmp\\",
                        ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\",
                        ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        ":\\Windows\\Tracing\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\"
                    ],
                    "TargetObject|contains": "\\SOFTWARE\\ODBC\\ODBCINST.INI\\",
                    "TargetObject|endswith": [
                        "\\Driver",
                        "\\Setup"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "e4d22291-f3d5-4b78-9a0c-a1fbaf32a6a4",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1003"
            ],
            "title": "Potentially Suspicious ODBC Driver Registered"
        },
        {
            "id": "0442defa-b4a2-41c9-ae2c-ea7042fc4701",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/23",
            "description": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it",
            "detection": {
                "condition": "selection and not 1 of filter*",
                "filter": {
                    "TargetObject|contains": [
                        "\\System\\CurrentControlSet\\Services\\WebClient\\NetworkProvider",
                        "\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\NetworkProvider",
                        "\\System\\CurrentControlSet\\Services\\RDPNP\\NetworkProvider"
                    ]
                },
                "filter_valid_procs": {
                    "Image": "C:\\Windows\\System32\\poqexec.exe"
                },
                "selection": {
                    "TargetObject|contains|all": [
                        "\\System\\CurrentControlSet\\Services\\",
                        "\\NetworkProvider"
                    ]
                }
            },
            "falsepositives": [
                "Other legitimate network providers used and not filtred in this rule"
            ],
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade",
                "https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "baef1ec6-2ca9-47a3-97cc-4cf2bda10b77"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003"
            ],
            "title": "Potential Credential Dumping Attempt Using New NetworkProvider - REG"
        },
        {
            "author": "Pawel Mazur",
            "date": "2021/05/24",
            "description": "Detect attempt to enable auditing of TTY input",
            "detection": {
                "condition": "1 of selection_*",
                "selection_path_events": {
                    "name": [
                        "/etc/pam.d/system-auth",
                        "/etc/pam.d/password-auth"
                    ],
                    "type": "PATH"
                },
                "selection_tty_events": {
                    "type": [
                        "TTY",
                        "USER_TTY"
                    ]
                }
            },
            "falsepositives": [
                "Administrative work"
            ],
            "id": "49aae26c-450e-448b-911d-b3c13d178dfc",
            "level": "high",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/12/18",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.001/T1056.001.md",
                "https://linux.die.net/man/8/pam_tty_audit",
                "https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-configuring_pam_for_auditing",
                "https://access.redhat.com/articles/4409591#audit-record-types-2"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1003",
                "attack.t1056.001"
            ],
            "title": "Linux Keylogging with Pam.d"
        }
    ],
    "x_mitre_platforms": [
        "Windows",
        "Linux",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Vincent Le Toux",
        "Ed Williams, Trustwave, SpiderLabs",
        "Tim (Wadhwa-)Brown",
        "Yves Yonan"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "credential-access"
        }
    ],
    "x_mitre_detection": "### Windows\nMonitor for unexpected processes interacting with lsass.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as [Mimikatz](https://attack.mitre.org/software/S0002) access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective [Process Injection](https://attack.mitre.org/techniques/T1055) to reduce potential indicators of malicious activity.\n\nHash dumpers open the Security Accounts Manager (SAM) on the local file system (%SystemRoot%/system32/config/SAM) or create a dump of the Registry SAM key to access stored account password hashes. Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well. \n\nOn Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.\n\nMonitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like [Mimikatz](https://attack.mitre.org/software/S0002). [PowerShell](https://attack.mitre.org/techniques/T1059/001) scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module, (Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nMonitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync. (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers may not log replication requests originating from the default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Also monitor for network protocols  (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft NRPC Dec 2017) and other replication requests (Citation: Microsoft SAMR) from IPs not associated with known domain controllers. (Citation: AdSecurity DCSync Sept 2015)\n\n### Linux\nTo obtain the passwords and hashes stored in memory, processes must open a maps file in the `/proc` filesystem for the process being analyzed. This file is stored under the path `/proc/<pid>/maps`, where the `<pid>` directory is the unique pid of the program being interrogated for such authentication data. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Process: Process Creation",
        "Network Traffic: Network Traffic Flow",
        "File: File Creation",
        "Windows Registry: Windows Registry Key Access",
        "Process: OS API Execution",
        "File: File Access",
        "Process: Process Access",
        "Command: Command Execution",
        "Active Directory: Active Directory Object Access"
    ],
    "x_mitre_permissions_required": []
}