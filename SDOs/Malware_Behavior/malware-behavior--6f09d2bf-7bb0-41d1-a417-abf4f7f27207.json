{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6f09d2bf-7bb0-41d1-a417-abf4f7f27207",
    "created": "2024-08-13T14:46:36.957054Z",
    "modified": "2024-08-13T14:46:45.100194Z",
    "name": "Exfiltration Over Web Service",
    "description": "Adversaries may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel. Popular Web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise. Firewall rules may also already exist to permit traffic to these services.Web service providers also commonly use SSL/TLS encryption, giving adversaries an added level of protection.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1567",
            "external_id": "T1567"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1567",
            "external_id": "T1567"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Janantha Marasinghe",
            "date": "2022/10/18",
            "description": "Detects the use of rclone, a command-line program to manage files on cloud storage, via its default user-agent string",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-useragent|startswith": "rclone/v"
                }
            },
            "falsepositives": [
                "Valid requests with this exact user agent to that is used by legitimate scripts or sysadmin operations"
            ],
            "fields": [
                "c-ip"
            ],
            "id": "2c03648b-e081-41a5-b9fb-7d854a915091",
            "level": "medium",
            "logsource": {
                "category": "proxy"
            },
            "references": [
                "https://rclone.org/",
                "https://www.kroll.com/en/insights/publications/cyber/new-m365-business-email-compromise-attacks-with-rclone"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "Rclone Activity via Proxy"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/10/24",
            "description": "Detects suspicious DNS queries to Monero mining pools",
            "detection": {
                "condition": "selection",
                "selection": {
                    "query|contains": [
                        "pool.minexmr.com",
                        "fr.minexmr.com",
                        "de.minexmr.com",
                        "sg.minexmr.com",
                        "ca.minexmr.com",
                        "us-west.minexmr.com",
                        "pool.supportxmr.com",
                        "mine.c3pool.com",
                        "xmr-eu1.nanopool.org",
                        "xmr-eu2.nanopool.org",
                        "xmr-us-east1.nanopool.org",
                        "xmr-us-west1.nanopool.org",
                        "xmr-asia1.nanopool.org",
                        "xmr-jp1.nanopool.org",
                        "xmr-au1.nanopool.org",
                        "xmr.2miners.com",
                        "xmr.hashcity.org",
                        "xmr.f2pool.com",
                        "xmrpool.eu",
                        "pool.hashvault.pro"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate crypto coin mining"
            ],
            "id": "b593fd50-7335-4682-a36c-4edcb68e4641",
            "level": "high",
            "logsource": {
                "category": "dns"
            },
            "references": [
                "https://www.nextron-systems.com/2021/10/24/monero-mining-pool-fqdns/"
            ],
            "status": "stable",
            "tags": [
                "attack.impact",
                "attack.t1496",
                "attack.t1567"
            ],
            "title": "Monero Crypto Coin Mining Pool Lookup"
        },
        {
            "author": "pH-T (Nextron Systems)",
            "date": "2022/07/15",
            "description": "Detects DNS queries for \"anonfiles.com\", which is an anonymous file upload platform often used for malicious purposes",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": ".anonfiles.com"
                }
            },
            "falsepositives": [
                "Rare legitimate access to anonfiles.com"
            ],
            "id": "065cceea-77ec-4030-9052-fc0affea7110",
            "level": "high",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/01/16",
            "references": [
                "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"
            ],
            "related": [
                {
                    "id": "29f171d7-aa47-42c7-9c7b-3c87938164d9",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query for Anonfiles.com Domain - Sysmon"
        },
        {
            "author": "yatinwad, TheDFIRReport",
            "date": "2022/06/23",
            "description": "Detects DNS queries to \"ufile.io\", which was seen abused by malware and threat actors as a method for data exfiltration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": "ufile.io"
                }
            },
            "falsepositives": [
                "DNS queries for \"ufile\" are not malicious by nature necessarily. Investigate the source to determine the necessary actions to take"
            ],
            "id": "1cbbeaaf-3c8c-4e4c-9d72-49485b6a176b",
            "level": "low",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://thedfirreport.com/2021/12/13/diavol-ransomware/"
            ],
            "related": [
                {
                    "id": "090ffaad-c01a-4879-850c-6d57da98452d",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To Ufile.io"
        },
        {
            "author": "Aaron Greetham (@beardofbinary) - NCC Group",
            "date": "2021/05/26",
            "description": "Detects DNS queries for subdomains related to MEGA sharing website",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": "userstorage.mega.co.nz"
                }
            },
            "falsepositives": [
                "Legitimate DNS queries and usage of Mega"
            ],
            "id": "613c03ba-0779-4a53-8a1f-47f914a4ded3",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/09/18",
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
            ],
            "related": [
                {
                    "id": "66474410-b883-415f-9f8d-75345a0a66a6",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To MEGA Hosting Website"
        },
        {
            "author": "Kamran Saifullah, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/05/27",
            "description": "Detects network connections to Cloudflared tunnels domains initiated by a process on the system.\nAttackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        ".v2.argotunnel.com",
                        "protocol-v2.argotunnel.com",
                        "trycloudflare.com",
                        "update.argotunnel.com"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of cloudflare tunnels will also trigger this."
            ],
            "id": "7cd1dcdc-6edf-4896-86dc-d1f19ad64903",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://defr0ggy.github.io/research/Abusing-Cloudflared-A-Proxy-Service-To-Host-Share-Applications/",
                "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/",
                "Internal Research"
            ],
            "related": [
                {
                    "id": "a1d9eec5-33b2-4177-8d24-27fe754d0812",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To Cloudflared Tunnels Domains"
        },
        {
            "author": "Kamran Saifullah",
            "date": "2023/11/20",
            "description": "Detects network connections to Visual Studio Code tunnel domains initiated by a process on a system. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": ".tunnels.api.visualstudio.com",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of Visual Studio Code tunnel will also trigger this."
            ],
            "id": "4b657234-038e-4ad5-997c-4be42340bce4",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://ipfyx.fr/post/visual-studio-code-tunnel/",
                "https://badoption.eu/blog/2023/01/31/code_c2.html",
                "https://cydefops.com/vscode-data-exfiltration"
            ],
            "related": [
                {
                    "id": "9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4",
                    "type": "similar"
                },
                {
                    "id": "b3e6418f-7c7a-4fad-993a-93b65027a9f1",
                    "type": "similar"
                },
                {
                    "id": "1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To Visual Studio Code Tunnels Domain"
        },
        {
            "id": "9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4",
            "author": "Kamran Saifullah",
            "date": "2023/11/20",
            "description": "Detects network connections to Devtunnels domains initiated by a process on a system. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": ".devtunnels.ms",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of Devtunnels will also trigger this."
            ],
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://blueteamops.medium.com/detecting-dev-tunnels-16f0994dc3e2",
                "https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/security",
                "https://cydefops.com/devtunnels-unleashed"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "4b657234-038e-4ad5-997c-4be42340bce4"
                },
                {
                    "id": "b3e6418f-7c7a-4fad-993a-93b65027a9f1",
                    "type": "similar"
                },
                {
                    "id": "1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To DevTunnels Domain"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/07/16",
            "description": "Detects an executable initiating a network connection to \"ngrok\" domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        ".ngrok-free.app",
                        ".ngrok-free.dev",
                        ".ngrok.app",
                        ".ngrok.dev",
                        ".ngrok.io"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of the ngrok service."
            ],
            "id": "18249279-932f-45e2-b37a-8925f2597670",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2023/11/17",
            "references": [
                "https://ngrok.com/",
                "https://ngrok.com/blog-post/new-ngrok-domains",
                "https://www.virustotal.com/gui/file/cca0c1182ac114b44dc52dd2058fcd38611c20bb6b5ad84710681d38212f835a/",
                "https://www.rnbo.gov.ua/files/2023_YEAR/CYBERCENTER/november/APT29%20attacks%20Embassies%20using%20CVE-2023-38831%20-%20report%20en.pdf"
            ],
            "related": [
                {
                    "id": "1d08ac94-400d-4469-a82f-daee9a908849",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Process Initiated Network  Connection To Ngrok Domain"
        },
        {
            "id": "1d08ac94-400d-4469-a82f-daee9a908849",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/03",
            "description": "Detects an executable initiating a network connection to \"ngrok\" tunneling domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|contains": [
                        "tunnel.us.ngrok.com",
                        "tunnel.eu.ngrok.com",
                        "tunnel.ap.ngrok.com",
                        "tunnel.au.ngrok.com",
                        "tunnel.sa.ngrok.com",
                        "tunnel.jp.ngrok.com",
                        "tunnel.in.ngrok.com"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of the ngrok service."
            ],
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/02/02",
            "references": [
                "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
                "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "18249279-932f-45e2-b37a-8925f2597670"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567",
                "attack.t1568.002",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102",
                "attack.s0508"
            ],
            "title": "Communication To Ngrok Tunneling Service Initiated"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/12/06",
            "description": "Detects a network connection initiated by a binary to \"api.mega.co.nz\".\nAttackers were seen abusing file sharing websites similar to \"mega.nz\" in order to upload/download additional payloads.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        "mega.co.nz",
                        "mega.nz"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate MEGA installers and utilities are expected to communicate with this domain. Exclude hosts that are known to be allowed to use this tool."
            ],
            "id": "fdeebdf0-9f3f-4d08-84a6-4c4d13e39fe4",
            "level": "low",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/05/31",
            "references": [
                "https://megatools.megous.com/",
                "https://www.mandiant.com/resources/russian-targeting-gov-business"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.001"
            ],
            "title": "Network Connection Initiated To Mega.nz"
        },
        {
            "author": "Aaron Greetham (@beardofbinary) - NCC Group",
            "date": "2021/05/26",
            "description": "Detects Rclone config files being created",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains|all": [
                        ":\\Users\\",
                        "\\.config\\rclone\\"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate Rclone usage"
            ],
            "id": "34986307-b7f4-49be-92f3-e7a4d01ac5db",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/05/09",
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "Rclone Config File Creation"
        },
        {
            "author": "Ialle Teixeira @teixeira0xfffff, Austin Songer @austinsonger",
            "date": "2021/09/30",
            "description": "Detects when a user performs data exfiltration by using DataSvcUtil.exe",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "/in:",
                        "/out:",
                        "/uri:"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\DataSvcUtil.exe"
                    },
                    {
                        "OriginalFileName": "DataSvcUtil.exe"
                    }
                ]
            },
            "falsepositives": [
                "DataSvcUtil.exe being used may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "DataSvcUtil.exe being executed from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "e290b10b-1023-4452-a4a9-eb31a9013b3a",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/05/16",
            "status": "test",
            "references": [
                "https://gist.github.com/teixeira0xfffff/837e5bfed0d1b0a29a7cb1e5dbdd9ca6",
                "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/wcf-data-service-client-utility-datasvcutil-exe",
                "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/generating-the-data-service-client-library-wcf-data-services",
                "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services",
                "https://lolbas-project.github.io/lolbas/Binaries/DataSvcUtil/"
            ],
            "tags": [
                "attack.exfiltration",
                "attack.t1567"
            ],
            "title": "LOLBAS Data Exfiltration by DataSvcUtil.exe"
        },
        {
            "author": "Bhabesh Raj, Sittikorn S, Aaron Greetham (@beardofbinary) - NCC Group",
            "date": "2021/05/10",
            "description": "Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc",
            "detection": {
                "condition": "selection_specific_options or all of selection_rclone_*",
                "selection_rclone_cli": {
                    "CommandLine|contains": [
                        "pass",
                        "user",
                        "copy",
                        "sync",
                        "config",
                        "lsd",
                        "remote",
                        "ls",
                        "mega",
                        "pcloud",
                        "ftp",
                        "ignore-existing",
                        "auto-confirm",
                        "transfers",
                        "multi-thread-streams",
                        "no-check-certificate "
                    ]
                },
                "selection_rclone_img": [
                    {
                        "Image|endswith": "\\rclone.exe"
                    },
                    {
                        "Description": "Rsync for cloud storage"
                    }
                ],
                "selection_specific_options": {
                    "CommandLine|contains|all": [
                        "--config ",
                        "--no-check-certificate ",
                        " copy "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "Details"
            ],
            "id": "e37db05d-d1f9-49c8-b464-cee1a4b11638",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "status": "test",
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/",
                "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware",
                "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a",
                "https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone",
                "https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html"
            ],
            "related": [
                {
                    "id": "a0d63692-a531-4912-ad39-4393325b2a9c",
                    "type": "obsoletes"
                },
                {
                    "id": "cb7286ba-f207-44ab-b9e6-760d82b84253",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "PUA - Rclone Execution"
        },
        {
            "author": "frack113",
            "date": "2021/11/26",
            "description": "Detects the execution of \"ConfigSecurityPolicy.EXE\", a binary part of Windows Defender used to manage settings in Windows Defender.\nUsers can configure different pilot collections for each of the co-management workloads.\nIt can be abused by attackers in order to upload or download files.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "CommandLine|contains": "ConfigSecurityPolicy.exe"
                    },
                    {
                        "Image|endswith": "\\ConfigSecurityPolicy.exe"
                    },
                    {
                        "OriginalFileName": "ConfigSecurityPolicy.exe"
                    }
                ],
                "selection_url": {
                    "CommandLine|contains": [
                        "ftp://",
                        "http://",
                        "https://"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1f0f6176-6482-4027-b151-00071af39d7e",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/ConfigSecurityPolicy/"
            ],
            "modified": "2022/05/16",
            "status": "test",
            "title": "Arbitrary File Download Via ConfigSecurityPolicy.EXE",
            "tags": [
                "attack.exfiltration",
                "attack.t1567"
            ]
        },
        {
            "id": "66474410-b883-415f-9f8d-75345a0a66a6",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/16",
            "description": "Detects DNS queries for subdomains related to MEGA sharing website",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": "userstorage.mega.co.nz"
                }
            },
            "falsepositives": [
                "Legitimate DNS queries and usage of Mega"
            ],
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "level": "medium",
            "related": [
                {
                    "type": "similar",
                    "id": "613c03ba-0779-4a53-8a1f-47f914a4ded3"
                }
            ],
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To MEGA Hosting Website - DNS Client"
        },
        {
            "id": "090ffaad-c01a-4879-850c-6d57da98452d",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/16",
            "description": "Detects DNS queries to \"ufile.io\", which was seen abused by malware and threat actors as a method for data exfiltration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": "ufile.io"
                }
            },
            "falsepositives": [
                "DNS queries for \"ufile\" are not malicious by nature necessarily. Investigate the source to determine the necessary actions to take"
            ],
            "level": "low",
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "modified": "2023/09/18",
            "references": [
                "https://thedfirreport.com/2021/12/13/diavol-ransomware/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "1cbbeaaf-3c8c-4e4c-9d72-49485b6a176b"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To Ufile.io - DNS Client"
        },
        {
            "id": "29f171d7-aa47-42c7-9c7b-3c87938164d9",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/16",
            "description": "Detects DNS queries for anonfiles.com, which is an anonymous file upload platform often used for malicious purposes",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": ".anonfiles.com"
                }
            },
            "falsepositives": [
                "Rare legitimate access to anonfiles.com"
            ],
            "level": "high",
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "related": [
                {
                    "type": "similar",
                    "id": "065cceea-77ec-4030-9052-fc0affea7110"
                }
            ],
            "references": [
                "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query for Anonfiles.com Domain - DNS Client"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/03",
            "description": "Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|contains": [
                        "tunnel.us.ngrok.com",
                        "tunnel.eu.ngrok.com",
                        "tunnel.ap.ngrok.com",
                        "tunnel.au.ngrok.com",
                        "tunnel.sa.ngrok.com",
                        "tunnel.jp.ngrok.com",
                        "tunnel.in.ngrok.com"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of ngrok"
            ],
            "id": "19bf6fdb-7721-4f3d-867f-53467f6a5db6",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "linux"
            },
            "references": [
                "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
                "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
            ],
            "status": "test",
            "title": "Communication To Ngrok Tunneling Service - Linux",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567",
                "attack.t1568.002",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102",
                "attack.s0508"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Cedric MAURUGEON (Update)",
            "date": "2022/09/15",
            "description": "Detects a suspicious curl process start the adds a file to a web request",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_localhost": {
                    "CommandLine|contains": [
                        "://localhost",
                        "://127.0.0.1"
                    ]
                },
                "selection_cli": [
                    {
                        "CommandLine|contains": [
                            " --form",
                            " --upload-file ",
                            " --data ",
                            " --data-"
                        ]
                    },
                    {
                        "CommandLine|re": "\\s-[FTd]\\s"
                    }
                ],
                "selection_img": {
                    "Image|endswith": "/curl"
                }
            },
            "falsepositives": [
                "Scripts created by developers and admins"
            ],
            "id": "00b90cc1-17ec-402c-96ad-3a8117d7a582",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "level": "medium",
            "modified": "2023/05/02",
            "references": [
                "https://twitter.com/d1r4c/status/1279042657508081664",
                "https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file",
                "https://curl.se/docs/manpage.html",
                "https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html"
            ],
            "related": [
                {
                    "id": "00bca14a-df4e-4649-9054-3f2aa676bc04",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567",
                "attack.t1105"
            ],
            "title": "Suspicious Curl File Upload - Linux"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Office 365",
        "SaaS",
        "Google Workspace"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "William Cain"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "exfiltration"
        }
    ],
    "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. User behavior monitoring may help to detect abnormal patterns of activity.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.3",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Connection Creation",
        "Command: Command Execution",
        "Network Traffic: Network Traffic Flow",
        "File: File Access",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": []
}