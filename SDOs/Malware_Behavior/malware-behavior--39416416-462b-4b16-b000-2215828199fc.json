{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--39416416-462b-4b16-b000-2215828199fc",
    "created": "2024-08-13T14:46:37.005606Z",
    "modified": "2024-08-13T14:46:45.406369Z",
    "name": "File and Directory Permissions Modification: Linux and Mac",
    "description": "Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.[1][2] File and directory permissions are commonly managed by ACLs configured by the file or directory owner, or users with the appropriate permissions. File and directory ACL implementations vary by platform, but generally explicitly designate which users or groups can perform which actions (read, write, execute, etc.).Most Linux and Linux-based platforms provide a standard set of permission groups (user, group, and other) and a standard set of permissions (read, write, and execute) that are applied to each group. While nuances of each platform\u2019s permissions implementation may vary, most of the platforms provide two primary commands used to manipulate file and directory ACLs: chown (short for change owner), and chmod (short for change mode).Adversarial may use these commands to make themselves the owner of files and directories or change the mode if current permissions allow it. They could subsequently lock others out of the file. Specific file and directory modifications may be a required step for many techniques, such as establishing Persistence via Unix Shell Configuration Modification or tainting/hijacking other instrumental binary/configuration files via Hijack Execution Flow.[3]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1222/002",
            "external_id": "T1222/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io",
            "date": "2022/06/03",
            "description": "Detects chmod targeting files in abnormal directory paths.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "/tmp/",
                        "/.Library/",
                        "/etc/",
                        "/opt/"
                    ],
                    "Image|endswith": "/chmod"
                }
            },
            "falsepositives": [
                "Admin changing file permissions."
            ],
            "id": "6419afd1-3742-47a5-a7e6-b50386cd15f8",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://www.intezer.com/blog/malware-analysis/new-backdoor-sysjoker/",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1222.002"
            ],
            "title": "Chmod Suspicious Directory"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/15",
            "description": "Detects usage of the 'chattr' utility to remove immutable file attribute.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": " -i ",
                    "Image|endswith": "/chattr"
                }
            },
            "falsepositives": [
                "Administrator interacting with immutable files (e.g. for instance backups)."
            ],
            "id": "34979410-e4b5-4e5d-8cfb-389fdff05c12",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html"
            ],
            "related": [
                {
                    "id": "a5b977d6-8a81-4475-91b9-49dbfcd941f7",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1222.002"
            ],
            "title": "Remove Immutable File Attribute"
        },
        {
            "id": "a5b977d6-8a81-4475-91b9-49dbfcd941f7",
            "author": "Jakob Weinzettl, oscd.community",
            "date": "2019/09/23",
            "description": "Detects removing immutable file attribute.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0|contains": "chattr",
                    "a1|contains": "-i",
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Administrator interacting with immutable files (e.g. for instance backups)."
            ],
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/11/26",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1222.002"
            ],
            "title": "Remove Immutable File Attribute - Auditd"
        },
        {
            "author": "Jakob Weinzettl, oscd.community",
            "date": "2019/09/23",
            "description": "Detects file and folder permission changes.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0|contains": [
                        "chmod",
                        "chown"
                    ],
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "User interacting with files permissions (normal/daily behaviour)."
            ],
            "id": "74c01ace-0152-4094-8ae2-6fd776dd43e5",
            "level": "low",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1222.002"
            ],
            "title": "File or Folder Permissions Change"
        }
    ]
}