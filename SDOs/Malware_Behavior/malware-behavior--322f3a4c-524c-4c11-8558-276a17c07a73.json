{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--322f3a4c-524c-4c11-8558-276a17c07a73",
    "created": "2024-08-13T14:46:36.674857Z",
    "modified": "2024-08-13T14:46:36.674857Z",
    "name": "Use of Known Kerberos Credentials",
    "description": "An adversary obtains (i.e. steals or purchases) legitimate Kerberos credentials (e.g. Kerberos service account userID/password or Kerberos Tickets) with the goal of achieving authenticated access to additional systems, applications, or services within the domain.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/652.html",
            "external_id": "652"
        },
        {
            "source_name": "CWE",
            "external_id": "522"
        },
        {
            "source_name": "CWE",
            "external_id": "307"
        },
        {
            "source_name": "CWE",
            "external_id": "308"
        },
        {
            "source_name": "CWE",
            "external_id": "309"
        },
        {
            "source_name": "CWE",
            "external_id": "262"
        },
        {
            "source_name": "CWE",
            "external_id": "263"
        },
        {
            "source_name": "CWE",
            "external_id": "654"
        },
        {
            "source_name": "CWE",
            "external_id": "294"
        },
        {
            "source_name": "CWE",
            "external_id": "836"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authentication"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Read Data",
            "scope": "Authorization"
        },
        {
            "impact": "Modify Data",
            "scope": "Integrity"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "Bronze Butler (also known as Tick), has been shown to leverage forged Kerberos Ticket Granting Tickets (TGTs) and Ticket Granting Service (TGS) tickets to maintain administrative access on a number of systems. [REF-584]"
        },
        {
            "description": "PowerSploit's Invoke-Kerberoast module can be leveraged to request Ticket Granting Service (TGS) tickets and return crackable ticket hashes. [REF-585] [REF-586]"
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Acquire known Kerberos credentials] The adversary must obtain known Kerberos credentials in order to access the target system, application, or service within the domain.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "An adversary purchases breached Kerberos service account username/password combinations or leaked hashed passwords from the dark web.",
                "An adversary guesses the credentials to a weak Kerberos service account.",
                "An adversary conducts a sniffing attack to steal Kerberos tickets as they are transmitted.",
                "An adversary conducts a Kerberoasting attack."
            ]
        },
        {
            "description": "[Attempt Kerberos authentication] Try each Kerberos credential against various resources within the domain until the target grants access.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Manually or automatically enter each Kerberos service account credential through the target's interface.",
                "Attempt a Pass the Ticket attack."
            ]
        },
        {
            "description": "[Impersonate] An adversary can use successful experiments or authentications to impersonate an authorized user or system, or to laterally move within the domain",
            "phase": "Exploit",
            "step": "3",
            "techniques": []
        },
        {
            "description": "[Spoofing] Malicious data can be injected into the target system or into other systems on the domain. The adversary can also pose as a legitimate domain user to perform social engineering attacks.",
            "phase": "Exploit",
            "step": "4",
            "techniques": []
        },
        {
            "description": "[Data Exfiltration] The adversary can obtain sensitive data contained within domain systems or applications.",
            "phase": "Exploit",
            "step": "5",
            "techniques": []
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Medium",
    "x_mitre_mitigations": [
        {
            "description": "Create a strong password policy and ensure that your system enforces this policy for Kerberos service accounts."
        },
        {
            "description": "Ensure Kerberos service accounts are not reusing username/password combinations for multiple systems, applications, or services."
        },
        {
            "description": "Do not reuse Kerberos service account credentials across systems."
        },
        {
            "description": "Deny remote use of Kerberos service account credentials to log into domain systems."
        },
        {
            "description": "Do not allow Kerberos service accounts to be a local administrator on more than one system."
        },
        {
            "description": "Enable at least AES Kerberos encryption for tickets."
        },
        {
            "description": "Monitor system and domain logs for abnormal credential access."
        }
    ]
}