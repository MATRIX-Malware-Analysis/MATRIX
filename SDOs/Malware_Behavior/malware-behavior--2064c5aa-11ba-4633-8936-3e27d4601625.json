{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--2064c5aa-11ba-4633-8936-3e27d4601625",
    "created": "2024-08-13T14:46:36.624024Z",
    "modified": "2024-08-13T14:46:36.624024Z",
    "name": "Directory Indexing",
    "description": "An adversary crafts a request to a target that results in the target listing/indexing the content of a directory as output. One common method of triggering directory contents as output is to construct a request containing a path that terminates in a directory name rather than a file name since many applications are configured to provide a list of the directory's contents when such a request is received. An adversary can use this to explore the directory tree on a target as well as learn the names of files. This can often end up revealing test files, backup files, temporary files, hidden files, configuration files, user accounts, script contents, as well as naming conventions, all of which can be used by an attacker to mount additional attacks.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/127.html",
            "external_id": "127"
        },
        {
            "source_name": "CWE",
            "external_id": "424"
        },
        {
            "source_name": "CWE",
            "external_id": "425"
        },
        {
            "source_name": "CWE",
            "external_id": "288"
        },
        {
            "source_name": "CWE",
            "external_id": "285"
        },
        {
            "source_name": "CWE",
            "external_id": "732"
        },
        {
            "source_name": "CWE",
            "external_id": "276"
        },
        {
            "source_name": "CWE",
            "external_id": "693"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "The adversary uses directory listing to view sensitive files in the application. This is an example of accessing the backup file. The attack issues a request for http://www.example.com/admin/ and receives the following dynamic directory indexing content in the response: Index of /admin Name Last Modified Size Description backup/ 31-May-2007 08:18 - Apache/ 2.0.55 Server at www.example.com Port 80\n               The target application does not have direct hyperlink to the \"backup\" directory in the normal html webpage, however the attacker has learned of this directory due to indexing the content. The client then requests the backup directory URL and receives output which has a \"db_dump.php\" file in it. This sensitive data should not be disclosed publicly."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Directory Discovery] Use a method, either manual, scripted, or automated to discover the directories on the server by making requests for directories that may possibly exist. During this phase the adversary is less concerned with whether a directory can be accessed or indexed and more focused on simply discovering what directories do exist on the target.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Send requests to the web server for common directory names",
                "If directories are discovered that are native to a server type further refine the directory search to include directories usually present on those types of servers.",
                "Search for uncommon or potentially user created directories that may be present."
            ]
        },
        {
            "description": "[Iteratively explore directory/file structures] The adversary attempts to access the discovered directories that allow access and may attempt to bypass server or application level ACLs by using manual or automated methods",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Use a scanner tool to dynamically add directories/files to include their scan based upon data obtained in initial probes.",
                "Use a browser to manually explore the website by issuing a request ending the URL in a slash '/'.",
                "Attempt to bypass ACLs on directories by using methods that known to work against some server types by appending data to the directory request. For instance, appending a Null byte to the end of the request which may cause an ACL to fail and allow access.",
                "Sequentially request a list of common base files to each directory discovered.",
                "Try multiple fuzzing techniques to list directory contents for directories that will not reveal their contents with a \"/\" request"
            ]
        },
        {
            "description": "[Read directories or files which are not intended for public viewing.] The adversary attempts to access the discovered directories that allow access and may attempt to bypass server or application level ACLs by using manual or automated methods",
            "phase": "Exploit",
            "step": "3",
            "techniques": [
                "Try multiple exploit techniques to list directory contents for directories that will not reveal their contents with a \"/\" request",
                "Try other known exploits to elevate privileges sufficient to bypass protected directories.",
                "List the files in the directory by issuing a request with the URL ending in a \"/\" slash.",
                "Access the files via direct URL and capture contents.",
                "Attempt to bypass ACLs on directories by using methods that are known to work against some server types by appending data to the directory request. For instance, appending a Null byte to the end of the request which may cause an ACL to fail and allow access.",
                "Sequentially request a list of common base files to each directory discovered."
            ]
        }
    ],
    "x_mitre_impact": "Medium",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "1. Using blank index.html: putting blank index.html simply prevent directory listings from displaying to site visitors."
        },
        {
            "description": "2. Preventing with .htaccess in Apache web server: In .htaccess, write \"Options-indexes\"."
        },
        {
            "description": "3. Suppressing error messages: using error 403 \"Forbidden\" message exactly like error 404 \"Not Found\" message."
        }
    ]
}