{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6a6febad-54e9-4121-9cd0-919dbbb889d5",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:46.009131Z",
    "name": "Software Deployment Tools",
    "description": "Adversaries may gain access to and use centralized software suites installed within an enterprise to execute commands and move laterally through the network. Configuration management and software deployment applications may be used in an enterprise network or cloud environment for routine administration purposes. These systems may also be integrated into CI/CD pipelines. Examples of such solutions include: SCCM, HBSS, Altiris, AWS Systems Manager, Microsoft Intune, Azure Arc, and GCP Deployment Manager.  Access to network-wide or enterprise-wide endpoint management software may enable an adversary to achieve remote code execution on all connected systems. The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints.SaaS-based configuration management services may allow for broad Cloud Administration Command on cloud-hosted instances, as well as the execution of arbitrary commands on on-premises endpoints. For example, Microsoft Configuration Manager allows Global or Intune Administrators to run scripts as SYSTEM on on-premises devices joined to Azure AD.[1] Such services may also utilize Web Protocols to communicate back to adversary owned infrastructure.[2]Network infrastructure devices may also have configuration management tools that can be similarly abused by adversaries.[3]The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required. However, the system may require an administrative account to log in or to access specific functionality.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1072",
            "external_id": "T1072"
        },
        {
            "source_name": "CAPEC 187",
            "external_id": "malware-behavior--4dd531cc-4cdf-4347-aa12-2278e2d31c35"
        },
        {
            "source_name": "CAPEC 657",
            "external_id": "malware-behavior--0396dc1e-f5d8-4ec3-86e4-af8c8a6d9814"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1072",
            "external_id": "T1072"
        },
        {
            "source_name": "Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation",
            "description": "ALEXANDER MARVI, BRAD SLAYBAUGH, DAN EBREO, TUFAIL AHMED, MUHAMMAD UMAIR, TINA JOHNSON. (2023, March 16). Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor in Espionage Operation. Retrieved May 15, 2023.",
            "url": "https://www.mandiant.com/resources/blog/fortinet-malware-ecosystem"
        },
        {
            "source_name": "SpecterOps Lateral Movement from Azure to On-Prem AD 2020",
            "description": "Andy Robbins. (2020, August 17). Death from Above: Lateral Movement from Azure to On-Prem AD. Retrieved March 13, 2023.",
            "url": "https://posts.specterops.io/death-from-above-lateral-movement-from-azure-to-on-prem-ad-d18cb3959d4d"
        },
        {
            "source_name": "Mitiga Security Advisory: SSM Agent as Remote Access Trojan",
            "description": "Ariel Szarf, Or Aspir. (n.d.). Mitiga Security Advisory: Abusing the SSM Agent as a Remote Access Trojan. Retrieved January 31, 2024.",
            "url": "https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113",
            "date": "2022/01/22",
            "description": "Detects the execution of Radmin which can be abused by an adversary to remotely control Windows machines",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "Radmin Viewer"
                    },
                    {
                        "Product": "Radmin Viewer"
                    },
                    {
                        "OriginalFileName": "Radmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5817e76f-4804-41e6-8f1d-5fa0b3ecae2d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/11",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1072/T1072.md",
                "https://www.radmin.fr/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.lateral_movement",
                "attack.t1072"
            ],
            "title": "PUA - Radmin Viewer Utility Execution"
        },
        {
            "author": "frack113",
            "date": "2022/10/01",
            "description": "Detect use of PDQ Deploy remote admin tool",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "PDQ Deploy Console"
                    },
                    {
                        "Product": "PDQ Deploy"
                    },
                    {
                        "Company": "PDQ.com"
                    },
                    {
                        "OriginalFileName": "PDQDeployConsole.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "d679950c-abb7-43a6-80fb-2a480c4fc450",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/30",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1072/T1072.md",
                "https://www.pdq.com/pdq-deploy/"
            ],
            "related": [
                {
                    "id": "12b8e9f5-96b2-41e1-9a42-8c6779a5c184",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.lateral_movement",
                "attack.t1072"
            ],
            "title": "PDQ Deploy Remote Adminstartion Tool Execution"
        },
        {
            "author": "Konstantin Grishchenko, oscd.community",
            "date": "2020/10/17",
            "description": "Csi.exe is a signed binary from Microsoft that comes with Visual Studio and provides C# interactive capabilities. It can be used to run C# code from a file passed as a parameter in command line. Early version of this utility provided with Microsoft \u201cRoslyn\u201d Community Technology Preview was named 'rcsi.exe'",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "Company": "Microsoft Corporation"
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\csi.exe",
                            "\\rcsi.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "csi.exe",
                            "rcsi.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate usage by software developers"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "40b95d31-1afc-469e-8d34-9a3a667d058e",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/07/11",
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Csi/",
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Rcsi/",
                "https://enigma0x3.net/2016/11/21/bypassing-application-whitelisting-by-using-rcsi-exe/",
                "https://twitter.com/Z3Jpa29z/status/1317545798981324801"
            ],
            "tags": [
                "attack.execution",
                "attack.t1072",
                "attack.defense_evasion",
                "attack.t1218"
            ],
            "title": "Suspicious Csi.exe Usage"
        },
        {
            "author": "frack113",
            "date": "2023/01/12",
            "description": "Detects restricted access to applications by the Software Restriction Policies (SRP) policy",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        865,
                        866,
                        867,
                        868,
                        882
                    ],
                    "Provider_Name": "Microsoft-Windows-SoftwareRestrictionPolicies"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b4c8da4a-1c12-46b0-8a2b-0a8521d03442",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/identity/software-restriction-policies/software-restriction-policies",
                "https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWEventsList/CSV/Windows11/22H2/W11_22H2_Pro_20220920_22621.382/Providers/Microsoft-Windows-AppXDeployment-Server.csv"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1072"
            ],
            "title": "Restricted Software Access By SRP"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network",
        "SaaS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Shane Tully, @securitygypsy",
        "Joe Gumke, U.S. Bank",
        "Tamir Yehuda"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        },
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "lateral-movement"
        }
    ],
    "x_mitre_detection": "Detection methods will vary depending on the type of third-party software or system and how it is typically used. \n\nThe same investigation process can be applied here as with other potentially malicious activities where the distribution vector is initially unknown but the resulting activity follows a discernible pattern. Analyze the process execution trees, historical activities from the third-party application (such as what types of files are usually pushed), and the resulting activities or events from the file/binary/script pushed to systems. \n\nOften these third-party applications will have logs of their own that can be collected and correlated with other data from the environment. Ensure that third-party application logs are on-boarded to the enterprise logging system and the logs are regularly reviewed. Audit software deployment logs and look for suspicious or unauthorized activity. A system not typically used to push software to clients that suddenly is used for such a task outside of a known admin function may be suspicious. Monitor account login activity on these applications to detect suspicious/abnormal usage.\n\nPerform application deployment at regular times so that irregular deployment activity stands out. Monitor process activity that does not correlate to known good software. Monitor account login activity on the deployment system.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "3.0",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": []
}