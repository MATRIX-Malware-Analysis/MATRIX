{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c89fa774-596e-46c2-aca9-5a3be6c7b0ff",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:44.851416Z",
    "name": "Phishing: Spearphishing Attachment",
    "description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon User Execution to gain execution.[1] Spearphishing may also involve social engineering techniques, such as posing as a trusted source.There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1566/001",
            "external_id": "T1566/001"
        },
        {
            "source_name": "CAPEC 163",
            "external_id": "malware-behavior--d7651bcd-0dc9-46d7-8577-3c8f7b61e97e"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/11",
            "description": "Detects the creation of recent element file that points to an .ISO, .IMG, .VHD or .VHDX file as often used in phishing attacks.\nThis can be a false positive on server systems but on workstations users should rarely mount .iso or .img files.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "\\Microsoft\\Windows\\Recent\\",
                    "TargetFilename|endswith": [
                        ".iso.lnk",
                        ".img.lnk",
                        ".vhd.lnk",
                        ".vhdx.lnk"
                    ]
                }
            },
            "falsepositives": [
                "Cases in which a user mounts an image file for legitimate reasons"
            ],
            "id": "4358e5a5-7542-4dcb-b9f3-87667371839b",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/",
                "https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore",
                "https://blog.emsisoft.com/en/32373/beware-new-wave-of-malware-spreads-via-iso-file-email-attachments/",
                "https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "ISO or Image Mount Indicator in Recent Files"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/23",
            "description": "Detects the creation of a office macro file from a a suspicious process",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmd": [
                    {
                        "Image|endswith": [
                            "\\cscript.exe",
                            "\\mshta.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\wscript.exe"
                        ]
                    },
                    {
                        "ParentImage|endswith": [
                            "\\cscript.exe",
                            "\\mshta.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\wscript.exe"
                        ]
                    }
                ],
                "selection_ext": {
                    "TargetFilename|endswith": [
                        ".docm",
                        ".dotm",
                        ".xlsm",
                        ".xltm",
                        ".potm",
                        ".pptm"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b1c50487-1967-4315-a026-6491686d860e",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows",
                "definition": "Requirements: The \"ParentImage\" field is not available by default on EID 11 of Sysmon logs. To be able to use this rule to the full extent you need to enriche the log with additional ParentImage data"
            },
            "modified": "2023/02/22",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md",
                "https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "Office Macro File Creation From Suspicious Process"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/23",
            "description": "Detects the creation of a new office macro files on the systems via an application (browser, mail client).",
            "detection": {
                "condition": "all of selection_*",
                "selection_ext": [
                    {
                        "TargetFilename|endswith": [
                            ".docm",
                            ".dotm",
                            ".xlsm",
                            ".xltm",
                            ".potm",
                            ".pptm"
                        ]
                    },
                    {
                        "TargetFilename|contains": [
                            ".docm:Zone",
                            ".dotm:Zone",
                            ".xlsm:Zone",
                            ".xltm:Zone",
                            ".potm:Zone",
                            ".pptm:Zone"
                        ]
                    }
                ],
                "selection_processes": {
                    "Image|endswith": [
                        "\\RuntimeBroker.exe",
                        "\\outlook.exe",
                        "\\thunderbird.exe",
                        "\\brave.exe",
                        "\\chrome.exe",
                        "\\firefox.exe",
                        "\\iexplore.exe",
                        "\\maxthon.exe",
                        "\\MicrosoftEdge.exe",
                        "\\msedge.exe",
                        "\\msedgewebview2.exe",
                        "\\opera.exe",
                        "\\safari.exe",
                        "\\seamonkey.exe",
                        "\\vivaldi.exe",
                        "\\whale.exe"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate macro files downloaded from the internet",
                "Legitimate macro files sent as attachments via emails"
            ],
            "id": "0e29e3a7-1ad8-40aa-b691-9f82ecd33d66",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/04/18",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md",
                "https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference"
            ],
            "related": [
                {
                    "id": "91174a41-dc8f-401b-be89-7bfc140612a0",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "Office Macro File Download"
        },
        {
            "author": "Tim Rauch (rule), Elastic (idea)",
            "date": "2022/10/21",
            "description": "Detects attempts to create a DLL file to a known desktop application dependencies folder such as Slack, Teams or OneDrive and by an unusual process. This may indicate an attempt to load a malicious module via DLL search order hijacking.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": "\\cmd.exe",
                    "TargetFilename|contains|all": [
                        "\\Users\\",
                        "\\AppData\\",
                        "\\Microsoft\\OneDrive\\",
                        "\\api-ms-win-core-"
                    ]
                },
                "selection": {
                    "Image|endswith": [
                        "\\winword.exe",
                        "\\excel.exe",
                        "\\powerpnt.exe",
                        "\\MSACCESS.EXE",
                        "\\MSPUB.EXE",
                        "\\fltldr.exe",
                        "\\cmd.exe",
                        "\\certutil.exe",
                        "\\mshta.exe",
                        "\\cscript.exe",
                        "\\wscript.exe",
                        "\\curl.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ],
                    "TargetFilename|contains": [
                        "\\Microsoft\\OneDrive\\",
                        "\\Microsoft OneDrive\\",
                        "\\Microsoft\\Teams\\",
                        "\\Local\\slack\\app-",
                        "\\Local\\Programs\\Microsoft VS Code\\"
                    ],
                    "TargetFilename|contains|all": [
                        "\\Users\\",
                        "\\AppData\\"
                    ],
                    "TargetFilename|endswith": ".dll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dbbd9f66-2ed3-4ca2-98a4-6ea985dd1a1c",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d46dd4ac6866b4337ec126be8cee0e115467b3e8703794ba6f6df6432c806bc",
                "https://posts.specterops.io/automating-dll-hijack-discovery-81c4295904b0"
            ],
            "status": "test",
            "tags": [
                "attack.t1566",
                "attack.t1566.001",
                "attack.initial_access",
                "attack.t1574",
                "attack.t1574.001",
                "attack.defense_evasion"
            ],
            "title": "Potential Initial Access via DLL Search Order Hijacking"
        },
        {
            "id": "91174a41-dc8f-401b-be89-7bfc140612a0",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/23",
            "description": "Detects the creation of a new office macro files on the systems",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": [
                        ".docm",
                        ".dotm",
                        ".xlsm",
                        ".xltm",
                        ".potm",
                        ".pptm"
                    ]
                }
            },
            "falsepositives": [
                "Very common in environments that rely heavily on macro documents"
            ],
            "level": "low",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "related": [
                {
                    "type": "similar",
                    "id": "0e29e3a7-1ad8-40aa-b691-9f82ecd33d66"
                }
            ],
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md",
                "https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "Office Macro File Creation"
        },
        {
            "author": "@sam0x90",
            "date": "2022/07/30",
            "description": "Detects the creation of a ISO file in the Outlook temp folder or in the Appdata temp folder. Typical of Qakbot TTP from end-July 2022.",
            "detection": {
                "condition": "1 of selection*",
                "selection_1": {
                    "TargetFilename|contains|all": [
                        "\\AppData\\Local\\Temp\\",
                        ".zip\\"
                    ],
                    "TargetFilename|endswith": ".iso"
                },
                "selection_2": {
                    "TargetFilename|contains": "\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook\\",
                    "TargetFilename|endswith": ".iso"
                }
            },
            "falsepositives": [
                "Potential FP by sysadmin opening a zip file containing a legitimate ISO file"
            ],
            "fields": [
                "Image",
                "ComputerName",
                "TargetFileName"
            ],
            "id": "2f9356ae-bf43-41b8-b858-4496d83b2acb",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://twitter.com/Sam0x90/status/1552011547974696960",
                "https://securityaffairs.co/wordpress/133680/malware/dll-sideloading-spread-qakbot.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "ISO File Created Within Temp Folders"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/10/01",
            "description": "Detects a suspicious program execution in Outlook temp folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|contains": "\\Temporary Internet Files\\Content.Outlook\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a018fdc3-46a3-44e5-9afb-2cd4af1d4b39",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "status": "test",
            "references": [
                "Internal Research"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "Suspicious Execution From Outlook Temporary Folder"
        },
        {
            "author": "Maxim Pavlunin",
            "date": "2020/04/01",
            "description": "Detects a suspicious execution of a Microsoft HTML Help (HH.exe)",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "OriginalFileName": "HH.exe"
                    },
                    {
                        "Image|endswith": "\\hh.exe"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        ".application",
                        "\\AppData\\Local\\Temp\\",
                        "\\Content.Outlook\\",
                        "\\Downloads\\",
                        "\\Users\\Public\\",
                        "\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e8a95b5e-c891-46e2-b33a-93937d3abc31",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "status": "test",
            "references": [
                "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/",
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7",
                "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
                "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.initial_access",
                "attack.t1047",
                "attack.t1059.001",
                "attack.t1059.003",
                "attack.t1059.005",
                "attack.t1059.007",
                "attack.t1218",
                "attack.t1218.001",
                "attack.t1218.010",
                "attack.t1218.011",
                "attack.t1566",
                "attack.t1566.001"
            ],
            "title": "Suspicious HH.EXE Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), @blu3_team (idea), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/06/26",
            "description": "Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        ".doc.exe",
                        ".docx.exe",
                        ".xls.exe",
                        ".xlsx.exe",
                        ".ppt.exe",
                        ".pptx.exe",
                        ".rtf.exe",
                        ".pdf.exe",
                        ".txt.exe",
                        "      .exe",
                        "______.exe",
                        ".doc.js",
                        ".docx.js",
                        ".xls.js",
                        ".xlsx.js",
                        ".ppt.js",
                        ".pptx.js",
                        ".rtf.js",
                        ".pdf.js",
                        ".txt.js"
                    ],
                    "Image|endswith": [
                        ".doc.exe",
                        ".docx.exe",
                        ".xls.exe",
                        ".xlsx.exe",
                        ".ppt.exe",
                        ".pptx.exe",
                        ".rtf.exe",
                        ".pdf.exe",
                        ".txt.exe",
                        "      .exe",
                        "______.exe",
                        ".doc.js",
                        ".docx.js",
                        ".xls.js",
                        ".xlsx.js",
                        ".ppt.js",
                        ".pptx.js",
                        ".rtf.js",
                        ".pdf.js",
                        ".txt.js"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1cdd9a09-06c9-4769-99ff-626e2b3991b8",
            "level": "critical",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/28",
            "references": [
                "https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html",
                "https://twitter.com/blackorbird/status/1140519090961825792"
            ],
            "related": [
                {
                    "id": "5e6a80c8-2d45-4633-9ef4-fa2671a39c5c",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "status": "stable",
            "title": "Suspicious Double Extension File Execution"
        },
        {
            "author": "Maxim Pavlunin, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/04/01",
            "description": "Detects a suspicious child process of a Microsoft HTML Help (HH.exe)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\CertReq.exe",
                        "\\CertUtil.exe",
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\installutil.exe",
                        "\\MSbuild.exe",
                        "\\MSHTA.EXE",
                        "\\msiexec.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\schtasks.exe",
                        "\\wmic.exe",
                        "\\wscript.exe"
                    ],
                    "ParentImage|endswith": "\\hh.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "52cad028-0ff0-4854-8f67-d25dfcbc78b4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "status": "test",
            "references": [
                "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/",
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7",
                "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
                "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.initial_access",
                "attack.t1047",
                "attack.t1059.001",
                "attack.t1059.003",
                "attack.t1059.005",
                "attack.t1059.007",
                "attack.t1218",
                "attack.t1218.001",
                "attack.t1218.010",
                "attack.t1218.011",
                "attack.t1566",
                "attack.t1566.001"
            ],
            "title": "HTML Help HH.EXE Suspicious Child Process"
        },
        {
            "author": "Tim Rauch (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), Elastic (idea)",
            "date": "2022/10/21",
            "description": "Detects suspicious child processes of the Microsoft OneNote application. This may indicate an attempt to execute malicious embedded objects from a .one file.",
            "detection": {
                "condition": "selection_parent and 1 of selection_opt_* and not 1 of filter_*",
                "filter_onedrive": {
                    "CommandLine|endswith": "-Embedding",
                    "Image|contains": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                    "Image|endswith": "\\FileCoAuth.exe"
                },
                "filter_teams": {
                    "CommandLine|endswith": "-Embedding",
                    "Image|endswith": "\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"
                },
                "selection_opt_explorer": {
                    "CommandLine|contains": [
                        ".hta",
                        ".vb",
                        ".wsh",
                        ".js",
                        ".ps",
                        ".scr",
                        ".pif",
                        ".bat",
                        ".cmd"
                    ],
                    "Image|endswith": "\\explorer.exe"
                },
                "selection_opt_img": [
                    {
                        "OriginalFileName": [
                            "bitsadmin.exe",
                            "CertOC.exe",
                            "CertUtil.exe",
                            "Cmd.Exe",
                            "CMSTP.EXE",
                            "cscript.exe",
                            "curl.exe",
                            "HH.exe",
                            "IEExec.exe",
                            "InstallUtil.exe",
                            "javaw.exe",
                            "Microsoft.Workflow.Compiler.exe",
                            "msdt.exe",
                            "MSHTA.EXE",
                            "msiexec.exe",
                            "Msxsl.exe",
                            "odbcconf.exe",
                            "pcalua.exe",
                            "PowerShell.EXE",
                            "RegAsm.exe",
                            "RegSvcs.exe",
                            "REGSVR32.exe",
                            "RUNDLL32.exe",
                            "schtasks.exe",
                            "ScriptRunner.exe",
                            "wmic.exe",
                            "WorkFolders.exe",
                            "wscript.exe"
                        ]
                    },
                    {
                        "Image|endswith": [
                            "\\AppVLP.exe",
                            "\\bash.exe",
                            "\\bitsadmin.exe",
                            "\\certoc.exe",
                            "\\certutil.exe",
                            "\\cmd.exe",
                            "\\cmstp.exe",
                            "\\control.exe",
                            "\\cscript.exe",
                            "\\curl.exe",
                            "\\forfiles.exe",
                            "\\hh.exe",
                            "\\ieexec.exe",
                            "\\installutil.exe",
                            "\\javaw.exe",
                            "\\mftrace.exe",
                            "\\Microsoft.Workflow.Compiler.exe",
                            "\\msbuild.exe",
                            "\\msdt.exe",
                            "\\mshta.exe",
                            "\\msidb.exe",
                            "\\msiexec.exe",
                            "\\msxsl.exe",
                            "\\odbcconf.exe",
                            "\\pcalua.exe",
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\regasm.exe",
                            "\\regsvcs.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\schtasks.exe",
                            "\\scrcons.exe",
                            "\\scriptrunner.exe",
                            "\\sh.exe",
                            "\\svchost.exe",
                            "\\verclsid.exe",
                            "\\wmic.exe",
                            "\\workfolders.exe",
                            "\\wscript.exe"
                        ]
                    }
                ],
                "selection_opt_paths": {
                    "Image|contains": [
                        "\\AppData\\",
                        "\\Users\\Public\\",
                        "\\ProgramData\\",
                        "\\Windows\\Tasks\\",
                        "\\Windows\\Temp\\",
                        "\\Windows\\System32\\Tasks\\"
                    ]
                },
                "selection_parent": {
                    "ParentImage|endswith": "\\onenote.exe"
                }
            },
            "falsepositives": [
                "File located in the AppData folder with trusted signature"
            ],
            "id": "c27515df-97a9-4162-8a60-dc0eeb51b775",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/10",
            "status": "test",
            "references": [
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-e34e43eb5666427602ddf488b2bf3b545bd9aae81af3e6f6c7949f9652abdf18",
                "https://micahbabinski.medium.com/detecting-onenote-one-malware-delivery-407e9321ecf0"
            ],
            "related": [
                {
                    "id": "438025f9-5856-4663-83f7-52f878a70a50",
                    "type": "derived"
                }
            ],
            "tags": [
                "attack.t1566",
                "attack.t1566.001",
                "attack.initial_access"
            ],
            "title": "Suspicious Microsoft OneNote Child Process"
        },
        {
            "author": "Sreeman",
            "date": "2020/03/13",
            "description": "The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create \"shortcuts\" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "CommandLine|contains": "immersivecontrolpanel"
                },
                "selection": {
                    "CommandLine|contains": ".SettingContent-ms"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ParentProcess",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "24de4f3b-804c-4165-b442-5a06a2302c7e",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "status": "test",
            "modified": "2022/04/14",
            "references": [
                "https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39"
            ],
            "tags": [
                "attack.t1204",
                "attack.t1566.001",
                "attack.execution",
                "attack.initial_access"
            ],
            "title": "Arbitrary Shell Command Execution Via Settingcontent-Ms"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/10/24",
            "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\gbb.exe",
                    "ParentImage|endswith": "\\Hwp.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "023394c4-29d5-46ab-92b8-6a534c6f447b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "status": "test",
            "references": [
                "https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/",
                "https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1",
                "https://twitter.com/cyberwar_15/status/1187287262054076416",
                "https://blog.alyac.co.kr/1901",
                "https://en.wikipedia.org/wiki/Hangul_(word_processor)"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001",
                "attack.execution",
                "attack.t1203",
                "attack.t1059.003",
                "attack.g0032"
            ],
            "title": "Suspicious HWP Sub Processes"
        },
        {
            "author": "Syed Hasan (@syedhasan009)",
            "date": "2021/05/29",
            "description": "Detects the mount of an ISO image on an endpoint",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "ObjectName": [
                        "\\Device\\CdRom0\\autorun.ico",
                        "\\Device\\CdRom0\\setup.exe",
                        "\\Device\\CdRom0\\setup64.exe"
                    ]
                },
                "selection": {
                    "EventID": 4663,
                    "ObjectName|startswith": "\\Device\\CdRom",
                    "ObjectServer": "Security",
                    "ObjectType": "File"
                }
            },
            "falsepositives": [
                "Software installation ISO files"
            ],
            "id": "0248a7bc-8a9a-4cd8-a57e-3ae8e073a073",
            "level": "medium",
            "logsource": {
                "definition": "The advanced audit policy setting \"Object Access > Audit Removable Storage\" must be configured for Success/Failure",
                "product": "windows",
                "service": "security"
            },
            "modified": "2023/11/09",
            "status": "test",
            "references": [
                "https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore",
                "https://www.proofpoint.com/us/blog/threat-insight/threat-actor-profile-ta2719-uses-colorful-lures-deliver-rats-local-languages",
                "https://twitter.com/MsftSecIntel/status/1257324139515269121",
                "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image"
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "ISO Image Mounted"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/05/09",
            "description": "Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 5379,
                    "TargetName|contains|all": [
                        "Microsoft_Windows_Shell_ZipFolder:filename",
                        "\\Temporary Internet Files\\Content.Outlook"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate used of encrypted ZIP files"
            ],
            "id": "571498c8-908e-40b4-910b-d2369159a3da",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://twitter.com/sbousseaden/status/1523383197513379841"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.initial_access",
                "attack.t1027",
                "attack.t1566.001"
            ],
            "title": "Password Protected ZIP File Opened (Email Attachment)"
        },
        {
            "author": "Antonlovesdnb, Trent Liffick (@tliffick)",
            "date": "2020/02/19",
            "description": "Alerts on trust record modification within the registry, indicating usage of macros",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "\\Security\\Trusted Documents\\TrustRecords"
                }
            },
            "falsepositives": [
                "This will alert on legitimate macro usage as well, additional tuning is required"
            ],
            "id": "295a59c1-7b79-4b47-a930-df12c15fc9c2",
            "level": "medium",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2023/06/21",
            "status": "test",
            "references": [
                "https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/",
                "http://az4n6.blogspot.com/2016/02/more-on-trust-records-macros-and.html",
                "https://twitter.com/inversecos/status/1494174785621819397"
            ],
            "related": [
                {
                    "id": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.initial_access",
                "attack.t1566.001"
            ],
            "title": "Windows Registry Trust Record Modification"
        }
    ]
}