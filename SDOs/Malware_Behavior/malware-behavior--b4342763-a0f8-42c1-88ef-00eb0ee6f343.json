{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--b4342763-a0f8-42c1-88ef-00eb0ee6f343",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:44.616161Z",
    "name": "Unsecured Credentials: Credentials In Files",
    "description": "Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.It is possible to extract passwords from backups or saved virtual machines through OS Credential Dumping.[1] Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller.[2]In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.[3] They may also be found as parameters to deployment commands in container logs.[4] In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.[5]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1552/001",
            "external_id": "T1552/001"
        },
        {
            "source_name": "CAPEC 191",
            "external_id": "malware-behavior--88a05437-a35b-47f7-a3ef-1159bc5d351b"
        },
        {
            "source_name": "CAPEC 639",
            "external_id": "malware-behavior--efd72166-96bf-49d1-b3c6-934f26b4f578"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/16",
            "description": "Identifies when a Keyvault Key is modified or deleted in Azure.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/UPDATE/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/CREATE",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/CREATE/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/IMPORT/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/RECOVER/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/RESTORE/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/DELETE",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/BACKUP/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/KEYS/PURGE/ACTION"
                    ]
                }
            },
            "falsepositives": [
                "Key being modified or deleted may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Key modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "80eeab92-0979-4152-942d-96749e11df40",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.credential_access",
                "attack.t1552",
                "attack.t1552.001"
            ],
            "title": "Azure Keyvault Key Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/16",
            "description": "Identifies when secrets are modified or deleted in Azure.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/WRITE",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/DELETE",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/BACKUP/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/PURGE/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/UPDATE/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/RECOVER/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/RESTORE/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/SECRETS/SETSECRET/ACTION"
                    ]
                }
            },
            "falsepositives": [
                "Secrets being modified or deleted may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Secrets modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "b831353c-1971-477b-abb6-2828edc3bca1",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.credential_access",
                "attack.t1552",
                "attack.t1552.001"
            ],
            "title": "Azure Keyvault Secrets Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/16",
            "description": "Identifies when a key vault is modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.KEYVAULT/VAULTS/WRITE",
                        "MICROSOFT.KEYVAULT/VAULTS/DELETE",
                        "MICROSOFT.KEYVAULT/VAULTS/DEPLOY/ACTION",
                        "MICROSOFT.KEYVAULT/VAULTS/ACCESSPOLICIES/WRITE"
                    ]
                }
            },
            "falsepositives": [
                "Key Vault being modified or deleted may be performed by a system administrator.",
                "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Key Vault modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "459a2970-bb84-4e6a-a32e-ff0fbd99448d",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.credential_access",
                "attack.t1552",
                "attack.t1552.001"
            ],
            "title": "Azure Key Vault Modified or Deleted"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/11",
            "description": "Collect pertinent data from the configuration files",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "show running-config",
                    "show startup-config",
                    "show archive config",
                    "more"
                ]
            },
            "falsepositives": [
                "Commonly run by administrators"
            ],
            "id": "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
            "level": "low",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "references": [
                "https://blog.router-switch.com/2013/11/show-running-config/",
                "https://www.cisco.com/E-Learning/bulk/public/tac/cim/cib/using_cisco_ios_software/cmdrefs/show_startup-config.htm",
                "https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/config-mgmt/configuration/15-sy/config-mgmt-15-sy-book/cm-config-diff.html"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.credential_access",
                "attack.collection",
                "attack.t1087.001",
                "attack.t1552.001",
                "attack.t1005"
            ],
            "title": "Cisco Collect Data"
        },
        {
            "author": "Igor Fits, Mikhail Larin, oscd.community",
            "date": "2020/10/19",
            "description": "Detecting attempts to extract passwords with grep and laZagne",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "CommandLine|contains": "password",
                    "Image|endswith": "/grep"
                },
                "selection2": {
                    "CommandLine|contains": "laZagne"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "53b1b378-9b06-4992-b972-dde6e423d2b4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001"
            ],
            "title": "Credentials In Files"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/07/23",
            "description": "Detects files written by the different tools that exploit HiveNightmare",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "TargetFilename|contains": [
                            "\\hive_sam_",
                            "\\SAM-2021-",
                            "\\SAM-2022-",
                            "\\SAM-2023-",
                            "\\SAM-haxx",
                            "\\Sam.save"
                        ]
                    },
                    {
                        "TargetFilename": "C:\\windows\\temp\\sam"
                    }
                ]
            },
            "falsepositives": [
                "Files that accidentally contain these strings"
            ],
            "id": "6ea858a8-ba71-4a12-b2cc-5d83312404c7",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://github.com/GossiTheDog/HiveNightmare",
                "https://github.com/FireFart/hivenightmare/",
                "https://github.com/WiredPulse/Invoke-HiveNightmare",
                "https://twitter.com/cube0x0/status/1418920190759378944"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001",
                "cve.2021.36934"
            ],
            "title": "HackTool - Typical HiveNightmare SAM File Export"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/14",
            "description": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database to a suspicious directory.",
            "detection": {
                "condition": "all of selection_*",
                "selection_flag": {
                    "CommandLine|contains": "snapshot"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\ADExplorer.exe"
                    },
                    {
                        "OriginalFileName": "AdExp"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        "\\Downloads\\",
                        "\\Users\\Public\\",
                        "\\AppData\\",
                        "\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ef61af62-bc74-4f58-b49b-626448227652",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html"
            ],
            "related": [
                {
                    "id": "9212f354-7775-4e28-9c9f-8f0a4544e664",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001",
                "attack.t1003.003"
            ],
            "title": "Suspicious Active Directory Database Snapshot Via ADExplorer"
        },
        {
            "author": "frack113",
            "date": "2021/07/28",
            "description": "Once established within a system or network, an adversary may use automated techniques for collecting internal data.",
            "detection": {
                "condition": "selection_ext and 1 of selection_other_*",
                "selection_ext": {
                    "CommandLine|contains": [
                        ".doc",
                        ".docx",
                        ".xls",
                        ".xlsx",
                        ".ppt",
                        ".pptx",
                        ".rtf",
                        ".pdf",
                        ".txt"
                    ]
                },
                "selection_other_dir": {
                    "CommandLine|contains|all": [
                        "dir ",
                        " /b ",
                        " /s "
                    ]
                },
                "selection_other_findstr": {
                    "CommandLine|contains": [
                        " /e ",
                        " /si "
                    ],
                    "OriginalFileName": "FINDSTR.EXE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f576a613-2392-4067-9d1a-9345fb58d8d1",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/11/11",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.collection",
                "attack.t1119",
                "attack.credential_access",
                "attack.t1552.001"
            ],
            "title": "Automated Collection Command Prompt"
        },
        {
            "id": "9212f354-7775-4e28-9c9f-8f0a4544e664",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/14",
            "description": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "snapshot"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\ADExplorer.exe"
                    },
                    {
                        "OriginalFileName": "AdExp"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "ef61af62-bc74-4f58-b49b-626448227652"
                }
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001",
                "attack.t1003.003"
            ],
            "title": "Active Directory Database Snapshot Via ADExplorer"
        },
        {
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2023/12/04",
            "description": "Detects commandline keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "Offline_Winpwn",
                        "WinPwn ",
                        "WinPwn.exe",
                        "WinPwn.ps1"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d557dc06-62e8-4468-a8e8-7984124908ce",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/S3cur3Th1sSh1t/WinPwn",
                "https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841",
                "https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/",
                "https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md",
                "https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team"
            ],
            "related": [
                {
                    "id": "851fd622-b675-4d26-b803-14bc7baa517a",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.discovery",
                "attack.execution",
                "attack.privilege_escalation",
                "attack.t1046",
                "attack.t1082",
                "attack.t1106",
                "attack.t1518",
                "attack.t1548.002",
                "attack.t1552.001",
                "attack.t1555",
                "attack.t1555.003"
            ],
            "title": "HackTool - WinPwn Execution"
        },
        {
            "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/05",
            "description": "Detects execution of \"findstr\" with specific flags and a remote share path. This specific set of CLI flags would allow \"findstr\" to download the content of the file located on the remote share as described in the LOLBAS entry.\n",
            "detection": {
                "condition": "selection_findstr and all of selection_cli_download_*",
                "selection_cli_download_1": {
                    "CommandLine|contains|windash": " -v "
                },
                "selection_cli_download_2": {
                    "CommandLine|contains|windash": " -l "
                },
                "selection_cli_download_3": {
                    "CommandLine|contains": "\\\\\\\\"
                },
                "selection_findstr": [
                    {
                        "CommandLine|contains": "findstr"
                    },
                    {
                        "Image|endswith": "findstr.exe"
                    },
                    {
                        "OriginalFileName": "FINDSTR.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "587254ee-a24b-4335-b3cd-065c0f1f4baa",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
                "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "related": [
                {
                    "id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1564.004",
                "attack.t1552.001",
                "attack.t1105"
            ],
            "title": "Remote File Download Via Findstr.EXE"
        },
        {
            "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/05",
            "description": "Detects execution of findstr with the \"s\" and \"i\" flags for a \"subfolder\" and \"insensitive\" search respectively. Attackers sometimes leverage this built-in utility to search the system for interesting files or filter through results of commands.\n",
            "detection": {
                "condition": "selection_findstr and all of selection_cli_search_*",
                "selection_cli_search_insensitive": {
                    "CommandLine|contains|windash": " -i "
                },
                "selection_cli_search_subfolder": {
                    "CommandLine|contains|windash": " -s "
                },
                "selection_findstr": [
                    {
                        "CommandLine|contains": "findstr"
                    },
                    {
                        "Image|endswith": "findstr.exe"
                    },
                    {
                        "OriginalFileName": "FINDSTR.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Administrative or software activity"
            ],
            "id": "04936b66-3915-43ad-a8e5-809eadfd1141",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
                "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "related": [
                {
                    "id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1564.004",
                "attack.t1552.001",
                "attack.t1105"
            ],
            "title": "Insensitive Subfolder Search Via Findstr.EXE"
        },
        {
            "author": "frack113",
            "date": "2021/12/19",
            "description": "Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials.\nThese can be files created by users to store their own credentials, shared credential stores for a group of individuals,\nconfiguration files containing passwords for a system or service, or source code/binary files containing embedded passwords.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "ls",
                        " -R",
                        "select-string ",
                        "-Pattern "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bd5971a7-626d-46ab-8176-ed643f694f68",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001"
            ],
            "title": "Extracting Information with PowerShell"
        },
        {
            "id": "851fd622-b675-4d26-b803-14bc7baa517a",
            "author": "Swachchhanda Shrawan Poudel",
            "date": "2023/12/04",
            "description": "Detects scriptblock text keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Offline_Winpwn",
                        "WinPwn ",
                        "WinPwn.exe",
                        "WinPwn.ps1"
                    ]
                }
            },
            "falsepositives": [
                "As the script block is a blob of text. False positive may occur with scripts that contain the keyword as a reference or simply use it for detection."
            ],
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/S3cur3Th1sSh1t/WinPwn",
                "https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841",
                "https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/",
                "https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md",
                "https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "d557dc06-62e8-4468-a8e8-7984124908ce"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.credential_access",
                "attack.defense_evasion",
                "attack.discovery",
                "attack.execution",
                "attack.privilege_escalation",
                "attack.t1046",
                "attack.t1082",
                "attack.t1106",
                "attack.t1518",
                "attack.t1548.002",
                "attack.t1552.001",
                "attack.t1555",
                "attack.t1555.003"
            ],
            "title": "HackTool - WinPwn Execution - ScriptBlock"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/01/31",
            "description": "Detects when the file \"passwd\" or \"shadow\" is copied from tmp path",
            "detection": {
                "condition": "all of selection_*",
                "selection_file": {
                    "CommandLine|contains": [
                        "passwd",
                        "shadow"
                    ]
                },
                "selection_img": {
                    "Image|endswith": "/cp"
                },
                "selection_path": {
                    "CommandLine|contains": "/tmp/"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "fa4aaed5-4fe0-498d-bbc0-08e3346387ba",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.blackberry.com/",
                "https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144"
            ],
            "status": "test",
            "title": "Copy Passwd Or Shadow From TMP Path",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/20",
            "description": "Detects events with patterns found in commands used for reconnaissance on linux systems",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        " -name .htpasswd",
                        " -perm -4000 "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "0cf7a157-8879-41a2-8f55-388dd23746b7",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://github.com/sleventyeleven/linuxprivchecker/blob/0d701080bbf92efd464e97d71a70f97c6f2cd658/linuxprivchecker.py"
            ],
            "status": "test",
            "tags": [
                "attack.reconnaissance",
                "attack.t1592.004",
                "attack.credential_access",
                "attack.t1552.001"
            ],
            "title": "Linux Recon Indicators"
        },
        {
            "author": "Igor Fits, oscd.community",
            "date": "2020/10/15",
            "description": "Detecting attempts to extract passwords with grep",
            "detection": {
                "condition": "selection and keywords",
                "keywords": {
                    "|all": [
                        "grep",
                        "password"
                    ]
                },
                "selection": {
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "df3fcaea-2715-4214-99c5-0056ea59eb35",
            "level": "high",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2023/04/30",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1552.001"
            ],
            "title": "Credentials In Files - Linux"
        }
    ]
}