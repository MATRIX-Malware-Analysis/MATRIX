{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--1a072ab7-aaca-4eb1-88f7-9f91a8199b68",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:45.450171Z",
    "name": "Compromise Host Software Binary",
    "description": "Adversaries may modify host software binaries to establish persistent access to systems. Software binaries/executables provide a wide range of system commands or services, programs, and libraries. Common software binaries are SSH clients, FTP clients, email clients, web browsers, and many other user or server applications.Adversaries may establish persistence though modifications to host software binaries. For example, an adversary may replace or otherwise infect a legitimate application binary (or support files) with a backdoor. Since these binaries may be routinely executed by applications or the user, the adversary can leverage this for persistent access to the host.An adversary may also modify an existing binary by patching in malicious functionality (e.g., IAT Hooking/Entry point patching)[1] prior to the binary\u2019s legitimate execution. For example, an adversary may modify the entry point of a binary to point to malicious code patched in by the adversary before resuming normal execution flow.[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1554",
            "external_id": "T1554"
        },
        {
            "source_name": "CAPEC 642",
            "external_id": "malware-behavior--0e3645de-4623-448d-ac81-0aff74bfc50f"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1554",
            "external_id": "T1554"
        },
        {
            "source_name": "Unit42 Banking Trojans Hooking 2022",
            "description": "Or Chechik. (2022, October 31). Banking Trojan Techniques: How Financially Motivated Malware Became Infrastructure. Retrieved September 27, 2023.",
            "url": "https://unit42.paloaltonetworks.com/banking-trojan-techniques/#post-125550-_rm3d6xxbk52n"
        },
        {
            "source_name": "ESET FontOnLake Analysis 2021",
            "description": "Vladislav Hr\u010dka. (2021, January 1). FontOnLake. Retrieved September 27, 2023.",
            "url": "https://web-assets.esetstatic.com/wls/2021/10/eset_fontonlake.pdf"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2021/04/12",
            "description": "Detects Azure Hybrid Connection Manager services querying the Azure service bus service",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|contains": "HybridConnectionManager",
                    "QueryName|contains": "servicebus.windows.net"
                }
            },
            "falsepositives": [
                "Legitimate use of Azure Hybrid Connection Manager and the Azure Service Bus service"
            ],
            "id": "7bd3902d-8b8b-4dd4-838a-c6862d40150d",
            "level": "high",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/01/16",
            "references": [
                "https://twitter.com/Cyb3rWard0g/status/1381642789369286662"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1554"
            ],
            "title": "DNS HybridConnectionManager Service Bus"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2021/04/12",
            "description": "Rule to detect the Hybrid Connection Manager service running on an endpoint.",
            "detection": {
                "condition": "selection and keywords",
                "keywords": [
                    "HybridConnection",
                    "sb://",
                    "servicebus.windows.net",
                    "HybridConnectionManage"
                ],
                "selection": {
                    "EventID": [
                        40300,
                        40301,
                        40302
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of Hybrid Connection Manager via Azure function apps."
            ],
            "id": "b55d23e5-6821-44ff-8a6e-67218891e49f",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "microsoft-servicebus-client"
            },
            "modified": "2022/10/09",
            "references": [
                "https://twitter.com/Cyb3rWard0g/status/1381642789369286662"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1554"
            ],
            "title": "HybridConnectionManager Service Running"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2021/04/12",
            "description": "Rule to detect the Hybrid Connection Manager service installation.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4697,
                    "ServiceFileName|contains": "HybridConnectionManager",
                    "ServiceName": "HybridConnectionManager"
                }
            },
            "falsepositives": [
                "Legitimate use of Hybrid Connection Manager via Azure function apps."
            ],
            "id": "0ee4d8a5-4e67-4faf-acfa-62a78457d1f2",
            "level": "high",
            "logsource": {
                "definition": "The 'System Security Extension' audit subcategory need to be enabled to log the EID 4697",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/10/09",
            "references": [
                "https://twitter.com/Cyb3rWard0g/status/1381642789369286662"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1554"
            ],
            "title": "HybridConnectionManager Service Installation"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "CrowdStrike Falcon OverWatch"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "persistence"
        }
    ],
    "x_mitre_detection": "Collect and analyze signing certificate metadata and check signature validity on software that executes within the environment. Look for changes to client software that do not correlate with known software or patch cycles. \n\nConsider monitoring for anomalous behavior from client applications, such as atypical module loads, file reads/writes, or network connections.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.0",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "File: File Deletion",
        "File: File Modification",
        "File: File Metadata",
        "File: File Creation"
    ],
    "x_mitre_permissions_required": []
}