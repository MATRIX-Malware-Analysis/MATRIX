{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--d6131a68-5360-4fd7-af35-5e0fb6814c84",
    "created": "2024-08-13T14:46:37.10731Z",
    "modified": "2024-08-13T14:46:48.636935Z",
    "name": "Event Triggered Execution: Screensaver",
    "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.[1] The Windows screensaver application scrnsave.scr is located in C:\\Windows\\System32\\, and C:\\Windows\\sysWOW64\\  on 64-bit Windows systems, along with screensavers included with base Windows installations.The following screensaver settings are stored in the Registry (HKCU\\Control Panel\\Desktop\\) and could be manipulated to achieve persistence:SCRNSAVE.exe - set to malicious PE pathScreenSaveActive - set to '1' to enable the screensaverScreenSaverIsSecure - set to '0' to not require a password to unlockScreenSaveTimeout - sets user inactivity timeout before screensaver is executedAdversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity.[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1546/002",
            "external_id": "T1546/002"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "string": "SCRNSAVE.EXE"
                            },
                            {
                                "optional": [
                                    {
                                        "string": "ScreenSaveTimeOut"
                                    },
                                    {
                                        "string": "Control Panel\\Desktop"
                                    },
                                    {
                                        "match": "set registry value"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Persistence::Event Triggered Execution::Screensaver [T1546.002]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "description": "SCRNSAVE.EXE registry value specifies the name of the screen saver executable file",
                    "name": "reference screen saver executable",
                    "namespace": "persistence/screensaver",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113",
            "date": "2021/12/29",
            "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity.\nScreensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension\n",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_generic": {
                    "Image|endswith": [
                        "\\Kindle.exe",
                        "\\Bin\\ccSvcHst.exe"
                    ]
                },
                "filter_tiworker": {
                    "Image|endswith": "\\TiWorker.exe",
                    "TargetFilename|endswith": "\\uwfservicingscr.scr"
                },
                "selection": {
                    "TargetFilename|endswith": ".scr"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "97aa2e88-555c-450d-85a6-229bcd87efb8",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/11/08",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1546.002"
            ],
            "title": "Suspicious Screensaver Binary File Creation"
        },
        {
            "author": "frack113",
            "date": "2022/01/01",
            "description": "Aversaries may use to interact with a remote network share using Server Message Block (SMB).\nThis technique is used by post-exploitation frameworks.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains|all": [
                        "\\\\\\\\127.0.0",
                        "\\ADMIN$\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4aafb0fa-bff5-4b9d-b99e-8093e659c65f",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/08/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.002/T1021.002.md#atomic-test-4---execute-command-writing-output-to-local-admin-share"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1546.002"
            ],
            "title": "Writing Local Admin Share"
        },
        {
            "author": "frack113",
            "date": "2021/08/19",
            "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity.\nScreensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension\n",
            "detection": {
                "condition": "selection_reg and 1 of selection_option_*",
                "selection_option_1": {
                    "CommandLine|contains|all": [
                        "/v ScreenSaveActive",
                        "/t REG_SZ",
                        "/d 1",
                        "/f"
                    ]
                },
                "selection_option_2": {
                    "CommandLine|contains|all": [
                        "/v ScreenSaveTimeout",
                        "/t REG_SZ",
                        "/d ",
                        "/f"
                    ]
                },
                "selection_option_3": {
                    "CommandLine|contains|all": [
                        "/v ScreenSaverIsSecure",
                        "/t REG_SZ",
                        "/d 0",
                        "/f"
                    ]
                },
                "selection_option_4": {
                    "CommandLine|contains|all": [
                        "/v SCRNSAVE.EXE",
                        "/t REG_SZ",
                        "/d ",
                        ".scr",
                        "/f"
                    ]
                },
                "selection_reg": {
                    "CommandLine|contains": [
                        "HKEY_CURRENT_USER\\Control Panel\\Desktop",
                        "HKCU\\Control Panel\\Desktop"
                    ],
                    "Image|endswith": "\\reg.exe"
                }
            },
            "falsepositives": [
                "GPO"
            ],
            "id": "0fc35fc3-efe6-4898-8a37-0b233339524f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/06/02",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md",
                "https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.privilege_escalation",
                "attack.t1546.002"
            ],
            "title": "Suspicious ScreenSave Change by Reg.exe"
        },
        {
            "author": "Bartlomiej Czyz @bczyz1, oscd.community",
            "date": "2020/10/11",
            "description": "Detects value modification of registry key containing path to binary used as screensaver.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": [
                        "\\rundll32.exe",
                        "\\explorer.exe"
                    ]
                },
                "selection": {
                    "TargetObject|endswith": "\\Control Panel\\Desktop\\SCRNSAVE.EXE"
                }
            },
            "falsepositives": [
                "Legitimate modification of screensaver"
            ],
            "id": "67a6c006-3fbe-46a7-9074-2ba3b82c3000",
            "level": "medium",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md",
                "https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1546.002"
            ],
            "title": "Path To Screensaver Binary Modified"
        }
    ]
}