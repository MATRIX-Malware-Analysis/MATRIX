{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--bc0f956c-ff3f-41d0-8b80-805d2e5479ff",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.494243Z",
    "name": "Indicator Removal",
    "description": "Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary\u2019s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform.Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1070",
            "external_id": "T1070"
        },
        {
            "source_name": "CAPEC 268",
            "external_id": "malware-behavior--2d937180-2912-4747-a752-17bdfa7fcab7"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1070",
            "external_id": "T1070"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "get file version info"
                            },
                            {
                                "api": "kernel32.BeginUpdateResource"
                            },
                            {
                                "api": "kernel32.UpdateResource"
                            },
                            {
                                "api": "kernel32.EndUpdateResource"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Indicator Removal [T1070]"
                    ],
                    "authors": [
                        "awillia2@cisco.com"
                    ],
                    "description": "Looks for Windows API calls associated with reading and then writing file version information of executables on disk. Malware can use these calls to overwrite its own version information with that of a legitimate executable on the system (for instance, explorer.exe) to make it appear to be a legitimate application.",
                    "examples": [
                        "e5369ac309f1be6d77afeeb3edab0ed8:0x4025A0"
                    ],
                    "name": "impersonate file version information",
                    "namespace": "anti-analysis/anti-forensic",
                    "references": [
                        "https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-updateresourcea",
                        "https://www.carbonblack.com/blog/threat-analysis-dont-forget-about-kangaroo-ransomware/"
                    ],
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "api": "SHEmptyRecycleBin"
                            },
                            {
                                "instruction": [
                                    {
                                        "or": [
                                            {
                                                "and": [
                                                    {
                                                        "mnemonic": "cmp"
                                                    },
                                                    {
                                                        "number": "7 = SHERB_NOSOUND|SHERB_NOPROGRESSUI|SHERB_NOCONFIRMATION"
                                                    }
                                                ]
                                            },
                                            {
                                                "and": [
                                                    {
                                                        "mnemonic": "lea"
                                                    },
                                                    {
                                                        "offset": "7 = SHERB_NOSOUND|SHERB_NOPROGRESSUI|SHERB_NOCONFIRMATION"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Indicator Removal [T1070]"
                    ],
                    "authors": [
                        "matthew.williams@mandiant.com"
                    ],
                    "examples": [
                        "276F691A3DF25481F59D79781799E35F:0x1400254E0"
                    ],
                    "name": "empty recycle bin quietly",
                    "namespace": "host-interaction/recycle-bin",
                    "references": [
                        "https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shemptyrecyclebina"
                    ],
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "basic block"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Janantha Marasinghe",
            "date": "2022/12/13",
            "description": "Detects an instance of an SES identity being deleted via the \"DeleteIdentity\" event. This may be an indicator of an adversary removing the account that carried out suspicious or malicious activities",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "DeleteIdentity",
                    "eventSource": "ses.amazonaws.com"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "20f754db-d025-4a8f-9d74-e0037e999a9a",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/12/28",
            "references": [
                "https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ],
            "title": "SES Identity Has Been Deleted"
        },
        {
            "author": "Leo Tsaousis (@laripping)",
            "date": "2024/03/26",
            "description": "Detects when events are deleted in Kubernetes.\nAn adversary may delete Kubernetes events in an attempt to evade detection.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "objectRef.resource": "events",
                    "verb": "delete"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3132570d-cab2-4561-9ea6-1743644b2290",
            "level": "medium",
            "logsource": {
                "category": "application",
                "product": "kubernetes",
                "service": "audit"
            },
            "references": [
                "https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Delete%20K8S%20events/"
            ],
            "related": [
                {
                    "id": "225d8b09-e714-479c-a0e4-55e6f29adf35",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.t1070"
            ],
            "title": "Kubernetes Events Deleted"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "Clear command history in network OS which is used for defense evasion",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "clear logging",
                    "clear archive"
                ]
            },
            "falsepositives": [
                "Legitimate administrators may run these commands"
            ],
            "id": "ceb407f6-8277-439b-951f-e4210e3ed956",
            "level": "high",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/05/26",
            "references": [
                "https://www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5000/sw/command/reference/sysmgmt/n5k-sysmgmt-cr/n5k-sm_cmds_c.html",
                "https://www.cisco.com/c/en/us/td/docs/ios/12_2sr/12_2sra/feature/guide/srmgtint.html#wp1127609"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.003"
            ],
            "title": "Cisco Clear Logs"
        },
        {
            "author": "Austin Clark",
            "date": "2019/08/12",
            "description": "See what files are being deleted from flash file systems",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "erase",
                    "delete",
                    "format"
                ]
            },
            "falsepositives": [
                "Will be used sometimes by admins to clean up local flash space"
            ],
            "fields": [
                "CmdSet"
            ],
            "id": "71d65515-c436-43c0-841b-236b1f32c21e",
            "level": "medium",
            "logsource": {
                "product": "cisco",
                "service": "aaa"
            },
            "modified": "2023/01/04",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1070.004",
                "attack.t1561.001",
                "attack.t1561.002"
            ],
            "title": "Cisco File Deletion"
        },
        {
            "author": "remotephone, oscd.community",
            "date": "2020/10/11",
            "description": "Detects deletion of local audit logs",
            "detection": {
                "condition": "selection1 and 1 of selection_cli*",
                "selection1": {
                    "Image|endswith": [
                        "/rm",
                        "/unlink",
                        "/shred"
                    ]
                },
                "selection_cli_1": {
                    "CommandLine|contains": "/var/log"
                },
                "selection_cli_2": {
                    "CommandLine|contains|all": [
                        "/Users/",
                        "/Library/Logs/"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "acf61bd8-d814-4272-81f0-a7a269aa69aa",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/09/16",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.002"
            ],
            "title": "Indicator Removal on Host - Clear Mac System Logs"
        },
        {
            "author": "Igor Fits, Mikhail Larin, oscd.community",
            "date": "2020/10/19",
            "description": "Detect file time attribute change to hide new or changes to existing files",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "-t",
                        "-acmr",
                        "-d",
                        "-r"
                    ],
                    "Image|endswith": "/touch"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "88c0f9d8-30a8-4120-bb6b-ebb54abcf2a0",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2022/01/12",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.006"
            ],
            "title": "File Time Attribute Change"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/17",
            "description": "Detects when a system process (i.e. located in system32, syswow64, etc.) loads a DLL from a suspicious location or a location with permissive permissions such as \"C:\\Users\\Public\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ImageLoaded|startswith": [
                        "C:\\Users\\Public\\",
                        "C:\\PerfLogs\\"
                    ],
                    "Image|startswith": "C:\\Windows\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9e9a9002-56c4-40fd-9eff-e4b09bfa5f6c",
            "level": "medium",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC (Idea)"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ],
            "title": "DLL Load By System Process From Suspicious Locations"
        },
        {
            "author": "Tim Rauch (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/16",
            "description": "Detects the deletion of IIS WebServer access logs which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "\\inetpub\\logs\\LogFiles\\",
                    "TargetFilename|endswith": ".log"
                }
            },
            "falsepositives": [
                "During uninstallation of the IIS service",
                "During log rotation"
            ],
            "id": "3eb8c339-a765-48cc-a150-4364c04652bf",
            "level": "medium",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "modified": "2023/02/15",
            "references": [
                "https://www.elastic.co/guide/en/security/current/webserver-access-logs-deleted.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ],
            "title": "IIS WebServer Access Logs Deleted"
        },
        {
            "author": "frack113",
            "date": "2022/01/16",
            "description": "Detects the deletion of the TeamViewer log files which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image": "C:\\Windows\\system32\\svchost.exe"
                },
                "selection": {
                    "TargetFilename|contains": "\\TeamViewer_",
                    "TargetFilename|endswith": ".log"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b1decb61-ed83-4339-8e95-53ea51901720",
            "level": "low",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "modified": "2023/02/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "TeamViewer Log File Deleted"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/15",
            "description": "Detects the deletion of the PowerShell console History logs which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "\\PSReadLine\\ConsoleHost_history.txt"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ff301988-c231-4bd0-834c-ac9d73b86586",
            "level": "medium",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "title": "PowerShell Console History Logs Deleted",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/09/04",
            "description": "Detects the deletion of the \"Zone.Identifier\" ADS by an uncommon process. Attackers can leverage this in order to bypass security restrictions that make use of the ADS such as Microsoft Office apps.",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "Image": [
                        "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                        "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                        "C:\\Windows\\explorer.exe",
                        "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                        "C:\\Windows\\SysWOW64\\explorer.exe",
                        "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
                    ]
                },
                "filter_optional_browsers_chrome": {
                    "Image": [
                        "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
                        "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"
                    ]
                },
                "filter_optional_browsers_firefox": {
                    "Image": [
                        "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe",
                        "C:\\Program Files\\Mozilla Firefox\\firefox.exe"
                    ]
                },
                "selection": {
                    "TargetFilename|endswith": ":Zone.Identifier"
                }
            },
            "falsepositives": [
                "Other third party applications not listed."
            ],
            "id": "3109530e-ab47-4cc6-a953-cac5ebcc93ae",
            "level": "medium",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "modified": "2024/04/26",
            "references": [
                "https://securityliterate.com/how-malware-abuses-the-zone-identifier-to-circumvent-detection-and-analysis/",
                "Internal Research"
            ],
            "related": [
                {
                    "id": "7eac0a16-5832-4e81-865f-0268a6d19e4b",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "ADS Zone.Identifier Deleted By Uncommon Application"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/16",
            "description": "Detects the deletion of tomcat WebServer logs which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": [
                        "catalina.",
                        "_access_log.",
                        "localhost."
                    ],
                    "TargetFilename|contains|all": [
                        "\\Tomcat",
                        "\\logs\\"
                    ]
                }
            },
            "falsepositives": [
                "During uninstallation of the tomcat server",
                "During log rotation"
            ],
            "id": "270185ff-5f50-4d6d-a27f-24c3b8c9fef8",
            "level": "medium",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "references": [
                "Internal Research",
                "https://linuxhint.com/view-tomcat-logs-windows/"
            ],
            "status": "test",
            "title": "Tomcat WebServer Logs Deleted",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/26",
            "description": "Detects the deletion of the Exchange PowerShell cmdlet History logs which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "_Cmdlet_",
                    "TargetFilename|startswith": "\\Logging\\CmdletInfra\\LocalPowerShell\\Cmdlet\\"
                }
            },
            "falsepositives": [
                "Possible FP during log rotation"
            ],
            "id": "a55349d8-9588-4c5a-8e3b-1925fe2a4ffe",
            "level": "high",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ],
            "title": "Exchange PowerShell Cmdlet History Deleted"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/15",
            "description": "Detects the deletion of the event log files which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": ".evtx",
                    "TargetFilename|startswith": "C:\\Windows\\System32\\winevt\\Logs\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "63c779ba-f638-40a0-a593-ddd45e8b1ddc",
            "level": "medium",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "title": "EventLog EVTX File Deleted",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "author": "Cedric MAURUGEON",
            "date": "2021/09/29",
            "description": "Detects the deletion of a prefetch file which may indicate an attempt to destroy forensic evidence",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_svchost": {
                    "Image|endswith": ":\\windows\\system32\\svchost.exe",
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "selection": {
                    "TargetFilename|contains": ":\\Windows\\Prefetch\\",
                    "TargetFilename|endswith": ".pf"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0a1f9d29-6465-4776-b091-7f43b26e4c89",
            "level": "high",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "modified": "2024/01/25",
            "references": [
                "Internal Research",
                "https://www.group-ib.com/blog/hunting-for-ttps-with-prefetch-files/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "Prefetch File Deleted"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "Detects the deletion of files by the Sysinternals SDelete utility. It looks for the common name pattern used to rename files.",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_wireshark": {
                    "TargetFilename|endswith": "\\Wireshark\\radius\\dictionary.alcatel-lucent.aaa"
                },
                "selection": {
                    "TargetFilename|endswith": [
                        ".AAA",
                        ".ZZZ"
                    ]
                }
            },
            "falsepositives": [
                "Legitime usage of SDelete"
            ],
            "id": "6ddab845-b1b8-49c2-bbf7-1a11967f64bc",
            "level": "medium",
            "logsource": {
                "category": "file_delete",
                "product": "windows"
            },
            "modified": "2023/02/15",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/9",
                "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/4.B.4_83D62033-105A-4A02-8B75-DAB52D8D51EC.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "File Deleted Via Sysinternals SDelete"
        },
        {
            "author": "frack113",
            "date": "2024/05/10",
            "description": "Detects file access requests to Windows Outlook Mail by uncommon processes.\nCould indicate potential attempt of credential stealing.\nRequires heavy baselining before usage\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\Windows\\system32\\",
                        ":\\Windows\\SysWOW64\\"
                    ]
                },
                "filter_main_system": {
                    "Image": "System"
                },
                "filter_optional_defender": {
                    "Image|contains": ":\\ProgramData\\Microsoft\\Windows Defender\\",
                    "Image|endswith": [
                        "\\MpCopyAccelerator.exe",
                        "\\MsMpEng.exe"
                    ]
                },
                "filter_optional_thor": {
                    "Image|endswith": [
                        "\\thor64.exe",
                        "\\thor.exe"
                    ]
                },
                "selection_unistore": {
                    "FileName|contains": "\\AppData\\Local\\Comms\\Unistore\\data"
                },
                "selection_unistoredb": {
                    "FileName|endswith": "\\AppData\\Local\\Comms\\UnistoreDB\\store.vol"
                }
            },
            "falsepositives": [
                "Antivirus, Anti-Spyware, Anti-Malware Software",
                "Backup software",
                "Legitimate software installed on partitions other than \"C:\\\"",
                "Searching software such as \"everything.exe\""
            ],
            "id": "fc3e237f-2fef-406c-b90d-b3ae7e02fa8f",
            "level": "low",
            "logsource": {
                "category": "file_access",
                "product": "windows",
                "definition": "Requirements: Microsoft-Windows-Kernel-File ETW provider"
            },
            "references": [
                "https://darkdefender.medium.com/windows-10-mail-app-forensics-39025f5418d2",
                "https://github.com/redcanaryco/atomic-red-team/blob/58496ee3306e6e42a7054d36a94e6eb561ee3081/atomics/T1070.008/T1070.008.md#atomic-test-4---copy-and-modify-mailbox-data-on-windows"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1070.008",
                "attack.defense_evasion"
            ],
            "title": "Access To Windows Outlook Mail Files By Uncommon Application"
        },
        {
            "author": "frack113, Florian Roth (Nextron Systems)",
            "date": "2022/08/12",
            "description": "Attackers may change the file creation time of a backdoor to make it look like it was installed with the operating system.\nNote that many processes legitimately change the creation time of a file; it does not necessarily indicate malicious activity.\n",
            "detection": {
                "condition": "(( selection1 and not filter1 ) or ( selection2 and not filter2 )) and not 1 of gen_filter*",
                "filter1": {
                    "CreationUtcTime|startswith": "2022"
                },
                "filter2": {
                    "CreationUtcTime|startswith": "202"
                },
                "gen_filter_tiworker": {
                    "Image|endswith": "\\TiWorker.exe",
                    "Image|startswith": "C:\\WINDOWS\\",
                    "TargetFilename|endswith": ".cab"
                },
                "gen_filter_updates": [
                    {
                        "Image": [
                            "C:\\Windows\\system32\\ProvTool.exe",
                            "C:\\Windows\\System32\\usocoreworker.exe",
                            "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"
                        ]
                    },
                    {
                        "TargetFilename|startswith": "C:\\ProgramData\\USOPrivate\\UpdateStore\\"
                    },
                    {
                        "TargetFilename|endswith": [
                            ".tmp",
                            ".temp"
                        ]
                    }
                ],
                "selection1": {
                    "PreviousCreationUtcTime|startswith": "2022"
                },
                "selection2": {
                    "PreviousCreationUtcTime|startswith": "202"
                }
            },
            "falsepositives": [
                "Changes made to or by the local NTP service"
            ],
            "id": "558eebe5-f2ba-4104-b339-36f7902bcc1a",
            "level": "high",
            "logsource": {
                "category": "file_change",
                "product": "windows"
            },
            "modified": "2022/10/25",
            "references": [
                "https://www.inversecos.com/2022/04/defence-evasion-technique-timestomping.html"
            ],
            "status": "test",
            "tags": [
                "attack.t1070.006",
                "attack.defense_evasion"
            ],
            "title": "File Creation Date Changed to Another Year"
        },
        {
            "author": "@neu5ron",
            "date": "2019/02/07",
            "description": "Detects potential malicious and unauthorized usage of bcdedit.exe",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "delete",
                        "deletevalue",
                        "import",
                        "safeboot",
                        "network"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bcdedit.exe"
                    },
                    {
                        "OriginalFileName": "bcdedit.exe"
                    }
                ]
            },
            "id": "c9fbe8e9-119d-40a6-9b59-dd58a5d84429",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set",
                "https://twitter.com/malwrhunterteam/status/1372536434125512712/photo/2"
            ],
            "modified": "2023/02/15",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.persistence",
                "attack.t1542.003"
            ],
            "title": "Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE"
        },
        {
            "author": "X__Junior (Nextron Systems)",
            "date": "2023/07/18",
            "description": "Detects uncommon and potentially suspicious one-liner command containing both \"ping\" and \"copy\" at the same time, which is usually used by malware.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_action": {
                    "CommandLine|contains|all": [
                        "ping",
                        "copy "
                    ]
                },
                "selection_cli_1": {
                    "CommandLine|contains|windash": " -n "
                },
                "selection_cli_2": {
                    "CommandLine|contains|windash": " -y "
                },
                "selection_cmd": [
                    {
                        "Image|endswith": "\\cmd.exe"
                    },
                    {
                        "OriginalFileName": "Cmd.Exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ded2b07a-d12f-4284-9b76-653e37b6c8b0",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "references": [
                "Internal Research"
            ],
            "modified": "2024/03/06",
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "Potentially Suspicious Ping/Copy Command Combination"
        },
        {
            "author": "Ecco, Daniil Yugoslavskiy, oscd.community, D3F7A5105",
            "date": "2019/09/26",
            "description": "Detects the clearing or configuration tampering of EventLog using utilities such as \"wevtutil\", \"powershell\" and \"wmic\".\nThis technique were seen used by threat actors and ransomware strains in order to evade defenses.\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_*",
                "filter_msiexec": {
                    "CommandLine|contains": " sl ",
                    "ParentImage": [
                        "C:\\Windows\\SysWOW64\\msiexec.exe",
                        "C:\\Windows\\System32\\msiexec.exe"
                    ]
                },
                "selection_other_ps": {
                    "CommandLine|contains": [
                        "Clear-EventLog ",
                        "Remove-EventLog ",
                        "Limit-EventLog ",
                        "Clear-WinEvent "
                    ],
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                },
                "selection_other_wmi": {
                    "CommandLine|contains": "ClearEventLog",
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\wmic.exe"
                    ]
                },
                "selection_wevtutil": {
                    "CommandLine|contains": [
                        "clear-log ",
                        " cl ",
                        "set-log ",
                        " sl ",
                        "lfn:"
                    ],
                    "Image|endswith": "\\wevtutil.exe"
                }
            },
            "falsepositives": [
                "Admin activity",
                "Scripts and administrative tools used in the monitored environment",
                "Maintenance activity"
            ],
            "id": "cc36992a-4671-4f21-a91d-6c2b72a2edf5",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/07/13",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.001/T1070.001.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
                "https://gist.github.com/fovtran/ac0624983c7722e80a8f5a4babb170ee",
                "https://jdhnet.wordpress.com/2017/12/19/changing-the-location-of-the-windows-event-logs/"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.001",
                "attack.t1562.002",
                "car.2016-04-002"
            ],
            "title": "Suspicious Eventlog Clearing or Configuration Change Activity"
        },
        {
            "author": "Ilya Krestinichev",
            "date": "2022/11/03",
            "description": "Detects a method often used by ransomware. Which combines the \"ping\" to wait a couple of seconds and then \"del\" to delete the file in question. Its used to hide the file responsible for the initial infection for example",
            "detection": {
                "condition": "all of selection_*",
                "selection_all": {
                    "CommandLine|contains|all": [
                        "ping",
                        "del "
                    ]
                },
                "selection_count": {
                    "CommandLine|contains|windash": " -n "
                },
                "selection_del_param": {
                    "CommandLine|contains|windash": [
                        " -f ",
                        " -q "
                    ]
                },
                "selection_nul": {
                    "CommandLine|contains": "Nul"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "54786ddc-5b8a-11ed-9b6a-0242ac120002",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2024/03/05",
            "references": [
                "https://blog.sygnia.co/kaseya-ransomware-supply-chain-attack",
                "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/06/23093553/Common-TTPs-of-the-modern-ransomware_low-res.pdf",
                "https://www.acronis.com/en-us/blog/posts/lockbit-ransomware/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "Suspicious Ping/Del Command Combination"
        },
        {
            "author": "Kirill Kiryanov, oscd.community",
            "date": "2019/10/23",
            "description": "Detects possible Sysmon filter driver unloaded via fltmc.exe",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "unload",
                        "sysmon"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\fltMC.exe"
                    },
                    {
                        "OriginalFileName": "fltMC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "4d7cda18-1b12-4e52-b45c-d28653210df8",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/02/13",
            "references": [
                "https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon"
            ],
            "related": [
                {
                    "id": "4931188c-178e-4ee7-a348-39e8a7a56821",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562",
                "attack.t1562.002"
            ],
            "title": "Sysmon Driver Unloaded Via Fltmc.EXE"
        },
        {
            "author": "oscd.community, @redcanary, Zach Stanford @svch0st",
            "date": "2020/10/08",
            "description": "Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "share",
                        "/delete"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\net.exe",
                            "\\net1.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "net.exe",
                            "net1.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Administrators or Power users may remove their shares via cmd line"
            ],
            "id": "cb7c4a03-2871-43c0-9bbb-18bbdb079896",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2023/02/21",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.005"
            ],
            "title": "Unmount Share Via Net.EXE"
        },
        {
            "author": "frack113",
            "date": "2022/01/15",
            "description": "Detects execution of the builtin \"rmdir\" command in order to delete directories.\nAdversaries may delete files left behind by the actions of their intrusion activity.\nMalware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how.\nRemoval of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        "/s",
                        "/q"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\cmd.exe"
                    },
                    {
                        "OriginalFileName": "Cmd.Exe"
                    }
                ],
                "selection_rmdir": {
                    "CommandLine|contains": "rmdir"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "41ca393d-538c-408a-ac27-cf1e038be80c",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2023/03/07",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "Directory Removal Via Rmdir"
        },
        {
            "author": "Florian Roth (Nextron Systems), Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community, Andreas Hunkeler (@Karneades)",
            "date": "2019/10/22",
            "description": "Shadow Copies deletion using operating systems utilities",
            "detection": {
                "condition": "(all of selection1*) or (all of selection2*) or (all of selection3*)",
                "selection1_cli": {
                    "CommandLine|contains|all": [
                        "shadow",
                        "delete"
                    ]
                },
                "selection1_img": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\wmic.exe",
                            "\\vssadmin.exe",
                            "\\diskshadow.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll",
                            "wmic.exe",
                            "VSSADMIN.EXE",
                            "diskshadow.exe"
                        ]
                    }
                ],
                "selection2_cli": {
                    "CommandLine|contains|all": [
                        "delete",
                        "catalog",
                        "quiet"
                    ]
                },
                "selection2_img": [
                    {
                        "Image|endswith": "\\wbadmin.exe"
                    },
                    {
                        "OriginalFileName": "WBADMIN.EXE"
                    }
                ],
                "selection3_cli": {
                    "CommandLine|contains": [
                        "unbounded",
                        "/MaxSize="
                    ],
                    "CommandLine|contains|all": [
                        "resize",
                        "shadowstorage"
                    ]
                },
                "selection3_img": [
                    {
                        "Image|endswith": "\\vssadmin.exe"
                    },
                    {
                        "OriginalFileName": "VSSADMIN.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate Administrator deletes Shadow Copies using operating systems utilities for legitimate reason",
                "LANDesk LDClient Ivanti-PSModule (PS EncodedCommand)"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "c947b146-0abc-4c87-9c64-b17e9d7274a2",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2022/11/03",
            "status": "stable",
            "references": [
                "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
                "https://blog.talosintelligence.com/2017/05/wannacry.html",
                "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/",
                "https://www.bleepingcomputer.com/news/security/why-everyone-should-disable-vssadmin-exe-now/",
                "https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100",
                "https://github.com/Neo23x0/Raccine#the-process",
                "https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/gen_ransomware_command_lines.yar",
                "https://redcanary.com/blog/intelligence-insights-october-2021/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1070",
                "attack.t1490"
            ],
            "title": "Shadow Copies Deletion Using Operating Systems Utilities"
        },
        {
            "id": "4931188c-178e-4ee7-a348-39e8a7a56821",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/13",
            "description": "Detect filter driver unloading activity via fltmc.exe",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_avira": {
                    "CommandLine|endswith": "unload rtp_filesystem_filter",
                    "ParentImage|contains": "\\AppData\\Local\\Temp\\",
                    "ParentImage|endswith": "\\endpoint-protection-installer-x64.tmp",
                    "ParentImage|startswith": "C:\\Users\\"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\fltMC.exe"
                    },
                    {
                        "OriginalFileName": "fltMC.exe"
                    }
                ],
                "filter_optional_manageengine": {
                    "CommandLine|endswith": "unload DFMFilter",
                    "ParentImage": "C:\\Program Files (x86)\\ManageEngine\\uems_agent\\bin\\dcfaservice64.exe"
                },
                "selection_cli": {
                    "CommandLine|contains": "unload"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2024/06/24",
            "references": [
                "https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon",
                "https://www.cybereason.com/blog/threat-analysis-report-lockbit-2.0-all-paths-lead-to-ransom"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "4d7cda18-1b12-4e52-b45c-d28653210df8"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562",
                "attack.t1562.002"
            ],
            "title": "Filter Driver Unloaded Via Fltmc.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/02/11",
            "description": "Detects the execution of \"logman\" utility in order to disable or delete Windows trace sessions",
            "detection": {
                "condition": "all of selection*",
                "selection_action": {
                    "CommandLine|contains": [
                        "stop ",
                        "delete "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\logman.exe"
                    },
                    {
                        "OriginalFileName": "Logman.exe"
                    }
                ],
                "selection_service": {
                    "CommandLine|contains": [
                        "Circular Kernel Context Logger",
                        "EventLog-",
                        "SYSMON TRACE",
                        "SysmonDnsEtwSession"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate deactivation by administrative staff",
                "Installer tools that disable services, e.g. before log collection agent installation"
            ],
            "id": "cd1f961e-0b96-436b-b7c6-38da4583ec00",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/02/21",
            "references": [
                "https://twitter.com/0gtweet/status/1359039665232306183?s=21",
                "https://ss64.com/nt/logman.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1562.001",
                "attack.t1070.001"
            ],
            "title": "Suspicious Windows Trace ETW Session Tamper Via Logman.EXE"
        },
        {
            "author": "frack113",
            "date": "2022/01/15",
            "description": "Detects execution of the builtin \"del\"/\"erase\" commands in order to delete files.\nAdversaries may delete files left behind by the actions of their intrusion activity.\nMalware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how.\nRemoval of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_del": {
                    "CommandLine|contains": [
                        "del ",
                        "erase "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\cmd.exe"
                    },
                    {
                        "OriginalFileName": "Cmd.Exe"
                    }
                ],
                "selection_flags": {
                    "CommandLine|contains|windash": [
                        " -f",
                        " -s",
                        " -q"
                    ]
                }
            },
            "falsepositives": [
                "False positives levels will differ Depending on the environment. You can use a combination of ParentImage and other keywords from the CommandLine field to filter legitimate activity"
            ],
            "id": "379fa130-190e-4c3f-b7bc-6c8e834485f3",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2024/03/05",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "File Deletion Via Del"
        },
        {
            "author": "frack113 , X__Junior (Nextron Systems)",
            "date": "2021/12/02",
            "description": "Detects execution of the \"del\" builtin command to remove files using greedy/wildcard expression. This is often used by malware to delete content of folders that perhaps contains the initial malware infection or to delete evidence.",
            "detection": {
                "condition": "all of selection_*",
                "selection_del": {
                    "CommandLine|contains": [
                        "del ",
                        "erase "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\cmd.exe"
                    },
                    {
                        "OriginalFileName": "Cmd.Exe"
                    }
                ],
                "selection_extensions": {
                    "CommandLine|contains": [
                        "\\\\\\*.au3",
                        "\\\\\\*.dll",
                        "\\\\\\*.exe",
                        "\\\\\\*.js"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "204b17ae-4007-471b-917b-b917b315c5db",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/09/11",
            "references": [
                "https://www.joesandbox.com/analysis/509330/0/html#1044F3BDBE3BB6F734E357235F4D5898582D",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "Greedy File Deletion Using Del"
        },
        {
            "author": "Ecco, E.M. Anhaus, oscd.community",
            "date": "2019/09/26",
            "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc).\nMight be used by ransomwares during the attack (seen by NotPetya and others).\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "deletejournal",
                        "createjournal",
                        "setZeroData"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\fsutil.exe"
                    },
                    {
                        "OriginalFileName": "fsutil.exe"
                    }
                ]
            },
            "falsepositives": [
                "Admin activity",
                "Scripts and administrative tools used in the monitored environment"
            ],
            "id": "add64136-62e5-48ea-807e-88638d02df1e",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2023/09/09",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070/T1070.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html",
                "https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md",
                "https://blog.cluster25.duskrise.com/2023/05/22/back-in-black-blackbyte-nt"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1070",
                "attack.t1485"
            ],
            "title": "Fsutil Suspicious Invocation"
        },
        {
            "author": "@neu5ron, Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
            "date": "2019/03/22",
            "description": "Detects command line activity that tries to clear or disable any ETW trace log which could be a sign of logging evasion.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_clear_1": {
                    "CommandLine|contains|all": [
                        "cl",
                        "/Trace"
                    ]
                },
                "selection_clear_2": {
                    "CommandLine|contains|all": [
                        "clear-log",
                        "/Trace"
                    ]
                },
                "selection_disable_1": {
                    "CommandLine|contains|all": [
                        "sl",
                        "/e:false"
                    ]
                },
                "selection_disable_2": {
                    "CommandLine|contains|all": [
                        "set-log",
                        "/e:false"
                    ]
                },
                "selection_disable_3": {
                    "CommandLine|contains|all": [
                        "logman",
                        "update",
                        "trace",
                        "--p",
                        "-ets"
                    ]
                },
                "selection_pwsh_remove": {
                    "CommandLine|contains": "Remove-EtwTraceProvider"
                },
                "selection_pwsh_set": {
                    "CommandLine|contains|all": [
                        "Set-EtwTraceProvider",
                        "0x11"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a238b5d0-ce2d-4414-a676-7a531b3d13d6",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2022/06/28",
            "references": [
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
                "https://abuse.io/lockergoga.txt",
                "https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562.006",
                "car.2016-04-002"
            ],
            "title": "ETW Trace Evasion Activity"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/01/10",
            "description": "One of the Windows Eventlogs has been cleared. e.g. caused by \"wevtutil cl\" command execution",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_covered": {
                    "Channel": [
                        "Microsoft-Windows-PowerShell/Operational",
                        "Microsoft-Windows-Sysmon/Operational",
                        "PowerShellCore/Operational",
                        "Security",
                        "System",
                        "Windows PowerShell"
                    ]
                },
                "selection": {
                    "EventID": 104,
                    "Provider_Name": "Microsoft-Windows-Eventlog"
                }
            },
            "falsepositives": [
                "Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)",
                "System provisioning (system reset before the golden image creation)"
            ],
            "id": "a62b37e0-45d3-48d9-a517-90c1a1b0186b",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2023/11/15",
            "references": [
                "https://twitter.com/deviouspolack/status/832535435960209408",
                "https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100"
            ],
            "related": [
                {
                    "id": "f2f01843-e7b8-4f95-a35a-d23584476423",
                    "type": "obsoletes"
                },
                {
                    "id": "d99b79d2-0a6f-4f46-ad8b-260b6e17f982",
                    "type": "derived"
                },
                {
                    "id": "100ef69e-3327-481c-8e5c-6d80d9507556",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.001",
                "car.2016-04-002"
            ],
            "title": "Eventlog Cleared"
        },
        {
            "id": "100ef69e-3327-481c-8e5c-6d80d9507556",
            "author": "Florian Roth (Nextron Systems), Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/05/17",
            "description": "Detects the clearing of one of the Windows Core Eventlogs. e.g. caused by \"wevtutil cl\" command execution",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 104,
                    "Channel": [
                        "Microsoft-Windows-PowerShell/Operational",
                        "Microsoft-Windows-Sysmon/Operational",
                        "PowerShellCore/Operational",
                        "Security",
                        "System",
                        "Windows PowerShell"
                    ],
                    "Provider_Name": "Microsoft-Windows-Eventlog"
                }
            },
            "falsepositives": [
                "Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)",
                "System provisioning (system reset before the golden image creation)"
            ],
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2023/11/15",
            "references": [
                "https://twitter.com/deviouspolack/status/832535435960209408",
                "https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "a62b37e0-45d3-48d9-a517-90c1a1b0186b"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.001",
                "car.2016-04-002"
            ],
            "title": "Important Windows Eventlog Cleared"
        },
        {
            "author": "Florian Roth (Nextron Systems), Tom U. @c_APT_ure (collection)",
            "date": "2017/05/12",
            "description": "Detects backup catalog deletions",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 524,
                    "Provider_Name": "Microsoft-Windows-Backup"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9703792d-fd9a-456d-a672-ff92efe4806a",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "application"
            },
            "modified": "2022/12/25",
            "references": [
                "https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx",
                "https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "Backup Catalog Deleted"
        },
        {
            "author": "Thomas Patzke",
            "date": "2017/06/14",
            "description": "Detects renaming of file while deletion with SDelete tool.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4656,
                        4663,
                        4658
                    ],
                    "ObjectName|endswith": [
                        ".AAA",
                        ".ZZZ"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate usage of SDelete"
            ],
            "id": "39a80702-d7ca-4a83-b776-525b1f86a36d",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2021/11/27",
            "references": [
                "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/sdelete.htm",
                "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
                "https://learn.microsoft.com/en-gb/sysinternals/downloads/sdelete"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1070.004",
                "attack.t1027.005",
                "attack.t1485",
                "attack.t1553.002",
                "attack.s0195"
            ],
            "title": "Secure Deletion with SDelete"
        },
        {
            "author": "@neu5ron",
            "date": "2019/02/05",
            "description": "Detect scenarios where a potentially unauthorized application or user is modifying the system time.",
            "detection": {
                "condition": "selection and not 1 of filter*",
                "filter1": {
                    "ProcessName": [
                        "C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe",
                        "C:\\Windows\\System32\\VBoxService.exe",
                        "C:\\Windows\\System32\\oobe\\msoobe.exe"
                    ]
                },
                "filter2": {
                    "ProcessName": "C:\\Windows\\System32\\svchost.exe",
                    "SubjectUserSid": "S-1-5-19"
                },
                "selection": {
                    "EventID": 4616
                }
            },
            "falsepositives": [
                "HyperV or other virtualization technologies with binary not listed in filter portion of detection"
            ],
            "id": "faa031b5-21ed-4e02-8881-2591f98d82ed",
            "level": "low",
            "logsource": {
                "definition": "Requirements: Audit Policy : System > Audit Security State Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Security State Change",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/08/03",
            "references": [
                "Private Cuckoo Sandbox (from many years ago, no longer have hash, NDA as well)",
                "Live environment caused by malware",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4616"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.006"
            ],
            "title": "Unauthorized System Time Modification"
        },
        {
            "id": "d99b79d2-0a6f-4f46-ad8b-260b6e17f982",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/01/10",
            "description": "One of the Windows Eventlogs has been cleared. e.g. caused by \"wevtutil cl\" command execution",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1102": {
                    "EventID": 1102,
                    "Provider_Name": "Microsoft-Windows-Eventlog"
                },
                "selection_517": {
                    "EventID": 517,
                    "Provider_Name": "Security"
                }
            },
            "falsepositives": [
                "Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)",
                "System provisioning (system reset before the golden image creation)"
            ],
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/02/24",
            "references": [
                "https://twitter.com/deviouspolack/status/832535435960209408",
                "https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100",
                "https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/SecurityEvent/SecurityEventLogCleared.yaml"
            ],
            "related": [
                {
                    "id": "f2f01843-e7b8-4f95-a35a-d23584476423",
                    "type": "obsoletes"
                },
                {
                    "id": "a122ac13-daf8-4175-83a2-72c387be339d",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.001",
                "car.2016-04-002"
            ],
            "title": "Security Eventlog Cleared"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/08/27",
            "description": "Detects removal of an exported Exchange mailbox which could be to cover tracks from ProxyShell exploit",
            "detection": {
                "condition": "keywords",
                "keywords": {
                    "|all": [
                        "Remove-MailboxExportRequest",
                        " -Identity ",
                        " -Confirm \"False\""
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "09570ae5-889e-43ea-aac0-0e1221fb3d95",
            "level": "high",
            "logsource": {
                "service": "msexchange-management",
                "product": "windows"
            },
            "modified": "2023/01/23",
            "references": [
                "https://github.com/rapid7/metasploit-framework/blob/1416b5776d963f21b7b5b45d19f3e961201e0aed/modules/exploits/windows/http/exchange_proxyshell_rce.rb#L430"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ],
            "title": "Remove Exported Mailbox from Exchange Webserver"
        },
        {
            "author": "Ali Alwashali",
            "date": "2022/08/21",
            "description": "Detects scripts or commands that disabled the Powershell command history by removing psreadline module",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Remove-Module",
                        "psreadline"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate script that disables the command history"
            ],
            "id": "602f5669-6927-4688-84db-0d4b7afb2150",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://twitter.com/DissectMalware/status/1062879286749773824"
            ],
            "status": "test",
            "title": "Disable Powershell Command History",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.003"
            ]
        },
        {
            "author": "frack113",
            "date": "2021/08/03",
            "description": "Adversaries may modify file time attributes to hide new or changes to existing files.\nTimestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder.\n",
            "detection": {
                "condition": "selection_ioc",
                "selection_ioc": {
                    "ScriptBlockText|contains": [
                        ".CreationTime =",
                        ".LastWriteTime =",
                        ".LastAccessTime =",
                        "[IO.File]::SetCreationTime",
                        "[IO.File]::SetLastAccessTime",
                        "[IO.File]::SetLastWriteTime"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate admin script"
            ],
            "id": "c6438007-e081-42ce-9483-b067fbef33c3",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md",
                "https://www.offensive-security.com/metasploit-unleashed/timestomp/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.006"
            ],
            "title": "Powershell Timestomp"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/11/25",
            "description": "Identifies when a user attempts to clear console history. An adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion.",
            "detection": {
                "condition": "selection1 or selection2a and selection2b",
                "selection1": {
                    "ScriptBlockText|contains": "Clear-History"
                },
                "selection2a": {
                    "ScriptBlockText|contains": [
                        "Remove-Item",
                        "rm"
                    ]
                },
                "selection2b": {
                    "ScriptBlockText|contains": [
                        "ConsoleHost_history.txt",
                        "(Get-PSReadlineOption).HistorySavePath"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bde47d4b-9987-405c-94c7-b080410e8ea7",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://stefanos.cloud/blog/kb/how-to-clear-the-powershell-command-history/",
                "https://www.shellhacks.com/clear-history-powershell/",
                "https://community.sophos.com/sophos-labs/b/blog/posts/powershell-command-history-forensics"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1070.003"
            ],
            "title": "Clearing Windows Console History"
        },
        {
            "author": "oscd.community, @redcanary, Zach Stanford @svch0st",
            "date": "2020/10/08",
            "description": "Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Remove-SmbShare",
                        "Remove-FileShare"
                    ]
                }
            },
            "falsepositives": [
                "Administrators or Power users may remove their shares via cmd line"
            ],
            "id": "66a4d409-451b-4151-94f4-a55d559c49b0",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.005"
            ],
            "title": "PowerShell Deleted Mounted Share"
        },
        {
            "author": "Ilyas Ochkov, Jonhnathan Ribeiro, Daniil Yugoslavskiy, oscd.community",
            "date": "2022/01/25",
            "description": "Detects keywords that could indicate clearing PowerShell history",
            "detection": {
                "condition": "1 of selection_* or all of selection1*",
                "selection1a": {
                    "ScriptBlockText|contains": [
                        "del",
                        "Remove-Item",
                        "rm"
                    ]
                },
                "selection1b": {
                    "ScriptBlockText|contains": "(Get-PSReadlineOption).HistorySavePath"
                },
                "selection_2": {
                    "ScriptBlockText|contains|all": [
                        "Set-PSReadlineOption",
                        "\u2013HistorySaveStyle",
                        "SaveNothing"
                    ]
                },
                "selection_3": {
                    "ScriptBlockText|contains|all": [
                        "Set-PSReadlineOption",
                        "-HistorySaveStyle",
                        "SaveNothing"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "26b692dc-1722-49b2-b496-a8258aa6371d",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/02",
            "references": [
                "https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a"
            ],
            "related": [
                {
                    "id": "dfba4ce1-e0ea-495f-986e-97140f31af2d",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.003"
            ],
            "title": "Clear PowerShell History - PowerShell"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/12",
            "description": "Detects usage of known powershell cmdlets such as \"Clear-EventLog\" to clear the Windows event logs",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Clear-EventLog ",
                        "Remove-EventLog ",
                        "Limit-EventLog ",
                        "Clear-WinEvent "
                    ]
                }
            },
            "falsepositives": [
                "Rare need to clear logs before doing something. Sometimes used by installers or cleaner scripts. The script should be investigated to determine if it's legitimate"
            ],
            "id": "0f017df3-8f5a-414f-ad6b-24aff1128278",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://twitter.com/oroneequalsone/status/1568432028361830402",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.001/T1070.001.md",
                "https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "cc36992a-4671-4f21-a91d-6c2b72a2edf5"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.001"
            ],
            "title": "Suspicious Eventlog Clear"
        },
        {
            "author": "frack113",
            "date": "2022/01/09",
            "description": "Open a handle on the drive volume via the \\\\.\\ DOS device path specifier and perform direct access read of the first few bytes of the volume.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "New-Object",
                        "IO.FileStream",
                        "\\\\\\\\.\\\\"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "70ad982f-67c8-40e0-a955-b920c2fa05cb",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/03/05",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1006/T1006.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.003"
            ],
            "title": "Suspicious IO.FileStream"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of powershell cmdlets to disable or remove ETW trace sessions",
            "detection": {
                "condition": "1 of selection*",
                "selection_pwsh_remove": {
                    "ScriptBlockText|contains": "Remove-EtwTraceProvider "
                },
                "selection_pwsh_set": {
                    "ScriptBlockText|contains|all": [
                        "Set-EtwTraceProvider ",
                        "0x11"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "115fdba9-f017-42e6-84cf-d5573bf2ddf8",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/11/25",
            "references": [
                "https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "a238b5d0-ce2d-4414-a676-7a531b3d13d6"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1562.006",
                "car.2016-04-002"
            ],
            "title": "Disable of ETW Trace - Powershell"
        },
        {
            "author": "Ilyas Ochkov, Jonhnathan Ribeiro, Daniil Yugoslavskiy, oscd.community",
            "date": "2019/10/25",
            "description": "Detects keywords that could indicate clearing PowerShell history",
            "detection": {
                "condition": "1 of selection_payload_* or all of selection_1*",
                "selection_1a_payload": {
                    "Payload|contains": [
                        "del",
                        "Remove-Item",
                        "rm"
                    ]
                },
                "selection_1b_payload": {
                    "Payload|contains": "(Get-PSReadlineOption).HistorySavePath"
                },
                "selection_payload_2": {
                    "Payload|contains|all": [
                        "Set-PSReadlineOption",
                        "\u2013HistorySaveStyle",
                        "SaveNothing"
                    ]
                },
                "selection_payload_3": {
                    "Payload|contains|all": [
                        "Set-PSReadlineOption",
                        "-HistorySaveStyle",
                        "SaveNothing"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "f99276ad-d122-4989-a09a-d00904a5f9d2",
            "level": "medium",
            "logsource": {
                "category": "ps_module",
                "product": "windows",
                "definition": "0ad03ef1-f21b-4a79-8ce8-e6900c54b65b"
            },
            "modified": "2022/12/02",
            "references": [
                "https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a"
            ],
            "related": [
                {
                    "id": "dfba4ce1-e0ea-495f-986e-97140f31af2d",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.003"
            ],
            "title": "Clear PowerShell History - PowerShell Module"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/10/19",
            "description": "Detects the deletion of registry keys containing the MSTSC connection history",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "EventType": "DeleteValue",
                    "TargetObject|contains": "\\Microsoft\\Terminal Server Client\\Default\\MRU"
                },
                "selection2": {
                    "EventType": "DeleteKey",
                    "TargetObject|contains": "\\Microsoft\\Terminal Server Client\\Servers\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "07bdd2f5-9c58-4f38-aec8-e101bb79ef8d",
            "level": "high",
            "logsource": {
                "category": "registry_delete",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://learn.microsoft.com/en-us/troubleshoot/windows-server/remote/remove-entries-from-remote-desktop-connection-computer",
                "http://woshub.com/how-to-clear-rdp-connections-history/",
                "https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070",
                "attack.t1112"
            ],
            "title": "Terminal Server Client Connection History Cleared - Registry"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/03/19",
            "description": "Detects changes to the \"MaxMpxCt\" registry value.\nMaxMpxCt specifies the maximum outstanding network requests for the server per client, which is used when negotiating a Server Message Block (SMB) connection with a client. Note if the value is set beyond 125 older Windows 9x clients will fail to negotiate.\nRansomware threat actors and operators (specifically BlackCat) were seen increasing this value in order to handle a higher volume of traffic.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "\\Services\\LanmanServer\\Parameters\\MaxMpxCt"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0e6a9e62-627e-496c-aef5-bfa39da29b5e",
            "level": "low",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://www.huntress.com/blog/blackcat-ransomware-affiliate-ttps",
                "https://securityscorecard.com/research/deep-dive-into-alphv-blackcat-ransomware",
                "https://www.intrinsec.com/alphv-ransomware-gang-analysis/?cn-reloaded=1",
                "https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/"
            ],
            "status": "experimental",
            "title": "MaxMpxCt Registry Value Changed",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.005"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/16",
            "description": "Administrative shares are hidden network shares created by Microsoft Windows NT operating systems that grant system administrators remote access to every disk volume on a network-connected system",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "\\Services\\LanmanServer\\Parameters\\",
                    "TargetObject|endswith": [
                        "\\AutoShareWks",
                        "\\AutoShareServer"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c7dcacd0-cc59-4004-b0a4-1d6cdebe6f3e",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md#atomic-test-4---disable-administrative-share-creation-at-startup"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.005"
            ],
            "title": "Disable Administrative Share Creation at Startup"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/01/11",
            "description": "Detects usage of the \"touch\" process in service file.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": " -t ",
                    "Image|endswith": "/touch",
                    "CommandLine|endswith": ".service"
                }
            },
            "falsepositives": [
                "Admin changing date of files."
            ],
            "id": "31545105-3444-4584-bebf-c466353230d2",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.blackberry.com/",
                "https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144"
            ],
            "status": "test",
            "title": "Touch Suspicious Service File",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.006"
            ]
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/07",
            "description": "Detects file deletion using \"rm\", \"shred\" or \"unlink\" commands which are used often by adversaries to delete files left behind by the actions of their intrusion activity",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/rm",
                        "/shred",
                        "/unlink"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "30aed7b6-d2c1-4eaf-9382-b6bc43e50c57",
            "level": "informational",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.004"
            ],
            "title": "File Deletion"
        },
        {
            "author": "\u00d6mer G\u00fcnal, oscd.community",
            "date": "2020/10/07",
            "description": "Detects attempts to clear logs on the system. Adversaries may clear system logs to hide evidence of an intrusion",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "/rm",
                        "/shred",
                        "/unlink"
                    ],
                    "CommandLine|contains": [
                        "/var/log",
                        "/var/spool/mail"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "80915f59-9b56-4616-9de0-fd0dea6c12fe",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.002"
            ],
            "title": "Clear Linux Logs"
        },
        {
            "author": "Max Altgelt (Nextron Systems), Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
            "date": "2021/10/15",
            "description": "Detects specific commands commonly used to remove or empty the syslog. Which is often used by attacker as a method to hide their tracks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "rm /var/log/syslog",
                        "rm -r /var/log/syslog",
                        "rm -f /var/log/syslog",
                        "rm -rf /var/log/syslog",
                        "unlink /var/log/syslog",
                        "unlink -r /var/log/syslog",
                        "unlink -f /var/log/syslog",
                        "unlink -rf /var/log/syslog",
                        "mv /var/log/syslog",
                        " >/var/log/syslog",
                        " > /var/log/syslog"
                    ]
                }
            },
            "falsepositives": [
                "Log rotation."
            ],
            "id": "3fcc9b35-39e4-44c0-a2ad-9e82b6902b31",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/09/15",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.002"
            ],
            "title": "Commands to Clear or Remove the Syslog"
        },
        {
            "author": "Tuan Le (NCSGroup), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/03/09",
            "description": "Detects linux package removal using builtin tools such as \"yum\", \"apt\", \"apt-get\" or \"dpkg\".",
            "detection": {
                "condition": "1 of selection_*",
                "selection_apt": {
                    "CommandLine|contains": [
                        "remove",
                        "purge"
                    ],
                    "Image|endswith": [
                        "/apt",
                        "/apt-get"
                    ]
                },
                "selection_dpkg": {
                    "CommandLine|contains": [
                        "--remove ",
                        " -r "
                    ],
                    "Image|endswith": "/dpkg"
                },
                "selection_rpm": {
                    "CommandLine|contains": " -e ",
                    "Image|endswith": "/rpm"
                },
                "selection_yum": {
                    "CommandLine|contains": [
                        "erase",
                        "remove"
                    ],
                    "Image|endswith": "/yum"
                }
            },
            "falsepositives": [
                "Administrator or administrator scripts might delete packages for several reasons (debugging, troubleshooting)."
            ],
            "id": "95d61234-7f56-465c-6f2d-b562c6fedbc4",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://sysdig.com/blog/mitre-defense-evasion-falco",
                "https://www.tutorialspoint.com/how-to-install-a-software-on-linux-using-yum-command",
                "https://linuxhint.com/uninstall_yum_package/",
                "https://linuxhint.com/uninstall-debian-packages/"
            ],
            "status": "test",
            "title": "Linux Package Uninstall",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070"
            ]
        },
        {
            "author": "Patrick Bareiss",
            "date": "2019/03/24",
            "description": "Detects commands that try to clear or tamper with the Linux command history.\nThis technique is used by threat actors in order to evade defenses and execute commands without them being recorded in files such as \"bash_history\" or \"zsh_history\".\n",
            "detection": {
                "condition": "keywords",
                "keywords": [
                    "cat /dev/null >*sh_history",
                    "cat /dev/zero >*sh_history",
                    "chattr +i*sh_history",
                    "echo \"\" >*sh_history",
                    "empty_bash_history",
                    "export HISTFILESIZE=0",
                    "history -c",
                    "history -w",
                    "ln -sf /dev/null *sh_history",
                    "ln -sf /dev/zero *sh_history",
                    "rm *sh_history",
                    "shopt -ou history",
                    "shopt -uo history",
                    "shred *sh_history",
                    "truncate -s0 *sh_history"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "fdc88d25-96fb-4b7c-9633-c0e417fdbd4e",
            "level": "high",
            "logsource": {
                "product": "linux"
            },
            "modified": "2024/04/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.003/T1070.003.md",
                "https://www.hackers-arise.com/post/2016/06/20/covering-your-bash-shell-tracks-antiforensics",
                "https://www.cadosecurity.com/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.003"
            ],
            "title": "Linux Command History Tampering"
        },
        {
            "author": "Igor Fits, oscd.community",
            "date": "2020/10/15",
            "description": "Detect file time attribute change to hide new or changes to existing files.",
            "detection": {
                "condition": "execve and touch and selection2",
                "execve": {
                    "type": "EXECVE"
                },
                "selection2": [
                    "-t",
                    "-acmr",
                    "-d",
                    "-r"
                ],
                "touch": [
                    "touch"
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b3cec4e7-6901-4b0d-a02d-8ab2d8eb818b",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/11/28",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1070.006"
            ],
            "title": "File Time Attribute Change - Linux"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Containers",
        "Network",
        "Office 365",
        "Google Workspace"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Brad Geesaman, @bradgeesaman",
        "Ed Williams, Trustwave, SpiderLabs",
        "Blake Strom, Microsoft 365 Defender"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "x_mitre_detection": "File system monitoring may be used to detect improper deletion or modification of indicator files.  Events not stored on the file system may require different detection mechanisms.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Scheduled Job: Scheduled Job Modification",
        "File: File Modification",
        "Firewall: Firewall Rule Modification",
        "User Account: User Account Authentication",
        "File: File Metadata",
        "User Account: User Account Deletion",
        "Process: OS API Execution",
        "Application Log: Application Log Content",
        "Command: Command Execution",
        "File: File Deletion",
        "Process: Process Creation",
        "Windows Registry: Windows Registry Key Modification",
        "Network Traffic: Network Traffic Content",
        "Windows Registry: Windows Registry Key Deletion"
    ],
    "x_mitre_permissions_required": []
}