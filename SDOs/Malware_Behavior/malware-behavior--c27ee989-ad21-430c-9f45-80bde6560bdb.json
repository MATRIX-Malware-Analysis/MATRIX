{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c27ee989-ad21-430c-9f45-80bde6560bdb",
    "created": "2024-08-13T14:46:37.051918Z",
    "modified": "2024-08-13T14:46:45.701158Z",
    "name": "Valid Accounts: Local Accounts",
    "description": "Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service.Local Accounts may also be abused to elevate privileges and harvest credentials through OS Credential Dumping. Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1078/003",
            "external_id": "T1078/003"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Sohan G (D4rkCiph3r)",
            "date": "2023/08/22",
            "description": "Detects attempts to create and/or add an account to the admin group, thus granting admin privileges.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " -o edit ",
                        " -a ",
                        " -t user",
                        "admin"
                    ],
                    "Image|endswith": "/dseditgroup"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "5d0fdb62-f225-42fb-8402-3dfe64da468a",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.003/T1078.003.md#atomic-test-5---add-a-newexisting-user-to-the-admin-group-using-dseditgroup-utility---macos",
                "https://ss64.com/osx/dseditgroup.html"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.privilege_escalation",
                "attack.t1078.003"
            ],
            "title": "User Added To Admin Group Via DseditGroup"
        },
        {
            "author": "Sohan G (D4rkCiph3r)",
            "date": "2023/03/19",
            "description": "Detects attempts to create and add an account to the admin group via \"dscl\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " -append ",
                        " /Groups/admin ",
                        " GroupMembership "
                    ],
                    "Image|endswith": "/dscl"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "b743623c-2776-40e0-87b1-682b975d0ca5",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.003/T1078.003.md#atomic-test-2---create-local-account-with-admin-privileges---macos",
                "https://ss64.com/osx/dscl.html"
            ],
            "related": [
                {
                    "id": "0c1ffcf9-efa9-436e-ab68-23a9496ebf5b",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.privilege_escalation",
                "attack.t1078.003"
            ],
            "title": "User Added To Admin Group Via Dscl"
        },
        {
            "author": "Sohan G (D4rkCiph3r)",
            "date": "2023/08/22",
            "description": "Detects attempts to enable the root account via \"dsenableroot\"",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_disable": {
                    "CommandLine|contains": " -d "
                },
                "selection": {
                    "Image|endswith": "/dsenableroot"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "821bcf4d-46c7-4b87-bc57-9509d3ba7c11",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1078.003/T1078.003.md",
                "https://github.com/elastic/detection-rules/blob/4312d8c9583be524578a14fe6295c3370b9a9307/rules/macos/persistence_enable_root_account.toml",
                "https://ss64.com/osx/dsenableroot.html"
            ],
            "status": "test",
            "tags": [
                "attack.t1078",
                "attack.t1078.001",
                "attack.t1078.003",
                "attack.initial_access",
                "attack.persistence"
            ],
            "title": "Root Account Enable Via Dsenableroot"
        },
        {
            "author": "Sohan G (D4rkCiph3r)",
            "date": "2023/03/19",
            "description": "Detects attempts to create and add an account to the admin group via \"sysadminctl\"",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " -addUser ",
                        " -admin "
                    ],
                    "Image|endswith": "/sysadminctl"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "652c098d-dc11-4ba6-8566-c20e89042f2b",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1078.003/T1078.003.md#atomic-test-3---create-local-account-with-admin-privileges-using-sysadminctl-utility---macos",
                "https://ss64.com/osx/sysadminctl.html"
            ],
            "related": [
                {
                    "id": "0c1ffcf9-efa9-436e-ab68-23a9496ebf5b",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.privilege_escalation",
                "attack.t1078.003"
            ],
            "title": "User Added To Admin Group Via Sysadminctl"
        },
        {
            "author": "juju4",
            "date": "2017/10/29",
            "description": "Detect remote login by Administrator user (depending on internal pattern).",
            "detection": {
                "condition": "selection",
                "selection": {
                    "AuthenticationPackageName": "Negotiate",
                    "EventID": 4624,
                    "LogonType": 10,
                    "TargetUserName|startswith": "Admin"
                }
            },
            "falsepositives": [
                "Legitimate administrative activity."
            ],
            "id": "0f63e1ef-1eb9-4226-9d54-8927ca08520a",
            "level": "low",
            "logsource": {
                "definition": "Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/10/09",
            "status": "test",
            "references": [
                "https://car.mitre.org/wiki/CAR-2016-04-005"
            ],
            "tags": [
                "attack.lateral_movement",
                "attack.t1078.001",
                "attack.t1078.002",
                "attack.t1078.003",
                "car.2016-04-005"
            ],
            "title": "Admin User Remote Logon"
        }
    ]
}