{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--08064958-ecac-4ce6-8c8f-23fb0740e650",
    "created": "2024-08-13T14:46:36.912939Z",
    "modified": "2024-08-13T14:46:48.393215Z",
    "name": "Software Packing: ",
    "description": "Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.[1] Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1027/002",
            "external_id": "T1027/002"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".nsp0"
                            },
                            {
                                "section": ".nsp1"
                            },
                            {
                                "section": ".nsp2"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "02179f3ba93663074740b5c0d283bae2"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with nspack",
                    "namespace": "anti-analysis/packer/nspack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "PESHiELD"
                            },
                            {
                                "section": "PESHiELD_1"
                            },
                            {
                                "string": "/ PE-SHiELD v[0-9]\\.[0-9]/"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "a3c0a2425ea84103adde03a92176424c"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with peshield",
                    "namespace": "anti-analysis/packer/peshield",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".aspack"
                            },
                            {
                                "section": ".adata"
                            },
                            {
                                "section": ".ASPack"
                            },
                            {
                                "section": "ASPack"
                            },
                            {
                                "string": "The procedure entry point %s could not be located in the dynamic link library %s"
                            },
                            {
                                "string": "The ordinal %u could not be located in the dynamic link library %s"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "2055994ff75b4309eee3a49c5749d306"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with ASPack",
                    "namespace": "anti-analysis/packer/aspack",
                    "references": [
                        "http://www.aspack.com/",
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "string": "A debugger has been found running in your system."
                            },
                            {
                                "string": "Please, unload it from memory and restart your program."
                            },
                            {
                                "string": "File corrupted!. This program has been manipulated and maybe"
                            },
                            {
                                "string": "it's infected by a Virus or cracked. This file won't work anymore."
                            },
                            {
                                "section": ".vmp0"
                            },
                            {
                                "section": ".vmp1"
                            },
                            {
                                "section": ".vmp2"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "971e599e6e707349eccea2fd4c8e5f67"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing::VMProtect [F0001.010]"
                    ],
                    "name": "packed with VMProtect",
                    "namespace": "anti-analysis/packer/vmprotect",
                    "references": [
                        "https://www.pcworld.com/article/2824572/leaked-programming-manual-may-help-criminals-develop-more-atm-malware.html",
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".y0da"
                            },
                            {
                                "section": ".y0da_1"
                            },
                            {
                                "section": ".yP"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "0cd2b334aede270b14868db28211cde3"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with y0da crypter",
                    "namespace": "anti-analysis/packer/y0da",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".Upack"
                            },
                            {
                                "section": ".ByDwing"
                            },
                            {
                                "string": "UpackByDwing@"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "9d98f8519d9fee8219caca5b31eef0bd"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with upack",
                    "namespace": "anti-analysis/packer/upack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "pebundle"
                            },
                            {
                                "section": "PEBundle"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "db9fe790b4e18abf55df31aa0b81e558"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with pebundle",
                    "namespace": "anti-analysis/packer/pebundle",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "class": "ConfusedByAttribute"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "b9f5bd514485fb06da39beff051b9fdc"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing::Confuser [F0001.009]"
                    ],
                    "name": "packed with Confuser",
                    "namespace": "anti-analysis/packer/confuser",
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".RLPack"
                            },
                            {
                                "section": ".packed"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "068a76d4823419b376d418cf03215d5c"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with rlpack",
                    "namespace": "anti-analysis/packer/rlpack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "Themida"
                            },
                            {
                                "section": ".Themida"
                            },
                            {
                                "section": ".themida"
                            },
                            {
                                "section": "WinLicen"
                            },
                            {
                                "section": ".winlice"
                            },
                            {
                                "count(section(        ))": "2 or more",
                                "description": "Section names containing 8 space characters observed in Themida 3.0.x packed files"
                            },
                            {
                                "and": [
                                    {
                                        "description": "Section names containing 3 and 8 space characters observed in Themida 2.1.x packed files"
                                    },
                                    {
                                        "section": "   "
                                    },
                                    {
                                        "section": "        "
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "8a132663bee5c2f0f5cbfebee1b55ac72934632bf32bc32d6e2dae797c9e6e35"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing::Themida [F0001.011]"
                    ],
                    "name": "packed with Themida",
                    "namespace": "anti-analysis/packer/themida",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "PELOCKnt"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "f0a6a1bd6d760497623611e8297a81df"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with pelocknt",
                    "namespace": "anti-analysis/packer/pelocknt",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "string": "Amber - Reflective PE Packer"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "john.gorman@mandiant.com"
                    ],
                    "examples": [
                        "bb7922d368a9a9c8d981837b5ad988f1"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with amber",
                    "namespace": "anti-analysis/packer/amber",
                    "references": [
                        "https://github.com/EgeBalci/amber"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "string": "main.packedPath"
                            },
                            {
                                "string": "main.unpackedPath"
                            },
                            {
                                "string": "main.footerMagic"
                            },
                            {
                                "optional": [
                                    {
                                        "string": "path   github.com/nirhaas/gopacker"
                                    },
                                    {
                                        "description": "LALALALA is the default magic footer; however, it can be changed.",
                                        "string": "LALALALA"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "jared.wilson@mandiant.com"
                    ],
                    "description": "The sample appears to be packed with GoPacker.",
                    "examples": [
                        "4122acca2f9ea98fc3f3ad040688e4ce"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing::Standard Compression [F0001.002]"
                    ],
                    "name": "packed with GoPacker",
                    "namespace": "anti-analysis/packer/gopacker",
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    },
                    "references": [
                        "https://github.com/nirhaas/gopacker"
                    ]
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "kkrunchy"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "f9ac6b16273556b3a57bf2c6d7e7db97"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with kkrunchy",
                    "namespace": "anti-analysis/packer/kkrunchy",
                    "references": [
                        "http://www.farbrausch.de/~fg/kkrunchy/",
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".huan"
                            },
                            {
                                "string": "[+] IAT Fix starts..."
                            },
                            {
                                "string": "     [+] Import by ordinal: "
                            },
                            {
                                "string": "     [+] Import by name: "
                            },
                            {
                                "string": "[!] There is a problem in relocation directory"
                            },
                            {
                                "string": "[!] No Relocation Table and Cannot load to the preferable address"
                            },
                            {
                                "string": "[+] All headers are copied"
                            },
                            {
                                "string": "[+] All sections are copied"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "jakub.jozwiak@mandiant.com"
                    ],
                    "examples": [
                        "378ecc1b2e60129c9f06bb6bb8042f2b95feca5f526a4c26a5c39707807fa259:0x140048000"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with Huan",
                    "namespace": "anti-analysis/packer/huan",
                    "references": [
                        "https://github.com/frkngksl/Huan"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "or": [
                                    {
                                        "mnemonic": "pusha"
                                    },
                                    {
                                        "mnemonic": "pushad"
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "mnemonic": "popa"
                                    },
                                    {
                                        "mnemonic": "popad"
                                    }
                                ]
                            },
                            {
                                "characteristic": "cross section flow"
                            },
                            {
                                "not": [
                                    {
                                        "match": "contain pusha popa sequence"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "Practical Malware Analysis Lab 18-01.exe_:0x409dc0"
                    ],
                    "name": "packed with generic packer",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing::Standard Compression [F0001.002]"
                    ],
                    "namespace": "anti-analysis/packer/generic",
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "format": "pe"
                                    },
                                    {
                                        "or": [
                                            {
                                                "section": "UPX0"
                                            },
                                            {
                                                "section": "UPX1"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "format": "elf"
                                    },
                                    {
                                        "or": [
                                            {
                                                "string": "UPX!"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "CD2CBA9E6313E8DF2C1273593E649682",
                        "Practical Malware Analysis Lab 01-02.exe_:0x0401000"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing::UPX [F0001.008]"
                    ],
                    "name": "packed with UPX",
                    "namespace": "anti-analysis/packer/upx",
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "PEC2TO"
                            },
                            {
                                "section": "PEC2"
                            },
                            {
                                "section": "pec"
                            },
                            {
                                "section": "pec1"
                            },
                            {
                                "section": "pec2"
                            },
                            {
                                "section": "pec3"
                            },
                            {
                                "section": "pec4"
                            },
                            {
                                "section": "pec5"
                            },
                            {
                                "section": "pec6"
                            },
                            {
                                "section": "PEC2MO"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "Practical Malware Analysis Lab 18-03.exe_"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with PECompact",
                    "namespace": "anti-analysis/packer/pecompact",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".petite"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@_re_fox"
                    ],
                    "examples": [
                        "2a7429d60040465f9bd27bbae2beef88"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with petite",
                    "namespace": "anti-analysis/packer/petite",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".taz"
                            },
                            {
                                "section": ".x64"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "jakub.jozwiak@mandiant.com"
                    ],
                    "examples": [
                        "23e19068ecba68d4396bc097e0278b8eca7e7dcaa4978e34d683231ad2219ae3",
                        "4b796a64abe7675254cd6f8a6c9b83949673158840a4a04c36e7c9068ec14cc8"
                    ],
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "name": "packed with PESpin",
                    "namespace": "anti-analysis/packer/pespin",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "string": "pyarmor_runtimesh"
                            },
                            {
                                "string": "PYARMOR"
                            },
                            {
                                "string": "__pyarmor__"
                            },
                            {
                                "string": "PYARMOR_SIGNATURE"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Execution::Command and Scripting Interpreter::Python [T1059.006]",
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@stvemillertime, @itreallynick"
                    ],
                    "examples": [
                        "a0fb20bc9aa944c3a0a6c4545c195818"
                    ],
                    "name": "compiled with pyarmor",
                    "namespace": "compiler/pyarmor",
                    "references": [
                        "https://twitter.com/stvemillertime/status/1349032548580483073"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "os": "windows"
                                    },
                                    {
                                        "3 or more": [
                                            {
                                                "string": "cx_Freeze Fatal Error"
                                            },
                                            {
                                                "string": "cx_Freeze: Python error in main script"
                                            },
                                            {
                                                "string": "cx_Freeze: Application Terminated"
                                            },
                                            {
                                                "string": "%ls\\lib\\library.zip;%ls\\lib"
                                            },
                                            {
                                                "string": "Unable to calculate directory of executable!"
                                            },
                                            {
                                                "string": "Unable to load python3.dll!"
                                            },
                                            {
                                                "string": "Unable to change DLL search path!"
                                            },
                                            {
                                                "string": "initializing with config file %ls"
                                            },
                                            {
                                                "string": "%ls --install <NAME> [<CONFIGFILE>]"
                                            },
                                            {
                                                "string": "exception calling session_changed method"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "or": [
                                            {
                                                "os": "linux"
                                            },
                                            {
                                                "os": "macos"
                                            }
                                        ]
                                    },
                                    {
                                        "3 or more": [
                                            {
                                                "string": "PATH environment variable not defined!"
                                            },
                                            {
                                                "string": "Unable to determine absolute path for executable!"
                                            },
                                            {
                                                "string": "Unable to convert path to string!"
                                            },
                                            {
                                                "string": "Unable to calculate directory of executable!"
                                            },
                                            {
                                                "string": "Out of memory creating sys.path!"
                                            },
                                            {
                                                "string": "Out of memory converting arguments!"
                                            },
                                            {
                                                "string": "Unable to convert argument to string!"
                                            },
                                            {
                                                "string": "%ls/lib/library.zip:%ls/lib"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Execution::Command and Scripting Interpreter::Python [T1059.006]",
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "@mr-tz",
                        "jakub.jozwiak@mandiant.com"
                    ],
                    "examples": [
                        "573174640974b288d9d161cf4d29387cd7dbf7d80a80f5547df887f9836df8fb"
                    ],
                    "name": "compiled with cx_Freeze",
                    "namespace": "compiler/cx_freeze",
                    "references": [
                        "https://github.com/marcelotduarte/cx_Freeze"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "!Epack"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Epack",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/epack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "PEPACK!!"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Pepack",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/pepack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".MaskPE"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with MaskPE",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/maskpe",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "MEW"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with MEW",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/mew",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".seau"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with SeauSFX",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/seausfx",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "DAStub"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Dragon Armor",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/dragon-armor",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".ccg"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with CCG",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/ccg",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".sforce3"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with StarForce",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/starforce",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".tsuarch"
                            },
                            {
                                "section": ".tsustub"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with TSULoader",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/tsuloader",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".MPRESS1"
                            },
                            {
                                "section": ".MPRESS2"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Mpress",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/mpress",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".spack"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Simple Pack",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/simple-pack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".enigma1"
                            },
                            {
                                "section": ".enigma2"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with enigma",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/enigma",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".WWPACK"
                            },
                            {
                                "section": ".WWP32"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with WWPACK",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/wwpack",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".perplex"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Perplex",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/perplex",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "ProCrypt"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with ProCrypt",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/procrypt",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".svkp"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with SVKP",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/svkp",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".neolite"
                            },
                            {
                                "section": ".neolit"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Neolite",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/neolite",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "VProtect"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with VProtect",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/vprotect",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "BitArts"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Crunch",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/crunch",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": "RCryptor"
                            },
                            {
                                "section": ".RCrypt"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with RPCrypt",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/rpcrypt",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "section": ".shrink1"
                            },
                            {
                                "section": ".shrink2"
                            },
                            {
                                "section": ".shrink3"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "packed with Shrinker",
                    "mbc": [
                        "Anti-Static Analysis::Software Packing [F0001]"
                    ],
                    "namespace": "anti-analysis/packer/shrinker",
                    "references": [
                        "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                    ],
                    "scopes": {
                        "dynamic": "file",
                        "static": "file"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Patrick St. John, OTR (Open Threat Research)",
            "date": "2020/05/03",
            "description": "Detects the image load of \"Python Core\" by a non-Python process. This might be indicative of a Python script bundled with Py2Exe.",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": [
                    {
                        "Image|contains": "Python"
                    },
                    {
                        "Image|startswith": [
                            "C:\\Program Files\\",
                            "C:\\Program Files (x86)\\",
                            "C:\\ProgramData\\Anaconda3\\"
                        ]
                    }
                ],
                "filter_optional_aurora": {
                    "Image": null
                },
                "selection": {
                    "Description": "Python Core"
                }
            },
            "falsepositives": [
                "Legitimate Py2Exe Binaries",
                "Known false positive caused with Python Anaconda"
            ],
            "id": "cbb56d62-4060-40f7-9466-d8aaf3123f83",
            "level": "medium",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://www.py2exe.org/",
                "https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1027.002"
            ],
            "title": "Python Image Load By Non-Python Process"
        }
    ]
}