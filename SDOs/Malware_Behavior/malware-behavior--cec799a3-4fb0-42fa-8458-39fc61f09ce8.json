{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--cec799a3-4fb0-42fa-8458-39fc61f09ce8",
    "created": "2024-08-13T14:46:36.626528Z",
    "modified": "2024-08-13T14:46:36.626528Z",
    "name": "DNS Cache Poisoning",
    "description": "A domain name server translates a domain name (such as www.example.com) into an IP address that Internet hosts use to contact Internet resources. An adversary modifies a public DNS cache to cause certain names to resolve to incorrect addresses that the adversary specifies. The result is that client applications that rely upon the targeted cache for domain name resolution will be directed not to the actual address of the specified domain name but to some other address. Adversaries can use this to herd clients to sites that install malware on the victim's computer or to masquerade as part of a Pharming attack.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/142.html",
            "external_id": "142"
        },
        {
            "source_name": "CWE",
            "external_id": "348"
        },
        {
            "source_name": "CWE",
            "external_id": "345"
        },
        {
            "source_name": "CWE",
            "external_id": "349"
        },
        {
            "source_name": "CWE",
            "external_id": "346"
        },
        {
            "source_name": "CWE",
            "external_id": "350"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "In this example, an adversary sends request to a local DNS server to look up www.example .com. The associated IP address of www.example.com is 1.3.5.7.\n               Local DNS usually caches IP addresses and do not go to remote DNS every time. Since the local record is not found, DNS server tries to connect to remote DNS for queries. However, before the remote DNS returns the right IP address 1.3.5.7, the adversary floods local DNS with crafted responses with IP address 2.4.6.8. The result is that 2.4.6.8 is stored in DNS cache. Meanwhile, 2.4.6.8 is associated with a malicious website www.maliciousexampsle.com\n               When users connect to www.example.com, the local DNS will direct it to www.maliciousexample.com, this works as part of a Pharming attack."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Explore resolver caches] Check DNS caches on local DNS server and client's browser with DNS cache enabled.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Run tools that check the resolver cache in the memory to see if it contains a target DNS entry.",
                "Figure out if the client's browser has DNS cache enabled."
            ]
        },
        {
            "description": "[Attempt sending crafted records to DNS cache] A request is sent to the authoritative server for target website and wait for the iterative name resolver. An adversary sends bogus request to the DNS local server, and then floods responses that trick a DNS cache to remember malicious responses, which are wrong answers of DNS query.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Adversary must know the transaction ID by intercepting a DNS query, or sending a bogus query with known transaction ID.",
                "If the transaction ID used to identify each query instance is randomized in some new DNS software, the attack must guess the transaction ID. Slow the response of the real DNS server by causing Denial-of-service. This gives adversaries enough time to guess transaction",
                "Adversary crafts DNS response with the same transaction ID as in the request. The adversary sends out DNS responses before the authorized DNS server. This forces DNS local cache stores fake DNS response (wrong answer). The fake DNS responses usually include a malicious website's IP address."
            ]
        },
        {
            "description": "[Redirect users to malicious website] As the adversary succeeds in exploiting the vulnerability, the victim connects to a malicious site using a good web site's domain name.",
            "phase": "Exploit",
            "step": "3",
            "techniques": [
                "Redirecting Web traffic to a site that looks enough like the original so as to not raise any suspicion.",
                "Adversary-in-the-Middle (CAPEC-94) intercepts secure communication between two parties."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "High",
    "x_mitre_mitigations": [
        {
            "description": "Configuration: Make sure your DNS servers have been updated to the latest versions"
        },
        {
            "description": "Configuration: UNIX services like rlogin, rsh/rcp, xhost, and nfs are all susceptible to wrong information being held in a cache. Care should be taken with these services so they do not rely upon DNS caches that have been exposed to the Internet."
        },
        {
            "description": "Configuration: Disable client side DNS caching."
        }
    ]
}