{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--187a2ce2-9802-4f38-b514-e1ed72517aa6",
    "created": "2024-08-13T14:46:37.005023Z",
    "modified": "2024-08-13T14:46:45.402846Z",
    "name": "Defacement: Internal",
    "description": "An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users, thus discrediting the integrity of the systems. This may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper.[1] Disturbing or offensive images may be used as a part of Internal Defacement in order to cause user discomfort, or to pressure compliance with accompanying messages. Since internally defacing systems exposes an adversary's presence, it often takes place after other intrusion goals have been accomplished.[2]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1491/001",
            "external_id": "T1491/001"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Stephen Lincoln @slincoln-aiq (AttackIQ)",
            "date": "2023/12/21",
            "description": "Detects the execution of \"reg.exe\" to alter registry keys that would replace the user's desktop background.\nThis is a common technique used by malware to change the desktop background to a ransom note or other image.\n",
            "detection": {
                "condition": "all of selection_reg_* and selection_keys and 1 of selection_cli_reg_*",
                "selection_cli_reg_1": {
                    "CommandLine|contains|all": [
                        "/v NoChangingWallpaper",
                        "/d 1"
                    ]
                },
                "selection_cli_reg_2": {
                    "CommandLine|contains|all": [
                        "/v Wallpaper",
                        "/t REG_SZ"
                    ]
                },
                "selection_cli_reg_3": {
                    "CommandLine|contains|all": [
                        "/v WallpaperStyle",
                        "/d 2"
                    ]
                },
                "selection_keys": {
                    "CommandLine|contains": [
                        "Control Panel\\Desktop",
                        "CurrentVersion\\Policies\\ActiveDesktop",
                        "CurrentVersion\\Policies\\System"
                    ]
                },
                "selection_reg_flag": {
                    "CommandLine|contains": "add"
                },
                "selection_reg_img": [
                    {
                        "Image|endswith": "\\reg.exe"
                    },
                    {
                        "OriginalFileName": "reg.exe"
                    }
                ]
            },
            "falsepositives": [
                "Administrative scripts that change the desktop background to a company logo or other image."
            ],
            "id": "8cbc9475-8d05-4e27-9c32-df960716c701",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.attackiq.com/2023/09/20/emulating-rhysida/",
                "https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/",
                "https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html",
                "https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI"
            ],
            "related": [
                {
                    "id": "85b88e05-dadc-430b-8a9e-53ff1cd30aae",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1112",
                "attack.t1491.001"
            ],
            "title": "Potentially Suspicious Desktop Background Change Using Reg.EXE"
        },
        {
            "author": "frack113",
            "date": "2021/12/26",
            "description": "An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users.\nThis may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "ScriptBlockText|contains|all": [
                        "Get-ItemProperty",
                        "Registry::",
                        "HKEY_CURRENT_USER\\Control Panel\\Desktop\\",
                        "WallPaper"
                    ]
                },
                "selection_2": {
                    "ScriptBlockText|contains": "SystemParametersInfo(20,0,*,3)"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c5ac6a1e-9407-45f5-a0ce-ca9a0806a287",
            "level": "low",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1491.001/T1491.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1491.001"
            ],
            "title": "Replace Desktop Wallpaper by Powershell"
        },
        {
            "id": "85b88e05-dadc-430b-8a9e-53ff1cd30aae",
            "author": "Nasreddine Bencherchali (Nextron Systems), Stephen Lincoln @slincoln-aiq (AttackIQ)",
            "date": "2023/12/21",
            "description": "Detects registry value settings that would replace the user's desktop background.\nThis is a common technique used by malware to change the desktop background to a ransom note or other image.\n",
            "detection": {
                "condition": "selection_keys and 1 of selection_values_* and not 1 of filter_main_*",
                "filter_main_svchost": {
                    "Image|endswith": "\\svchost.exe"
                },
                "selection_keys": {
                    "TargetObject|contains": [
                        "Control Panel\\Desktop",
                        "CurrentVersion\\Policies\\ActiveDesktop",
                        "CurrentVersion\\Policies\\System"
                    ]
                },
                "selection_values_1": {
                    "Details": "DWORD (0x00000001)",
                    "TargetObject|endswith": "NoChangingWallpaper"
                },
                "selection_values_2": {
                    "TargetObject|endswith": "\\Wallpaper"
                },
                "selection_values_3": {
                    "Details": "2",
                    "TargetObject|endswith": "\\WallpaperStyle"
                }
            },
            "falsepositives": [
                "Administrative scripts that change the desktop background to a company logo or other image."
            ],
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://www.attackiq.com/2023/09/20/emulating-rhysida/",
                "https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/",
                "https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html",
                "https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper",
                "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "8cbc9475-8d05-4e27-9c32-df960716c701"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.impact",
                "attack.t1112",
                "attack.t1491.001"
            ],
            "title": "Potentially Suspicious Desktop Background Change Via Registry"
        },
        {
            "author": "frack113",
            "date": "2022/12/11",
            "description": "Detect changes to the \"LegalNoticeCaption\" or \"LegalNoticeText\" registry values where the message set contains keywords often used in ransomware ransom messages",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details|contains": [
                        "encrypted",
                        "Unlock-Password",
                        "paying"
                    ],
                    "TargetObject|contains": [
                        "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeCaption",
                        "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeText"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8b9606c9-28be-4a38-b146-0e313cc232c1",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "status": "test",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1491.001/T1491.001.md"
            ],
            "tags": [
                "attack.impact",
                "attack.t1491.001"
            ],
            "title": "Potential Ransomware Activity Using LegalNotice Message"
        }
    ]
}