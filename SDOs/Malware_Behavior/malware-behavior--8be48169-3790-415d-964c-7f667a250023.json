{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--8be48169-3790-415d-964c-7f667a250023",
    "created": "2024-08-13T14:46:37.026797Z",
    "modified": "2024-08-13T14:46:48.537498Z",
    "name": "Hide Artifacts",
    "description": "Adversaries may attempt to hide artifacts associated with their behaviors to evade detection. Operating systems may have features to hide various artifacts, such as important system files and administrative task execution, to avoid disrupting user work environments and prevent users from changing files or features on the system. Adversaries may abuse these features to hide artifacts such as files, directories, user accounts, or other system activity to evade detection.[1][2][3]Adversaries may also attempt to hide artifacts associated with malicious behavior by creating computing regions that are isolated from common security instrumentation, such as through the use of virtualization technology.[4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1564",
            "external_id": "T1564"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1564",
            "external_id": "T1564"
        },
        {
            "source_name": "Cybereason OSX Pirrit",
            "description": "Amit Serper. (2016). Cybereason Lab Analysis OSX.Pirrit. Retrieved December 10, 2021.",
            "url": "https://cdn2.hubspot.net/hubfs/3354902/Content%20PDFs/Cybereason-Lab-Analysis-OSX-Pirrit-4-6-16.pdf"
        },
        {
            "source_name": "MalwareBytes ADS July 2015",
            "description": "Arntz, P. (2015, July 22). Introduction to Alternate Data Streams. Retrieved March 21, 2018.",
            "url": "https://blog.malwarebytes.com/101/2015/07/introduction-to-alternate-data-streams/"
        },
        {
            "source_name": "Sofacy Komplex Trojan",
            "description": "Dani Creus, Tyler Halfpop, Robert Falcone. (2016, September 26). Sofacy's 'Komplex' OS X Trojan. Retrieved July 8, 2017.",
            "url": "https://researchcenter.paloaltonetworks.com/2016/09/unit42-sofacys-komplex-os-x-trojan/"
        },
        {
            "source_name": "Sophos Ragnar May 2020",
            "description": "SophosLabs. (2020, May 21). Ragnar Locker ransomware deploys virtual machine to dodge security. Retrieved June 29, 2020.",
            "url": "https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "match": "find taskbar"
                            },
                            {
                                "match": "hide graphical window"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Hide Artifacts [T1564]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10007250"
                    ],
                    "name": "hide the Windows taskbar",
                    "namespace": "host-interaction/gui/taskbar/hide",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Daniil Yugoslavskiy, oscd.community",
            "date": "2020/10/10",
            "description": "Detects creation of a hidden user account on macOS (UserID < 500) or with IsHidden option",
            "detection": {
                "condition": "dscl_create and id_below_500 or dscl_create and (ishidden_option_declaration and ishidden_option_confirmation)",
                "dscl_create": {
                    "CommandLine|contains": "create",
                    "Image|endswith": "/dscl"
                },
                "id_below_500": {
                    "CommandLine|contains": "UniqueID",
                    "CommandLine|re": "([0-9]|[1-9][0-9]|[1-4][0-9]{2})"
                },
                "ishidden_option_confirmation": {
                    "CommandLine|contains": [
                        "true",
                        "yes",
                        "1"
                    ]
                },
                "ishidden_option_declaration": {
                    "CommandLine|contains": "IsHidden"
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "b22a5b36-2431-493a-8be1-0bae56c28ef3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.002/T1564.002.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.002"
            ],
            "title": "Hidden User Creation"
        },
        {
            "author": "frack113",
            "date": "2021/06/04",
            "description": "Detects when an attacker tries to hide from Sysmon by disabling or stopping it",
            "detection": {
                "condition": "1 of selection_* and not filter",
                "filter": {
                    "State": "Started"
                },
                "selection_conf": [
                    "Sysmon config state changed"
                ],
                "selection_stop": {
                    "State": "Stopped"
                }
            },
            "falsepositives": [
                "Legitimate administrative action"
            ],
            "id": "1f2b5353-573f-4880-8e33-7d04dcf97744",
            "level": "high",
            "logsource": {
                "category": "sysmon_status",
                "product": "windows"
            },
            "modified": "2022/08/02",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564"
            ],
            "title": "Sysmon Configuration Modification"
        },
        {
            "author": "frack113",
            "date": "2021/06/04",
            "description": "Detects when an adversary is trying to hide it's action from Sysmon logging based on error messages",
            "detection": {
                "condition": "selection_error and not 1 of filter*",
                "filter_by_errorcode": {
                    "Description|contains": [
                        "Failed to open service configuration with error 19",
                        "Failed to open service configuration with error 93"
                    ]
                },
                "filter_generic_english": {
                    "Description|contains|all": [
                        "Failed to open service configuration with error",
                        "Last error: The media is write protected."
                    ]
                },
                "selection_error": {
                    "Description|contains": [
                        "Failed to open service configuration with error",
                        "Failed to connect to the driver to update configuration"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administrative action"
            ],
            "id": "815cd91b-7dbc-4247-841a-d7dd1392b0a8",
            "level": "high",
            "logsource": {
                "category": "sysmon_error",
                "product": "windows"
            },
            "modified": "2022/07/07",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
                "https://talesfrominfosec.blogspot.com/2017/12/killing-sysmon-silently.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564"
            ],
            "title": "Sysmon Configuration Error"
        },
        {
            "author": "frack113",
            "date": "2022/09/05",
            "description": "Detect creation of suspicious executable file names.\nSome strings look for suspicious file extensions, others look for filenames that exploit unquoted service paths.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": [
                        ":\\$Recycle.Bin.exe",
                        ":\\Documents and Settings.exe",
                        ":\\MSOCache.exe",
                        ":\\PerfLogs.exe",
                        ":\\Recovery.exe",
                        ".bat.exe",
                        ".sys.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "74babdd6-a758-4549-9632-26535279e654",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/12/11",
            "references": [
                "https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae",
                "https://app.any.run/tasks/76c69e2d-01e8-49d9-9aea-fb7cc0c4d3ad/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564"
            ],
            "title": "Suspicious Executable File Creation"
        },
        {
            "author": "frack113",
            "date": "2022/01/21",
            "description": "Once executed, colorcpl.exe will copy the arbitrary file to c:\\windows\\system32\\spool\\drivers\\color\\",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_ext": {
                    "TargetFilename|endswith": [
                        ".icm",
                        ".gmmp",
                        ".cdmp",
                        ".camp"
                    ]
                },
                "selection": {
                    "Image|endswith": "\\colorcpl.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e15b518d-b4ce-4410-a9cd-501f23ce4a18",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/01/05",
            "references": [
                "https://twitter.com/eral4m/status/1480468728324231172?s=20"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564"
            ],
            "title": "Suspicious Creation with Colorcpl"
        },
        {
            "author": "Scoubi (@ScoubiMtl)",
            "date": "2023/10/09",
            "description": "Detects the creation of hidden file/folder with the \"::$index_allocation\" stream. Which can be used as a technique to prevent access to folder and files from tooling such as \"explorer.exe\" and \"powershell.exe\"\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "::$index_allocation"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "a8f866e1-bdd4-425e-a27a-37619238d9c7",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://twitter.com/pfiatde/status/1681977680688738305",
                "https://soroush.me/blog/2010/12/a-dotty-salty-directory-a-secret-place-in-ntfs-for-secret-files/",
                "https://sec-consult.com/blog/detail/pentesters-windows-ntfs-tricks-collection/",
                "https://github.com/redcanaryco/atomic-red-team/blob/5c3b23002d2bbede3c07e7307165fc2a235a427d/atomics/T1564.004/T1564.004.md#atomic-test-5---create-hidden-directory-via-index_allocation",
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3"
            ],
            "related": [
                {
                    "id": "0900463c-b33b-49a8-be1d-552a3b553dae",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream"
        },
        {
            "author": "frack113, Nasreddine Bencherchali",
            "date": "2022/08/07",
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
            "detection": {
                "condition": "selection and not filter",
                "filter": [
                    {
                        "ParentImage": [
                            "C:\\Windows\\System32\\Dism.exe",
                            "C:\\Windows\\System32\\cleanmgr.exe",
                            "C:\\Program Files\\GPSoftware\\Directory Opus\\dopus.exe"
                        ]
                    },
                    {
                        "ParentImage|endswith": [
                            "\\WebEx\\WebexHost.exe",
                            "\\thor\\thor64.exe",
                            "\\veam.backup.shell.exe",
                            "\\winget.exe",
                            "\\Everything\\Everything.exe"
                        ]
                    },
                    {
                        "ParentImage|contains": "\\AppData\\Local\\Temp\\WinGet\\"
                    },
                    {
                        "CommandLine|contains": [
                            "\\appdata\\local\\webex\\webex64\\meetings\\wbxreport.exe",
                            "C:\\Program Files\\Git\\post-install.bat",
                            "C:\\Program Files\\Git\\cmd\\scalar.exe"
                        ]
                    }
                ],
                "selection": {
                    "CommandLine|contains": [
                        "~1\\",
                        "~2\\"
                    ]
                }
            },
            "falsepositives": [
                "Applications could use this notation occasionally which might generate some false positives. In that case investigate the parent and child process."
            ],
            "id": "349d891d-fef0-4fe4-bc53-eee623a15969",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/26",
            "references": [
                "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
                "https://twitter.com/frack113/status/1555830623633375232"
            ],
            "related": [
                {
                    "id": "a96970af-f126-420d-90e1-d37bf25e50e1",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Use Short Name Path in Command Line"
        },
        {
            "author": "Harjot Singh, '@cyb3rjy0t'",
            "date": "2023/01/21",
            "description": "Detects execution of rundll32 where the DLL being called is stored in an Alternate Data Stream (ADS).",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|re": "[Rr][Uu][Nn][Dd][Ll][Ll]32(\\.[Ee][Xx][Ee])? \\S+?\\w:\\S+?:"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\rundll32.exe"
                    },
                    {
                        "OriginalFileName": "RUNDLL32.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9248c7e1-2bf3-4661-a22c-600a8040b446",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Rundll32"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Potential Rundll32 Execution With DLL Stored In ADS"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/20",
            "description": "Detects the execution of AdvancedRun utility",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "OriginalFileName": "AdvancedRun.exe"
                    },
                    {
                        "CommandLine|contains|all": [
                            " /EXEFilename ",
                            " /Run"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            " /WindowState 0",
                            " /RunAs ",
                            " /CommandLine "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d2b749ee-4225-417e-b20e-a8d2193cbb84",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://twitter.com/splinter_code/status/1483815103279603714",
                "https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3",
                "https://elastic.github.io/security-research/malware/2022/01/01.operation-bleeding-bear/article/",
                "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/"
            ],
            "related": [
                {
                    "id": "fa00b701-44c6-4679-994d-5a18afa8a707",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.t1564.003",
                "attack.t1134.002",
                "attack.t1059.003"
            ],
            "title": "PUA - AdvancedRun Execution"
        },
        {
            "author": "Sergey Soldatov, Kaspersky Lab, oscd.community",
            "date": "2019/10/30",
            "description": "Detects PowerShell script execution from Alternate Data Stream (ADS)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "Get-Content",
                        "-Stream"
                    ],
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ],
                    "ParentImage|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "45a594aa-1fbd-4972-a809-ff5a99dd81b8",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/07/14",
            "references": [
                "https://github.com/p0shkatz/Get-ADS/blob/1c3a3562e713c254edce1995a7d9879c687c7473/Get-ADS.ps1"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Run PowerShell Script from ADS"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/02/25",
            "description": "Detects a potentially suspicious execution of a parent process located in the \"\\Users\\Public\" folder executing a child process containing references to shell or scripting binaries and commandlines.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_child": [
                    {
                        "Image|endswith": [
                            "\\bitsadmin.exe",
                            "\\certutil.exe",
                            "\\cmd.exe",
                            "\\cscript.exe",
                            "\\mshta.exe",
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\wscript.exe"
                        ]
                    },
                    {
                        "CommandLine|contains": [
                            "bitsadmin",
                            "certutil",
                            "cscript",
                            "mshta",
                            "powershell",
                            "regsvr32",
                            "rundll32",
                            "wscript"
                        ]
                    }
                ],
                "selection_parent": {
                    "ParentImage|contains": ":\\Users\\Public\\"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "69bd9b97-2be2-41b6-9816-fb08757a4d1a",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/07/12",
            "references": [
                "https://redcanary.com/blog/blackbyte-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1564",
                "attack.t1059"
            ],
            "title": "Potentially Suspicious Execution From Parent Process In Public Folder"
        },
        {
            "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
            "date": "2020/06/04",
            "description": "Detects suspicious command lines used in Covenant luanchers",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "CommandLine|contains": [
                        "-Command",
                        "-EncodedCommand"
                    ],
                    "CommandLine|contains|all": [
                        "-Sta",
                        "-Nop",
                        "-Window",
                        "Hidden"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "sv o (New-Object IO.MemorySteam);sv d ",
                        "mshta file.hta",
                        "GruntHTTP",
                        "-EncodedCommand cwB2ACAAbwAgA"
                    ]
                }
            },
            "id": "c260b6db-48ba-4b4a-a76f-2f67644e99d2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://posts.specterops.io/covenant-v0-5-eee0507b85ba"
            ],
            "modified": "2023/02/21",
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1059.001",
                "attack.t1564.003"
            ],
            "title": "HackTool - Covenant PowerShell Launcher"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/06",
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image based detection",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic_parent": {
                    "ParentImage": "C:\\Windows\\explorer.exe"
                },
                "filter_optional_thor": {
                    "ParentImage|endswith": "\\thor\\thor64.exe"
                },
                "filter_optional_vcred": {
                    "Image|endswith": "\\VCREDI~1.EXE"
                },
                "filter_optional_webex": {
                    "ParentImage|endswith": "\\WebEx\\WebexHost.exe"
                },
                "filter_optional_winzip": {
                    "Image": "C:\\PROGRA~1\\WinZip\\WZPREL~1.EXE"
                },
                "selection": {
                    "Image|contains": [
                        "~1.bat",
                        "~1.dll",
                        "~1.exe",
                        "~1.hta",
                        "~1.js",
                        "~1.msi",
                        "~1.ps1",
                        "~1.tmp",
                        "~1.vbe",
                        "~1.vbs",
                        "~2.bat",
                        "~2.dll",
                        "~2.exe",
                        "~2.hta",
                        "~2.js",
                        "~2.msi",
                        "~2.ps1",
                        "~2.tmp",
                        "~2.vbe",
                        "~2.vbs"
                    ]
                }
            },
            "falsepositives": [
                "Software Installers"
            ],
            "id": "3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/07/20",
            "references": [
                "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
                "https://twitter.com/jonasLyk/status/1555914501802921984"
            ],
            "related": [
                {
                    "id": "dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Use NTFS Short Name in Image"
        },
        {
            "author": "frack113",
            "date": "2022/05/02",
            "description": "Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        " -f",
                        ".zip"
                    ],
                    "Image|endswith": "\\PrintBrm.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "cafeeba3-01da-4ab4-b6c4-a31b1d9730c7",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/PrintBrm/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1105",
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "PrintBrm ZIP Creation of Extraction"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/10/10",
            "description": "Detects the execution of Process Hacker based on binary metadata information (Image, Hash, Imphash, etc).\nProcess Hacker is a tool to view and manipulate processes, kernel options and other low level options.\nThreat actors abused older vulnerable versions to manipulate system processes.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_hash_values": [
                    {
                        "md5": [
                            "68f9b52895f4d34e74112f3129b3b00d",
                            "b365af317ae730a67c936f21432b9c71"
                        ]
                    },
                    {
                        "sha1": [
                            "c5e2018bf7c0f314fed4fd7fe7e69fa2e648359e",
                            "a0bdfac3ce1880b32ff9b696458327ce352e3b1d"
                        ]
                    },
                    {
                        "sha256": [
                            "d4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f",
                            "bd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4"
                        ]
                    },
                    {
                        "Imphash": [
                            "04de0ad9c37eb7bd52043d2ecac958df",
                            "3695333c60dedecdcaff1590409aa462"
                        ]
                    }
                ],
                "selection_hashes": {
                    "Hashes|contains": [
                        "MD5=68F9B52895F4D34E74112F3129B3B00D",
                        "MD5=B365AF317AE730A67C936F21432B9C71",
                        "SHA1=A0BDFAC3CE1880B32FF9B696458327CE352E3B1D",
                        "SHA1=C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E",
                        "SHA256=D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F",
                        "SHA256=BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4",
                        "IMPHASH=3695333C60DEDECDCAFF1590409AA462",
                        "IMPHASH=04DE0AD9C37EB7BD52043D2ECAC958DF"
                    ]
                },
                "selection_image": [
                    {
                        "Image|contains": "\\ProcessHacker_"
                    },
                    {
                        "Image|endswith": "\\ProcessHacker.exe"
                    },
                    {
                        "OriginalFileName": [
                            "ProcessHacker.exe",
                            "Process Hacker"
                        ]
                    },
                    {
                        "Description": "Process Hacker"
                    },
                    {
                        "Product": "Process Hacker"
                    }
                ]
            },
            "falsepositives": [
                "While sometimes 'Process Hacker is used by legitimate administrators, the execution of Process Hacker must be investigated and allowed on a case by case basis"
            ],
            "id": "811e0002-b13b-4a15-9d00-a613fce66e42",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/11",
            "references": [
                "https://processhacker.sourceforge.io/",
                "https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/"
            ],
            "related": [
                {
                    "id": "5722dff1-4bdd-4949-86ab-fbaf707e767a",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.discovery",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.t1622",
                "attack.t1564",
                "attack.t1543"
            ],
            "title": "PUA - Process Hacker Execution"
        },
        {
            "author": "Janantha Marasinghe",
            "date": "2020/09/26",
            "description": "Adversaries can carry out malicious operations using a virtual instance to avoid detection. This rule is built to detect the registration of the Virtualbox driver or start of a Virtualbox VM.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "CommandLine|contains": [
                        "VBoxRT.dll,RTR3Init",
                        "VBoxC.dll",
                        "VBoxDrv.sys"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "startvm",
                        "controlvm"
                    ]
                }
            },
            "falsepositives": [
                "This may have false positives on hosts where Virtualbox is legitimately being used for operations"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "bab049ca-7471-4828-9024-38279a4c04da",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2022/07/14",
            "status": "test",
            "references": [
                "https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/",
                "https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.006",
                "attack.t1564"
            ],
            "title": "Detect Virtualbox Driver Installation OR Starting Of VMs"
        },
        {
            "id": "5722dff1-4bdd-4949-86ab-fbaf707e767a",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2023/05/08",
            "description": "Detects the execution of System Informer, a task manager tool to view and manipulate processes, kernel options and other low level operations",
            "detection": {
                "condition": "1 of selection_*",
                "selection_hash_values": [
                    {
                        "md5": "19426363A37C03C3ED6FEDF57B6696EC"
                    },
                    {
                        "sha1": "8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC"
                    },
                    {
                        "sha256": "8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287"
                    },
                    {
                        "Imphash": "B68908ADAEB5D662F87F2528AF318F12"
                    }
                ],
                "selection_hashes": {
                    "Hashes|contains": [
                        "MD5=19426363A37C03C3ED6FEDF57B6696EC",
                        "SHA1=8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC",
                        "SHA256=8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287",
                        "IMPHASH=B68908ADAEB5D662F87F2528AF318F12"
                    ]
                },
                "selection_image": [
                    {
                        "Image|endswith": "\\SystemInformer.exe"
                    },
                    {
                        "OriginalFileName": "SystemInformer.exe"
                    },
                    {
                        "Description": "System Informer"
                    },
                    {
                        "Product": "System Informer"
                    }
                ]
            },
            "falsepositives": [
                "System Informer is regularly used legitimately by system administrators or developers. Apply additional filters accordingly"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/winsiderss/systeminformer"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "811e0002-b13b-4a15-9d00-a613fce66e42"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.discovery",
                "attack.defense_evasion",
                "attack.t1082",
                "attack.t1564",
                "attack.t1543"
            ],
            "title": "PUA - System Informer Execution"
        },
        {
            "author": "frack113",
            "date": "2021/11/26",
            "description": "Extract data from cab file and hide it in an alternate data stream",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "extrac32.exe",
                        ".cab"
                    ],
                    "CommandLine|re": ":[^\\\\]"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4b13db67-0c45-40f1-aba8-66a1a7198a1e",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Extrac32/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Suspicious Extrac32 Alternate Data Stream Execution"
        },
        {
            "author": "frack113",
            "date": "2022/07/18",
            "description": "Detect use of icacls to deny access for everyone in Users folder sometimes used to hide malicious files",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmd": {
                    "CommandLine|contains|all": [
                        "/deny",
                        "*S-1-1-0:"
                    ]
                },
                "selection_icacls": [
                    {
                        "OriginalFileName": "iCACLS.EXE"
                    },
                    {
                        "Image|endswith": "\\icacls.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4ae81040-fc1c-4249-bfa3-938d260214d9",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/04/29",
            "references": [
                "https://app.any.run/tasks/1df999e6-1cb8-45e3-8b61-499d1b7d5a9b/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "Use Icacls to Hide File to Everyone"
        },
        {
            "author": "Janantha Marasinghe",
            "date": "2022/11/18",
            "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
            "detection": {
                "condition": "selection_img and (1 of selection_flags_*)",
                "selection_flags_configure": {
                    "CommandLine|contains|all": [
                        "/configure",
                        "/db"
                    ]
                },
                "selection_flags_discovery": {
                    "CommandLine|contains|all": [
                        "/export",
                        "/cfg"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\secedit.exe"
                    },
                    {
                        "OriginalFileName": "SeCEdit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administrative use"
            ],
            "id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/30",
            "references": [
                "https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.persistence",
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.privilege_escalation",
                "attack.t1562.002",
                "attack.t1547.001",
                "attack.t1505.005",
                "attack.t1556.002",
                "attack.t1562",
                "attack.t1574.007",
                "attack.t1564.002",
                "attack.t1546.008",
                "attack.t1546.007",
                "attack.t1547.014",
                "attack.t1547.010",
                "attack.t1547.002",
                "attack.t1557",
                "attack.t1082"
            ],
            "title": "Potential Suspicious Activity Using SeCEdit"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects the usage of attrib with the \"+s\" option to set scripts or executables located in suspicious locations as system files to hide them from users and make them unable to be deleted with simple rights. The rule limits the search to specific extensions and directories to avoid FPs\n",
            "detection": {
                "condition": "all of selection* and not 1 of filter_optional_*",
                "filter_optional_installer": {
                    "CommandLine|contains|all": [
                        "\\Windows\\TEMP\\",
                        ".exe"
                    ]
                },
                "selection_cli": {
                    "CommandLine|contains": " +s"
                },
                "selection_ext": {
                    "CommandLine|contains": [
                        ".bat",
                        ".dll",
                        ".exe",
                        ".hta",
                        ".ps1",
                        ".vbe",
                        ".vbs"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\attrib.exe"
                    },
                    {
                        "OriginalFileName": "ATTRIB.EXE"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        " %",
                        "\\Users\\Public\\",
                        "\\AppData\\Local\\",
                        "\\ProgramData\\",
                        "\\Downloads\\",
                        "\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "efec536f-72e8-4656-8960-5e85d091345b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/14",
            "references": [
                "https://app.any.run/tasks/c28cabc8-a19f-40f3-a78b-cae506a5c0d4",
                "https://app.any.run/tasks/cfc8870b-ccd7-4210-88cf-a8087476a6d0",
                "https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/"
            ],
            "related": [
                {
                    "id": "bb19e94c-59ae-4c15-8c12-c563d23fe52b",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "Set Suspicious Files as System Files Using Attrib.EXE"
        },
        {
            "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/05",
            "description": "Detects execution of \"findstr\" with specific flags and a remote share path. This specific set of CLI flags would allow \"findstr\" to download the content of the file located on the remote share as described in the LOLBAS entry.\n",
            "detection": {
                "condition": "selection_findstr and all of selection_cli_download_*",
                "selection_cli_download_1": {
                    "CommandLine|contains|windash": " -v "
                },
                "selection_cli_download_2": {
                    "CommandLine|contains|windash": " -l "
                },
                "selection_cli_download_3": {
                    "CommandLine|contains": "\\\\\\\\"
                },
                "selection_findstr": [
                    {
                        "CommandLine|contains": "findstr"
                    },
                    {
                        "Image|endswith": "findstr.exe"
                    },
                    {
                        "OriginalFileName": "FINDSTR.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "587254ee-a24b-4335-b3cd-065c0f1f4baa",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
                "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "related": [
                {
                    "id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1564.004",
                "attack.t1552.001",
                "attack.t1105"
            ],
            "title": "Remote File Download Via Findstr.EXE"
        },
        {
            "id": "dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795",
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/05",
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
            "detection": {
                "condition": "selection and not filter",
                "filter": [
                    {
                        "ParentImage|endswith": [
                            "\\WebEx\\WebexHost.exe",
                            "\\thor\\thor64.exe"
                        ]
                    },
                    {
                        "CommandLine|contains": "C:\\xampp\\vcredist\\VCREDI~1.EXE"
                    }
                ],
                "selection": {
                    "CommandLine|contains": [
                        "~1.exe",
                        "~1.bat",
                        "~1.msi",
                        "~1.vbe",
                        "~1.vbs",
                        "~1.dll",
                        "~1.ps1",
                        "~1.js",
                        "~1.hta",
                        "~2.exe",
                        "~2.bat",
                        "~2.msi",
                        "~2.vbe",
                        "~2.vbs",
                        "~2.dll",
                        "~2.ps1",
                        "~2.js",
                        "~2.hta"
                    ]
                }
            },
            "falsepositives": [
                "Applications could use this notation occasionally which might generate some false positives. In that case Investigate the parent and child process."
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/09/21",
            "references": [
                "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
                "https://twitter.com/jonasLyk/status/1555914501802921984"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Use NTFS Short Name in Command Line"
        },
        {
            "author": "frack113",
            "date": "2021/11/26",
            "description": "Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "diantz.exe",
                        ".cab"
                    ],
                    "CommandLine|re": ":[^\\\\]"
                }
            },
            "falsepositives": [
                "Very Possible"
            ],
            "id": "6b369ced-4b1d-48f1-b427-fdc0de0790bd",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/12/31",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Diantz/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Suspicious Diantz Alternate Data Stream Execution"
        },
        {
            "author": "Sami Ruohonen",
            "date": "2019/01/16",
            "description": "Detects usage of attrib.exe to hide files from users.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_msiexec": {
                    "CommandLine|contains": "\\desktop.ini "
                },
                "filter_optional_intel": {
                    "CommandLine": "+R +H +S +A \\\\\\*.cui",
                    "ParentCommandLine": "C:\\\\WINDOWS\\\\system32\\\\\\*.bat",
                    "ParentImage|endswith": "\\cmd.exe"
                },
                "selection_cli": {
                    "CommandLine|contains": " +h "
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\attrib.exe"
                    },
                    {
                        "OriginalFileName": "ATTRIB.EXE"
                    }
                ]
            },
            "falsepositives": [
                "IgfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)",
                "Msiexec.exe hiding desktop.ini"
            ],
            "id": "4281cb20-2994-4580-aa63-c8b86d019934",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/14",
            "references": [
                "https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/",
                "https://www.uptycs.com/blog/lolbins-are-no-laughing-matter"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "Hiding Files with Attrib.exe"
        },
        {
            "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/05",
            "description": "Detects execution of findstr with the \"s\" and \"i\" flags for a \"subfolder\" and \"insensitive\" search respectively. Attackers sometimes leverage this built-in utility to search the system for interesting files or filter through results of commands.\n",
            "detection": {
                "condition": "selection_findstr and all of selection_cli_search_*",
                "selection_cli_search_insensitive": {
                    "CommandLine|contains|windash": " -i "
                },
                "selection_cli_search_subfolder": {
                    "CommandLine|contains|windash": " -s "
                },
                "selection_findstr": [
                    {
                        "CommandLine|contains": "findstr"
                    },
                    {
                        "Image|endswith": "findstr.exe"
                    },
                    {
                        "OriginalFileName": "FINDSTR.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Administrative or software activity"
            ],
            "id": "04936b66-3915-43ad-a8e5-809eadfd1141",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "low",
            "modified": "2024/03/05",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
                "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "related": [
                {
                    "id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218",
                "attack.t1564.004",
                "attack.t1552.001",
                "attack.t1105"
            ],
            "title": "Insensitive Subfolder Search Via Findstr.EXE"
        },
        {
            "id": "a96970af-f126-420d-90e1-d37bf25e50e1",
            "author": "frack113, Nasreddine Bencherchali",
            "date": "2022/08/07",
            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image detection",
            "detection": {
                "condition": "selection and not 1 of filter*",
                "filter1": [
                    {
                        "ParentImage": [
                            "C:\\Windows\\System32\\Dism.exe",
                            "C:\\Windows\\System32\\cleanmgr.exe"
                        ]
                    },
                    {
                        "ParentImage|endswith": [
                            "\\WebEx\\WebexHost.exe",
                            "\\thor\\thor64.exe"
                        ]
                    },
                    {
                        "Product": "InstallShield (R)"
                    },
                    {
                        "Description": "InstallShield (R) Setup Engine"
                    },
                    {
                        "Company": "InstallShield Software Corporation"
                    }
                ],
                "filter_installers": [
                    {
                        "Image|contains|all": [
                            "\\AppData\\",
                            "\\Temp\\"
                        ]
                    },
                    {
                        "Image|endswith": [
                            "~1\\unzip.exe",
                            "~1\\7zG.exe"
                        ]
                    }
                ],
                "selection": {
                    "Image|contains": [
                        "~1\\",
                        "~2\\"
                    ]
                }
            },
            "falsepositives": [
                "Applications could use this notation occasionally which might generate some false positives. In that case Investigate the parent and child process."
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/21",
            "references": [
                "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
                "https://twitter.com/frack113/status/1555830623633375232"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "349d891d-fef0-4fe4-bc53-eee623a15969"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Use Short Name Path in Image"
        },
        {
            "id": "0900463c-b33b-49a8-be1d-552a3b553dae",
            "author": "Nasreddine Bencherchali (Nextron Systems), Scoubi (@ScoubiMtl)",
            "date": "2023/10/09",
            "description": "Detects command line containing reference to the \"::$index_allocation\" stream, which can be used as a technique to prevent access to folders or files from tooling such as \"explorer.exe\" or \"powershell.exe\"\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "::$index_allocation"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://twitter.com/pfiatde/status/1681977680688738305",
                "https://soroush.me/blog/2010/12/a-dotty-salty-directory-a-secret-place-in-ntfs-for-secret-files/",
                "https://sec-consult.com/blog/detail/pentesters-windows-ntfs-tricks-collection/",
                "https://github.com/redcanaryco/atomic-red-team/blob/5c3b23002d2bbede3c07e7307165fc2a235a427d/atomics/T1564.004/T1564.004.md#atomic-test-5---create-hidden-directory-via-index_allocation",
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "a8f866e1-bdd4-425e-a27a-37619238d9c7"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI"
        },
        {
            "author": "frack113",
            "date": "2021/09/01",
            "description": "Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection",
            "detection": {
                "condition": "selection_stream and (1 of selection_tools_*)",
                "selection_stream": {
                    "CommandLine|contains": "txt:"
                },
                "selection_tools_esentutl": {
                    "CommandLine|contains|all": [
                        "esentutl ",
                        " /y ",
                        " /d ",
                        " /o "
                    ]
                },
                "selection_tools_makecab": {
                    "CommandLine|contains|all": [
                        "makecab ",
                        ".cab"
                    ]
                },
                "selection_tools_reg": {
                    "CommandLine|contains|all": [
                        "reg ",
                        " export "
                    ]
                },
                "selection_tools_regedit": {
                    "CommandLine|contains|all": [
                        "regedit ",
                        " /E "
                    ]
                },
                "selection_tools_type": {
                    "CommandLine|contains|all": [
                        "type ",
                        " > "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7f43c430-5001-4f8b-aaa9-c3b88f18fa5c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Execute From Alternate Data Streams"
        },
        {
            "author": "frack113",
            "date": "2021/09/02",
            "description": "Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.",
            "detection": {
                "condition": "selection_compspec",
                "selection_compspec": {
                    "ScriptBlockText|contains|all": [
                        "Start-Process",
                        "-FilePath \"$env:comspec\" ",
                        "-ArgumentList ",
                        ">"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "a699b30e-d010-46c8-bbd1-ee2e26765fe9",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Powershell Store File In Alternate Data Stream"
        },
        {
            "author": "frack113, Tim Shelton (fp AWS)",
            "date": "2021/10/20",
            "description": "Adversaries may use hidden windows to conceal malicious activity from the plain sight of users.\nIn some cases, windows that would typically be displayed when an application carries out an operation can be hidden\n",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "ScriptBlockText|contains|all": [
                        ":\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\",
                        "$PSScriptRoot\\Module\\WorkspaceScriptModule\\WorkspaceScriptModule"
                    ]
                },
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "powershell",
                        "WindowStyle",
                        "Hidden"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "313fbb0a-a341-4682-848d-6d6f8c4fab7c",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2023/01/03",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.003/T1564.003.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.003"
            ],
            "title": "Suspicious PowerShell WindowStyle Option"
        },
        {
            "author": "Sami Ruohonen",
            "date": "2018/07/24",
            "description": "Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.",
            "detection": {
                "condition": "all of selection*",
                "selection_content": {
                    "ScriptBlockText|contains": [
                        "set-content",
                        "add-content"
                    ]
                },
                "selection_stream": {
                    "ScriptBlockText|contains": "-stream"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8c521530-5169-495d-a199-0a3a881ad24e",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "http://www.powertheshell.com/ntfsstreams/",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004",
                "attack.execution",
                "attack.t1059.001"
            ],
            "title": "NTFS Alternate Data Stream"
        },
        {
            "author": "frack113",
            "date": "2022/04/09",
            "description": "Adversaries may carry out malicious operations using a virtual instance to avoid detection",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "New-VM",
                        "Set-VMFirmware",
                        "Start-VM"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "42d36aa1-3240-4db0-8257-e0118dcdd9cd",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.006/T1564.006.md#atomic-test-3---create-and-start-hyper-v-virtual-machine"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.006"
            ],
            "title": "Suspicious Hyper-V Cmdlets"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2022/07/12",
            "description": "Detects modifications to the registry key \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" where the value is set to \"0\" in order to hide user account from being listed on the logon screen.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "EventType": "SetValue",
                    "TargetObject|contains": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f8aebc67-a56d-4ec9-9fbe-7b0e8b7b4efd",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/01/26",
            "references": [
                "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/",
                "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1564.002/T1564.002.md"
            ],
            "related": [
                {
                    "id": "8a58209c-7ae6-4027-afb0-307a78e4589a",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.002"
            ],
            "title": "Hiding User Account Via SpecialAccounts Registry Key"
        },
        {
            "author": "Tobias Michalski (Nextron Systems)",
            "date": "2022/02/24",
            "description": "Detects disabling the CrashDump per registry (as used by HermeticWiper)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": "SYSTEM\\CurrentControlSet\\Control\\CrashControl"
                }
            },
            "falsepositives": [
                "Legitimate disabling of crashdumps"
            ],
            "id": "2ff692c2-4594-41ec-8fcb-46587de769e0",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/"
            ],
            "status": "test",
            "tags": [
                "attack.t1564",
                "attack.t1112"
            ],
            "title": "CrashControl CrashDump Disabled"
        },
        {
            "author": "frack113",
            "date": "2022/04/02",
            "description": "Detects changes to the registry for the currently logged-in user. In order to disable PowerShell module logging, script block logging or transcription and script execution logging",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|contains": [
                        "\\Microsoft\\Windows\\PowerShell\\",
                        "\\Microsoft\\PowerShellCore\\"
                    ],
                    "TargetObject|endswith": [
                        "\\ModuleLogging\\EnableModuleLogging",
                        "\\ScriptBlockLogging\\EnableScriptBlockLogging",
                        "\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging",
                        "\\Transcription\\EnableTranscripting",
                        "\\Transcription\\EnableInvocationHeader",
                        "\\EnableScripts"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "fecfd1a1-cc78-4313-a1ea-2ee2e8ec27a7",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-32---windows-powershell-logging-disabled"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "PowerShell Logging Disabled Via Registry Key Tampering"
        },
        {
            "author": "frack113",
            "date": "2022/04/02",
            "description": "Detects modifications to the \"Hidden\" and \"ShowSuperHidden\" explorer registry values in order to disable showing of hidden files and system files.\nThis technique is abused by several malware families to hide their files from normal users.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowSuperHidden",
                        "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5a5152f1-463f-436b-b2f5-8eceb3964b42",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/26",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md#atomic-test-8---hide-files-through-registry"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "Displaying Hidden Files Feature Disabled"
        },
        {
            "author": "frack113",
            "date": "2022/04/04",
            "description": "Detects the modification of the registry to allow a driver or service to persist in Safe Mode.",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_sophos": {
                    "Image": "C:\\WINDOWS\\system32\\msiexec.exe",
                    "TargetObject|endswith": [
                        "\\Control\\SafeBoot\\Minimal\\SAVService\\(Default)",
                        "\\Control\\SafeBoot\\Network\\SAVService\\(Default)"
                    ]
                },
                "selection": {
                    "Details": "Service",
                    "TargetObject|contains": [
                        "\\Control\\SafeBoot\\Minimal\\",
                        "\\Control\\SafeBoot\\Network\\"
                    ],
                    "TargetObject|endswith": "\\(Default)"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1547e27c-3974-43e2-a7d7-7f484fb928ec",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-33---windows-add-registry-value-to-load-service-in-safe-mode-without-network",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-34---windows-add-registry-value-to-load-service-in-safe-mode-with-network"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "Registry Persistence via Service in Safe Mode"
        },
        {
            "author": "Oddvar Moe, Sander Wiebing, oscd.community",
            "date": "2020/10/07",
            "description": "Exports the target Registry key and hides it in the specified alternate data stream.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\regedit.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "TargetFilename"
            ],
            "id": "0d7a9363-af70-4e7b-a3b7-1a176b7fbe84",
            "level": "high",
            "modified": "2021/11/27",
            "logsource": {
                "category": "create_stream_hash",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
                "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Exports Registry Key To an Alternate Data Stream"
        },
        {
            "author": "Florian Roth (Nextron Systems), @0xrawsec",
            "date": "2018/06/03",
            "description": "Detects the creation of an ADS (Alternate Data Stream) that contains an executable by looking at a non-empty Imphash",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_null": {
                    "Hash|contains": "IMPHASH=00000000000000000000000000000000"
                },
                "selection": {
                    "Hash|contains": "IMPHASH="
                }
            },
            "falsepositives": [
                "This rule isn't looking for any particular binary characteristics. As legitimate installers and programs were seen embedding hidden binaries in their ADS. Some false positives are expected from browser processes and similar."
            ],
            "id": "b69888d4-380c-45ce-9cf9-d9ce46e67821",
            "level": "medium",
            "logsource": {
                "category": "create_stream_hash",
                "product": "windows",
                "definition": "Requirements: Sysmon or equivalent configured with Imphash logging"
            },
            "modified": "2023/02/10",
            "references": [
                "https://twitter.com/0xrawsec/status/1002478725605273600?s=21"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.s0139",
                "attack.t1564.004"
            ],
            "title": "Hidden Executable In NTFS Alternate Data Stream"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/08/24",
            "description": "Detects the creation of a named file stream with the imphash of a well-known hack tool",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Imphash": [
                            "bcca3c247b619dcd13c8cdff5f123932",
                            "3a19059bd7688cb88e70005f18efc439",
                            "bf6223a49e45d99094406777eb6004ba",
                            "0c106686a31bfe2ba931ae1cf6e9dbc6",
                            "0d1447d4b3259b3c2a1d4cfb7ece13c3",
                            "1b0369a1e06271833f78ffa70ffb4eaf",
                            "4c1b52a19748428e51b14c278d0f58e3",
                            "4d927a711f77d62cebd4f322cb57ec6f",
                            "66ee036df5fc1004d9ed5e9a94a1086a",
                            "672b13f4a0b6f27d29065123fe882dfc",
                            "6bbd59cea665c4afcc2814c1327ec91f",
                            "725bb81dc24214f6ecacc0cfb36ad30d",
                            "9528a0e91e28fbb88ad433feabca2456",
                            "9da6d5d77be11712527dcab86df449a3",
                            "a6e01bc1ab89f8d91d9eab72032aae88",
                            "b24c5eddaea4fe50c6a96a2a133521e4",
                            "d21bbc50dcc169d7b4d0f01962793154",
                            "fcc251cceae90d22c392215cc9a2d5d6",
                            "23867a89c2b8fc733be6cf5ef902f2d1",
                            "a37ff327f8d48e8a4d2f757e1b6e70bc",
                            "f9a28c458284584a93b14216308d31bd",
                            "6118619783fc175bc7ebecff0769b46e",
                            "959a83047e80ab68b368fdb3f4c6e4ea",
                            "563233bfa169acc7892451f71ad5850a",
                            "87575cb7a0e0700eb37f2e3668671a08",
                            "13f08707f759af6003837a150a371ba1",
                            "1781f06048a7e58b323f0b9259be798b",
                            "233f85f2d4bc9d6521a6caae11a1e7f5",
                            "24af2584cbf4d60bbe5c6d1b31b3be6d",
                            "632969ddf6dbf4e0f53424b75e4b91f2",
                            "713c29b396b907ed71a72482759ed757",
                            "749a7bb1f0b4c4455949c0b2bf7f9e9f",
                            "8628b2608957a6b0c6330ac3de28ce2e",
                            "8b114550386e31895dfab371e741123d",
                            "94cb940a1a6b65bed4d5a8f849ce9793",
                            "9d68781980370e00e0bd939ee5e6c141",
                            "b18a1401ff8f444056d29450fbc0a6ce",
                            "cb567f9498452721d77a451374955f5f",
                            "730073214094cd328547bf1f72289752",
                            "17b461a082950fc6332228572138b80c",
                            "dc25ee78e2ef4d36faa0badf1e7461c9",
                            "819b19d53ca6736448f9325a85736792",
                            "829da329ce140d873b4a8bde2cbfaa7e",
                            "c547f2e66061a8dffb6f5a3ff63c0a74",
                            "0588081ab0e63ba785938467e1b10cca",
                            "0d9ec08bac6c07d9987dfd0f1506587c",
                            "bc129092b71c89b4d4c8cdf8ea590b29",
                            "4da924cf622d039d58bce71cdf05d242",
                            "e7a3a5c377e2d29324093377d7db1c66",
                            "9a9dbec5c62f0380b4fa5fd31deffedf",
                            "af8a3976ad71e5d5fdfb67ddb8dadfce",
                            "0c477898bbf137bbd6f2a54e3b805ff4",
                            "0ca9f02b537bcea20d4ea5eb1a9fe338",
                            "3ab3655e5a14d4eefc547f4781bf7f9e",
                            "e6f9d5152da699934b30daab206471f6",
                            "3ad59991ccf1d67339b319b15a41b35d",
                            "ffdd59e0318b85a3e480874d9796d872",
                            "0cf479628d7cc1ea25ec7998a92f5051",
                            "07a2d4dcbd6cb2c6a45e6b101f0b6d51",
                            "d6d0f80386e1380d05cb78e871bc72b1",
                            "38d9e015591bbfd4929e0d0f47fa0055",
                            "0e2216679ca6e1094d63322e3412d650",
                            "ada161bf41b8e5e9132858cb54cab5fb",
                            "2a1bc4913cd5ecb0434df07cb675b798",
                            "11083e75553baae21dc89ce8f9a195e4",
                            "a23d29c9e566f2fa8ffbb79267f5df80",
                            "4a07f944a83e8a7c2525efa35dd30e2f",
                            "767637c23bb42cd5d7397cf58b0be688",
                            "14c4e4c72ba075e9069ee67f39188ad8",
                            "3c782813d4afce07bbfc5a9772acdbdc",
                            "7d010c6bb6a3726f327f7e239166d127",
                            "89159ba4dd04e4ce5559f132a9964eb3",
                            "6f33f4a5fc42b8cec7314947bd13f30f",
                            "5834ed4291bdeb928270428ebbaf7604",
                            "5a8a8a43f25485e7ee1b201edcbc7a38",
                            "dc7d30b90b2d8abf664fbed2b1b59894",
                            "41923ea1f824fe63ea5beb84db7a3e74",
                            "3de09703c8e79ed2ca3f01074719906b",
                            "a53a02b997935fd8eedcb5f7abab9b9f",
                            "e96a73c7bf33a464c510ede582318bf2",
                            "32089b8851bbf8bc2d014e9f37288c83",
                            "09D278F9DE118EF09163C6140255C690",
                            "03866661686829d806989e2fc5a72606",
                            "e57401fbdadcd4571ff385ab82bd5d6d",
                            "84B763C45C0E4A3E7CA5548C710DB4EE",
                            "19584675d94829987952432e018d5056",
                            "330768a4f172e10acb6287b87289d83b",
                            "885c99ccfbe77d1cbfcb9c4e7c1a3313",
                            "22a22bc9e4e0d2f189f1ea01748816ac",
                            "7fa30e6bb7e8e8a69155636e50bf1b28",
                            "96df3a3731912449521f6f8d183279b1",
                            "7e6cf3ff4576581271ac8a313b2aab46",
                            "51791678f351c03a0eb4e2a7b05c6e17",
                            "25ce42b079282632708fc846129e98a5",
                            "021bcca20ba3381b11bdde26b4e62f20",
                            "59223b5f52d8799d38e0754855cbdf42",
                            "81e75d8f1d276c156653d3d8813e4a43",
                            "17244e8b6b8227e57fe709ccad421420",
                            "5b76da3acdedc8a5cdf23a798b5936b4",
                            "cb2b65bb77d995cc1c0e5df1c860133c",
                            "40445337761d80cf465136fafb1f63e6",
                            "8a790f401b29fa87bc1e56f7272b3aa6"
                        ]
                    },
                    {
                        "Hash|contains": [
                            "IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932",
                            "IMPHASH=3A19059BD7688CB88E70005F18EFC439",
                            "IMPHASH=bf6223a49e45d99094406777eb6004ba",
                            "IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6",
                            "IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3",
                            "IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF",
                            "IMPHASH=4C1B52A19748428E51B14C278D0F58E3",
                            "IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F",
                            "IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A",
                            "IMPHASH=672B13F4A0B6F27D29065123FE882DFC",
                            "IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F",
                            "IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D",
                            "IMPHASH=9528A0E91E28FBB88AD433FEABCA2456",
                            "IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3",
                            "IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88",
                            "IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4",
                            "IMPHASH=D21BBC50DCC169D7B4D0F01962793154",
                            "IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6",
                            "IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1",
                            "IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC",
                            "IMPHASH=F9A28C458284584A93B14216308D31BD",
                            "IMPHASH=6118619783FC175BC7EBECFF0769B46E",
                            "IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA",
                            "IMPHASH=563233BFA169ACC7892451F71AD5850A",
                            "IMPHASH=87575CB7A0E0700EB37F2E3668671A08",
                            "IMPHASH=13F08707F759AF6003837A150A371BA1",
                            "IMPHASH=1781F06048A7E58B323F0B9259BE798B",
                            "IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5",
                            "IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D",
                            "IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2",
                            "IMPHASH=713C29B396B907ED71A72482759ED757",
                            "IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F",
                            "IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E",
                            "IMPHASH=8B114550386E31895DFAB371E741123D",
                            "IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793",
                            "IMPHASH=9D68781980370E00E0BD939EE5E6C141",
                            "IMPHASH=B18A1401FF8F444056D29450FBC0A6CE",
                            "IMPHASH=CB567F9498452721D77A451374955F5F",
                            "IMPHASH=730073214094CD328547BF1F72289752",
                            "IMPHASH=17B461A082950FC6332228572138B80C",
                            "IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9",
                            "IMPHASH=819B19D53CA6736448F9325A85736792",
                            "IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E",
                            "IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74",
                            "IMPHASH=0588081AB0E63BA785938467E1B10CCA",
                            "IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C",
                            "IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29",
                            "IMPHASH=4DA924CF622D039D58BCE71CDF05D242",
                            "IMPHASH=E7A3A5C377E2D29324093377D7DB1C66",
                            "IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF",
                            "IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE",
                            "IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4",
                            "IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338",
                            "IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E",
                            "IMPHASH=E6F9D5152DA699934B30DAAB206471F6",
                            "IMPHASH=3AD59991CCF1D67339B319B15A41B35D",
                            "IMPHASH=FFDD59E0318B85A3E480874D9796D872",
                            "IMPHASH=0CF479628D7CC1EA25EC7998A92F5051",
                            "IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51",
                            "IMPHASH=D6D0F80386E1380D05CB78E871BC72B1",
                            "IMPHASH=38D9E015591BBFD4929E0D0F47FA0055",
                            "IMPHASH=0E2216679CA6E1094D63322E3412D650",
                            "IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB",
                            "IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798",
                            "IMPHASH=11083E75553BAAE21DC89CE8F9A195E4",
                            "IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80",
                            "IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F",
                            "IMPHASH=767637C23BB42CD5D7397CF58B0BE688",
                            "IMPHASH=14C4E4C72BA075E9069EE67F39188AD8",
                            "IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC",
                            "IMPHASH=7D010C6BB6A3726F327F7E239166D127",
                            "IMPHASH=89159BA4DD04E4CE5559F132A9964EB3",
                            "IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F",
                            "IMPHASH=5834ED4291BDEB928270428EBBAF7604",
                            "IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38",
                            "IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894",
                            "IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74",
                            "IMPHASH=3DE09703C8E79ED2CA3F01074719906B",
                            "IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F",
                            "IMPHASH=E96A73C7BF33A464C510EDE582318BF2",
                            "IMPHASH=32089B8851BBF8BC2D014E9F37288C83",
                            "IMPHASH=09D278F9DE118EF09163C6140255C690",
                            "IMPHASH=03866661686829d806989e2fc5a72606",
                            "IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d",
                            "IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE",
                            "IMPHASH=19584675D94829987952432E018D5056",
                            "IMPHASH=330768A4F172E10ACB6287B87289D83B",
                            "IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313",
                            "IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC",
                            "IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28",
                            "IMPHASH=96DF3A3731912449521F6F8D183279B1",
                            "IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46",
                            "IMPHASH=51791678F351C03A0EB4E2A7B05C6E17",
                            "IMPHASH=25CE42B079282632708FC846129E98A5",
                            "IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20",
                            "IMPHASH=59223B5F52D8799D38E0754855CBDF42",
                            "IMPHASH=81E75D8F1D276C156653D3D8813E4A43",
                            "IMPHASH=17244E8B6B8227E57FE709CCAD421420",
                            "IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4",
                            "IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C",
                            "IMPHASH=40445337761D80CF465136FAFB1F63E6",
                            "IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "19b041f6-e583-40dc-b842-d6fa8011493f",
            "level": "high",
            "logsource": {
                "category": "create_stream_hash",
                "product": "windows",
                "definition": "Requirements: Sysmon config with Imphash logging activated"
            },
            "modified": "2024/01/02",
            "references": [
                "https://github.com/gentilkiwi/mimikatz",
                "https://github.com/topotam/PetitPotam",
                "https://github.com/ohpe/juicy-potato",
                "https://github.com/antonioCoco/RoguePotato",
                "https://www.tarasco.org/security/pwdump_7/",
                "https://github.com/fortra/nanodump",
                "https://github.com/codewhitesec/HandleKatz",
                "https://github.com/xuanxuan0/DripLoader",
                "https://github.com/hfiref0x/UACME",
                "https://github.com/outflanknl/Dumpert",
                "https://github.com/wavestone-cdt/EDRSandblast"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.s0139",
                "attack.t1564.004"
            ],
            "title": "HackTool Named File Stream Created"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/08/24",
            "description": "Detects the download of suspicious file type from a well-known file and paste sharing domain",
            "detection": {
                "condition": "all of selection*",
                "selection_domain": {
                    "Contents|contains": [
                        ".githubusercontent.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cdn.discordapp.com/attachments/",
                        "ddns.net",
                        "dl.dropboxusercontent.com",
                        "ghostbin.co",
                        "glitch.me",
                        "gofile.io",
                        "hastebin.com",
                        "mediafire.com",
                        "mega.nz",
                        "onrender.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "privatlab.com",
                        "privatlab.net",
                        "send.exploit.in",
                        "sendspace.com",
                        "storage.googleapis.com",
                        "storjshare.io",
                        "supabase.co",
                        "temp.sh",
                        "transfer.sh",
                        "ufile.io"
                    ]
                },
                "selection_extension": {
                    "TargetFilename|contains": [
                        ".exe:Zone",
                        ".vbs:Zone",
                        ".vbe:Zone",
                        ".dll:Zone",
                        ".one:Zone",
                        ".hta:Zone",
                        ".lnk:Zone",
                        ".xll:Zone",
                        ".cpl:Zone"
                    ]
                }
            },
            "falsepositives": [
                "Some false positives might occur with binaries download via Github"
            ],
            "id": "52182dfb-afb7-41db-b4bc-5336cb29b464",
            "level": "high",
            "modified": "2024/02/09",
            "logsource": {
                "category": "create_stream_hash",
                "product": "windows"
            },
            "references": [
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015",
                "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
                "https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/",
                "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
            ],
            "related": [
                {
                    "id": "ae02ed70-11aa-4a22-b397-c0d0e8f6ea99",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.s0139",
                "attack.t1564.004"
            ],
            "title": "Suspicious File Download From File Sharing Websites"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
            "date": "2022/09/07",
            "description": "Detects the download of suspicious file type from URLs with IP",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Contents|re": "http[s]?://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                    "TargetFilename|contains": [
                        ".ps1:Zone",
                        ".bat:Zone",
                        ".exe:Zone",
                        ".vbe:Zone",
                        ".vbs:Zone",
                        ".dll:Zone",
                        ".one:Zone",
                        ".cmd:Zone",
                        ".hta:Zone",
                        ".xll:Zone",
                        ".lnk:Zone"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "025bd229-fd1f-4fdb-97ab-20006e1a5368",
            "level": "high",
            "modified": "2023/02/10",
            "logsource": {
                "category": "create_stream_hash",
                "product": "windows"
            },
            "references": [
                "https://github.com/trustedsec/SysmonCommunityGuide/blob/adcdfee20999f422b974c8d4149bf4c361237db7/chapters/file-stream-creation-hash.md",
                "https://labs.withsecure.com/publications/detecting-onenote-abuse"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.004"
            ],
            "title": "Unusual File Download from Direct IP Address"
        },
        {
            "id": "ae02ed70-11aa-4a22-b397-c0d0e8f6ea99",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/08/24",
            "description": "Detects the download of suspicious file type from a well-known file and paste sharing domain",
            "detection": {
                "condition": "all of selection*",
                "selection_domain": {
                    "Contents|contains": [
                        ".githubusercontent.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cdn.discordapp.com/attachments/",
                        "ddns.net",
                        "dl.dropboxusercontent.com",
                        "ghostbin.co",
                        "glitch.me",
                        "gofile.io",
                        "hastebin.com",
                        "mediafire.com",
                        "mega.nz",
                        "onrender.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "privatlab.com",
                        "privatlab.net",
                        "send.exploit.in",
                        "sendspace.com",
                        "storage.googleapis.com",
                        "storjshare.io",
                        "supabase.co",
                        "temp.sh",
                        "transfer.sh",
                        "ufile.io"
                    ]
                },
                "selection_extension": {
                    "TargetFilename|contains": [
                        ".ps1:Zone",
                        ".bat:Zone",
                        ".cmd:Zone"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "TargetFilename",
                "Image"
            ],
            "level": "medium",
            "modified": "2024/02/09",
            "logsource": {
                "category": "create_stream_hash",
                "product": "windows"
            },
            "status": "experimental",
            "references": [
                "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015",
                "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
                "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "52182dfb-afb7-41db-b4bc-5336cb29b464"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.s0139",
                "attack.t1564.004"
            ],
            "title": "Unusual File Download From File Sharing Websites"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/01/12",
            "description": "Detects execution of the \"mount\" command with \"hidepid\" parameter to make invisible processes to other users from the system",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "hidepid=2",
                        " -o "
                    ],
                    "Image|endswith": "/mount"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ec52985a-d024-41e3-8ff6-14169039a0b3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.blackberry.com/",
                "https://www.cyberciti.biz/faq/linux-hide-processes-from-other-users/",
                "https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144"
            ],
            "status": "test",
            "tags": [
                "attack.credential_access",
                "attack.t1564"
            ],
            "title": "Mount Execution With Hidepid Parameter"
        },
        {
            "author": "Pawel Mazur",
            "date": "2021/09/06",
            "description": "Detects adversary creating hidden file or directory, by detecting directories or files with . as the first character",
            "detection": {
                "arguments": [
                    {
                        "a1|contains": "/."
                    },
                    {
                        "a1|startswith": "."
                    },
                    {
                        "a2|contains": "/."
                    },
                    {
                        "a2|startswith": "."
                    }
                ],
                "commands": {
                    "a0": [
                        "mkdir",
                        "touch",
                        "vim",
                        "nano",
                        "vi"
                    ],
                    "type": "EXECVE"
                },
                "condition": "commands and arguments"
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d08722cd-3d09-449a-80b4-83ea2d9d4616",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "level": "low",
            "modified": "2022/10/09",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1564.001"
            ],
            "title": "Hidden Files and Directories"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Office 365"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "x_mitre_detection": "Monitor files, processes, and command-line arguments for actions indicative of hidden artifacts. Monitor event and authentication logs for records of hidden artifacts being used. Monitor the file system and shell commands for hidden attribute usage.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "File: File Metadata",
        "Application Log: Application Log Content",
        "Process: Process Creation",
        "Command: Command Execution",
        "File: File Modification",
        "Firmware: Firmware Modification",
        "Service: Service Creation",
        "Windows Registry: Windows Registry Key Modification",
        "Script: Script Execution",
        "User Account: User Account Creation",
        "Process: OS API Execution",
        "User Account: User Account Metadata",
        "File: File Creation"
    ],
    "x_mitre_permissions_required": []
}