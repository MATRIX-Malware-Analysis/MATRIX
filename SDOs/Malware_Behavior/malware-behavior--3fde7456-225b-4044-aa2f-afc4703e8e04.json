{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--3fde7456-225b-4044-aa2f-afc4703e8e04",
    "created": "2024-08-13T14:46:36.652001Z",
    "modified": "2024-08-13T14:46:36.652001Z",
    "name": "Task Impersonation",
    "description": "An adversary, through a previously installed malicious application, impersonates an expected or routine task in an attempt to steal sensitive information or leverage a user's privileges.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/504.html",
            "external_id": "504"
        },
        {
            "source_name": "CWE",
            "external_id": "1021"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authentication"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "An adversary monitors the system task list for Microsoft Outlook in an attempt to determine when the application may prompt the user to enter their credentials to view encrypted email. Once the task is executed, the adversary impersonates the credential prompt to obtain the user's Microsoft Outlook encryption credentials. These credentials can then be leveraged by the adversary to read a user's encrypted email."
        },
        {
            "description": "An adversary prompts a user to authorize an elevation of privileges, implying that a background task needs additional permissions to execute. The user accepts the privilege elevation, allowing the adversary to execute additional malware or tasks with the user's privileges."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Determine suitable tasks to exploit] Determine what tasks exist on the target system that may result in a user providing sensitive information.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Determine what tasks prompt a user for their credentials.",
                "Determine what tasks may prompt a user to authorize a process to execute with elevated privileges."
            ]
        },
        {
            "description": "[Impersonate Task] Impersonate a legitimate task, either expected or unexpected, in an attempt to gain user credentials or to ride the user's privileges.",
            "phase": "Exploit",
            "step": "2",
            "techniques": [
                "Prompt a user for their credentials, while making the user believe the credential request is legitimate.",
                "Prompt a user to authorize a task to run with elevated privileges, while making the user believe the request is legitimate."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Medium",
    "x_mitre_mitigations": [
        {
            "description": "The only known mitigation to this attack is to avoid installing the malicious application on the device. However, to impersonate a running task the malicious application does need the GET_TASKS permission to be able to query the task list, and being suspicious of applications with that permission can help."
        }
    ]
}