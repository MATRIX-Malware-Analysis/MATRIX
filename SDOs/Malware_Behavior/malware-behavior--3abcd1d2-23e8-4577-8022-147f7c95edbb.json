{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--3abcd1d2-23e8-4577-8022-147f7c95edbb",
    "created": "2024-08-13T14:46:36.876853Z",
    "modified": "2024-08-13T14:46:48.338205Z",
    "name": "Windows Management Instrumentation",
    "description": "Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is designed for programmers and is the infrastructure for management data and operations on Windows systems.[1] WMI is an administration feature that provides a uniform environment to access Windows system components.The WMI service enables both local and remote access, though the latter is facilitated by Remote Services such as Distributed Component Object Model and Windows Remote Management.[1] Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS.[1] [2]An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as Execution of commands and payloads.[2] For example, wmic.exe can be abused by an adversary to delete shadow copies with the command wmic.exe Shadowcopy Delete (i.e., Inhibit System Recovery).[3]Note: wmic.exe is deprecated as of January of 2024, with the WMIC feature being 'disabled by default' on Windows 11+. WMIC will be removed from subsequent Windows releases and replaced by PowerShell as the primary WMI interface.[4] In addition to PowerShell and tools like wbemtool.exe, COM APIs can also be used to programmatically interact with WMI via C++, .NET, VBScript, etc.[4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1047",
            "external_id": "T1047"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1047",
            "external_id": "T1047"
        },
        {
            "source_name": "FireEye WMI 2015",
            "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016.",
            "url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"
        },
        {
            "source_name": "Mandiant WMI",
            "description": "Mandiant. (n.d.). Retrieved February 13, 2024.",
            "url": "https://www.mandiant.com/resources/reports"
        },
        {
            "source_name": "WMI 6",
            "description": "Microsoft. (2022, June 13). BlackCat. Retrieved February 13, 2024.",
            "url": "https://www.microsoft.com/en-us/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/"
        },
        {
            "source_name": "WMI 1-3",
            "description": "Microsoft. (2023, March 7). Retrieved February 13, 2024.",
            "url": "https://learn.microsoft.com/en-us/windows/win32/wmisdk/wmi-start-page?redirectedfrom=MSDN"
        },
        {
            "source_name": "WMI 7,8",
            "description": "Microsoft. (2024, January 26). WMIC Deprecation. Retrieved February 13, 2024.",
            "url": "https://techcommunity.microsoft.com/t5/windows-it-pro-blog/wmi-command-line-wmic-utility-deprecation-next-steps/ba-p/4039242"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "string": "Win32_Process"
                            },
                            {
                                "optional": [
                                    {
                                        "string": "Win32_ProcessStartup"
                                    }
                                ]
                            },
                            {
                                "string": "Create"
                            },
                            {
                                "api": "System.Management.ManagementObject::GetMethodParameters"
                            },
                            {
                                "optional": [
                                    {
                                        "string": "CommandLine"
                                    },
                                    {
                                        "string": "ProcessStartupInformation"
                                    }
                                ]
                            },
                            {
                                "api": "System.Management.ManagementObject::InvokeMethod"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Execution::Windows Management Instrumentation [T1047]"
                    ],
                    "authors": [
                        "anushka.virgaonkar@mandiant.com"
                    ],
                    "name": "create process via WMI in .NET",
                    "namespace": "host-interaction/wmi",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "and": [
                                    {
                                        "api": "System.Management.ManagementClass::ctor"
                                    },
                                    {
                                        "optional": [
                                            {
                                                "api": "System.Management.ManagementClass::GetInstances"
                                            },
                                            {
                                                "api": "System.Management.ManagementObjectCollection::GetEnumerator"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "and": [
                                    {
                                        "api": "System.Management.ManagementObjectSearcher::Get"
                                    },
                                    {
                                        "optional": [
                                            {
                                                "api": "System.Management.ManagementObjectSearcher::ctor"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Execution::Windows Management Instrumentation [T1047]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "access WMI data in .NET",
                    "namespace": "host-interaction/wmi",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "basic block": [
                                    {
                                        "and": [
                                            {
                                                "api": "ole32.CoCreateInstance"
                                            },
                                            {
                                                "com/class": "WbemLocator"
                                            },
                                            {
                                                "com/interface": "IWbemLocator"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "or": [
                                    {
                                        "and": [
                                            {
                                                "arch": "i386"
                                            },
                                            {
                                                "offset": "0xC = ppv->ConnectServer"
                                            }
                                        ]
                                    },
                                    {
                                        "and": [
                                            {
                                                "arch": "amd64"
                                            },
                                            {
                                                "offset": "0x18 = ppv->ConnectServer"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "optional": [
                                    {
                                        "string": "/ROOT\\\\CIMV2/i"
                                    },
                                    {
                                        "string": "/ROOT\\\\DEFAULT/i"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Execution::Windows Management Instrumentation [T1047]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "examples": [
                        "al-khaser_x64.exe_:0x14001956e",
                        "al-khaser_x86.exe_:0x00445270"
                    ],
                    "name": "connect to WMI namespace via WbemLocator",
                    "namespace": "host-interaction/wmi",
                    "scopes": {
                        "dynamic": "unsupported",
                        "static": "function"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Sagie Dulce, Dekel Paz",
            "date": "2022/01/01",
            "description": "Detects remote RPC calls that performs remote DCOM operations. These could be abused for lateral movement via DCOM or WMI.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3,
                    "EventLog": "RPCFW",
                    "InterfaceUuid": [
                        "4d9f4ab8-7d1c-11cf-861e-0020af6e7c57",
                        "99fcfec4-5260-101b-bbcb-00aa0021347a",
                        "000001a0-0000-0000-c000-000000000046",
                        "00000131-0000-0000-c000-000000000046",
                        "00000143-0000-0000-c000-000000000046",
                        "00000000-0000-0000-c000-000000000046"
                    ]
                }
            },
            "falsepositives": [
                "Some administrative tasks on remote host"
            ],
            "id": "68050b10-e477-4377-a99b-3721b422d6ef",
            "level": "high",
            "logsource": {
                "category": "application",
                "definition": "Requirements: install and apply the RPC Firewall to all processes with \"audit:true action:block uuid:367abb81-9844-35f1-ad32-98f038001003",
                "product": "rpc_firewall"
            },
            "modified": "2022/01/01",
            "references": [
                "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-srvs/accf23b0-0f57-441c-9185-43041f1b0ee9",
                "https://github.com/zeronetworks/rpcfirewall",
                "https://zeronetworks.com/blog/stopping-lateral-movement-via-the-rpc-firewall/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1021.003",
                "attack.t1047"
            ],
            "title": "Remote DCOM/WMI Lateral Movement"
        },
        {
            "author": "@neu5ron, SOC Prime",
            "date": "2020/03/19",
            "description": "Windows DCE-RPC functions which indicate an execution techniques on the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation field goes to MITRE",
            "detection": {
                "condition": "1 of op*",
                "op1": {
                    "endpoint": "JobAdd",
                    "operation": "atsvc"
                },
                "op10": {
                    "endpoint": "svcctl",
                    "operation": "StartServiceW"
                },
                "op2": {
                    "endpoint": "ITaskSchedulerService",
                    "operation": "SchRpcEnableTask"
                },
                "op3": {
                    "endpoint": "ITaskSchedulerService",
                    "operation": "SchRpcRegisterTask"
                },
                "op4": {
                    "endpoint": "ITaskSchedulerService",
                    "operation": "SchRpcRun"
                },
                "op5": {
                    "endpoint": "IWbemServices",
                    "operation": "ExecMethod"
                },
                "op6": {
                    "endpoint": "IWbemServices",
                    "operation": "ExecMethodAsync"
                },
                "op7": {
                    "endpoint": "svcctl",
                    "operation": "CreateServiceA"
                },
                "op8": {
                    "endpoint": "svcctl",
                    "operation": "CreateServiceW"
                },
                "op9": {
                    "endpoint": "svcctl",
                    "operation": "StartServiceA"
                }
            },
            "falsepositives": [
                "Windows administrator tasks or troubleshooting",
                "Windows management scripts or software"
            ],
            "id": "b640c0b8-87f8-4daa-aef8-95a24261dd1d",
            "level": "medium",
            "logsource": {
                "product": "zeek",
                "service": "dce_rpc"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/mitre-attack/bzar#indicators-for-attck-execution"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.t1053.002",
                "attack.t1569.002"
            ],
            "title": "MITRE BZAR Indicators for Execution"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/10/12",
            "description": "Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\\Windows\\System32\\wbem\\` directory over the network and loading it for a WMI DLL Hijack scenario.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ImageLoaded|endswith": "\\wbem\\wbemcomn.dll",
                    "Image|endswith": "\\wmiprvse.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7707a579-e0d8-4886-a853-ce47e4575aaa",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "modified": "2022/10/09",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.lateral_movement",
                "attack.t1021.002"
            ],
            "title": "Wmiprvse Wbemcomn DLL Hijack"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/09/01",
            "description": "Detects suspicious encoded payloads in WMI Event Consumers",
            "detection": {
                "condition": "selection_destination",
                "selection_destination": {
                    "Destination|base64offset|contains": [
                        "WriteProcessMemory",
                        "This program cannot be run in DOS mode",
                        "This program must be run under Win32"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "User",
                "Operation"
            ],
            "id": "83844185-1c5b-45bc-bcf3-b5bf3084ca5b",
            "level": "high",
            "modified": "2022/10/09",
            "logsource": {
                "category": "wmi_event",
                "product": "windows"
            },
            "status": "test",
            "references": [
                "https://github.com/RiccardoAncarani/LiquidSnake"
            ],
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.persistence",
                "attack.t1546.003"
            ],
            "title": "Suspicious Encoded Scripts in a WMI Consumer"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/10/12",
            "description": "Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\\Windows\\System32\\wbem\\` directory over the network and loading it for a WMI DLL Hijack scenario.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image": "System",
                    "TargetFilename|endswith": "\\wbem\\wbemcomn.dll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "614a7e17-5643-4d89-b6fe-f9df1a79641c",
            "level": "critical",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/12/02",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.lateral_movement",
                "attack.t1021.002"
            ],
            "title": "Wmiprvse Wbemcomn DLL Hijack - File"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/02",
            "description": "Detects the creation of the default output filename used by the wmiexec tool",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "TargetFilename|re": "\\\\Windows\\\\__1\\d{9}\\.\\d{1,7}$"
                    },
                    {
                        "TargetFilename|re": "C:\\\\__1\\d{9}\\.\\d{1,7}$"
                    },
                    {
                        "TargetFilename|re": "D:\\\\__1\\d{9}\\.\\d{1,7}$"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "8d5aca11-22b3-4f22-b7ba-90e60533e1fb",
            "level": "critical",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/03/08",
            "references": [
                "https://www.crowdstrike.com/blog/how-to-detect-and-prevent-impackets-wmiexec/",
                "https://github.com/fortra/impacket/blob/f4b848fa27654ca95bc0f4c73dbba8b9c2c9f30a/examples/wmiexec.py"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.t1047"
            ],
            "title": "Wmiexec Default Output File"
        },
        {
            "author": "Florian Roth (Nextron Systems), Markus Neis, FPT.EagleEye Team, Vadim Khrykov, Cyb3rEng, Michael Haag, Christopher Peacock @securepeacock, @scythe_io",
            "date": "2018/04/06",
            "description": "Detects a suspicious process spawning from one of the Microsoft Office suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.)",
            "detection": {
                "condition": "selection_parent and 1 of selection_child_*",
                "selection_child_processes": [
                    {
                        "OriginalFileName": [
                            "bitsadmin.exe",
                            "CertOC.exe",
                            "CertUtil.exe",
                            "Cmd.Exe",
                            "CMSTP.EXE",
                            "cscript.exe",
                            "curl.exe",
                            "HH.exe",
                            "IEExec.exe",
                            "InstallUtil.exe",
                            "javaw.exe",
                            "Microsoft.Workflow.Compiler.exe",
                            "msdt.exe",
                            "MSHTA.EXE",
                            "msiexec.exe",
                            "Msxsl.exe",
                            "odbcconf.exe",
                            "pcalua.exe",
                            "PowerShell.EXE",
                            "RegAsm.exe",
                            "RegSvcs.exe",
                            "REGSVR32.exe",
                            "RUNDLL32.exe",
                            "schtasks.exe",
                            "ScriptRunner.exe",
                            "wmic.exe",
                            "WorkFolders.exe",
                            "wscript.exe"
                        ]
                    },
                    {
                        "Image|endswith": [
                            "\\AppVLP.exe",
                            "\\bash.exe",
                            "\\bitsadmin.exe",
                            "\\certoc.exe",
                            "\\certutil.exe",
                            "\\cmd.exe",
                            "\\cmstp.exe",
                            "\\control.exe",
                            "\\cscript.exe",
                            "\\curl.exe",
                            "\\forfiles.exe",
                            "\\hh.exe",
                            "\\ieexec.exe",
                            "\\installutil.exe",
                            "\\javaw.exe",
                            "\\mftrace.exe",
                            "\\Microsoft.Workflow.Compiler.exe",
                            "\\msbuild.exe",
                            "\\msdt.exe",
                            "\\mshta.exe",
                            "\\msidb.exe",
                            "\\msiexec.exe",
                            "\\msxsl.exe",
                            "\\odbcconf.exe",
                            "\\pcalua.exe",
                            "\\powershell.exe",
                            "\\pwsh.exe",
                            "\\regasm.exe",
                            "\\regsvcs.exe",
                            "\\regsvr32.exe",
                            "\\rundll32.exe",
                            "\\schtasks.exe",
                            "\\scrcons.exe",
                            "\\scriptrunner.exe",
                            "\\sh.exe",
                            "\\svchost.exe",
                            "\\verclsid.exe",
                            "\\wmic.exe",
                            "\\workfolders.exe",
                            "\\wscript.exe"
                        ]
                    }
                ],
                "selection_child_susp_paths": {
                    "Image|contains": [
                        "\\AppData\\",
                        "\\Users\\Public\\",
                        "\\ProgramData\\",
                        "\\Windows\\Tasks\\",
                        "\\Windows\\Temp\\",
                        "\\Windows\\System32\\Tasks\\"
                    ]
                },
                "selection_parent": {
                    "ParentImage|endswith": [
                        "\\EQNEDT32.EXE",
                        "\\EXCEL.EXE",
                        "\\MSACCESS.EXE",
                        "\\MSPUB.exe",
                        "\\ONENOTE.EXE",
                        "\\POWERPNT.exe",
                        "\\VISIO.exe",
                        "\\WINWORD.EXE",
                        "\\wordpad.exe",
                        "\\wordview.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "438025f9-5856-4663-83f7-52f878a70a50",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/24",
            "references": [
                "https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100",
                "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html",
                "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
                "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e",
                "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml",
                "https://github.com/splunk/security_content/blob/develop/detections/endpoint/office_spawning_control.yml",
                "https://twitter.com/andythevariable/status/1576953781581144064?s=20&t=QiJILvK4ZiBdR8RJe24u-A",
                "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set",
                "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/defense_evasion_execution_msbuild_started_by_office_app.toml",
                "https://www.vmray.com/analyses/2d2fa29185ad/report/overview.html",
                "https://app.any.run/tasks/c903e9c8-0350-440c-8688-3881b556b8e0/"
            ],
            "related": [
                {
                    "id": "c27515df-97a9-4162-8a60-dc0eeb51b775",
                    "type": "derived"
                },
                {
                    "id": "e1693bc8-7168-4eab-8718-cdcaa68a1738",
                    "type": "derived"
                },
                {
                    "id": "23daeb52-e6eb-493c-8607-c4f0246cb7d8",
                    "type": "obsoletes"
                },
                {
                    "id": "518643ba-7d9c-4fa5-9f37-baed36059f6a",
                    "type": "obsoletes"
                },
                {
                    "id": "04f5363a-6bca-42ff-be70-0d28bf629ead",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.t1047",
                "attack.t1204.002",
                "attack.t1218.010"
            ],
            "title": "Suspicious Microsoft Office Child Process"
        },
        {
            "author": "Nasreddine Bencherchali",
            "date": "2023/02/14",
            "description": "Detects the execution of WMIC in order to get a list of firewall and antivirus products",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "Product"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wmic.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "15434e33-5027-4914-88d5-3d4145ec25a9",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://thedfirreport.com/2023/03/06/2022-year-in-review/",
                "https://www.yeahhub.com/list-installed-programs-version-path-windows/",
                "https://learn.microsoft.com/en-us/answers/questions/253555/software-list-inventory-wmic-product"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Potential Product Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Maxim Pavlunin",
            "date": "2020/04/01",
            "description": "Detects a suspicious execution of a Microsoft HTML Help (HH.exe)",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "OriginalFileName": "HH.exe"
                    },
                    {
                        "Image|endswith": "\\hh.exe"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        ".application",
                        "\\AppData\\Local\\Temp\\",
                        "\\Content.Outlook\\",
                        "\\Downloads\\",
                        "\\Users\\Public\\",
                        "\\Windows\\Temp\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e8a95b5e-c891-46e2-b33a-93937d3abc31",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "references": [
                "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/",
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7",
                "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
                "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.initial_access",
                "attack.t1047",
                "attack.t1059.001",
                "attack.t1059.003",
                "attack.t1059.005",
                "attack.t1059.007",
                "attack.t1218",
                "attack.t1218.001",
                "attack.t1218.010",
                "attack.t1218.011",
                "attack.t1566",
                "attack.t1566.001"
            ],
            "title": "Suspicious HH.EXE Execution"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/14",
            "description": "An adversary might use WMI to check if a certain remote service is running on a remote device.\nWhen the test completes, a service information will be displayed on the screen if it exists.\nA common feedback message is that \"No instance(s) Available\" if the service queried is not running.\nA common error message is \"Node - (provided IP or default) ERROR Description =The RPC server is unavailable\" if the provided remote host is unreachable\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "service"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "76f55eaa-d27f-4213-9d45-7b0e4b60bbae",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
            ],
            "related": [
                {
                    "id": "68bcd73b-37ef-49cb-95fc-edc809730be6",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Service Reconnaissance Via Wmic.EXE"
        },
        {
            "id": "68bcd73b-37ef-49cb-95fc-edc809730be6",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/20",
            "description": "Detects known WMI recon method to look for unquoted service paths using wmic. Often used by pentester and attacker enumeration scripts",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " service get ",
                        "name,displayname,pathname,startmode"
                    ]
                },
                "selection_img": [
                    {
                        "OriginalFileName": "wmic.exe"
                    },
                    {
                        "Image|endswith": "\\WMIC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/09/11",
            "references": [
                "https://github.com/nccgroup/redsnarf/blob/35949b30106ae543dc6f2bc3f1be10c6d9a8d40e/redsnarf.py",
                "https://github.com/S3cur3Th1sSh1t/Creds/blob/eac23d67f7f90c7fc8e3130587d86158c22aa398/PowershellScripts/jaws-enum.ps1",
                "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
            ],
            "related": [
                {
                    "id": "09658312-bc27-4a3b-91c5-e49ab9046d1b",
                    "type": "similar"
                },
                {
                    "type": "similar",
                    "id": "76f55eaa-d27f-4213-9d45-7b0e4b60bbae"
                }
            ],
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "status": "experimental",
            "title": "Potential Unquoted Service Path Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Ecco, oscd.community, Jonhnathan Ribeiro, Tim Rauch",
            "date": "2019/09/03",
            "description": "Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework",
            "detection": {
                "condition": "1 of selection_*",
                "selection_atexec": {
                    "CommandLine|contains|all": [
                        "cmd.exe",
                        "/C",
                        "Windows\\Temp\\",
                        "&1"
                    ],
                    "ParentCommandLine|contains": [
                        "svchost.exe -k netsvcs",
                        "taskeng.exe"
                    ]
                },
                "selection_other": {
                    "CommandLine|contains|all": [
                        "cmd.exe",
                        "/Q",
                        "/c",
                        "\\\\\\\\127.0.0.1\\\\",
                        "&1"
                    ],
                    "ParentImage|endswith": [
                        "\\wmiprvse.exe",
                        "\\mmc.exe",
                        "\\explorer.exe",
                        "\\services.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "10c14723-61c7-4c75-92ca-9af245723ad2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/wmiexec.py",
                "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/atexec.py",
                "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/smbexec.py",
                "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/dcomexec.py",
                "https://www.elastic.co/guide/en/security/current/suspicious-cmd-execution-via-wmi.html"
            ],
            "related": [
                {
                    "id": "e31f89f7-36fb-4697-8ab6-48823708353b",
                    "type": "obsoletes"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.lateral_movement",
                "attack.t1021.003"
            ],
            "title": "HackTool - Potential Impacket Lateral Movement Activity"
        },
        {
            "id": "e1693bc8-7168-4eab-8718-cdcaa68a1738",
            "author": "Vadim Khrykov, Cyb3rEng",
            "date": "2021/08/23",
            "description": "Office application called wmic to proxye execution through a LOLBIN process. This is often used to break suspicious parent-child chain (Office app spawns LOLBin).",
            "detection": {
                "condition": "all of selection_*",
                "selection_parent": {
                    "ParentImage|endswith": [
                        "\\WINWORD.EXE",
                        "\\EXCEL.EXE",
                        "\\POWERPNT.exe",
                        "\\MSPUB.exe",
                        "\\VISIO.exe",
                        "\\MSACCESS.EXE",
                        "\\EQNEDT32.EXE",
                        "\\ONENOTE.EXE",
                        "\\wordpad.exe",
                        "\\wordview.exe"
                    ]
                },
                "selection_wmic_cli": {
                    "CommandLine|contains": [
                        "regsvr32",
                        "rundll32",
                        "msiexec",
                        "mshta",
                        "verclsid",
                        "wscript",
                        "cscript"
                    ],
                    "CommandLine|contains|all": [
                        "process",
                        "create",
                        "call"
                    ]
                },
                "selection_wmic_img": [
                    {
                        "Image|endswith": "\\wbem\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
                "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "438025f9-5856-4663-83f7-52f878a70a50"
                },
                {
                    "id": "518643ba-7d9c-4fa5-9f37-baed36059f6a",
                    "type": "obsoletes"
                },
                {
                    "id": "9d1c72f5-43f0-4da5-9320-648cf2099dd0",
                    "type": "obsoletes"
                },
                {
                    "id": "c0e1c3d5-4381-4f18-8145-2583f06a1fe5",
                    "type": "obsoletes"
                },
                {
                    "id": "04f5363a-6bca-42ff-be70-0d28bf629ead",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.t1204.002",
                "attack.t1047",
                "attack.t1218.010",
                "attack.execution",
                "attack.defense_evasion"
            ],
            "title": "Suspicious WMIC Execution Via Office Process"
        },
        {
            "author": "Sittikorn S",
            "date": "2021/06/21",
            "description": "Detects a suspicious child process of Script Event Consumer (scrcons.exe).",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\svchost.exe",
                        "\\dllhost.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\wscript.exe",
                        "\\cscript.exe",
                        "\\schtasks.exe",
                        "\\regsvr32.exe",
                        "\\mshta.exe",
                        "\\rundll32.exe",
                        "\\msiexec.exe",
                        "\\msbuild.exe"
                    ],
                    "ParentImage|endswith": "\\scrcons.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "f6d1dd2f-b8ce-40ca-bc23-062efb686b34",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/07/14",
            "status": "test",
            "references": [
                "https://redcanary.com/blog/child-processes/",
                "https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/scrcons-exe-rare-child-process.html"
            ],
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Script Event Consumer Spawning Process"
        },
        {
            "author": "Thomas Patzke",
            "date": "2020/05/22",
            "description": "Detects various execution patterns of the CrackMapExec pentesting framework",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "cmd.exe /Q /c * 1> \\\\\\\\*\\\\*\\\\* 2>&1",
                        "cmd.exe /C * > \\\\\\\\*\\\\*\\\\* 2>&1",
                        "cmd.exe /C * > *\\\\Temp\\\\* 2>&1",
                        "powershell.exe -exec bypass -noni -nop -w 1 -C \"",
                        "powershell.exe -noni -nop -w 1 -enc "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "058f4380-962d-40a5-afce-50207d36d7e2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/06",
            "references": [
                "https://github.com/byt3bl33d3r/CrackMapExec"
            ],
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.t1053",
                "attack.t1059.003",
                "attack.t1059.001",
                "attack.s0106"
            ],
            "title": "HackTool - CrackMapExec Execution Patterns",
            "status": "stable"
        },
        {
            "author": "Michael Haag, Florian Roth (Nextron Systems), juju4, oscd.community",
            "date": "2023/02/14",
            "description": "Detects the execution of WMIC in order to get a list of firewall and antivirus products",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "AntiVirusProduct",
                        "FirewallProduct"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wmic.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e568650b-5dcd-4658-8f34-ded0b1e13992",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/07",
            "references": [
                "https://github.com/albertzsigovits/malware-notes/blob/c820c7fea76cf76a861b28ebc77e06100e20ec29/Ransomware/Maze.md",
                "https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "car.2016-03-002"
            ],
            "title": "Potential Product Class Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/25",
            "description": "This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.",
            "detection": {
                "condition": "1 of selection_* or all of part_localauth*",
                "part_localauth_1": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -p "
                    ]
                },
                "part_localauth_2": {
                    "CommandLine|contains|all": [
                        " 10.",
                        " 192.168.",
                        "/24 "
                    ]
                },
                "selection_binary": {
                    "Image|endswith": "\\crackmapexec.exe"
                },
                "selection_execute": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -x "
                    ]
                },
                "selection_hash": {
                    "CommandLine|contains|all": [
                        " --local-auth",
                        " -u ",
                        " -p ",
                        " -H 'NTHASH'"
                    ]
                },
                "selection_module_mssql": {
                    "CommandLine|contains|all": [
                        " mssql ",
                        " -u ",
                        " -p ",
                        " -M ",
                        " -d "
                    ]
                },
                "selection_module_smb1": {
                    "CommandLine|contains|all": [
                        " smb ",
                        " -u ",
                        " -H ",
                        " -M ",
                        " -o "
                    ]
                },
                "selection_module_smb2": {
                    "CommandLine|contains|all": [
                        " smb ",
                        " -u ",
                        " -p ",
                        " --local-auth"
                    ]
                },
                "selection_special": {
                    "CommandLine|contains": " -M pe_inject "
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "ComputerName",
                "User",
                "CommandLine"
            ],
            "id": "42a993dd-bb3e-48c8-b372-4d6684c4106c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/08",
            "status": "test",
            "references": [
                "https://mpgn.gitbook.io/crackmapexec/smb-protocol/authentication/checking-credentials-local",
                "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
                "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=mssql-mimikatz",
                "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-pe_inject"
            ],
            "tags": [
                "attack.execution",
                "attack.persistence",
                "attack.privilege_escalation",
                "attack.credential_access",
                "attack.discovery",
                "attack.t1047",
                "attack.t1053",
                "attack.t1059.003",
                "attack.t1059.001",
                "attack.t1110",
                "attack.t1201"
            ],
            "title": "HackTool - CrackMapExec Execution"
        },
        {
            "author": "Vadim Khrykov (ThreatIntel), Cyb3rEng, Florian Roth (Nextron Systems)",
            "date": "2021/08/23",
            "description": "Detects suspicious and uncommon child processes of WmiPrvSE",
            "detection": {
                "condition": "selection_parent and 1 of selection_children_* and not 1 of filter_main_*",
                "filter_main_msiexec": {
                    "CommandLine|contains": "/i ",
                    "Image|endswith": "\\msiexec.exe"
                },
                "filter_main_werfault": {
                    "Image|endswith": "\\WerFault.exe"
                },
                "filter_main_wmiprvse": {
                    "Image|endswith": "\\WmiPrvSE.exe"
                },
                "selection_children_1": {
                    "Image|endswith": [
                        "\\certutil.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\msiexec.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\verclsid.exe",
                        "\\wscript.exe"
                    ]
                },
                "selection_children_2": {
                    "CommandLine|contains": [
                        "cscript",
                        "mshta",
                        "powershell",
                        "pwsh",
                        "regsvr32",
                        "rundll32",
                        "wscript"
                    ],
                    "Image|endswith": "\\cmd.exe"
                },
                "selection_parent": {
                    "ParentImage|endswith": "\\wbem\\WmiPrvSE.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8a582fe2-0882-4b89-a82a-da6b2dc32937",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/10",
            "references": [
                "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
                "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml",
                "https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/",
                "https://twitter.com/ForensicITGuy/status/1334734244120309760"
            ],
            "related": [
                {
                    "id": "692f0bec-83ba-4d04-af7e-e884a96059b6",
                    "type": "similar"
                },
                {
                    "id": "d21374ff-f574-44a7-9998-4a8c8bf33d7d",
                    "type": "similar"
                },
                {
                    "id": "18cf6cf0-39b0-4c22-9593-e244bdc9a2d4",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1047",
                "attack.t1204.002",
                "attack.t1218.010"
            ],
            "title": "Suspicious WmiPrvSE Child Process"
        },
        {
            "author": "frack113",
            "date": "2022/01/01",
            "description": "Detects the execution of \"wmic\" with the \"process\" flag, which adversary might use to list processes running on the compromised host or list installed software hotfixes and patches.",
            "detection": {
                "condition": "all of selection* and not 1 of filter_*",
                "filter_main_creation": {
                    "CommandLine|contains|all": [
                        "call",
                        "create"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains": "process"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "221b251a-357a-49a9-920a-271802777cc0",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
            ],
            "modified": "2023/02/14",
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Process Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2023/02/14",
            "description": "Detects the execution of WMIC with the \"csproduct\" which is used to obtain information such as hardware models and vendor information",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "csproduct"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wmic.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3e3ceccd-6c06-48b8-b5ff-ab1d25db8c1d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://jonconwayuk.wordpress.com/2014/01/31/wmic-csproduct-using-wmi-to-identify-make-and-model-of-hardware/",
                "https://www.uptycs.com/blog/kuraystealer-a-bandit-using-discord-webhooks"
            ],
            "status": "test",
            "title": "Hardware Model Reconnaissance Via Wmic.EXE",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "car.2016-03-002"
            ]
        },
        {
            "author": "Maxim Pavlunin, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/04/01",
            "description": "Detects a suspicious child process of a Microsoft HTML Help (HH.exe)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\CertReq.exe",
                        "\\CertUtil.exe",
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\installutil.exe",
                        "\\MSbuild.exe",
                        "\\MSHTA.EXE",
                        "\\msiexec.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\schtasks.exe",
                        "\\wmic.exe",
                        "\\wscript.exe"
                    ],
                    "ParentImage|endswith": "\\hh.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "52cad028-0ff0-4854-8f67-d25dfcbc78b4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "references": [
                "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/",
                "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7",
                "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
                "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.execution",
                "attack.initial_access",
                "attack.t1047",
                "attack.t1059.001",
                "attack.t1059.003",
                "attack.t1059.005",
                "attack.t1059.007",
                "attack.t1218",
                "attack.t1218.001",
                "attack.t1218.010",
                "attack.t1218.011",
                "attack.t1566",
                "attack.t1566.001"
            ],
            "title": "HTML Help HH.EXE Suspicious Child Process"
        },
        {
            "author": "Markus Neis, Florian Roth",
            "date": "2019/01/16",
            "description": "Detects potential SquiblyTwo attack technique with possible renamed WMIC via Imphash and OriginalFileName fields",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "format:",
                        "http"
                    ]
                },
                "selection_pe": [
                    {
                        "Image|endswith": "\\wmic.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    },
                    {
                        "Imphash": [
                            "1B1A3F43BF37B5BFE60751F2EE2F326E",
                            "37777A96245A3C74EB217308F3546F4C",
                            "9D87C9D67CE724033C0B40CC4CA1B206"
                        ]
                    },
                    {
                        "Hashes|contains": [
                            "IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E",
                            "IMPHASH=37777A96245A3C74EB217308F3546F4C",
                            "IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8d63dadf-b91b-4187-87b6-34a1114577ea",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/15",
            "references": [
                "https://web.archive.org/web/20190209154607/https://subt0x11.blogspot.com/2018/04/wmicexe-whitelisting-bypass-hacking.html",
                "https://twitter.com/mattifestation/status/986280382042595328",
                "https://atomicredteam.io/defense-evasion/T1220/",
                "https://lolbas-project.github.io/lolbas/Binaries/Wmic/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1047",
                "attack.t1220",
                "attack.execution",
                "attack.t1059.005",
                "attack.t1059.007"
            ],
            "title": "Potential SquiblyTwo Technique Execution"
        },
        {
            "id": "d21374ff-f574-44a7-9998-4a8c8bf33d7d",
            "author": "Roberto Rodriguez @Cyb3rWard0g",
            "date": "2019/08/15",
            "description": "Detects WmiPrvSE spawning a process",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_logonid": {
                    "LogonId": [
                        "0x3e7",
                        "null"
                    ]
                },
                "filter_null": {
                    "LogonId": null
                },
                "filter_system_user": {
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                },
                "filter_werfault": {
                    "Image|endswith": "\\WerFault.exe"
                },
                "filter_wmiprvse": {
                    "Image|endswith": "\\WmiPrvSE.exe"
                },
                "selection": {
                    "ParentImage|endswith": "\\WmiPrvSe.exe"
                }
            },
            "falsepositives": [
                "False positives are expected (e.g. in environments where WinRM is used legitimately)"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/23",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/190815-RemoteServiceInstallation/notebook.html"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "8a582fe2-0882-4b89-a82a-da6b2dc32937"
                },
                {
                    "id": "692f0bec-83ba-4d04-af7e-e884a96059b6",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "status": "stable",
            "title": "WmiPrvSE Spawned A Process"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/09/11",
            "description": "Detects calls to the \"terminate\" function via wmic in order to kill an application",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "call",
                        "terminate"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "49d9671b-0a0a-4c09-8280-d215bfd30662",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://cyble.com/blog/lockfile-ransomware-using-proxyshell-attack-to-deploy-ransomware/",
                "https://www.bitdefender.com/files/News/CaseStudies/study/377/Bitdefender-Whitepaper-WMI-creat4871-en-EN-GenericUse.pdf"
            ],
            "related": [
                {
                    "id": "847d5ff3-8a31-4737-a970-aeae8fe21765",
                    "type": "derived"
                }
            ],
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "status": "experimental",
            "title": "Application Terminated Via Wmic.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/10/12",
            "description": "Detects WMIC executing \"process call create\" with suspicious calls to processes such as \"rundll32\", \"regsrv32\", etc.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "rundll32",
                        "bitsadmin",
                        "regsvr32",
                        "cmd.exe /c ",
                        "cmd.exe /k ",
                        "cmd.exe /r ",
                        "cmd /c ",
                        "cmd /k ",
                        "cmd /r ",
                        "powershell",
                        "pwsh",
                        "certutil",
                        "cscript",
                        "wscript",
                        "mshta",
                        "\\Users\\Public\\",
                        "\\Windows\\Temp\\",
                        "\\AppData\\Local\\",
                        "%temp%",
                        "%tmp%",
                        "%ProgramData%",
                        "%appdata%",
                        "%comspec%",
                        "%localappdata%"
                    ],
                    "CommandLine|contains|all": [
                        "process ",
                        "call ",
                        "create "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3c89a1e8-0fba-449e-8f1b-8409d6267ec8",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://thedfirreport.com/2020/10/08/ryuks-return/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker"
            ],
            "related": [
                {
                    "id": "526be59f-a573-4eea-b5f7-f0973207634d",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Suspicious Process Created Via Wmic.EXE"
        },
        {
            "author": "Stephen Lincoln `@slincoln-aiq`(AttackIQ)",
            "date": "2024/02/02",
            "description": "An adversary might use WMI to discover information about the system, such as the volume name, size,\nfree space, and other disk information. This can be done using the `wmic` command-line utility and has been\nobserved being used by threat actors such as Volt Typhoon.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "volume",
                        "path win32_logicaldisk"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c79da740-5030-45ec-a2e0-479e824a562c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
            ],
            "related": [
                {
                    "id": "d85ecdd7-b855-4e6e-af59-d9c78b5b861e",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.execution",
                "attack.discovery",
                "attack.t1047",
                "attack.t1082"
            ],
            "title": "System Disk And Volume Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/20",
            "description": "Detects the execution of wmic with the \"qfe\" flag in order to obtain information about installed hotfix updates on the system. This is often used by pentester and attacker enumeration scripts",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|contains": " qfe"
                },
                "selection_img": [
                    {
                        "OriginalFileName": "wmic.exe"
                    },
                    {
                        "Image|endswith": "\\WMIC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://github.com/carlospolop/PEASS-ng/blob/fa0f2e17fbc1d86f1fd66338a40e665e7182501d/winPEAS/winPEASbat/winPEAS.bat",
                "https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Windows Hotfix Updates Reconnaissance Via Wmic.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/08",
            "description": "Detects execution of wmic utility with the \"computersystem\" flag in order to obtain information about the machine such as the domain, username, model, etc.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "computersystem"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wmic.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9d7ca793-f6bd-471c-8d0f-11e68b2f0d2f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/"
            ],
            "status": "test",
            "tags": [
                "attack.discovery",
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Computer System Reconnaissance Via Wmic.EXE"
        },
        {
            "id": "526be59f-a573-4eea-b5f7-f0973207634d",
            "author": "Michael Haag, Florian Roth (Nextron Systems), juju4, oscd.community",
            "date": "2019/01/16",
            "description": "Detects new process creation using WMIC via the \"process call create\" flag",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "process",
                        "call",
                        "create"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\wmic.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://www.sans.org/blog/wmic-for-incident-response/",
                "https://github.com/redcanaryco/atomic-red-team/blob/84215139ee5127f8e3a117e063b604812bd71928/atomics/T1047/T1047.md#atomic-test-5---wmi-execute-local-process"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "3c89a1e8-0fba-449e-8f1b-8409d6267ec8"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "car.2016-03-002"
            ],
            "title": "New Process Created Via Wmic.EXE"
        },
        {
            "id": "692f0bec-83ba-4d04-af7e-e884a96059b6",
            "author": "Markus Neis @Karneades",
            "date": "2019/04/03",
            "description": "Detects Powershell as a child of the WmiPrvSE process. Which could be a sign of lateral movement via WMI.",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\powershell.exe",
                            "\\pwsh.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll"
                        ]
                    }
                ],
                "selection_parent": {
                    "ParentImage|endswith": "\\WmiPrvSE.exe"
                }
            },
            "falsepositives": [
                "AppvClient",
                "CCM",
                "WinRM"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/29",
            "references": [
                "https://any.run/report/68bc255f9b0db6a0d30a8f2dadfbee3256acfe12497bf93943bc1eab0735e45e/a2385d6f-34f7-403c-90d3-b1f9d2a90a5e"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "8a582fe2-0882-4b89-a82a-da6b2dc32937"
                },
                {
                    "id": "d21374ff-f574-44a7-9998-4a8c8bf33d7d",
                    "type": "similar"
                }
            ],
            "status": "stable",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.t1059.001"
            ],
            "title": "Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/02/14",
            "description": "Detects the execution of WMIC to query information on a remote system",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "filter_localhost": {
                    "CommandLine|contains": [
                        "/node:127.0.0.1 ",
                        "/node:localhost "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains": "/node:"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7773b877-5abb-4a3e-b9c9-fd0369b59b00",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
            ],
            "related": [
                {
                    "id": "e42af9df-d90b-4306-b7fb-05c863847ebd",
                    "type": "obsoletes"
                },
                {
                    "id": "09af397b-c5eb-4811-b2bb-08b3de464ebf",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "WMIC Remote Command Execution"
        },
        {
            "author": "frack113",
            "date": "2022/01/28",
            "description": "Detects the removal or uninstallation of an application via \"Wmic.EXE\".",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "call",
                        "uninstall"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WMIC.exe"
                    },
                    {
                        "OriginalFileName": "wmic.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b53317a0-8acf-4fd1-8de8-a5401e776b96",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/07/02",
            "related": [
                {
                    "id": "847d5ff3-8a31-4737-a970-aeae8fe21765",
                    "type": "derived"
                }
            ],
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md#atomic-test-10---application-uninstall-using-wmic"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Application Removed Via Wmic.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/20",
            "description": "Detects usage of wmic to start or stop a service",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        "stopservice",
                        "startservice"
                    ],
                    "CommandLine|contains|all": [
                        " service ",
                        " call "
                    ]
                },
                "selection_img": [
                    {
                        "OriginalFileName": "wmic.exe"
                    },
                    {
                        "Image|endswith": "\\WMIC.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0b7163dc-7eee-4960-af17-c0cd517f92da",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Service Started/Stopped Via Wmic.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/09/01",
            "description": "Detects the WMI Event Consumer service scrcons.exe creating a named pipe",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\scrcons.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "493fb4ab-cdcc-4c4f-818c-0e363bd1e4bb",
            "level": "medium",
            "logsource": {
                "category": "pipe_created",
                "product": "windows",
                "definition": "Note that you have to configure logging for Named Pipe Events in Sysmon config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config, https://github.com/olafhartong/sysmon-modular. How to test detection? You can check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575"
            },
            "modified": "2023/11/30",
            "status": "test",
            "references": [
                "https://github.com/RiccardoAncarani/LiquidSnake"
            ],
            "tags": [
                "attack.t1047",
                "attack.execution"
            ],
            "title": "WMI Event Consumer Created Named Pipe"
        },
        {
            "author": "Bhabesh Raj",
            "date": "2020/07/14",
            "description": "Detects blocking of process creations originating from PSExec and WMI commands",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1121,
                    "ProcessName|endswith": [
                        "\\wmiprvse.exe",
                        "\\psexesvc.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "97b9ce1e-c5ab-11ea-87d0-0242ac130003",
            "level": "high",
            "logsource": {
                "definition": "Requirements:Enabled Block process creations originating from PSExec and WMI commands from Attack Surface Reduction (GUID: d1e49aac-8f56-4280-b9ba-993a6d77406c)",
                "product": "windows",
                "service": "windefend"
            },
            "modified": "2022/12/25",
            "references": [
                "https://learn.microsoft.com/en-us/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide#block-process-creations-originating-from-psexec-and-wmi-commands",
                "https://twitter.com/duff22b/status/1280166329660497920"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.lateral_movement",
                "attack.t1047",
                "attack.t1569.002"
            ],
            "title": "PSExec and WMI Process Creations Block"
        },
        {
            "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)",
            "date": "2020/10/12",
            "description": "Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\\Windows\\System32\\wbem\\` directory over the network for a WMI DLL Hijack scenario.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "SubjectUserName|endswith": "$"
                },
                "selection": {
                    "EventID": 5145,
                    "RelativeTargetName|endswith": "\\wbem\\wbemcomn.dll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f6c68d5f-e101-4b86-8c84-7d96851fd65c",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/02/24",
            "references": [
                "https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.lateral_movement",
                "attack.t1021.002"
            ],
            "title": "T1047 Wmiprvse Wbemcomn DLL Hijack"
        },
        {
            "author": "Thomas Patzke",
            "date": "2019/12/04",
            "description": "Detects successful logon attempts performed with WMI",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4624,
                    "ProcessName|endswith": "\\WmiPrvSE.exe"
                }
            },
            "falsepositives": [
                "Monitoring tools",
                "Legitimate system administration"
            ],
            "id": "5af54681-df95-4c26-854f-2565e13cfab0",
            "level": "low",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2024/01/17",
            "references": [
                "Internal Research"
            ],
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "Successful Account Login Via WMI",
            "status": "stable"
        },
        {
            "author": "NVISO",
            "date": "2020/03/26",
            "description": "Detects parameters used by WMImplant",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "WMImplant",
                        " change_user ",
                        " gen_cli ",
                        " command_exec ",
                        " disable_wdigest ",
                        " disable_winrm ",
                        " enable_wdigest ",
                        " enable_winrm ",
                        " registry_mod ",
                        " remote_posh ",
                        " sched_job ",
                        " service_mod ",
                        " process_kill ",
                        " active_users ",
                        " basic_info ",
                        " power_off ",
                        " vacant_system ",
                        " logon_events "
                    ]
                }
            },
            "falsepositives": [
                "Administrative scripts that use the same keywords."
            ],
            "id": "8028c2c3-e25a-46e3-827f-bbb5abf181d7",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/FortyNorthSecurity/WMImplant"
            ],
            "status": "test",
            "title": "WMImplant Hack Tool",
            "tags": [
                "attack.execution",
                "attack.t1047",
                "attack.t1059.001"
            ]
        },
        {
            "id": "09658312-bc27-4a3b-91c5-e49ab9046d1b",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/20",
            "description": "Detects known WMI recon method to look for unquoted service paths, often used by pentest inside of powershell scripts attackers enum scripts",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains": [
                        "Get-WmiObject ",
                        "gwmi "
                    ],
                    "ScriptBlockText|contains|all": [
                        " Win32_Service ",
                        "Name",
                        "DisplayName",
                        "PathName",
                        "StartMode"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/11/25",
            "related": [
                {
                    "id": "68bcd73b-37ef-49cb-95fc-edc809730be6",
                    "type": "similar"
                }
            ],
            "references": [
                "https://github.com/nccgroup/redsnarf/blob/35949b30106ae543dc6f2bc3f1be10c6d9a8d40e/redsnarf.py",
                "https://github.com/S3cur3Th1sSh1t/Creds/blob/eac23d67f7f90c7fc8e3130587d86158c22aa398/PowershellScripts/jaws-enum.ps1",
                "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1047"
            ],
            "title": "WMIC Unquoted Services Path Lookup - PowerShell"
        },
        {
            "author": "Trent Liffick (@tliffick)",
            "date": "2020/05/14",
            "description": "Attempts to detect system changes made by Blue Mockingbird",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|endswith": "\\CurrentControlSet\\Services\\wercplsupport\\Parameters\\ServiceDll"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "92b0b372-a939-44ed-a11b-5136cf680e27",
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://redcanary.com/blog/blue-mockingbird-cryptominer/"
            ],
            "related": [
                {
                    "id": "c3198a27-23a0-4c2c-af19-e5328d49680e",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1112",
                "attack.t1047"
            ],
            "title": "Blue Mockingbird - Registry"
        }
    ],
    "x_mitre_platforms": [
        "Windows"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "@ionstorm",
        "Olaf Hartong, Falcon Force",
        "Tristan Madani"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        }
    ],
    "x_mitre_detection": "Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect. Perform process monitoring to capture command-line arguments of \"wmic\" and detect commands that are used to perform remote behavior. (Citation: FireEye WMI 2015)",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.5",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Network Traffic: Network Connection Creation",
        "Process: Process Creation",
        "WMI: WMI Creation",
        "Command: Command Execution"
    ],
    "x_mitre_permissions_required": []
}