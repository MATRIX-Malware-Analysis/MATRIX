{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--28a8f7c4-21fb-4ec7-b892-82436c0feb5f",
    "created": "2024-08-13T14:46:36.923049Z",
    "modified": "2024-08-13T14:46:45.014511Z",
    "name": "Remote Access Software",
    "description": "An adversary may use legitimate desktop support and remote access software to establish an interactive command and control channel to target systems within networks. These services, such as VNC, Team Viewer, AnyDesk, ScreenConnect, LogMein, AmmyyAdmin, and other remote monitoring and management (RMM) tools, are commonly used as legitimate technical support software and may be allowed by application control within a target environment.[1][2][3]Remote access software may be installed and used post-compromise as an alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary-controlled system.Adversaries may similarly abuse response features included in EDR and other defensive tools that enable remote access.Installation of many remote access software may also include persistence (e.g., the software's installation routine creates a Windows Service). Remote access modules/features may also exist as part of otherwise existing software (e.g., Google Chrome\u2019s Remote Desktop).[4][5]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1219",
            "external_id": "T1219"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1219",
            "external_id": "T1219"
        },
        {
            "source_name": "CrowdStrike 2015 Global Threat Report",
            "description": "CrowdStrike Intelligence. (2016). 2015 Global Threat Report. Retrieved April 11, 2018.",
            "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/15GlobalThreatReport.pdf"
        },
        {
            "source_name": "CrySyS Blog TeamSpy",
            "description": "CrySyS Lab. (2013, March 20). TeamSpy \u2013 Obshie manevri. Ispolzovat\u2019 tolko s razreshenija S-a. Retrieved April 11, 2018.",
            "url": "https://blog.crysys.hu/2013/03/teamspy/"
        },
        {
            "source_name": "Google Chrome Remote Desktop",
            "description": "Google. (n.d.). Retrieved March 14, 2024.",
            "url": "https://support.google.com/chrome/answer/1649523"
        },
        {
            "source_name": "Chrome Remote Desktop",
            "description": "Huntress. (n.d.). Retrieved March 14, 2024.",
            "url": "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
        },
        {
            "source_name": "Symantec Living off the Land",
            "description": "Wueest, C., Anand, H. (2017, July). Living off the land and fileless attack techniques. Retrieved April 10, 2018.",
            "url": "https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-living-off-the-land-and-fileless-attack-techniques-en.pdf"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems), Arnim Rupp",
            "date": "2018/09/09",
            "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Signature|contains": [
                        "Backdoor.Cobalt",
                        "Brutel",
                        "BruteR",
                        "CobaltStr",
                        "CobaltStrike",
                        "COBEACON",
                        "Cometer",
                        "Exploit.Script.CVE",
                        "IISExchgSpawnCMD",
                        "Metasploit",
                        "Meterpreter",
                        "MeteTool",
                        "Mpreter",
                        "MsfShell",
                        "PowerSploit",
                        "Razy",
                        "Rozena",
                        "Sbelt",
                        "Seatbelt",
                        "Sliver",
                        "Swrort"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
            "level": "critical",
            "logsource": {
                "category": "antivirus"
            },
            "modified": "2024/07/17",
            "references": [
                "https://www.nextron-systems.com/?s=antivirus",
                "https://www.virustotal.com/gui/file/925b0b28472d4d79b4bf92050e38cc2b8f722691c713fc28743ac38551bc3797",
                "https://www.virustotal.com/gui/file/8f8daabe1c8ceb5710949283818e16c4aa8059bf2ce345e2f2c90b8692978424",
                "https://www.virustotal.com/gui/file/d9669f7e3eb3a9cdf6a750eeb2ba303b5ae148a43e36546896f1d1801e912466"
            ],
            "status": "stable",
            "tags": [
                "attack.execution",
                "attack.t1203",
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Antivirus Exploitation Framework Detection"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/06/24",
            "description": "Detects a DNS query by a non browser process on the system to \"azurewebsites.net\". The latter was often used by threat actors as a malware hosting and exfiltration site.\n",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_avant": {
                    "Image|endswith": "\\avant.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Avant Browser\\",
                        "C:\\Program Files\\Avant Browser\\"
                    ]
                },
                "filter_optional_brave": {
                    "Image|endswith": "\\brave.exe",
                    "Image|startswith": "C:\\Program Files\\BraveSoftware\\"
                },
                "filter_optional_chrome": {
                    "Image": [
                        "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                        "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                    ]
                },
                "filter_optional_defender": {
                    "Image|endswith": [
                        "\\MsMpEng.exe",
                        "\\MsSense.exe"
                    ]
                },
                "filter_optional_edge_1": [
                    {
                        "Image|startswith": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\"
                    },
                    {
                        "Image|endswith": "\\WindowsApps\\MicrosoftEdge.exe"
                    },
                    {
                        "Image": [
                            "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                            "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                        ]
                    }
                ],
                "filter_optional_edge_2": {
                    "Image|endswith": [
                        "\\msedge.exe",
                        "\\msedgewebview2.exe"
                    ],
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                        "C:\\Program Files\\Microsoft\\EdgeCore\\"
                    ]
                },
                "filter_optional_falkon": {
                    "Image|endswith": "\\falkon.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Falkon\\",
                        "C:\\Program Files (x86)\\Falkon\\"
                    ]
                },
                "filter_optional_firefox": {
                    "Image": [
                        "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                        "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                    ]
                },
                "filter_optional_flock": {
                    "Image|contains": "\\AppData\\Local\\Flock\\",
                    "Image|endswith": "\\Flock.exe"
                },
                "filter_optional_ie": {
                    "Image": [
                        "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                        "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                    ]
                },
                "filter_optional_maxthon": {
                    "Image|contains": "\\AppData\\Local\\Maxthon\\",
                    "Image|endswith": "\\maxthon.exe"
                },
                "filter_optional_midori": {
                    "Image|contains": "\\AppData\\Local\\Programs\\midori-ng\\",
                    "Image|endswith": "\\Midori Next Generation.exe"
                },
                "filter_optional_opera": {
                    "Image|contains": "\\AppData\\Local\\Programs\\Opera\\",
                    "Image|endswith": "\\opera.exe"
                },
                "filter_optional_phoebe": {
                    "Image|contains": "\\AppData\\Local\\Phoebe\\",
                    "Image|endswith": "\\Phoebe.exe"
                },
                "filter_optional_safari": {
                    "Image|endswith": "\\safari.exe"
                },
                "filter_optional_seamonkey": {
                    "Image|endswith": "\\seamonkey.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SeaMonkey\\",
                        "C:\\Program Files (x86)\\SeaMonkey\\"
                    ]
                },
                "filter_optional_slimbrowser": {
                    "Image|endswith": "\\slimbrowser.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SlimBrowser\\",
                        "C:\\Program Files (x86)\\SlimBrowser\\"
                    ]
                },
                "filter_optional_tor": {
                    "Image|contains": "\\Tor Browser\\"
                },
                "filter_optional_vivaldi": {
                    "Image|contains": "\\AppData\\Local\\Vivaldi\\",
                    "Image|endswith": "\\vivaldi.exe"
                },
                "filter_optional_whale": {
                    "Image|endswith": "\\whale.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Naver\\Naver Whale\\",
                        "C:\\Program Files (x86)\\Naver\\Naver Whale\\"
                    ]
                },
                "filter_optional_whaterfox": {
                    "Image|endswith": "\\Waterfox.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Waterfox\\",
                        "C:\\Program Files (x86)\\Waterfox\\"
                    ]
                },
                "selection": {
                    "QueryName|endswith": "azurewebsites.net"
                }
            },
            "falsepositives": [
                "Likely with other browser software. Apply additional filters for any other browsers you might use."
            ],
            "id": "e043f529-8514-4205-8ab0-7f7d2927b400",
            "level": "medium",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "references": [
                "https://www.sentinelone.com/labs/wip26-espionage-threat-actors-abuse-cloud-infrastructure-in-targeted-telco-attacks/",
                "https://symantec-enterprise-blogs.security.com/threat-intelligence/harvester-new-apt-attacks-asia",
                "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
                "https://intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/"
            ],
            "related": [
                {
                    "id": "5c80b618-0dbb-46e6-acbb-03d90bcb6d83",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "DNS Query To AzureWebsites.NET By Non-Browser Process"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/30",
            "description": "Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer client by an image that isn't named TeamViewer (sometimes used by threat actors for obfuscation)",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_teamviewer": {
                    "Image|contains": "TeamViewer"
                },
                "selection": {
                    "QueryName": [
                        "taf.teamviewer.com",
                        "udp.ping.teamviewer.com"
                    ]
                }
            },
            "falsepositives": [
                "Unknown binary names of TeamViewer",
                "Depending on the environment the rule might require some initial tuning before usage to avoid FP with third party applications"
            ],
            "id": "778ba9a8-45e4-4b80-8e3e-34a419f0b85e",
            "level": "medium",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://www.teamviewer.com/en-us/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "TeamViewer Domain Query By Non-TeamViewer Application"
        },
        {
            "author": "frack113, Connor Martin",
            "date": "2022/07/11",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_optional_*",
                "filter_optional_avant": {
                    "Image|endswith": "\\avant.exe",
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Avant Browser\\",
                        "C:\\Program Files\\Avant Browser\\"
                    ]
                },
                "filter_optional_brave": {
                    "Image|endswith": "\\brave.exe",
                    "Image|startswith": "C:\\Program Files\\BraveSoftware\\"
                },
                "filter_optional_chrome": {
                    "Image": [
                        "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                        "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                    ]
                },
                "filter_optional_defender": {
                    "Image|endswith": [
                        "\\MsMpEng.exe",
                        "\\MsSense.exe"
                    ]
                },
                "filter_optional_edge_1": [
                    {
                        "Image|startswith": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\"
                    },
                    {
                        "Image|endswith": "\\WindowsApps\\MicrosoftEdge.exe"
                    },
                    {
                        "Image": [
                            "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                            "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                        ]
                    }
                ],
                "filter_optional_edge_2": {
                    "Image|endswith": [
                        "\\msedge.exe",
                        "\\msedgewebview2.exe"
                    ],
                    "Image|startswith": [
                        "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                        "C:\\Program Files\\Microsoft\\EdgeCore\\"
                    ]
                },
                "filter_optional_falkon": {
                    "Image|endswith": "\\falkon.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Falkon\\",
                        "C:\\Program Files (x86)\\Falkon\\"
                    ]
                },
                "filter_optional_firefox": {
                    "Image": [
                        "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                        "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                    ]
                },
                "filter_optional_flock": {
                    "Image|contains": "\\AppData\\Local\\Flock\\",
                    "Image|endswith": "\\Flock.exe"
                },
                "filter_optional_ie": {
                    "Image": [
                        "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                        "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                    ]
                },
                "filter_optional_maxthon": {
                    "Image|contains": "\\AppData\\Local\\Maxthon\\",
                    "Image|endswith": "\\maxthon.exe"
                },
                "filter_optional_midori": {
                    "Image|contains": "\\AppData\\Local\\Programs\\midori-ng\\",
                    "Image|endswith": "\\Midori Next Generation.exe"
                },
                "filter_optional_opera": {
                    "Image|contains": "\\AppData\\Local\\Programs\\Opera\\",
                    "Image|endswith": "\\opera.exe"
                },
                "filter_optional_phoebe": {
                    "Image|contains": "\\AppData\\Local\\Phoebe\\",
                    "Image|endswith": "\\Phoebe.exe"
                },
                "filter_optional_safari": {
                    "Image|endswith": "\\safari.exe"
                },
                "filter_optional_seamonkey": {
                    "Image|endswith": "\\seamonkey.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SeaMonkey\\",
                        "C:\\Program Files (x86)\\SeaMonkey\\"
                    ]
                },
                "filter_optional_slimbrowser": {
                    "Image|endswith": "\\slimbrowser.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\SlimBrowser\\",
                        "C:\\Program Files (x86)\\SlimBrowser\\"
                    ]
                },
                "filter_optional_tor": {
                    "Image|contains": "\\Tor Browser\\"
                },
                "filter_optional_vivaldi": {
                    "Image|contains": "\\AppData\\Local\\Vivaldi\\",
                    "Image|endswith": "\\vivaldi.exe"
                },
                "filter_optional_whale": {
                    "Image|endswith": "\\whale.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Naver\\Naver Whale\\",
                        "C:\\Program Files (x86)\\Naver\\Naver Whale\\"
                    ]
                },
                "filter_optional_whaterfox": {
                    "Image|endswith": "\\Waterfox.exe",
                    "Image|startswith": [
                        "C:\\Program Files\\Waterfox\\",
                        "C:\\Program Files (x86)\\Waterfox\\"
                    ]
                },
                "selection_generic": {
                    "QueryName|endswith": [
                        "agent.jumpcloud.com",
                        "agentreporting.atera.com",
                        "ammyy.com",
                        "api.parsec.app",
                        "api.playanext.com",
                        "api.splashtop.com",
                        "app.atera.com",
                        "assist.zoho.com",
                        "authentication.logmeininc.com",
                        "beyondtrustcloud.com",
                        "cdn.kaseya.net",
                        "client.teamviewer.com",
                        "comserver.corporate.beanywhere.com",
                        "control.connectwise.com",
                        "downloads.zohocdn.com",
                        "dwservice.net",
                        "express.gotoassist.com",
                        "getgo.com",
                        "integratedchat.teamviewer.com",
                        "join.zoho.com",
                        "kickstart.jumpcloud.com",
                        "license.bomgar.com",
                        "logmein-gateway.com",
                        "logmein.com",
                        "logmeincdn.http.internapcdn.net",
                        "n-able.com",
                        "net.anydesk.com",
                        "netsupportsoftware.com",
                        "parsecusercontent.com",
                        "pubsub.atera.com",
                        "relay.kaseya.net",
                        "relay.screenconnect.com",
                        "relay.splashtop.com",
                        "remotedesktop-pa.googleapis.com",
                        "remoteutilities.com",
                        "secure.logmeinrescue.com",
                        "services.vnc.com",
                        "static.remotepc.com",
                        "swi-rc.com",
                        "swi-tc.com",
                        "telemetry.servers.qetqo.com",
                        "tmate.io",
                        "zohoassist.com"
                    ]
                },
                "selection_rustdesk": {
                    "QueryName|endswith": ".rustdesk.com",
                    "QueryName|startswith": "rs-"
                }
            },
            "falsepositives": [
                "Likely with other browser software. Apply additional filters for any other browsers you might use."
            ],
            "id": "4d07b1f4-cb00-4470-b9f8-b0191d48ff52",
            "level": "medium",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/09/12",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows",
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-6---ammyy-admin-software-execution",
                "https://redcanary.com/blog/misbehaving-rats/",
                "https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/hunting-for-omi-vulnerability-exploitation-with-azure-sentinel/ba-p/2764093"
            ],
            "related": [
                {
                    "id": "71ba22cb-8a01-42e2-a6dd-5bf9b547498f",
                    "type": "obsoletes"
                },
                {
                    "id": "7c4cf8e0-1362-48b2-a512-b606d2065d7d",
                    "type": "obsoletes"
                },
                {
                    "id": "ed785237-70fa-46f3-83b6-d264d1dc6eb4",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "DNS Query To Remote Access Software Domain From Non-Browser App"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/30",
            "description": "Detects the creation of log files during a TeamViewer remote session",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "TargetFilename|endswith": [
                        "\\TeamViewer\\RemotePrinting\\tvprint.db",
                        "\\TeamViewer\\TVNetwork.log"
                    ]
                },
                "selection2": {
                    "TargetFilename|contains|all": [
                        "\\TeamViewer",
                        "_Logfile.log"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate uses of TeamViewer in an organisation"
            ],
            "id": "162ab1e4-6874-4564-853c-53ec3ab8be01",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://www.teamviewer.com/en-us/"
            ],
            "status": "test",
            "title": "TeamViewer Remote Session",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/11",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": [
                        "\\AppData\\Roaming\\AnyDesk\\user.conf",
                        "\\AppData\\Roaming\\AnyDesk\\system.conf"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "0b9ad457-2554-44c1-82c2-d56a99c42377",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/07/20",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Anydesk Temporary Artefact"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/10/24",
            "description": "Detects the presence and execution of Inveigh via dropped artefacts",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": [
                        "\\Inveigh-Log.txt",
                        "\\Inveigh-Cleartext.txt",
                        "\\Inveigh-NTLMv1Users.txt",
                        "\\Inveigh-NTLMv2Users.txt",
                        "\\Inveigh-NTLMv1.txt",
                        "\\Inveigh-NTLMv2.txt",
                        "\\Inveigh-FormInput.txt",
                        "\\Inveigh.dll",
                        "\\Inveigh.exe",
                        "\\Inveigh.ps1",
                        "\\Inveigh-Relay.ps1"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "bb09dd3e-2b78-4819-8e35-a7c1b874e449",
            "level": "critical",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2024/06/27",
            "references": [
                "https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Output.cs",
                "https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Control.cs",
                "https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "HackTool - Inveigh Execution Artefacts"
        },
        {
            "author": "frack113",
            "date": "2022/02/13",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "\\AppData\\Local\\Temp\\LogMeInInc\\GoToAssist Remote Support Expert\\"
                }
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "5d756aee-ad3e-4306-ad95-cb1abec48de2",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows"
            ],
            "status": "test",
            "title": "GoToAssist Temporary Installation Artefact",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/13",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "\\Bin\\ScreenConnect."
                }
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "fec96f39-988b-4586-b746-b93d59fd1922",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows"
            ],
            "status": "test",
            "title": "ScreenConnect Temporary Installation Artefact",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/28",
            "description": "Detects AnyDesk writing binary files to disk other than \"gcapi.dll\".\nAccording to RedCanary research it is highly abnormal for AnyDesk to write executable files to disk besides gcapi.dll,\nwhich is a legitimate DLL that is part of the Google Chrome web browser used to interact with the Google Cloud API. (See reference section for more details)\n",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_dlls": {
                    "TargetFilename|endswith": "\\gcapi.dll"
                },
                "selection": {
                    "Image|endswith": "\\anydesk.exe",
                    "TargetFilename|endswith": [
                        ".dll",
                        ".exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2d367498-5112-4ae5-a06a-96e7bc33a211",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/blog/misbehaving-rats/"
            ],
            "status": "test",
            "title": "Suspicious Binary Writes Via AnyDesk",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "Samir Bousseaden",
            "date": "2019/02/21",
            "description": "Detects the usage of tsclient share to place a backdoor on the RDP source machine's startup folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\mstsc.exe",
                    "TargetFilename|contains": "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "52753ea4-b3a0-4365-910d-36cff487b789",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Hijack Legit RDP Session to Move Laterally"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/06/27",
            "description": "Detects the creation of file with specific names used by RemoteKrbRelay SMB Relay attack module.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": [
                        ":\\windows\\temp\\sam.tmp",
                        ":\\windows\\temp\\sec.tmp",
                        ":\\windows\\temp\\sys.tmp"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "3ab79e90-9fab-4cdf-a7b2-6522bc742adb",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/CICADA8-Research/RemoteKrbRelay/blob/19ec76ba7aa50c2722b23359bc4541c0a9b2611c/Exploit/RemoteKrbRelay/Relay/Attacks/RemoteRegistry.cs#L31-L40"
            ],
            "status": "experimental",
            "title": "HackTool - RemoteKrbRelay SMB Relay Secrets Dump Module Indicators",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/28",
            "description": "TeamViewer_Desktop.exe is create during install",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|endswith": "\\TeamViewer_Desktop.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9711de76-5d4f-4c50-a94f-21e4e8f8384d",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-1---teamviewer-files-detected-test-on-windows"
            ],
            "status": "test",
            "title": "Installation of TeamViewer Desktop",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/13",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "GoTo Opener"
                    },
                    {
                        "Product": "GoTo Opener"
                    },
                    {
                        "Company": "LogMeIn, Inc."
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "b6d98a4f-cef0-4abf-bbf6-24132854a83d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows"
            ],
            "modified": "2023/03/05",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - GoToAssist Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/02/23",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|contains": [
                        "\\JWrapper-Remote Access\\",
                        "\\JWrapper-Remote Support\\"
                    ],
                    "Image|endswith": "\\SimpleService.exe"
                }
            },
            "falsepositives": [
                "Legitimate usage of the tool"
            ],
            "id": "95e60a2b-4705-444b-b7da-ba0ea81a3ee2",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
            ],
            "status": "experimental",
            "title": "Remote Access Tool - Simple Help Execution",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/11",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "LMIGuardianSvc"
                    },
                    {
                        "Product": "LMIGuardianSvc"
                    },
                    {
                        "Company": "LogMeIn, Inc."
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "d85873ef-a0f8-4c48-a53a-6b621f11729d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - LogMeIn Execution"
        },
        {
            "author": "Muhammad Faisal",
            "date": "2023/08/02",
            "description": "Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "-register ",
                        "-code ",
                        "-id ",
                        "-region "
                    ],
                    "Image|endswith": "\\amazon-ssm-agent.exe"
                }
            },
            "falsepositives": [
                "Legitimate activity of system administrators"
            ],
            "id": "d20ee2f4-822c-4827-9e15-41500b1fff10",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan",
                "https://www.bleepingcomputer.com/news/security/amazons-aws-ssm-agent-can-be-used-as-post-exploitation-rat-malware/",
                "https://www.helpnetsecurity.com/2023/08/02/aws-instances-attackers-access/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.persistence",
                "attack.t1219"
            ],
            "title": "Potential Amazon SSM Agent Hijacking"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/04/18",
            "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file located in suspicious locations.",
            "detection": {
                "condition": "all of selection_*",
                "selection_extension": {
                    "CommandLine|endswith": [
                        ".rdp",
                        ".rdp\""
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\mstsc.exe"
                    },
                    {
                        "OriginalFileName": "mstsc.exe"
                    }
                ],
                "selection_paths": {
                    "CommandLine|contains": [
                        ":\\Users\\Public\\",
                        ":\\Windows\\System32\\spool\\drivers\\color",
                        ":\\Windows\\System32\\Tasks_Migrated ",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        ":\\Windows\\Tracing\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\Downloads\\"
                    ]
                }
            },
            "falsepositives": [
                "Likelihood is related to how often the paths are used in the environment"
            ],
            "id": "6e22722b-dfb1-4508-a911-49ac840b40f8",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/",
                "https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"
            ],
            "status": "test",
            "title": "Suspicious Mstsc.EXE Execution With Local RDP File",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/05/20",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|contains": [
                        "\\AppData\\",
                        "Program Files (x86)\\AnyDesk",
                        "Program Files\\AnyDesk"
                    ]
                },
                "selection": [
                    {
                        "Image|endswith": "\\AnyDesk.exe"
                    },
                    {
                        "Description": "AnyDesk"
                    },
                    {
                        "Product": "AnyDesk"
                    },
                    {
                        "Company": "AnyDesk Software GmbH"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of AnyDesk from a non-standard folder"
            ],
            "id": "065b00ca-5d5c-4557-ac95-64a6d0b64d86",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows"
            ],
            "related": [
                {
                    "id": "b52e84a3-029e-4529-b09b-71d19dd27e94",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - Anydesk Execution From Suspicious Folder"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @Kostastsale",
            "date": "2022/02/25",
            "description": "Detects potentially suspicious child processes launched via the ScreenConnect client service.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\bitsadmin.exe",
                        "\\cmd.exe",
                        "\\curl.exe",
                        "\\dllhost.exe",
                        "\\net.exe",
                        "\\nltest.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\rundll32.exe",
                        "\\wevtutil.exe"
                    ],
                    "ParentCommandLine|contains|all": [
                        ":\\Windows\\TEMP\\ScreenConnect\\",
                        "run.cmd"
                    ]
                }
            },
            "falsepositives": [
                "If the script being executed make use of any of the utilities mentioned in the detection then they should filtered out or allowed."
            ],
            "id": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/02/28",
            "references": [
                "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
                "https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode",
                "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708",
                "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html"
            ],
            "related": [
                {
                    "id": "d1a401ab-8c47-4e86-a7d8-2460b6a53e4a",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Christopher Peacock @securepeacock",
            "date": "2023/04/18",
            "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_optional_*",
                "filter_optional_wsl": {
                    "CommandLine|contains": "C:\\ProgramData\\Microsoft\\WSL\\wslg.rdp",
                    "ParentImage": "C:\\Windows\\System32\\lxss\\wslhost.exe"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\mstsc.exe"
                    },
                    {
                        "OriginalFileName": "mstsc.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|endswith": [
                        ".rdp",
                        ".rdp\""
                    ]
                }
            },
            "falsepositives": [
                "Likely with legitimate usage of \".rdp\" files"
            ],
            "id": "5fdce3ac-e7f9-4ecd-a3aa-a4d78ebbf0af",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/",
                "https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"
            ],
            "modified": "2023/04/30",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Mstsc.EXE Execution With Local RDP File"
        },
        {
            "author": "frack113",
            "date": "2022/09/25",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Product": "UltraViewer"
                    },
                    {
                        "Company": "DucFabulous Co,ltd"
                    },
                    {
                        "OriginalFileName": "UltraViewer_Desktop.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "88656cec-6c3b-487c-82c0-f73ebb805503",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/14",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - UltraViewer Execution"
        },
        {
            "author": "J\u00e1n Tren\u010dansk\u00fd",
            "date": "2021/08/06",
            "description": "Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "--install",
                        "--start-with-win",
                        "--silent"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate deployment of AnyDesk"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "CurrentDirectory"
            ],
            "id": "114e7f1c-f137-48c8-8f54-3088c24ce4b9",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "status": "test",
            "references": [
                "https://twitter.com/TheDFIRReport/status/1423361119926816776?s=20",
                "https://support.anydesk.com/Automatic_Deployment"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - AnyDesk Silent Installation"
        },
        {
            "author": "frack113",
            "date": "2022/09/25",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "NetSupport Client Configurator"
                    },
                    {
                        "Product": "NetSupport Remote Control"
                    },
                    {
                        "Company": "NetSupport Ltd"
                    },
                    {
                        "OriginalFileName": "PCICFGUI.EXE"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "758ff488-18d5-4cbe-8ec4-02b6285a434f",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/06",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - NetSupport Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/28",
            "description": "Detects piping the password to an anydesk instance via CMD and the '--set-password' flag.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "/c ",
                        "echo ",
                        ".exe --set-password"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate piping of the password to anydesk",
                "Some FP could occur with similar tools that uses the same command line '--set-password'"
            ],
            "id": "b1377339-fda6-477a-b455-ac0923f9ec2c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/blog/misbehaving-rats/"
            ],
            "modified": "2023/03/05",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - AnyDesk Piped Password Via CLI"
        },
        {
            "author": "frack113",
            "date": "2022/10/02",
            "description": "An adversary may use legitimate desktop support and remote access software,to establish an interactive command and control channel to target systems within networks",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "VNCViewer"
                    },
                    {
                        "Product": "UltraVNC VNCViewer"
                    },
                    {
                        "Company": "UltraVNC"
                    },
                    {
                        "OriginalFileName": "VNCViewer.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "145322e4-0fd3-486b-81ca-9addc75736d8",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1219/T1219.md"
            ],
            "status": "test",
            "title": "Use of UltraVNC Remote Access Software",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/02/13",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Description": "ScreenConnect Service"
                    },
                    {
                        "Product": "ScreenConnect"
                    },
                    {
                        "Company": "ScreenConnect Software"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate usage of the tool"
            ],
            "id": "57bff678-25d1-4d6c-8211-8ca106d12053",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows"
            ],
            "modified": "2023/03/05",
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - ScreenConnect Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/03/17",
            "description": "Detects a tscon.exe start as LOCAL SYSTEM",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\tscon.exe",
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9847f263-4a81-424f-970c-875dab15b79b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/05/27",
            "references": [
                "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html",
                "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6",
                "https://www.ired.team/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Suspicious TSCON Start as SYSTEM"
        },
        {
            "id": "b52e84a3-029e-4529-b09b-71d19dd27e94",
            "author": "frack113",
            "date": "2022/02/11",
            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\AnyDesk.exe"
                    },
                    {
                        "Description": "AnyDesk"
                    },
                    {
                        "Product": "AnyDesk"
                    },
                    {
                        "Company": "AnyDesk Software GmbH"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows"
            ],
            "status": "test",
            "related": [
                {
                    "type": "similar",
                    "id": "065b00ca-5d5c-4557-ac95-64a6d0b64d86"
                }
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Remote Access Tool - AnyDesk Execution"
        },
        {
            "author": "James Pemberton",
            "date": "2020/05/22",
            "description": "Detects logons using NTLM to hosts that are potentially not part of the domain.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 8001,
                    "TargetName|startswith": "TERMSRV"
                }
            },
            "falsepositives": [
                "Host connections to valid domains, exclude these.",
                "Host connections not using host FQDN.",
                "Host connections to external legitimate domains."
            ],
            "fields": [
                "Computer",
                "UserName",
                "DomainName",
                "TargetName"
            ],
            "id": "ce5678bb-b9aa-4fb5-be4b-e57f686256ad",
            "level": "medium",
            "modified": "2021/11/27",
            "logsource": {
                "definition": "Requires events from Microsoft-Windows-NTLM/Operational",
                "product": "windows",
                "service": "ntlm"
            },
            "status": "test",
            "references": [
                "n/a"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ],
            "title": "Potential Remote Desktop Connection to Non-Domain Host"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/11/28",
            "description": "Detects a Mesh Agent service installation. Mesh Agent is used to remotely manage computers",
            "detection": {
                "condition": "all of selection_*",
                "selection_root": {
                    "EventID": 7045,
                    "Provider_Name": "Service Control Manager"
                },
                "selection_service": [
                    {
                        "ImagePath|contains": "MeshAgent.exe"
                    },
                    {
                        "ServiceName|contains": "Mesh Agent"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of the tool"
            ],
            "id": "e0d1ad53-c7eb-48ec-a87a-72393cc6cedc",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "references": [
                "https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/"
            ],
            "status": "test",
            "title": "Mesh Agent Service Installation",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/11/28",
            "description": "Detects a TacticalRMM service installation. Tactical RMM is a remote monitoring & management tool.",
            "detection": {
                "condition": "all of selection_*",
                "selection_root": {
                    "EventID": 7045,
                    "Provider_Name": "Service Control Manager"
                },
                "selection_service": [
                    {
                        "ImagePath|contains": "tacticalrmm.exe"
                    },
                    {
                        "ServiceName|contains": "TacticalRMM Agent Service"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of the tool"
            ],
            "id": "4bb79b62-ef12-4861-981d-2aab43fab642",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "references": [
                "https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/"
            ],
            "status": "test",
            "title": "TacticalRMM Service Installation",
            "tags": [
                "attack.command_and_control",
                "attack.t1219"
            ]
        },
        {
            "author": "Bhabesh Raj",
            "date": "2021/09/01",
            "description": "Detects successful installation of Atera Remote Monitoring & Management (RMM) agent as recently found to be used by Conti operators",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 1033,
                    "Message|contains": "AteraAgent",
                    "Provider_Name": "MsiInstaller"
                }
            },
            "falsepositives": [
                "Legitimate Atera agent installation"
            ],
            "id": "87261fb2-69d0-42fe-b9de-88c6b5f65a43",
            "level": "high",
            "logsource": {
                "service": "application",
                "product": "windows"
            },
            "modified": "2022/12/25",
            "references": [
                "https://www.advintel.io/post/secret-backdoor-behind-conti-ransomware-operation-introducing-atera-agent"
            ],
            "status": "test",
            "tags": [
                "attack.t1219"
            ],
            "title": "Atera Agent Installation"
        },
        {
            "author": "Muhammad Faisal",
            "date": "2023/08/03",
            "description": "Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains|all": [
                        "-register ",
                        "-code ",
                        "-id ",
                        "-region "
                    ],
                    "Image|endswith": "/amazon-ssm-agent"
                }
            },
            "falsepositives": [
                "Legitimate activity of system administrators"
            ],
            "id": "f9b3edc5-3322-4fc7-8aa3-245d646cc4b7",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan",
                "https://www.bleepingcomputer.com/news/security/amazons-aws-ssm-agent-can-be-used-as-post-exploitation-rat-malware/",
                "https://www.helpnetsecurity.com/2023/08/02/aws-instances-attackers-access/"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.persistence",
                "attack.t1219"
            ],
            "title": "Potential Linux Amazon SSM Agent Hijacking"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "Windows",
        "macOS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Matt Kelly, @breakersall",
        "Zachary Stanford, @svch0st",
        "Dray Agha, @Purp1eW0lf, Huntress Labs"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "command-and-control"
        }
    ],
    "x_mitre_detection": "Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\n\n[Domain Fronting](https://attack.mitre.org/techniques/T1090/004) may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "2.3",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Process: Process Creation",
        "Network Traffic: Network Traffic Flow",
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Connection Creation"
    ],
    "x_mitre_permissions_required": []
}