{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--8a4f7316-8fee-43b1-b1bc-63cf91b131f0",
    "created": "2024-08-13T14:46:36.96194Z",
    "modified": "2024-08-13T14:46:45.131647Z",
    "name": "Proxy",
    "description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including HTRAN, ZXProxy, and ZXPortMap. [1] Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.Adversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1090",
            "external_id": "T1090"
        },
        {
            "source_name": "mitre-attack",
            "external_id": "T1090",
            "url": "https://attack.mitre.org/techniques/T1090"
        },
        {
            "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/",
            "description": "Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015.",
            "source_name": "Trend Micro APT Attack Tools"
        },
        {
            "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf",
            "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
            "source_name": "University of Birmingham C2"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Mark Morowczynski '@markmorow', Gloria Lee, '@gleeiamglo'",
            "date": "2023/09/03",
            "description": "Indicates sign-ins from IP addresses infected with malware that is known to actively communicate with a bot server.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "riskEventType": "malwareInfectedIPAddress"
                }
            },
            "falsepositives": [
                "Using an IP address that is shared by many users"
            ],
            "id": "821b4dc3-1295-41e7-b157-39ab212dd6bd",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "riskdetection"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#malware-linked-ip-address-deprecated",
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins"
            ],
            "status": "test",
            "tags": [
                "attack.t1090",
                "attack.command_and_control"
            ],
            "title": "Sign-In From Malware Infected IP"
        },
        {
            "author": "Mark Morowczynski '@markmorow', Gloria Lee, '@gleeiamglo'",
            "date": "2023/09/07",
            "description": "Indicates sign-in from a malicious IP address based on high failure rates.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "riskEventType": "maliciousIPAddress"
                }
            },
            "falsepositives": [
                "We recommend investigating the sessions flagged by this detection in the context of other sign-ins from the user."
            ],
            "id": "a3f55ebd-0c01-4ed6-adc0-8fb76d8cd3cd",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "riskdetection"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#malicious-ip-address",
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1090",
                "attack.command_and_control"
            ],
            "title": "Malicious IP Address Sign-In Failure Rate"
        },
        {
            "author": "Mark Morowczynski '@markmorow', Gloria Lee, '@gleeiamglo'",
            "date": "2023/09/07",
            "description": "Indicates sign-in from a malicious IP address known to be malicious at time of sign-in.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "riskEventType": "suspiciousIPAddress"
                }
            },
            "falsepositives": [
                "We recommend investigating the sessions flagged by this detection in the context of other sign-ins from the user."
            ],
            "id": "36440e1c-5c22-467a-889b-593e66498472",
            "level": "high",
            "logsource": {
                "product": "azure",
                "service": "riskdetection"
            },
            "references": [
                "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#malicious-ip-address",
                "https://learn.microsoft.com/en-us/entra/architecture/security-operations-user-accounts#unusual-sign-ins"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1090",
                "attack.command_and_control"
            ],
            "title": "Malicious IP Address Sign-In Suspicious"
        },
        {
            "author": "Security Onion Solutions",
            "date": "2024/03/08",
            "description": "Detects instances where an HTTPPROXY service on an OpenCanary node has had an attempt to proxy another page.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "logtype": 7001
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "5498fc09-adc6-4804-b9d9-5cca1f0b8760",
            "level": "high",
            "logsource": {
                "category": "application",
                "product": "opencanary"
            },
            "references": [
                "https://opencanary.readthedocs.io/en/latest/starting/configuration.html#services-configuration",
                "https://github.com/thinkst/opencanary/blob/a0896adfcaf0328cfd5829fe10d2878c7445138e/opencanary/logger.py#L52"
            ],
            "status": "experimental",
            "tags": [
                "attack.initial_access",
                "attack.defense_evasion",
                "attack.t1090"
            ],
            "title": "OpenCanary - HTTPPROXY Login Attempt"
        },
        {
            "author": "frack113",
            "date": "2022/02/20",
            "description": "Detects DNS queries to an \".onion\" address related to Tor routing networks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": ".onion"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b55ca2a3-7cff-4dda-8bdd-c7bfa63bf544",
            "level": "high",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "status": "experimental",
            "references": [
                "https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/"
            ],
            "related": [
                {
                    "id": "8384bd26-bde6-4da9-8e5d-4174a7a47ca2",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090.003"
            ],
            "title": "DNS Query Tor .Onion Address - Sysmon"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2024/05/31",
            "description": "Detects an executable accessing the portmap.io domain, which could be a sign of forbidden C2 traffic or data exfiltration by malicious actors",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": ".portmap.io",
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of portmap.io domains"
            ],
            "id": "07837ab9-60e1-481f-a74d-c31fb496a94c",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://portmap.io/",
                "https://github.com/rapid7/metasploit-framework/issues/11337",
                "https://pro.twitter.com/JaromirHorejsi/status/1795001037746761892/photo/2"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1041",
                "attack.command_and_control",
                "attack.t1090.002",
                "attack.exfiltration"
            ],
            "title": "Network Communication Initiated To Portmap.IO Domain"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/03",
            "description": "Detects an executable initiating a network connection to \"ngrok\" tunneling domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|contains": [
                        "tunnel.us.ngrok.com",
                        "tunnel.eu.ngrok.com",
                        "tunnel.ap.ngrok.com",
                        "tunnel.au.ngrok.com",
                        "tunnel.sa.ngrok.com",
                        "tunnel.jp.ngrok.com",
                        "tunnel.in.ngrok.com"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of the ngrok service."
            ],
            "id": "1d08ac94-400d-4469-a82f-daee9a908849",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2024/02/02",
            "status": "test",
            "references": [
                "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
                "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
            ],
            "related": [
                {
                    "id": "18249279-932f-45e2-b37a-8925f2597670",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567",
                "attack.t1568.002",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102",
                "attack.s0508"
            ],
            "title": "Communication To Ngrok Tunneling Service Initiated"
        },
        {
            "author": "Andreas Braathen (mnemonic.io)",
            "date": "2024/06/17",
            "description": "Detects an executable initiating a network connection to \"LocaltoNet\" tunneling sub-domains.\nLocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet.\nAttackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        ".localto.net",
                        ".localtonet.com"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of the LocaltoNet service."
            ],
            "id": "3ab65069-d82a-4d44-a759-466661a082d1",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "references": [
                "https://localtonet.com/documents/supported-tunnels",
                "https://cloud.google.com/blog/topics/threat-intelligence/unc3944-targets-saas-applications"
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102"
            ],
            "title": "Communication To LocaltoNet Tunneling Service Initiated"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf), Hunter Juhan (@threatHNTR)",
            "date": "2024/06/03",
            "description": "Detects potentially suspicious execution of the Qemu utility in a Windows environment.\nThreat actors have leveraged this utility and this technique for achieving network access as reported by Kaspersky.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_normal_usecase": {
                    "CommandLine|contains": [
                        " -cdrom ",
                        " type=virt ",
                        " -blockdev "
                    ]
                },
                "selection": {
                    "CommandLine|contains": [
                        "-m 1M",
                        "-m 2M",
                        "-m 3M"
                    ],
                    "CommandLine|contains|all": [
                        "restrict=off",
                        "-netdev ",
                        "connect=",
                        "-nographic"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5fc297ae-25b6-488a-8f25-cc12ac29b744",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://securelist.com/network-tunneling-with-qemu/111803/",
                "https://www.qemu.org/docs/master/system/invocation.html#hxtool-5"
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.t1090",
                "attack.t1572"
            ],
            "title": "Potentially Suspicious Usage Of Qemu"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/09/05",
            "description": "Detects usage of the Sharp Chisel via the commandline arguments",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\SharpChisel.exe"
                    },
                    {
                        "Product": "SharpChisel"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "cf93e05e-d798-4d9e-b522-b0248dc61eaf",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "status": "test",
            "references": [
                "https://github.com/shantanu561993/SharpChisel",
                "https://www.sentinelone.com/labs/wading-through-muddy-waters-recent-activity-of-an-iranian-state-sponsored-threat-actor/"
            ],
            "related": [
                {
                    "id": "8b0e12da-d3c3-49db-bb4f-256703f380e5",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090.001"
            ],
            "title": "HackTool - SharpChisel Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/12/20",
            "description": "Detects the execution of the \"cloudflared\" binary from a non standard location.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_admin_location": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\cloudflared\\",
                        ":\\Program Files\\cloudflared\\"
                    ]
                },
                "selection": {
                    "Image|endswith": "\\cloudflared.exe"
                }
            },
            "falsepositives": [
                "Legitimate usage of Cloudflared portable versions"
            ],
            "id": "fadb84f0-4e84-4f6d-a1ce-9ef2bffb6ccd",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/",
                "https://github.com/cloudflare/cloudflared",
                "https://www.intrinsec.com/akira_ransomware/",
                "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/",
                "https://github.com/cloudflare/cloudflared/releases"
            ],
            "status": "experimental",
            "title": "Cloudflared Portable Execution",
            "tags": [
                "attack.command_and_control",
                "attack.t1090.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/12/27",
            "description": "Detects executable names or flags used by Htran or Htran-like tools (e.g. NATBypass)",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        ".exe -tran ",
                        ".exe -slave "
                    ]
                },
                "selection_img": {
                    "Image|endswith": [
                        "\\htran.exe",
                        "\\lcx.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f5e3b62f-e577-4e59-931e-0a15b2b94e1e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "status": "test",
            "references": [
                "https://github.com/HiwinCN/HTran",
                "https://github.com/cw1997/NATBypass"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090",
                "attack.s0040"
            ],
            "title": "HackTool - Htran/NATBypass Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), omkar72, oscd.community, Swachchhanda Shrawan Poudel",
            "date": "2019/01/29",
            "description": "Detects the execution of netsh commands that configure a new port forwarding (PortProxy) rule",
            "detection": {
                "condition": "selection_img and 1 of selection_cli_*",
                "selection_cli_1": {
                    "CommandLine|contains|all": [
                        "interface",
                        "portproxy",
                        "add",
                        "v4tov4"
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains|all": [
                        "i ",
                        "p ",
                        "a ",
                        "v "
                    ]
                },
                "selection_cli_3": {
                    "CommandLine|contains|all": [
                        "connectp",
                        "listena",
                        "c="
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administration activity",
                "WSL2 network bridge PowerShell script used for WSL/Kubernetes/Docker (e.g. https://github.com/microsoft/WSL/issues/4150#issuecomment-504209723)"
            ],
            "id": "322ed9ec-fcab-4f67-9a34-e7c6aef43614",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/09/01",
            "status": "test",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html",
                "https://adepts.of0x.cc/netsh-portproxy-code/",
                "https://www.dfirnotes.net/portproxy_detection/"
            ],
            "tags": [
                "attack.lateral_movement",
                "attack.defense_evasion",
                "attack.command_and_control",
                "attack.t1090"
            ],
            "title": "New Port Forwarding Rule Added Via Netsh.EXE"
        },
        {
            "id": "8b0e12da-d3c3-49db-bb4f-256703f380e5",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/13",
            "description": "Detects usage of the Chisel tunneling tool via the commandline arguments",
            "detection": {
                "condition": "selection_img or all of selection_param*",
                "selection_img": {
                    "Image|endswith": "\\chisel.exe"
                },
                "selection_param1": {
                    "CommandLine|contains": [
                        "exe client ",
                        "exe server "
                    ]
                },
                "selection_param2": {
                    "CommandLine|contains": [
                        "-socks5",
                        "-reverse",
                        " r:",
                        ":127.0.0.1:",
                        "-tls-skip-verify ",
                        ":socks"
                    ]
                }
            },
            "falsepositives": [
                "Some false positives may occur with other tools with similar commandlines"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "status": "test",
            "references": [
                "https://github.com/jpillora/chisel/",
                "https://arcticwolf.com/resources/blog/lorenz-ransomware-chiseling-in/",
                "https://blog.sekoia.io/lucky-mouse-incident-response-to-detection-engineering/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "cf93e05e-d798-4d9e-b522-b0248dc61eaf"
                }
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090.001"
            ],
            "title": "PUA - Chisel Tunneling Tool Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), oscd.community",
            "date": "2019/01/29",
            "description": "Detects the execution of netsh to configure a port forwarding of port 3389 (RDP) rule",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " i",
                        " p",
                        "=3389",
                        " c"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\netsh.exe"
                    },
                    {
                        "OriginalFileName": "netsh.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate administration activity"
            ],
            "id": "782d6f3e-4c5d-4b8c-92a3-1d05fed72e63",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "status": "test",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html"
            ],
            "tags": [
                "attack.lateral_movement",
                "attack.defense_evasion",
                "attack.command_and_control",
                "attack.t1090"
            ],
            "title": "RDP Port Forwarding Rule Added Via Netsh.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/17",
            "description": "Detects execution of the \"cloudflared\" tool with the tunnel \"cleanup\" flag in order to cleanup tunnel connections.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "-config ",
                        "-connector-id "
                    ],
                    "CommandLine|contains|all": [
                        " tunnel ",
                        "cleanup "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate usage of Cloudflared."
            ],
            "id": "7050bba1-1aed-454e-8f73-3f46f09ce56a",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/21",
            "status": "experimental",
            "references": [
                "https://github.com/cloudflare/cloudflared",
                "https://developers.cloudflare.com/cloudflare-one/connections/connect-apps"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1102",
                "attack.t1090",
                "attack.t1572"
            ],
            "title": "Cloudflared Tunnel Connections Cleanup"
        },
        {
            "author": "Sajid Nawaz Khan",
            "date": "2023/12/20",
            "description": "Detects creation of an ad-hoc Cloudflare Quick Tunnel, which can be used to tunnel local services such as HTTP, RDP, SSH and SMB.\nThe free TryCloudflare Quick Tunnel will generate a random subdomain on trycloudflare[.]com, following a call to api[.]trycloudflare[.]com.\nThe tool has been observed in use by threat groups including Akira ransomware.\n",
            "detection": {
                "condition": "(selection_img and selection_param) or selection_other",
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\cloudflared.exe",
                            "\\cloudflared-windows-386.exe",
                            "\\cloudflared-windows-amd64.exe"
                        ]
                    },
                    {
                        "Hashes|contains": [
                            "SHA256=2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29",
                            "SHA256=b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8",
                            "SHA256=1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039",
                            "SHA256=0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28",
                            "SHA256=7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7",
                            "SHA256=5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373",
                            "SHA256=ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670",
                            "SHA256=1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a",
                            "SHA256=af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0",
                            "SHA256=39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1",
                            "SHA256=ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2",
                            "SHA256=b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac",
                            "SHA256=f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f",
                            "SHA256=fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d",
                            "SHA256=083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499",
                            "SHA256=44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b",
                            "SHA256=5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f",
                            "SHA256=e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032",
                            "SHA256=c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234",
                            "SHA256=b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f",
                            "SHA256=cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058",
                            "SHA256=9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c",
                            "SHA256=c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f",
                            "SHA256=53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5",
                            "SHA256=648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3",
                            "SHA256=ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4",
                            "SHA256=3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c",
                            "SHA256=f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4",
                            "SHA256=d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f",
                            "SHA256=bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad",
                            "SHA256=b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7",
                            "SHA256=f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75",
                            "SHA256=b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6",
                            "SHA256=f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688",
                            "SHA256=d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f",
                            "SHA256=d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663",
                            "SHA256=2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77",
                            "SHA256=19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078"
                        ]
                    }
                ],
                "selection_other": {
                    "CommandLine|contains|all": [
                        "-url",
                        "-no-autoupdate"
                    ]
                },
                "selection_param": [
                    {
                        "CommandLine|contains|all": [
                            "-url",
                            "tunnel"
                        ]
                    },
                    {
                        "CommandLine|contains": [
                            ".exe -url",
                            ".exe --url"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate usage of Cloudflare Quick Tunnel"
            ],
            "id": "222129f7-f4dc-4568-b0d2-22440a9639ba",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/",
                "https://github.com/cloudflare/cloudflared",
                "https://www.intrinsec.com/akira_ransomware/",
                "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "7050bba1-1aed-454e-8f73-3f46f09ce56a"
                },
                {
                    "id": "9a019ffc-3580-4c9d-8d87-079f7e8d3fd4",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "title": "Cloudflared Quick Tunnel Execution",
            "tags": [
                "attack.command_and_control",
                "attack.t1090.001"
            ]
        },
        {
            "id": "9a019ffc-3580-4c9d-8d87-079f7e8d3fd4",
            "author": "Janantha Marasinghe, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/17",
            "description": "Detects execution of the \"cloudflared\" tool to connect back to a tunnel. This was seen used by threat actors to maintain persistence and remote access to compromised networks.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "-config ",
                        "-credentials-contents ",
                        "-credentials-file ",
                        "-token "
                    ],
                    "CommandLine|contains|all": [
                        " tunnel ",
                        " run "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate usage of Cloudflared tunnel."
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/20",
            "status": "experimental",
            "references": [
                "https://blog.reconinfosec.com/emergence-of-akira-ransomware-group",
                "https://github.com/cloudflare/cloudflared",
                "https://developers.cloudflare.com/cloudflare-one/connections/connect-apps"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1102",
                "attack.t1090",
                "attack.t1572"
            ],
            "title": "Cloudflared Tunnel Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/10/08",
            "description": "Detects the use of IOX - a tool for port forwarding and intranet proxy purposes",
            "detection": {
                "condition": "1 of selection*",
                "selection": {
                    "Image|endswith": "\\iox.exe"
                },
                "selection_commandline": {
                    "CommandLine|contains": [
                        ".exe fwd -l ",
                        ".exe fwd -r ",
                        ".exe proxy -l ",
                        ".exe proxy -r "
                    ]
                },
                "selection_hashes": [
                    {
                        "Hashes|contains": [
                            "MD5=9DB2D314DD3F704A02051EF5EA210993",
                            "SHA1=039130337E28A6623ECF9A0A3DA7D92C5964D8DD",
                            "SHA256=C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731"
                        ]
                    },
                    {
                        "md5": "9db2d314dd3f704a02051ef5ea210993"
                    },
                    {
                        "sha1": "039130337e28a6623ecf9a0a3da7d92c5964d8dd"
                    },
                    {
                        "sha256": "c6cf82919b809967d9d90ea73772a8aa1c1eb3bc59252d977500f64f1a0d6731"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "d7654f02-e04b-4934-9838-65c46f187ebc",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "status": "test",
            "references": [
                "https://github.com/EddieIvan01/iox"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090"
            ],
            "title": "PUA- IOX Tunneling Tool Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/12/20",
            "description": "Detects the execution of a renamed \"cloudflared\" binary.",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_*",
                "filter_main_known_names": {
                    "Image|endswith": [
                        "\\cloudflared.exe",
                        "\\cloudflared-windows-386.exe",
                        "\\cloudflared-windows-amd64.exe"
                    ]
                },
                "selection_accountless": {
                    "CommandLine|contains|all": [
                        "-url",
                        "tunnel"
                    ]
                },
                "selection_cleanup": {
                    "CommandLine|contains": [
                        "-config ",
                        "-connector-id "
                    ],
                    "CommandLine|contains|all": [
                        " tunnel ",
                        "cleanup "
                    ]
                },
                "selection_hashes": {
                    "Hashes|contains": [
                        "SHA256=2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29",
                        "SHA256=b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8",
                        "SHA256=1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039",
                        "SHA256=0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28",
                        "SHA256=7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7",
                        "SHA256=5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373",
                        "SHA256=ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670",
                        "SHA256=1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a",
                        "SHA256=af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0",
                        "SHA256=39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1",
                        "SHA256=ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2",
                        "SHA256=b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac",
                        "SHA256=f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f",
                        "SHA256=fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d",
                        "SHA256=083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499",
                        "SHA256=44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b",
                        "SHA256=5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f",
                        "SHA256=e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032",
                        "SHA256=c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234",
                        "SHA256=b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f",
                        "SHA256=cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058",
                        "SHA256=9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c",
                        "SHA256=c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f",
                        "SHA256=53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5",
                        "SHA256=648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3",
                        "SHA256=ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4",
                        "SHA256=3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c",
                        "SHA256=f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4",
                        "SHA256=d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f",
                        "SHA256=bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad",
                        "SHA256=b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7",
                        "SHA256=f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75",
                        "SHA256=b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6",
                        "SHA256=f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688",
                        "SHA256=d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f",
                        "SHA256=d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663",
                        "SHA256=2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77",
                        "SHA256=19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078"
                    ]
                },
                "selection_tunnel": {
                    "CommandLine|contains": [
                        "-config ",
                        "-credentials-contents ",
                        "-credentials-file ",
                        "-token "
                    ],
                    "CommandLine|contains|all": [
                        " tunnel ",
                        " run "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e0c69ebd-b54f-4aed-8ae3-e3467843f3f0",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://github.com/cloudflare/cloudflared/releases",
                "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/",
                "https://github.com/cloudflare/cloudflared",
                "https://www.intrinsec.com/akira_ransomware/",
                "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/"
            ],
            "status": "experimental",
            "title": "Renamed Cloudflared.EXE Execution",
            "tags": [
                "attack.command_and_control",
                "attack.t1090.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/10/08",
            "description": "Detects the use of NPS, a port forwarding and intranet penetration proxy server",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli_1": {
                    "CommandLine|contains|all": [
                        " -server=",
                        " -vkey=",
                        " -password="
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains": " -config=npc"
                },
                "selection_hashes": [
                    {
                        "Hashes|contains": [
                            "MD5=AE8ACF66BFE3A44148964048B826D005",
                            "SHA1=CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181",
                            "SHA256=5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856"
                        ]
                    },
                    {
                        "md5": "ae8acf66bfe3a44148964048b826d005"
                    },
                    {
                        "sha1": "cea49e9b9b67f3a13ad0be1c2655293ea3c18181"
                    },
                    {
                        "sha256": "5a456283392ffceeeaca3d3426c306eb470304637520d72fed1cc1febbbd6856"
                    }
                ],
                "selection_img": {
                    "Image|endswith": "\\npc.exe"
                }
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "68d37776-61db-42f5-bf54-27e87072d17e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "status": "test",
            "references": [
                "https://github.com/ehang-io/nps"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090"
            ],
            "title": "PUA - NPS Tunneling Tool Execution"
        },
        {
            "author": "frack113",
            "date": "2022/02/20",
            "description": "Detects the use of Tor or Tor-Browser to connect to onion routing networks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\tor.exe",
                        "\\Tor Browser\\Browser\\firefox.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "62f7c9bf-9135-49b2-8aeb-1e54a6ecc13c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/13",
            "status": "test",
            "references": [
                "https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/"
            ],
            "title": "Tor Client/Browser Execution",
            "tags": [
                "attack.command_and_control",
                "attack.t1090.003"
            ]
        },
        {
            "author": "frack113, Florian Roth",
            "date": "2022/09/02",
            "description": "Detects the use of Fast Reverse Proxy. frp is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "\\frpc.ini"
                },
                "selection_hashes": [
                    {
                        "Hashes|contains": [
                            "MD5=7D9C233B8C9E3F0EA290D2B84593C842",
                            "SHA1=06DDC9280E1F1810677935A2477012960905942F",
                            "SHA256=57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C"
                        ]
                    },
                    {
                        "md5": "7d9c233b8c9e3f0ea290d2b84593c842"
                    },
                    {
                        "sha1": "06ddc9280e1f1810677935a2477012960905942f"
                    },
                    {
                        "sha256": "57b0936b8d336d8e981c169466a15a5fd21a7d5a2c7daf62d5e142ee860e387c"
                    }
                ],
                "selection_img": {
                    "Image|endswith": [
                        "\\frpc.exe",
                        "\\frps.exe"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use"
            ],
            "id": "32410e29-5f94-4568-b6a3-d91a8adad863",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/04",
            "status": "test",
            "references": [
                "https://asec.ahnlab.com/en/38156/",
                "https://github.com/fatedier/frp"
            ],
            "tags": [
                "attack.command_and_control",
                "attack.t1090"
            ],
            "title": "PUA - Fast Reverse Proxy (FRP) Execution"
        },
        {
            "id": "8384bd26-bde6-4da9-8e5d-4174a7a47ca2",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/02/20",
            "description": "Detects DNS resolution of an .onion address related to Tor routing networks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": ".onion"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "related": [
                {
                    "type": "similar",
                    "id": "b55ca2a3-7cff-4dda-8bdd-c7bfa63bf544"
                }
            ],
            "status": "test",
            "references": [
                "https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/"
            ],
            "title": "Query Tor Onion Address - DNS Client",
            "tags": [
                "attack.command_and_control",
                "attack.t1090.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/04/29",
            "description": "Detects cases in which ngrok, a reverse proxy tool, forwards events to the local RDP port, which could be a sign of malicious behaviour",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Address|contains": "16777216",
                    "EventID": 21
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "64d51a51-32a6-49f0-9f3d-17e34d640272",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "terminalservices-localsessionmanager"
            },
            "references": [
                "https://twitter.com/tekdefense/status/1519711183162556416?s=12&t=OTsHCBkQOTNs1k3USz65Zg",
                "https://ngrok.com/"
            ],
            "status": "test",
            "title": "Ngrok Usage with Remote Desktop Service",
            "tags": [
                "attack.command_and_control",
                "attack.t1090"
            ]
        },
        {
            "author": "Samir Bousseaden",
            "date": "2019/02/16",
            "description": "Detects svchost hosting RDP termsvcs communicating with the loopback address",
            "detection": {
                "condition": "selection and ( sourceRDP or destinationRDP ) and not 1 of filter*",
                "destinationRDP": {
                    "DestPort": 3389,
                    "SourceAddress": [
                        "127.*",
                        "::1"
                    ]
                },
                "filter_app_container": {
                    "FilterOrigin": "AppContainer Loopback"
                },
                "filter_thor": {
                    "Application|endswith": [
                        "\\thor.exe",
                        "\\thor64.exe"
                    ]
                },
                "selection": {
                    "EventID": 5156
                },
                "sourceRDP": {
                    "DestAddress": [
                        "127.*",
                        "::1"
                    ],
                    "SourcePort": 3389
                }
            },
            "falsepositives": [
                "Programs that connect locally to the RDP port"
            ],
            "id": "5bed80b6-b3e8-428e-a3ae-d3c757589e41",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/09/02",
            "status": "test",
            "references": [
                "https://twitter.com/SBousseaden/status/1096148422984384514",
                "https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/44fbe85f72ee91582876b49678f9a26292a155fb/Command%20and%20Control/DE_RDP_Tunnel_5156.evtx"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.command_and_control",
                "attack.lateral_movement",
                "attack.t1090.001",
                "attack.t1090.002",
                "attack.t1021.001",
                "car.2013-07-002"
            ],
            "title": "RDP over Reverse SSH Tunnel WFP"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/07/08",
            "description": "Detects powershell scripts that creates sockets/listeners which could be indicative of tunneling activity",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "[System.Net.HttpWebRequest]",
                        "System.Net.Sockets.TcpListener",
                        "AcceptTcpClient"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bd33d2aa-497e-4651-9893-5c5364646595",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/Arno0x/PowerShellScripts/blob/a6b7d5490fbf0b20f91195838f3a11156724b4f7/proxyTunnel.ps1"
            ],
            "status": "test",
            "title": "Suspicious TCP Tunnel Via PowerShell Script",
            "tags": [
                "attack.command_and_control",
                "attack.t1090"
            ]
        },
        {
            "author": "Andreas Hunkeler (@Karneades)",
            "date": "2021/06/22",
            "description": "Detects the modification of the PortProxy registry key which is used for port forwarding.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetObject|contains": "\\Services\\PortProxy\\v4tov4\\tcp\\"
                }
            },
            "falsepositives": [
                "WSL2 network bridge PowerShell script used for WSL/Kubernetes/Docker (e.g. https://github.com/microsoft/WSL/issues/4150#issuecomment-504209723)",
                "Synergy Software KVM (https://symless.com/synergy)"
            ],
            "id": "a54f842a-3713-4b45-8c84-5f136fdebd3c",
            "level": "medium",
            "logsource": {
                "category": "registry_event",
                "product": "windows"
            },
            "modified": "2024/03/25",
            "status": "test",
            "references": [
                "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html",
                "https://adepts.of0x.cc/netsh-portproxy-code/",
                "https://www.dfirnotes.net/portproxy_detection/"
            ],
            "tags": [
                "attack.lateral_movement",
                "attack.defense_evasion",
                "attack.command_and_control",
                "attack.t1090"
            ],
            "title": "New PortProxy Registry Entry Added"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/11/03",
            "description": "Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|contains": [
                        "tunnel.us.ngrok.com",
                        "tunnel.eu.ngrok.com",
                        "tunnel.ap.ngrok.com",
                        "tunnel.au.ngrok.com",
                        "tunnel.sa.ngrok.com",
                        "tunnel.jp.ngrok.com",
                        "tunnel.in.ngrok.com"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of ngrok"
            ],
            "id": "19bf6fdb-7721-4f3d-867f-53467f6a5db6",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "linux"
            },
            "status": "test",
            "references": [
                "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
                "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
            ],
            "title": "Communication To Ngrok Tunneling Service - Linux",
            "tags": [
                "attack.exfiltration",
                "attack.command_and_control",
                "attack.t1567",
                "attack.t1568.002",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102",
                "attack.s0508"
            ]
        },
        {
            "author": "Andreas Braathen (mnemonic.io)",
            "date": "2024/06/17",
            "description": "Detects an executable initiating a network connection to \"LocaltoNet\" tunneling sub-domains.\nLocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet.\nAttackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "DestinationHostname|endswith": [
                        ".localto.net",
                        ".localtonet.com"
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Legitimate use of the LocaltoNet service."
            ],
            "id": "c4568f5d-131f-4e78-83d4-45b2da0ec4f1",
            "level": "high",
            "logsource": {
                "category": "network_connection",
                "product": "linux"
            },
            "references": [
                "https://localtonet.com/documents/supported-tunnels",
                "https://cloud.google.com/blog/topics/threat-intelligence/unc3944-targets-saas-applications"
            ],
            "status": "experimental",
            "tags": [
                "attack.command_and_control",
                "attack.t1572",
                "attack.t1090",
                "attack.t1102"
            ],
            "title": "Communication To LocaltoNet Tunneling Service Initiated - Linux"
        },
        {
            "author": "\u00d6mer G\u00fcnal",
            "date": "2020/06/17",
            "description": "Detects setting proxy configuration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "http_proxy=",
                        "https_proxy="
                    ]
                }
            },
            "falsepositives": [
                "Legitimate administration activities"
            ],
            "id": "72f4ab3f-787d-495d-a55d-68c2ff46cf4c",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "modified": "2022/10/05",
            "status": "test",
            "references": [
                "https://attack.mitre.org/techniques/T1090/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1090"
            ],
            "title": "Connection Proxy"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Jon Sheedy",
        "Heather Linn",
        "Walker Johnson"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "command-and-control"
        }
    ],
    "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nConsider monitoring for traffic to known anonymity networks (such as [Tor](https://attack.mitre.org/software/S0183)).",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "3.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Network Traffic: Network Traffic Flow",
        "Network Traffic: Network Traffic Content",
        "Network Traffic: Network Connection Creation"
    ],
    "x_mitre_permissions_required": []
}