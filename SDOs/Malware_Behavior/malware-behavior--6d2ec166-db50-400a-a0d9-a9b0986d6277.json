{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6d2ec166-db50-400a-a0d9-a9b0986d6277",
    "created": "2024-08-13T14:46:36.906474Z",
    "modified": "2024-08-13T14:46:44.906653Z",
    "name": "Data Encrypted for Impact",
    "description": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.[1][2][3][4]In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted (and often renamed and/or tagged with specific file markers). Adversaries may need to first employ other behaviors, such as File and Directory Permissions Modification or System Shutdown/Reboot, in order to unlock and/or gain access to manipulate these files.[5] In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.[3] To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like Valid Accounts, OS Credential Dumping, and SMB/Windows Admin Shares.[2][3] Encryption malware may also leverage Internal Defacement, such as changing victim wallpapers, or otherwise intimidate victims by sending ransom notes or other messages to connected printers (known as 'print bombing').[6]In cloud environments, storage objects within compromised accounts may also be encrypted.[7]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1486",
            "external_id": "T1486"
        },
        {
            "source_name": "mitre-attack",
            "external_id": "T1486",
            "url": "https://attack.mitre.org/techniques/T1486"
        },
        {
            "source_name": "CarbonBlack Conti July 2020",
            "url": "https://www.carbonblack.com/blog/tau-threat-discovery-conti-ransomware/",
            "description": "Baskin, B. (2020, July 8). TAU Threat Discovery: Conti Ransomware. Retrieved February 17, 2021."
        },
        {
            "source_name": "FireEye WannaCry 2017",
            "url": "https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html",
            "description": "Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry Malware Profile. Retrieved March 15, 2019."
        },
        {
            "source_name": "Rhino S3 Ransomware Part 1",
            "url": "https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/",
            "description": "Gietzen, S. (n.d.). S3 Ransomware Part 1: Attack Vector. Retrieved April 14, 2021."
        },
        {
            "source_name": "NHS Digital Egregor Nov 2020",
            "url": "https://digital.nhs.uk/cyber-alerts/2020/cc-3681#summary",
            "description": "NHS Digital. (2020, November 26). Egregor Ransomware The RaaS successor to Maze. Retrieved December 29, 2020."
        },
        {
            "source_name": "US-CERT Ransomware 2016",
            "url": "https://www.us-cert.gov/ncas/alerts/TA16-091A",
            "description": "US-CERT. (2016, March 31). Alert (TA16-091A): Ransomware and Recent Variants. Retrieved March 15, 2019."
        },
        {
            "source_name": "US-CERT NotPetya 2017",
            "url": "https://www.us-cert.gov/ncas/alerts/TA17-181A",
            "description": "US-CERT. (2017, July 1). Alert (TA17-181A): Petya Ransomware. Retrieved March 15, 2019."
        },
        {
            "source_name": "US-CERT SamSam 2018",
            "url": "https://www.us-cert.gov/ncas/alerts/AA18-337A",
            "description": "US-CERT. (2018, December 3). Alert (AA18-337A): SamSam Ransomware. Retrieved March 15, 2019."
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems), Arnim Rupp",
            "date": "2022/05/12",
            "description": "Detects a highly relevant Antivirus alert that reports ransomware.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Signature|contains": [
                        "BlackWorm",
                        "Crypter",
                        "CRYPTES",
                        "Cryptor",
                        "Destructor",
                        "Filecoder",
                        "GandCrab",
                        "GrandCrab",
                        "Krypt",
                        "Locker",
                        "Phobos",
                        "Ransom",
                        "Ryuk",
                        "Ryzerlo",
                        "Tescrypt",
                        "TeslaCrypt"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "4c6ca276-d4d0-4a8c-9e4c-d69832f8671f",
            "level": "critical",
            "logsource": {
                "category": "antivirus"
            },
            "modified": "2023/02/03",
            "references": [
                "https://www.nextron-systems.com/?s=antivirus",
                "https://www.virustotal.com/gui/file/43b0f7872900bd234975a0877744554f4f355dc57505517abd1ef611e1ce6916",
                "https://www.virustotal.com/gui/file/c312c05ddbd227cbb08958876df2b69d0f7c1b09e5689eb9d93c5b357f63eff7",
                "https://www.virustotal.com/gui/file/20179093c59bca3acc6ce9a4281e8462f577ffd29fd7bf51cf2a70d106062045",
                "https://www.virustotal.com/gui/file/554db97ea82f17eba516e6a6fdb9dc04b1d25580a1eb8cb755eeb260ad0bd61d",
                "https://www.virustotal.com/gui/file/69fe77dd558e281621418980040e2af89a2547d377d0f2875502005ce22bc95c"
            ],
            "status": "test",
            "tags": [
                "attack.t1486"
            ],
            "title": "Antivirus Ransomware Detection"
        },
        {
            "author": "austinsonger",
            "date": "2021/08/19",
            "description": "Detects when a Microsoft Cloud App Security reported when a user uploads files to the cloud that might be infected with ransomware.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "Potential ransomware activity",
                    "eventSource": "SecurityComplianceCenter",
                    "status": "success"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "bd132164-884a-48f1-aa2d-c6d646b04c69",
            "level": "medium",
            "logsource": {
                "product": "m365",
                "service": "threat_management"
            },
            "modified": "2022/10/09",
            "references": [
                "https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy",
                "https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1486"
            ],
            "title": "Microsoft 365 - Potential Ransomware Activity"
        },
        {
            "author": "Sittikorn S",
            "date": "2021/06/29",
            "description": "Identifies disabling of default Amazon Elastic Block Store (EBS) encryption in the current region.\nDisabling default encryption does not change the encryption status of your existing volumes.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "DisableEbsEncryptionByDefault",
                    "eventSource": "ec2.amazonaws.com"
                }
            },
            "falsepositives": [
                "System Administrator Activities",
                "DEV, UAT, SAT environment. You should apply this rule with PROD account only."
            ],
            "id": "16124c2d-e40b-4fcc-8f2c-5ab7870a2223",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2021/08/20",
            "references": [
                "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html"
            ],
            "status": "stable",
            "tags": [
                "attack.impact",
                "attack.t1486",
                "attack.t1565"
            ],
            "title": "AWS EC2 Disable EBS Encryption"
        },
        {
            "author": "Luc G\u00e9naux",
            "date": "2023/11/28",
            "description": "Detects the load of RstrtMgr DLL (Restart Manager) by a suspicious process.\nThis library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\nIt could also be used for anti-analysis purposes by shut downing specific processes.\n",
            "detection": {
                "condition": "selection_img and 1 of selection_folders_*",
                "selection_folders_1": {
                    "Image|contains": [
                        ":\\Perflogs\\",
                        ":\\Users\\Public\\",
                        "\\Temporary Internet"
                    ]
                },
                "selection_folders_2": [
                    {
                        "Image|contains|all": [
                            ":\\Users\\",
                            "\\Favorites\\"
                        ]
                    },
                    {
                        "Image|contains|all": [
                            ":\\Users\\",
                            "\\Favourites\\"
                        ]
                    },
                    {
                        "Image|contains|all": [
                            ":\\Users\\",
                            "\\Contacts\\"
                        ]
                    }
                ],
                "selection_img": [
                    {
                        "ImageLoaded|endswith": "\\RstrtMgr.dll"
                    },
                    {
                        "OriginalFileName": "RstrtMgr.dll"
                    }
                ]
            },
            "falsepositives": [
                "Processes related to software installation"
            ],
            "id": "b48492dc-c5ef-4572-8dff-32bc241c15c8",
            "level": "high",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "references": [
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-1/",
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-2/",
                "https://www.swascan.com/cactus-ransomware-malware-analysis/",
                "https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html"
            ],
            "related": [
                {
                    "id": "3669afd2-9891-4534-a626-e5cf03810a61",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1486",
                "attack.t1562.001"
            ],
            "title": "Load Of RstrtMgr.DLL By A Suspicious Process"
        },
        {
            "id": "3669afd2-9891-4534-a626-e5cf03810a61",
            "author": "Luc G\u00e9naux",
            "date": "2023/11/28",
            "description": "Detects the load of RstrtMgr DLL (Restart Manager) by an uncommon process.\nThis library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\nIt could also be used for anti-analysis purposes by shut downing specific processes.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_admin_software_installations": {
                    "Image|contains": ":\\Windows\\Temp\\"
                },
                "filter_main_generic": {
                    "Image|contains": [
                        ":\\$WINDOWS.~BT\\",
                        ":\\$WinREAgent\\",
                        ":\\Program Files (x86)\\",
                        ":\\Program Files\\",
                        ":\\ProgramData\\",
                        ":\\Windows\\explorer.exe",
                        ":\\Windows\\SoftwareDistribution\\",
                        ":\\Windows\\SysNative\\",
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\",
                        ":\\Windows\\WinSxS\\",
                        ":\\WUDownloadCache\\"
                    ]
                },
                "filter_main_user_software_installations": {
                    "Image|contains|all": [
                        ":\\Users\\",
                        "\\AppData\\Local\\Temp\\is-",
                        ".tmp\\"
                    ],
                    "Image|endswith": ".tmp"
                },
                "selection": [
                    {
                        "ImageLoaded|endswith": "\\RstrtMgr.dll"
                    },
                    {
                        "OriginalFileName": "RstrtMgr.dll"
                    }
                ]
            },
            "falsepositives": [
                "Other legitimate Windows processes not currently listed",
                "Processes related to software installation"
            ],
            "level": "low",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "references": [
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-1/",
                "https://www.crowdstrike.com/blog/windows-restart-manager-part-2/",
                "https://www.swascan.com/cactus-ransomware-malware-analysis/",
                "https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "b48492dc-c5ef-4572-8dff-32bc241c15c8"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1486",
                "attack.t1562.001"
            ],
            "title": "Load Of RstrtMgr.DLL By An Uncommon Process"
        },
        {
            "author": "frack113",
            "date": "2022/07/16",
            "description": "Detects file renames where the target filename uses an uncommon double extension. Could indicate potential ransomware activity renaming files and adding a custom extension to the encrypted files, such as \".jpg.crypted\", \".docx.locky\", etc.",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "TargetFilename|endswith": [
                        ".backup",
                        ".bak",
                        ".old",
                        ".orig",
                        ".temp",
                        ".tmp"
                    ]
                },
                "filter_optional_anaconda": {
                    "TargetFilename|contains": ":\\ProgramData\\Anaconda3\\",
                    "TargetFilename|endswith": ".c~"
                },
                "selection": {
                    "SourceFilename|endswith": [
                        ".doc",
                        ".docx",
                        ".jpeg",
                        ".jpg",
                        ".lnk",
                        ".pdf",
                        ".png",
                        ".pst",
                        ".rtf",
                        ".xls",
                        ".xlsx"
                    ],
                    "TargetFilename|contains": [
                        ".doc.",
                        ".docx.",
                        ".jpeg.",
                        ".jpg.",
                        ".lnk.",
                        ".pdf.",
                        ".png.",
                        ".pst.",
                        ".rtf.",
                        ".xls.",
                        ".xlsx."
                    ]
                }
            },
            "falsepositives": [
                "Backup software"
            ],
            "id": "e3f673b3-65d1-4d80-9146-466f8b63fa99",
            "level": "medium",
            "logsource": {
                "category": "file_rename",
                "product": "windows",
                "definition": "Requirements: Microsoft-Windows-Kernel-File Provider with at least the KERNEL_FILE_KEYWORD_RENAME_SETLINK_PATH keyword"
            },
            "modified": "2023/11/11",
            "references": [
                "https://app.any.run/tasks/d66ead5a-faf4-4437-93aa-65785afaf9e5/",
                "https://blog.cyble.com/2022/08/10/onyx-ransomware-renames-its-leak-site-to-vsop/"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1486"
            ],
            "title": "Suspicious Appended Extension"
        },
        {
            "author": "frack113",
            "date": "2021/12/26",
            "description": "Ransomware create txt file in the user Desktop",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\cmd.exe",
                    "TargetFilename|contains|all": [
                        "\\Users\\",
                        "\\Desktop\\"
                    ],
                    "TargetFilename|endswith": ".txt"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "caf02a0a-1e1c-4552-9b48-5e070bd88d11",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1486/T1486.md#atomic-test-5---purelocker-ransom-note"
            ],
            "status": "test",
            "title": "Suspicious Creation TXT File in User Desktop",
            "tags": [
                "attack.impact",
                "attack.t1486"
            ]
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/06",
            "description": "Detects the execution of \"gpg.exe\" from uncommon location. Often used by ransomware and loaders to decrypt/encrypt data.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_legit_location": {
                    "Image|contains": [
                        ":\\Program Files (x86)\\GNU\\GnuPG\\bin\\",
                        ":\\Program Files (x86)\\GnuPG VS-Desktop\\",
                        ":\\Program Files (x86)\\GnuPG\\bin\\",
                        ":\\Program Files (x86)\\Gpg4win\\bin\\"
                    ]
                },
                "selection": [
                    {
                        "Image|endswith": [
                            "\\gpg.exe",
                            "\\gpg2.exe"
                        ]
                    },
                    {
                        "OriginalFileName": "gpg.exe"
                    },
                    {
                        "Description": "GnuPG\u2019s OpenPGP tool"
                    }
                ]
            },
            "id": "77df53a5-1d78-4f32-bc5a-0e7465bd8f41",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/11/10",
            "references": [
                "https://www.trendmicro.com/vinfo/vn/threat-encyclopedia/malware/ransom.bat.zarlock.a",
                "https://securelist.com/locked-out/68960/",
                "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1486/T1486.md"
            ],
            "status": "experimental",
            "title": "Portable Gpg.EXE Execution",
            "tags": [
                "attack.impact",
                "attack.t1486"
            ]
        },
        {
            "author": "frack113",
            "date": "2021/11/15",
            "description": "Detects suspicious addition to BitLocker related registry keys via the reg.exe utility",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": [
                        "EnableBDEWithNoTPM",
                        "UseAdvancedStartup",
                        "UseTPM",
                        "UseTPMKey",
                        "UseTPMKeyPIN",
                        "RecoveryKeyMessageSource",
                        "UseTPMPIN",
                        "RecoveryKeyMessage"
                    ],
                    "CommandLine|contains|all": [
                        "REG",
                        "ADD",
                        "\\SOFTWARE\\Policies\\Microsoft\\FVE",
                        "/v",
                        "/f"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "0e0255bf-2548-47b8-9582-c0955c9283f5",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "modified": "2022/09/09",
            "references": [
                "https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1486"
            ],
            "title": "Suspicious Reg Add BitLocker"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2023/08/09",
            "description": "Detects the execution of a renamed \"gpg.exe\". Often used by ransomware and loaders to decrypt/encrypt data.",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_img": {
                    "Image|endswith": [
                        "\\gpg.exe",
                        "\\gpg2.exe"
                    ]
                },
                "selection": {
                    "OriginalFileName": "gpg.exe"
                }
            },
            "id": "ec0722a3-eb5c-4a56-8ab2-bf6f20708592",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "level": "high",
            "references": [
                "https://securelist.com/locked-out/68960/"
            ],
            "title": "Renamed Gpg.EXE Execution",
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1486"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "IaaS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Oleg Kolesnikov, Securonix",
        "Mayuresh Dani, Qualys",
        "Harshal Tupsamudre, Qualys",
        "Travis Smith, Qualys",
        "ExtraHop"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "impact"
        }
    ],
    "x_mitre_detection": "Use process monitoring to monitor the execution and command line parameters of binaries involved in data destruction activity, such as vssadmin, wbadmin, and bcdedit. Monitor for the creation of suspicious files as well as unusual file modification activity. In particular, look for large quantities of file modifications in user directories.\n\nIn some cases, monitoring for unusual kernel driver installation activity can aid in detection.\n\nIn cloud environments, monitor for events that indicate storage objects have been anomalously replaced by copies.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.4",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "File: File Modification",
        "Cloud Storage: Cloud Storage Modification",
        "Network Share: Network Share Access",
        "File: File Creation",
        "Command: Command Execution",
        "Process: Process Creation"
    ],
    "x_mitre_permissions_required": []
}