{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--c994634b-2224-439b-8883-f3df3dbdfbdb",
    "created": "2024-08-13T14:46:36.676377Z",
    "modified": "2024-08-13T14:46:36.676377Z",
    "name": "Root/Jailbreak Detection Evasion via Hooking",
    "description": "An adversary forces a non-restricted mobile application to load arbitrary code or code files, via Hooking, with the goal of evading Root/Jailbreak detection. Mobile device users often Root/Jailbreak their devices in order to gain administrative control over the mobile operating system and/or to install third-party mobile applications that are not provided by authorized application stores (e.g. Google Play Store and Apple App Store). Adversaries may further leverage these capabilities to escalate privileges or bypass access control on legitimate applications. Although many mobile applications check if a mobile device is Rooted/Jailbroken prior to authorized use of the application, adversaries may be able to \"hook\" code in order to circumvent these checks. Successfully evading Root/Jailbreak detection allows an adversary to execute administrative commands, obtain confidential data, impersonate legitimate users of the application, and more.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/660.html",
            "external_id": "660"
        },
        {
            "source_name": "CWE",
            "external_id": "829"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Integrity"
        },
        {
            "impact": "Execute Unauthorized Commands",
            "scope": "Authorization"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        },
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Read Data",
            "scope": "Access Control"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "An adversary targets a non-restricted iOS banking application in an attempt to compromise sensitive user data. The adversary creates Objective-C runtime code that always returns \"false\" when checking for the existence of the Cydia application. The malicious code is then dynamically loaded into the application via the DYLD_INSERT_LIBRARIES environment variable. When the banking applications checks for Cydia, the hooked code returns \"false\", so the application assumes the device is stock (i.e. not Jailbroken) and allows it to access the application. However, the adversary has just evaded Jailbreak detection and is now able to glean user credentials and/or transaction details."
        },
        {
            "description": "An adversary targets a mobile voting application on an Android device with the goal of committing voter fraud. Leveraging the Xposed framework, the adversary is able to create and hook Java code into the application that bypasses Root detection methods. When the voting application attempts to detect a Rooted device by checking for commonly known installed packages associated with Rooting, the hooked code removes the suspicious packages before returning to the application. As a result, the application believes the device is stock (i.e. not Rooted) when in actuality this is not the case. Having evading Root detection, the adversary is now able to cast votes for the candidate of their choosing as a variety of different users."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Identify application with attack potential] The adversary searches for and identifies a mobile application that could be exploited for malicious purposes (e.g. banking, voting, or medical applications).",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "Search application stores for mobile applications worth exploiting"
            ]
        },
        {
            "description": "[Develop code to be hooked into chosen target application] The adversary develops code or leverages existing code that will be hooked into the target application in order to evade Root/Jailbreak detection methods.",
            "phase": "Experiment",
            "step": "2",
            "techniques": [
                "Develop code or leverage existing code to bypass Root/Jailbreak detection methods.",
                "Test the code to see if it works.",
                "Iteratively develop the code until Root/Jailbreak detection methods are evaded."
            ]
        },
        {
            "description": "[Execute code hooking to evade Root/Jailbreak detection methods] Once hooking code has been developed or obtained, execute the code against the target application to evade Root/Jailbreak detection methods.",
            "phase": "Exploit",
            "step": "3",
            "techniques": [
                "Hook code into the target application."
            ]
        }
    ],
    "x_mitre_impact": "Very High",
    "x_mitre_likelihood_of_attack": "Medium",
    "x_mitre_mitigations": [
        {
            "description": "Ensure mobile applications are signed appropriately to avoid code inclusion via hooking."
        },
        {
            "description": "Inspect the application's memory for suspicious artifacts, such as shared objects/JARs or dylibs, after other Root/Jailbreak detection methods."
        },
        {
            "description": "Inspect the application's stack trace for suspicious method calls."
        },
        {
            "description": "Allow legitimate native methods, and check for non-allowed native methods during Root/Jailbreak detection methods."
        },
        {
            "description": "For iOS applications, ensure application methods do not originate from outside of Apple's SDK."
        }
    ]
}