{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--155db668-26b4-4407-a699-55e361b12e2d",
    "created": "2024-08-13T14:46:37.013435Z",
    "modified": "2024-08-13T14:46:45.457334Z",
    "name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage",
    "description": "Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet.Examples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1567/002",
            "external_id": "T1567/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Janantha Marasinghe",
            "date": "2022/10/18",
            "description": "Detects the use of rclone, a command-line program to manage files on cloud storage, via its default user-agent string",
            "detection": {
                "condition": "selection",
                "selection": {
                    "c-useragent|startswith": "rclone/v"
                }
            },
            "falsepositives": [
                "Valid requests with this exact user agent to that is used by legitimate scripts or sysadmin operations"
            ],
            "fields": [
                "c-ip"
            ],
            "id": "2c03648b-e081-41a5-b9fb-7d854a915091",
            "level": "medium",
            "logsource": {
                "category": "proxy"
            },
            "references": [
                "https://rclone.org/",
                "https://www.kroll.com/en/insights/publications/cyber/new-m365-business-email-compromise-attacks-with-rclone"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "Rclone Activity via Proxy"
        },
        {
            "author": "pH-T (Nextron Systems)",
            "date": "2022/07/15",
            "description": "Detects DNS queries for \"anonfiles.com\", which is an anonymous file upload platform often used for malicious purposes",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": ".anonfiles.com"
                }
            },
            "falsepositives": [
                "Rare legitimate access to anonfiles.com"
            ],
            "id": "065cceea-77ec-4030-9052-fc0affea7110",
            "level": "high",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/01/16",
            "references": [
                "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"
            ],
            "related": [
                {
                    "id": "29f171d7-aa47-42c7-9c7b-3c87938164d9",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query for Anonfiles.com Domain - Sysmon"
        },
        {
            "author": "yatinwad, TheDFIRReport",
            "date": "2022/06/23",
            "description": "Detects DNS queries to \"ufile.io\", which was seen abused by malware and threat actors as a method for data exfiltration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": "ufile.io"
                }
            },
            "falsepositives": [
                "DNS queries for \"ufile\" are not malicious by nature necessarily. Investigate the source to determine the necessary actions to take"
            ],
            "id": "1cbbeaaf-3c8c-4e4c-9d72-49485b6a176b",
            "level": "low",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://thedfirreport.com/2021/12/13/diavol-ransomware/"
            ],
            "related": [
                {
                    "id": "090ffaad-c01a-4879-850c-6d57da98452d",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To Ufile.io"
        },
        {
            "author": "Aaron Greetham (@beardofbinary) - NCC Group",
            "date": "2021/05/26",
            "description": "Detects DNS queries for subdomains related to MEGA sharing website",
            "detection": {
                "condition": "selection",
                "selection": {
                    "QueryName|contains": "userstorage.mega.co.nz"
                }
            },
            "falsepositives": [
                "Legitimate DNS queries and usage of Mega"
            ],
            "id": "613c03ba-0779-4a53-8a1f-47f914a4ded3",
            "logsource": {
                "category": "dns_query",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/09/18",
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
            ],
            "related": [
                {
                    "id": "66474410-b883-415f-9f8d-75345a0a66a6",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To MEGA Hosting Website"
        },
        {
            "author": "Aaron Greetham (@beardofbinary) - NCC Group",
            "date": "2021/05/26",
            "description": "Detects Rclone config files being created",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains|all": [
                        ":\\Users\\",
                        "\\.config\\rclone\\"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate Rclone usage"
            ],
            "id": "34986307-b7f4-49be-92f3-e7a4d01ac5db",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "level": "medium",
            "modified": "2023/05/09",
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "Rclone Config File Creation"
        },
        {
            "author": "Bhabesh Raj, Sittikorn S, Aaron Greetham (@beardofbinary) - NCC Group",
            "date": "2021/05/10",
            "description": "Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc",
            "detection": {
                "condition": "selection_specific_options or all of selection_rclone_*",
                "selection_rclone_cli": {
                    "CommandLine|contains": [
                        "pass",
                        "user",
                        "copy",
                        "sync",
                        "config",
                        "lsd",
                        "remote",
                        "ls",
                        "mega",
                        "pcloud",
                        "ftp",
                        "ignore-existing",
                        "auto-confirm",
                        "transfers",
                        "multi-thread-streams",
                        "no-check-certificate "
                    ]
                },
                "selection_rclone_img": [
                    {
                        "Image|endswith": "\\rclone.exe"
                    },
                    {
                        "Description": "Rsync for cloud storage"
                    }
                ],
                "selection_specific_options": {
                    "CommandLine|contains|all": [
                        "--config ",
                        "--no-check-certificate ",
                        " copy "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine",
                "Details"
            ],
            "id": "e37db05d-d1f9-49c8-b464-cee1a4b11638",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "status": "test",
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/",
                "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware",
                "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a",
                "https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone",
                "https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html"
            ],
            "related": [
                {
                    "id": "a0d63692-a531-4912-ad39-4393325b2a9c",
                    "type": "obsoletes"
                },
                {
                    "id": "cb7286ba-f207-44ab-b9e6-760d82b84253",
                    "type": "obsoletes"
                }
            ],
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "PUA - Rclone Execution"
        },
        {
            "id": "66474410-b883-415f-9f8d-75345a0a66a6",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/16",
            "description": "Detects DNS queries for subdomains related to MEGA sharing website",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": "userstorage.mega.co.nz"
                }
            },
            "falsepositives": [
                "Legitimate DNS queries and usage of Mega"
            ],
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "level": "medium",
            "related": [
                {
                    "type": "similar",
                    "id": "613c03ba-0779-4a53-8a1f-47f914a4ded3"
                }
            ],
            "references": [
                "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To MEGA Hosting Website - DNS Client"
        },
        {
            "id": "090ffaad-c01a-4879-850c-6d57da98452d",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/16",
            "description": "Detects DNS queries to \"ufile.io\", which was seen abused by malware and threat actors as a method for data exfiltration",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": "ufile.io"
                }
            },
            "falsepositives": [
                "DNS queries for \"ufile\" are not malicious by nature necessarily. Investigate the source to determine the necessary actions to take"
            ],
            "level": "low",
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "modified": "2023/09/18",
            "references": [
                "https://thedfirreport.com/2021/12/13/diavol-ransomware/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "1cbbeaaf-3c8c-4e4c-9d72-49485b6a176b"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query To Ufile.io - DNS Client"
        },
        {
            "id": "29f171d7-aa47-42c7-9c7b-3c87938164d9",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/16",
            "description": "Detects DNS queries for anonfiles.com, which is an anonymous file upload platform often used for malicious purposes",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 3008,
                    "QueryName|contains": ".anonfiles.com"
                }
            },
            "falsepositives": [
                "Rare legitimate access to anonfiles.com"
            ],
            "level": "high",
            "logsource": {
                "definition": "Requirements: Microsoft-Windows-DNS Client Events/Operational Event Log must be enabled/collected in order to receive the events.",
                "product": "windows",
                "service": "dns-client"
            },
            "related": [
                {
                    "type": "similar",
                    "id": "065cceea-77ec-4030-9052-fc0affea7110"
                }
            ],
            "references": [
                "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1567.002"
            ],
            "title": "DNS Query for Anonfiles.com Domain - DNS Client"
        }
    ]
}