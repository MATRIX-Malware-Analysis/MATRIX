{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--851f33ab-e089-436a-a74e-f8fc0526fcb4",
    "created": "2024-08-13T14:46:36.971072Z",
    "modified": "2024-08-13T14:46:45.190814Z",
    "name": "Automated Exfiltration",
    "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection.[1] When automated exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as Exfiltration Over C2 Channel and Exfiltration Over Alternative Protocol.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1020",
            "external_id": "T1020"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1020",
            "external_id": "T1020"
        },
        {
            "source_name": "ESET Gamaredon June 2020",
            "description": "Boutin, J. (2020, June 11). Gamaredon group grows its game. Retrieved June 16, 2020.",
            "url": "https://www.welivesecurity.com/2020/06/11/gamaredon-group-grows-its-game/"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/22",
            "description": "Detects when a Microsoft Cloud App Security reported suspicious email forwarding rules, for example, if a user created an inbox rule that forwards a copy of all emails to an external address.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "Suspicious inbox forwarding",
                    "eventSource": "SecurityComplianceCenter",
                    "status": "success"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "6c220477-0b5b-4b25-bb90-66183b4089e8",
            "level": "low",
            "logsource": {
                "product": "m365",
                "service": "threat_management"
            },
            "modified": "2022/10/09",
            "references": [
                "https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy",
                "https://learn.microsoft.com/en-us/defender-cloud-apps/policy-template-reference"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1020"
            ],
            "title": "Suspicious Inbox Forwarding"
        },
        {
            "author": "Romain Gaillard (@romain-gaillard)",
            "date": "2024/07/29",
            "description": "Detects when the policy allowing forks of private and internal repositories is changed (enabled or cleared).\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action": [
                        "private_repository_forking.clear",
                        "private_repository_forking.enable"
                    ]
                }
            },
            "falsepositives": [
                "Allowed administrative activities."
            ],
            "id": "69b3bd1e-b38a-462f-9a23-fbdbf63d2294",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "references": [
                "https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/audit-log-events-for-your-enterprise#private_repository_forking"
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.t1020",
                "attack.t1537"
            ],
            "title": "Github Fork Private Repositories Setting Enabled/Cleared"
        },
        {
            "author": "Romain Gaillard (@romain-gaillard)",
            "date": "2024/07/29",
            "description": "Detects when a repository or an organization is being transferred to another location.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action": [
                        "migration.create",
                        "org.transfer_outgoing",
                        "org.transfer",
                        "repo.transfer_outgoing"
                    ]
                }
            },
            "falsepositives": [
                "Allowed administrative activities."
            ],
            "id": "04ad83ef-1a37-4c10-b57a-81092164bf33",
            "level": "medium",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "references": [
                "https://docs.github.com/en/repositories/creating-and-managing-repositories/transferring-a-repository",
                "https://docs.github.com/en/organizations/managing-organization-settings/transferring-organization-ownership",
                "https://docs.github.com/en/migrations",
                "https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/audit-log-events-for-your-enterprise#migration"
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.t1020",
                "attack.t1537"
            ],
            "title": "Github Repository/Organization Transferred"
        },
        {
            "author": "faloker",
            "date": "2020/02/12",
            "description": "Detects the change of database master password. It may be a part of data exfiltration.",
            "detection": {
                "condition": "selection_source",
                "selection_source": {
                    "eventName": "ModifyDBInstance",
                    "eventSource": "rds.amazonaws.com",
                    "responseElements.pendingModifiedValues.masterUserPassword|contains": "*"
                }
            },
            "falsepositives": [
                "Benign changes to a db instance"
            ],
            "id": "8a63cdd4-6207-414a-85bc-7e032bd3c1a2",
            "level": "medium",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/05",
            "references": [
                "https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/rds__explore_snapshots/main.py"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1020"
            ],
            "title": "AWS RDS Master Password Change"
        },
        {
            "author": "faloker",
            "date": "2020/02/12",
            "description": "Detects the recovery of a new public database instance from a snapshot. It may be a part of data exfiltration.",
            "detection": {
                "condition": "selection_source",
                "selection_source": {
                    "eventName": "RestoreDBInstanceFromDBSnapshot",
                    "eventSource": "rds.amazonaws.com",
                    "responseElements.publiclyAccessible": "true"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "c3f265c7-ff03-4056-8ab2-d486227b4599",
            "level": "high",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/rds__explore_snapshots/main.py"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1020"
            ],
            "title": "Restore Public AWS RDS Instance"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/05",
            "description": "Detects PowerShell scripts that have capabilities to read files, loop through them and resolve DNS host entries.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Get-content ",
                        "foreach",
                        "[System.Net.Dns]::GetHostEntry",
                        "Out-File"
                    ]
                }
            },
            "falsepositives": [
                "The same functionality can be implemented by admin scripts, correlate with name and creator"
            ],
            "id": "fbc5e92f-3044-4e73-a5c6-1c4359b539de",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "definition": "bade5735-5ab0-4aa7-a642-a11be0e40872",
                "product": "windows"
            },
            "references": [
                "https://www.fortypoundhead.com/showcontent.asp?artid=24022",
                "https://labs.withsecure.com/publications/fin7-target-veeam-servers"
            ],
            "status": "test",
            "title": "PowerShell Script With File Hostname Resolving Capabilities",
            "tags": [
                "attack.exfiltration",
                "attack.t1020"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/07",
            "description": "Detects PowerShell scripts leveraging the \"Invoke-WebRequest\" cmdlet to send data via either \"PUT\" or \"POST\" method.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cmdlet": {
                    "ScriptBlockText|contains": [
                        "Invoke-WebRequest",
                        "iwr "
                    ]
                },
                "selection_flag": {
                    "ScriptBlockText|contains": [
                        "-Method Put",
                        "-Method Post"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "d2e3f2f6-7e09-4bf2-bc5d-90186809e7fb",
            "level": "low",
            "logsource": {
                "category": "ps_script",
                "definition": "bade5735-5ab0-4aa7-a642-a11be0e40872",
                "product": "windows"
            },
            "modified": "2023/05/04",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1020/T1020.md",
                "https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1020"
            ],
            "title": "PowerShell Script With File Upload Capabilities"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "ExtraHop"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "exfiltration"
        }
    ],
    "x_mitre_detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Command: Command Execution",
        "Network Traffic: Network Traffic Flow",
        "File: File Access",
        "Network Traffic: Network Connection Creation",
        "Network Traffic: Network Traffic Content",
        "Script: Script Execution"
    ],
    "x_mitre_permissions_required": []
}