{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--f013f5eb-b0ee-4dde-a472-e283ff888a71",
    "created": "2024-08-13T14:46:37.128506Z",
    "modified": "2024-08-13T14:46:37.275864Z",
    "name": "Serverless Execution",
    "description": "Adversaries may abuse serverless computing, integration, and automation services to execute arbitrary code in cloud environments. Many cloud providers offer a variety of serverless resources, including compute engines, application integration services, and web servers. Adversaries may abuse these resources in various ways as a means of executing arbitrary commands. For example, adversaries may use serverless functions to execute malicious code, such as crypto-mining malware (i.e. Resource Hijacking).[1] Adversaries may also create functions that enable further compromise of the cloud environment. For example, an adversary may use the IAM:PassRole permission in AWS or the iam.serviceAccounts.actAs permission in Google Cloud to add Additional Cloud Roles to a serverless cloud function, which may then be able to perform actions the original user cannot.[2][3]Serverless functions can also be invoked in response to cloud events (i.e. Event Triggered Execution), potentially enabling persistent execution over time. For example, in AWS environments, an adversary may create a Lambda function that automatically adds Additional Cloud Credentials to a user and a corresponding CloudWatch events rule that invokes that function whenever a new user is created.[4] Similarly, an adversary may create a Power Automate workflow in Office 365 environments that forwards all emails a user receives or creates anonymous sharing links whenever a user is granted access to a document in SharePoint.[5][6]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1648",
            "external_id": "T1648"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1648",
            "external_id": "T1648"
        },
        {
            "source_name": "Microsoft DART Case Report 001",
            "description": "Berk Veral. (2020, March 9). Real-life cybercrime stories from DART, the Microsoft Detection and Response Team. Retrieved May 27, 2022.",
            "url": "https://www.microsoft.com/security/blog/2020/03/09/real-life-cybercrime-stories-dart-microsoft-detection-and-response-team"
        },
        {
            "source_name": "Backdooring an AWS account",
            "description": "Daniel Grzelak. (2016, July 9). Backdooring an AWS account. Retrieved May 27, 2022.",
            "url": "https://medium.com/daniel-grzelak/backdooring-an-aws-account-da007d36f8f9"
        },
        {
            "source_name": "Varonis Power Automate Data Exfiltration",
            "description": "Eric Saraga. (2022, February 2). Using Power Automate for Covert Data Exfiltration in Microsoft 365. Retrieved May 27, 2022.",
            "url": "https://www.varonis.com/blog/power-automate-data-exfiltration"
        },
        {
            "source_name": "Cado Security Denonia",
            "description": "Matt Muir. (2022, April 6). Cado Discovers Denonia: The First Malware Specifically Targeting Lambda. Retrieved May 27, 2022.",
            "url": "https://www.cadosecurity.com/cado-discovers-denonia-the-first-malware-specifically-targeting-lambda/"
        },
        {
            "source_name": "Rhino Security Labs AWS Privilege Escalation",
            "description": "Rhino Security Labs. (n.d.). AWS IAM Privilege Escalation \u2013 Methods and Mitigation. Retrieved May 27, 2022.",
            "url": "https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/"
        },
        {
            "source_name": "Rhingo Security Labs GCP Privilege Escalation",
            "description": "Spencer Gietzen. (n.d.). Privilege Escalation in Google Cloud Platform \u2013 Part 1 (IAM). Retrieved May 27, 2022.",
            "url": "https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/"
        }
    ],
    "x_mitre_platforms": [
        "SaaS",
        "IaaS",
        "Office 365"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Shailesh Tiwary (Indian Army)",
        "Praetorian",
        "Oleg Kolesnikov, Securonix",
        "Cisco",
        "Varonis Threat Labs",
        "Alex Soler, AttackIQ",
        "Vectra AI"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "execution"
        }
    ],
    "x_mitre_detection": "",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.0",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Cloud Service: Cloud Service Modification",
        "Application Log: Application Log Content"
    ],
    "x_mitre_permissions_required": []
}