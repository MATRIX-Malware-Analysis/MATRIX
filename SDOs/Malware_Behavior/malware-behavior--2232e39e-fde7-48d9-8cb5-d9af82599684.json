{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--2232e39e-fde7-48d9-8cb5-d9af82599684",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:46.172645Z",
    "name": "Impair Defenses: Disable or Modify Cloud Firewall",
    "description": "Adversaries may disable or modify a firewall within a cloud environment to bypass controls that limit access to cloud resources. Cloud firewalls are separate from system firewalls that are described in Disable or Modify System Firewall. Cloud environments typically utilize restrictive security groups and firewall rules that only allow network activity from trusted IP addresses via expected ports and protocols. An adversary may introduce new firewall rules or policies to allow access into a victim cloud environment. For example, an adversary may use a script or utility that creates new ingress rules in existing security groups to allow any TCP/IP connectivity, or remove networking limitations to support traffic associated with malicious activity (such as cryptomining).[1][2]Modifying or disabling a cloud firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1562/007",
            "external_id": "T1562/007"
        },
        {
            "source_name": "CAPEC 578",
            "external_id": "malware-behavior--2f8f9894-8e67-43f6-99d5-2527cce30d1c"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/02",
            "description": "Identifies when a Firewall Policy is Modified or Deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/WRITE",
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/JOIN/ACTION",
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/CERTIFICATES/ACTION",
                        "MICROSOFT.NETWORK/FIREWALLPOLICIES/DELETE"
                    ]
                }
            },
            "falsepositives": [
                "Firewall Policy being modified or deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Firewall Policy modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "83c17918-746e-4bd9-920b-8e098bf88c23",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.defense_evasion",
                "attack.t1562.007"
            ],
            "title": "Azure Network Firewall Policy Modified or Deleted"
        }
    ]
}