{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--6fbb68ca-9044-478e-96e2-219040e4e6bd",
    "created": "2024-08-13T14:46:37.023489Z",
    "modified": "2024-08-13T14:46:45.521308Z",
    "name": "System Binary Proxy Execution: Odbcconf",
    "description": "Adversaries may abuse odbcconf.exe to proxy execution of malicious payloads. Odbcconf.exe is a Windows utility that allows you to configure Open Database Connectivity (ODBC) drivers and data source names.[1] The Odbcconf.exe binary may be digitally signed by Microsoft.Adversaries may abuse odbcconf.exe to bypass application control solutions that do not account for its potential abuse. Similar to Regsvr32, odbcconf.exe has a REGSVR flag that can be misused to execute DLLs (ex: odbcconf.exe /S /A {REGSVR 'C:\\Users\\Public\\file.dll'}). [2][3][4]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1218/008",
            "external_id": "T1218/008"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/22",
            "description": "Detects execution of \"odbcconf\" with \"INSTALLDRIVER\" which installs a new ODBC driver. Attackers abuse this to install and run malicious DLLs.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "INSTALLDRIVER ",
                        ".dll"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate driver DLLs being registered via \"odbcconf\" will generate false positives. Investigate the path of the DLL and its contents to determine if the action is authorized."
            ],
            "id": "3f5491e2-8db8-496b-9e95-1029fce852d4",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176",
                "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
            ],
            "related": [
                {
                    "id": "cb0fe7c5-f3a3-484d-aa25-d350a7912729",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "Driver/DLL Installation Via Odbcconf.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/22",
            "description": "Detects execution of \"odbcconf\" with the \"-f\" flag in order to load a response file with a non-\".rsp\" extension.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_*",
                "filter_main_rsp_ext": {
                    "CommandLine|contains": ".rsp"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ],
                "filter_main_runonce_odbc": {
                    "CommandLine|contains": ".exe /E /F \"C:\\WINDOWS\\system32\\odbcconf.tmp\"",
                    "Image": "C:\\Windows\\System32\\odbcconf.exe",
                    "ParentImage": "C:\\Windows\\System32\\runonce.exe"
                },
                "selection_cli": {
                    "CommandLine|contains|windash": " -f "
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "2d32dd6f-3196-4093-b9eb-1ad8ab088ca5",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html"
            ],
            "related": [
                {
                    "id": "5f03babb-12db-4eec-8c82-7b4cb5580868",
                    "type": "derived"
                },
                {
                    "id": "65d2be45-8600-4042-b4c0-577a1ff8a60e",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "Suspicious Response File Execution Via Odbcconf.EXE"
        },
        {
            "author": "Harjot Singh @cyb3rjy0t",
            "date": "2023/05/22",
            "description": "Detects an uncommon child process of \"odbcconf.exe\" binary which normally shouldn't have any child processes.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ParentImage|endswith": "\\odbcconf.exe"
                }
            },
            "falsepositives": [
                "In rare occurrences where \"odbcconf\" crashes. It might spawn a \"werfault\" process",
                "Other child processes will depend on the DLL being registered by actions like \"regsvr\". In case where the DLLs have external calls (which should be rare). Other child processes might spawn and additional filters need to be applied."
            ],
            "id": "8e3c7994-131e-4ba5-b6ea-804d49113a26",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://medium.com/@cyberjyot/t1218-008-dll-execution-using-odbcconf-exe-803fa9e08dac"
            ],
            "status": "test",
            "title": "Uncommon Child Process Spawned By Odbcconf.EXE",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ]
        },
        {
            "id": "5f03babb-12db-4eec-8c82-7b4cb5580868",
            "author": "Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/22",
            "description": "Detects execution of \"odbcconf\" with the \"-f\" flag in order to load a response file which might contain a malicious action.",
            "detection": {
                "condition": "all of selection_*",
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains|windash": " -f "
                },
                "selection_rsp_ext": {
                    "CommandLine|contains": ".rsp"
                }
            },
            "falsepositives": [
                "The rule is looking for any usage of response file, which might generate false positive when this function is used legitimately. Investigate the contents of the \".rsp\" file to determine if it is malicious and apply additional filters if necessary."
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/05",
            "references": [
                "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://www.cybereason.com/blog/threat-analysis-report-bumblebee-loader-the-high-road-to-enterprise-domain-control",
                "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "2d32dd6f-3196-4093-b9eb-1ad8ab088ca5"
                },
                {
                    "id": "65d2be45-8600-4042-b4c0-577a1ff8a60e",
                    "type": "obsoletes"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "Response File Execution Via Odbcconf.EXE"
        },
        {
            "author": "Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/22",
            "description": "Detects execution of \"odbcconf\" with \"REGSVR\" in order to register a new DLL (equivalent to running regsvr32). Attackers abuse this to install and run malicious DLLs.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        "REGSVR ",
                        ".dll"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate DLLs being registered via \"odbcconf\" will generate false positives. Investigate the path of the DLL and its content to determine if the action is authorized."
            ],
            "id": "9f0a8bf3-a65b-440a-8c1e-5cb1547c8e70",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://redcanary.com/blog/raspberry-robin/",
                "https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176",
                "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/",
                "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html"
            ],
            "related": [
                {
                    "id": "ba4cfc11-d0fa-4d94-bf20-7c332c412e76",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "New DLL Registered Via Odbcconf.EXE"
        },
        {
            "id": "ba4cfc11-d0fa-4d94-bf20-7c332c412e76",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/22",
            "description": "Detects execution of \"odbcconf\" with the \"REGSVR\" action where the DLL in question doesn't contain a \".dll\" extension. Which is often used as a method to evade defenses.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_*",
                "filter_main_dll_ext": {
                    "CommandLine|contains": ".dll"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains": "REGSVR "
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "related": [
                {
                    "type": "derived",
                    "id": "9f0a8bf3-a65b-440a-8c1e-5cb1547c8e70"
                }
            ],
            "references": [
                "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "Potentially Suspicious DLL Registered Via Odbcconf.EXE"
        },
        {
            "id": "cb0fe7c5-f3a3-484d-aa25-d350a7912729",
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/23",
            "description": "Detects execution of \"odbcconf\" with the \"INSTALLDRIVER\" action where the driver doesn't contain a \".dll\" extension. This is often used as a defense evasion method.",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_*",
                "filter_main_dll_ext": {
                    "CommandLine|contains": ".dll"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ],
                "selection_cli": {
                    "CommandLine|contains": "INSTALLDRIVER "
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
                "https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176",
                "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "3f5491e2-8db8-496b-9e95-1029fce852d4"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "Suspicious Driver/DLL Installation Via Odbcconf.EXE"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/05/22",
            "description": "Detects execution of \"odbcconf\" where the path of the DLL being registered is located in a potentially suspicious location.",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        ":\\PerfLogs\\",
                        ":\\ProgramData\\",
                        ":\\Temp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\Registration\\CRMLog",
                        ":\\Windows\\System32\\com\\dmp\\",
                        ":\\Windows\\System32\\FxsTmp\\",
                        ":\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\",
                        ":\\Windows\\System32\\spool\\drivers\\color\\",
                        ":\\Windows\\System32\\spool\\PRINTERS\\",
                        ":\\Windows\\System32\\spool\\SERVERS\\",
                        ":\\Windows\\System32\\Tasks_Migrated\\",
                        ":\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                        ":\\Windows\\SysWOW64\\com\\dmp\\",
                        ":\\Windows\\SysWOW64\\FxsTmp\\",
                        ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\",
                        ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                        ":\\Windows\\Tasks\\",
                        ":\\Windows\\Temp\\",
                        ":\\Windows\\Tracing\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\odbcconf.exe"
                    },
                    {
                        "OriginalFileName": "odbcconf.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "6b65c28e-11f3-46cb-902a-68f2cafaf474",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/26",
            "references": [
                "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
                "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html",
                "https://securityintelligence.com/posts/raspberry-robin-worm-dridex-malware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1218.008"
            ],
            "title": "Odbcconf.EXE Suspicious DLL Location"
        }
    ]
}