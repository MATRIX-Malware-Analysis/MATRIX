{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--0fa940ab-d2ea-4768-8748-b11645a2f5e9",
    "created": "2024-08-13T14:46:36.851221Z",
    "modified": "2024-08-13T14:46:44.558032Z",
    "name": "Create Account: Cloud Account",
    "description": "Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system.[1][2][3][4][5]In addition to user accounts, cloud accounts may be associated with services. Cloud providers handle the concept of service accounts in different ways. In Azure, service accounts include service principals and managed identities, which can be linked to various resources such as OAuth applications, serverless functions, and virtual machines in order to grant those resources permissions to perform various activities in the environment.[6] In GCP, service accounts can also be linked to specific resources, as well as be impersonated by other accounts for Temporary Elevated Cloud Access.[7] While AWS has no specific concept of service accounts, resources can be directly granted permission to assume roles.[8][9]Adversaries may create accounts that only have access to specific cloud services, which can reduce the chance of detection.Once an adversary has created a cloud account, they can then manipulate that account to ensure persistence and allow access to additional resources - for example, by adding Additional Cloud Credentials or assigning Additional Cloud Roles.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1136/003",
            "external_id": "T1136/003"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Splunk Threat Research Team (original rule), Harjot Singh @cyb3rjy0t (sigma rule)",
            "date": "2023/09/18",
            "description": "Detects the addition of a new Federated Domain.",
            "detection": {
                "condition": "all of selection_*",
                "selection_domain": {
                    "Operation|contains": "domain"
                },
                "selection_operation": {
                    "Operation|contains": [
                        "add",
                        "new"
                    ]
                }
            },
            "falsepositives": [
                "The creation of a new Federated domain is not necessarily malicious, however these events need to be followed closely, as it may indicate federated credential abuse or backdoor via federated identities at a similar or different cloud provider."
            ],
            "id": "58f88172-a73d-442b-94c9-95eaed3cbb36",
            "level": "medium",
            "logsource": {
                "product": "m365",
                "service": "audit"
            },
            "references": [
                "https://research.splunk.com/cloud/e155876a-6048-11eb-ae93-0242ac130002/",
                "https://o365blog.com/post/aadbackdoor/"
            ],
            "related": [
                {
                    "id": "42127bdd-9133-474f-a6f1-97b6c08a4339",
                    "type": "similar"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.persistence",
                "attack.t1136.003"
            ],
            "title": "New Federated Domain Added"
        },
        {
            "id": "42127bdd-9133-474f-a6f1-97b6c08a4339",
            "author": "Splunk Threat Research Team (original rule), '@ionsor (rule)'",
            "date": "2022/02/08",
            "description": "Detects the addition of a new Federated Domain.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "Add-FederatedDomain",
                    "eventSource": "Exchange",
                    "status": "success"
                }
            },
            "falsepositives": [
                "The creation of a new Federated domain is not necessarily malicious, however these events need to be followed closely, as it may indicate federated credential abuse or backdoor via federated identities at a similar or different cloud provider."
            ],
            "level": "medium",
            "logsource": {
                "product": "m365",
                "service": "exchange"
            },
            "references": [
                "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/wp-m-unc2452-2021-000343-01.pdf",
                "https://us-cert.cisa.gov/ncas/alerts/aa21-008a",
                "https://www.splunk.com/en_us/blog/security/a-golden-saml-journey-solarwinds-continued.html",
                "https://www.sygnia.co/golden-saml-advisory",
                "https://o365blog.com/post/aadbackdoor/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "58f88172-a73d-442b-94c9-95eaed3cbb36"
                }
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136.003"
            ],
            "title": "New Federated Domain Added - Exchange"
        },
        {
            "author": "Muhammad Faisal (@faisalusuf)",
            "date": "2023/01/29",
            "description": "Detects when a new member is added or invited to a github organization.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "action": [
                        "org.add_member",
                        "org.invite_member"
                    ]
                }
            },
            "falsepositives": [
                "Organization approved new members"
            ],
            "id": "3908d64a-3c06-4091-b503-b3a94424533b",
            "level": "informational",
            "logsource": {
                "definition": "Requirements: The audit log streaming feature must be enabled to be able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming",
                "product": "github",
                "service": "audit"
            },
            "references": [
                "https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#dependabot_alerts-category-actions"
            ],
            "status": "test",
            "title": "New Github Organization Member Added",
            "tags": [
                "attack.persistence",
                "attack.t1136.003"
            ]
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/07/24",
            "description": "Detects when an ElastiCache security group has been created.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": "CreateCacheSecurityGroup",
                    "eventSource": "elasticache.amazonaws.com"
                }
            },
            "falsepositives": [
                "A ElastiCache security group may be created by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Security group creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "4ae68615-866f-4304-b24b-ba048dfa5ca7",
            "level": "low",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/elastic/detection-rules/blob/598f3d7e0a63221c0703ad9a0ea7e22e7bc5961e/rules/integrations/aws/persistence_elasticache_security_group_creation.toml"
            ],
            "status": "test",
            "tags": [
                "attack.persistence",
                "attack.t1136",
                "attack.t1136.003"
            ],
            "title": "AWS ElastiCache Security Group Created"
        }
    ]
}