{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--3d04e0a1-42be-4898-8cb8-668656ac0ac8",
    "created": "2024-08-13T14:46:36.852685Z",
    "modified": "2024-08-13T14:46:44.568012Z",
    "name": "Exfiltration Over Alternative Protocol",
    "description": "Adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.  Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Adversaries may also opt to encrypt and/or obfuscate these alternate channels. Exfiltration Over Alternative Protocol can be done using various common operating system utilities such as Net/SMB or FTP.[1] On macOS and Linux curl may be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from a system.[2]Many IaaS and SaaS platforms (such as Microsoft Exchange, Microsoft SharePoint, GitHub, and AWS S3) support the direct download of files, emails, source code, and other sensitive information via the web console or Cloud API.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1048",
            "external_id": "T1048"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1048",
            "external_id": "T1048"
        },
        {
            "source_name": "University of Birmingham C2",
            "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
            "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
        },
        {
            "source_name": "Palo Alto OilRig Oct 2016",
            "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
            "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/"
        },
        {
            "source_name": "20 macOS Common Tools and Techniques",
            "description": "Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.",
            "url": "https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/05/10",
            "description": "Detects suspicious DNS queries using base64 encoding",
            "detection": {
                "condition": "selection",
                "selection": {
                    "query|contains": "==."
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4153a907-2451-4e4f-a578-c52bb6881432",
            "level": "medium",
            "logsource": {
                "category": "dns"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/krmaxwell/dns-exfiltration"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003",
                "attack.command_and_control",
                "attack.t1071.004"
            ],
            "title": "Suspicious DNS Query with B64 Encoded String"
        },
        {
            "author": "Saw Winn Naung , Azure-Sentinel",
            "date": "2021/08/15",
            "description": "Identifies IPs performing DNS lookups associated with common Tor proxies.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "query": [
                        "tor2web.org",
                        "tor2web.com",
                        "torlink.co",
                        "onion.to",
                        "onion.ink",
                        "onion.cab",
                        "onion.nu",
                        "onion.link",
                        "onion.it",
                        "onion.city",
                        "onion.direct",
                        "onion.top",
                        "onion.casa",
                        "onion.plus",
                        "onion.rip",
                        "onion.dog",
                        "tor2web.fi",
                        "tor2web.blutmagie.de",
                        "onion.sh",
                        "onion.lu",
                        "onion.pet",
                        "t2w.pw",
                        "tor2web.ae.org",
                        "tor2web.io",
                        "tor2web.xyz",
                        "onion.lt",
                        "s1.tor-gateways.de",
                        "s2.tor-gateways.de",
                        "s3.tor-gateways.de",
                        "s4.tor-gateways.de",
                        "s5.tor-gateways.de",
                        "hiddenservice.net"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "clientip"
            ],
            "id": "a8322756-015c-42e7-afb1-436e85ed3ff5",
            "level": "medium",
            "modified": "2022/10/09",
            "logsource": {
                "product": "zeek",
                "service": "dns"
            },
            "status": "test",
            "references": [
                "https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/ASimDNS/imDNS_TorProxies.yaml"
            ],
            "tags": [
                "attack.exfiltration",
                "attack.t1048"
            ],
            "title": "DNS TOR Proxies"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "A General detection for WebDav user-agent being used to PUT files on a WebDav network share. This could be an indicator of exfiltration.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "id.resp_h|cidr": [
                        "10.0.0.0/8",
                        "127.0.0.0/8",
                        "172.16.0.0/12",
                        "192.168.0.0/16",
                        "169.254.0.0/16"
                    ]
                },
                "selection": {
                    "method": "PUT",
                    "user_agent|contains": "WebDAV"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "705072a5-bb6f-4ced-95b6-ecfa6602090b",
            "level": "low",
            "logsource": {
                "product": "zeek",
                "service": "http"
            },
            "modified": "2024/03/13",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/17"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003"
            ],
            "title": "WebDav Put Request"
        },
        {
            "author": "frack113",
            "date": "2022/01/07",
            "description": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.\nThe data may also be sent to an alternate network location from the main command and control server.\n",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_clients": {
                    "Image|endswith": [
                        "\\thunderbird.exe",
                        "\\outlook.exe"
                    ]
                },
                "filter_mailserver": {
                    "Image|startswith": "C:\\Program Files\\Microsoft\\Exchange Server\\"
                },
                "filter_outlook": {
                    "Image|endswith": "\\HxTsr.exe",
                    "Image|startswith": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_"
                },
                "selection": {
                    "DestinationPort": [
                        25,
                        587,
                        465,
                        2525
                    ],
                    "Initiated": "true"
                }
            },
            "falsepositives": [
                "Other SMTP tools"
            ],
            "id": "9976fa64-2804-423c-8a5b-646ade840773",
            "level": "medium",
            "logsource": {
                "category": "network_connection",
                "product": "windows"
            },
            "modified": "2022/09/21",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp",
                "https://www.ietf.org/rfc/rfc2821.txt"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003"
            ],
            "title": "Suspicious Outbound SMTP Connections"
        },
        {
            "author": "Florian Roth (Nextron Systems), oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st, Nasreddine Bencherchali",
            "date": "2019/12/30",
            "description": "Detects a copy command or a copy utility execution to or from an Admin share or remote",
            "detection": {
                "condition": "selection_target and (selection_other_tools or all of selection_cmd_* or all of selection_pwsh_*)",
                "selection_cmd_cli": {
                    "CommandLine|contains": "copy"
                },
                "selection_cmd_img": [
                    {
                        "Image|endswith": "\\cmd.exe"
                    },
                    {
                        "OriginalFileName": "Cmd.Exe"
                    }
                ],
                "selection_other_tools": [
                    {
                        "Image|endswith": [
                            "\\robocopy.exe",
                            "\\xcopy.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "robocopy.exe",
                            "XCOPY.EXE"
                        ]
                    }
                ],
                "selection_pwsh_cli": {
                    "CommandLine|contains": [
                        "copy-item",
                        "copy ",
                        "cpi ",
                        " cp ",
                        "move ",
                        "move-item",
                        " mi ",
                        " mv "
                    ]
                },
                "selection_pwsh_img": [
                    {
                        "Image|contains": [
                            "\\powershell.exe",
                            "\\pwsh.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "PowerShell.EXE",
                            "pwsh.dll"
                        ]
                    }
                ],
                "selection_target": {
                    "CommandLine|contains": [
                        "\\\\\\\\*$",
                        "\\Sysvol\\"
                    ]
                }
            },
            "falsepositives": [
                "Administrative scripts"
            ],
            "id": "855bc8b5-2ae8-402e-a9ed-b889e6df1900",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/15",
            "references": [
                "https://twitter.com/SBousseaden/status/1211636381086339073",
                "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view",
                "https://www.elastic.co/guide/en/security/current/remote-file-copy-to-a-hidden-share.html",
                "https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/"
            ],
            "status": "test",
            "tags": [
                "attack.lateral_movement",
                "attack.collection",
                "attack.exfiltration",
                "attack.t1039",
                "attack.t1048",
                "attack.t1021.002"
            ],
            "title": "Copy From Or To Admin Share Or Sysvol Folder"
        },
        {
            "author": "Daniil Yugoslavskiy, oscd.community",
            "date": "2019/10/24",
            "description": "Well-known DNS Exfiltration tools execution",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\iodine.exe"
                    },
                    {
                        "Image|contains": "\\dnscat2"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "98a96a5a-64a0-4c42-92c5-489da3866cb0",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2021/11/27",
            "references": [
                "https://github.com/iagox86/dnscat2",
                "https://github.com/yarrick/iodine"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.001",
                "attack.command_and_control",
                "attack.t1071.004",
                "attack.t1132.001"
            ],
            "title": "DNS Exfiltration and Tunneling Tools Execution"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
            "date": "2023/03/16",
            "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like C:\\windows\\system32\\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially a sign of exploitation of CVE-2023-23397\n",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_local_ips": {
                    "CommandLine|contains": [
                        "://10.",
                        "://192.168.",
                        "://172.16.",
                        "://172.17.",
                        "://172.18.",
                        "://172.19.",
                        "://172.20.",
                        "://172.21.",
                        "://172.22.",
                        "://172.23.",
                        "://172.24.",
                        "://172.25.",
                        "://172.26.",
                        "://172.27.",
                        "://172.28.",
                        "://172.29.",
                        "://172.30.",
                        "://172.31.",
                        "://127.",
                        "://169.254."
                    ]
                },
                "selection": {
                    "CommandLine|contains": "C:\\windows\\system32\\davclnt.dll,DavSetCookie",
                    "CommandLine|re": "://\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
                    "Image|endswith": "\\rundll32.exe",
                    "ParentCommandLine|contains": "-s WebClient",
                    "ParentImage|endswith": "\\svchost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "982e9f2d-1a85-4d5b-aea4-31f5e97c6555",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://twitter.com/aceresponder/status/1636116096506818562",
                "https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/",
                "https://www.pwndefend.com/2023/03/15/the-long-game-persistent-hash-theft/",
                "https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2023/03/Figure-7-sample-webdav-process-create-event.png",
                "https://www.microsoft.com/en-us/security/blog/2023/03/24/guidance-for-investigating-attacks-using-cve-2023-23397/"
            ],
            "status": "experimental",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003",
                "cve.2023.23397"
            ],
            "title": "Suspicious WebDav Client Execution Via Rundll32.EXE"
        },
        {
            "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
            "date": "2020/05/02",
            "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like \"C:\\windows\\system32\\davclnt.dll,DavSetCookie\".\nThis could be an indicator of exfiltration or use of WebDav to launch code (hosted on a WebDav server).\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": "C:\\windows\\system32\\davclnt.dll,DavSetCookie"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\rundll32.exe"
                    },
                    {
                        "OriginalFileName": "RUNDLL32.EXE"
                    }
                ],
                "selection_parent": {
                    "ParentImage|endswith": "\\svchost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2dbd9d3d-9e27-42a8-b8df-f13825c6c3d5",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/09/18",
            "references": [
                "https://github.com/OTRF/detection-hackathon-apt29/issues/17",
                "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/7.B.4_C10730EA-6345-4934-AA0F-B0EFCA0C4BA6.md"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003"
            ],
            "title": "WebDav Client Execution Via Rundll32.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/16",
            "description": "Detects a suspicious output redirection to the local admins share, this technique is often found in malicious scripts or hacktool stagers",
            "detection": {
                "condition": "all of selection_*",
                "selection_redirect": {
                    "CommandLine|contains": ">"
                },
                "selection_share": {
                    "CommandLine|contains": [
                        "\\\\\\\\127.0.0.1\\\\admin$\\\\",
                        "\\\\\\\\localhost\\\\admin$\\\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "ab9e3b40-0c85-4ba1-aede-455d226fd124",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/28",
            "references": [
                "https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/",
                "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
            ],
            "status": "test",
            "title": "Suspicious Redirection to Local Admin Share",
            "tags": [
                "attack.exfiltration",
                "attack.t1048"
            ]
        },
        {
            "author": "Daniil Yugoslavskiy, Ian Davis, oscd.community",
            "date": "2019/10/24",
            "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_avast": {
                    "Image|contains": [
                        ":\\Program Files\\Avast Software\\SecureLine VPN\\",
                        ":\\Program Files (x86)\\Avast Software\\SecureLine VPN\\"
                    ]
                },
                "filter_optional_openvpn": {
                    "Image|contains": ":\\Program Files\\OpenVPN Connect\\drivers\\tap\\"
                },
                "filter_optional_protonvpn": {
                    "Image|contains": ":\\Program Files (x86)\\Proton Technologies\\ProtonVPNTap\\installer\\"
                },
                "selection": {
                    "Image|endswith": "\\tapinstall.exe"
                }
            },
            "falsepositives": [
                "Legitimate OpenVPN TAP installation"
            ],
            "id": "99793437-3e16-439b-be0f-078782cf953d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/12/11",
            "references": [
                "https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers"
            ],
            "status": "test",
            "title": "Tap Installer Execution",
            "tags": [
                "attack.exfiltration",
                "attack.t1048"
            ]
        },
        {
            "author": "Daniil Yugoslavskiy, Ian Davis, oscd.community",
            "date": "2019/10/24",
            "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 7045,
                    "ImagePath|contains": "tap0901",
                    "Provider_Name": "Service Control Manager"
                }
            },
            "falsepositives": [
                "Legitimate OpenVPN TAP installation"
            ],
            "id": "8e4cf0e5-aa5d-4dc3-beff-dc26917744a9",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "system"
            },
            "modified": "2022/12/25",
            "references": [
                "https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers"
            ],
            "status": "test",
            "title": "Tap Driver Installation",
            "tags": [
                "attack.exfiltration",
                "attack.t1048"
            ]
        },
        {
            "author": "Daniil Yugoslavskiy, Ian Davis, oscd.community",
            "date": "2019/10/24",
            "description": "Detects the installation of a well-known TAP driver service. This could be a sign of potential preparation for data exfiltration using tunnelling techniques.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": 4697,
                    "ServiceFileName|contains": "tap0901"
                }
            },
            "falsepositives": [
                "Legitimate OpenVPN TAP installation"
            ],
            "id": "9c8afa4d-0022-48f0-9456-3712466f9701",
            "level": "low",
            "logsource": {
                "definition": "Requirements: The System Security Extension audit subcategory need to be enabled to log the EID 4697",
                "product": "windows",
                "service": "security"
            },
            "modified": "2022/11/29",
            "references": [
                "https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "8e4cf0e5-aa5d-4dc3-beff-dc26917744a9"
                }
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048"
            ],
            "title": "Tap Driver Installation - Security"
        },
        {
            "author": "frack113",
            "date": "2022/09/26",
            "description": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.\nThe data may also be sent to an alternate network location from the main command and control server.\n",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "ScriptBlockText|contains": "CmdletsToExport"
                },
                "selection": {
                    "ScriptBlockText|contains": "Send-MailMessage"
                }
            },
            "falsepositives": [
                "Legitimate script"
            ],
            "id": "9a7afa56-4762-43eb-807d-c3dc9ffe211b",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/send-mailmessage?view=powershell-7.4",
                "https://www.ietf.org/rfc/rfc2821.txt"
            ],
            "status": "test",
            "title": "Powershell Exfiltration Over SMTP",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003"
            ]
        },
        {
            "author": "frack113",
            "date": "2022/01/07",
            "description": "DNSExfiltrator allows for transferring (exfiltrate) a file over a DNS request covert channel",
            "detection": {
                "condition": "selection_cmdlet",
                "selection_cmdlet": [
                    {
                        "ScriptBlockText|contains": "Invoke-DNSExfiltrator"
                    },
                    {
                        "ScriptBlockText|contains|all": [
                            " -i ",
                            " -d ",
                            " -p ",
                            " -doh ",
                            " -t "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Legitimate script"
            ],
            "id": "d59d7842-9a21-4bc6-ba98-64bfe0091355",
            "level": "high",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048/T1048.md#atomic-test-3---dnsexfiltration-doh",
                "https://github.com/Arno0x/DNSExfiltrator"
            ],
            "status": "test",
            "title": "Powershell DNSExfiltration",
            "tags": [
                "attack.exfiltration",
                "attack.t1048"
            ]
        },
        {
            "author": "Bartlomiej Czyz @bczyz1, oscd.community",
            "date": "2020/10/10",
            "description": "Detects Exfiltration Over Alternative Protocol - ICMP. Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "New-Object",
                        "System.Net.NetworkInformation.Ping",
                        ".Send("
                    ]
                }
            },
            "falsepositives": [
                "Legitimate usage of System.Net.NetworkInformation.Ping class"
            ],
            "id": "4c4af3cd-2115-479c-8193-6b8bfce9001c",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "modified": "2022/12/25",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-2---exfiltration-over-alternative-protocol---icmp"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003"
            ],
            "title": "PowerShell ICMP Exfiltration"
        },
        {
            "author": "Pawel Mazur",
            "date": "2021/11/18",
            "description": "Detects attempts to post the file with the usage of wget utility.\nThe adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0": "wget",
                    "a1|startswith": "--post-file=",
                    "type": "EXECVE"
                }
            },
            "falsepositives": [
                "Legitimate usage of wget utility to post a file"
            ],
            "id": "cb39d16b-b3b6-4a7a-8222-1cf24b686ffc",
            "level": "medium",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "modified": "2022/12/25",
            "references": [
                "https://linux.die.net/man/1/wget",
                "https://gtfobins.github.io/gtfobins/wget/"
            ],
            "status": "test",
            "tags": [
                "attack.exfiltration",
                "attack.t1048.003"
            ],
            "title": "Data Exfiltration with Wget"
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Office 365",
        "SaaS",
        "IaaS",
        "Google Workspace",
        "Network"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "William Cain",
        "Alfredo Abarca"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "exfiltration"
        }
    ],
    "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.4",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Cloud Storage: Cloud Storage Access",
        "Network Traffic: Network Traffic Flow",
        "Command: Command Execution",
        "Network Traffic: Network Traffic Content",
        "Application Log: Application Log Content",
        "File: File Access",
        "Network Traffic: Network Connection Creation"
    ],
    "x_mitre_permissions_required": []
}