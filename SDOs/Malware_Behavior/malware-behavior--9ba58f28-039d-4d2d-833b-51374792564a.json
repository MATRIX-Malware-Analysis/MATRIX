{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--9ba58f28-039d-4d2d-833b-51374792564a",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.45025Z",
    "name": "Impair Defenses: Safe Mode Boot",
    "description": "Adversaries may abuse Windows safe mode to disable endpoint defenses. Safe mode starts up the Windows operating system with a limited set of drivers and services. Third-party security software such as endpoint detection and response (EDR) tools may not start after booting Windows in safe mode. There are two versions of safe mode: Safe Mode and Safe Mode with Networking. It is possible to start additional services after a safe mode boot.[1][2]Adversaries may abuse safe mode to disable endpoint defenses that may not start with a limited boot. Hosts can be forced into safe mode after the next reboot via modifications to Boot Configuration Data (BCD) stores, which are files that manage boot application settings.[3]Adversaries may also add their malicious applications to the list of minimal services that start in safe mode by modifying relevant Registry values (i.e. Modify Registry). Malicious Component Object Model (COM) objects may also be registered and loaded in safe mode.[2][4][5][6]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1562/009",
            "external_id": "T1562/009"
        },
        {
            "source_name": "CAPEC 578",
            "external_id": "malware-behavior--2f8f9894-8e67-43f6-99d5-2527cce30d1c"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "windows"
                            },
                            {
                                "or": [
                                    {
                                        "description": "XP-era method for safe mode",
                                        "substring": "bootcfg /raw /a /safeboot:network"
                                    },
                                    {
                                        "description": "modern-era method for safe mode, no internet",
                                        "string": "bcdedit /set {current} safeboot minimal"
                                    },
                                    {
                                        "description": "modern-era method for safe mode, with internet",
                                        "string": "bcdedit /set {current} safeboot network"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Impair Defenses::Safe Mode Boot [T1562.009]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "name": "enable safe mode boot",
                    "namespace": "host-interaction/bootloader",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        },
        {
            "rule": {
                "features": [
                    {
                        "and": [
                            {
                                "os": "windows"
                            },
                            {
                                "or": [
                                    {
                                        "description": "registry key for safe mode, no networking",
                                        "substring": "Control\\SafeBoot\\Minimal\\"
                                    },
                                    {
                                        "description": "registry key for safe mode, with networking",
                                        "substring": "Control\\SafeBoot\\Network\\"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Defense Evasion::Impair Defenses::Safe Mode Boot [T1562.009]"
                    ],
                    "authors": [
                        "william.ballenthin@mandiant.com"
                    ],
                    "examples": [
                        "3446b3889a52d81119d8c482a2a282b9:0x409AA8"
                    ],
                    "name": "manipulate safe mode programs",
                    "namespace": "host-interaction/bootloader",
                    "scopes": {
                        "dynamic": "thread",
                        "static": "function"
                    }
                }
            }
        }
    ]
}