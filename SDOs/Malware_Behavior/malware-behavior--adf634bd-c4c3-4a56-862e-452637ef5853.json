{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--adf634bd-c4c3-4a56-862e-452637ef5853",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:44.993686Z",
    "name": "Masquerading",
    "description": "Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.Renaming abusable system utilities to evade security monitoring is also a form of Masquerading.[1]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1036",
            "external_id": "T1036"
        },
        {
            "source_name": "CAPEC 177",
            "external_id": "malware-behavior--6d7db53d-b2c5-4697-af67-3c32d0ed92fe"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1036",
            "external_id": "T1036"
        },
        {
            "source_name": "Twitter ItsReallyNick Masquerading Update",
            "description": "Carr, N.. (2018, October 25). Nick Carr Status Update Masquerading. Retrieved April 22, 2019.",
            "url": "https://twitter.com/ItsReallyNick/status/1055321652777619457"
        },
        {
            "source_name": "Elastic Masquerade Ball",
            "description": "Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016.",
            "url": "https://www.elastic.co/blog/how-hunt-masquerade-ball"
        },
        {
            "source_name": "LOLBAS Main Site",
            "description": "LOLBAS. (n.d.). Living Off The Land Binaries and Scripts (and also Libraries). Retrieved February 10, 2020.",
            "url": "https://lolbas-project.github.io/"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/10/25",
            "description": "Detects a flashplayer update from an unofficial location",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "cs-host|endswith": ".adobe.com"
                },
                "selection": [
                    {
                        "c-uri|contains": "/flash_install.php"
                    },
                    {
                        "c-uri|endswith": "/install_flash_player.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown flash download locations"
            ],
            "id": "4922a5dd-6743-4fc2-8e81-144374280997",
            "level": "high",
            "logsource": {
                "category": "proxy"
            },
            "modified": "2022/08/08",
            "references": [
                "https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb"
            ],
            "status": "test",
            "tags": [
                "attack.initial_access",
                "attack.t1189",
                "attack.execution",
                "attack.t1204.002",
                "attack.defense_evasion",
                "attack.t1036.005"
            ],
            "title": "Flash Player Update from Suspicious Location"
        },
        {
            "author": "Leo Tsaousis (@laripping)",
            "date": "2024/03/26",
            "description": "Detects deployments of pods within the kube-system namespace, which could be intended to imitate system pods.\nSystem pods, created by controllers such as Deployments or DaemonSets have random suffixes in their names.\nAttackers can use this fact and name their backdoor pods as if they were created by these controllers to avoid detection.\nDeployment of such a backdoor container e.g. named kube-proxy-bv61v, could be attempted in the kube-system namespace alongside the other administrative containers.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "objectRef.namespace": "kube-system",
                    "objectRef.resource": "pods",
                    "verb": "create"
                }
            },
            "falsepositives": [
                "System components such as daemon-set-controller and kube-scheduler also create pods in the kube-system namespace"
            ],
            "id": "a80d927d-ac6e-443f-a867-e8d6e3897318",
            "level": "medium",
            "logsource": {
                "category": "application",
                "product": "kubernetes",
                "service": "audit"
            },
            "references": [
                "https://microsoft.github.io/Threat-Matrix-for-Kubernetes/techniques/Pod%20or%20container%20name%20similarily/"
            ],
            "status": "experimental",
            "tags": [
                "attack.t1036.005"
            ],
            "title": "Creation Of Pod In System Namespace"
        },
        {
            "author": "remotephone",
            "date": "2021/11/20",
            "description": "Detects attempts to masquerade as legitimate files by adding a space to the end of the filename.",
            "detection": {
                "condition": "1 of selection*",
                "selection1": {
                    "CommandLine|endswith": " "
                },
                "selection2": {
                    "Image|endswith": " "
                }
            },
            "falsepositives": [
                "Mistyped commands or legitimate binaries named to match the pattern"
            ],
            "id": "b6e2a2e3-2d30-43b1-a4ea-071e36595690",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "macos"
            },
            "modified": "2023/01/04",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.006/T1036.006.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.006"
            ],
            "title": "Space After Filename - macOS"
        },
        {
            "author": "Anish Bogati",
            "date": "2024/01/09",
            "description": "Detects image load events of system control panel items (.cpl) from uncommon or non-system locations which might be the result of sideloading.",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_main_legit_location": {
                    "ImageLoaded|contains": [
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\",
                        ":\\Windows\\WinSxS\\"
                    ]
                },
                "selection": {
                    "ImageLoaded|endswith": [
                        "\\hdwwiz.cpl",
                        "\\appwiz.cpl"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2b140a5c-dc02-4bb8-b6b1-8bdb45714cde",
            "level": "medium",
            "logsource": {
                "category": "image_load",
                "product": "windows"
            },
            "references": [
                "https://www.hexacorn.com/blog/2024/01/06/1-little-known-secret-of-fondue-exe/",
                "https://www.hexacorn.com/blog/2024/01/01/1-little-known-secret-of-hdwwiz-exe/"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "System Control Panel Item Loaded From Uncommon Location"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2024/06/24",
            "description": "Detects the creation of a file with the \".dll\" extension that has the name of a System DLL in uncommon or unsuspected locations. (Outisde of \"System32\", \"SysWOW64\", etc.).\nIt is highly recommended to perform an initial baseline before using this rule in production.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "TargetFilename|contains": [
                        "C:\\$WINDOWS.~BT\\",
                        "C:\\$WinREAgent\\",
                        "C:\\Windows\\SoftwareDistribution\\",
                        "C:\\Windows\\System32\\",
                        "C:\\Windows\\SysWOW64\\",
                        "C:\\Windows\\WinSxS\\",
                        "C:\\Windows\\uus\\"
                    ]
                },
                "selection": {
                    "TargetFilename|endswith": [
                        "\\secur32.dll",
                        "\\tdh.dll"
                    ]
                }
            },
            "falsepositives": [
                "Third party software might bundle specific versions of system DLLs."
            ],
            "id": "13c02350-4177-4e45-ac17-cf7ca628ff5e",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.005"
            ],
            "title": "Files With System DLL Name In Unsuspected Locations"
        },
        {
            "author": "Sander Wiebing, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/05/26",
            "description": "Detects the creation of an executable with a system process name in folders other than the system ones (System32, SysWOW64, etc.).\nIt is highly recommended to perform an initial baseline before using this rule in production.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "TargetFilename|contains": [
                        "C:\\$WINDOWS.~BT\\",
                        "C:\\$WinREAgent\\",
                        "C:\\Windows\\SoftwareDistribution\\",
                        "C:\\Windows\\System32\\",
                        "C:\\Windows\\SysWOW64\\",
                        "C:\\Windows\\WinSxS\\",
                        "C:\\Windows\\uus\\"
                    ]
                },
                "filter_main_explorer": {
                    "TargetFilename|endswith": "C:\\Windows\\explorer.exe"
                },
                "filter_main_healtray": {
                    "Image|endswith": "\\SecurityHealthSetup.exe",
                    "TargetFilename|contains": "C:\\Windows\\System32\\SecurityHealth\\",
                    "TargetFilename|endswith": "\\SecurityHealthSystray.exe"
                },
                "filter_main_msiexec": {
                    "Image|endswith": "C:\\WINDOWS\\system32\\msiexec.exe",
                    "TargetFilename|endswith": [
                        "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                        "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe"
                    ]
                },
                "filter_main_svchost": {
                    "Image|endswith": "C:\\Windows\\system32\\svchost.exe",
                    "TargetFilename|contains": "C:\\Program Files\\WindowsApps\\"
                },
                "filter_main_wuauclt": {
                    "Image|endswith": "C:\\Windows\\System32\\wuauclt.exe"
                },
                "selection": {
                    "TargetFilename|endswith": [
                        "\\AtBroker.exe",
                        "\\audiodg.exe",
                        "\\backgroundTaskHost.exe",
                        "\\bcdedit.exe",
                        "\\bitsadmin.exe",
                        "\\cmdl32.exe",
                        "\\cmstp.exe",
                        "\\conhost.exe",
                        "\\csrss.exe",
                        "\\dasHost.exe",
                        "\\dfrgui.exe",
                        "\\dllhost.exe",
                        "\\dwm.exe",
                        "\\eventcreate.exe",
                        "\\eventvwr.exe",
                        "\\explorer.exe",
                        "\\extrac32.exe",
                        "\\fontdrvhost.exe",
                        "\\ipconfig.exe",
                        "\\iscsicli.exe",
                        "\\iscsicpl.exe",
                        "\\logman.exe",
                        "\\LogonUI.exe",
                        "\\LsaIso.exe",
                        "\\lsass.exe",
                        "\\lsm.exe",
                        "\\msiexec.exe",
                        "\\msinfo32.exe",
                        "\\mstsc.exe",
                        "\\nbtstat.exe",
                        "\\odbcconf.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regini.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\RuntimeBroker.exe",
                        "\\schtasks.exe",
                        "\\SearchFilterHost.exe",
                        "\\SearchIndexer.exe",
                        "\\SearchProtocolHost.exe",
                        "\\SecurityHealthService.exe",
                        "\\SecurityHealthSystray.exe",
                        "\\services.exe",
                        "\\ShellAppRuntime.exe",
                        "\\sihost.exe",
                        "\\smartscreen.exe",
                        "\\smss.exe",
                        "\\spoolsv.exe",
                        "\\svchost.exe",
                        "\\SystemSettingsBroker.exe",
                        "\\taskhost.exe",
                        "\\taskhostw.exe",
                        "\\Taskmgr.exe",
                        "\\TiWorker.exe",
                        "\\vssadmin.exe",
                        "\\w32tm.exe",
                        "\\WerFault.exe",
                        "\\WerFaultSecure.exe",
                        "\\wermgr.exe",
                        "\\wevtutil.exe",
                        "\\wininit.exe",
                        "\\winlogon.exe",
                        "\\winrshost.exe",
                        "\\WinRTNetMUAHostServer.exe",
                        "\\wlanext.exe",
                        "\\wlrmdr.exe",
                        "\\WmiPrvSE.exe",
                        "\\wslhost.exe",
                        "\\WSReset.exe",
                        "\\WUDFHost.exe",
                        "\\WWAHost.exe"
                    ]
                }
            },
            "falsepositives": [
                "System processes copied outside their default folders for testing purposes",
                "Third party software naming their software with the same names as the processes mentioned here"
            ],
            "id": "d5866ddf-ce8f-4aea-b28e-d96485a20d3d",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "modified": "2024/06/24",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.005"
            ],
            "title": "Files With System Process Name In Unsuspected Locations"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/08/12",
            "description": "Detects Windows executables that write files with suspicious extensions",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_*",
                "filter_main_AppLockerPolicyTest": {
                    "Image": "C:\\Windows\\System32\\dllhost.exe",
                    "TargetFilename|contains|all": [
                        ":\\Users\\",
                        "\\AppData\\Local\\Temp\\__PSScriptPolicyTest_"
                    ],
                    "TargetFilename|endswith": ".ps1"
                },
                "filter_main_script_gpo_machine": {
                    "Image": "C:\\Windows\\system32\\svchost.exe",
                    "TargetFilename|contains|all": [
                        "C:\\Windows\\System32\\GroupPolicy\\DataStore\\",
                        "\\sysvol\\",
                        "\\Policies\\",
                        "\\Machine\\Scripts\\Startup\\"
                    ],
                    "TargetFilename|endswith": [
                        ".ps1",
                        ".bat"
                    ]
                },
                "selection_generic": {
                    "Image|endswith": [
                        "\\csrss.exe",
                        "\\lsass.exe",
                        "\\RuntimeBroker.exe",
                        "\\sihost.exe",
                        "\\smss.exe",
                        "\\wininit.exe",
                        "\\winlogon.exe"
                    ],
                    "TargetFilename|endswith": [
                        ".bat",
                        ".dll",
                        ".exe",
                        ".hta",
                        ".iso",
                        ".ps1",
                        ".txt",
                        ".vbe",
                        ".vbs"
                    ]
                },
                "selection_special": {
                    "Image|endswith": [
                        "\\dllhost.exe",
                        "\\rundll32.exe",
                        "\\svchost.exe"
                    ],
                    "TargetFilename|endswith": [
                        ".bat",
                        ".hta",
                        ".iso",
                        ".ps1",
                        ".vbe",
                        ".vbs"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "b8fd0e93-ff58-4cbd-8f48-1c114e342e62",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "modified": "2024/04/15",
            "related": [
                {
                    "id": "1277f594-a7d1-4f28-a2d3-73af5cbeab43",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Windows Binaries Write Suspicious Extensions"
        },
        {
            "author": "Micah Babinski, @micahbabinski",
            "date": "2023/05/08",
            "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_lower": {
                    "TargetFilename|contains": [
                        "\u0430",
                        "\u0435",
                        "\u043e",
                        "\u0440",
                        "\u0441",
                        "\u0445",
                        "\u0455",
                        "\u0456",
                        "\u04cf",
                        "\u0458",
                        "\u04bb",
                        "\u0501",
                        "\u051b",
                        "\u051d",
                        "\u03bf"
                    ]
                },
                "selection_upper": {
                    "TargetFilename|contains": [
                        "\u0410",
                        "\u0412",
                        "\u0415",
                        "\u041a",
                        "\u041c",
                        "\u041d",
                        "\u041e",
                        "\u0420",
                        "\u0421",
                        "\u0422",
                        "\u0425",
                        "\u0405",
                        "\u0406",
                        "\u0408",
                        "\u04ae",
                        "\u04c0",
                        "\u050c",
                        "\u051a",
                        "\u051c",
                        "\u0391",
                        "\u0392",
                        "\u0395",
                        "\u0396",
                        "\u0397",
                        "\u0399",
                        "\u039a",
                        "\u039c",
                        "\u039d",
                        "\u039f",
                        "\u03a1",
                        "\u03a4",
                        "\u03a5",
                        "\u03a7"
                    ]
                }
            },
            "falsepositives": [
                "File names with legitimate Cyrillic text. Will likely require tuning (or not be usable) in countries where these alphabets are in use."
            ],
            "id": "4f1707b1-b50b-45b4-b5a2-3978b5a5d0d6",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish",
                "http://www.irongeek.com/homoglyph-attack-generator.php"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1036.003"
            ],
            "title": "Potential Homoglyph Attack Using Lookalike Characters in Filename"
        },
        {
            "author": "elhoim",
            "date": "2022/04/28",
            "description": "Detects the creation of copy of suspicious files (EXE/DLL) to the default GPO storage folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "TargetFilename|contains": "\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\",
                    "TargetFilename|endswith": [
                        ".dll",
                        ".exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5f87308a-0a5b-4623-ae15-d8fa1809bc60",
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/blog/intelligence-insights-november-2021/"
            ],
            "status": "test",
            "tags": [
                "attack.t1036.005",
                "attack.defense_evasion"
            ],
            "title": "Suspicious Files in Default GPO Folder"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2022/06/19",
            "description": "Detects dropped files with double extensions, which is often used by malware as a method to abuse the fact that Windows hide default extensions by default.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_exe": {
                    "TargetFilename|endswith": [
                        ".rar.exe",
                        ".zip.exe"
                    ]
                },
                "selection_gen": {
                    "TargetFilename|contains": [
                        ".doc.",
                        ".docx.",
                        ".jpg.",
                        ".pdf.",
                        ".ppt.",
                        ".pptx.",
                        ".xls.",
                        ".xlsx."
                    ],
                    "TargetFilename|endswith": [
                        ".exe",
                        ".iso",
                        ".rar",
                        ".zip"
                    ]
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "b4926b47-a9d7-434c-b3a0-adc3fa0bd13e",
            "level": "high",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2022/11/07",
            "references": [
                "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/",
                "https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations",
                "https://www.cybereason.com/blog/research/a-bazar-of-tricks-following-team9s-development-cycles",
                "https://twitter.com/malwrhunterteam/status/1235135745611960321",
                "https://twitter.com/luc4m/status/1073181154126254080"
            ],
            "related": [
                {
                    "id": "1cdd9a09-06c9-4769-99ff-626e2b3991b8",
                    "type": "derived"
                },
                {
                    "id": "3215aa19-f060-4332-86d5-5602511f3ca8",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.007"
            ],
            "title": "Suspicious Double Extension Files"
        },
        {
            "id": "3215aa19-f060-4332-86d5-5602511f3ca8",
            "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
            "date": "2022/11/07",
            "description": "Detects the creation of files with an \"LNK\" as a second extension. This is sometimes used by malware as a method to abuse the fact that Windows hides the \"LNK\" extension by default.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_recent": {
                    "TargetFilename|contains": "\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\"
                },
                "filter_optional_office_excel": {
                    "Image|endswith": "\\excel.exe",
                    "TargetFilename|contains": "\\AppData\\Roaming\\Microsoft\\Excel"
                },
                "filter_optional_office_powerpoint": {
                    "Image|endswith": "\\powerpnt.exe",
                    "TargetFilename|contains": "\\AppData\\Roaming\\Microsoft\\PowerPoint"
                },
                "filter_optional_office_recent": {
                    "Image|endswith": [
                        "\\excel.exe",
                        "\\powerpnt.exe",
                        "\\winword.exe"
                    ],
                    "TargetFilename|contains": "\\AppData\\Roaming\\Microsoft\\Office\\Recent\\"
                },
                "filter_optional_office_word": {
                    "Image|endswith": "\\winword.exe",
                    "TargetFilename|contains": "\\AppData\\Roaming\\Microsoft\\Word"
                },
                "selection": {
                    "TargetFilename|contains": [
                        ".doc.",
                        ".docx.",
                        ".jpg.",
                        ".pdf.",
                        ".ppt.",
                        ".pptx.",
                        ".xls.",
                        ".xlsx."
                    ],
                    "TargetFilename|endswith": ".lnk"
                }
            },
            "falsepositives": [
                "Some tuning is required for other general purpose directories of third party apps"
            ],
            "level": "medium",
            "logsource": {
                "category": "file_event",
                "product": "windows"
            },
            "modified": "2023/10/18",
            "status": "experimental",
            "references": [
                "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/",
                "https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations",
                "https://www.cybereason.com/blog/research/a-bazar-of-tricks-following-team9s-development-cycles",
                "https://twitter.com/malwrhunterteam/status/1235135745611960321",
                "https://twitter.com/luc4m/status/1073181154126254080"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "b4926b47-a9d7-434c-b3a0-adc3fa0bd13e"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.007"
            ],
            "title": "Suspicious LNK Double Extension File Created"
        },
        {
            "author": "Florian Roth (Nextron Systems), Modexp, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/02/18",
            "description": "Detects a process memory dump via \"comsvcs.dll\" using rundll32, covering multiple different techniques (ordinal, minidump function, etc.)",
            "detection": {
                "condition": "(selection_img and 1 of selection_cli_*) or selection_generic",
                "selection_cli_1": {
                    "CommandLine|contains": [
                        "#-",
                        "#+",
                        "#24",
                        "24 ",
                        "MiniDump"
                    ],
                    "CommandLine|contains|all": [
                        "comsvcs",
                        "full"
                    ]
                },
                "selection_generic": {
                    "CommandLine|contains": [
                        " #",
                        ",#",
                        ", #"
                    ],
                    "CommandLine|contains|all": [
                        "24",
                        "comsvcs",
                        "full"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\rundll32.exe"
                    },
                    {
                        "OriginalFileName": "RUNDLL32.EXE"
                    },
                    {
                        "CommandLine|contains": "rundll32"
                    }
                ]
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "646ea171-dded-4578-8a4d-65e9822892e3",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/16",
            "references": [
                "https://twitter.com/shantanukhande/status/1229348874298388484",
                "https://twitter.com/pythonresponder/status/1385064506049630211?s=21",
                "https://twitter.com/Hexacorn/status/1224848930795552769",
                "https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/",
                "https://twitter.com/SBousseaden/status/1167417096374050817",
                "https://twitter.com/Wietze/status/1542107456507203586",
                "https://github.com/Hackndo/lsassy/blob/14d8f8ae596ecf22b449bfe919829173b8a07635/lsassy/dumpmethod/comsvcs.py"
            ],
            "related": [
                {
                    "id": "09e6d5c0-05b8-4ff8-9eeb-043046ec774c",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.credential_access",
                "attack.t1036",
                "attack.t1003.001",
                "car.2013-05-009"
            ],
            "title": "Process Memory Dump Via Comsvcs.DLL"
        },
        {
            "author": "X__Junior (Nextron Systems)",
            "date": "2023/06/30",
            "description": "Detects execution of \"WerFault.exe\" with the \"-pr\" commandline flag that is used to run files stored in the ReflectDebugger key which could be used to store the path to the malware in order to masquerade the execution flow",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": " -pr "
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\WerFault.exe"
                    },
                    {
                        "OriginalFileName": "WerFault.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html",
                "https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/"
            ],
            "related": [
                {
                    "id": "0cf2e1c6-8d10-4273-8059-738778f981ad",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Potential ReflectDebugger Content Execution Via WerFault.EXE"
        },
        {
            "author": "juju4, Jonhnathan Ribeiro, oscd.community",
            "date": "2019/01/16",
            "description": "Detects suspicious process run from unusual locations",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|contains": [
                            ":\\RECYCLER\\",
                            ":\\SystemVolumeInformation\\"
                        ]
                    },
                    {
                        "Image|startswith": [
                            "C:\\Windows\\Tasks\\",
                            "C:\\Windows\\debug\\",
                            "C:\\Windows\\fonts\\",
                            "C:\\Windows\\help\\",
                            "C:\\Windows\\drivers\\",
                            "C:\\Windows\\addins\\",
                            "C:\\Windows\\cursors\\",
                            "C:\\Windows\\system32\\tasks\\"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "False positives depend on scripts and administrative tools used in the monitored environment"
            ],
            "id": "15b75071-74cc-47e0-b4c6-b43744a62a2b",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/01/07",
            "references": [
                "https://car.mitre.org/wiki/CAR-2013-05-002"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "car.2013-05-002"
            ],
            "title": "Suspicious Process Start Locations"
        },
        {
            "author": "Matthew Green @mgreen27, Ecco, James Pemberton @4A616D6573, oscd.community, Andreas Hunkeler (@Karneades)",
            "date": "2019/06/15",
            "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\conhost.exe",
                        "\\7z.exe",
                        "\\WinRAR.exe",
                        "\\wevtutil.exe",
                        "\\net.exe",
                        "\\net1.exe",
                        "\\netsh.exe",
                        "\\InstallUtil.exe"
                    ]
                },
                "selection": {
                    "OriginalFileName": [
                        "Cmd.Exe",
                        "CONHOST.EXE",
                        "7z.exe",
                        "WinRAR.exe",
                        "wevtutil.exe",
                        "net.exe",
                        "net1.exe",
                        "netsh.exe",
                        "InstallUtil.exe"
                    ]
                }
            },
            "falsepositives": [
                "Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist"
            ],
            "id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/01/18",
            "references": [
                "https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html",
                "https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html",
                "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1036.003/T1036.003.md#atomic-test-1---masquerading-as-windows-lsass-process"
            ],
            "related": [
                {
                    "id": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Potential Defense Evasion Via Binary Rename"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file to a suspicious target folder",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_folder": {
                    "CommandLine|contains": [
                        ":\\Perflogs",
                        ":\\ProgramData\\",
                        ":\\Temp\\",
                        ":\\Users\\Public\\",
                        ":\\Windows\\",
                        "\\AppData\\Local\\Temp\\",
                        "\\AppData\\Roaming\\",
                        "\\Desktop\\",
                        "%ProgramData%",
                        "%public%"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "2ddef153-167b-4e89-86b6-757a9e65dcac",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/30",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File Download Via Bitsadmin To A Suspicious Target Folder"
        },
        {
            "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/01/06",
            "description": "Detect execution of suspicious double extension files in ParentCommandLine",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "ParentImage|endswith": [
                            ".doc.lnk",
                            ".docx.lnk",
                            ".xls.lnk",
                            ".xlsx.lnk",
                            ".ppt.lnk",
                            ".pptx.lnk",
                            ".rtf.lnk",
                            ".pdf.lnk",
                            ".txt.lnk",
                            ".doc.js",
                            ".docx.js",
                            ".xls.js",
                            ".xlsx.js",
                            ".ppt.js",
                            ".pptx.js",
                            ".rtf.js",
                            ".pdf.js",
                            ".txt.js"
                        ]
                    },
                    {
                        "ParentCommandLine|contains": [
                            ".doc.lnk",
                            ".docx.lnk",
                            ".xls.lnk",
                            ".xlsx.lnk",
                            ".ppt.lnk",
                            ".pptx.lnk",
                            ".rtf.lnk",
                            ".pdf.lnk",
                            ".txt.lnk",
                            ".doc.js",
                            ".docx.js",
                            ".xls.js",
                            ".xlsx.js",
                            ".ppt.js",
                            ".pptx.js",
                            ".rtf.js",
                            ".pdf.js",
                            ".txt.js"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5e6a80c8-2d45-4633-9ef4-fa2671a39c5c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/28",
            "references": [
                "https://www.virustotal.com/gui/file/7872d8845a332dce517adae9c3389fde5313ff2fed38c2577f3b498da786db68/behavior",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bluebottle-banks-targeted-africa"
            ],
            "related": [
                {
                    "id": "1cdd9a09-06c9-4769-99ff-626e2b3991b8",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.007"
            ],
            "title": "Suspicious Parent Double Extension File Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/03/18",
            "description": "Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "\\taskmgr.exe",
                    "User|contains": [
                        "AUTHORI",
                        "AUTORI"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "9fff585c-c33e-4a86-b3cd-39312079a65f",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "modified": "2022/05/27",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Taskmgr as LOCAL_SYSTEM"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/03/13",
            "description": "Detects the creation of a process via the Windows task manager. This might be an attempt to bypass UAC",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "Image|endswith": [
                        ":\\Windows\\System32\\mmc.exe",
                        ":\\Windows\\System32\\resmon.exe",
                        ":\\Windows\\System32\\Taskmgr.exe"
                    ]
                },
                "selection": {
                    "ParentImage|endswith": "\\taskmgr.exe"
                }
            },
            "falsepositives": [
                "Administrative activity"
            ],
            "id": "3d7679bd-0c00-440c-97b0-3f204273e6c7",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/18",
            "references": [
                "https://twitter.com/ReneFreingruber/status/1172244989335810049"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "New Process Created Via Taskmgr.EXE"
        },
        {
            "author": "Christian Burkard (Nextron Systems)",
            "date": "2021/10/26",
            "description": "Detects potential evasion or obfuscation attempts using bogus path traversal via the commandline",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_optional_*",
                "filter_optional_citrix": {
                    "CommandLine|contains": "\\Citrix\\Virtual Smart Card\\Citrix.Authentication.VirtualSmartcard.Launcher.exe\\..\\"
                },
                "filter_optional_google_drive": {
                    "CommandLine|contains": "\\Google\\Drive\\googledrivesync.exe\\..\\"
                },
                "selection_1": {
                    "CommandLine|contains": [
                        "\\..\\Windows\\",
                        "\\..\\System32\\",
                        "\\..\\..\\"
                    ],
                    "Image|contains": "\\Windows\\"
                },
                "selection_2": {
                    "CommandLine|contains": ".exe\\..\\"
                }
            },
            "falsepositives": [
                "Google Drive",
                "Citrix"
            ],
            "id": "1327381e-6ab0-4f38-b583-4c1b8346a56b",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/29",
            "references": [
                "https://twitter.com/hexacorn/status/1448037865435320323",
                "https://twitter.com/Gal_B1t/status/1062971006078345217"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Potential Command Line Path Traversal Evasion Attempt"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file using an URL that contains an IP",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "filter_seven_zip": {
                    "CommandLine|contains": "://7-"
                },
                "selection_extension": {
                    "CommandLine|contains": [
                        "://1",
                        "://2",
                        "://3",
                        "://4",
                        "://5",
                        "://6",
                        "://7",
                        "://8",
                        "://9"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "99c840f2-2012-46fd-9141-c761987550ef",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
            ],
            "modified": "2023/02/15",
            "status": "test",
            "related": [
                {
                    "id": "90f138c1-f578-4ac3-8c49-eecfd847c8b7",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "Suspicious Download From Direct IP Via Bitsadmin"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2023/08/29",
            "description": "Detects a suspicious copy operation that tries to copy a known LOLBIN from system (System32, SysWOW64, WinSxS) directories to another on disk in order to bypass detections based on locations.\n",
            "detection": {
                "condition": "1 of selection_tools_* and all of selection_target_*",
                "selection_target_lolbin": {
                    "CommandLine|contains": [
                        "\\bitsadmin.exe",
                        "\\calc.exe",
                        "\\certutil.exe",
                        "\\cmdl32.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\rundll32.exe",
                        "\\wscript.exe"
                    ]
                },
                "selection_target_path": {
                    "CommandLine|contains": [
                        "\\System32",
                        "\\SysWOW64",
                        "\\WinSxS"
                    ]
                },
                "selection_tools_cmd": {
                    "CommandLine|contains": "copy ",
                    "Image|endswith": "\\cmd.exe"
                },
                "selection_tools_other": [
                    {
                        "Image|endswith": [
                            "\\robocopy.exe",
                            "\\xcopy.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "robocopy.exe",
                            "XCOPY.EXE"
                        ]
                    }
                ],
                "selection_tools_pwsh": {
                    "CommandLine|contains": [
                        "copy-item",
                        " copy ",
                        "cpi ",
                        " cp "
                    ],
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f5d19838-41b5-476c-98d8-ba8af4929ee2",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120",
                "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
                "https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/"
            ],
            "related": [
                {
                    "id": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
                    "type": "derived"
                }
            ],
            "status": "test",
            "title": "LOL-Binary Copied From System Directory",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/10/14",
            "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) child process",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_rundll32": {
                    "Image|endswith": "\\rundll32.exe",
                    "CommandLine|contains|all": [
                        "C:\\Windows\\system32\\WerConCpl.dll",
                        "LaunchErcApp -queuereporting"
                    ]
                },
                "selection": {
                    "Image|endswith": [
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\ipconfig.exe",
                        "\\mshta.exe",
                        "\\net.exe",
                        "\\net1.exe",
                        "\\netstat.exe",
                        "\\nslookup.exe",
                        "\\powershell_ise.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\systeminfo.exe",
                        "\\whoami.exe",
                        "\\wscript.exe"
                    ],
                    "ParentImage|endswith": "\\wermgr.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "396f6630-f3ac-44e3-bfc8-1b161bc00c4e",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/20",
            "status": "experimental",
            "references": [
                "https://www.trendmicro.com/en_us/research/22/j/black-basta-infiltrates-networks-via-qakbot-brute-ratel-and-coba.html",
                "https://www.echotrail.io/insights/search/wermgr.exe",
                "https://github.com/binderlabs/DirCreate2System"
            ],
            "related": [
                {
                    "id": "5394fcc7-aeb2-43b5-9a09-cac9fc5edcd5",
                    "type": "similar"
                }
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.privilege_escalation",
                "attack.t1055",
                "attack.t1036"
            ],
            "title": "Suspicious Child Process Of Wermgr.EXE"
        },
        {
            "author": "Florian Roth (Nextron Systems), Patrick Bareiss, Anton Kutepov, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
            "date": "2017/11/27",
            "description": "Detects the execution of a Windows system binary that is usually located in the system folder from an uncommon location.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_generic": {
                    "Image|startswith": [
                        "C:\\$WINDOWS.~BT\\",
                        "C:\\$WinREAgent\\",
                        "C:\\Windows\\SoftwareDistribution\\",
                        "C:\\Windows\\System32\\",
                        "C:\\Windows\\SystemTemp\\",
                        "C:\\Windows\\SysWOW64\\",
                        "C:\\Windows\\uus\\",
                        "C:\\Windows\\WinSxS\\"
                    ]
                },
                "filter_main_powershell": {
                    "Image": [
                        "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                        "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe"
                    ]
                },
                "filter_main_wsl_windowsapps": {
                    "Image|endswith": "\\wsl.exe",
                    "Image|startswith": "C:\\Program Files\\WindowsApps\\MicrosoftCorporationII.WindowsSubsystemForLinux"
                },
                "filter_optional_system32": {
                    "Image|contains": "\\SystemRoot\\System32\\"
                },
                "selection": {
                    "Image|endswith": [
                        "\\atbroker.exe",
                        "\\audiodg.exe",
                        "\\bcdedit.exe",
                        "\\bitsadmin.exe",
                        "\\certreq.exe",
                        "\\certutil.exe",
                        "\\cmstp.exe",
                        "\\conhost.exe",
                        "\\consent.exe",
                        "\\cscript.exe",
                        "\\csrss.exe",
                        "\\dashost.exe",
                        "\\defrag.exe",
                        "\\dfrgui.exe",
                        "\\dism.exe",
                        "\\dllhost.exe",
                        "\\dllhst3g.exe",
                        "\\dwm.exe",
                        "\\eventvwr.exe",
                        "\\logonui.exe",
                        "\\LsaIso.exe",
                        "\\lsass.exe",
                        "\\lsm.exe",
                        "\\msiexec.exe",
                        "\\ntoskrnl.exe",
                        "\\powershell_ise.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\runonce.exe",
                        "\\RuntimeBroker.exe",
                        "\\schtasks.exe",
                        "\\services.exe",
                        "\\sihost.exe",
                        "\\smartscreen.exe",
                        "\\smss.exe",
                        "\\spoolsv.exe",
                        "\\svchost.exe",
                        "\\taskhost.exe",
                        "\\Taskmgr.exe",
                        "\\userinit.exe",
                        "\\wininit.exe",
                        "\\winlogon.exe",
                        "\\winver.exe",
                        "\\wlanext.exe",
                        "\\wscript.exe",
                        "\\wsl.exe",
                        "\\wsmprovhost.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e4a6b256-3e47-40fc-89d2-7a477edd6915",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/07/16",
            "status": "experimental",
            "references": [
                "https://twitter.com/GelosSnake/status/934900723426439170",
                "https://asec.ahnlab.com/en/39828/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "System File Execution Location Anomaly"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/02/26",
            "description": "Detects suspicious Windows Update Agent activity in which a wuauclt.exe process command line doesn't contain any command line flags\n",
            "detection": {
                "condition": "all of selection*",
                "selection_cli": {
                    "CommandLine|endswith": [
                        "Wuauclt",
                        "Wuauclt.exe"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\Wuauclt.exe"
                    },
                    {
                        "OriginalFileName": "Wuauclt.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "52d097e2-063e-4c9c-8fbb-855c8948d135",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/11",
            "references": [
                "https://redcanary.com/blog/blackbyte-ransomware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Suspicious Windows Update Agent Empty Cmdline"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2024/01/17",
            "description": "Detects a CodePage modification using the \"mode.com\" utility to Russian language.\nThis behavior has been used by threat actors behind Dharma ransomware.\n",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains|all": [
                        " con ",
                        " cp ",
                        " select="
                    ],
                    "CommandLine|endswith": [
                        "=1251",
                        "=866"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\mode.com"
                    },
                    {
                        "OriginalFileName": "MODE.COM"
                    }
                ]
            },
            "falsepositives": [
                "Russian speaking people changing the CodePage"
            ],
            "id": "12fbff88-16b5-4b42-9754-cd001a789fb3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers",
                "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/mode",
                "https://strontic.github.io/xcyclopedia/library/mode.com-59D1ED51ACB8C3D50F1306FD75F20E99.html",
                "https://www.virustotal.com/gui/file/5e75ef02517afd6e8ba6462b19217dc4a5a574abb33d10eb0f2bab49d8d48c22/behavior"
            ],
            "related": [
                {
                    "id": "d48c5ffa-3b02-4c0f-9a9e-3c275650dd0e",
                    "type": "derived"
                }
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "CodePage Modification Via MODE.COM To Russian Language"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file to uncommon target folder",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_folder": {
                    "CommandLine|contains": [
                        "%AppData%",
                        "%temp%",
                        "%tmp%",
                        "\\AppData\\Local\\",
                        "C:\\Windows\\Temp\\"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "6e30c82f-a9f8-4aab-b79c-7c12bce6f248",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
            ],
            "modified": "2023/02/15",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File Download Via Bitsadmin To An Uncommon Target Folder"
        },
        {
            "author": "Max Altgelt (Nextron Systems)",
            "date": "2022/06/02",
            "description": "Detects process creation with a renamed BrowserCore.exe (used to extract Azure tokens)",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_realbrowsercore": {
                    "Image|endswith": "\\BrowserCore.exe"
                },
                "selection": {
                    "OriginalFileName": "BrowserCore.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "8a4519e8-e64a-40b6-ae85-ba8ad2177559",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://twitter.com/mariuszbit/status/1531631015139102720"
            ],
            "status": "test",
            "tags": [
                "attack.t1528",
                "attack.t1036.003"
            ],
            "title": "Renamed BrowserCore.EXE Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file from a suspicious domain",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_domain": {
                    "CommandLine|contains": [
                        ".githubusercontent.com",
                        "anonfiles.com",
                        "cdn.discordapp.com",
                        "cdn.discordapp.com/attachments/",
                        "ddns.net",
                        "dl.dropboxusercontent.com",
                        "ghostbin.co",
                        "glitch.me",
                        "gofile.io",
                        "hastebin.com",
                        "mediafire.com",
                        "mega.nz",
                        "onrender.com",
                        "paste.ee",
                        "pastebin.com",
                        "pastebin.pl",
                        "pastetext.net",
                        "privatlab.com",
                        "privatlab.net",
                        "send.exploit.in",
                        "sendspace.com",
                        "storage.googleapis.com",
                        "storjshare.io",
                        "supabase.co",
                        "temp.sh",
                        "transfer.sh",
                        "ufile.io"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Some legitimate apps use this, but limited."
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "status": "experimental",
            "modified": "2024/02/09",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
                "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
                "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
                "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
            ],
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "Suspicious Download From File-Sharing Website Via Bitsadmin"
        },
        {
            "author": "Trent Liffick",
            "date": "2020/05/01",
            "description": "Detects usage of findstr to identify and execute a lnk file as seen within the HHS redirect attack",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|endswith": [
                        ".lnk",
                        ".lnk\"",
                        ".lnk'"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\find.exe",
                            "\\findstr.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "FIND.EXE",
                            "FINDSTR.EXE"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "33339be3-148b-4e16-af56-ad16ec6c7e7b",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/01/15",
            "references": [
                "https://www.bleepingcomputer.com/news/security/hhsgov-open-redirect-used-by-coronavirus-phishing-to-spread-malware/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1202",
                "attack.t1027.003"
            ],
            "title": "Findstr Launching .lnk File"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/01/04",
            "description": "Detects uses of the createdump.exe LOLOBIN utility to dump process memory",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        " -u ",
                        " --full ",
                        " -f ",
                        " --name ",
                        ".dmp "
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\createdump.exe"
                    },
                    {
                        "OriginalFileName": "FX_VER_INTERNALNAME_STR"
                    }
                ]
            },
            "falsepositives": [
                "Command lines that use the same flags"
            ],
            "id": "515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/08/19",
            "references": [
                "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
                "https://twitter.com/bopin2020/status/1366400799199272960"
            ],
            "related": [
                {
                    "id": "1a1ed54a-2ba4-4221-94d5-01dee560d71e",
                    "type": "similar"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ],
            "title": "CreateDump Process Dump"
        },
        {
            "id": "1a1ed54a-2ba4-4221-94d5-01dee560d71e",
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/09/20",
            "description": "Detects uses of a renamed legitimate createdump.exe LOLOBIN utility to dump process memory",
            "detection": {
                "condition": "1 of selection_* and not filter",
                "filter": {
                    "Image|endswith": "\\createdump.exe"
                },
                "selection_cli": [
                    {
                        "CommandLine|contains|all": [
                            " -u ",
                            " -f ",
                            ".dmp"
                        ]
                    },
                    {
                        "CommandLine|contains|all": [
                            " --full ",
                            " --name ",
                            ".dmp"
                        ]
                    }
                ],
                "selection_pe": {
                    "OriginalFileName": "FX_VER_INTERNALNAME_STR"
                }
            },
            "falsepositives": [
                "Command lines that use the same flags"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/14",
            "references": [
                "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
                "https://twitter.com/bopin2020/status/1366400799199272960"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ],
            "title": "Renamed CreateDump Utility Execution"
        },
        {
            "id": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
            "author": "Matthew Green - @mgreen27, Florian Roth (Nextron Systems), frack113",
            "date": "2019/06/15",
            "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": [
                        "\\certutil.exe",
                        "\\cmstp.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\msiexec.exe",
                        "\\powershell_ise.exe",
                        "\\powershell.exe",
                        "\\psexec.exe",
                        "\\psexec64.exe",
                        "\\PSEXESVC.exe",
                        "\\pwsh.exe",
                        "\\reg.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\wermgr.exe",
                        "\\wmic.exe",
                        "\\wscript.exe"
                    ]
                },
                "selection": [
                    {
                        "Description": "Execute processes remotely"
                    },
                    {
                        "Product": "Sysinternals PsExec"
                    },
                    {
                        "Description|startswith": [
                            "Windows PowerShell",
                            "pwsh"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "certutil.exe",
                            "cmstp.exe",
                            "cscript.exe",
                            "mshta.exe",
                            "msiexec.exe",
                            "powershell_ise.exe",
                            "powershell.exe",
                            "psexec.c",
                            "psexec.exe",
                            "psexesvc.exe",
                            "pwsh.dll",
                            "reg.exe",
                            "regsvr32.exe",
                            "rundll32.exe",
                            "WerMgr",
                            "wmic.exe",
                            "wscript.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist",
                "PsExec installed via Windows Store doesn't contain original filename field (False negative)"
            ],
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/08/23",
            "references": [
                "https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html",
                "https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html",
                "https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks",
                "https://twitter.com/christophetd/status/1164506034720952320",
                "https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/"
            ],
            "related": [
                {
                    "type": "similar",
                    "id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142"
                },
                {
                    "id": "2569ed8c-1147-498a-9b8c-2ad3656b10ed",
                    "type": "derived"
                },
                {
                    "id": "a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2",
                    "type": "obsoletes"
                },
                {
                    "id": "d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20",
                    "type": "obsoletes"
                },
                {
                    "id": "d4d2574f-ac17-4d9e-b986-aeeae0dc8fe2",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003",
                "car.2013-05-009"
            ],
            "title": "Potential Defense Evasion Via Rename Of Highly Relevant Binaries"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/04/06",
            "description": "Detects suspicious ways to use the \"DumpMinitool.exe\" binary",
            "detection": {
                "cmd_has_flags": {
                    "CommandLine|contains": [
                        " Full",
                        " Mini",
                        " WithHeap"
                    ]
                },
                "condition": "selection and ( ( not filter_folder ) or susp_flags or ( cmd_has_flags and not filter_cmd_misses_flags ) )",
                "filter_cmd_misses_flags": {
                    "CommandLine|contains": "--dumpType"
                },
                "filter_folder": {
                    "Image|contains": [
                        "\\Microsoft Visual Studio\\",
                        "\\Extensions\\"
                    ]
                },
                "selection": [
                    {
                        "Image|endswith": [
                            "\\DumpMinitool.exe",
                            "\\DumpMinitool.x86.exe",
                            "\\DumpMinitool.arm64.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "DumpMinitool.exe",
                            "DumpMinitool.x86.exe",
                            "DumpMinitool.arm64.exe"
                        ]
                    }
                ],
                "susp_flags": {
                    "CommandLine|contains": ".txt"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "eb1c4225-1c23-4241-8dd4-051389fde4ce",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "references": [
                "https://twitter.com/mrd0x/status/1511415432888131586",
                "https://twitter.com/mrd0x/status/1511489821247684615",
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/"
            ],
            "status": "test",
            "title": "Suspicious DumpMinitool Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Micah Babinski, @micahbabinski",
            "date": "2023/02/15",
            "description": "Detects the presence of the \"u202+E\" character, which causes a terminal, browser, or operating system to render text in a right-to-left sequence.\nThis is used as an obfuscation and masquerading techniques.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|contains": "\u202e"
                }
            },
            "falsepositives": [
                "Commandlines that contains scriptures such as arabic or hebrew might make use of this character"
            ],
            "id": "ad691d92-15f2-4181-9aa4-723c74f9ddc3",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/blog/right-to-left-override/",
                "https://www.malwarebytes.com/blog/news/2014/01/the-rtlo-method",
                "https://unicode-explorer.com/c/202E"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.002"
            ],
            "title": "Potential Defense Evasion Via Right-to-Left Override"
        },
        {
            "author": "pH-T (Nextron Systems)",
            "date": "2022/06/03",
            "description": "Detects the execution of a renamed \"Msdt.exe\" binary",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": "\\msdt.exe"
                },
                "selection": {
                    "OriginalFileName": "msdt.exe"
                }
            },
            "falsepositives": [
                "Unlikely"
            ],
            "id": "bd1c6866-65fc-44b2-be51-5588fcff82b9",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://lolbas-project.github.io/lolbas/Binaries/Msdt/"
            ],
            "status": "test",
            "title": "Renamed Msdt.EXE Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "id": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
            "author": "Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/07/03",
            "description": "Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\nOften used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\n",
            "detection": {
                "condition": "1 of selection_* and target",
                "selection_cmd": {
                    "CommandLine|contains": "copy ",
                    "Image|endswith": "\\cmd.exe"
                },
                "selection_other": [
                    {
                        "Image|endswith": [
                            "\\robocopy.exe",
                            "\\xcopy.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "robocopy.exe",
                            "XCOPY.EXE"
                        ]
                    }
                ],
                "selection_pwsh": {
                    "CommandLine|contains": [
                        "copy-item",
                        " copy ",
                        "cpi ",
                        " cp "
                    ],
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe"
                    ]
                },
                "target": {
                    "CommandLine|contains": [
                        "\\System32",
                        "\\SysWOW64",
                        "\\WinSxS"
                    ]
                }
            },
            "falsepositives": [
                "Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)",
                "When cmd.exe and xcopy.exe are called directly",
                "When the command contains the keywords but not in the correct order"
            ],
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120",
                "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
                "https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/"
            ],
            "modified": "2023/08/29",
            "related": [
                {
                    "id": "855bc8b5-2ae8-402e-a9ed-b889e6df1900",
                    "type": "derived"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Suspicious Copy From or To System Directory"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/21",
            "description": "Detects suspicious parent processes that should not have any children or should only have a single possible child program",
            "detection": {
                "condition": "selection or ( selection_special and not 1 of filter_* )",
                "filter_null": {
                    "Image": null
                },
                "filter_special": {
                    "Image|endswith": [
                        "\\WerFault.exe",
                        "\\wermgr.exe",
                        "\\conhost.exe",
                        "\\mmc.exe",
                        "\\win32calc.exe",
                        "\\notepad.exe"
                    ]
                },
                "selection": {
                    "ParentImage|endswith": [
                        "\\minesweeper.exe",
                        "\\winver.exe",
                        "\\bitsadmin.exe"
                    ]
                },
                "selection_special": {
                    "ParentImage|endswith": [
                        "\\csrss.exe",
                        "\\certutil.exe",
                        "\\eventvwr.exe",
                        "\\calc.exe",
                        "\\notepad.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "cbec226f-63d9-4eca-9f52-dfb6652f24df",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/09/08",
            "references": [
                "https://twitter.com/x86matthew/status/1505476263464607744?s=12",
                "https://svch0st.medium.com/stats-from-hunting-cobalt-strike-beacons-c17e56255f9b"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Suspicious Process Parents"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2018/10/30",
            "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process.\nThis way we are also able to catch cases in which the attacker has renamed the procdump executable.\n",
            "detection": {
                "condition": "all of selection*",
                "selection_flags": {
                    "CommandLine|contains|windash": " -ma "
                },
                "selection_process": {
                    "CommandLine|contains": " ls"
                }
            },
            "falsepositives": [
                "Unlikely, because no one should dump an lsass process memory",
                "Another tool that uses command line flags similar to ProcDump"
            ],
            "id": "5afee48e-67dd-4e03-a783-f74259dcf998",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/03/13",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
            ],
            "status": "stable",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.credential_access",
                "attack.t1003.001",
                "car.2013-05-009"
            ],
            "title": "Potential LSASS Process Dump Via Procdump"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2020/01/28",
            "description": "Detects a renamed \"dctask64.exe\" execution, a signed binary by ZOHO Corporation part of ManageEngine Endpoint Central.\nThis binary can be abused for DLL injection, arbitrary command and process execution.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_legit_name": {
                    "Image|endswith": "\\dctask64.exe"
                },
                "selection": {
                    "Hashes|contains": [
                        "6834B1B94E49701D77CCB3C0895E1AFD",
                        "1BB6F93B129F398C7C4A76BB97450BBA",
                        "FAA2AC19875FADE461C8D89DCF2710A3",
                        "F1039CED4B91572AB7847D26032E6BBF"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "340a090b-c4e9-412e-bb36-b4b16fe96f9b",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/04/22",
            "references": [
                "https://twitter.com/gN3mes1s/status/1222088214581825540",
                "https://twitter.com/gN3mes1s/status/1222095963789111296",
                "https://twitter.com/gN3mes1s/status/1222095371175911424"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1055.001",
                "attack.t1202",
                "attack.t1218"
            ],
            "title": "Renamed ZOHO Dctask64 Execution"
        },
        {
            "author": "Nextron Systems",
            "date": "2022/06/01",
            "description": "Detects sdiagnhost.exe calling a suspicious child process (e.g. used in exploits for Follina / CVE-2022-30190)",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\cmd.exe",
                        "\\mshta.exe",
                        "\\cscript.exe",
                        "\\wscript.exe",
                        "\\taskkill.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\calc.exe"
                    ],
                    "ParentImage|endswith": "\\sdiagnhost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f3d39c45-de1a-4486-a687-ab126124f744",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/10/31",
            "references": [
                "https://twitter.com/nao_sec/status/1530196847679401984",
                "https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/",
                "https://app.any.run/tasks/f420d295-0457-4e9b-9b9e-6732be227583/",
                "https://app.any.run/tasks/c4117d9a-f463-461a-b90f-4cd258746798/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1218"
            ],
            "title": "Sdiagnhost Calling Suspicious Child Process"
        },
        {
            "author": "Micah Babinski",
            "date": "2022/12/11",
            "description": "Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion.",
            "detection": {
                "condition": "all of selection_*",
                "selection_attributes": {
                    "CommandLine|contains": [
                        "OriginalFileName",
                        "CompanyName",
                        "FileDescription",
                        "ProductName",
                        "ProductVersion",
                        "LegalCopyright"
                    ]
                },
                "selection_flags": {
                    "CommandLine|contains": "--set-"
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\rcedit-x64.exe",
                            "\\rcedit-x86.exe"
                        ]
                    },
                    {
                        "Description": "Edit resources of exe"
                    },
                    {
                        "Product": "rcedit"
                    }
                ]
            },
            "falsepositives": [
                "Legitimate use of the tool by administrators or users to update metadata of a binary"
            ],
            "id": "0c92f2e6-f08f-4b73-9216-ecb0ca634689",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/05",
            "references": [
                "https://security.stackexchange.com/questions/210843/is-it-possible-to-change-original-filename-of-an-exe",
                "https://www.virustotal.com/gui/file/02e8e8c5d430d8b768980f517b62d7792d690982b9ba0f7e04163cbc1a6e7915",
                "https://github.com/electron/rcedit"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003",
                "attack.t1036",
                "attack.t1027.005",
                "attack.t1027"
            ],
            "title": "PUA - Potential PE Metadata Tamper Using Rcedit"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/11/14",
            "description": "Detects the execution of msiexec.exe from an uncommon directory",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|startswith": [
                        "C:\\Windows\\System32\\",
                        "C:\\Windows\\SysWOW64\\",
                        "C:\\Windows\\WinSxS\\"
                    ]
                },
                "selection": [
                    {
                        "Image|endswith": "\\msiexec.exe"
                    },
                    {
                        "OriginalFileName": "\\msiexec.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/21",
            "references": [
                "https://twitter.com/200_okay_/status/1194765831911215104"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.005"
            ],
            "title": "Potential MsiExec Masquerading"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/28",
            "description": "Detects usage of bitsadmin downloading a file with a suspicious extension",
            "detection": {
                "condition": "all of selection_*",
                "selection_flags": {
                    "CommandLine|contains": [
                        " /transfer ",
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_extension": {
                    "CommandLine|contains": [
                        ".7z",
                        ".asax",
                        ".ashx",
                        ".asmx",
                        ".asp",
                        ".aspx",
                        ".bat",
                        ".cfm",
                        ".cgi",
                        ".chm",
                        ".cmd",
                        ".dll",
                        ".gif",
                        ".jpeg",
                        ".jpg",
                        ".jsp",
                        ".jspx",
                        ".log",
                        ".png",
                        ".ps1",
                        ".psm1",
                        ".rar",
                        ".scf",
                        ".sct",
                        ".txt",
                        ".vbe",
                        ".vbs",
                        ".war",
                        ".wsf",
                        ".wsh",
                        ".xll",
                        ".zip"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "5b80a791-ad9b-4b75-bcc1-ad4e1e89c200",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/30",
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File With Suspicious Extension Downloaded Via Bitsadmin"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems)",
            "date": "2022/06/06",
            "description": "Detects the execution of a renamed version of the Plink binary",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": "\\plink.exe"
                },
                "selection": [
                    {
                        "OriginalFileName": "Plink"
                    },
                    {
                        "CommandLine|contains|all": [
                            " -l forward",
                            " -P ",
                            " -R "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "1c12727d-02bf-45ff-a9f3-d49806a3cf43",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/",
                "https://the.earth.li/~sgtatham/putty/0.58/htmldoc/Chapter7.html"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Renamed Plink Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
            "date": "2019/11/18",
            "description": "Detects the execution of a renamed ProcDump executable.\nThis often done by attackers or malware in order to evade defensive mechanisms.\n",
            "detection": {
                "condition": "(selection_ofn or all of selection_cli_*) and not 1 of filter_main_*",
                "filter_main_known_names": {
                    "Image|endswith": [
                        "\\procdump.exe",
                        "\\procdump64.exe"
                    ]
                },
                "selection_cli_dump_flag": {
                    "CommandLine|contains|windash": [
                        " -ma ",
                        " -mp "
                    ]
                },
                "selection_cli_eula_flag": {
                    "CommandLine|contains|windash": " /accepteula"
                },
                "selection_ofn": {
                    "OriginalFileName": "procdump"
                }
            },
            "falsepositives": [
                "Procdump illegally bundled with legitimate software.",
                "Administrators who rename binaries (should be investigated)."
            ],
            "id": "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/25",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
            ],
            "related": [
                {
                    "id": "03795938-1387-481b-9f4c-3f6241e604fe",
                    "type": "obsoletes"
                }
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Renamed ProcDump Execution"
        },
        {
            "author": "Nextron Systems",
            "date": "2022/06/01",
            "description": "Detects msdt.exe executed by a suspicious parent as seen in CVE-2022-30190 / Follina exploitation",
            "detection": {
                "condition": "all of selection_*",
                "selection_msdt": [
                    {
                        "Image|endswith": "\\msdt.exe"
                    },
                    {
                        "OriginalFileName": "msdt.exe"
                    }
                ],
                "selection_parent": {
                    "ParentImage|endswith": [
                        "\\cmd.exe",
                        "\\cscript.exe",
                        "\\mshta.exe",
                        "\\powershell.exe",
                        "\\pwsh.exe",
                        "\\regsvr32.exe",
                        "\\rundll32.exe",
                        "\\schtasks.exe",
                        "\\wmic.exe",
                        "\\wscript.exe",
                        "\\wsl.exe"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "7a74da6b-ea76-47db-92cc-874ad90df734",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/06",
            "references": [
                "https://twitter.com/nao_sec/status/1530196847679401984",
                "https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1218"
            ],
            "title": "Suspicious MSDT Parent Process"
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
            "date": "2022/04/06",
            "description": "Detects the use of \"DumpMinitool.exe\" a tool that allows the dump of process memory via the use of the \"MiniDumpWriteDump\"",
            "detection": {
                "condition": "all of selection_*",
                "selection_cli": {
                    "CommandLine|contains": [
                        " Full",
                        " Mini",
                        " WithHeap"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": [
                            "\\DumpMinitool.exe",
                            "\\DumpMinitool.x86.exe",
                            "\\DumpMinitool.arm64.exe"
                        ]
                    },
                    {
                        "OriginalFileName": [
                            "DumpMinitool.exe",
                            "DumpMinitool.x86.exe",
                            "DumpMinitool.arm64.exe"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dee0a7a3-f200-4112-a99b-952196d81e42",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/04/12",
            "references": [
                "https://twitter.com/mrd0x/status/1511415432888131586",
                "https://twitter.com/mrd0x/status/1511489821247684615",
                "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/",
                "https://gist.github.com/nasbench/6d58c3c125e2fa1b8f7a09754c1b087f"
            ],
            "status": "test",
            "title": "DumpMinitool Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Nasreddine Bencherchali (Nextron Systems), Anish Bogati",
            "date": "2024/01/05",
            "description": "Detects the execution of \"forfiles\" from a non-default location, in order to potentially spawn a custom \"cmd.exe\" from the current working directory.\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_parent_not_sys": {
                    "Image|contains": [
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\"
                    ],
                    "Image|endswith": "\\cmd.exe",
                    "ParentImage|contains": [
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\"
                    ],
                    "ParentImage|endswith": "\\forfiles.exe"
                },
                "selection": {
                    "CommandLine|startswith": "/c echo \"",
                    "Image|endswith": "\\cmd.exe",
                    "ParentCommandLine|endswith": [
                        ".exe",
                        ".exe\""
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "f53714ec-5077-420e-ad20-907ff9bb2958",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://www.hexacorn.com/blog/2023/12/31/1-little-known-secret-of-forfiles-exe/"
            ],
            "status": "experimental",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Forfiles.EXE Child Process Masquerading"
        },
        {
            "author": "vburov",
            "date": "2019/02/23",
            "description": "Detect suspicious parent processes of well-known Windows processes",
            "detection": {
                "condition": "selection and not 1 of filter_*",
                "filter_msmpeng": {
                    "ParentImage|contains": [
                        "\\Windows Defender\\",
                        "\\Microsoft Security Client\\"
                    ],
                    "ParentImage|endswith": "\\MsMpEng.exe"
                },
                "filter_null": [
                    {
                        "ParentImage": null
                    },
                    {
                        "ParentImage": "-"
                    }
                ],
                "filter_sys": [
                    {
                        "ParentImage|endswith": [
                            "\\SavService.exe",
                            "\\ngen.exe"
                        ]
                    },
                    {
                        "ParentImage|contains": [
                            "\\System32\\",
                            "\\SysWOW64\\"
                        ]
                    }
                ],
                "selection": {
                    "Image|endswith": [
                        "\\svchost.exe",
                        "\\taskhost.exe",
                        "\\lsm.exe",
                        "\\lsass.exe",
                        "\\services.exe",
                        "\\lsaiso.exe",
                        "\\csrss.exe",
                        "\\wininit.exe",
                        "\\winlogon.exe"
                    ]
                }
            },
            "falsepositives": [
                "Some security products seem to spawn these"
            ],
            "id": "96036718-71cc-4027-a538-d1587e0006a7",
            "level": "low",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2022/02/14",
            "references": [
                "https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2",
                "https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/",
                "https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003",
                "attack.t1036.005"
            ],
            "title": "Windows Processes Suspicious Parent Directory"
        },
        {
            "author": "Sreeman",
            "date": "2020/04/17",
            "description": "HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications.\nHxTsr.exe is part of Outlook apps, because it resides in a hidden \"WindowsApps\" subfolder of \"C:\\Program Files\".\nAny instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe\n",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_hxtsr": {
                    "Image|contains": ":\\program files\\windowsapps\\microsoft.windowscommunicationsapps_",
                    "Image|endswith": "\\hxtsr.exe"
                },
                "selection": {
                    "Image|endswith": "\\hxtsr.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "4e762605-34a8-406d-b72e-c1a089313320",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "modified": "2024/02/08",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Potential Fake Instance Of Hxtsr.EXE Executed"
        },
        {
            "author": "Micah Babinski, @micahbabinski",
            "date": "2023/05/07",
            "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
            "detection": {
                "condition": "1 of selection_*",
                "selection_lower": {
                    "CommandLine|contains": [
                        "\u0430",
                        "\u0435",
                        "\u043e",
                        "\u0440",
                        "\u0441",
                        "\u0445",
                        "\u0455",
                        "\u0456",
                        "\u04cf",
                        "\u0458",
                        "\u04bb",
                        "\u0501",
                        "\u051b",
                        "\u051d",
                        "\u03bf"
                    ]
                },
                "selection_upper": {
                    "CommandLine|contains": [
                        "\u0410",
                        "\u0412",
                        "\u0415",
                        "\u041a",
                        "\u041c",
                        "\u041d",
                        "\u041e",
                        "\u0420",
                        "\u0421",
                        "\u0422",
                        "\u0425",
                        "\u0405",
                        "\u0406",
                        "\u0408",
                        "\u04ae",
                        "\u04c0",
                        "\u050c",
                        "\u051a",
                        "\u051c",
                        "\u0391",
                        "\u0392",
                        "\u0395",
                        "\u0396",
                        "\u0397",
                        "\u0399",
                        "\u039a",
                        "\u039c",
                        "\u039d",
                        "\u039f",
                        "\u03a1",
                        "\u03a4",
                        "\u03a5",
                        "\u03a7"
                    ]
                }
            },
            "falsepositives": [
                "Commandlines with legitimate Cyrillic text; will likely require tuning (or not be usable) in countries where these alphabets are in use."
            ],
            "id": "32e280f1-8ad4-46ef-9e80-910657611fbc",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish",
                "http://www.irongeek.com/homoglyph-attack-generator.php"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1036.003"
            ],
            "title": "Potential Homoglyph Attack Using Lookalike Characters"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/11",
            "description": "Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name",
            "detection": {
                "condition": "1 of selection_*",
                "selection_1": {
                    "CommandLine|contains": [
                        "copy procdump",
                        "move procdump"
                    ]
                },
                "selection_2": {
                    "CommandLine|contains": [
                        "2.dmp",
                        "lsass",
                        "out.dmp"
                    ],
                    "CommandLine|contains|all": [
                        "copy ",
                        ".dmp "
                    ]
                },
                "selection_3": {
                    "CommandLine|contains": [
                        "copy lsass.exe_",
                        "move lsass.exe_"
                    ]
                }
            },
            "falsepositives": [
                "False positives are expected in cases in which ProcDump just gets copied to a different directory without any renaming"
            ],
            "id": "79b06761-465f-4f88-9ef2-150e24d3d737",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/05/09",
            "references": [
                "https://twitter.com/mrd0x/status/1480785527901204481"
            ],
            "status": "test",
            "title": "Potential SysInternals ProcDump Evasion",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Markus Neis, Swisscom",
            "date": "2019/06/04",
            "description": "Detects the execution of a renamed \"jusched.exe\" as seen used by the cobalt group",
            "detection": {
                "condition": "selection and not filter",
                "filter": {
                    "Image|endswith": "\\jusched.exe"
                },
                "selection": {
                    "Description": [
                        "Java Update Scheduler",
                        "Java(TM) Update Scheduler"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "edd8a48c-1b9f-4ba1-83aa-490338cd1ccb",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/03",
            "references": [
                "https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1036.003"
            ],
            "title": "Renamed Jusched.EXE Execution"
        },
        {
            "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
            "date": "2019/10/14",
            "description": "Detects a code page switch in command line or batch scripts to a rare language",
            "detection": {
                "condition": "selection",
                "selection": {
                    "CommandLine|endswith": [
                        " 936",
                        " 1258"
                    ],
                    "Image|endswith": "\\chcp.com"
                }
            },
            "falsepositives": [
                "Administrative activity (adjust code pages according to your organization's region)"
            ],
            "fields": [
                "ParentCommandLine"
            ],
            "id": "c7942406-33dd-4377-a564-0f62db0593a3",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/03/07",
            "status": "test",
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers",
                "https://twitter.com/cglyer/status/1183756892952248325"
            ],
            "tags": [
                "attack.t1036",
                "attack.defense_evasion"
            ],
            "title": "Suspicious CodePage Switch Via CHCP"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/01/28",
            "description": "Detects suspicious use of XORDump process memory dumping utility",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "Image|endswith": "\\xordump.exe"
                    },
                    {
                        "CommandLine|contains": [
                            " -process lsass.exe ",
                            " -m comsvcs ",
                            " -m dbghelp ",
                            " -m dbgcore "
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Another tool that uses the command line switches of XORdump"
            ],
            "id": "66e563f9-1cbd-4a22-a957-d8b7c0f44372",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/08",
            "references": [
                "https://github.com/audibleblink/xordump"
            ],
            "status": "test",
            "title": "HackTool - XORDump Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2019/02/09",
            "description": "Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion.\n",
            "detection": {
                "condition": "selection_1 or ( selection_2 and not filter_main_known_locations )",
                "filter_main_known_locations": {
                    "Image|contains": [
                        ":\\Windows\\System32\\",
                        ":\\Windows\\SysWOW64\\",
                        ":\\Windows\\WinSxS\\"
                    ]
                },
                "selection_1": {
                    "CommandLine|contains": "\\calc.exe "
                },
                "selection_2": {
                    "Image|endswith": "\\calc.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "737e618a-a410-49b5-bec3-9e55ff7fbc15",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/11/09",
            "references": [
                "https://twitter.com/ItsReallyNick/status/1094080242686312448"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Suspicious Calculator Usage"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2021/08/16",
            "description": "Detects usage of the SysInternals Procdump utility",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": [
                        "\\procdump.exe",
                        "\\procdump64.exe"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate use of procdump by a developer or administrator"
            ],
            "id": "2e65275c-8288-4ab4-aeb7-6274f58b6b20",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2023/02/28",
            "references": [
                "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
            ],
            "status": "test",
            "title": "Procdump Execution",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036",
                "attack.t1003.001"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems), Tim Shelton",
            "date": "2019/01/16",
            "description": "Detects a potentially suspicious execution from an uncommon folder.",
            "detection": {
                "condition": "selection and not 1 of filter_optional_*",
                "filter_optional_citrix": {
                    "Image|endswith": "\\CitrixReceiverUpdater.exe",
                    "Image|startswith": "C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\"
                },
                "filter_optional_ibm": {
                    "Image|startswith": "C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\"
                },
                "selection": {
                    "Image|contains": [
                        ":\\Perflogs\\",
                        ":\\Users\\All Users\\",
                        ":\\Users\\Default\\",
                        ":\\Users\\NetworkService\\",
                        ":\\Windows\\addins\\",
                        ":\\Windows\\debug\\",
                        ":\\Windows\\Fonts\\",
                        ":\\Windows\\Help\\",
                        ":\\Windows\\IME\\",
                        ":\\Windows\\Media\\",
                        ":\\Windows\\repair\\",
                        ":\\Windows\\security\\",
                        ":\\Windows\\System32\\Tasks\\",
                        ":\\Windows\\Tasks\\",
                        "$Recycle.bin",
                        "\\config\\systemprofile\\",
                        "\\Intel\\Logs\\",
                        "\\RSA\\MachineKeys\\"
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "3dfd06d2-eaf4-4532-9555-68aca59f57c4",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/07/12",
            "references": [
                "https://github.com/mbevilacqua/appcompatprocessor/blob/6c847937c5a836e2ce2fe2b915f213c345a3c389/AppCompatSearch.txt",
                "https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses",
                "https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/",
                "https://github.com/ThreatHuntingProject/ThreatHunting/blob/cb22598bb70651f88e0285abc8d835757d2cb596/hunts/suspicious_process_creation_via_windows_event_logs.md"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Process Execution From A Potentially Suspicious Folder"
        },
        {
            "author": "Michael Haag, FPT.EagleEye",
            "date": "2017/03/09",
            "description": "Detects usage of bitsadmin downloading a file",
            "detection": {
                "condition": "selection_img and (selection_cmd or all of selection_cli_*)",
                "selection_cli_1": {
                    "CommandLine|contains": [
                        " /create ",
                        " /addfile "
                    ]
                },
                "selection_cli_2": {
                    "CommandLine|contains": "http"
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\bitsadmin.exe"
                    },
                    {
                        "OriginalFileName": "bitsadmin.exe"
                    }
                ],
                "selection_cmd": {
                    "CommandLine|contains": " /transfer "
                }
            },
            "falsepositives": [
                "Some legitimate apps use this, but limited."
            ],
            "fields": [
                "CommandLine",
                "ParentCommandLine"
            ],
            "id": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
                "https://isc.sans.edu/diary/22264",
                "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
            ],
            "modified": "2023/02/15",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1197",
                "attack.s0190",
                "attack.t1036.003"
            ],
            "title": "File Download Via Bitsadmin"
        },
        {
            "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @gott_cyber",
            "date": "2019/06/29",
            "description": "Detects a command line process that uses explorer.exe to launch arbitrary commands or binaries,\nwhich is similar to cmd.exe /c, only it breaks the process tree and makes its parent a new instance of explorer spawning from \"svchost\"\n",
            "detection": {
                "condition": "selection",
                "selection": [
                    {
                        "CommandLine|contains": "/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}"
                    },
                    {
                        "CommandLine|contains|all|windash": [
                            "explorer.exe",
                            " /root,"
                        ]
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "949f1ffb-6e85-4f00-ae1e-c3c5b190d605",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "modified": "2024/06/04",
            "references": [
                "https://twitter.com/CyberRaiju/status/1273597319322058752",
                "https://twitter.com/bohops/status/1276357235954909188?s=12",
                "https://twitter.com/nas_bench/status/1535322450858233858",
                "https://securityboulevard.com/2019/09/deobfuscating-ostap-trickbots-34000-line-javascript-downloader/"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Explorer Process Tree Break"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2017/08/15",
            "description": "Detects an uncommon svchost parent process",
            "detection": {
                "condition": "selection and not 1 of filter_main_*",
                "filter_main_generic": {
                    "ParentImage|endswith": [
                        "\\Mrt.exe",
                        "\\MsMpEng.exe",
                        "\\ngen.exe",
                        "\\rpcnet.exe",
                        "\\services.exe",
                        "\\TiWorker.exe"
                    ]
                },
                "filter_main_parent_empty": {
                    "ParentImage": [
                        "-",
                        ""
                    ]
                },
                "filter_main_parent_null": {
                    "ParentImage": null
                },
                "selection": {
                    "Image|endswith": "\\svchost.exe"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "01d2e2a1-5f09-44f7-9fc1-24faa7479b6d",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "Internal Research"
            ],
            "modified": "2022/06/28",
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.005"
            ],
            "title": "Uncommon Svchost Parent Process"
        },
        {
            "author": "Swachchhanda Shrawan Poudel, Elastic (idea)",
            "date": "2023/04/20",
            "description": "Detects the creation of a scheduled task using the \"-XML\" flag with a file without the '.xml' extension. This behavior could be indicative of potential defense evasion attempt during persistence",
            "detection": {
                "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
                "filter_main_extension_xml": {
                    "CommandLine|contains": ".xml"
                },
                "filter_main_rundll32": {
                    "ParentCommandLine|contains|all": [
                        ":\\WINDOWS\\Installer\\MSI",
                        ".tmp,zzzzInvokeManagedCustomActionOutOfProc"
                    ],
                    "ParentImage|endswith": "\\rundll32.exe"
                },
                "filter_main_system_process": {
                    "IntegrityLevel": "System"
                },
                "filter_optional_third_party": {
                    "ParentImage|endswith": [
                        ":\\ProgramData\\OEM\\UpgradeTool\\CareCenter_*\\BUnzip\\Setup_msi.exe",
                        ":\\Program Files\\Axis Communications\\AXIS Camera Station\\SetupActions.exe",
                        ":\\Program Files\\Axis Communications\\AXIS Device Manager\\AdmSetupActions.exe",
                        ":\\Program Files (x86)\\Zemana\\AntiMalware\\AntiMalware.exe",
                        ":\\Program Files\\Dell\\SupportAssist\\pcdrcui.exe"
                    ]
                },
                "selection_cli_create": {
                    "CommandLine|contains": [
                        "/create",
                        "-create"
                    ]
                },
                "selection_cli_xml": {
                    "CommandLine|contains": [
                        "/xml",
                        "-xml"
                    ]
                },
                "selection_img": [
                    {
                        "Image|endswith": "\\schtasks.exe"
                    },
                    {
                        "OriginalFileName": "schtasks.exe"
                    }
                ]
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "windows"
            },
            "references": [
                "https://learn.microsoft.com/en-us/windows/win32/taskschd/daily-trigger-example--xml-",
                "https://github.com/elastic/protections-artifacts/blob/084067123d3328a823b1c3fdde305b694275c794/behavior/rules/persistence_suspicious_scheduled_task_creation_via_masqueraded_xml_file.toml"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.persistence",
                "attack.t1036.005",
                "attack.t1053.005"
            ],
            "title": "Suspicious Scheduled Task Creation via Masqueraded XML File"
        },
        {
            "author": "Ilyas Ochkov, oscd.community",
            "date": "2019/10/25",
            "description": "Detects the creation of a user with the \"$\" character. This can be used by attackers to hide a user or trick detection systems that lack the parsing mechanisms.\n",
            "detection": {
                "condition": "1 of selection_* and not 1 of filter_main_*",
                "filter_main_homegroup": {
                    "EventID": 4720,
                    "TargetUserName": "HomeGroupUser$"
                },
                "selection_create": {
                    "EventID": 4720,
                    "SamAccountName|contains": "$"
                },
                "selection_rename": {
                    "EventID": 4781,
                    "NewTargetUserName|contains": "$"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "cfeed607-6aa4-4bbd-9627-b637deb723c8",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "modified": "2024/01/16",
            "references": [
                "https://twitter.com/SBousseaden/status/1387743867663958021"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "New or Renamed User Account with '$' Character"
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/05/09",
            "description": "Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened.",
            "detection": {
                "condition": "selection and selection_filename",
                "selection": {
                    "EventID": 5379,
                    "TargetName|contains": "Microsoft_Windows_Shell_ZipFolder:filename"
                },
                "selection_filename": {
                    "TargetName|contains": [
                        "invoice",
                        "new order",
                        "rechnung",
                        "factura",
                        "delivery",
                        "purchase",
                        "order",
                        "payment"
                    ]
                }
            },
            "falsepositives": [
                "Legitimate used of encrypted ZIP files"
            ],
            "id": "54f0434b-726f-48a1-b2aa-067df14516e4",
            "level": "high",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://twitter.com/sbousseaden/status/1523383197513379841"
            ],
            "status": "test",
            "tags": [
                "attack.command_and_control",
                "attack.defense_evasion",
                "attack.t1027",
                "attack.t1105",
                "attack.t1036"
            ],
            "title": "Password Protected ZIP File Opened (Suspicious Filenames)"
        },
        {
            "author": "frack113",
            "date": "2022/01/15",
            "description": "Powershell use PassThru option to start in background",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Start-Process",
                        "-PassThru ",
                        "-FilePath "
                    ]
                }
            },
            "falsepositives": [
                "Legitimate PowerShell scripts"
            ],
            "id": "0718cd72-f316-4aa2-988f-838ea8533277",
            "level": "medium",
            "logsource": {
                "category": "ps_script",
                "product": "windows",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.003/T1036.003.md",
                "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Start-Process?view=powershell-5.1&viewFallbackFrom=powershell-7"
            ],
            "status": "test",
            "title": "Suspicious Start-Process PassThru",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "id": "0cf2e1c6-8d10-4273-8059-738778f981ad",
            "author": "X__Junior",
            "date": "2023/05/18",
            "description": "Detects potential WerFault \"ReflectDebugger\" registry value abuse for persistence.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventType": "SetValue",
                    "TargetObject|endswith": "\\Microsoft\\Windows\\Windows Error Reporting\\Hangs\\ReflectDebugger"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "level": "high",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "references": [
                "https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html",
                "https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/"
            ],
            "related": [
                {
                    "type": "derived",
                    "id": "fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd"
                }
            ],
            "status": "test",
            "title": "Potential WerFault ReflectDebugger Registry Value Abuse",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "frack113",
            "date": "2023/01/27",
            "description": "Detect changes to the \"PendingFileRenameOperations\" registry key from uncommon or suspicious images locations to stage currently used files for rename or deletion after reboot.\n",
            "detection": {
                "condition": "selection_main and 1 of selection_susp_*",
                "selection_main": {
                    "EventType": "SetValue",
                    "TargetObject|contains": "\\CurrentControlSet\\Control\\Session Manager\\PendingFileRenameOperations"
                },
                "selection_susp_images": {
                    "Image|endswith": [
                        "\\reg.exe",
                        "\\regedit.exe"
                    ]
                },
                "selection_susp_paths": {
                    "Image|contains": [
                        "\\AppData\\Local\\Temp\\",
                        "\\Users\\Public\\"
                    ]
                }
            },
            "falsepositives": [
                "Installers and updaters may set currently in use files for rename or deletion after a reboot."
            ],
            "id": "4eec988f-7bf0-49f1-8675-1e6a510b3a2a",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2024/07/03",
            "references": [
                "https://any.run/report/3ecd4763ffc944fdc67a9027e459cd4f448b1a8d1b36147977afaf86bbf2a261/64b0ba45-e7ce-423b-9a1d-5b4ea59521e6",
                "https://devblogs.microsoft.com/scripting/determine-pending-reboot-statuspowershell-style-part-1/",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc960241(v=technet.10)?redirectedfrom=MSDN",
                "https://www.trendmicro.com/en_us/research/21/j/purplefox-adds-new-backdoor-that-uses-websockets.html",
                "https://www.trendmicro.com/en_us/research/19/i/purple-fox-fileless-malware-with-rookit-component-delivered-by-rig-exploit-kit-now-abuses-powershell.html"
            ],
            "status": "test",
            "title": "Potential PendingFileRenameOperations Tampering",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        },
        {
            "author": "Florian Roth (Nextron Systems)",
            "date": "2022/03/14",
            "description": "Detects suspicious interactive bash as a parent to rather uncommon child processes",
            "detection": {
                "anomaly1": {
                    "CommandLine|contains": [
                        "-c import ",
                        "base64",
                        "pty.spawn"
                    ]
                },
                "anomaly2": {
                    "Image|endswith": [
                        "whoami",
                        "iptables",
                        "/ncat",
                        "/nc",
                        "/netcat"
                    ]
                },
                "condition": "selection and 1 of anomaly*",
                "selection": {
                    "ParentCommandLine": "bash -i"
                }
            },
            "falsepositives": [
                "Legitimate software that uses these patterns"
            ],
            "id": "ea3ecad2-db86-4a89-ad0b-132a10d2db55",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "Internal Research"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.defense_evasion",
                "attack.t1059.004",
                "attack.t1036"
            ],
            "title": "Interactive Bash Suspicious Children"
        },
        {
            "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
            "date": "2023/06/02",
            "description": "Detects a potentially suspicious execution of a process located in the '/tmp/' folder",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|startswith": "/tmp/"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "312b42b1-bded-4441-8b58-163a3af58775",
            "level": "high",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://blogs.jpcert.or.jp/en/2023/05/gobrat.html",
                "https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/",
                "https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection",
                "https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection"
            ],
            "status": "test",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036"
            ],
            "title": "Potentially Suspicious Execution From Tmp Folder"
        },
        {
            "author": "Timur Zinniatullin, oscd.community",
            "date": "2019/10/21",
            "description": "Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.\nSeveral different variations of this technique have been observed.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "a0": "cp",
                    "a1": "/bin/sh",
                    "a2|endswith": "/crond",
                    "type": "execve"
                }
            },
            "id": "9d4548fa-bba0-4e88-bd66-5d5bf516cda0",
            "logsource": {
                "product": "linux",
                "service": "auditd"
            },
            "level": "medium",
            "modified": "2023/08/22",
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/8a82e9b66a5b4f4bc5b91089e9f24e0544f20ad7/atomics/T1036.003/T1036.003.md#atomic-test-2---masquerading-as-linux-crond-process"
            ],
            "status": "test",
            "title": "Masquerading as Linux Crond Process",
            "tags": [
                "attack.defense_evasion",
                "attack.t1036.003"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Containers"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Oleg Kolesnikov, Securonix",
        "Nick Carr, Mandiant",
        "David Lu, Tripwire",
        "Felipe Esp\u00f3sito, @Pr0teus",
        "Elastic",
        "Bartosz Jerzman",
        "Goldstein Menachem"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "defense-evasion"
        }
    ],
    "x_mitre_detection": "Collect file hashes; file names that do not match their expected hash are suspect. Perform file monitoring; files with known names but in unusual locations are suspect. Likewise, files that are modified outside of an update or patch are suspect.\n\nIf file names are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled. Collecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity. (Citation: Elastic Masquerade Ball) Do not focus on the possible names a file could have, but instead on the command-line arguments that are known to be used and are distinct because it will have a better rate of detection.(Citation: Twitter ItsReallyNick Masquerading Update)\n\nLook for indications of common characters that may indicate an attempt to trick users into misidentifying the file type, such as a space as the last character of a file name or the right-to-left override characters\"\\u202E\", \"[U+202E]\", and \"%E2%80%AE\u201d.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.7",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "File: File Modification",
        "Process: Process Metadata",
        "Service: Service Creation",
        "Service: Service Metadata",
        "Process: Process Creation",
        "Image: Image Metadata",
        "Scheduled Job: Scheduled Job Metadata",
        "File: File Metadata",
        "Scheduled Job: Scheduled Job Modification",
        "Command: Command Execution",
        "Process: OS API Execution"
    ],
    "x_mitre_permissions_required": []
}