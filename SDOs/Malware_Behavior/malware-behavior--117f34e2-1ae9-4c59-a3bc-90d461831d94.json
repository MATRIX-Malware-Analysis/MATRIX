{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--117f34e2-1ae9-4c59-a3bc-90d461831d94",
    "created": "2024-08-13T14:46:37.12967Z",
    "modified": "2024-08-13T14:46:46.192461Z",
    "name": "Inter-Process Communication: Dynamic Data Exchange",
    "description": "Adversaries may use Windows Dynamic Data Exchange (DDE) to execute arbitrary commands. DDE is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution.Object Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by Component Object Model, DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys.[1][2][3]Microsoft Office documents can be poisoned with DDE commands, directly or through embedded files, and used to deliver execution via Phishing campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros.[4][5][6][7] Similarly, adversaries may infect payloads to execute applications and/or commands on a victim device by way of embedding DDE formulas within a CSV file intended to be opened through a Windows spreadsheet program.[8][9]DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to a Command and Scripting Interpreter. DDE execution can be invoked remotely via Remote Services such as Distributed Component Object Model (DCOM).[10]",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1559/002",
            "external_id": "T1559/002"
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "frack113",
            "date": "2022/02/26",
            "description": "Enable Dynamic Data Exchange protocol (DDE) in all supported editions of Microsoft Word or Excel.",
            "detection": {
                "condition": "1 of selection_*",
                "selection_excel": {
                    "Details": "DWORD (0x00000000)",
                    "TargetObject|endswith": [
                        "\\Excel\\Security\\DisableDDEServerLaunch",
                        "\\Excel\\Security\\DisableDDEServerLookup"
                    ]
                },
                "selection_word": {
                    "Details": [
                        "DWORD (0x00000001)",
                        "DWORD (0x00000002)"
                    ],
                    "TargetObject|endswith": "\\Word\\Security\\AllowDDE"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "63647769-326d-4dde-a419-b925cc0caf42",
            "level": "medium",
            "logsource": {
                "category": "registry_set",
                "product": "windows"
            },
            "modified": "2023/08/17",
            "references": [
                "https://msrc.microsoft.com/update-guide/vulnerability/ADV170021"
            ],
            "status": "test",
            "tags": [
                "attack.execution",
                "attack.t1559.002"
            ],
            "title": "Enable Microsoft Dynamic Data Exchange"
        }
    ]
}