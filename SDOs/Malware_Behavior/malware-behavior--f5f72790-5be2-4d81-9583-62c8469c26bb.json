{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--f5f72790-5be2-4d81-9583-62c8469c26bb",
    "created": "2024-08-13T14:46:36.673792Z",
    "modified": "2024-08-13T14:46:36.673792Z",
    "name": "Sniff Application Code",
    "description": "An adversary passively sniffs network communications and captures application code bound for an authorized client. Once obtained, they can use it as-is, or through reverse-engineering glean sensitive information or exploit the trust relationship between the client and server. Such code may belong to a dynamic update to the client, a patch being applied to a client component or any such interaction where the client is authorized to communicate with the server.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CAPEC",
            "url": "https://capec.mitre.org/data/definitions/65.html",
            "external_id": "65"
        },
        {
            "source_name": "CWE",
            "external_id": "319"
        },
        {
            "source_name": "CWE",
            "external_id": "311"
        },
        {
            "source_name": "CWE",
            "external_id": "318"
        },
        {
            "source_name": "CWE",
            "external_id": "693"
        }
    ],
    "x_mitre_consequences": [
        {
            "impact": "Read Data",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Confidentiality"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Access Control"
        },
        {
            "impact": "Gain Privileges",
            "scope": "Authorization"
        }
    ],
    "x_mitre_examples": [
        {
            "description": "Attacker receives notification that the computer/OS/application has an available update, loads a network sniffing tool, and extracts update data from subsequent communication. The attacker then proceeds to reverse engineer the captured stream to gain sensitive information, such as encryption keys, validation algorithms, applications patches, etc.."
        },
        {
            "description": "Plain code, such as applets or JavaScript, is also part of the executing application. If such code is transmitted unprotected, the attacker can capture the code and possibly reverse engineer it to gain sensitive information, such as encryption keys, validation algorithms and such."
        }
    ],
    "x_mitre_execution_flows": [
        {
            "description": "[Set up a sniffer] The adversary sets up a sniffer in the path between the server and the client and watches the traffic.",
            "phase": "Explore",
            "step": "1",
            "techniques": [
                "The adversary sets up a sniffer in the path between the server and the client."
            ]
        },
        {
            "description": "[Capturing Application Code Bound During Patching]adversary knows that the computer/OS/application can request new applications to install, or it periodically checks for an available update. The adversary loads the sniffer set up during Explore phase, and extracts the application code from subsequent communication. The adversary then proceeds to reverse engineer the captured code.",
            "phase": "Exploit",
            "step": "2",
            "techniques": [
                "adversary loads the sniffer to capture the application code bound during a dynamic update.",
                "The adversary proceeds to reverse engineer the captured code."
            ]
        }
    ],
    "x_mitre_impact": "High",
    "x_mitre_likelihood_of_attack": "Low",
    "x_mitre_mitigations": [
        {
            "description": "Design: Encrypt all communication between the client and server."
        },
        {
            "description": "Implementation: Use SSL, SSH, SCP."
        },
        {
            "description": "Operation: Use \"ifconfig/ipconfig\" or other tools to detect the sniffer installed in the network."
        }
    ]
}