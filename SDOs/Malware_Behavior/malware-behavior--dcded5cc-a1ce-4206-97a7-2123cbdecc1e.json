{
    "type": "malware-behavior",
    "spec_version": "2.1",
    "id": "malware-behavior--dcded5cc-a1ce-4206-97a7-2123cbdecc1e",
    "created": "2024-08-13T14:46:36.684307Z",
    "modified": "2024-08-13T14:46:48.605337Z",
    "name": "Account Access Removal",
    "description": "Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. Adversaries may also subsequently log off and/or perform a System Shutdown/Reboot to set malicious changes into place.[1][2]In Windows, Net utility, Set-LocalUser and Set-ADAccountPassword PowerShell cmdlets may be used by adversaries to modify user accounts. In Linux, the passwd utility may be used to change passwords. Accounts could also be disabled by Group Policy. Adversaries who use ransomware or similar attacks may first perform this and other Impact behaviors, such as Data Destruction and Defacement, in order to impede incident response/recovery before completing the Data Encrypted for Impact objective.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "MITRE ATT&CK",
            "url": "https://attack.mitre.org/techniques/T1531",
            "external_id": "T1531"
        },
        {
            "source_name": "CAPEC 2",
            "external_id": "malware-behavior--e0d1f77b-e4c9-4edc-8097-011a53d598b1"
        },
        {
            "source_name": "mitre-attack",
            "url": "https://attack.mitre.org/techniques/T1531",
            "external_id": "T1531"
        },
        {
            "source_name": "CarbonBlack LockerGoga 2019",
            "description": "CarbonBlack Threat Analysis Unit. (2019, March 22). TAU Threat Intelligence Notification \u2013 LockerGoga Ransomware. Retrieved April 16, 2019.",
            "url": "https://www.carbonblack.com/2019/03/22/tau-threat-intelligence-notification-lockergoga-ransomware/"
        },
        {
            "source_name": "Unit42 LockerGoga 2019",
            "description": "Harbison, M. (2019, March 26). Born This Way? Origins of LockerGoga. Retrieved April 16, 2019.",
            "url": "https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/"
        }
    ],
    "x_mitre_capa_rules": [
        {
            "rule": {
                "features": [
                    {
                        "or": [
                            {
                                "api": "netapi32.NetUserDel"
                            }
                        ]
                    }
                ],
                "meta": {
                    "att&ck": [
                        "Impact::Account Access Removal [T1531]"
                    ],
                    "authors": [
                        "michael.hunhoff@mandiant.com"
                    ],
                    "name": "delete user account",
                    "namespace": "host-interaction/accounts",
                    "scopes": {
                        "dynamic": "call",
                        "static": "basic block"
                    }
                }
            }
        }
    ],
    "x_mitre_detection_rules": [
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/09/12",
            "description": "Detects when an user account is locked out.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "displaymessage": "Max sign in attempts exceeded"
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "14701da0-4b0f-4ee6-9c95-2ffb4e73bb9a",
            "level": "medium",
            "logsource": {
                "product": "okta",
                "service": "okta"
            },
            "modified": "2022/10/09",
            "references": [
                "https://developer.okta.com/docs/reference/api/system-log/",
                "https://developer.okta.com/docs/reference/api/event-types/"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ],
            "title": "Okta User Account Locked Out"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/14",
            "description": "Identifies when a service account is disabled or deleted in Google Cloud.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "gcp.audit.method_name|endswith": [
                        ".serviceAccounts.disable",
                        ".serviceAccounts.delete"
                    ]
                }
            },
            "falsepositives": [
                "Service Account being disabled or deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Service Account disabled or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "13f81a90-a69c-4fab-8f07-b5bb55416a9f",
            "level": "medium",
            "logsource": {
                "product": "gcp",
                "service": "gcp.audit"
            },
            "modified": "2022/10/09",
            "references": [
                "https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ],
            "title": "Google Cloud Service Account Disabled or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/07/24",
            "description": "Identifies when an ElastiCache security group has been modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "eventName": [
                        "DeleteCacheSecurityGroup",
                        "AuthorizeCacheSecurityGroupIngress",
                        "RevokeCacheSecurityGroupIngress",
                        "AuthorizeCacheSecurityGroupEgress",
                        "RevokeCacheSecurityGroupEgress"
                    ],
                    "eventSource": "elasticache.amazonaws.com"
                }
            },
            "falsepositives": [
                "A ElastiCache security group deletion may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Security Group deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "7c797da2-9cf2-4523-ba64-33b06339f0cc",
            "level": "low",
            "logsource": {
                "product": "aws",
                "service": "cloudtrail"
            },
            "modified": "2022/10/09",
            "references": [
                "https://github.com/elastic/detection-rules/blob/7d5efd68603f42be5e125b5a6a503b2ef3ac0f4e/rules/integrations/aws/impact_elasticache_security_group_modified_or_deleted.toml"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ],
            "title": "AWS ElastiCache Security Group Modified or Deleted"
        },
        {
            "author": "Austin Songer @austinsonger",
            "date": "2021/08/07",
            "description": "Identifies when a service account is modified or deleted.",
            "detection": {
                "condition": "selection",
                "selection": {
                    "operationName": [
                        "MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SERVICEACCOUNTS/WRITE",
                        "MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SERVICEACCOUNTS/DELETE",
                        "MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/SERVICEACCOUNTS/IMPERSONATE/ACTION"
                    ]
                }
            },
            "falsepositives": [
                "Service account being modified or deleted may be performed by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
                "Service account modified or deleted from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
            ],
            "id": "12d027c3-b48c-4d9d-8bb6-a732200034b2",
            "level": "medium",
            "logsource": {
                "product": "azure",
                "service": "activitylogs"
            },
            "modified": "2022/08/23",
            "references": [
                "https://learn.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes",
                "https://www.microsoft.com/security/blog/2021/03/23/secure-containerized-environments-with-updated-threat-matrix-for-kubernetes/",
                "https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/",
                "https://medium.com/mitre-engenuity/att-ck-for-containers-now-available-4c2359654bf1",
                "https://attack.mitre.org/matrices/enterprise/cloud/"
            ],
            "status": "test",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ],
            "title": "Azure Kubernetes Service Account Modified or Deleted"
        },
        {
            "author": "frack113",
            "date": "2022/10/14",
            "description": "Detects a user log-off activity. Could be used for example to correlate information during forensic investigations",
            "detection": {
                "condition": "selection",
                "selection": {
                    "EventID": [
                        4634,
                        4647
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "0badd08f-c6a3-4630-90d3-6875cca440be",
            "level": "informational",
            "logsource": {
                "product": "windows",
                "service": "security"
            },
            "references": [
                "https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4634",
                "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4647"
            ],
            "status": "test",
            "title": "User Logoff Event",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ]
        },
        {
            "author": "frack113",
            "date": "2021/12/26",
            "description": "Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users.\nAccounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts.\n",
            "detection": {
                "condition": "selection",
                "selection": {
                    "ScriptBlockText|contains|all": [
                        "Remove-ADGroupMember",
                        "-Identity ",
                        "-Members "
                    ]
                }
            },
            "falsepositives": [
                "Unknown"
            ],
            "id": "48a45d45-8112-416b-8a67-46e03a4b2107",
            "level": "medium",
            "logsource": {
                "product": "windows",
                "category": "ps_script",
                "definition": "Requirements: Script Block Logging must be enabled"
            },
            "references": [
                "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1531/T1531.md#atomic-test-3---remove-account-from-domain-admin-group"
            ],
            "status": "test",
            "title": "Remove Account From Domain Admin Group",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ]
        },
        {
            "author": "Tuan Le (NCSGroup)",
            "date": "2022/12/26",
            "description": "Detects execution of the \"groupdel\" binary. Which is used to delete a group. This is sometimes abused by threat actors in order to cover their tracks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "/groupdel"
                }
            },
            "falsepositives": [
                "Legitimate administrator activities"
            ],
            "id": "8a46f16c-8c4c-82d1-b121-0fdd3ba70a84",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://linuxize.com/post/how-to-delete-group-in-linux/",
                "https://www.cyberciti.biz/faq/linux-remove-user-command/",
                "https://www.cybrary.it/blog/0p3n/linux-commands-used-attackers/",
                "https://linux.die.net/man/8/groupdel"
            ],
            "status": "test",
            "title": "Group Has Been Deleted Via Groupdel",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ]
        },
        {
            "author": "Tuan Le (NCSGroup)",
            "date": "2022/12/26",
            "description": "Detects execution of the \"userdel\" binary. Which is used to delete a user account and related files. This is sometimes abused by threat actors in order to cover their tracks",
            "detection": {
                "condition": "selection",
                "selection": {
                    "Image|endswith": "/userdel"
                }
            },
            "falsepositives": [
                "Legitimate administrator activities"
            ],
            "id": "08f26069-6f80-474b-8d1f-d971c6fedea0",
            "level": "medium",
            "logsource": {
                "category": "process_creation",
                "product": "linux"
            },
            "references": [
                "https://linuxize.com/post/how-to-delete-group-in-linux/",
                "https://www.cyberciti.biz/faq/linux-remove-user-command/",
                "https://www.cybrary.it/blog/0p3n/linux-commands-used-attackers/",
                "https://linux.die.net/man/8/userdel"
            ],
            "status": "test",
            "title": "User Has Been Deleted Via Userdel",
            "tags": [
                "attack.impact",
                "attack.t1531"
            ]
        }
    ],
    "x_mitre_platforms": [
        "Linux",
        "macOS",
        "Windows",
        "Office 365",
        "SaaS"
    ],
    "x_mitre_domains": [
        "enterprise-attack"
    ],
    "x_mitre_contributors": [
        "Hubert Mank"
    ],
    "kill_chain_phases": [
        {
            "kill_chain_name": "mitre-attack",
            "phase_name": "impact"
        }
    ],
    "x_mitre_detection": "Use process monitoring to monitor the execution and command line parameters of binaries involved in deleting accounts or changing passwords, such as use of [Net](https://attack.mitre.org/software/S0039). Windows event logs may also designate activity associated with an adversary's attempt to remove access to an account:\n\n* Event ID 4723 - An attempt was made to change an account's password\n* Event ID 4724 - An attempt was made to reset an account's password\n* Event ID 4726 - A user account was deleted\n* Event ID 4740 - A user account was locked out\n\nAlerting on [Net](https://attack.mitre.org/software/S0039) and these Event IDs may generate a high degree of false positives, so compare against baseline knowledge for how systems are typically used and correlate modification events with other indications of malicious activity where possible.",
    "x_mitre_is_subtechnique": false,
    "x_mitre_version": "1.2",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
    "x_mitre_data_sources": [
        "Active Directory: Active Directory Object Modification",
        "User Account: User Account Modification",
        "User Account: User Account Deletion"
    ],
    "x_mitre_permissions_required": []
}