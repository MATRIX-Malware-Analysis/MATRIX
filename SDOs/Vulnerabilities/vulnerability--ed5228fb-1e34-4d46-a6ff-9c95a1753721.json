{
    "type": "vulnerability",
    "spec_version": "2.1",
    "id": "vulnerability--ed5228fb-1e34-4d46-a6ff-9c95a1753721",
    "created": "2024-08-13T16:06:29.996537Z",
    "modified": "2024-08-13T16:06:29.996542Z",
    "name": "Sandbox Escape by math function in smarty",
    "description": "Smarty is a template engine for PHP, facilitating the separation of presentation (HTML/CSS) from application logic. Prior to versions 3.1.42 and 4.0.2, template authors could run arbitrary PHP code by crafting a malicious math string. If a math string was passed through as user provided data to the math function, external users could run arbitrary PHP code by crafting a malicious math string. Users should upgrade to version 3.1.42 or 4.0.2 to receive a patch.",
    "external_references": [
        {
            "source_name": "cve",
            "external_id": "CVE-2021-29454"
        }
    ],
    "metrics": [
        {
            "cvssV3_1": {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "NONE",
                "baseScore": 8.1,
                "baseSeverity": "HIGH",
                "confidentialityImpact": "HIGH",
                "integrityImpact": "HIGH",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "REQUIRED",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
                "version": "3.1"
            }
        }
    ],
    "references": [
        {
            "url": "https://github.com/smarty-php/smarty/security/advisories/GHSA-29gp-2c3m-3j6m"
        },
        {
            "url": "https://github.com/smarty-php/smarty/commit/215d81a9fa3cd63d82fb3ab56ecaf97cf1e7db71"
        },
        {
            "url": "https://github.com/smarty-php/smarty/releases/tag/v3.1.42"
        },
        {
            "url": "https://github.com/smarty-php/smarty/releases/tag/v4.0.2"
        },
        {
            "url": "https://packagist.org/packages/smarty/smarty"
        },
        {
            "url": "https://www.smarty.net/docs/en/language.function.math.tpl"
        },
        {
            "name": "[debian-lts-announce] 20220505 [SECURITY] [DLA 2995-1] smarty3 security update",
            "tags": [
                "mailing-list"
            ],
            "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00005.html"
        },
        {
            "name": "DSA-5151",
            "tags": [
                "vendor-advisory"
            ],
            "url": "https://www.debian.org/security/2022/dsa-5151"
        },
        {
            "name": "GLSA-202209-09",
            "tags": [
                "vendor-advisory"
            ],
            "url": "https://security.gentoo.org/glsa/202209-09"
        },
        {
            "name": "FEDORA-2022-52154efd61",
            "tags": [
                "vendor-advisory"
            ],
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/L777JIBIWJV34HS7LXPIDWASG7TT4LNI/"
        },
        {
            "name": "FEDORA-2022-d5fc9dcdd7",
            "tags": [
                "vendor-advisory"
            ],
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BRAJVDRGCIY5UZ2PQHKDTT7RMKG6WJQQ/"
        }
    ]
}