{
    "type": "vulnerability",
    "spec_version": "2.1",
    "id": "vulnerability--f960c66a-30ad-49c9-963a-cb809e0d96b2",
    "created": "2024-08-13T16:11:11.120978Z",
    "modified": "2024-08-13T16:11:11.120982Z",
    "name": "LookupResources may return partial results in spicedb",
    "description": "SpiceDB is an open source, Google Zanzibar-inspired, database system for creating and managing security-critical application permissions. Any user making a negative authorization decision based on the results of a `LookupResources` request with 1.22.0 is affected. For example, using `LookupResources` to find a list of resources to allow access to be okay: some subjects that should have access to a resource may not. But if using `LookupResources` to find a list of banned resources instead, then some users that shouldn't have access may. Generally, `LookupResources` is not and should not be to gate access in this way - that's what the `Check` API is for. Additionally, version 1.22.0 has included a warning about this bug since its initial release. Users are advised to upgrade to version 1.22.2. Users unable to upgrade should avoid using `LookupResources` for negative authorization decisions.",
    "external_references": [
        {
            "source_name": "cve",
            "external_id": "CVE-2023-35930"
        }
    ],
    "metrics": [
        {
            "cvssV3_1": {
                "attackComplexity": "HIGH",
                "attackVector": "NETWORK",
                "availabilityImpact": "NONE",
                "baseScore": 3.7,
                "baseSeverity": "LOW",
                "confidentialityImpact": "NONE",
                "integrityImpact": "LOW",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N",
                "version": "3.1"
            }
        }
    ],
    "references": [
        {
            "name": "https://github.com/authzed/spicedb/security/advisories/GHSA-m54h-5x5f-5m6r",
            "tags": [
                "x_refsource_CONFIRM"
            ],
            "url": "https://github.com/authzed/spicedb/security/advisories/GHSA-m54h-5x5f-5m6r"
        },
        {
            "name": "https://github.com/authzed/spicedb/pull/1397",
            "tags": [
                "x_refsource_MISC"
            ],
            "url": "https://github.com/authzed/spicedb/pull/1397"
        }
    ]
}