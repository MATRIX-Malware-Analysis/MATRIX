{
    "type": "vulnerability",
    "spec_version": "2.1",
    "id": "vulnerability--32422c35-6295-4913-8146-eb53a48e7758",
    "created": "2024-08-13T16:13:40.92303Z",
    "modified": "2024-08-13T16:13:40.923034Z",
    "name": "next-auth vulnerable to possible user mocking that bypasses basic authentication",
    "description": "NextAuth.js provides authentication for Next.js. `next-auth` applications prior to version 4.24.5 that rely on the default Middleware authorization are affected by a vulnerability. A bad actor could create an empty/mock user, by getting hold of a NextAuth.js-issued JWT from an interrupted OAuth sign-in flow (state, PKCE or nonce). Manually overriding the `next-auth.session-token` cookie value with this non-related JWT would let the user simulate a logged in user, albeit having no user information associated with it. (The only property on this user is an opaque randomly generated string). This vulnerability does not give access to other users' data, neither to resources that require proper authorization via scopes or other means. The created mock user has no information associated with it (ie. no name, email, access_token, etc.) This vulnerability can be exploited by bad actors to peek at logged in user states (e.g. dashboard layout). `next-auth` `v4.24.5` contains a patch for the vulnerability. As a workaround, using a custom authorization callback for Middleware, developers can manually do a basic authentication.",
    "external_references": [
        {
            "source_name": "cve",
            "external_id": "CVE-2023-48309"
        }
    ],
    "metrics": [
        {
            "cvssV3_1": {
                "attackComplexity": "LOW",
                "attackVector": "NETWORK",
                "availabilityImpact": "NONE",
                "baseScore": 5.3,
                "baseSeverity": "MEDIUM",
                "confidentialityImpact": "LOW",
                "integrityImpact": "NONE",
                "privilegesRequired": "NONE",
                "scope": "UNCHANGED",
                "userInteraction": "NONE",
                "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
                "version": "3.1"
            }
        }
    ],
    "references": [
        {
            "name": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-v64w-49xw-qq89",
            "tags": [
                "x_refsource_CONFIRM"
            ],
            "url": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-v64w-49xw-qq89"
        },
        {
            "name": "https://github.com/nextauthjs/next-auth/commit/d237059b6d0cb868c041ba18b698e0cee20a2f10",
            "tags": [
                "x_refsource_MISC"
            ],
            "url": "https://github.com/nextauthjs/next-auth/commit/d237059b6d0cb868c041ba18b698e0cee20a2f10"
        },
        {
            "name": "https://authjs.dev/guides/basics/role-based-access-control",
            "tags": [
                "x_refsource_MISC"
            ],
            "url": "https://authjs.dev/guides/basics/role-based-access-control"
        },
        {
            "name": "https://next-auth.js.org/configuration/nextjs#advanced-usage",
            "tags": [
                "x_refsource_MISC"
            ],
            "url": "https://next-auth.js.org/configuration/nextjs#advanced-usage"
        },
        {
            "name": "https://next-auth.js.org/configuration/nextjs#middlewar",
            "tags": [
                "x_refsource_MISC"
            ],
            "url": "https://next-auth.js.org/configuration/nextjs#middlewar"
        }
    ]
}