{
    "type": "weakness",
    "spec_version": "2.1",
    "id": "weakness--25aaccd5-76c0-4260-bea1-24f5a1b9cb25",
    "created": "2024-08-13T14:46:48.886574Z",
    "modified": "2024-08-13T14:46:48.886574Z",
    "name": "Improper Validation of Certificate with Host Mismatch",
    "description": "The product communicates with a host that provides a certificate, but the product does not properly ensure that the certificate is actually associated with that host.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CWE",
            "external_id": "297"
        }
    ],
    "x_mitre_common_consequences": [
        {
            "impact": "Gain Privileges or Assume Identity",
            "scope": "Access Control"
        },
        {
            "impact": "Other",
            "scope": "Authentication"
        },
        {
            "impact": "Other",
            "scope": "Other"
        }
    ],
    "x_mitre_content_history": [
        {
            "submission_date": "2006-07-19",
            "submission_name": "CLASP",
            "submission_organization": null
        }
    ],
    "x_mitre_detection_methods": [
        {
            "description": "Automated static analysis, commonly referred to as Static Application Security Testing (SAST), can find some instances of this weakness by analyzing source code (or binary/compiled code) without having to execute it. Typically, this is done by building a model of data flow and control flow, then searching for potentially-vulnerable patterns that connect \"sources\" (origins of input) with \"sinks\" (destinations where the data interacts with external components, a lower layer such as the OS, etc.)",
            "effectiveness": "High",
            "method": "Automated Static Analysis"
        },
        {
            "description": "Set up an untrusted endpoint (e.g. a server) with which the product will connect.  Create a test certificate that uses an invalid hostname but is signed by a trusted CA and provide this certificate from the untrusted endpoint. If the product performs any operations instead of disconnecting and reporting an error, then this indicates that the hostname is not being checked and the test certificate has been accepted.",
            "effectiveness": null,
            "method": "Dynamic Analysis with Manual Results Interpretation"
        },
        {
            "description": "When Certificate Pinning is being used in a mobile application, consider using a tool such as Spinner [REF-955].  This methodology might be extensible to other technologies.",
            "effectiveness": null,
            "method": "Black Box"
        }
    ],
    "x_mitre_likelihood_of_exploit": "High",
    "x_mitre_observed_examples": [
        {
            "description": "Mobile banking application does not verify hostname, leading to financial loss.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5810",
            "reference": "CVE-2012-5810"
        },
        {
            "description": "Mobile application for printing documents does not verify hostname, allowing attackers to read sensitive documents.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5811",
            "reference": "CVE-2012-5811"
        },
        {
            "description": "Software for electronic checking does not verify hostname, leading to financial loss.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5807",
            "reference": "CVE-2012-5807"
        },
        {
            "description": "Cloud-support library written in Python uses incorrect regular expression when matching hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-3446",
            "reference": "CVE-2012-3446"
        },
        {
            "description": "Web browser does not correctly handle '\\0' character (NUL) in Common Name, allowing spoofing of https sites.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-2408",
            "reference": "CVE-2009-2408"
        },
        {
            "description": "Database program truncates the Common Name during hostname verification, allowing spoofing.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-0867",
            "reference": "CVE-2012-0867"
        },
        {
            "description": "Incorrect handling of '\\0' character (NUL) in hostname verification allows spoofing.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2010-2074",
            "reference": "CVE-2010-2074"
        },
        {
            "description": "Mail server's incorrect handling of '\\0' character (NUL) in hostname verification allows spoofing.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-4565",
            "reference": "CVE-2009-4565"
        },
        {
            "description": "LDAP server's incorrect handling of '\\0' character (NUL) in hostname verification allows spoofing.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-3767",
            "reference": "CVE-2009-3767"
        },
        {
            "description": "Payment processing module does not verify hostname when connecting to PayPal using PHP fsockopen function.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5806",
            "reference": "CVE-2012-5806"
        },
        {
            "description": "Smartphone device does not verify hostname, allowing spoofing of mail services.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-2993",
            "reference": "CVE-2012-2993"
        },
        {
            "description": "E-commerce module does not verify hostname when connecting to payment site.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5804",
            "reference": "CVE-2012-5804"
        },
        {
            "description": "Chat application does not validate hostname, leading to loss of privacy.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5824",
            "reference": "CVE-2012-5824"
        },
        {
            "description": "Application uses third-party library that does not validate hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5822",
            "reference": "CVE-2012-5822"
        },
        {
            "description": "Cloud storage management application does not validate hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5819",
            "reference": "CVE-2012-5819"
        },
        {
            "description": "Java library uses JSSE SSLSocket and SSLEngine classes, which do not verify the hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5817",
            "reference": "CVE-2012-5817"
        },
        {
            "description": "SOAP platform does not verify the hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5784",
            "reference": "CVE-2012-5784"
        },
        {
            "description": "PHP library for payments does not verify the hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5782",
            "reference": "CVE-2012-5782"
        },
        {
            "description": "Merchant SDK for payments does not verify the hostname.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2012-5780",
            "reference": "CVE-2012-5780"
        },
        {
            "description": "Web browser does not validate Common Name, allowing spoofing of https sites.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2003-0355",
            "reference": "CVE-2003-0355"
        }
    ],
    "x_mitre_potential_mitigations": [
        {
            "description": "Fully check the hostname of the certificate and provide the user with adequate information about the nature of the problem and how to proceed.",
            "effectiveness": null,
            "phase": "Architecture and Design"
        },
        {
            "description": "If certificate pinning is being used, ensure that all relevant properties of the certificate are fully validated before the certificate is pinned, including the hostname.",
            "effectiveness": null,
            "phase": "Implementation"
        }
    ],
    "x_mitre_references": [
        {
            "external_reference_id": "REF-18"
        },
        {
            "external_reference_id": "REF-245"
        },
        {
            "external_reference_id": "REF-243"
        },
        {
            "external_reference_id": "REF-249"
        },
        {
            "external_reference_id": "REF-250"
        },
        {
            "external_reference_id": "REF-44"
        },
        {
            "external_reference_id": "REF-955"
        }
    ],
    "x_mitre_related_weaknesses": [
        {
            "cwe_id": "923",
            "nature": "ChildOf"
        },
        {
            "cwe_id": "295",
            "nature": "ChildOf"
        }
    ]
}