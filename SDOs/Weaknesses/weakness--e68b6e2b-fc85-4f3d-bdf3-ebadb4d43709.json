{
    "type": "weakness",
    "spec_version": "2.1",
    "id": "weakness--e68b6e2b-fc85-4f3d-bdf3-ebadb4d43709",
    "created": "2024-08-13T14:46:48.785119Z",
    "modified": "2024-08-13T14:46:48.785119Z",
    "name": "Improper Handling of Length Parameter Inconsistency",
    "description": "The product parses a formatted message or structure, but it does not handle or incorrectly handles a length field that is inconsistent with the actual length of the associated data.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CWE",
            "external_id": "130"
        }
    ],
    "x_mitre_common_consequences": [
        {
            "impact": "Read Memory",
            "scope": "Confidentiality"
        },
        {
            "impact": "Modify Memory",
            "scope": "Confidentiality"
        },
        {
            "impact": "Varies by Context",
            "scope": "Confidentiality"
        },
        {
            "impact": "Read Memory",
            "scope": "Integrity"
        },
        {
            "impact": "Modify Memory",
            "scope": "Integrity"
        },
        {
            "impact": "Varies by Context",
            "scope": "Integrity"
        }
    ],
    "x_mitre_content_history": [
        {
            "submission_date": "2006-07-19",
            "submission_name": "PLOVER",
            "submission_organization": null
        }
    ],
    "x_mitre_likelihood_of_exploit": "Unknown",
    "x_mitre_observed_examples": [
        {
            "description": "Chain: \"Heartbleed\" bug receives an inconsistent length parameter (CWE-130) enabling an out-of-bounds read (CWE-126), returning memory that could include private cryptographic keys and other sensitive data.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2014-0160",
            "reference": "CVE-2014-0160"
        },
        {
            "description": "Web application firewall consumes excessive memory when an HTTP request contains a large Content-Length value but no POST data.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-2299",
            "reference": "CVE-2009-2299"
        },
        {
            "description": "Buffer overflow in internal string handling routine allows remote attackers to execute arbitrary commands via a length argument of zero or less, which disables the length check.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2001-0825",
            "reference": "CVE-2001-0825"
        },
        {
            "description": "Web server allows remote attackers to cause a denial of service via an HTTP request with a content-length value that is larger than the size of the request, which prevents server from timing out the connection.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2001-1186",
            "reference": "CVE-2001-1186"
        },
        {
            "description": "Service does not properly check the specified length of a cookie, which allows remote attackers to execute arbitrary commands via a buffer overflow, or brute force authentication by using a short cookie length.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2001-0191",
            "reference": "CVE-2001-0191"
        },
        {
            "description": "Traffic analyzer allows remote attackers to cause a denial of service and possibly execute arbitrary code via invalid IPv4 or IPv6 prefix lengths, possibly triggering a buffer overflow.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2003-0429",
            "reference": "CVE-2003-0429"
        },
        {
            "description": "Chat client allows remote attackers to cause a denial of service or execute arbitrary commands via a JPEG image containing a comment with an illegal field length of 1.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2000-0655",
            "reference": "CVE-2000-0655"
        },
        {
            "description": "Server allows remote attackers to cause a denial of service and possibly execute arbitrary code via a negative Content-Length HTTP header field causing a heap-based buffer overflow.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0492",
            "reference": "CVE-2004-0492"
        },
        {
            "description": "Help program allows remote attackers to execute arbitrary commands via a heap-based buffer overflow caused by a .CHM file with a large length field",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0201",
            "reference": "CVE-2004-0201"
        },
        {
            "description": "Name services does not properly validate the length of certain packets, which allows attackers to cause a denial of service and possibly execute arbitrary code. Can overlap zero-length issues",
            "link": "https://www.cve.org/CVERecord?id=CVE-2003-0825",
            "reference": "CVE-2003-0825"
        },
        {
            "description": "Policy manager allows remote attackers to cause a denial of service (memory consumption and crash) and possibly execute arbitrary code via an HTTP POST request with an invalid Content-Length value.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0095",
            "reference": "CVE-2004-0095"
        },
        {
            "description": "Heap-based buffer overflow in library allows remote attackers to execute arbitrary code via a modified record length field in an SSLv2 client hello message.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0826",
            "reference": "CVE-2004-0826"
        },
        {
            "description": "When domain logons are enabled, server allows remote attackers to cause a denial of service via a SAM_UAS_CHANGE request with a length value that is larger than the number of structures that are provided.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0808",
            "reference": "CVE-2004-0808"
        },
        {
            "description": "Multiple SSH2 servers and clients do not properly handle packets or data elements with incorrect length specifiers, which may allow remote attackers to cause a denial of service or possibly execute arbitrary code.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2002-1357",
            "reference": "CVE-2002-1357"
        },
        {
            "description": "Server allows remote attackers to cause a denial of service (CPU and memory exhaustion) via a POST request with a Content-Length header set to -1.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0774",
            "reference": "CVE-2004-0774"
        },
        {
            "description": "Multiple buffer overflows in xml library that may allow remote attackers to execute arbitrary code via long URLs.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0989",
            "reference": "CVE-2004-0989"
        },
        {
            "description": "Application does not properly validate the length of a value that is saved in a session file, which allows remote attackers to execute arbitrary code via a malicious session file (.ht), web site, or Telnet URL contained in an e-mail message, triggering a buffer overflow.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0568",
            "reference": "CVE-2004-0568"
        },
        {
            "description": "Server allows remote attackers to cause a denial of service via a remote password array with an invalid length, which triggers a heap-based buffer overflow.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2003-0327",
            "reference": "CVE-2003-0327"
        },
        {
            "description": "Product allows remote attackers to cause a denial of service and possibly execute arbitrary code via an SMB packet that specifies a smaller buffer length than is required.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2003-0345",
            "reference": "CVE-2003-0345"
        },
        {
            "description": "Server allows remote attackers to execute arbitrary code via a LoginExt packet for a Cleartext Password User Authentication Method (UAM) request with a PathName argument that includes an AFPName type string that is longer than the associated length field.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0430",
            "reference": "CVE-2004-0430"
        },
        {
            "description": "PDF viewer allows remote attackers to execute arbitrary code via a PDF file with a large /Encrypt /Length keyLength value.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2005-0064",
            "reference": "CVE-2005-0064"
        },
        {
            "description": "SVN client trusts the length field of SVN protocol URL strings, which allows remote attackers to cause a denial of service and possibly execute arbitrary code via an integer overflow that leads to a heap-based buffer overflow.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0413",
            "reference": "CVE-2004-0413"
        },
        {
            "description": "Is effectively an accidental double increment of a counter that prevents a length check conditional from exiting a loop.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2004-0940",
            "reference": "CVE-2004-0940"
        },
        {
            "description": "Length field of a request not verified.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2002-1235",
            "reference": "CVE-2002-1235"
        },
        {
            "description": "Buffer overflow by modifying a length value.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2005-3184",
            "reference": "CVE-2005-3184"
        }
    ],
    "x_mitre_potential_mitigations": [
        {
            "description": "When processing structured incoming data containing a size field followed by raw data, ensure that you identify and resolve any inconsistencies between the size field and the actual size of the data.",
            "effectiveness": null,
            "phase": "Implementation"
        },
        {
            "description": "Do not let the user control the size of the buffer.",
            "effectiveness": null,
            "phase": "Implementation"
        },
        {
            "description": "Validate that the length of the user-supplied data is consistent with the buffer size.",
            "effectiveness": null,
            "phase": "Implementation"
        }
    ],
    "x_mitre_related_weaknesses": [
        {
            "cwe_id": "240",
            "nature": "ChildOf"
        },
        {
            "cwe_id": "119",
            "nature": "ChildOf"
        },
        {
            "cwe_id": "119",
            "nature": "ChildOf"
        },
        {
            "cwe_id": "805",
            "nature": "CanPrecede"
        }
    ]
}