{
    "type": "weakness",
    "spec_version": "2.1",
    "id": "weakness--f1c8d3cc-6421-4513-a5bb-b54e36f137f0",
    "created": "2024-08-13T14:46:48.824643Z",
    "modified": "2024-08-13T14:46:48.824643Z",
    "name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "object_marking_refs": [
        "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
    ],
    "external_references": [
        {
            "source_name": "CWE",
            "external_id": "22"
        }
    ],
    "x_mitre_common_consequences": [
        {
            "impact": "Execute Unauthorized Code or Commands",
            "scope": "Integrity"
        },
        {
            "impact": "Execute Unauthorized Code or Commands",
            "scope": "Confidentiality"
        },
        {
            "impact": "Execute Unauthorized Code or Commands",
            "scope": "Availability"
        },
        {
            "impact": "Modify Files or Directories",
            "scope": "Integrity"
        },
        {
            "impact": "Read Files or Directories",
            "scope": "Confidentiality"
        },
        {
            "impact": "DoS: Crash, Exit, or Restart",
            "scope": "Availability"
        }
    ],
    "x_mitre_content_history": [
        {
            "submission_date": "2006-07-19",
            "submission_name": "PLOVER",
            "submission_organization": null
        }
    ],
    "x_mitre_detection_methods": [
        {
            "description": "Automated techniques can find areas where path traversal weaknesses exist. However, tuning or customization may be required to remove or de-prioritize path-traversal problems that are only exploitable by the product's administrator - or other privileged users - and thus potentially valid behavior or, at worst, a bug instead of a vulnerability.",
            "effectiveness": "High",
            "method": "Automated Static Analysis"
        },
        {
            "description": "Manual white box techniques may be able to provide sufficient code coverage and reduction of false positives if all file access operations can be assessed within limited time constraints.",
            "effectiveness": "High",
            "method": "Manual Static Analysis"
        },
        {
            "description": "\n                  ",
            "effectiveness": "High",
            "method": "Automated Static Analysis - Binary or Bytecode"
        },
        {
            "description": "\n                  ",
            "effectiveness": "SOAR Partial",
            "method": "Manual Static Analysis - Binary or Bytecode"
        },
        {
            "description": "\n                  ",
            "effectiveness": "High",
            "method": "Dynamic Analysis with Automated Results Interpretation"
        },
        {
            "description": "\n                  ",
            "effectiveness": "High",
            "method": "Dynamic Analysis with Manual Results Interpretation"
        },
        {
            "description": "\n                  ",
            "effectiveness": "High",
            "method": "Manual Static Analysis - Source Code"
        },
        {
            "description": "\n                  ",
            "effectiveness": "High",
            "method": "Automated Static Analysis - Source Code"
        },
        {
            "description": "\n                  ",
            "effectiveness": "High",
            "method": "Architecture or Design Review"
        }
    ],
    "x_mitre_likelihood_of_exploit": "High",
    "x_mitre_observed_examples": [
        {
            "description": "Large language model (LLM) management tool does not\n               validate the format of a digest value (CWE-1287) from a\n               private, untrusted model registry, enabling relative\n               path traversal (CWE-23), a.k.a. Probllama",
            "link": "https://www.cve.org/CVERecord?id=CVE-2024-37032",
            "reference": "CVE-2024-37032"
        },
        {
            "description": "Chain: API for text generation using Large Language Models (LLMs) does\n\t\t\t   not include the \"\\\" Windows folder separator in its denylist (CWE-184)\n\t\t\t   when attempting to prevent Local File Inclusion via path traversal\n\t\t\t   (CWE-22), allowing deletion of arbitrary files on Windows systems.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2024-4315",
            "reference": "CVE-2024-4315"
        },
        {
            "description": "Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using \"../\" sequences (CWE-24)",
            "link": "https://www.cve.org/CVERecord?id=CVE-2022-45918",
            "reference": "CVE-2022-45918"
        },
        {
            "description": "Python package manager does not correctly restrict the filename specified in a Content-Disposition header, allowing arbitrary file read using path traversal sequences such as \"../\"",
            "link": "https://www.cve.org/CVERecord?id=CVE-2019-20916",
            "reference": "CVE-2019-20916"
        },
        {
            "description": "Python package constructs filenames using an unsafe os.path.join call on untrusted input, allowing absolute path traversal because os.path.join resets the pathname to an absolute path that is specified as part of the input.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2022-31503",
            "reference": "CVE-2022-31503"
        },
        {
            "description": "directory traversal in Go-based Kubernetes operator app allows accessing data from the controller's pod file system via ../ sequences in a yaml file",
            "link": "https://www.cve.org/CVERecord?id=CVE-2022-24877",
            "reference": "CVE-2022-24877"
        },
        {
            "description": "Chain: Cloud computing virtualization platform does not require authentication for upload of a tar format file (CWE-306), then uses .. path traversal sequences (CWE-23) in the file to access unexpected files, as exploited in the wild per CISA KEV.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2021-21972",
            "reference": "CVE-2021-21972"
        },
        {
            "description": "a Kubernetes package manager written in Go allows malicious plugins to inject path traversal sequences into a plugin archive (\"Zip slip\") to copy a file outside the intended directory",
            "link": "https://www.cve.org/CVERecord?id=CVE-2020-4053",
            "reference": "CVE-2020-4053"
        },
        {
            "description": "Chain: security product has improper input validation (CWE-20) leading to directory traversal (CWE-22), as exploited in the wild per CISA KEV.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2020-3452",
            "reference": "CVE-2020-3452"
        },
        {
            "description": "Go-based archive library allows extraction of  files to locations outside of the target folder with \"../\" path traversal sequences in filenames in a zip file, aka \"Zip Slip\"",
            "link": "https://www.cve.org/CVERecord?id=CVE-2019-10743",
            "reference": "CVE-2019-10743"
        },
        {
            "description": "Newsletter module allows reading arbitrary files using \"../\" sequences.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2010-0467",
            "reference": "CVE-2010-0467"
        },
        {
            "description": "Chain: PHP app uses extract for register_globals compatibility layer (CWE-621), enabling path traversal (CWE-22)",
            "link": "https://www.cve.org/CVERecord?id=CVE-2006-7079",
            "reference": "CVE-2006-7079"
        },
        {
            "description": "FTP server allows deletion of arbitrary files using \"..\" in the DELE command.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-4194",
            "reference": "CVE-2009-4194"
        },
        {
            "description": "FTP server allows creation of arbitrary directories using \"..\" in the MKD command.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-4053",
            "reference": "CVE-2009-4053"
        },
        {
            "description": "FTP service for a Bluetooth device allows listing of directories, and creation or reading of files using \"..\" sequences.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-0244",
            "reference": "CVE-2009-0244"
        },
        {
            "description": "Software package maintenance program allows overwriting arbitrary files using \"../\" sequences.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-4013",
            "reference": "CVE-2009-4013"
        },
        {
            "description": "Bulletin board allows attackers to determine the existence of files using the avatar.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-4449",
            "reference": "CVE-2009-4449"
        },
        {
            "description": "PHP program allows arbitrary code execution using \"..\" in filenames that are fed to the include() function.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-4581",
            "reference": "CVE-2009-4581"
        },
        {
            "description": "Overwrite of files using a .. in a Torrent file.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2010-0012",
            "reference": "CVE-2010-0012"
        },
        {
            "description": "Chat program allows overwriting files using a custom smiley request.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2010-0013",
            "reference": "CVE-2010-0013"
        },
        {
            "description": "Chain: external control of values for user's desired language and theme enables path traversal.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2008-5748",
            "reference": "CVE-2008-5748"
        },
        {
            "description": "Chain: library file sends a redirect if it is directly requested but continues to execute, allowing remote file inclusion and path traversal.",
            "link": "https://www.cve.org/CVERecord?id=CVE-2009-1936",
            "reference": "CVE-2009-1936"
        }
    ],
    "x_mitre_potential_mitigations": [
        {
            "description": "\n                  ",
            "effectiveness": null,
            "phase": "Implementation"
        },
        {
            "description": "For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side, in order to avoid CWE-602. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server.",
            "effectiveness": null,
            "phase": "Architecture and Design"
        },
        {
            "description": "\n                  ",
            "effectiveness": null,
            "phase": "Implementation"
        },
        {
            "description": "Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid.",
            "effectiveness": null,
            "phase": "Architecture and Design"
        },
        {
            "description": "Use an application firewall that can detect attacks against this weakness. It can be beneficial in cases in which the code cannot be fixed (because it is controlled by a third party), as an emergency prevention measure while more comprehensive software assurance measures are applied, or to provide defense in depth.",
            "effectiveness": "Moderate",
            "phase": "Operation"
        },
        {
            "description": "Run your code using the lowest privileges that are required to accomplish the necessary tasks [REF-76]. If possible, create isolated accounts with limited privileges that are only used for a single task. That way, a successful attack will not immediately give the attacker access to the rest of the software or its environment. For example, database applications rarely need to run as the database administrator, especially in day-to-day operations.",
            "effectiveness": null,
            "phase": "Architecture and Design"
        },
        {
            "description": "\n                  ",
            "effectiveness": null,
            "phase": "Architecture and Design"
        },
        {
            "description": "\n                  ",
            "effectiveness": "Limited",
            "phase": "Architecture and Design"
        },
        {
            "description": "\n                  ",
            "effectiveness": null,
            "phase": "Architecture and Design"
        },
        {
            "description": "\n                  ",
            "effectiveness": null,
            "phase": "Implementation"
        },
        {
            "description": "When using PHP, configure the application so that it does not use register_globals. During implementation, develop the application so that it does not rely on this feature, but be wary of implementing a register_globals emulation that is subject to weaknesses such as CWE-95, CWE-621, and similar issues.",
            "effectiveness": null,
            "phase": "Operation"
        }
    ],
    "x_mitre_references": [
        {
            "external_reference_id": "REF-7"
        },
        {
            "external_reference_id": "REF-45"
        },
        {
            "external_reference_id": "REF-185"
        },
        {
            "external_reference_id": "REF-186"
        },
        {
            "external_reference_id": "REF-76"
        },
        {
            "external_reference_id": "REF-62"
        },
        {
            "external_reference_id": "REF-962"
        },
        {
            "external_reference_id": "REF-1448"
        }
    ],
    "x_mitre_related_weaknesses": [
        {
            "cwe_id": "706",
            "nature": "ChildOf"
        },
        {
            "cwe_id": "706",
            "nature": "ChildOf"
        },
        {
            "cwe_id": "668",
            "nature": "ChildOf"
        }
    ]
}