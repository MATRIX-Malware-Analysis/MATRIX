{
    "type": "relationship",
    "spec_version": "2.1",
    "id": "relationship--7d3d9d78-4a82-4e74-9e67-c236334bf6ff",
    "created": "2024-08-13T14:51:21.679499Z",
    "modified": "2024-08-13T14:51:21.679515Z",
    "relationship_type": "detects",
    "source_ref": "x-mitre-data-component--0935b964-b044-4905-9b60-dc5cc1712193",
    "target_ref": "malware-behavior--1c338d0f-a65e-4073-a5c1-c06878849f21",
    "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
    ],
    "external_references": [],
    "description": "Monitor for newly executed processes that may inject malicious code into suspended and hollowed processes in order to evade process-based defenses. Adversaries may start legitimate processes and then use their memory space to run malicious code. This analytic looks for common Windows processes that have been abused this way in the past; when the processes are started for this purpose they may not have the standard parent that we would expect. This list is not exhaustive, and it is possible for cyber actors to avoid this discepency. These signatures only work if Sysmon reports the parent process, which may not always be the case if the parent dies before sysmon processes the event.\n\nAnalytic 1 - Processes Started From Irregular Parents\n\n<code>(source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"1\") OR (source=\"*WinEventLog:Security\" EventCode=\"4688\") AND ParentImage!=\"?\" AND ParentImage!=\"C:\\\\Program Files\\\\SplunkUniversalForwarder\\\\bin\\\\splunk-regmon.exe\" AND ParentImage!=\"C:\\\\Program Files\\\\SplunkUniversalForwarder\\\\bin\\\\splunk-powershell.exe\" AND\n((Image=\"C:\\\\Windows\\System32\\\\smss.exe\" AND (ParentImage!=\"C:\\\\Windows\\\\System32\\\\smss.exe\" AND ParentImage!=\"System\")) OR\n(Image=\"C:\\\\Windows\\\\System32\\\\csrss.exe\" AND (ParentImage!=\"C:\\\\Windows\\\\System32\\\\smss.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\svchost.exe\")) OR\n(Image=\"C:\\\\Windows\\\\System32\\\\wininit.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\smss.exe\") OR\n(Image=\"C:\\\\Windows\\\\System32\\\\winlogon.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\smss.exe\") OR\n(Image=\"C:\\\\Windows\\\\System32\\\\lsass.exe\" and ParentImage!=\"C:\\\\Windows\\\\System32\\\\wininit.exe\") OR\n(Image=\"C:\\\\Windows\\\\System32\\\\LogonUI.exe\" AND (ParentImage!=\"C:\\\\Windows\\\\System32\\\\winlogon.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\wininit.exe\")) OR\n(Image=\"C:\\\\Windows\\\\System32\\\\services.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\wininit.exe\") OR\n(Image=\"C:\\\\Windows\\\\System32\\\\spoolsv.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\services.exe\") OR\n(Image=\"C:\\\\Windows\\\\System32\\\\taskhost.exe\" AND (ParentImage!=\"C:\\\\Windows\\\\System32\\\\services.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\svchost.exe\")) OR\n(Image=\"C:\\\\Windows\\\\System32\\\\taskhostw.exe\" AND (ParentImage!=\"C:\\\\Windows\\\\System32\\\\services.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\svchost.exe\")) OR\n(Image=\"C:\\\\Windows\\System32\\\\userinit.exe\" AND (ParentImage!=\"C:\\\\Windows\\\\System32\\\\dwm.exe\" AND ParentImage!=\"C:\\\\Windows\\\\System32\\\\winlogon.exe\")))</code>",
    "x_mitre_version": "0.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
}