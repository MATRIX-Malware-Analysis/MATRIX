{
    "type": "relationship",
    "spec_version": "2.1",
    "id": "relationship--d2332d0a-81b5-43eb-a92e-7bc2229cf504",
    "created": "2024-08-13T14:51:21.835849Z",
    "modified": "2024-08-13T14:51:21.835851Z",
    "relationship_type": "detects",
    "source_ref": "x-mitre-data-component--6a81060d-3847-4b03-9b38-7273c3c2a2a2",
    "target_ref": "malware-behavior--ad179030-4c07-4e57-b204-a7e8ad70c6d7",
    "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
    ],
    "external_references": [
        {
            "source_name": "Microsoft GetAllTrustRelationships",
            "url": "https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.activedirectory.domain.getalltrustrelationships?redirectedfrom=MSDN&view=netframework-4.7.2#System_DirectoryServices_ActiveDirectory_Domain_GetAllTrustRelationships",
            "description": "Microsoft. (n.d.). Domain.GetAllTrustRelationships Method. Retrieved February 14, 2019."
        },
        {
            "source_name": "Harmj0y Domain Trusts",
            "url": "https://posts.specterops.io/a-guide-to-attacking-domain-trusts-971e52cb2944",
            "description": "Schroeder, W. (2017, October 30). A Guide to Attacking Domain Trusts. Retrieved February 14, 2019."
        }
    ],
    "description": "Monitor for API calls associated with gathering information on domain trust relationships that may be used to identify lateral movement like DSEnumerateDomainTrusts() Win32 API call to spot activity associated with Domain Trust Discovery.(Citation: Harmj0y Domain Trusts) Information may also be acquired through Windows system management tools such as PowerShell. The .NET method GetAllTrustRelationships() can be an indicator of Domain Trust Discovery.(Citation: Microsoft GetAllTrustRelationships)",
    "x_mitre_version": "0.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
}