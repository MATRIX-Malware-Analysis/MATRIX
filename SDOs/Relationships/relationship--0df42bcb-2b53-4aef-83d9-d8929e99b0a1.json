{
    "type": "relationship",
    "spec_version": "2.1",
    "id": "relationship--0df42bcb-2b53-4aef-83d9-d8929e99b0a1",
    "created": "2024-08-13T14:51:23.573077Z",
    "modified": "2024-08-13T14:51:23.573080Z",
    "relationship_type": "detects",
    "source_ref": "x-mitre-data-component--0935b964-b044-4905-9b60-dc5cc1712193",
    "target_ref": "malware-behavior--65f2d882-3f41-4d48-8a06-29af77ec9f90",
    "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
    ],
    "external_references": [],
    "description": "Monitor for newly executed processes that may be indicative of credential dumping. On Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process. Try monitoring for Sysmon Event ID 1 and/or Windows Security Event ID 4688 for process activity. \n\nNote: \n- Rundll32/MiniDump has a different command-line syntax than that of Procdump, in that the process being dumped is specified via process ID instead of name (as with Procdump). Therefore, because the LSASS process ID is non-deterministic, the MiniDump detection isn\u2019t specific to LSASS dumping and may need to be tuned to help reduce false positives.\n- When monitoring for .dll  functions on the command-line be sure to also check for the ordinal associated with the function.\n\nAnalytic 1 - Procdump\n\n```(source=WinEventLog:\"*Security\" EventCode=\"4688\") OR (source=WinEventLog:\"*Microsoft-Windows-Sysmon/Operational\" EventCode=\"1\") AND Image=\"procdump*.exe\" | where CommandLine LIKE \"%lsass%\"```\n\nAnalytic 2 - MiniDump via rundll32\n\n```(source=WinEventLog:\"*Security\" EventCode=\"4688\") OR (source=WinEventLog:\"*Microsoft-Windows-Sysmon/Operational\" EventCode=\"1\") AND Image=\"\\*rundll32.exe\" | where CommandLine LIKE \"%comsvcs.dll MiniDump%\" OR CommandLine=\"_comsvcs.dll,#24\")```\n",
    "x_mitre_version": "0.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
}