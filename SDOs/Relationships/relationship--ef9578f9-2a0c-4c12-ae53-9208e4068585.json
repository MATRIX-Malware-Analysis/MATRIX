{
    "type": "relationship",
    "spec_version": "2.1",
    "id": "relationship--ef9578f9-2a0c-4c12-ae53-9208e4068585",
    "created": "2024-08-13T14:51:21.997489Z",
    "modified": "2024-08-13T14:51:21.997491Z",
    "relationship_type": "detects",
    "source_ref": "x-mitre-data-component--0935b964-b044-4905-9b60-dc5cc1712193",
    "target_ref": "malware-behavior--e1f9cdd2-9511-4fca-90d7-f3e92cfdd0bf",
    "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
    ],
    "external_references": [],
    "description": "Monitor for newly executed processes that may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as RDP, telnet, SSH, and VNC. The adversary may then perform actions that spawn additional processes as the logged-on user.\n\nMalicious actors may rename built-in commands or external tools, such as those provided by SysInternals, to better\u00a0blend in\u00a0with the environment. In those cases, the file path name is arbitrary and may blend in well with the background. If the arguments are closely inspected, it may be possible to infer what tools are running and understand what an adversary is doing. When any legitimate software shares the same command lines, it must be whitelisted according to the expected parameters.\n\nAny tool of interest with commonly known command line usage can be detecting by command line analysis. Known substrings of command lines include\n\n- PuTTY\n- port forwarding\u00a0<code>-R * -pw</code>\n- secure copy (scp)\u00a0<code>-pw * * *@*</code>\n- mimikatz\u00a0<code>sekurlsa::</code>\n- RAR\u00a0<code>* -hp *</code>\n- Archive* a *\u00a0Additionally, it may be useful to find IP addresses in the command line\n- <code>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}</code>\n\nAnalytic 1 - Suspicious Arguments\n\n<code>(source=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode=\"1\") OR (source=\"WinEventLog:Security\" EventCode=\"4688\") AND \nCommandLine=\"-R .* -pw\" OR \nCommandLine=\"-pw .* .* .*@.*\" OR \nCommandLine=\"sekurlsa\" OR \nCommandLine=\" -hp \" OR \nCommandLine=\".* a .*\" </code>",
    "x_mitre_version": "0.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
}