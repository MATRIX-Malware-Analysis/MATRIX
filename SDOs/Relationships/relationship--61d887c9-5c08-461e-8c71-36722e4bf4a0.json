{
    "type": "relationship",
    "spec_version": "2.1",
    "id": "relationship--61d887c9-5c08-461e-8c71-36722e4bf4a0",
    "created": "2024-08-13T14:51:22.399392Z",
    "modified": "2024-08-13T14:51:22.399394Z",
    "relationship_type": "detects",
    "source_ref": "x-mitre-data-component--1d5b3b74-1c67-4c50-8642-6f354efb039c",
    "target_ref": "malware-behavior--eb125d40-0b2d-41ac-a71a-3229241c2cd3",
    "object_marking_refs": [
        "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
    ],
    "external_references": [],
    "description": "Monitor for the creation to Registry keys associated with Windows logon scrips, nameley <code>HKCU\\Environment\\UserInitMprLogonScript</code>.\n\nAdversaries may schedule software to run whenever a user logs into the system; this is done to establish persistence and sometimes for lateral movement. This trigger is established through the registry key HKEY_CURRENT_USER\\EnvironmentUserInitMprLogonScript. This signature looks edits to existing keys or creation of new keys in that path. Users purposefully adding benign scripts to this path will result in false positives; that case is rare, however. There are other ways of running a script at startup or login that are not covered in this signature. Note that this signature overlaps with the Windows Sysinternals Autoruns tool, which would also show changes to this registry path.\n\nAnalytic 1 - Boot or Logon Initialization Scripts\n\n<code> (source=\"*WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventCode IN (12, 14, 13)) TargetObject= \"*\\Environment*UserInitMprLogonScript\")  </code>",
    "x_mitre_version": "0.1",
    "x_mitre_modified_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
}