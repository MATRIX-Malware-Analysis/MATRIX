{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--af195d01-1b19-40ce-b20a-8739841c60da",
    "created": "2024-08-14T16:33:18.004341Z",
    "modified": "2024-08-14T16:33:18.004345Z",
    "name": "Multi Manage the screensaver of the target computer",
    "description": " This module allows you to turn on or off the screensaver of the target computer and also lock the current session.  'License' => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/post/multi/manage/screensaver.rb",
            "external_id": "screensaver.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Post\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'Multi Manage the screensaver of the target computer',\n        'Description' => %q{\n          This module allows you to turn on or off the screensaver of the target computer and also\n          lock the current session.\n        },\n        'License' => MSF_LICENSE,\n        'Author' => [ 'Eliott Teissonniere'],\n        'Platform' => [ 'linux', 'osx', 'win' ],\n        'SessionTypes' => [ 'shell', 'meterpreter' ],\n        'Actions' => [\n          [ 'LOCK', { 'Description' => 'Lock the current session' } ],\n          [ 'START', { 'Description' => 'Start the screensaver, may lock the current session' } ],\n          [ 'STOP', { 'Description' => 'Stop the screensaver, user may be prompted for its password' }]\n        ]\n      )\n    )\n  end\n\n  #\n  # cmd_exec but with some controls and verbosity\n  #\n  def cmd_vexec(cmd)\n    print_status(\"Executing '#{cmd}'\")\n\n    begin\n      cmd_exec(cmd)\n    rescue EOFError\n      print_error('Command failed')\n      return false\n    end\n\n    true\n  end\n\n  def lock_session\n    case session.platform\n    when 'linux'\n      cmd_vexec('xdg-screensaver lock')\n    when 'osx'\n      cmd_vexec('pmset displaysleepnow')\n    when 'windows'\n      cmd_vexec('rundll32 user32.dll,LockWorkStation')\n    end\n\n    true\n  end\n\n  def start_screensaver\n    case session.platform\n    when 'linux'\n      cmd_vexec('xdg-screensaver activate')\n    when 'osx'\n      cmd_vexec('open -a ScreenSaverEngine')\n    when 'windows'\n      cmd_vexec('powershell -w hidden -nop -c \"Start-Process C:\\\\Windows\\\\System32\\\\scrnsave.scr\"')\n    end\n\n    true\n  end\n\n  def stop_screensaver\n    case session.platform\n    when 'linux'\n      cmd_vexec('xdg-screensaver reset')\n    when 'osx'\n      print_error('Not supported on Mac OSX, you can still lock the screen or start the screensaver')\n      return false\n    when 'windows'\n      print_error('Not supported on Windows, you can still lock the screen or start the screensaver')\n      return false\n    end\n\n    true\n  end\n\n  def run\n    if action.nil?\n      print_error('Please specify an action')\n    end\n\n    case action.name\n    when 'LOCK'\n      return lock_session\n    when 'START'\n      return start_screensaver\n    when 'STOP'\n      return stop_screensaver\n    end\n  end\nend\n",
    "x_mitre_platforms": [
        "[ 'linux', 'osx', 'win' ]"
    ]
}