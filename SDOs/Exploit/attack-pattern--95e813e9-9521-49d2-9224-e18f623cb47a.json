{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--95e813e9-9521-49d2-9224-e18f623cb47a",
    "created": "2024-08-14T16:29:36.715101Z",
    "modified": "2024-08-14T16:29:36.715106Z",
    "name": "Supermicro Onboard IPMI Static SSL Certificate Scanner",
    "description": " This module checks for a static SSL certificate shipped with Supermicro Onboard IPMI controllers. An attacker with access to the publicly-available firmware can perform man-in-the-middle attacks and offline decryption of communication to the controller. This module has been on a Supermicro Onboard IPMI (X9SCL/X9SCM) with firmware version SMT_X9_214. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/scanner/http/smt_ipmi_static_cert_scanner.rb",
            "external_id": "smt_ipmi_static_cert_scanner.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2013-3619"
        },
        {
            "source_name": "reference",
            "url": "https://www.rapid7.com/blog/post/2013/11/06/supermicro-ipmi-firmware-vulnerabilities/"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Scanner\n  include Msf::Auxiliary::Report\n\n  PRIVATE_KEY = <<-EOF.gsub(/^ {4}/, '')\n    -----BEGIN RSA PRIVATE KEY-----\n    MIICXQIBAAKBgQC1q1kR6chWLfwspD84Asyy6EFV6SYRGy/gILsYGtn9kCQi2RFo\n    bNxS5CvphbGWn9D9n5gJpTVWLWb3LwJxGuBKSRj2wrHLlejzw6kSmF+3xFCuMfxV\n    FSj8TM8JqlOqM1c6lvH2MSXnN7pJBVcekNKbBUEfptakPSejStljbXecSwIDAQAB\n    AoGAah4/FzGiboTKCyGeNA+eltsIXzCjpdZlrtwvrbLxpyXtldWKT59XS6ww4mXQ\n    CJYuNBhnbSrt7vrybG0vVfZHEOCvK+5YKBOtvRgrWDgs1Bkc5hsdI5gLx3jE7g6M\n    PuUvD7ueF4OzYeYRrOLWr957jl32n+hD/k65bKWAUp3aTDECQQDqnEPZWlmoH7Jp\n    6woRnEp+1cullHv8DviM5Huh+JeBotSa03p4unhKlRYSqnHdeHU2343n1VUDzvnV\n    LQWi5G+FAkEAxjt0S67lyuuVD842uZRHt2WSQvwt23aKzQ+EJwV0IXYzfefeLzEm\n    dDdvc1AJ31gweAQK89/5/1EEF40K7BJdjwJBAJDFdtTT/QlS7eyQPjlZwVp9IVp+\n    wvdqYZPHlkb/uLYlPZ6Aq01+e6ZCU0mXZgYtQ99lmhKaQQjFmsMiMh0va2UCQA2T\n    NLuaFpJ235ZdgNHknaSpiAKeUmWdEJRKY7poXTONbKlKn6SLsR50TWWQLZzl5SvS\n    2w0oYW5ile0m84CHIXECQQCrABn0HY4Ll9/4FX+OCWamqwENltU1GcGIogeyFymK\n    ZVX8QdAVoUiZoUaVku946j63WNSkI1sU/UWhL6XDt4gx\n    -----END RSA PRIVATE KEY-----\n  EOF\n\n\n  def initialize\n    super(\n      'Name'        => 'Supermicro Onboard IPMI Static SSL Certificate Scanner',\n      'Description' => %q{\n        This module checks for a static SSL certificate shipped with Supermicro Onboard IPMI\n        controllers. An attacker with access to the publicly-available firmware can perform\n        man-in-the-middle attacks and offline decryption of communication to the controller.\n        This module has been on a Supermicro Onboard IPMI (X9SCL/X9SCM) with firmware\n        version SMT_X9_214.\n      },\n      'Author'       =>\n        [\n          'hdm', # Discovery and analysis\n          'juan' # Metasploit module\n        ],\n      'License'     => MSF_LICENSE,\n      'References'  =>\n        [\n          [ 'CVE', '2013-3619' ],\n          [ 'URL', 'https://www.rapid7.com/blog/post/2013/11/06/supermicro-ipmi-firmware-vulnerabilities/']\n        ],\n      'DisclosureDate' => 'Nov 06 2013'\n    )\n\n    register_options(\n      [\n        Opt::RPORT(443),\n      ])\n  end\n\n  # Fingerprint a single host\n  def run_host(ip)\n    connect(true, {\"SSL\" => true}) #Force SSL\n    cert  = OpenSSL::X509::Certificate.new(sock.peer_cert)\n    disconnect\n\n    unless cert\n      vprint_error(\"#{ip}:#{rport} - No certificate found\")\n      return\n    end\n\n    pkey = OpenSSL::PKey::RSA.new(PRIVATE_KEY)\n    result = cert.verify(pkey)\n\n    if result\n      print_good(\"#{ip}:#{rport} - Vulnerable to CVE-2013-3619 (Static SSL Certificate)\")\n      # Report with the SSL Private Key hash for the host\n      digest = OpenSSL::Digest::SHA1.new(pkey.public_key.to_der).to_s.scan(/../).join(\":\")\n      report_note(\n        :host  => ip,\n        :proto => 'tcp',\n        :port  => rport,\n        :type  => 'supermicro.ipmi.ssl.certificate.pkey_hash',\n        :data  => digest\n      )\n\n      report_vuln({\n        :host  => rhost,\n        :port  => rport,\n        :proto => 'tcp',\n        :name  => \"Supermicro Onboard IPMI Static SSL Certificate\",\n        :refs  => self.references\n      })\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "Nov 06 2013"
}