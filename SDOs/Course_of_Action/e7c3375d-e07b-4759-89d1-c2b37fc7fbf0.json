{
    "type": "course-of-action",
    "spec_version": "2.1",
    "id": "course-of-action--e7c3375d-e07b-4759-89d1-c2b37fc7fbf0",
    "created": "2024-08-14T07:36:38.412116Z",
    "modified": "2024-08-14T07:36:38.412116Z",
    "name": "Reference - CAR-2015-04-001: Remotely Scheduled Tasks via AT - MITRE",
    "description": "No description available",
    "x_kb_abstract": "When AT.exe is used to remotely schedule tasks, Windows uses named pipes over SMB to communicate with the API on the remote machine. After authentication over SMB, the Named Pipe \u201cATSVC\u201d is opened, over which the JobAdd function is called. On the remote host, the job files are created by the Task Scheduler and follow the convention C:\\Windows\\System32\\AT<job\\_id>. Unlike CAR-2013-05-004, this analytic specifically focuses on uses of AT that can be detected between hosts, indicating remotely gained execution.\n\nThis pipe activity could be discovered with a network decoder, such as that in wireshark, that can inspect SMB traffic to identify the use of pipes. It could also be detected by looking for raw packet capture streams or from a custom sensor on the host that hooks the appropriate API functions. If no network or API level of visibility is possible, this traffic may inferred by looking at SMB connections over 445/tcp followed by the creation of files matching the pattern C:\\Windows\\System32\\AT\\<job_id\\>.",
    "x_kb_author": "MITRE",
    "x_kb_organization": "MITRE",
    "x_kb_reference_of": "http://d3fend.mitre.org/ontologies/d3fend.owl#IPCTrafficAnalysis",
    "x_kb_reference_title": "CAR-2015-04-001: Remotely Scheduled Tasks via AT"
}