{
    "data": [
        {
            "id": "5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_CAPA"
            },
            "attributes": {
                "signature_matches": [
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n",
                        "name": "create process on Windows",
                        "description": "host-interaction/process/create"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - api: kernel32.Sleep\n      - api: kernel32.SleepEx\n      - api: kernel32.WaitForSingleObject\n      - api: kernel32.SignalObjectAndWait\n      - api: kernel32.WaitForSingleObjectEx\n      - api: kernel32.WaitForMultipleObjects\n      - api: kernel32.WaitForMultipleObjectsEx\n      - api: kernel32.RegisterWaitForSingleObject\n      - api: WaitOnAddress\n      - api: user32.MsgWaitForMultipleObjects\n      - api: user32.MsgWaitForMultipleObjectsEx\n      - api: NtDelayExecution\n      - api: KeWaitForSingleObject\n      - api: KeDelayExecutionThread\n",
                        "name": "delay execution",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "description": "linking/runtime-linking",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm"
                            },
                            {
                                "ref": "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "access PEB ldr_data"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
                        "name": "encode data using XOR",
                        "description": "data-manipulation/encoding/xor"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - api: System.Threading.Thread::Start\n",
                        "name": "create thread",
                        "description": "host-interaction/thread/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create or open registry key\n    namespace: host-interaction/registry\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n",
                        "name": "create or open registry key",
                        "description": "host-interaction/registry"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Disassembler Evasion::Argument Obfuscation [B0012.001]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n",
                        "name": "contain obfuscated stackstrings",
                        "description": "anti-analysis/obfuscation/string/stackstring"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n",
                        "name": "get common file path",
                        "description": "host-interaction/file-system"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n",
                        "name": "write file on Windows",
                        "description": "host-interaction/file-system/write"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - match: contain a resource (.rsrc) section\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n      - api: user32.LoadString\n",
                        "name": "extract resource via kernel32 functions",
                        "description": "executable/resource"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n",
                        "name": "read file on Windows",
                        "description": "host-interaction/file-system/read"
                    },
                    {
                        "description": "data-manipulation/hashing/md5",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data with MD5\n    namespace: data-manipulation/hashing/md5\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - Cryptography::Cryptographic Hash::MD5 [C0029.001]\n    references:\n      - https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x100108ED\n  features:\n    - or:\n      - and:\n        - description: magic initialization constants from MD4 and MD5\n        - number: 0x67452301 = A\n        - number: 0xefcdab89 = B\n        - number: 0x98badcfe = C\n        - number: 0x10325476 = D\n        - not:\n          - number: 0xc3d2e1f0 = likely SHA1\n        - optional:\n          - description: specific compilation from https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp\n          - and:\n            - offset: -0x28955B88\n            - offset: -0x173848AA\n      - basic block:\n        - and:\n          - number: 0x8003 = CALG_MD5\n          - api: advapi32.CryptCreateHash\n      - and:\n        - format: dotnet\n        - api: System.Security.Cryptography.MD5::Create\n        - api: System.Security.Cryptography.HashAlgorithm::ComputeHash\n",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "name": "hash data with MD5"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: prepare HTTP request\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Create Request [C0002.012]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10002650\n  features:\n    - or:\n      - api: winhttp.WinHttpOpenRequest\n",
                        "name": "prepare HTTP request",
                        "description": "communication/http/client"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: initialize WinHTTP library\n    namespace: communication/http\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::WinHTTP [C0002.008]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000E670\n  features:\n    - and:\n      - api: winhttp.WinHttpOpen\n",
                        "name": "initialize WinHTTP library",
                        "description": "communication/http"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read HTTP header\n    namespace: communication/http\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Read Header [C0002.014]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10002A30\n  features:\n    - and:\n      - api: winhttp.WinHttpQueryHeaders\n",
                        "name": "read HTTP header",
                        "description": "communication/http"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set HTTP header\n    namespace: communication/http\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Set Header [C0002.013]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x1000E230\n  features:\n    - and:\n      - api: winhttp.WinHttpAddRequestHeaders\n",
                        "name": "set HTTP header",
                        "description": "communication/http"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: receive HTTP response\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::HTTP Communication::Get Response [C0002.017]\n    examples:\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10002790\n  features:\n    - or:\n      - api: System.Net.WebRequest::GetResponse\n      - api: winhttp.WinHttpReceiveResponse\n      - and:\n        - api: winhttp.WinHttpReadData\n        - optional:\n          - api: winhttp.WinHttpQueryDataAvailable\n",
                        "name": "receive HTTP response",
                        "description": "communication/http/client"
                    },
                    {
                        "description": "can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function"
                            },
                            {
                                "ref": "http://isthe.com/chongo/tech/comp/fnv/"
                            },
                            {
                                "ref": "https://create.stephan-brumme.com/fnv-hash/"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using fnv\n    namespace: data-manipulation/hashing/fnv\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    description: can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0\n    scope: function\n    mbc:\n      - Data::Non-Cryptographic Hash::FNV [C0030.005]\n    references:\n      - https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n      - http://isthe.com/chongo/tech/comp/fnv/\n      - https://create.stephan-brumme.com/fnv-hash/\n    examples:\n      - ad4229879180e267f431ac6666b6a0a2:0x14007B4D4\n  features:\n    - and:\n      - optional:\n        - characteristic: loop\n        - number: 0xcbf29ce484222325 = FNV_offset_basis, unused by FNV-0\n        - number: 0x811c9dc5 = FNV_offset_basis, unused by FNV-0\n      - or:\n        - number: 0x100000001b3 = FNV prime\n        - number: 0x01000193 = FNV prime\n      - basic block:\n        # FNV-1 hash does multiply then XOR\n        # FNV-1a hash does XOR then multiply\n        - and:\n          - characteristic: nzxor\n          - or:\n            - mnemonic: imul\n            - mnemonic: mul\n",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "@_re_fox",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "hash data using fnv"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "@_re_fox"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse credit card information\n    namespace: collection/credit-card\n    authors:\n      - \"@_re_fox\"\n    scope: function\n    mbc:\n      - Data::Check String [C0019]\n    examples:\n      - 1d8fd13c890060464019c0f07b928b1a:0x402860\n  features:\n    - and:\n      - 3 or more:\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x5E = '^' (Track 1 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3D = '=' (Track 2 separator)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x25 = '%' (Track 1 start sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x42 = 'B' (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x44 = 'D' (Format code)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3F = '?' (Track 1 & 2 end sentinel)\n        - instruction:\n          - mnemonic: cmp\n          - number: 0x3B = ';' (Track 2 start sentinel)\n      - not:\n        - description: if a function also compares these non-hex characters it's most likely NOT parsing CC data\n        - and:\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6D = 'm'\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6E = 'n'\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x6F = 'o'\n          - instruction:\n            - mnemonic: cmp\n            - number: 0x70 = 'p'\n",
                        "name": "parse credit card information",
                        "description": "collection/credit-card"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get token membership\n    namespace: host-interaction/session\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n    examples:\n      - mimikatz.exe_:0x40DABE\n  features:\n    - and:\n      - api: advapi32.CheckTokenMembership\n      - optional:\n        - api: advapi32.AllocateAndInitializeSid\n        - api: advapi32.FreeSid\n",
                        "name": "get token membership",
                        "description": "host-interaction/session"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n",
                        "name": "copy file",
                        "description": "host-interaction/file-system/copy"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    # TODO filter out false positives\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n",
                        "name": "parse PE header",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n      - and:\n        - match: host-interaction/process/create\n        - string: /reg(|.exe) add /i\n",
                        "name": "set registry value",
                        "description": "host-interaction/registry/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe"
                        ],
                        "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get geographical location\n    namespace: collection\n    authors:\n      - moritz.raabe\n    scope: function\n    att&ck:\n      - Discovery::System Location Discovery [T1614]\n    examples:\n      - 9879D201DC5ACA863F357184CD1F170E:0x10001A99\n  features:\n    - or:\n      - api: GetLocaleInfo\n      - api: GetLocaleInfoEx\n      # strings part of requests or parsed from response\n      # \"geo\" and \"zip\" are too short\n      # \"region\" results in FPs mostly related to memory\n      - string: /geolocation/i\n      - string: /geo-location/i\n      - string: /^city/i\n      - string: /region_code/i\n      - string: /region_name/i\n      - string: /^country/i\n      - string: /country_code/i\n      - string: /countrycode/i\n      - string: /country_name/i\n      - string: /continent_code/i\n      - string: /continent_name/i\n      - string: /^latitude/i\n      - string: /^longitude/i\n",
                        "name": "get geographical location",
                        "description": "collection"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: persist via Run registry key\n    namespace: persistence/registry/run\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n    examples:\n      - Practical Malware Analysis Lab 06-03.exe_:0x401130\n      - b87e9dd18a5533a09d3e48a7a1efbcf6:0x1400070E0\n      - 9ff8e68343cc29c1036650fc153e69f7:0x470624\n  features:\n    - and:\n      - or:\n        - match: set registry value\n        - number: 0x80000001 = HKEY_CURRENT_USER\n        - number: 0x80000002 = HKEY_LOCAL_MACHINE\n      - or:\n        - and:\n          - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion/i\n          - or:\n            - string: /Run/i\n            - string: /Explorer\\\\Shell Folders/i\n            - string: /User Shell Folders/i\n            - string: /RunServices/i\n            - string: /Policies\\\\Explorer\\\\Run/i\n        - string: /Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\load/i\n        - string: /System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\BootExecute/i\n",
                        "name": "persist via Run registry key",
                        "description": "persistence/registry/run"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n",
                        "name": "contain a resource (.rsrc) section",
                        "description": "executable/pe/section/rsrc"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n",
                        "name": "contain an embedded PE file",
                        "description": "executable/subfile/pe"
                    },
                    {
                        "description": "linking/static/cppregex",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "http://www.cplusplus.com/reference/regex/regex_error/"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: linked against CPP regex library\n    namespace: linking/static/cppregex\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n    references:\n      - http://www.cplusplus.com/reference/regex/regex_error/\n  features:\n    - or:\n      - string: \"regex_error(error_syntax)\"\n        description: C++ STL regex library\n      - string: \"regex_error(error_collate): The expression contained an invalid collating element name.\"\n",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "linked against CPP regex library"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n",
                        "name": "contains PDB path",
                        "description": "executable/pe/pdb"
                    }
                ],
                "has_memdump": false,
                "analysis_date": 1676960336,
                "sandbox_name": "CAPA",
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "access PEB ldr_data"
                            }
                        ],
                        "signature_description": "access PEB ldr_data",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ],
                        "signature_description": "contain obfuscated stackstrings",
                        "id": "T1027.005",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ],
                        "signature_description": "get common file path",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get token membership"
                            }
                        ],
                        "signature_description": "get token membership",
                        "id": "T1033",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "parse PE header"
                            }
                        ],
                        "signature_description": "parse PE header",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get geographical location"
                            }
                        ],
                        "signature_description": "get geographical location",
                        "id": "T1614",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "persist via Run registry key"
                            }
                        ],
                        "signature_description": "persist via Run registry key",
                        "id": "T1547.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_html_report": false,
                "last_modification_date": 1676960336,
                "has_evtx": false,
                "has_pcap": false,
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480"
            }
        },
        {
            "id": "5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_VenusEye Sandbox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_VenusEye Sandbox"
            },
            "attributes": {
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "208.95.112.1"
                        ],
                        "hostname": "ip-api.com"
                    },
                    {
                        "resolved_ips": [
                            "69.171.244.12"
                        ],
                        "hostname": "www.facebook.com"
                    },
                    {
                        "resolved_ips": [
                            "192.157.193.137"
                        ],
                        "hostname": "hfuie32.2ihsfa.com"
                    }
                ],
                "has_memdump": false,
                "processes_tree": [
                    {
                        "process_id": "496",
                        "name": "lsass.exe"
                    },
                    {
                        "process_id": "3480",
                        "name": "56ca13666918d6227702bada9419fcb4.exe",
                        "children": [
                            {
                                "process_id": "2352",
                                "name": "jfiag_gg.exe"
                            }
                        ]
                    }
                ],
                "modules_loaded": [
                    "wship6.dll",
                    "KERNEL32.DLL",
                    "C:\\Windows\\System32\\wshqos.dll",
                    "kernel32",
                    "C:\\Windows\\system32\\shell32.dll",
                    "IPHLPAPI.DLL",
                    "wshtcpip",
                    "C:\\Windows\\system32\\mswsock.dll",
                    "credssp.dll",
                    "comdlg32.dll",
                    "cryptsp.dll"
                ],
                "analysis_date": 1587730420,
                "sandbox_name": "VenusEye Sandbox",
                "files_written": [
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\fjgha23_fa.txt",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe"
                ],
                "registry_keys_opened": [
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\windows\\CurrentVersion\\Internet Settings\\Connections",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\PeerDist\\Service",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\SspiCache",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WinHttp",
                    "HKEY_CURRENT_USER\\Software",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "HKEY_CURRENT_USER\\Software\\iwqggtf\\data",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\Winsock\\Setup Migration\\Providers\\Psched",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders\\SaslProfiles",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Winsock",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Psched\\Parameters\\Winsock",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\WinHttp\\Tracing",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                    "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\PeerDist\\Service",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Setup Migration\\Providers",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\LsaExtensionConfig\\SspiCli",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\SspiCache\\credssp.dll",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\windows\\CurrentVersion\\Internet Settings\\Connections",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Winsock\\Parameters",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole"
                ],
                "has_html_report": true,
                "http_conversations": [
                    {
                        "url": "http://hfuie32.2ihsfa.com/api/?sid=260836&key=5970d127bb04ecc62f6e305f2175e871",
                        "request_method": "POST"
                    },
                    {
                        "url": "http://ip-api.com/json/",
                        "request_method": "GET"
                    },
                    {
                        "url": "http://hfuie32.2ihsfa.com/api/fbtime",
                        "request_method": "GET"
                    }
                ],
                "last_modification_date": 1587730421,
                "command_executions": [
                    "%TEMP%\\jfiag_gg.exe /scookiestxt C:\\Users\\DEBUG4~1\\AppData\\Local\\Temp\\fjgha23_fa.txt"
                ],
                "has_evtx": false,
                "has_pcap": false,
                "behash": "c8878782e55e4e28733fd0e86badadf7",
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "192.157.193.137",
                        "destination_port": 80
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "208.95.112.1",
                        "destination_port": 80
                    },
                    {
                        "transport_layer_protocol": "UDP",
                        "destination_ip": "40.81.94.65",
                        "destination_port": 123
                    }
                ],
                "files_opened": [
                    "%WINDIR%\\System32\\netmsg.dll",
                    "%WINDIR%\\System32\\en-US\\netmsg.dll.mui",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\fjgha23_fa.txt"
                ]
            }
        },
        {
            "id": "5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_VirusTotal Jujubox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_VirusTotal Jujubox"
            },
            "attributes": {
                "processes_terminated": [
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe /scookiestxt C:\\Users\\<USER>\\AppData\\Local\\Temp\\fjgha23_fa.txt",
                    "zbetcheckin_tracker_ifhvvyy.exe"
                ],
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "192.157.193.137"
                        ],
                        "hostname": "hfuie32.2ihsfa.com"
                    },
                    {
                        "resolved_ips": [
                            "edge-star-mini-shv-01-cdt1.facebook.com"
                        ],
                        "hostname": "35.21.240.157.in-addr.arpa"
                    },
                    {
                        "resolved_ips": [
                            "ip-api.com"
                        ],
                        "hostname": "1.112.95.208.in-addr.arpa"
                    },
                    {
                        "resolved_ips": [
                            "157.240.21.35"
                        ],
                        "hostname": "star-mini.c10r.facebook.com"
                    },
                    {
                        "resolved_ips": [
                            "208.95.112.1"
                        ],
                        "hostname": "ip-api.com"
                    },
                    {
                        "resolved_ips": [
                            "157.240.21.35"
                        ],
                        "hostname": "www.facebook.com"
                    },
                    {
                        "resolved_ips": [
                            "137.193-157-192.rdns.scalabledns.com"
                        ],
                        "hostname": "137.193.157.192.in-addr.arpa"
                    }
                ],
                "ja3_digests": [
                    "4d7a28d6f2263ed61de88ca66eb011e3"
                ],
                "has_memdump": false,
                "files_dropped": [
                    {
                        "path": "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe",
                        "sha256": "a45317c374d54e322153afd73f0e90f1486638d77b7fd85746d091071bbecd59"
                    }
                ],
                "processes_tree": [
                    {
                        "process_id": "2024",
                        "name": "zbetcheckin_tracker_ifhvvyy.exe",
                        "children": [
                            {
                                "process_id": "2664",
                                "time_offset": 1,
                                "name": "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe /scookiestxt C:\\Users\\<USER>\\AppData\\Local\\Temp\\fjgha23_fa.txt"
                            }
                        ]
                    }
                ],
                "modules_loaded": [
                    "api-ms-win-core-synch-l1-2-0",
                    "kernel32",
                    "api-ms-win-core-fibers-l1-1-1",
                    "api-ms-win-core-localization-l1-2-1",
                    "api-ms-win-core-string-l1-1-0",
                    "api-ms-win-core-datetime-l1-1-1",
                    "api-ms-win-core-localization-obsolete-l1-2-0",
                    "ADVAPI32.dll",
                    "RPCRT4.dll",
                    "CRYPTBASE.dll",
                    "SHLWAPI.dll",
                    "WS2_32.dll",
                    "SspiCli.dll",
                    "IPHLPAPI.DLL",
                    "ole32.dll",
                    "NSI.dll",
                    "CFGMGR32.dll",
                    "API-MS-WIN-Service-Management-L1-1-0.dll",
                    "API-MS-WIN-Service-Management-L2-1-0.dll",
                    "API-MS-WIN-Service-winsvc-L1-1-0.dll",
                    "DNSAPI.dll",
                    "ncrypt.dll",
                    "USER32.dll",
                    "CRYPT32.dll",
                    "USERENV.dll",
                    "API-MS-Win-Security-SDDL-L1-1-0.dll",
                    "CRYPTSP.dll"
                ],
                "analysis_date": 1587726820,
                "sandbox_name": "VirusTotal Jujubox",
                "files_written": [
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe"
                ],
                "registry_keys_set": [
                    {
                        "key": "data\\times",
                        "value": "6"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\kissq",
                        "value": "C:\\Users\\<USER>\\AppData\\Local\\Temp\\kissq.exe"
                    }
                ],
                "registry_keys_opened": [
                    "HKCU\\Software\\iwqggtf\\data",
                    "HKCU\\Software",
                    "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                    "HKLM\\System\\CurrentControlSet\\Control\\Class\\{4d36e972-e325-11ce-bfc1-08002be10318}",
                    "HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel",
                    "System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel\\UserContextLockCount",
                    "System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel\\UserContextListCount"
                ],
                "processes_created": [
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe /scookiestxt C:\\Users\\<USER>\\AppData\\Local\\Temp\\fjgha23_fa.txt"
                ],
                "has_html_report": true,
                "http_conversations": [
                    {
                        "url": "http://ip-api.com/json/",
                        "request_method": "GET",
                        "request_headers": {
                            "accept-language": "en,q=0.9;q=0.8,ja;q=0.7,af;q=0.6,am;q=0.5,sq;q=0.4,ar;q=0.3,an;q=0.2,hy;q=0.1,ast;q=0.1,az;q=0.1,bn;q=0.1,eu;q=0.1",
                            "connection": "Keep-Alive",
                            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
                            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36",
                            "host": "ip-api.com",
                            "viewport-width": "1920"
                        }
                    },
                    {
                        "url": "http://hfuie32.2ihsfa.com/api/fbtime",
                        "request_method": "GET",
                        "request_headers": {
                            "connection": "Keep-Alive",
                            "host": "hfuie32.2ihsfa.com",
                            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36"
                        }
                    },
                    {
                        "url": "http://hfuie32.2ihsfa.com/api/?sid=254009&key=91204b1294f28fe263e6465ea44c402b",
                        "request_method": "POST",
                        "request_headers": {
                            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36"
                        }
                    }
                ],
                "last_modification_date": 1587726820,
                "calls_highlighted": [
                    "GetTickCount",
                    "GetAdaptersAddresses"
                ],
                "has_evtx": false,
                "tags": [
                    "DIRECT_CPU_CLOCK_ACCESS",
                    "CHECKS_NETWORK_ADAPTERS",
                    "RUNTIME_MODULES",
                    "PERSISTENCE"
                ],
                "has_pcap": true,
                "files_copied": [
                    {
                        "source": "C:\\Users\\<USER>\\Downloads\\zbetcheckin_tracker_ifhvvyy.exe",
                        "destination": "C:\\Users\\<USER>\\AppData\\Local\\Temp\\kissq.exe"
                    }
                ],
                "behash": "948a3860fffc5cb51d5970762c64d3d7",
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "208.95.112.1",
                        "destination_port": 80
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "157.240.21.35",
                        "destination_port": 443
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "192.157.193.137",
                        "destination_port": 80
                    }
                ],
                "files_opened": [
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.exe",
                    "C:\\Windows\\system32\\apphelp.dll",
                    "\\SystemRoot\\AppPatch\\sysmain.sdb",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\",
                    "C:\\Users\\",
                    "C:\\Users\\<USER>\\",
                    "C:\\Users\\<USER>\\AppData\\",
                    "C:\\Users\\<USER>\\AppData\\Local\\",
                    "C:\\Windows\\system32\\shell32.dll",
                    "C:\\Users\\<USER>\\AppData\\Local",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg_lng.ini",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\jfiag_gg.cfg",
                    "C:\\Users\\<USER>\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies",
                    "C:\\Users\\<USER>\\AppData\\Local\\Google\\Chrome\\User Data\\Local State",
                    "C:\\Users\\<USER>\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies-journal",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\fjgha23_fa.txt",
                    "C:\\Users\\<USER>\\Downloads\\zbetcheckin_tracker_ifhvvyy.exe",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\kissq.exe",
                    "C:\\Windows\\syswow64\\en-US\\KERNELBASE.dll.mui",
                    "C:\\Windows\\system32\\cryptsp.dll",
                    "C:\\Windows\\system32\\credssp.dll",
                    "C:\\Windows\\system32\\mswsock.dll",
                    "C:\\Windows\\System32\\wshtcpip.dll",
                    "C:\\Windows\\System32\\wship6.dll",
                    ".\\Nsi",
                    "C:\\Windows\\system32\\dhcpcsvc6.DLL",
                    "C:\\Windows\\system32\\dhcpcsvc.DLL",
                    "\\DEVICE\\NETBT_TCPIP_{AE434C4A-85E5-4595-83E0-5F53070D058E}",
                    "\\DEVICE\\NETBT_TCPIP_{846EE342-7039-11DE-9D20-806E6F6E6963}",
                    "\\DEVICE\\NETBT_TCPIP_{EE0BF7A5-EB1C-46BB-B402-49ABE2114F9F}",
                    "C:\\Windows\\system32\\netmsg.dll",
                    "\\Device\\Afd\\Endpoint",
                    "C:\\Windows\\system32\\rasadhlp.dll",
                    "\\Device\\RasAcd",
                    "C:\\Windows\\System32\\fwpuclnt.dll",
                    "C:\\Windows\\SysWOW64\\schannel.dll",
                    "C:\\Windows\\system32\\ncrypt.dll",
                    "C:\\Windows\\system32\\bcrypt.dll",
                    "C:\\Windows\\SysWOW64\\bcryptprimitives.dll",
                    "C:\\Windows\\system32\\USERENV.dll",
                    "C:\\Windows\\system32\\profapi.dll",
                    "C:\\Users\\<USER>\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My\\Certificates\\",
                    "C:\\Users\\<USER>\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My\\CRLs\\",
                    "C:\\Users\\<USER>\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My\\CTLs\\",
                    "C:\\Windows\\system32\\GPAPI.dll",
                    "C:\\Users\\<USER>\\AppData\\Roaming\\Microsoft\\SystemCertificates\\My",
                    "C:\\Windows\\system32\\CRYPTSP.dll",
                    "C:\\Windows\\system32\\rsaenh.dll"
                ]
            }
        },
        {
            "id": "5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_Yomi Hunter",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab_Yomi Hunter"
            },
            "attributes": {
                "processes_terminated": [
                    "is32bit.exe",
                    "hVIYXKlFv.exe"
                ],
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "8.8.4.4"
                        ],
                        "hostname": "dns.google"
                    }
                ],
                "has_memdump": false,
                "files_dropped": [
                    {
                        "path": "C:\\Users\\user\\AppData\\Local\\Temp\\jfiag_gg.exe",
                        "sha256": "f2bd67f7ced8f41c63627ff5e79b35b03dbbaa5e1e85ceb0861e8bf48a40ebee",
                        "type": "PE_EXE"
                    }
                ],
                "processes_tree": [
                    {
                        "process_id": "2568",
                        "time_offset": 4745,
                        "name": "7f47a8192433562fb0fbe7c0c008c014.exe",
                        "children": [
                            {
                                "process_id": "2796",
                                "time_offset": 4743,
                                "name": "e3921c5d1264c85480ad7043171f9d7d.exe"
                            }
                        ]
                    }
                ],
                "modules_loaded": [
                    "SspiCli",
                    "rpcrt4",
                    "api-ms-win-core-synch-l1-2-0",
                    "api-ms-win-core-fibers-l1-1-1",
                    "kernel32",
                    "api-ms-win-core-localization-l1-2-1",
                    "api-ms-win-core-string-l1-1-0",
                    "api-ms-win-core-datetime-l1-1-1",
                    "api-ms-win-core-localization-obsolete-l1-2-0",
                    "apphelp",
                    "SHLWAPI",
                    "kernel32",
                    "ADVAPI32",
                    "winhttp",
                    "WS2_32",
                    "WS2_32",
                    "kernel32",
                    "SspiCli",
                    "cryptsp",
                    "credssp",
                    "RPCRT4",
                    "ADVAPI32",
                    "mswsock",
                    "wshtcpip",
                    "mswsock",
                    "wship6",
                    "IPHLPAPI",
                    "dhcpcsvc6",
                    "IPHLPAPI",
                    "dhcpcsvc",
                    "IPHLPAPI",
                    "ntdll",
                    "ole32",
                    "CRYPTBASE",
                    "NSI",
                    "CFGMGR32",
                    "API-MS-WIN-Service-Management-L1-1-0",
                    "API-MS-WIN-Service-Management-L2-1-0",
                    "API-MS-WIN-Service-winsvc-L1-1-0",
                    "SspiCli",
                    "rpcrt4",
                    "KERNEL32",
                    "ADVAPI32",
                    "COMCTL32",
                    "comdlg32",
                    "CRYPT32",
                    "GDI32",
                    "msvcrt",
                    "SHELL32",
                    "USER32",
                    "VERSION",
                    "comctl32",
                    "shell32",
                    "ole32",
                    "ADVAPI32",
                    "kernel32"
                ],
                "analysis_date": 1592383284,
                "sandbox_name": "Yomi Hunter",
                "files_written": [
                    "C:\\Users\\user\\AppData\\Local\\Temp\\jfiag_gg.exe",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\kissq.exe",
                    "\\Sessions\\1\\BaseNamedObjects",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\fjgha23_fa.txt"
                ],
                "processes_created": [
                    "bin\\is32bit.exe -f C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\9169df81b2b8e83cec23f1c200f2759a.exe",
                    "bin\\hVIYXKlFv.exe --app C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\9169df81b2b8e83cec23f1c200f2759a.exe --only-start --curdir C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\9169df81b2b8e83cec23f1c200f2759a.exe ",
                    "C:\\Windows\\system32\\wbem\\wmiprvse.exe -Embedding",
                    "bin\\is32bit.exe -p 2568"
                ],
                "has_html_report": true,
                "verdicts": [
                    "MALWARE"
                ],
                "last_modification_date": 1592376105,
                "calls_highlighted": [
                    "C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\jfiag_gg.exe /scookiestxt C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\fjgha23_fa.txt",
                    "kernel32.CreateSemaphoreW",
                    "kernel32.FreeLibraryWhenCallbackReturns",
                    "kernel32.OutputDebugStringA",
                    "kernel32.GetCurrentThreadId",
                    "kernel32.GetSystemTimeAsFileTime",
                    "kernel32.FreeLibrary",
                    "kernel32.GetSystemDirectoryW",
                    "kernel32.LoadLibraryExW",
                    "kernel32.FindNextFileW",
                    "kernel32.ReadFile",
                    "kernel32.WriteFile",
                    "kernel32.ReadProcessMemory",
                    "kernel32.ExitProcess",
                    "kernel32.GetSystemTime",
                    "comdlg32.GetOpenFileNameW",
                    "user32.SendDlgItemMessageW",
                    "user32.SendMessageW",
                    "shell32.ShellExecuteW",
                    "advapi32.RegOpenKeyExW"
                ],
                "command_executions": [
                    "C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\jfiag_gg.exe /scookiestxt C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\fjgha23_fa.txt"
                ],
                "has_evtx": false,
                "has_pcap": false,
                "behash": "ce5251ea9e5cd8fdb2a40f408b3ffa58",
                "files_opened": [
                    "C:\\Users\\A4148~1.MON\\AppData\\Local\\Temp\\",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\jfiag_gg.exe",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\fjgha23_fa.txt",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\9169df81b2b8e83cec23f1c200f2759a.exe",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\kissq.exe",
                    "C:\\Windows",
                    "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                    "\\Sessions\\1\\BaseNamedObjects",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\netmsg.dll",
                    "C:\\Windows\\System32\\netmsg.dll",
                    "C:\\Windows\\System32\\en-US\\netmsg.dll.mui",
                    "C:\\Windows\\system32",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\jfiag_gg_lng.ini",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\jfiag_gg.cfg",
                    "C:\\Users\\user\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies"
                ]
            }
        }
    ],
    "meta": {
        "count": 4
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/5fac6cd31ff0f16528342db837798bb0767bd8a6747177492df2bf74d4c51dab/behaviours?limit=10"
    }
}