{
    "data": [
        {
            "id": "08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822_C2AE"
            },
            "attributes": {
                "behash": "7fa219fb35c457770cfc9af281b88a25",
                "has_html_report": false,
                "analysis_date": 1673910416,
                "has_pcap": false,
                "registry_keys_set": [
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\SystemCertificates\\Root\\Certificates\\0174E68C97DDF1E0EEEA415EA336A163D2B61AFD\\Blob",
                        "value": "5C 00 00 00 01 00 00 00 04 00 00 00 00 10 00 00 04 00 00 00 01 00 00 00 10 00 00 00 0D BE 92 DE FF 7D 36 BB 48 C4 A6 B1 15 24 95 38 0F 00 00 00 01 00 00 00 20 00 00 00 53 FE B9 19 2E D4 80 F2 09 12 4A 2C 57 D7 E8 97 7A 2E 9F 39 46 1D BF 21 4D F1 12 CB 16 02 4F A2 14 00 00 00 01 00 00 00 14 00 00 00 78 B8 30 FD 63 AC 7B 89 4A 07 3B ED F6 8A 83 9C C3 52 02 65 19 00 00 00 01 00 00 00 10 00 00 00 B5 74 AF 30 C5 C1 BA 3A 69 A7 10 02 00 82 4D D0 03 00 00 00 01 00 00 00 14 00 00 00 01 74 E6 8C 97 DD F1 E0 EE EA 41 5E A3 36 A1 63 D2 B6 1A FD 20 00 00 00 01 00 00 00 F8 05 00 00 30 82 05 F4 30 82 03 DC A0 03 02 01 02 02 09 00 E0 EA 61 4C 28 56 32 64 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30 81 8E 31 0B 30 09 06 03 55 04 06 13 02 49 4C 31 0F 30 0D 06 03 55 04 08 0C 06 43 65 6E 74 65 72 31 0C 30 0A 06 03 55 04 07 0C 03 4C 6F 64 31 10 30 0E 06 03 55 04 0A 0C 07 47 6F 50 72 6F 78 79 31 10 30 0E 06 03 55 04 0B 0C 07 47 6F 50 72 6F 78 79 31 1A 30 18 06 03 55 04 03 0C 11 67 6F 70 72 6F 78 79 2E 67 69 74 68 75 62 2E 69 6"
                    }
                ],
                "has_evtx": false,
                "processes_tree": [
                    {
                        "process_id": "2256",
                        "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                    },
                    {
                        "process_id": "2980",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "3020",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2620",
                        "name": "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% %WORKDIR% 483",
                        "children": [
                            {
                                "process_id": "2736",
                                "name": "%windir%\\system32\\regsvr32.exe \"%windir%\\system32\\MQTLXHvhvVnJNiL\\HmxlXYX.dll\""
                            }
                        ]
                    }
                ],
                "command_executions": [
                    "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% %WORKDIR% 483"
                ],
                "verdicts": [
                    "UNKNOWN_VERDICT"
                ],
                "has_memdump": false,
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "209.126.98.206",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "82.223.21.224",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "45.235.8.30",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "160.16.142.56",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "164.68.99.3",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "153.126.146.25",
                        "destination_port": 7080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "159.89.202.34",
                        "destination_port": 443
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "115.68.227.76",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "119.193.124.41",
                        "destination_port": 7080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "206.189.28.199",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "45.118.115.99",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "167.172.199.165",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "107.170.39.149",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "173.212.193.249",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "185.4.135.165",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "159.65.88.10",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "163.44.196.120",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "104.168.155.143",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "37.187.115.122",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "147.139.166.154",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "167.172.253.162",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "149.56.131.28",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "212.24.98.99",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "183.111.227.137",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "82.165.152.127",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "101.50.0.91",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "172.104.251.154",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "91.207.28.33",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "110.232.117.186",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "150.95.66.124",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "197.242.150.244",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "213.239.212.5",
                        "destination_port": 443
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "139.59.56.73",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "1.234.2.232",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "94.23.45.86",
                        "destination_port": 4143
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "72.15.201.15",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "103.132.242.26",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "134.122.66.193",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "103.70.28.102",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "79.137.35.198",
                        "destination_port": 8080
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "187.63.160.88",
                        "destination_port": 80
                    }
                ],
                "last_modification_date": 1674029258,
                "processes_terminated": [
                    "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                    "wmiadap.exe /F /T /R",
                    "%SANDBOX_DLL_LOADER_AMD64% %SAMPLEPATH% %WORKDIR% 483"
                ],
                "sandbox_name": "C2AE",
                "http_conversations": [
                    {
                        "url": "http://103.75.201.2/",
                        "request_method": "GET",
                        "request_headers": {
                            "Host": "103.75.201.2",
                            "Cookie": "y=oLYg0Nve2YgvCH7O401KB2QQW7bkbO/wnP2tykxU3Tsvh0d/FTyg9l7xPhyKzZCeblRIpaXGrljtUWWwAdk8zsZRVJfuQsHf3M/9OLjUiKDDyl8A3dRyC1K/dSM87FnighM+9X1Or4pHZzFMFN2hwdVGozobnfgg1P6LkbFD0nUVwsHxc6JgNg4IwQycfH8WLnp1pusuAExfuTXN2QejPky4l3501QSGDpXi+SCPSpkWJhlsIdNhPGqMRy/XLCCGUPubfZBvqmtbcNgf3DTTaCbw1wiVhWMVmH9UfI4dZ1R04vkXagPT3G85y9FPul9gZKe1aXc=",
                            "Connection": "Keep-Alive"
                        }
                    },
                    {
                        "url": "http://51.161.73.194/",
                        "request_method": "GET",
                        "request_headers": {
                            "Connection": "Keep-Alive",
                            "Cookie": "y=oLYg0Nve2YgvCH7O401KB2QQW7bkbO/wnP2tykxU3Tsvh0d/FTyg9l7xPhyKzZCeblRIpaXGrljtUWWwAdk8zsZRVJfuQsHf3M/9OLjUiKDDyl8A3dRyC1K/dSM87FnighM+9X1Or4pHZzFMFN2hwdVGozobnfgg1P6LkbFD0nUVwsHxc6JgNg4IwQycfH8WLnp1pusuAExfuTXN2QejPky4l3501QSGDpXi+SCPSpkWJhlsIdNhPGqMRy/XLCCGUPubfZBvqmtbcNgf3DTTaCbw1wiVhWMVmH9UfI4dZ1R04vkXagPT3G85y9FPul9gZKe1aXc=",
                            "Host": "51.161.73.194"
                        }
                    },
                    {
                        "url": "http://172.105.226.75:8080/",
                        "request_method": "GET",
                        "request_headers": {
                            "Connection": "Keep-Alive",
                            "Cookie": "y=oLYg0Nve2YgvCH7O401KB2QQW7bkbO/wnP2tykxU3Tsvh0d/FTyg9l7xPhyKzZCeblRIpaXGrljtUWWwAdk8zsZRVJfuQsHf3M/9OLjUiKDDyl8A3dRyC1K/dSM87FnighM+9X1Or4pHZzFMFN2hwdVGozobnfgg1P6LkbFD0nUVwsHxc6JgNg4IwQycfH8WLnp1pusuAExfuTXN2QejPky4l3501QSGDpXi+SCPSpkWJhlsIdNhPGqMRy/XLCCGUPubfZBvqmtbcNgf3DTTaCbw1wiVhWMVmH9UfI4dZ1R04vkXagPT3G85y9FPul9gZKe1aXc=",
                            "Host": "172.105.226.75:8080"
                        }
                    },
                    {
                        "url": "http://167.172.199.165:8080/",
                        "request_method": "GET",
                        "request_headers": {
                            "Host": "167.172.199.165:8080",
                            "Cookie": "eeOqOqW=oLYg0Nve2YgvCH7O401KB2QQW7bkbO/wnP2tykxU3Tsvh0d/FTyg9l7xPhyKzZCeblRIpaXGrljtUWWwAdk8zsZRVJfuQsHf3M/9OLjUiKDDyl8A3dRyC1K/dSM87FnighM+9X1Or4pHZzFMFN2hwdVGozobnfgg1P6LkbFD0nUVwsHxc6JgNg4IwQycfH8WKw+ZgBjdwCRcTCMAfOrF2Xc7+fgfHAXVy3hsKK8/v5EO4wIBhXbe/ut75HWfZP9I4N3bBrpsrnhr9cet2YZqSd2E3wqi55PHxX3jJo78s8bAWt904oWbrpNThSrXhWhQCzOLddQ=",
                            "Connection": "Keep-Alive"
                        }
                    },
                    {
                        "url": "http://51.161.73.194/",
                        "request_method": "GET",
                        "response_headers": {
                            "Content-Length": "1451",
                            "Access-Control-Allow-Headers": "range,x-requested-with, Content-Type, origin, authorization, accept, client-security-token",
                            "Access-Control-Max-Age": "1000",
                            "Accept-Ranges": "bytes",
                            "Access-Control-Expose-Headers": "Server,range,Content-Length,Content-Range",
                            "Vary": "Accept-Encoding",
                            "Keep-Alive": "timeout=5, max=100",
                            "Server": "Apache/2.4.29 (Ubuntu)",
                            "Last-Modified": "Wed, 31 Aug 2022 20:34:56 GMT",
                            "Connection": "Keep-Alive",
                            "ETag": "\"5ab-5e78f6e095c00\"",
                            "Access-Control-Allow-Credentials": "true",
                            "Date": "Mon, 16 Jan 2023 23:06:34 GMT",
                            "Access-Control-Allow-Origin": "*",
                            "Access-Control-Allow-Methods": "POST, GET, OPTIONS, DELETE, PUT",
                            "Content-Type": "text/html"
                        },
                        "response_status_code": 200,
                        "request_headers": {
                            "Host": "51.161.73.194",
                            "Cookie": "eeOqOqW=oLYg0Nve2YgvCH7O401KB2QQW7bkbO/wnP2tykxU3Tsvh0d/FTyg9l7xPhyKzZCeblRIpaXGrljtUWWwAdk8zsZRVJfuQsHf3M/9OLjUiKDDyl8A3dRyC1K/dSM87FnighM+9X1Or4pHZzFMFN2hwdVGozobnfgg1P6LkbFD0nUVwsHxc6JgNg4IwQycfH8WKw+ZgBjdwCRcTCMAfOrF2Xc7+fgfHAXVy3hsKK8/v5EO4wIBhXbe/ut75HWfZP9I4N3bBrpsrnhr9cet2YZqSd2E3wqi55PHxX3jJo78s8bAWt904oWbrpNThSrXhWhQCzOLddQ=",
                            "Connection": "Keep-Alive"
                        }
                    }
                ]
            }
        },
        {
            "id": "08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822_CAPA"
            },
            "attributes": {
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480",
                "has_html_report": false,
                "analysis_date": 1673906458,
                "has_pcap": false,
                "mitre_attack_techniques": [
                    {
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "encode data using Base64",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using Base64"
                            }
                        ],
                        "signature_description": "encode data using Base64",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_evtx": false,
                "has_memdump": false,
                "signature_matches": [
                    {
                        "description": "data-manipulation/encoding/xor",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
                        "name": "encode data using XOR",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "load-code/pe",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "data-manipulation/hmac",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://tools.ietf.org/html/rfc2104"
                            },
                            {
                                "ref": "https://tools.ietf.org/html/rfc4634"
                            },
                            {
                                "ref": "https://github.com/ogay/hmac"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: authenticate HMAC\n    namespace: data-manipulation/hmac\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Cryptography::Hashed Message Authentication Code [C0061]\n    references:\n      - https://tools.ietf.org/html/rfc2104\n      - https://tools.ietf.org/html/rfc4634\n      - https://github.com/ogay/hmac\n    examples:\n      - mimikatz.exe_:0x403408\n  features:\n    - and:\n      # block-sized inner padding, consisting of repeated bytes valued 0x36\n      - number: 0x36 = inner padding byte value\n      # block-sized outer padding, consisting of repeated bytes valued 0x5c\n      - number: 0x5C = outer padding byte value\n      - match: contain loop\n      - count(characteristic(nzxor)): 2 or more\n      - optional:\n        - description: block size\n        - number: 64 = MD5, SHA-1, SHA-224, or SHA-256\n        - number: 128 = SHA-384 or SHA-512\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "authenticate HMAC"
                    },
                    {
                        "description": "data-manipulation/hashing/murmur",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/aappleby/smhasher/blob/master/src/MurmurHash3.cpp"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using murmur3\n    namespace: data-manipulation/hashing/murmur\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    mbc:\n      - Data::Non-Cryptographic Hash::MurmurHash [C0030.001]\n    references:\n      - https://github.com/aappleby/smhasher/blob/master/src/MurmurHash3.cpp\n    examples:\n      - c66172b12971a329f8d5ff01665f204b:0x404A18\n  features:\n    - or:\n      - and:\n        - number: 0x85ebca6b = 32-bit finalization mix constant 1\n        - number: 0xc2b2ae35 = 32-bit finalization mix constant 2\n      - and:\n        - number: 0xff51afd7ed558ccd = 64-bit finalization mix constant 1\n        - number: 0xc4ceb9fe1a85ec53 = 64-bit finalization mix constant 2\n      - and:\n        - number: 0xcc9e2d51 = c1 32-bit hash\n        - number: 0x1b873593 = c2 32-bit hash\n      - and:\n        - number: 0x239b961b = 32-bit c1 for 128-bit hash\n        - number: 0xab0e9789 = 32-bit c2 for 128-bit hash\n        - number: 0x38b34ae5 = 32-bit c3 for 128-bit hash\n        - number: 0xa1e38b93 = 32-bit c4 for 128-bit hash\n      - and:\n        - number: 0x87c37b91114253d5 = 64-bit c1 for 128-bit hash\n        - number: 0x4cf5ad432745937f = 64-bit c2 for 128-bit hash\n      - basic block:\n        - and:\n          - description: 'hash >> 16; hash >> 13; hash >> 16'\n          - count(mnemonic(shr)): 3\n          - instruction:\n            - mnemonic: shr\n            - number: 16\n          - instruction:\n            - mnemonic: shr\n            - number: 13\n          - optional:\n            - count(characteristic(nzxor)): 3 or more\n      - and:\n        # Group this two blocks under an `and` as on their own they are not\n        # unique enough and would cause false positives\n        - instruction:\n          - description: k ROL r1\n          - mnemonic: rol\n          - number: 15 = r1\n        - instruction:\n          - description: hash ROL r2\n          - mnemonic: rol\n          - number: 13 = r2\n",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "hash data using murmur3"
                    },
                    {
                        "description": "load-code/pe",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://0x00sec.org/t/reflective-dll-injection/3080"
                            },
                            {
                                "ref": "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    scope: function\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      - offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - basic block:\n        - and:\n          - offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n          - offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n          - offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n",
                        "authors": [
                            "@Ana06"
                        ],
                        "name": "enumerate PE sections"
                    },
                    {
                        "description": "data-manipulation/encoding/base64",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using Base64\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::Base64 [C0026.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C\n      - 074072B261FC27B65C72671F13510C05:0x100049B2\n      - 5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - and:\n        - mnemonic: shl\n        - mnemonic: shr\n        - number: 0x3F = modulo 64\n        - or:\n          - number: 0x3D = '='\n          - number: 0x3D3D = '=='\n        - match: contain loop\n        - optional:\n          - number: 2\n          - number: 3\n          - number: 4\n          - number: 6\n          - number: 0xF\n          - string: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n      - api: System.Convert::ToBase64String\n",
                        "name": "encode data using Base64",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "host-interaction/file-system",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n",
                        "authors": [
                            "blas.kojusner@mandiant.com",
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "reference absolute stream path on Windows"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using Base64\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::Base64 [C0026.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C\n      - 074072B261FC27B65C72671F13510C05:0x100049B2\n      - 5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - and:\n        - mnemonic: shl\n        - mnemonic: shr\n        - number: 0x3F = modulo 64\n        - or:\n          - number: 0x3D = '='\n          - number: 0x3D3D = '=='\n        - match: contain loop\n        - optional:\n          - number: 2\n          - number: 3\n          - number: 4\n          - number: 6\n          - number: 0xF\n          - string: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n      - api: System.Convert::ToBase64String\n      - api: System.Convert::ToBase64CharArray\n      - api: System.Convert::TryToBase64Chars\n",
                        "name": "encode data using Base64",
                        "description": "data-manipulation/encoding/base64"
                    }
                ],
                "last_modification_date": 1689460104,
                "sandbox_name": "CAPA"
            }
        },
        {
            "id": "08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822_VMRay",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822_VMRay"
            },
            "attributes": {
                "behash": "271b4f014adb07c9980281de2a3eafc7",
                "has_html_report": false,
                "analysis_date": 1674492312,
                "processes_created": [
                    "C:\\Windows\\system32\\regsvr32.exe \"C:\\Windows\\system32\\TERJZv\\HGpViwxkrxp.dll\"",
                    "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822.exe.ocx\""
                ],
                "verdict_labels": [
                    "Mal/Generic-S"
                ],
                "has_pcap": false,
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_0"
                            }
                        ],
                        "signature_description": "(Process #2) regsvr32.exe enumerates running processes.",
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_110"
                            }
                        ],
                        "signature_description": "(Process #2) regsvr32.exe starts (process #3) regsvr32.exe with a hidden window.",
                        "id": "T1143",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_109"
                            }
                        ],
                        "signature_description": "(Process #2) regsvr32.exe tries to delete zone identifier of file \"C:\\Windows\\system32\\TERJZv\\HGpViwxkrxp.dll\".",
                        "id": "T1096",
                        "severity": "IMPACT_SEVERITY_HIGH"
                    }
                ],
                "has_evtx": false,
                "registry_keys_opened": [
                    "HKEY_CLASSES_ROOT\\dllfile\\AutoRegister",
                    "HKEY_CLASSES_ROOT\\dllfile",
                    "HKEY_CLASSES_ROOT\\.dll",
                    "HKEY_CLASSES_ROOT\\ocxfile\\AutoRegister",
                    "HKEY_CLASSES_ROOT\\ocxfile",
                    "HKEY_CLASSES_ROOT\\.ocx",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects"
                ],
                "processes_tree": [
                    {
                        "process_id": "5000",
                        "name": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\sHralaLI.exe\"  \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822.exe.ocx\"",
                        "children": [
                            {
                                "process_id": "5044",
                                "name": "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822.exe.ocx\"",
                                "children": [
                                    {
                                        "process_id": "5080",
                                        "name": "C:\\Windows\\system32\\regsvr32.exe \"C:\\Windows\\system32\\TERJZv\\HGpViwxkrxp.dll\""
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "files_deleted": [
                    "c:\\users\\rdhj0c~1\\desktop\\08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822.exe.ocx",
                    "c:\\windows\\system32\\terjzv\\hgpviwxkrxp.dll:zone.identifier"
                ],
                "verdicts": [
                    "MALWARE"
                ],
                "files_written": [
                    "c:\\jsmith\\loader",
                    "c:\\windows\\system32\\terjzv\\hgpviwxkrxp.dll"
                ],
                "has_memdump": false,
                "signature_matches": [
                    {
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa02"
                            }
                        ],
                        "description": "(Process #2) regsvr32.exe creates file \"C:\\Windows\\system32\\TERJZv\\HGpViwxkrxp.dll\" in the OS directory.",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "id": "vti_match_108"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa02"
                            }
                        ],
                        "description": "(Process #2) regsvr32.exe tries to delete zone identifier of file \"C:\\Windows\\system32\\TERJZv\\HGpViwxkrxp.dll\".",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "id": "vti_match_109"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa02"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\system32\\regsvr32.exe \"C:\\Windows\\system32\\TERJZv\\HGpViwxkrxp.dll\""
                            }
                        ],
                        "description": "(Process #2) regsvr32.exe starts (process #3) regsvr32.exe with a hidden window.",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "id": "vti_match_110"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa02"
                            }
                        ],
                        "description": "Reputation analysis labels the sample itself as Mal/Generic-S.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "id": "vti_match_111"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Windows\\System32\\regsvr32.exe\" \"C:\\Users\\RDHJ0C~1\\Desktop\\08039481f17de1a125763d6dadc9a91615fa02"
                            }
                        ],
                        "description": "(Process #2) regsvr32.exe enumerates running processes.",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "id": "vti_match_0"
                    }
                ],
                "last_modification_date": 1674524008,
                "sandbox_name": "VMRay"
            }
        }
    ],
    "meta": {
        "count": 3
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/08039481f17de1a125763d6dadc9a91615fa027ad42a4f42d886b94063a94822/behaviours?limit=10"
    }
}