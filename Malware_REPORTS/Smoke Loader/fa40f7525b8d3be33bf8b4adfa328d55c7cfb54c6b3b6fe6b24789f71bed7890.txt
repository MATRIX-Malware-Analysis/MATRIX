{
    "data": [
        {
            "id": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_C2AE"
            },
            "attributes": {
                "has_memdump": false,
                "has_html_report": false,
                "behash": "f2a96f92c36218030b7cf2462e1a62dd",
                "analysis_date": 1721378982,
                "processes_tree": [
                    {
                        "process_id": "2640",
                        "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                        "children": [
                            {
                                "process_id": "2672",
                                "name": "%windir%\\SysWOW64\\WerFault.exe -u -p 2540 -s 132"
                            }
                        ]
                    },
                    {
                        "process_id": "2540",
                        "name": "%SAMPLEPATH%"
                    },
                    {
                        "process_id": "2844",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2888",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    }
                ],
                "command_executions": [
                    "%SAMPLEPATH%"
                ],
                "registry_keys_set": [
                    {
                        "key": "HKEY_USERS\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\SystemCertificates\\Root\\Certificates\\0174E68C97DDF1E0EEEA415EA336A163D2B61AFD\\Blob",
                        "value": "5C 00 00 00 01 00 00 00 04 00 00 00 00 10 00 00 04 00 00 00 01 00 00 00 10 00 00 00 0D BE 92 DE FF 7D 36 BB 48 C4 A6 B1 15 24 95 38 0F 00 00 00 01 00 00 00 20 00 00 00 53 FE B9 19 2E D4 80 F2 09 12 4A 2C 57 D7 E8 97 7A 2E 9F 39 46 1D BF 21 4D F1 12 CB 16 02 4F A2 14 00 00 00 01 00 00 00 14 00 00 00 78 B8 30 FD 63 AC 7B 89 4A 07 3B ED F6 8A 83 9C C3 52 02 65 19 00 00 00 01 00 00 00 10 00 00 00 B5 74 AF 30 C5 C1 BA 3A 69 A7 10 02 00 82 4D D0 03 00 00 00 01 00 00 00 14 00 00 00 01 74 E6 8C 97 DD F1 E0 EE EA 41 5E A3 36 A1 63 D2 B6 1A FD 20 00 00 00 01 00 00 00 F8 05 00 00 30 82 05 F4 30 82 03 DC A0 03 02 01 02 02 09 00 E0 EA 61 4C 28 56 32 64 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30 81 8E 31 0B 30 09 06 03 55 04 06 13 02 49 4C 31 0F 30 0D 06 03 55 04 08 0C 06 43 65 6E 74 65 72 31 0C 30 0A 06 03 55 04 07 0C 03 4C 6F 64 31 10 30 0E 06 03 55 04 0A 0C 07 47 6F 50 72 6F 78 79 31 10 30 0E 06 03 55 04 0B 0C 07 47 6F 50 72 6F 78 79 31 1A 30 18 06 03 55 04 03 0C 11 67 6F 70 72 6F 78 79 2E 67 69 74 68 75 62 2E 69 6"
                    },
                    {
                        "key": "HKEY_USERS\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Debug\\StoreLocation",
                        "value": "%LOCALAPPDATA%\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_PRIOL7BO7F9YNMWC_4a01dd466faff8fb04d3fa374fc63696346d192_0a717261"
                    },
                    {
                        "key": "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Debug\\StoreLocation",
                        "value": "%LOCALAPPDATA%\\Microsoft\\Windows\\WER\\ReportArchive\\AppCrash_PRIOL7BO7F9YNMWC_4a01dd466faff8fb04d3fa374fc63696346d192_0a717261"
                    }
                ],
                "last_modification_date": 1721497805,
                "verdicts": [
                    "MALWARE"
                ],
                "sandbox_name": "C2AE",
                "verdict_labels": [
                    "SmokeLoader",
                    "Zenpack"
                ],
                "verdict_confidence": 50,
                "has_evtx": false,
                "processes_terminated": [
                    "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                    "%windir%\\SysWOW64\\WerFault.exe -u -p 2540 -s 132",
                    "%SAMPLEPATH%",
                    "wmiadap.exe /F /T /R"
                ],
                "has_pcap": false
            }
        },
        {
            "id": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_CAPA"
            },
            "attributes": {
                "has_memdump": false,
                "has_html_report": false,
                "behash": "93af6a574af732d9b32059617ca90131",
                "analysis_date": 1721374673,
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "contain obfuscated stackstrings",
                        "description": "anti-analysis/obfuscation/string/stackstring",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "change memory protection",
                        "authors": [
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: change memory protection\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Change Memory Protection [C0008]\n    examples:\n      - Practical Malware Analysis Lab 11-02.dll_:0x10001203\n  features:\n    - or:\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtProtectVirtualMemory\n      - api: ZwProtectVirtualMemory\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualProtect\"\n          - string: \"VirtualProtectEx\"\n          - string: \"NtProtectVirtualMemory\"\n          - string: \"ZwProtectVirtualMemory\"\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "allocate or change RWX memory",
                        "description": "host-interaction/process/inject",
                        "authors": [
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: allocate or change RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x40 = PAGE_EXECUTE_READWRITE\n        # lea     r9d, [rcx+40h]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x40 = PAGE_EXECUTE_READWRITE\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "access PEB ldr_data",
                        "description": "linking/runtime-linking",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
                        "refs": [
                            {
                                "ref": "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm"
                            },
                            {
                                "ref": "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get process heap flags",
                        "description": "host-interaction/process",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get process heap flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x40 = ProcessHeap->HeapFlags >= Vista\n            - number: 0xC = ProcessHeap->HeapFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x70 = ProcessHeap->HeapFlags >= Vista\n            - number: 0x14 = ProcessHeap->HeapFlags < Vista\n",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get disk size",
                        "description": "host-interaction/hardware/storage",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get disk size\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347\n    examples:\n      - al-khaser_x86.exe_:0x4343D0\n      - al-khaser_x86.exe_:0x434010\n  features:\n    - or:\n      - api: kernel32.GetDiskFreeSpace\n      - api: kernel32.GetDiskFreeSpaceEx\n      - property/read: System.IO.DriveInfo::TotalSize\n      - property/read: System.IO.DriveInfo::TotalFreeSpace\n      - property/read: System.IO.DriveInfo::AvailableFreeSpace\n      - basic block:\n        - and:\n          - match: interact with driver via IOCTL\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - call:\n        - and:\n          - match: interact with driver via IOCTL\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - and:\n        - or:\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i\n        - string: \"Size\"\n",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "execute shellcode via Windows callback function",
                        "description": "load-code/shellcode : Detect usage of various WinAPI functions that accept callback functions as parameters in order to execute arbitrary shellcode",
                        "authors": [
                            "ervin.ocampo@mandiant.com",
                            "jakub.jozwiak@mandiant.com",
                            "still@teamt5.org"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: execute shellcode via Windows callback function\n    namespace: load-code/shellcode\n    authors:\n      - ervin.ocampo@mandiant.com\n      - jakub.jozwiak@mandiant.com\n      - still@teamt5.org\n    description: Detect usage of various WinAPI functions that accept callback functions as parameters in order to execute arbitrary shellcode\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Defense Evasion::Reflective Code Loading [T1620]\n    mbc:\n      - Defense Evasion::Hijack Execution Flow::Abuse Windows Function Calls [F0015.006]\n    references:\n      - https://github.com/ChaitanyaHaritash/Callback_Shellcode_Injection\n      - https://www.trendmicro.com/en_us/research/22/k/earth-preta-spear-phishing-governments-worldwide.html\n      - http://ropgadget.com/posts/abusing_win_functions.html\n      - https://github.com/aahmad097/AlternativeShellcodeExec/\n      - https://osandamalith.com/2021/04/01/executing-shellcode-via-callbacks/\n    examples:\n      - 10cd7afd580ee9c222b0a87ff241d306:0x10008BE0\n      - 268d61837aa248c1d49a973612a129ce:0x1000CEC0\n      - 4a2992b4c7a1573bf7c74065e3bf5b0d:0x1000D050\n      - 43db867967c71bd3aaba9a9a3084e7fa:0x140001000\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - or:\n        - api: CallWindowProc\n        - api: EnumCalendarInfo\n        - api: EnumCalendarInfoEx\n        - api: EnumChildWindows\n        - api: EnumChildWindows\n        - api: EnumDateFormats\n        - api: EnumDesktops\n        - api: EnumDesktopWindows\n        - api: EnumDisplayMonitors\n        - api: EnumFontFamilies\n        - api: EnumFontFamiliesEx\n        - api: EnumFonts\n        - api: EnumProps\n        - api: EnumPropsEx\n        - api: EnumResourceTypes\n        - api: EnumSystemCodePages\n        - api: EnumSystemGeoID\n        - api: EnumSystemLanguageGroups\n        - api: EnumSystemLocales\n        - api: EnumThreadWindows\n        - api: EnumTimeFormats\n        - api: EnumUILanguages\n        - api: EnumWindows\n        - api: GrayString\n        - api: LineDDA\n",
                        "refs": [
                            {
                                "ref": "https://github.com/ChaitanyaHaritash/Callback_Shellcode_Injection"
                            },
                            {
                                "ref": "https://www.trendmicro.com/en_us/research/22/k/earth-preta-spear-phishing-governments-worldwide.html"
                            },
                            {
                                "ref": "http://ropgadget.com/posts/abusing_win_functions.html"
                            },
                            {
                                "ref": "https://github.com/aahmad097/AlternativeShellcodeExec/"
                            },
                            {
                                "ref": "https://osandamalith.com/2021/04/01/executing-shellcode-via-callbacks/"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "execute shellcode via indirect call",
                        "description": "load-code/shellcode",
                        "authors": [
                            "ronnie.salomonsen@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: execute shellcode via indirect call\n    namespace: load-code/shellcode\n    authors:\n      - ronnie.salomonsen@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    mbc:\n      - Memory::Allocate Memory [C0007]\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - or:\n        - characteristic: indirect call\n        - characteristic: cross section flow\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "enumerate gui resources",
                        "description": "host-interaction/gui",
                        "authors": [
                            "johnk3r",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate gui resources\n    namespace: host-interaction/gui\n    authors:\n      - johnk3r\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 5e6764534b3a1e4d3abacc4810b6985d:0x4011C0\n      - a74ee8200aace7d19dee79871bbf2ed3:0x403750\n      - 74fa32d2b277f583010b692a3f91b627:0x66BAEA67\n      - 021f49678cd633dc8cf99c61b3af3dda:0x40E44A\n  features:\n    - or:\n      - api: EnumResourceTypes\n      - api: EnumWindowStations\n      - api: EnumDesktops\n      - api: EnumWindows\n      - property/read: System.Windows.Forms.Screen::AllScreens\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get common file path",
                        "description": "host-interaction/file-system",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "terminate process",
                        "description": "host-interaction/process/terminate",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "allocate thread local storage",
                        "description": "host-interaction/thread/tls",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: allocate thread local storage\n    namespace: host-interaction/thread/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Process::Allocate Thread Local Storage [C0040]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\n  features:\n    - or:\n      - api: kernel32.TlsAlloc\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "link many functions at runtime",
                        "description": "linking/runtime-linking",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "linked against CPP standard library",
                        "description": "linking/static",
                        "authors": [
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: linked against CPP standard library\n    namespace: linking/static\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: file\n      dynamic: file\n    references:\n      - https://en.wikipedia.org/wiki/P._J._Plauger\n      - https://www.dinkumware.com/\n    examples:\n      - 03b236b23b1ec37c663527c1f53af3fe\n  features:\n    - or:\n      - string: \"Copyright (c) by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED.\"\n      - string: \"Copyright (c) 1992-2004 by P.J. Plauger, licensed by Dinkumware, Ltd. ALL RIGHTS RESERVED.\"\n",
                        "refs": [
                            {
                                "ref": "https://en.wikipedia.org/wiki/P._J._Plauger"
                            },
                            {
                                "ref": "https://www.dinkumware.com/"
                            }
                        ]
                    }
                ],
                "last_modification_date": 1721374674,
                "mitre_attack_techniques": [
                    {
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "link function at runtime on Windows",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ]
                    },
                    {
                        "id": "T1027.005",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "contain obfuscated stackstrings",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ]
                    },
                    {
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "access PEB ldr_data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "access PEB ldr_data"
                            }
                        ]
                    },
                    {
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get process heap flags",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get process heap flags"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get disk size",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk size"
                            }
                        ]
                    },
                    {
                        "id": "T1620",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "execute shellcode via Windows callback function",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "execute shellcode via Windows callback function"
                            }
                        ]
                    },
                    {
                        "id": "T1010",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "enumerate gui resources",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate gui resources"
                            }
                        ]
                    },
                    {
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get common file path",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ]
                    },
                    {
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "link many functions at runtime",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link many functions at runtime"
                            }
                        ]
                    }
                ],
                "sandbox_name": "CAPA",
                "mbc": [
                    {
                        "id": "B0032.020",
                        "objective": "Anti-Static Analysis",
                        "behavior": "Executable Code Obfuscation",
                        "method": "Argument Obfuscation",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ]
                    },
                    {
                        "id": "B0032.017",
                        "objective": "Anti-Static Analysis",
                        "behavior": "Executable Code Obfuscation",
                        "method": "Stack Strings",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ]
                    },
                    {
                        "id": "C0008",
                        "objective": "Memory",
                        "behavior": "Change Memory Protection",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "change memory protection"
                            }
                        ]
                    },
                    {
                        "id": "C0007",
                        "objective": "Memory",
                        "behavior": "Allocate Memory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "allocate or change RWX memory"
                            }
                        ]
                    },
                    {
                        "id": "B0001.019",
                        "objective": "Anti-Behavioral Analysis",
                        "behavior": "Debugger Detection",
                        "method": "Process Environment Block",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "PEB access"
                            }
                        ]
                    },
                    {
                        "id": "C0016",
                        "objective": "File System",
                        "behavior": "Create File",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open file"
                            }
                        ]
                    },
                    {
                        "id": "E1082",
                        "objective": "Discovery",
                        "behavior": "System Information Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk size"
                            }
                        ]
                    },
                    {
                        "id": "F0015.006",
                        "objective": "Defense Evasion",
                        "behavior": "Hijack Execution Flow",
                        "method": "Abuse Windows Function Calls",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "execute shellcode via Windows callback function"
                            }
                        ]
                    },
                    {
                        "id": "C0007",
                        "objective": "Memory",
                        "behavior": "Allocate Memory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "execute shellcode via indirect call"
                            }
                        ]
                    },
                    {
                        "id": "E1083",
                        "objective": "Discovery",
                        "behavior": "File and Directory Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ]
                    },
                    {
                        "id": "C0018",
                        "objective": "Process",
                        "behavior": "Terminate Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "terminate process"
                            }
                        ]
                    },
                    {
                        "id": "C0040",
                        "objective": "Process",
                        "behavior": "Allocate Thread Local Storage",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "allocate thread local storage"
                            }
                        ]
                    }
                ],
                "has_evtx": false,
                "has_pcap": false
            }
        },
        {
            "id": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_VMRay",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_VMRay"
            },
            "attributes": {
                "has_memdump": false,
                "has_html_report": false,
                "behash": "97c06dac01bdc7fb25c159bfc5b6ef47",
                "analysis_date": 1721393653,
                "files_written": [
                    "c:\\users\\rdhj0cnfevzx\\appdata\\roaming\\aratcih"
                ],
                "processes_tree": [
                    {
                        "process_id": "4344",
                        "name": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                    },
                    {
                        "process_id": "1656",
                        "name": "C:\\Windows\\Explorer.EXE",
                        "children": [
                            {
                                "process_id": "1012",
                                "name": "C:\\Windows\\system32\\svchost.exe -k netsvcs",
                                "children": [
                                    {
                                        "process_id": "4636",
                                        "name": "C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "memory_pattern_urls": [
                    "http://gebeus.ru/tmp/index.php",
                    "http://evilos.cc/tmp/index.php",
                    "http://office-techs.biz/tmp/index.php",
                    "http://cx5519.com/tmp/index.php"
                ],
                "signature_matches": [
                    {
                        "id": "vti_match_2032",
                        "name": "Writes into the memory of another process",
                        "description": "(Process #1) 2.exe modifies memory of (process #2) explorer.exe.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            }
                        ]
                    },
                    {
                        "id": "vti_match_0",
                        "name": "Tries to detect debugger",
                        "description": "(Process #1) 2.exe tries to detect a debugger via API \"NtQueryInformationProcess\".",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            }
                        ]
                    },
                    {
                        "id": "vti_match_380",
                        "name": "Creates mutex",
                        "description": "(Process #2) explorer.exe creates mutex with name \"D69A52F145F3A62DDE7821AEB69A1D0A0C287F38\".",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "vti_match_381",
                        "name": "Deletes file after execution",
                        "description": "(Process #2) explorer.exe deletes executed executable \"C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih\".",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_382",
                        "name": "Deletes file after execution",
                        "description": "(Process #2) explorer.exe deletes executed executable \"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\".",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2027",
                        "name": "Downloads file",
                        "description": "(Process #2) explorer.exe downloads file via http from http://gebeus.ru/tmp/index.php.",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "324fbaad62d96efa9812ea69c66f74a389f5658cbf9e6881d929b0871e147976"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_1",
                        "name": "Enumerates running processes",
                        "description": "(Process #2) explorer.exe enumerates running processes.",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_679",
                        "name": "Delays execution",
                        "description": "(Process #2) explorer.exe has a thread which sleeps more than 5 minutes.",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_383",
                        "name": "Obscures a file's origin",
                        "description": "(Process #2) explorer.exe tries to delete zone identifier of file \"C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih\".",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2031",
                        "name": "Smoke Loader configuration was extracted",
                        "description": "A configuration for Smoke Loader was extracted from artifacts of the dynamic analysis.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2036",
                        "name": "Malicious host or URL detected via reputation",
                        "description": "Reputation analysis labels the URL \"http://evilos.cc/tmp/index.php\" which was contacted by (process #2) explorer.exe as C2/Generic-A.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2035",
                        "name": "Malicious host or URL detected via reputation",
                        "description": "Reputation analysis labels the URL \"http://gebeus.ru/tmp/index.php\" which was contacted by (process #2) explorer.exe as C2/Generic-A.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2037",
                        "name": "Malicious host or URL detected via reputation",
                        "description": "Reputation analysis labels the resolved domain \"evilos.cc\" as C2/Generic-A.",
                        "severity": "IMPACT_SEVERITY_HIGH"
                    },
                    {
                        "id": "vti_match_2040",
                        "name": "Malicious host or URL detected via reputation",
                        "description": "Reputation analysis labels the resolved domain \"gebeus.ru\" as C2/Generic-A.",
                        "severity": "IMPACT_SEVERITY_HIGH"
                    },
                    {
                        "id": "vti_match_2034",
                        "name": "Malicious file detected via reputation",
                        "description": "Reputation analysis labels the sample itself as Mal/Generic-S.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2051",
                        "name": "Schedules task",
                        "description": "Schedules task for command \"C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih\", to be triggered by LOGON.",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2052",
                        "name": "Schedules task",
                        "description": "Schedules task for command \"C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih\", to be triggered by TIME. Task has been rescheduled by the analyzer.",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2048",
                        "format": "SIG_FORMAT_YARA",
                        "name": "Malicious content matched by YARA rules",
                        "description": "YARA detected \"SmokeLoader\" from ruleset \"Malware\" in memory dump data from (process #2) explorer.exe.",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "9f51ceca0492258d51f71ed11ca6feceb37778d1b4ed5f5ae513b7406270c9b5"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "C:\\Windows\\Explorer.EXE"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2046",
                        "format": "SIG_FORMAT_YARA",
                        "name": "Malicious content matched by YARA rules",
                        "description": "YARA detected \"SmokeLoaderNetwork\" from ruleset \"Malware\" in web response data from \"http://gebeus.ru/tmp/index.php\".",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "cc2fa9d186b3ad8042f9a20924aac5a90e0463949c24fadbfeb3b6a9e0b30836"
                            },
                            {
                                "ref": "#files_dropped",
                                "value": "d2d3cbc88ef1607552799611e7c90623f1a230268d4df706e2f3b8685cd03cac"
                            },
                            {
                                "ref": "#files_dropped",
                                "value": "02dd64c9c207a04cd7aa00b588156fe52158d0a68dab16c35380ee9fd8a9c578"
                            },
                            {
                                "ref": "#files_dropped",
                                "value": "182b74a0dcd41d38d4ac9975256d53aa9ebb49ac9bad5868ff0ac60109ee1c4f"
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2043",
                        "format": "SIG_FORMAT_YARA",
                        "name": "Suspicious content matched by YARA rules",
                        "description": "YARA detected \"VMDeviceStrings\" from ruleset \"Generic\" in function strings data from (process #1) 2.exe.",
                        "severity": "IMPACT_SEVERITY_MEDIUM",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#files_dropped",
                                "value": "88d9e84d77ef269809f64796a8171dcaf44e509a04d64aa9b9564d0f034b4b89"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2045",
                        "format": "SIG_FORMAT_YARA",
                        "name": "Suspicious content matched by YARA rules",
                        "description": "YARA detected \"VMModuleNames\" from ruleset \"Generic\" in function strings data from (process #1) 2.exe.",
                        "severity": "IMPACT_SEVERITY_MEDIUM",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#files_dropped",
                                "value": "88d9e84d77ef269809f64796a8171dcaf44e509a04d64aa9b9564d0f034b4b89"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            }
                        ]
                    },
                    {
                        "id": "vti_match_2044",
                        "format": "SIG_FORMAT_YARA",
                        "name": "Suspicious content matched by YARA rules",
                        "description": "YARA detected \"VMProcessNames\" from ruleset \"Generic\" in function strings data from (process #1) 2.exe.",
                        "severity": "IMPACT_SEVERITY_MEDIUM",
                        "refs": [
                            {
                                "ref": "#files_dropped",
                                "value": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890"
                            },
                            {
                                "ref": "#files_dropped",
                                "value": "88d9e84d77ef269809f64796a8171dcaf44e509a04d64aa9b9564d0f034b4b89"
                            },
                            {
                                "ref": "#process_tree",
                                "value": "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\2.exe\" "
                            }
                        ]
                    }
                ],
                "http_conversations": [
                    {
                        "url": "http://gebeus.ru/tmp/index.php",
                        "request_method": "POST",
                        "request_headers": {
                            "Host": "gebeus.ru",
                            "Content-Length": "365",
                            "Content-Type": "application/x-www-form-urlencoded",
                            "Accept": "*/*",
                            "Connection": "Keep-Alive",
                            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko",
                            "Referer": "http://yuhnrimdkejtftx.org/"
                        },
                        "response_headers": {
                            "Date": "Fri, 19 Jul 2024 12:57:05 GMT",
                            "Server": "nginx/1.26.0",
                            "Content-Type": "text/html; charset=utf-8",
                            "Connection": "close"
                        },
                        "response_status_code": 404
                    },
                    {
                        "url": "http://gebeus.ru/tmp/index.php",
                        "request_method": "POST",
                        "request_headers": {
                            "Host": "gebeus.ru",
                            "Content-Length": "161",
                            "Content-Type": "application/x-www-form-urlencoded",
                            "Accept": "*/*",
                            "Connection": "Keep-Alive",
                            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko",
                            "Referer": "http://ccgrtvlajxvplgh.org/"
                        },
                        "response_headers": {
                            "Date": "Fri, 19 Jul 2024 12:57:57 GMT",
                            "Server": "nginx/1.26.0",
                            "Content-Type": "text/html; charset=utf-8",
                            "Connection": "close"
                        },
                        "response_status_code": 404
                    },
                    {
                        "url": "http://gebeus.ru/tmp/index.php",
                        "request_method": "POST",
                        "request_headers": {
                            "Host": "gebeus.ru",
                            "Content-Length": "306",
                            "Content-Type": "application/x-www-form-urlencoded",
                            "Accept": "*/*",
                            "Connection": "Keep-Alive",
                            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko",
                            "Referer": "http://aqewwbvmaetw.net/"
                        },
                        "response_headers": {
                            "Date": "Fri, 19 Jul 2024 12:58:38 GMT",
                            "Server": "nginx/1.26.0",
                            "Content-Type": "text/html; charset=utf-8",
                            "Connection": "close"
                        },
                        "response_status_code": 404
                    },
                    {
                        "url": "http://gebeus.ru/tmp/index.php",
                        "request_method": "POST",
                        "request_headers": {
                            "Host": "gebeus.ru",
                            "Content-Length": "231",
                            "Content-Type": "application/x-www-form-urlencoded",
                            "Accept": "*/*",
                            "Connection": "Keep-Alive",
                            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; Trident/7.0; rv:11.0) like Gecko",
                            "Referer": "http://fpyytfpprafxu.org/"
                        },
                        "response_headers": {
                            "Date": "Fri, 19 Jul 2024 12:59:13 GMT",
                            "Server": "nginx/1.26.0",
                            "Content-Type": "text/html; charset=utf-8",
                            "Connection": "close"
                        },
                        "response_status_code": 404
                    }
                ],
                "ip_traffic": [
                    {
                        "destination_ip": "211.40.39.251",
                        "destination_port": 80,
                        "transport_layer_protocol": "TCP"
                    }
                ],
                "processes_created": [
                    "C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih"
                ],
                "memory_pattern_domains": [
                    "gebeus.ru",
                    "evilos.cc",
                    "office-techs.biz",
                    "cx5519.com"
                ],
                "registry_keys_opened": [
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Enum\\SCSI",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Enum\\IDE",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Internet Explorer\\svcVersion"
                ],
                "sigma_analysis_results": [
                    {
                        "rule_level": "medium",
                        "rule_id": "43c6ce8bdbd683e1a7f4fb9b49a3a8236621ff32e67fdf0987c5770097ef376c",
                        "rule_source": "Sigma Integrated Rule Set (GitHub)",
                        "rule_title": "ADS Zone.Identifier Deleted By Uncommon Application",
                        "rule_description": "Detects the deletion of the \"Zone.Identifier\" ADS by an uncommon process. Attackers can leverage this in order to bypass security restrictions that make use of the ADS such as Microsoft Office apps.",
                        "rule_author": "Nasreddine Bencherchali (Nextron Systems)",
                        "match_context": [
                            {
                                "values": {
                                    "TargetFilename": "c:\\users\\rdhj0cnfevzx\\appdata\\roaming\\aratcih:zone.identifier"
                                }
                            }
                        ]
                    }
                ],
                "last_modification_date": 1721426249,
                "verdicts": [
                    "SPREADER"
                ],
                "files_deleted": [
                    "c:\\users\\rdhj0cnfevzx\\desktop\\2.exe",
                    "c:\\users\\rdhj0cnfevzx\\appdata\\roaming\\aratcih",
                    "c:\\users\\rdhj0cnfevzx\\appdata\\roaming\\aratcih:zone.identifier"
                ],
                "files_dropped": [
                    {
                        "sha256": "127161a7235c767e77572c6ef308c051a533e64e5067374090a674b1948b3a7b"
                    },
                    {
                        "sha256": "324fbaad62d96efa9812ea69c66f74a389f5658cbf9e6881d929b0871e147976"
                    },
                    {
                        "sha256": "c3d6feb1318b4cb0773267e75e0827cc291032c3167bdb99faf036f7ac091c0a"
                    },
                    {
                        "sha256": "0aed025f0e6348ac7b651890d81ae247774e76d5171248b061db4511f1a227a8"
                    },
                    {
                        "sha256": "db2d808b7111da8edc789c2bc5477bd3545b06402e839d1e926bd61fa8073e58"
                    },
                    {
                        "sha256": "cc2fa9d186b3ad8042f9a20924aac5a90e0463949c24fadbfeb3b6a9e0b30836"
                    },
                    {
                        "sha256": "d2d3cbc88ef1607552799611e7c90623f1a230268d4df706e2f3b8685cd03cac"
                    },
                    {
                        "sha256": "02dd64c9c207a04cd7aa00b588156fe52158d0a68dab16c35380ee9fd8a9c578"
                    },
                    {
                        "sha256": "182b74a0dcd41d38d4ac9975256d53aa9ebb49ac9bad5868ff0ac60109ee1c4f"
                    },
                    {
                        "sha256": "9f51ceca0492258d51f71ed11ca6feceb37778d1b4ed5f5ae513b7406270c9b5"
                    },
                    {
                        "sha256": "88d9e84d77ef269809f64796a8171dcaf44e509a04d64aa9b9564d0f034b4b89"
                    }
                ],
                "dns_lookups": [
                    {
                        "hostname": "gebeus.ru",
                        "resolved_ips": [
                            "211.40.39.251",
                            "58.151.148.90",
                            "211.171.233.126",
                            "78.89.199.216",
                            "185.18.245.58",
                            "201.233.78.169",
                            "219.92.154.145",
                            "211.202.224.10",
                            "189.143.190.45",
                            "181.204.98.226"
                        ]
                    },
                    {
                        "hostname": "evilos.cc"
                    }
                ],
                "mitre_attack_techniques": [
                    {
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "(Process #2) explorer.exe enumerates running processes.",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_1"
                            }
                        ]
                    },
                    {
                        "id": "T1096",
                        "severity": "IMPACT_SEVERITY_HIGH",
                        "signature_description": "(Process #2) explorer.exe tries to delete zone identifier of file \"C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih\".",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_383"
                            }
                        ]
                    },
                    {
                        "id": "T1071",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "(Process #2) explorer.exe downloads file via http from http://gebeus.ru/tmp/index.php.",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_2027"
                            }
                        ]
                    },
                    {
                        "id": "T1105",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "(Process #2) explorer.exe downloads file via http from http://gebeus.ru/tmp/index.php.",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_2027"
                            }
                        ]
                    },
                    {
                        "id": "T1053",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "signature_description": "Schedules task for command \"C:\\Users\\RDhJ0CNFevzX\\AppData\\Roaming\\aratcih\", to be triggered by TIME. Task has been rescheduled by the analyzer.",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_2051"
                            },
                            {
                                "ref": "#signature_matches",
                                "value": "vti_match_2052"
                            }
                        ]
                    }
                ],
                "sandbox_name": "VMRay",
                "verdict_labels": [
                    "SmokeLoader",
                    "C2/Generic-A",
                    "Mal/Generic-S"
                ],
                "text_decoded": [
                    "[{\"parser\": \"SmokeLoader\", \"metadata\": [{\"type\": \"mission_id\", \"tags\": [], \"value\": \"2022\"}, {\"type\": \"encryption_key\", \"key\": \"4Jezpg==\", \"tags\": [\"Network Communication Decryption Key\"], \"algorithm\": \"RC4\", \"mode\": null, \"iv\": null}, {\"type\": \"encryption_key\", \"key\": \"QOUiOw==\", \"tags\": [\"Network Communication Encryption Key\"], \"algorithm\": \"RC4\", \"mode\": null, \"iv\": null}, {\"type\": \"url\", \"url\": \"http://evilos.cc/tmp/index.php\", \"tags\": [], \"socket\": {\"type\": \"socket\", \"tags\": [], \"address\": \"evilos.cc\", \"port\": null, \"network_protocol\": null, \"c2\": true, \"listen\": null}, \"path\": \"/tmp/index.php\", \"query\": null, \"application_protocol\": \"http\", \"credential\": null}, {\"type\": \"url\", \"url\": \"http://gebeus.ru/tmp/index.php\", \"tags\": [], \"socket\": {\"type\": \"socket\", \"tags\": [], \"address\": \"gebeus.ru\", \"port\": null, \"network_protocol\": null, \"c2\": true, \"listen\": null}, \"path\": \"/tmp/index.php\", \"query\": null, \"application_protocol\": \"http\", \"credential\": null}, {\"type\": \"url\", \"url\": \"http://office-techs.biz/tmp/index.php\", \"tags\": [], \"socket\": {\"type\": \"socket\", \"tags\": [], \"address\": \"office-techs.biz\", \"port\": null, \"network_protocol\": null, \"c2\": true, \"listen\": null}, \"path\": \"/tmp/index.php\", \"query\": null, \"application_protocol\": \"http\", \"credential\": null}, {\"type\": \"url\", \"url\": \"http://cx5519.com/tmp/index.php\", \"tags\": [], \"socket\": {\"type\": \"socket\", \"tags\": [], \"address\": \"cx5519.com\", \"port\": null, \"network_protocol\": null, \"c2\": true, \"listen\": null}, \"path\": \"/tmp/index.php\", \"query\": null, \"application_protocol\": \"http\", \"credential\": null}]}]"
                ],
                "mutexes_opened": [
                    "D69A52F145F3A62DDE7821AEB69A1D0A0C287F38"
                ],
                "has_evtx": false,
                "has_pcap": false
            }
        },
        {
            "id": "fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_Yomi Hunter",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890_Yomi Hunter"
            },
            "attributes": {
                "has_memdump": false,
                "has_html_report": true,
                "behash": "dbb2024bc698b782821dde4e52e374f1",
                "analysis_date": 1721411862,
                "processes_tree": [
                    {
                        "process_id": "2420",
                        "name": "80347e8cfd7e6bd06c65e3dfdfd6ec03.exe",
                        "time_offset": 23605
                    }
                ],
                "calls_highlighted": [
                    "kernel32.ExitProcess",
                    "kernel32.TerminateProcess"
                ],
                "http_conversations": [
                    {
                        "url": "http://crt.sectigo.com/SectigoPublicCodeSigningCAR36.crt",
                        "request_method": "GET",
                        "request_headers": {
                            "User-Agent": "Microsoft-CryptoAPI/6.1",
                            "Host": "crt.sectigo.com"
                        },
                        "response_headers": {
                            "Content-Length": "1566",
                            "Content-Type": "application/pkix-cert"
                        },
                        "response_status_code": 200
                    },
                    {
                        "url": "http://www.microsoft.com/pki/certs/MicrosoftTimeStampPCA.crt",
                        "request_method": "GET",
                        "request_headers": {
                            "User-Agent": "Microsoft-CryptoAPI/6.1",
                            "Host": "www.microsoft.com"
                        },
                        "response_headers": {
                            "Content-Length": "1547",
                            "Content-Type": "application/octet-stream"
                        },
                        "response_status_code": 200
                    },
                    {
                        "url": "http://www.microsoft.com/pki/certs/MicCodSigPCA_08-31-2010.crt",
                        "request_method": "GET",
                        "request_headers": {
                            "User-Agent": "Microsoft-CryptoAPI/6.1",
                            "Host": "www.microsoft.com"
                        },
                        "response_headers": {
                            "Content-Length": "1472",
                            "Content-Type": "application/octet-stream"
                        },
                        "response_status_code": 200
                    },
                    {
                        "url": "http://crt.sectigo.com/SectigoPublicCodeSigningRootR46.p7c",
                        "request_method": "GET",
                        "request_headers": {
                            "User-Agent": "Microsoft-CryptoAPI/6.1",
                            "Host": "crt.sectigo.com"
                        },
                        "response_headers": {
                            "Content-Length": "4515",
                            "Content-Type": "application/pkcs7-mime"
                        },
                        "response_status_code": 200
                    }
                ],
                "last_modification_date": 1721411893,
                "modules_loaded": [
                    "msimg32",
                    "kernel32",
                    "rpcrt4",
                    "SspiCli"
                ],
                "verdicts": [
                    "MALWARE"
                ],
                "files_dropped": [
                    {
                        "path": "/msdownload/update/v3/static/trustedr/en/authrootstl.cab",
                        "sha256": "b33efcb95235b98b48508e019afa4b7655e80cf071defabd8b2123fc8b29307f",
                        "type": "CAB",
                        "download_url": "ctldl.windowsupdate.comhttp://ctldl.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab?5da65a72320b129f"
                    }
                ],
                "dns_lookups": [
                    {
                        "hostname": "crt.sectigo.com",
                        "resolved_ips": [
                            "172.64.149.23"
                        ]
                    }
                ],
                "mitre_attack_techniques": [
                    {
                        "id": "T1129",
                        "signature_description": "The process tried to load dynamically one or more functions."
                    },
                    {
                        "id": "T1045",
                        "signature_description": "Manalize Local SandBox Packer Harvesting"
                    },
                    {
                        "id": "T1063",
                        "signature_description": "It Tries to detect injection methods"
                    }
                ],
                "sandbox_name": "Yomi Hunter",
                "has_evtx": true,
                "has_pcap": true
            }
        }
    ],
    "meta": {
        "count": 4
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/fa40f7525b8d3be33bf8b4adfa328d55c7cfb54c6b3b6fe6b24789f71bed7890/behaviours?limit=10"
    }
}