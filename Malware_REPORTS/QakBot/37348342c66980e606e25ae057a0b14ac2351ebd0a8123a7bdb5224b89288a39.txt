{
    "data": [
        {
            "id": "37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39_C2AE"
            },
            "attributes": {
                "has_pcap": false,
                "has_html_report": false,
                "files_dropped": [
                    {
                        "path": "%SAMPLEPATH%",
                        "sha256": "8b5dcb91b3f5b4c3f375706e612749b6537eb653c5f73d2b6b8678b3ed9a5fa3"
                    }
                ],
                "command_executions": [
                    "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483",
                    "\"%windir%\\system32\\schtasks.exe\" /Create /RU \"NT AUTHORITY\\SYSTEM\" /tn yzfhlhnb /tr \"regsvr32.exe -s \\\"%SAMPLEPATH%\\\"\" /SC ONCE /Z /ST 09:10 /ET 09:22"
                ],
                "sandbox_name": "C2AE",
                "has_evtx": false,
                "verdict_labels": [
                    "Qakbot"
                ],
                "verdict_confidence": 80,
                "registry_keys_set": [
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\_IndexName_"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer",
                        "value": "%HTTP_PROXY%:8080"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable",
                        "value": "1"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\100000001F21B\\662"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\_FileId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\_ObjectLru_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\_Usn_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\_ObjectId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\AeFileID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\_UsnJournalId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\AeProgramID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\_FileId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\_ObjectLru_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\_Usn_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\_ObjectId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\AeFileID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\_UsnJournalId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\AeProgramID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\LruList\\0000000000002B6C\\ObjectLru"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\LruList\\0000000000002B6C\\ObjectId"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\abe1bff3",
                        "value": "3B C8 9D F2 FB 8A 5C 80 FD 1D 0F 1B 13 06 D5 65 56 46 8A 86 0B 0C B1 C4 F5 05 76 65 C5 DD 8B D2 02 51 92 B4 A4 05 55"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\248328a4",
                        "value": "30 80 E9 CC 70 5C 5A C7 5B 4D BF 96 88 6F B5 5D C1 8C BE 4E E9 67 34 CC 40 0A F0 DF DE 80 96 A0 26 E7 B0 F9 90 39 84 BE 3F BB 39 73 57 1B 34 89 A4 14 4D 32 54 36 68"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\d4a8d005",
                        "value": "86 A6 37 53 D0 A2 72 1F 05 08 2A B2 50 21 99 DE 5E B0 92 9C 48 03 9E E6 F8 F7 FC A5 0C 31 6A D4 63 62 BE 80 0C A2 5C 26 F6 FE 20 53 47 0B B5 B9 27 A4 00 D5 A1 49 91 16 15 0E BC 3D E5 43 2A 9C 02 2E B7 A9 42 48 81 15 AF E3 D9 BF 1F 77"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\598b672e",
                        "value": "75 07 60 5E 4A D5 45 91 E2 B8 09 49 1F 41 9B 2C 32 72 7E 1B F3 C6 03 52 F6 2B 77 EB DA 5D 32 99 7C E2 32 7F CD DC 33 E8 C9 4F D7 BF C7 BF B7 56 96 23 8C 7A EC 03 6B 7C F5 5A 5C E9 E0 5E AB 78 10 41 3C 1C 70 30 BE"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\26c208d8",
                        "value": "10 57 09 9F 89 95 DF 55 1F B1 AE 98 B3 4B BF F2 90 8E 24 93 3D"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\e137004b",
                        "value": "06 08 3D 40 BC D9 8F 57 B6 1E AF B8 57 C1 B7 65 8B F7 07 01 99 45 D5 13 CB 02 9B D6 B5 3B 8E 31 B8 05 D8 2B 42 88 CF BC 44 CE 95 A4 15 B0 2C 51 FD 5C"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\9e7e6fbd",
                        "value": "A2 25 54 01 F1 0E 0F 17 23 32 9D 7A 70 93 CD 76 B3 D9 A6 98 1B FB 22 1D 18 90 C4 71 30 BE 7C 67 D3 F7 35 40 23 25 74 E4 A5 01 9D 9E B5 0E 68 9A EC 63 F6 08 56 6A E4 88 AC AB 99 A0 9B 27 C0 90 3D A6 16 A4 B0 4D CB 1B A2 5F B8 02 AB B8 8D 69 47 38 8B D5 C5 EF 19 29 2C 42 66 5F EB 04 C1 29 12 81 46 4E BE AD F9 06 63 EF FD 27 AE BF D7 81 A2 C5 CA 2D BF A4 36 F9 EB B4 87 2A D1 5A 8D 93 D4 34 FB 3C 39 B8 93 B2 36 1C B8 33 B1 C4 8D B0 C0 70 6A 43 17 42 5E 9E D9 2C 63 CB FF 73 BF 7F 0B C7 F8 2D 9E 7D 00 E8 E1 FE 7D 5D 6E 72 A7 74 89 FF 2B 7F 2F BA BF C8 2E 94 AB"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Wqigacuybfu\\9c3f4fc1",
                        "value": "98 71 7E F3 A0 EA D7 08 64 14 F9 82 B2 43 82 82 FD 23 6C E0 6E FE 7E 99 C3 67 7B 9B 77 BA 82 26 BD FC F6 89 DD D1 75 58 CB 18 D3 98 D4 03 12 29 9C 1E 06 C8 EE 60 D5 B0 F4 12 4E 13 5F B4 25 16 21 77 24 B5 34 32 1A 44 63 62 8D 0A 1E AD 26 E4 D6 F4 7F DF A7 2B 59 88 0B 05 24 AB E1 96 A7 47 C3 1F 2E 79 0E C3 BB 14 8B 41 7C 90"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\_CurrentObjectId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\LruList\\0000000000002B69\\ObjectLru"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\LruList\\0000000000002B69\\ObjectId"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\200000001F9C9\\661"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings",
                        "value": "46 00 00 00 04 01 00 00 03 00 00 00 14 00 00 00 65 78 74 72 61 63 74 6F 72 2E 70 72 6F 78 79 3A 38 30 38 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 D0 5C 01 4D C1 D5 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\yzfhlhnb\\Index"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\yzfhlhnb\\Id"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\661\\Indexes\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\200000001F9C9"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{FBD4C5EA-A64D-47BA-B086-4DCF337145C2}\\DynamicInfo"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{FBD4C5EA-A64D-47BA-B086-4DCF337145C2}\\Path"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{FBD4C5EA-A64D-47BA-B086-4DCF337145C2}\\Hash"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{FBD4C5EA-A64D-47BA-B086-4DCF337145C2}\\Triggers"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\ObjectTable\\662\\Indexes\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\100000001F21B"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{cec89213-fcc5-11eb-b70b-167c9a143b0c}\\DefaultObjectStore\\LruList\\CurrentLru"
                    }
                ],
                "last_modification_date": 1637855266,
                "behash": "dbd3fdf3b7983e1cf7d6681a7cb82a01",
                "memory_pattern_urls": [
                    "tcp://93.48.58.123:2222",
                    "tcp://92.59.35.196:2222",
                    "tcp://86.123.105.31:443",
                    "tcp://45.46.53.140:2222",
                    "tcp://78.153.126.175:443",
                    "tcp://94.200.181.154:443",
                    "tcp://41.235.5.174:443",
                    "tcp://2.222.167.138:443",
                    "tcp://67.165.206.193:993",
                    "tcp://216.238.72.121:995",
                    "tcp://73.140.38.124:443",
                    "tcp://129.208.184.37:995",
                    "tcp://24.229.150.54:995",
                    "tcp://103.82.211.39:995",
                    "tcp://103.116.178.85:61200",
                    "tcp://123.252.190.14:443",
                    "tcp://182.176.180.73:443",
                    "tcp://27.147.204.38:995",
                    "tcp://65.100.174.110:8443",
                    "tcp://162.244.227.45:443",
                    "tcp://178.51.47.120:995",
                    "tcp://72.252.201.34:995",
                    "tcp://89.101.97.139:443",
                    "tcp://93.147.212.206:443",
                    "tcp://103.143.8.71:995",
                    "tcp://41.228.22.180:443",
                    "tcp://217.165.237.42:443",
                    "tcp://81.174.162.180:995",
                    "tcp://71.13.93.154:2222",
                    "tcp://105.198.236.99:995",
                    "tcp://209.210.95.228:443",
                    "tcp://206.47.134.234:2222",
                    "tcp://136.232.34.70:443",
                    "tcp://73.171.4.177:443",
                    "tcp://71.74.12.34:443",
                    "tcp://24.152.219.253:995",
                    "tcp://75.169.58.229:32100",
                    "tcp://100.1.119.41:443",
                    "tcp://220.255.25.187:2222",
                    "tcp://111.250.29.21:443",
                    "tcp://189.135.61.226:443",
                    "tcp://68.204.7.158:443",
                    "tcp://207.246.112.221:443",
                    "tcp://178.239.56.80:443",
                    "tcp://80.6.192.58:443",
                    "tcp://96.21.251.127:2222",
                    "tcp://93.48.80.198:995",
                    "tcp://176.63.117.1:22",
                    "tcp://68.186.192.69:443",
                    "tcp://117.198.148.163:443",
                    "tcp://94.60.254.81:443",
                    "tcp://27.223.92.142:995",
                    "tcp://103.142.10.177:443",
                    "tcp://39.49.95.46:995",
                    "tcp://140.82.49.12:443",
                    "tcp://24.139.72.117:443",
                    "tcp://39.33.218.78:995",
                    "tcp://24.55.112.61:443",
                    "tcp://111.91.87.187:443",
                    "tcp://86.173.96.86:443",
                    "tcp://83.223.164.163:443",
                    "tcp://27.5.4.111:2222",
                    "tcp://5.238.149.197:61202",
                    "tcp://89.137.52.44:443",
                    "tcp://189.223.33.109:443",
                    "tcp://50.194.160.233:32100",
                    "tcp://216.238.71.31:995",
                    "tcp://71.13.93.154:2083",
                    "tcp://79.160.207.214:443",
                    "tcp://187.121.105.111:995",
                    "tcp://75.188.35.168:995",
                    "tcp://91.178.126.51:995",
                    "tcp://136.143.11.232:443",
                    "tcp://63.143.92.99:995",
                    "tcp://186.64.67.17:443",
                    "tcp://75.66.88.33:443",
                    "tcp://103.116.178.85:993",
                    "tcp://96.246.158.154:995",
                    "tcp://71.13.93.154:6881",
                    "tcp://194.36.28.26:443",
                    "tcp://115.96.64.9:995",
                    "tcp://50.194.160.233:443",
                    "tcp://117.248.109.38:21",
                    "tcp://197.89.17.163:443",
                    "tcp://50.194.160.233:465",
                    "tcp://218.101.110.3:995",
                    "tcp://187.192.70.222:80",
                    "tcp://173.21.10.71:2222",
                    "tcp://216.238.71.31:443",
                    "tcp://45.9.20.200:2211",
                    "tcp://216.238.72.121:443",
                    "tcp://189.147.225.12:443",
                    "tcp://81.250.153.227:2222",
                    "tcp://96.37.113.36:993",
                    "tcp://103.168.241.135:465",
                    "tcp://86.97.160.193:443",
                    "tcp://120.150.218.241:995",
                    "tcp://78.191.52.30:995",
                    "tcp://102.65.38.57:443",
                    "tcp://5.193.134.177:995",
                    "tcp://109.12.111.14:443",
                    "tcp://73.151.236.31:443",
                    "tcp://190.73.3.148:2222",
                    "tcp://72.252.201.34:465",
                    "tcp://200.127.27.220:465",
                    "tcp://76.25.142.196:443",
                    "tcp://86.8.177.143:443",
                    "tcp://207.246.112.221:995"
                ],
                "processes_terminated": [
                    "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                    "%CONHOST% \"-64295192612470551531791231008-2465888952067479246-4144006117042614491794736910",
                    "wmiadap.exe /F /T /R",
                    "taskeng.exe {C58B71E8-B47A-455C-B051-EEC06823576E}",
                    "regsvr32.exe -s \"%SAMPLEPATH%\"",
                    " -s \"%SAMPLEPATH%\"",
                    "%windir%\\SysWOW64\\explorer.exe",
                    "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483",
                    "\"%windir%\\system32\\schtasks.exe\" /Create /RU \"NT AUTHORITY\\SYSTEM\" /tn yzfhlhnb /tr \"regsvr32.exe -s \\\"%SAMPLEPATH%\\\"\" /SC ONCE /Z /ST 09:10 /ET 09:22"
                ],
                "has_memdump": false,
                "analysis_date": 1637768840,
                "memory_pattern_ips": [
                    "93.48.58.123",
                    "92.59.35.196",
                    "86.123.105.31",
                    "45.46.53.140",
                    "78.153.126.175",
                    "94.200.181.154",
                    "41.235.5.174",
                    "2.222.167.138",
                    "67.165.206.193",
                    "216.238.72.121",
                    "73.140.38.124",
                    "129.208.184.37",
                    "24.229.150.54",
                    "103.82.211.39",
                    "103.116.178.85",
                    "123.252.190.14",
                    "182.176.180.73",
                    "27.147.204.38",
                    "65.100.174.110",
                    "162.244.227.45",
                    "178.51.47.120",
                    "72.252.201.34",
                    "89.101.97.139",
                    "93.147.212.206",
                    "103.143.8.71",
                    "41.228.22.180",
                    "217.165.237.42",
                    "81.174.162.180",
                    "71.13.93.154",
                    "105.198.236.99",
                    "209.210.95.228",
                    "206.47.134.234",
                    "136.232.34.70",
                    "73.171.4.177",
                    "71.74.12.34",
                    "24.152.219.253",
                    "75.169.58.229",
                    "100.1.119.41",
                    "220.255.25.187",
                    "111.250.29.21",
                    "189.135.61.226",
                    "68.204.7.158",
                    "207.246.112.221",
                    "178.239.56.80",
                    "80.6.192.58",
                    "96.21.251.127",
                    "93.48.80.198",
                    "176.63.117.1",
                    "68.186.192.69",
                    "117.198.148.163",
                    "94.60.254.81",
                    "27.223.92.142",
                    "103.142.10.177",
                    "39.49.95.46",
                    "140.82.49.12",
                    "24.139.72.117",
                    "39.33.218.78",
                    "24.55.112.61",
                    "111.91.87.187",
                    "86.173.96.86",
                    "83.223.164.163",
                    "27.5.4.111",
                    "5.238.149.197",
                    "89.137.52.44",
                    "189.223.33.109",
                    "50.194.160.233",
                    "216.238.71.31",
                    "79.160.207.214",
                    "187.121.105.111",
                    "75.188.35.168",
                    "91.178.126.51",
                    "136.143.11.232",
                    "63.143.92.99",
                    "186.64.67.17",
                    "75.66.88.33",
                    "96.246.158.154",
                    "194.36.28.26",
                    "115.96.64.9",
                    "117.248.109.38",
                    "197.89.17.163",
                    "218.101.110.3",
                    "187.192.70.222",
                    "173.21.10.71",
                    "45.9.20.200",
                    "189.147.225.12",
                    "81.250.153.227",
                    "96.37.113.36",
                    "103.168.241.135",
                    "86.97.160.193",
                    "120.150.218.241",
                    "78.191.52.30",
                    "102.65.38.57",
                    "5.193.134.177",
                    "109.12.111.14",
                    "73.151.236.31",
                    "190.73.3.148",
                    "200.127.27.220",
                    "76.25.142.196",
                    "86.8.177.143"
                ],
                "verdicts": [
                    "STEALER"
                ],
                "processes_tree": [
                    {
                        "process_id": "2288",
                        "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                    },
                    {
                        "process_id": "2820",
                        "name": "%CONHOST% \"-64295192612470551531791231008-2465888952067479246-4144006117042614491794736910"
                    },
                    {
                        "process_id": "1344",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2044",
                        "name": "taskeng.exe {C58B71E8-B47A-455C-B051-EEC06823576E}",
                        "children": [
                            {
                                "process_id": "2244",
                                "name": "regsvr32.exe -s \"%SAMPLEPATH%\"",
                                "children": [
                                    {
                                        "process_id": "1180",
                                        "name": " -s \"%SAMPLEPATH%\""
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "process_id": "2268",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2932",
                        "name": "regsvr32.exe -s \"%SAMPLEPATH%\"",
                        "children": [
                            {
                                "process_id": "2940",
                                "name": " -s \"%SAMPLEPATH%\"",
                                "children": [
                                    {
                                        "process_id": "2960",
                                        "name": "%windir%\\SysWOW64\\explorer.exe"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "process_id": "2480",
                        "name": "%windir%\\system32\\DllHost.exe /Processid:{3EB3C877-1F16-487C-9050-104DBCD66683}"
                    },
                    {
                        "process_id": "2696",
                        "name": "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483",
                        "children": [
                            {
                                "process_id": "2788",
                                "name": "%windir%\\SysWOW64\\explorer.exe",
                                "children": [
                                    {
                                        "process_id": "2812",
                                        "time_offset": 2,
                                        "name": "\"%windir%\\system32\\schtasks.exe\" /Create /RU \"NT AUTHORITY\\SYSTEM\" /tn yzfhlhnb /tr \"regsvr32.exe -s \\\"%SAMPLEPATH%\\\"\" /SC ONCE /Z /ST 09:10 /ET 09:22"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39_CAPA"
            },
            "attributes": {
                "has_pcap": false,
                "has_html_report": false,
                "sandbox_name": "CAPA",
                "has_evtx": false,
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n",
                        "name": "calculate modulo 256 via x86 assembly",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n",
                        "name": "allocate memory",
                        "authors": [
                            "0x534a@mailbox.org"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: allocate RW memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x4 = PAGE_READWRITE\n",
                        "name": "allocate RW memory",
                        "authors": [
                            "0x534a@mailbox.org"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create or open registry key\n    namespace: host-interaction/registry\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n",
                        "name": "create or open registry key",
                        "description": "host-interaction/registry"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - api: kernel32.Sleep\n      - api: kernel32.SleepEx\n      - api: kernel32.WaitForSingleObject\n      - api: kernel32.SignalObjectAndWait\n      - api: kernel32.WaitForSingleObjectEx\n      - api: kernel32.WaitForMultipleObjects\n      - api: kernel32.WaitForMultipleObjectsEx\n      - api: kernel32.RegisterWaitForSingleObject\n      - api: WaitOnAddress\n      - api: user32.MsgWaitForMultipleObjects\n      - api: user32.MsgWaitForMultipleObjectsEx\n      - api: NtDelayExecution\n      - api: KeWaitForSingleObject\n      - api: KeDelayExecutionThread\n",
                        "name": "delay execution",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: allocate RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - match: allocate memory\n      - number: 0x40 = PAGE_EXECUTE_READWRITE\n",
                        "name": "allocate RWX memory",
                        "description": "host-interaction/process/inject"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
                        "name": "encode data using XOR",
                        "description": "data-manipulation/encoding/xor"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hide graphical window\n    namespace: host-interaction/gui/window/hide\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Hide Artifacts::Hidden Window [T1564.003]\n    examples:\n      - 39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10007250\n  features:\n    - and:\n      - number: 0x0 = SW_HIDE\n      - api: user32.ShowWindow\n",
                        "name": "hide graphical window",
                        "description": "host-interaction/gui/window/hide"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set global application hook\n    namespace: host-interaction/gui\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n  features:\n    - and:\n      - api: user32.SetWindowsHookEx\n      - number: 0x3 = WM_GETMESSAGE\n      - number: 0x0 = dwThreadId\n",
                        "name": "set global application hook",
                        "description": "host-interaction/gui"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - api: System.Threading.Thread::Start\n",
                        "name": "create thread",
                        "description": "host-interaction/thread/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: inspect load icon resource\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n  features:\n    # check if call to LoadIcon fails when first argument is NULL\n    # and second argument is not a valid predefined icon - LoadIcon\n    # should return NULL here, but some sandboxes/emulation may instead\n    # return a valid handle\n    - and:\n      - api: user32.LoadIcon\n      - number: 0x0\n      - mnemonic: test\n      - not:\n        - or:\n          - description: predefined icon identifiers\n          - number: 0x7F05 = IDI_WINLOGO\n          - number: 0x7F06 = IDI_SHIELD\n          - number: 0x7F02 = IDI_QUESTION\n          - number: 0x7F00 = IDI_APPLICATION\n          - number: 0x7F04 = (IDI_ASTERISK | IDI_INFORMATION)\n          - number: 0x7F01 = (IDI_ERROR | IDI_HAND)\n          - number: 0x7F03 = (IDI_EXCLAMATION | IDI_WARNING)\n",
                        "name": "inspect load icon resource",
                        "description": "anti-analysis"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n",
                        "name": "create process on Windows",
                        "description": "host-interaction/process/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n",
                        "name": "accept command line arguments",
                        "description": "host-interaction/cli"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n",
                        "name": "query or enumerate registry value",
                        "description": "host-interaction/registry"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n",
                        "name": "write file on Windows",
                        "description": "host-interaction/file-system/write"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe"
                        ],
                        "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get geographical location\n    namespace: collection\n    authors:\n      - moritz.raabe\n    scope: function\n    att&ck:\n      - Discovery::System Location Discovery [T1614]\n    examples:\n      - 9879D201DC5ACA863F357184CD1F170E:0x10001A99\n  features:\n    - or:\n      - api: GetLocaleInfo\n      - api: GetLocaleInfoEx\n      # strings part of requests or parsed from response\n      # \"geo\" and \"zip\" are too short\n      # \"region\" results in FPs mostly related to memory\n      - string: /geolocation/i\n      - string: /geo-location/i\n      - string: /^city/i\n      - string: /region_code/i\n      - string: /region_name/i\n      - string: /^country/i\n      - string: /country_code/i\n      - string: /countrycode/i\n      - string: /country_name/i\n      - string: /continent_code/i\n      - string: /continent_name/i\n      - string: /^latitude/i\n      - string: /^longitude/i\n",
                        "name": "get geographical location",
                        "description": "collection"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - match: contain a resource (.rsrc) section\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n      - api: user32.LoadString\n",
                        "name": "extract resource via kernel32 functions",
                        "description": "executable/resource"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set thread local storage value\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Set Thread Local Storage Value [C0041]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000AE21\n  features:\n    - and:\n      - api: kernel32.TlsSetValue\n      - optional:\n        - match: allocate thread local storage\n",
                        "name": "set thread local storage value",
                        "description": "host-interaction/process"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get thread local storage value\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n  features:\n    - and:\n      - api: kernel32.TlsGetValue\n",
                        "name": "get thread local storage value",
                        "description": "host-interaction/process"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: allocate thread local storage\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Process::Allocate Thread Local Storage [C0040]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\n  features:\n    - or:\n      - api: kernel32.TlsAlloc\n",
                        "name": "allocate thread local storage",
                        "description": "host-interaction/process"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n",
                        "name": "create mutex",
                        "description": "host-interaction/mutex"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n",
                        "name": "find graphical window",
                        "description": "host-interaction/gui/window/find"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - api: kernel32.CreateFile\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n",
                        "name": "read file on Windows",
                        "description": "host-interaction/file-system/read"
                    },
                    {
                        "description": "host-interaction/hardware/storage",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get disk size\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347\n    examples:\n      - al-khaser_x86.exe_:0x4343D0\n      - al-khaser_x86.exe_:0x434010\n  features:\n    - or:\n      - api: kernel32.GetDiskFreeSpace\n      - api: kernel32.GetDiskFreeSpaceEx\n      - basic block:\n        - and:\n          - api: DeviceIoControl\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - and:\n        - or:\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i\n        - string: \"Size\"\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "get disk size"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get file version info\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    examples:\n      - mimikatz.exe_:0x45E308\n  features:\n    - and:\n      - or:\n        - api: version.GetFileVersionInfo\n        - api: version.GetFileVersionInfoEx\n        - api: System.Diagnostics.FileVersionInfo::GetVersionInfo\n      - optional:\n        - description: retrieve specified version information from the version-information resource\n        - api: version.VerQueryValue\n        - or:\n          - api: version.GetFileVersionInfoSize\n          - api: version.GetFileVersionInfoSizeEx\n",
                        "name": "get file version info",
                        "description": "host-interaction/file-system/meta"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get system information on Windows\n    namespace: host-interaction/os/info\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetSystemInfo\n        - api: kernel32.GetNativeSystemInfo\n        - api: NtQuerySystemInformation\n        - api: NtQuerySystemInformationEx\n        - api: ntdll.RtlGetNativeSystemInformation\n        - api: ZwQuerySystemInformation\n        - api: ZwQuerySystemInformationEx\n",
                        "name": "get system information on Windows",
                        "description": "host-interaction/os/info"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read clipboard data\n    namespace: host-interaction/clipboard\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Clipboard Data [T1115]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x40156F\n      - 93dfc146f60bd796eb28d4e4f348f2e4:0x401050\n  features:\n    - and:\n      - optional:\n        - match: open clipboard\n      - or:\n        - api: user32.GetClipboardData\n        - api: System.Windows.Forms.Clipboard::GetAudioStream\n        - api: System.Windows.Forms.Clipboard::GetData\n        - api: System.Windows.Forms.Clipboard::GetDataObject\n        - api: System.Windows.Forms.Clipboard::GetFileDropList\n        - api: System.Windows.Forms.Clipboard::GetImage\n        - api: System.Windows.Forms.Clipboard::GetText\n",
                        "name": "read clipboard data",
                        "description": "host-interaction/clipboard"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "@_re_fox",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: capture screenshot\n    namespace: collection/screenshot\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Screen Capture [T1113]\n    mbc:\n      - Collection::Screen Capture::WinAPI [E1113.m01]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314610A\n      - 7204e3efc2434012e13ca939db0d0b02:0x414070\n      - 50D5EE1CE2CA5E30C6B1019EE64EEEC2:0x406E07\n  features:\n    - or:\n      - and:\n        - or:\n          - api: user32.GetWindowDC\n          - api: user32.GetDC\n          - and:\n            - api: gdi32.CreateDC\n            - string: \"DISPLAY\"\n        - or:\n          - api: gdi32.BitBlt\n          - api: gdi32.GetDIBits\n        - api: gdi32.CreateCompatibleDC\n        - api: gdi32.CreateCompatibleBitmap\n        - optional:\n          - or:\n            - api: user32.GetSystemMetrics = fetch screen dimensions\n            - api: user32.GetDesktopWindow = get entire desktop\n      - basic block:\n        - and:\n          - api: BitBlt\n          - characteristic: tight loop\n",
                        "name": "capture screenshot",
                        "description": "collection/screenshot"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n",
                        "name": "link many functions at runtime",
                        "description": "linking/runtime-linking"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "johnk3r"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate gui resources\n    namespace: host-interaction/gui\n    authors:\n      - johnk3r\n    scope: function\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 5e6764534b3a1e4d3abacc4810b6985d:0x4011C0\n      - a74ee8200aace7d19dee79871bbf2ed3:0x403750\n      - 74fa32d2b277f583010b692a3f91b627:0x66BAEA67\n      - 021f49678cd633dc8cf99c61b3af3dda:0x40E44A\n  features:\n    - or:\n      - api: EnumResourceTypes\n      - api: EnumWindowStations\n      - api: EnumDesktops\n      - api: EnumWindows\n",
                        "name": "enumerate gui resources",
                        "description": "host-interaction/gui"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: check for time delay via GetTickCount\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013d0\n  features:\n    - and:\n      - count(api(kernel32.GetTickCount)): 2 or more\n      - basic block:\n        - and:\n          - mnemonic: sub\n          - mnemonic: cmp\n",
                        "name": "check for time delay via GetTickCount",
                        "description": "anti-analysis/anti-debugging/debugger-detection"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: log keystrokes via polling\n    namespace: collection/keylog\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Input Capture::Keylogging [T1056.001]\n    mbc:\n      - Collection::Keylogging::Polling [F0002.002]\n    examples:\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001030\n  features:\n    - or:\n      - api: user32.GetAsyncKeyState\n      - api: user32.GetKeyState\n      - api: user32.GetKeyboardState\n      - api: user32.VkKeyScan\n      - api: user32.VkKeyScanEx\n      - api: user32.GetKeyNameText\n",
                        "name": "log keystrokes via polling",
                        "description": "collection/keylog"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get keyboard layout\n    namespace: host-interaction/hardware/keyboard\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Location Discovery::System Language Discovery [T1614.001]\n    examples:\n      - 6F99A2C8944CB02FF28C6F9CED59B161:0x4193C0\n      - C91887D861D9BD4A5872249B641BC9F9:0x4015FD\n  features:\n    - and:\n      - or:\n        - api: user32.GetKeyboardLayoutList\n        - api: user32.GetKeyboardLayout\n        - api: user32.GetKeyboardLayoutName\n      - optional:\n        - api: kernel32.GetLocaleInfo\n",
                        "name": "get keyboard layout",
                        "description": "host-interaction/hardware/keyboard"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set application hook\n    namespace: host-interaction/gui\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - Practical Malware Analysis Lab 12-03.exe_:0x401000\n  features:\n    - and:\n      - or:\n        - api: user32.SetWindowsHookEx\n        - api: user32.UnhookWindowsHookEx\n",
                        "name": "set application hook",
                        "description": "host-interaction/gui"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get graphical window text\n    namespace: host-interaction/gui/window/get-text\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Discovery::Application Window Discovery::Window Text [E1010.m01]\n    examples:\n      - B7841B9D5DC1F511A93CC7576672EC0C:0x10007A50\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001000\n  features:\n    - or:\n      - and:\n        - optional:\n          - api: user32.IsWindowVisible\n        - basic block:\n          - and:\n            - number: 0xD = WM_GETTEXT\n            - api: user32.SendMessage\n      - and:\n        - optional:\n          - api: user32.GetForegroundWindow\n        - api: user32.GetWindowText\n",
                        "name": "get graphical window text",
                        "description": "host-interaction/gui/window/get-text"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: log keystrokes\n    namespace: collection/keylog\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Collection::Input Capture::Keylogging [T1056.001]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x4015FD\n  features:\n    - or:\n      - and:\n        - api: SetWindowsHookEx\n        - api: GetKeyState\n      - and:\n        - api: RegisterHotKey\n        - api: user32.keybd_event\n        - api: UnregisterHotKey\n      - and:\n        - api: CallNextHookEx\n        - api: user32.GetKeyNameText\n        - api: user32.GetAsyncKeyState\n        - api: user32.GetForgroundWindow\n      - api: user32.AttachThreadInput\n      - api: user32.MapVirtualKey\n",
                        "name": "log keystrokes",
                        "description": "collection/keylog"
                    },
                    {
                        "description": "host-interaction/hardware/cpu",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x64 = PEB->NumberOfProcessors\n        - and:\n          - arch: amd64\n          - number: 0xB8 = PEB->NumberOfProcessors\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "get number of processors"
                    },
                    {
                        "description": "load-code/pe",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://0x00sec.org/t/reflective-dll-injection/3080"
                            },
                            {
                                "ref": "https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    scope: function\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      - offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - basic block:\n        - and:\n          - offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n          - offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n          - offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n",
                        "authors": [
                            "@Ana06"
                        ],
                        "name": "enumerate PE sections"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n",
                        "name": "get common file path",
                        "description": "host-interaction/file-system"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain pusha popa sequence\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - a5c70086b3bc4fe64f4e7a0aa452e620:0x35007200\n  features:\n    - and:\n      - or:\n        - count(mnemonic(pusha)): 2 or more\n        # vivisect\n        - count(mnemonic(pushad)): 2 or more\n      - or:\n        - count(mnemonic(popa)): 2 or more\n        # vivisect\n        - count(mnemonic(popad)): 2 or more\n",
                        "name": "contain pusha popa sequence",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n",
                        "name": "contain a resource (.rsrc) section",
                        "description": "executable/pe/section/rsrc"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: compiled with Borland Delphi\n    namespace: compiler/delphi\n    authors:\n      - william.ballenthin@mandiant.com\n      - \"@mr-tz\"\n    scope: file\n    examples:\n      - 4BDD67FF852C221112337FECD0681EAC\n  features:\n    - or:\n      - string: \"Borland C++ - Copyright 2002 Borland Corporation\"\n      - string: \"Sysutils::Exception\"\n      - string: \"TForm1\"\n      - import: \"BORLNDMM.DLL\"\n      - substring: \"SOFTWARE\\\\Borland\\\\Delphi\\\\RTL\"\n      - substring: \"Embarcadero Delphi for Win32 compiler\"\n",
                        "name": "compiled with Borland Delphi",
                        "description": "compiler/delphi"
                    }
                ],
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hide graphical window"
                            }
                        ],
                        "signature_description": "hide graphical window",
                        "id": "T1564.003",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "accept command line arguments"
                            }
                        ],
                        "signature_description": "accept command line arguments",
                        "id": "T1059",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry value"
                            }
                        ],
                        "signature_description": "query or enumerate registry value",
                        "id": "T1012",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ],
                        "signature_description": "link function at runtime on Windows",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get geographical location"
                            }
                        ],
                        "signature_description": "get geographical location",
                        "id": "T1614",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "find graphical window"
                            }
                        ],
                        "signature_description": "find graphical window",
                        "id": "T1010",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk size"
                            }
                        ],
                        "signature_description": "get disk size",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get file version info"
                            }
                        ],
                        "signature_description": "get file version info",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get system information on Windows"
                            }
                        ],
                        "signature_description": "get system information on Windows",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "read clipboard data"
                            }
                        ],
                        "signature_description": "read clipboard data",
                        "id": "T1115",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "capture screenshot"
                            }
                        ],
                        "signature_description": "capture screenshot",
                        "id": "T1113",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link many functions at runtime"
                            }
                        ],
                        "signature_description": "link many functions at runtime",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate gui resources"
                            }
                        ],
                        "signature_description": "enumerate gui resources",
                        "id": "T1010",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "log keystrokes via polling"
                            }
                        ],
                        "signature_description": "log keystrokes via polling",
                        "id": "T1056.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get keyboard layout"
                            }
                        ],
                        "signature_description": "get keyboard layout",
                        "id": "T1614.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "log keystrokes"
                            }
                        ],
                        "signature_description": "log keystrokes",
                        "id": "T1056.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get number of processors"
                            }
                        ],
                        "signature_description": "get number of processors",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ],
                        "signature_description": "get common file path",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "last_modification_date": 1677710536,
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480",
                "has_memdump": false,
                "analysis_date": 1677710536
            }
        },
        {
            "id": "37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39_VMRay",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39_VMRay"
            },
            "attributes": {
                "has_pcap": false,
                "has_html_report": false,
                "command_executions": [
                    "arp -a",
                    "cmd /c set",
                    "ipconfig /all",
                    "C:\\Windows\\SysWOW64\\explorer.exe",
                    "\"C:\\Users\\RDhJ0CNFevzX\\Desktop\\TmwenS.exe\" /dll=\"C:\\Users\\RDHJ0C~1\\Desktop\\37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39.dll\"",
                    "whoami /all",
                    "net view /all"
                ],
                "mutexes_opened": [
                    "Global\\{DE3A2553-AB1B-4C85-9686-F3F136EBACE2}",
                    "{DE3A2553-AB1B-4C85-9686-F3F136EBACE2}",
                    "{61969771-19E3-435D-AE55-CFB18F1249EF}"
                ],
                "processes_created": [
                    "c:\\windows\\syswow64\\whoami.exe",
                    "c:\\windows\\syswow64\\arp.exe",
                    "c:\\windows\\syswow64\\cmd.exe",
                    "c:\\users\\rdhj0cnfevzx\\desktop\\tmwens.exe",
                    "c:\\windows\\syswow64\\explorer.exe",
                    "c:\\windows\\syswow64\\net.exe",
                    "c:\\windows\\syswow64\\ipconfig.exe"
                ],
                "sandbox_name": "VMRay",
                "has_evtx": false,
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "92.59.35.196",
                        "destination_port": 2222
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "86.123.105.31",
                        "destination_port": 443
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "50.194.160.233",
                        "destination_port": 443
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "91.178.126.51",
                        "destination_port": 995
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "187.121.105.111",
                        "destination_port": 995
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "216.238.71.31",
                        "destination_port": 995
                    }
                ],
                "modules_loaded": [
                    "\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.10586.0_none_d3c2e4e965da4528\\comctl32.dll",
                    "\\Windows\\SysWOW64\\SHCore.dll",
                    "\\Windows\\SysWOW64\\cryptbase.dll",
                    "\\Windows\\System32\\ntdll.dll",
                    "\\Windows\\SysWOW64\\oleaut32.dll",
                    "\\Windows\\SysWOW64\\apphelp.dll",
                    "\\Windows\\SysWOW64\\shell32.dll",
                    "\\Windows\\SysWOW64\\wkscli.dll",
                    "\\Windows\\SysWOW64\\KernelBase.dll",
                    "\\Windows\\SysWOW64\\uxtheme.dll",
                    "\\Windows\\SysWOW64\\ws2_32.dll",
                    "\\Windows\\SysWOW64\\srvcli.dll",
                    "\\Windows\\SysWOW64\\bcryptprimitives.dll",
                    "\\Windows\\SysWOW64\\cfgmgr32.dll",
                    "\\Windows\\SysWOW64\\msvcrt.dll",
                    "\\Windows\\SysWOW64\\user32.dll",
                    "\\Windows\\SysWOW64\\version.dll",
                    "\\Windows\\SysWOW64\\kernel32.dll",
                    "\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_5.82.10586.0_none_811bc0006c44242b\\comctl32.dll",
                    "\\Windows\\System32\\wow64cpu.dll",
                    "\\Windows\\SysWOW64\\advapi32.dll",
                    "\\Windows\\System32\\wow64win.dll",
                    "\\Windows\\SysWOW64\\windows.storage.dll",
                    "\\Windows\\SysWOW64\\profapi.dll",
                    "\\Users\\RDHJ0C~1\\Desktop\\37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39.dll",
                    "\\Windows\\SysWOW64\\sspicli.dll",
                    "\\Windows\\SysWOW64\\shlwapi.dll",
                    "\\Windows\\SysWOW64\\gdi32.dll",
                    "\\Windows\\SysWOW64\\logoncli.dll",
                    "\\Windows\\System32\\wow64.dll",
                    "\\Windows\\SysWOW64\\ntdll.dll",
                    "\\Windows\\SysWOW64\\dwmapi.dll",
                    "\\Windows\\SysWOW64\\powrprof.dll",
                    "\\Windows\\SysWOW64\\kernel.appcore.dll",
                    "\\Windows\\SysWOW64\\bcrypt.dll",
                    "\\Windows\\SysWOW64\\samcli.dll",
                    "\\Windows\\SysWOW64\\imm32.dll",
                    "\\Windows\\SysWOW64\\sechost.dll",
                    "\\Windows\\SysWOW64\\netutils.dll",
                    "\\Windows\\SysWOW64\\rpcrt4.dll",
                    "\\Windows\\SysWOW64\\netapi32.dll",
                    "\\Windows\\SysWOW64\\combase.dll",
                    "\\Windows\\SysWOW64\\userenv.dll",
                    "\\Windows\\SysWOW64\\ole32.dll",
                    "\\Windows\\SysWOW64\\msctf.dll",
                    "\\Windows\\SysWOW64\\dxgi.dll",
                    "\\Windows\\SysWOW64\\ncrypt.dll",
                    "\\Windows\\SysWOW64\\dcomp.dll",
                    "\\Windows\\SysWOW64\\twinapi.appcore.dll",
                    "\\Windows\\SysWOW64\\wintrust.dll",
                    "\\Windows\\SysWOW64\\winnlsres.dll",
                    "\\Windows\\SysWOW64\\wbemcomn.dll",
                    "\\Windows\\SysWOW64\\wbem\\fastprox.dll",
                    "\\Windows\\SysWOW64\\d3d11.dll",
                    "\\Windows\\SysWOW64\\dnsapi.dll",
                    "\\Windows\\SysWOW64\\ncryptsslp.dll",
                    "\\Windows\\SysWOW64\\clbcatq.dll",
                    "\\Windows\\SysWOW64\\tokenbinding.dll",
                    "\\Windows\\SysWOW64\\cryptnet.dll",
                    "\\Windows\\SysWOW64\\rsaenh.dll",
                    "\\Windows\\SysWOW64\\cryptsp.dll",
                    "\\Windows\\SysWOW64\\webio.dll",
                    "\\Windows\\SysWOW64\\wtsapi32.dll",
                    "\\Windows\\SysWOW64\\ntmarta.dll",
                    "\\Windows\\SysWOW64\\twinapi.dll",
                    "\\Windows\\SysWOW64\\propsys.dll",
                    "\\Windows\\SysWOW64\\winhttp.dll",
                    "\\Windows\\SysWOW64\\msasn1.dll",
                    "\\Windows\\SysWOW64\\wininet.dll",
                    "\\Windows\\SysWOW64\\cabinet.dll",
                    "\\Windows\\SysWOW64\\crypt32.dll",
                    "\\Windows\\SysWOW64\\nsi.dll",
                    "\\Windows\\SysWOW64\\samlib.dll",
                    "\\Windows\\SysWOW64\\dpapi.dll",
                    "\\Windows\\SysWOW64\\mswsock.dll",
                    "\\Windows\\SysWOW64\\MrmCoreR.dll",
                    "\\Windows\\SysWOW64\\OnDemandConnRouteHelper.dll",
                    "\\Windows\\SysWOW64\\urlmon.dll",
                    "\\Windows\\SysWOW64\\schannel.dll",
                    "\\Windows\\SysWOW64\\wbem\\wbemsvc.dll",
                    "\\Windows\\SysWOW64\\dhcpcsvc6.dll",
                    "\\Windows\\SysWOW64\\winnsi.dll",
                    "\\Windows\\SysWOW64\\mskeyprotect.dll",
                    "\\Windows\\SysWOW64\\rasadhlp.dll",
                    "\\Windows\\SysWOW64\\iertutil.dll",
                    "\\Windows\\SysWOW64\\winsta.dll",
                    "\\Windows\\SysWOW64\\wbem\\wbemprox.dll",
                    "\\Windows\\SysWOW64\\ntasn1.dll",
                    "\\Windows\\SysWOW64\\gpapi.dll",
                    "\\Windows\\SysWOW64\\dhcpcsvc.dll",
                    "\\Windows\\SysWOW64\\authz.dll",
                    "\\Windows\\SysWOW64\\snmpapi.dll",
                    "\\Windows\\SysWOW64\\inetmib1.dll",
                    "\\Windows\\SysWOW64\\browcli.dll",
                    "\\Windows\\SysWOW64\\mpr.dll",
                    "\\Windows\\SysWOW64\\cscapi.dll",
                    "\\Windows\\SysWOW64\\netmsg.dll"
                ],
                "http_conversations": [
                    {
                        "url": "https://50.194.160.233/t4",
                        "request_method": "POST",
                        "response_headers": {
                            "Content-Length": "168",
                            "Server": "nginx/1.9.12"
                        },
                        "response_status_code": 200,
                        "request_headers": {
                            "Content-Type": "application/x-www-form-urlencoded"
                        }
                    },
                    {
                        "url": "https://187.121.105.111/t4",
                        "request_method": "POST",
                        "request_headers": {
                            "Content-Type": "application/x-www-form-urlencoded"
                        }
                    },
                    {
                        "url": "https://216.238.71.31/t4",
                        "request_method": "POST",
                        "request_headers": {
                            "Content-Type": "application/x-www-form-urlencoded"
                        }
                    },
                    {
                        "url": "https://91.178.126.51/t4",
                        "request_method": "POST",
                        "request_headers": {
                            "Content-Type": "application/x-www-form-urlencoded"
                        }
                    },
                    {
                        "url": "https://86.123.105.31/t4",
                        "request_method": "POST",
                        "request_headers": {
                            "Content-Type": "application/x-www-form-urlencoded"
                        }
                    },
                    {
                        "url": "https://92.59.35.196/t4",
                        "request_method": "POST",
                        "request_headers": {
                            "Content-Type": "application/x-www-form-urlencoded"
                        }
                    }
                ],
                "registry_keys_set": [
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\130eebf0"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\6c478406"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\d4fbe363"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\abb28c95"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\114fcb8c"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\9e2d5cdb"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\a9f3ace9"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\e164332d"
                    }
                ],
                "last_modification_date": 1637767867,
                "behash": "a58147da2ebc3a6c6b58a07f0d6c019f",
                "processes_terminated": [
                    "c:\\windows\\syswow64\\whoami.exe",
                    "c:\\windows\\syswow64\\net.exe",
                    "c:\\windows\\syswow64\\arp.exe",
                    "c:\\windows\\syswow64\\ipconfig.exe",
                    "c:\\windows\\syswow64\\cmd.exe"
                ],
                "has_memdump": false,
                "files_opened": [
                    "C:\\Users\\RDhJ0CNFevzX\\Desktop\\37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39.dll"
                ],
                "analysis_date": 1637690460,
                "processes_tree": [
                    {
                        "process_id": "proc_1",
                        "name": "tmwens.exe",
                        "children": [
                            {
                                "process_id": "proc_2",
                                "name": "explorer.exe",
                                "children": [
                                    {
                                        "process_id": "proc_7",
                                        "name": "whoami.exe"
                                    },
                                    {
                                        "process_id": "proc_9",
                                        "name": "cmd.exe"
                                    },
                                    {
                                        "process_id": "proc_11",
                                        "name": "arp.exe"
                                    },
                                    {
                                        "process_id": "proc_13",
                                        "name": "ipconfig.exe"
                                    },
                                    {
                                        "process_id": "proc_15",
                                        "name": "net.exe"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "registry_keys_opened": [
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\DefaultColor",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\59d85448",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\DisableUNCCheck",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\f3d19cc3",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1560258661-3990802383-1811730007-501",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1560258661-3990802383-1811730007-500",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1560258661-3990802383-1811730007-503",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1560258661-3990802383-1811730007-1000\\ProfileImagePath",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{E25A642B-6CEB-4194-8F83-8BC82AF94F5A}\\Dhcpv6ClassId",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\DelayedExpansion",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\130eebf0",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\e3251351",
                    "HKEY_LOCAL_MACHINE\\Software\\Borland\\Locales",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{E25A642B-6CEB-4194-8F83-8BC82AF94F5A}",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{C2998852-8A8B-426B-AAB1-8880E47F8B1A}",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters\\Interfaces\\{C2998852-8A8B-426B-AAB1-8880E47F8B1A}\\Dhcpv6ClassId",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\EnableExtensions",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\9e2d5cdb",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\PathCompletionChar",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\e164332d",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{C2998852-8A8B-426B-AAB1-8880E47F8B1A}",
                    "HKEY_CURRENT_USER\\Software\\Borland\\Delphi\\Locales",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\2caa5c0b",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{E25A642B-6CEB-4194-8F83-8BC82AF94F5A}",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\3665b42c",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\d4fbe363",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\114fcb8c",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\AutoRun",
                    "HKEY_CURRENT_USER\\Software\\Borland\\Locales",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\EnableExtensions",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\{E25A642B-6CEB-4194-8F83-8BC82AF94F5A}\\DhcpClassId",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\PathCompletionChar",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\DelayedExpansion",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\abb28c95",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\CompletionChar",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\6c478406",
                    "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\System",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\CompletionChar",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\a9f3ace9",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Command Processor\\DisableUNCCheck",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Fdircmnenyyey\\3e1ff3e5",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\S-1-5-21-1560258661-3990802383-1811730007-1000",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\DefaultColor",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Command Processor\\AutoRun"
                ]
            }
        }
    ],
    "meta": {
        "count": 3
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/37348342c66980e606e25ae057a0b14ac2351ebd0a8123a7bdb5224b89288a39/behaviours?limit=10"
    }
}