{
    "data": [
        {
            "id": "105af5c40c65f51979308e022c25dd285db3cd20e9656caaba0e9b1fc253898b_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/105af5c40c65f51979308e022c25dd285db3cd20e9656caaba0e9b1fc253898b_CAPA"
            },
            "attributes": {
                "has_pcap": false,
                "has_evtx": false,
                "sandbox_name": "CAPA",
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using Curve25519"
                            }
                        ],
                        "signature_description": "encrypt data using Curve25519",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using HC-128"
                            }
                        ],
                        "signature_description": "encrypt data using HC-128",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete volume shadow copies"
                            }
                        ],
                        "signature_description": "delete volume shadow copies",
                        "id": "T1490",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete volume shadow copies"
                            }
                        ],
                        "signature_description": "delete volume shadow copies",
                        "id": "T1070.004",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "self delete"
                            }
                        ],
                        "signature_description": "self delete",
                        "id": "T1070.004",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_html_report": false,
                "behash": "c46628c627d6b8d74d5647254da84b67",
                "analysis_date": 1705790082,
                "last_modification_date": 1705790082,
                "has_memdump": false,
                "mbc": [
                    {
                        "objective": "Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "calculate modulo 256 via x86 assembly"
                            }
                        ],
                        "id": "C0058",
                        "behavior": "Modulo"
                    },
                    {
                        "objective": "Defense Evasion",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using HC-128"
                            }
                        ],
                        "id": "E1027.m05",
                        "behavior": "Obfuscated Files or Information",
                        "method": "Encryption-Standard Algorithm"
                    },
                    {
                        "objective": "Cryptography",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using HC-128"
                            }
                        ],
                        "id": "C0027.006",
                        "behavior": "Encrypt Data",
                        "method": "HC-128"
                    },
                    {
                        "objective": "Impact",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete volume shadow copies"
                            }
                        ],
                        "id": "E1485.m04",
                        "behavior": "Data Destruction",
                        "method": "Delete Shadow Copies"
                    },
                    {
                        "objective": "Defense Evasion",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "self delete"
                            }
                        ],
                        "id": "F0007.001",
                        "behavior": "Self Deletion",
                        "method": "COMSPEC Environment Variable"
                    }
                ],
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n",
                        "name": "calculate modulo 256 via x86 assembly",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "dimiter.andonov@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encrypt data using Curve25519\n    namespace: data-manipulation/encryption/elliptic-curve\n    authors:\n      - dimiter.andonov@mandiant.com\n    description: Targets code that enforces Curve25519's secret key restrictions. The specification states \"The legitimate users are assumed to generate independent uniform random secret keys. A user can, for example, generate 32 uniform random bytes, clear bits 0, 1, 2 of the first byte, clear bit 7 of the last byte, and set bit 6 of the last byte.\"\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    examples:\n      - 0a0882b8da225406cc838991b5f67d11:0x4135f6\n      - 0a0882b8da225406cc838991b5f67d11:0x416f51\n      - 80372de850597bd9e7e021a94f13f0a1:0x406480\n      - 80372de850597bd9e7e021a94f13f0a1:0x4086f4\n      - b4a07cdd640bbaef21cd0493b4d62675:0x4098af\n  features:\n    # Common corresponding C source code:\n    #    e[0] &= 0xf8;\n    #   e[31] &= 0x7f;\n    #   e[31] |= 0x40;\n    - and:\n      - instruction:\n        - description: clear bits 0, 1, and 2 of the first byte\n        - mnemonic: and\n        - number: 0xf8\n      - or:\n        - instruction:\n          - description: clear bit 7 of the last byte\n          - mnemonic: and\n          - number: 0x7f\n        - instruction:\n          - description: clear bits 6 and 7 of the last byte; clearing bit 6 in addition to bit 7 is fine because bit 6 is ultimately set\n          - mnemonic: and\n          - number: 0x3f\n      - instruction:\n        - description: set bit 6 of the last byte\n        - mnemonic: or\n        - number: 0x40\n",
                        "name": "encrypt data using Curve25519",
                        "description": "data-manipulation/encryption/elliptic-curve : Targets code that enforces Curve25519's secret key restrictions. The specification states \"The legitimate users are assumed to generate independent uniform random secret keys. A user can, for example, generate 32 uniform random bytes, clear bits 0, 1, 2 of the first byte, clear bit 7 of the last byte, and set bit 6 of the last byte.\""
                    },
                    {
                        "description": "data-manipulation/encryption/hc-128 : Looks for instruction mnemonics associated with initialization of the HC-128 stream cipher",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://download.bitdefender.com/resources/files/News/CaseStudies/study/318/Bitdefender-TRR-Whitepaper-Maze-creat4351-en-EN-GenericUse.pdf"
                            },
                            {
                                "ref": "https://github.com/rost1993/hc128/blob/master/hc128.c"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encrypt data using HC-128\n    namespace: data-manipulation/encryption/hc-128\n    authors:\n      - awillia2@cisco.com\n    description: Looks for instruction mnemonics associated with initialization of the HC-128 stream cipher\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\n      - Cryptography::Encrypt Data::HC-128 [C0027.006]\n    references:\n      - https://download.bitdefender.com/resources/files/News/CaseStudies/study/318/Bitdefender-TRR-Whitepaper-Maze-creat4351-en-EN-GenericUse.pdf\n      - https://github.com/rost1993/hc128/blob/master/hc128.c\n    examples:\n      - e69a8eb94f65480980deaf1ff5a431a6:0x405D0D\n  features:\n    - and:\n      - instruction:\n        - mnemonic: shl\n        - number: 0x0F = (v << (32 - 17)) from ROTR32(x, 17) in F2(x)\n      - instruction:\n        - mnemonic: shr\n        - number: 0x11 = (v >> 17) from ROTR32(x, 17) in F2(x)\n      - instruction:\n        - mnemonic: shl\n        - number: 0xD = (v << (32 - 19)) from ROTR32(x, 19) in F2(x)\n      - instruction:\n        - mnemonic: shr\n        - number: 0x13 = (v >> 19) from ROTR32(x, 19) in F2(x)\n      - instruction:\n        - mnemonic: shr\n        - number: 0xA = (v >> 10) in F2(x)\n      - instruction:\n        - mnemonic: shl\n        - number: 0x19 = (v << (32 - 7)) from ROTR32(x, 7) in F1(x)\n      - instruction:\n        - mnemonic: shr\n        - number: 0x7 = (v >> 7) from ROTR32(x, 7) in F1(x)\n      - instruction:\n        - mnemonic: shl\n        - number: 0xE = (v << (32 - 18)) from ROTR32(x, 18) in F1(x)\n      - instruction:\n        - mnemonic: shr\n        - number: 0x12 = (v >> 18) from ROTR32(x, 18) in F1(X)\n      - instruction:\n        - mnemonic: shr\n        - number: 0x3 = (x >> 3) in F1(x)\n      - count(mnemonic(shl)): 4\n      - count(mnemonic(shr)): 6\n      - count(mnemonic(or)): 4\n      - count(characteristic(nzxor)): 4\n",
                        "authors": [
                            "awillia2@cisco.com"
                        ],
                        "name": "encrypt data using HC-128"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete volume shadow copies\n    namespace: impact/inhibit-system-recovery\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Impact::Inhibit System Recovery [T1490]\n      - Defense Evasion::Indicator Removal::File Deletion [T1070.004]\n    mbc:\n      - Impact::Data Destruction::Delete Shadow Copies [E1485.m04]\n    examples:\n      - B87E9DD18A5533A09D3E48A7A1EFBCF6:0x140006AF0\n  features:\n    - or:\n      - string: /vssadmin.* delete shadows/i\n      - string: /vssadmin.* resize shadowstorage/i\n      - string: /wmic.* shadowcopy delete/i\n",
                        "name": "delete volume shadow copies",
                        "description": "impact/inhibit-system-recovery"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: self delete\n    namespace: anti-analysis/anti-forensic/self-deletion\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@mr-tz\"\n    scope: function\n    att&ck:\n      - Defense Evasion::Indicator Removal::File Deletion [T1070.004]\n    mbc:\n      - Defense Evasion::Self Deletion::COMSPEC Environment Variable [F0007.001]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n  features:\n    - and:\n      - or:\n        - match: get COMSPEC environment variable\n        - string: \"cmd.exe\"\n        - match: host-interaction/process/create\n      - or:\n        - string: /\\/c\\s*del\\s*/\n          description: \"/c del\"\n        - string: /del\\s*\\S/\n          description: \"del \\\"%s\\\"\"\n      - optional:\n        - string: /\\s*>\\s*nul\\s*/i\n          description: \"> nul\"\n",
                        "name": "self delete",
                        "description": "anti-analysis/anti-forensic/self-deletion"
                    }
                ]
            }
        },
        {
            "id": "105af5c40c65f51979308e022c25dd285db3cd20e9656caaba0e9b1fc253898b_VenusEye Sandbox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/105af5c40c65f51979308e022c25dd285db3cd20e9656caaba0e9b1fc253898b_VenusEye Sandbox"
            },
            "attributes": {
                "has_pcap": false,
                "has_evtx": false,
                "sandbox_name": "VenusEye Sandbox",
                "has_html_report": true,
                "behash": "6ce8aab8c0de24aa6e0d324576990550",
                "analysis_date": 1640969455,
                "processes_tree": [
                    {
                        "process_id": "572",
                        "name": "svchost.exe"
                    },
                    {
                        "process_id": "464",
                        "name": "services.exe"
                    }
                ],
                "last_modification_date": 1640969456,
                "has_memdump": false,
                "command_executions": [
                    "taskhost.exe $(Arg0)",
                    "taskhost.exe SYSTEM"
                ]
            }
        }
    ],
    "meta": {
        "count": 2
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/105af5c40c65f51979308e022c25dd285db3cd20e9656caaba0e9b1fc253898b/behaviours?limit=10"
    }
}