{
    "data": [
        {
            "id": "e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_CAPA"
            },
            "attributes": {
                "sandbox_name": "CAPA",
                "analysis_date": 1721872014,
                "has_evtx": false,
                "mbc": [
                    {
                        "id": "C0001.011",
                        "objective": "Communication",
                        "behavior": "Socket Communication",
                        "method": "Create TCP Socket",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create TCP socket"
                            }
                        ]
                    },
                    {
                        "id": "C0055",
                        "objective": "Process",
                        "behavior": "Suspend Thread",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "suspend thread"
                            }
                        ]
                    },
                    {
                        "id": "C0036.004",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Create Registry Key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open registry key"
                            }
                        ]
                    },
                    {
                        "id": "C0036.003",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Open Registry Key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open registry key"
                            }
                        ]
                    },
                    {
                        "id": "C0017",
                        "objective": "Process",
                        "behavior": "Create Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create process on Windows"
                            }
                        ]
                    },
                    {
                        "id": "C0050",
                        "objective": "File System",
                        "behavior": "Set File Attributes",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set file attributes"
                            }
                        ]
                    },
                    {
                        "id": "C0049",
                        "objective": "File System",
                        "behavior": "Get File Attributes",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get file attributes"
                            }
                        ]
                    },
                    {
                        "id": "C0035",
                        "objective": "Operating System",
                        "behavior": "Wallpaper",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "change the wallpaper"
                            }
                        ]
                    },
                    {
                        "id": "C0038",
                        "objective": "Process",
                        "behavior": "Create Thread",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create thread"
                            }
                        ]
                    },
                    {
                        "id": "C0018",
                        "objective": "Process",
                        "behavior": "Terminate Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "terminate process"
                            }
                        ]
                    },
                    {
                        "id": "C0001.008",
                        "objective": "Communication",
                        "behavior": "Socket Communication",
                        "method": "TCP Client",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "act as TCP client"
                            }
                        ]
                    },
                    {
                        "id": "C0053.001",
                        "objective": "Data",
                        "behavior": "Decode Data",
                        "method": "Base64",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "decode data using Base64 in .NET"
                            }
                        ]
                    },
                    {
                        "id": "C0036.007",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Delete Registry Value",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete registry value"
                            }
                        ]
                    },
                    {
                        "id": "C0036.005",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Query Registry Key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry key"
                            }
                        ]
                    },
                    {
                        "id": "E1027.m02",
                        "objective": "Defense Evasion",
                        "behavior": "Obfuscated Files or Information",
                        "method": "Encoding-Standard Algorithm",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using Base64"
                            }
                        ]
                    },
                    {
                        "id": "C0026.001",
                        "objective": "Data",
                        "behavior": "Encode Data",
                        "method": "Base64",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using Base64"
                            }
                        ]
                    },
                    {
                        "id": "C0036.006",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Query Registry Value",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry value"
                            }
                        ]
                    },
                    {
                        "id": "C0024",
                        "objective": "Data",
                        "behavior": "Compress Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "compress data using GZip in .NET"
                            }
                        ]
                    },
                    {
                        "id": "B0043",
                        "objective": "Discovery",
                        "behavior": "Taskbar Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "find taskbar"
                            }
                        ]
                    },
                    {
                        "id": "C0036.001",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Set Registry Key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set registry value"
                            }
                        ]
                    },
                    {
                        "id": "C0001.007",
                        "objective": "Communication",
                        "behavior": "Socket Communication",
                        "method": "Send Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "send data on socket"
                            }
                        ]
                    },
                    {
                        "id": "B0030.001",
                        "objective": "Command and Control",
                        "behavior": "C2 Communication",
                        "method": "Send Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "send data"
                            }
                        ]
                    },
                    {
                        "id": "E1113.m01",
                        "objective": "Collection",
                        "behavior": "Screen Capture",
                        "method": "WinAPI",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "capture screenshot"
                            }
                        ]
                    },
                    {
                        "id": "E1083",
                        "objective": "Discovery",
                        "behavior": "File and Directory Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate files in .NET"
                            }
                        ]
                    },
                    {
                        "id": "E1082",
                        "objective": "Discovery",
                        "behavior": "System Information Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk size"
                            }
                        ]
                    },
                    {
                        "id": "E1082",
                        "objective": "Discovery",
                        "behavior": "System Information Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk information"
                            }
                        ]
                    },
                    {
                        "id": "E1083",
                        "objective": "Discovery",
                        "behavior": "File and Directory Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get file size"
                            }
                        ]
                    },
                    {
                        "id": "E1082",
                        "objective": "Discovery",
                        "behavior": "System Information Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get hostname"
                            }
                        ]
                    },
                    {
                        "id": "C0052",
                        "objective": "File System",
                        "behavior": "Writes File",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "write file on Windows"
                            }
                        ]
                    },
                    {
                        "id": "C0051",
                        "objective": "File System",
                        "behavior": "Read File",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "read file on Windows"
                            }
                        ]
                    },
                    {
                        "id": "F0012",
                        "objective": "Persistence",
                        "behavior": "Registry Run Keys / Startup Folder",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "persist via Run registry key"
                            }
                        ]
                    },
                    {
                        "id": "C0045",
                        "objective": "File System",
                        "behavior": "Copy File",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "copy file"
                            }
                        ]
                    },
                    {
                        "id": "E1083",
                        "objective": "Discovery",
                        "behavior": "File and Directory Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ]
                    },
                    {
                        "id": "E1082",
                        "objective": "Discovery",
                        "behavior": "System Information Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query environment variable"
                            }
                        ]
                    },
                    {
                        "id": "F0007.001",
                        "objective": "Defense Evasion",
                        "behavior": "Self Deletion",
                        "method": "COMSPEC Environment Variable",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "self delete"
                            }
                        ]
                    },
                    {
                        "id": "E1510",
                        "objective": "Impact",
                        "behavior": "Clipboard Modification",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "write clipboard data"
                            }
                        ]
                    },
                    {
                        "id": "C0002.017",
                        "objective": "Communication",
                        "behavior": "HTTP Communication",
                        "method": "Get Response",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "read data from Internet"
                            }
                        ]
                    },
                    {
                        "id": "C0047",
                        "objective": "File System",
                        "behavior": "Delete File",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete file"
                            }
                        ]
                    },
                    {
                        "id": "C0048",
                        "objective": "File System",
                        "behavior": "Delete Directory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete directory"
                            }
                        ]
                    },
                    {
                        "id": "E1010",
                        "objective": "Discovery",
                        "behavior": "Application Window Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get graphical window text"
                            }
                        ]
                    },
                    {
                        "id": "B0042.001",
                        "objective": "Impact",
                        "behavior": "Modify Hardware",
                        "method": "CDROM",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "manipulate CD-ROM drive"
                            }
                        ]
                    },
                    {
                        "id": "E1083",
                        "objective": "Discovery",
                        "behavior": "File and Directory Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "check if file exists"
                            }
                        ]
                    },
                    {
                        "id": "B0030.002",
                        "objective": "Command and Control",
                        "behavior": "C2 Communication",
                        "method": "Receive Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "receive data"
                            }
                        ]
                    },
                    {
                        "id": "B0023",
                        "objective": "Execution",
                        "behavior": "Install Additional Program",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "write and execute a file"
                            }
                        ]
                    },
                    {
                        "id": "B0030.003",
                        "objective": "Command and Control",
                        "behavior": "C2 Communication",
                        "method": "Server to Client File Transfer",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "download and write a file"
                            }
                        ]
                    },
                    {
                        "id": "B0042.002",
                        "objective": "Impact",
                        "behavior": "Modify Hardware",
                        "method": "Mouse",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "swap mouse buttons"
                            }
                        ]
                    },
                    {
                        "id": "C0002.006",
                        "objective": "Communication",
                        "behavior": "HTTP Communication",
                        "method": "Download URL",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "download URL"
                            }
                        ]
                    },
                    {
                        "id": "C0034.001",
                        "objective": "Operating System",
                        "behavior": "Environment Variable",
                        "method": "Set Variable",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set environment variable"
                            }
                        ]
                    },
                    {
                        "id": "C0042",
                        "objective": "Process",
                        "behavior": "Create Mutex",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create mutex"
                            }
                        ]
                    },
                    {
                        "id": "C0029.001",
                        "objective": "Cryptography",
                        "behavior": "Cryptographic Hash",
                        "method": "MD5",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hash data with MD5"
                            }
                        ]
                    },
                    {
                        "id": "C0001.006",
                        "objective": "Communication",
                        "behavior": "Socket Communication",
                        "method": "Receive Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "receive data on socket"
                            }
                        ]
                    },
                    {
                        "id": "C0036.002",
                        "objective": "Operating System",
                        "behavior": "Registry",
                        "method": "Delete Registry Key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete registry key"
                            }
                        ]
                    },
                    {
                        "id": "F0002.002",
                        "objective": "Collection",
                        "behavior": "Keylogging",
                        "method": "Polling",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "log keystrokes via polling"
                            }
                        ]
                    },
                    {
                        "id": "B0009",
                        "objective": "Anti-Behavioral Analysis",
                        "behavior": "Virtual Machine Detection",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "reference anti-VM strings"
                            }
                        ]
                    },
                    {
                        "id": "F0001",
                        "objective": "Anti-Static Analysis",
                        "behavior": "Software Packing",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "packed with ASPack"
                            }
                        ]
                    },
                    {
                        "id": "B0013.001",
                        "objective": "Discovery",
                        "behavior": "Analysis Tool Discovery",
                        "method": "Process detection",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "reference analysis tools strings"
                            }
                        ]
                    }
                ],
                "has_memdump": false,
                "last_modification_date": 1721872016,
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create TCP socket",
                        "description": "communication/socket/tcp",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: socket\n          - api: ws2_32.socket\n          - api: ws2_32.#23 = socket\n          - api: ws2_32.WSASocket\n          - api: ws2_32.#82 = WSASocketA\n          - api: ws2_32.#83 = WSASocketW\n          - api: System.Net.Sockets.Socket::ctor\n      - property/read: System.Net.Sockets.TcpClient::Client\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "suspend thread",
                        "description": "host-interaction/thread/suspend",
                        "authors": [
                            "0x534a@mailbox.org",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: suspend thread\n    namespace: host-interaction/thread/suspend\n    authors:\n      - 0x534a@mailbox.org\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Suspend Thread [C0055]\n    examples:\n      - 787cbc8a6d1bc58ea169e51e1ad029a637f22560660cc129ab8a099a745bd50e:0x502f4c\n  features:\n    - or:\n      - api: kernel32.SuspendThread\n      - api: ntdll.NtSuspendThread\n      - api: ntdll.ZwSuspendThread\n      - api: System.Threading.Thread::Suspend\n      - api: System.Threading.Thread::Sleep\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create or open registry key",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "hide graphical window",
                        "description": "host-interaction/gui/window/hide",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hide graphical window\n    namespace: host-interaction/gui/window/hide\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Defense Evasion::Hide Artifacts::Hidden Window [T1564.003]\n    examples:\n      - 39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10007250\n  features:\n    - and:\n      - number: 0x0 = SW_HIDE\n      - api: user32.ShowWindow\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create process on Windows",
                        "description": "host-interaction/process/create",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "power down monitor",
                        "description": "host-interaction/hardware/monitor",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: power down monitor\n    namespace: host-interaction/hardware/monitor\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n  features:\n    - and:\n      - api: user32.SendMessage\n      - number: 0x112 = WM_SYSCOMMAND\n      - number: 0xF170 = SC_MONITORPOWER\n      - number: 2 = the display is being shut off\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "set file attributes",
                        "description": "host-interaction/file-system/meta",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Defense Evasion::File and Directory Permissions Modification [T1222]\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015f0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n  features:\n    - or:\n      - api: kernel32.SetFileAttributes\n      - api: ZwSetInformationFile\n      - api: NtSetInformationFile\n      - api: System.IO.File::SetAttributes\n      - api: System.IO.File::SetCreationTime\n      - api: System.IO.File::SetCreationTimeUtc\n      - api: System.IO.File::SetLastAccessTime\n      - api: System.IO.File::SetLastAccessTimeUtc\n      - api: System.IO.File::SetLastWriteTime\n      - api: System.IO.File::SetLastWriteTimeUtc\n      - property/write: System.IO.FileSystemInfo::Attributes\n      - api: utime\n      - api: utimes\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get OS version in .NET",
                        "description": "host-interaction/os/version",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get OS version in .NET\n    namespace: host-interaction/os/version\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires property features\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n  features:\n    - or:\n      - property/read: System.Environment::OSVersion\n      - property/read: System.Environment::Is64BitOperatingSystem\n      - property/read: System.OperatingSystem::Version\n      - property/read: Microsoft.VisualBasic.Devices.ComputerInfo::OSFullName\n      - property/read: System.Runtime.InteropServices.RuntimeInformation::OSDescription\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get file attributes",
                        "description": "host-interaction/file-system/meta",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n      - api: stat\n      - api: fstat\n      - api: lstat\n      - api: fstatat\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get process image filename",
                        "description": "host-interaction/process",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get process image filename\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.K32GetProcessImageFileName\n          - api: kernel32.GetProcessImageFileName\n      - and:\n        - api: System.Diagnostics.Process::GetCurrentProcess\n        - property/read: System.Diagnostics.Process::MainModule\n        - property/read: System.Diagnostics.ProcessModule::FileName\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "change the wallpaper",
                        "description": "host-interaction/gui/session",
                        "authors": [
                            "@_re_fox"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: change the wallpaper\n    namespace: host-interaction/gui/session\n    authors:\n      - \"@_re_fox\"\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Wallpaper [C0035]\n    examples:\n      - 5dd0b130d5c3d40c69e3972f39fd7d62:0x45AC6F\n  features:\n    - and:\n      - api: SystemParametersInfo\n      - number: 0x14 = SPI_SETDESKWALLPAPER\n      - number: 0x3 = SPIF_SENDWININICHANGE | SPIF_UPDATEINIFILE\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create thread",
                        "description": "host-interaction/thread/create",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "terminate process",
                        "description": "host-interaction/process/terminate",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "terminate process by name in .NET",
                        "description": "host-interaction/process/terminate",
                        "authors": [
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: terminate process by name in .NET\n    namespace: host-interaction/process/terminate\n    authors:\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n  features:\n    - and:\n      - api: System.Diagnostics.Process::GetProcessesByName\n      - api: System.Diagnostics.Process::Kill\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "find process by name",
                        "description": "host-interaction/process/list",
                        "authors": [
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: find process by name\n    namespace: host-interaction/process/list\n    authors:\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n  features:\n    - and:\n      - api: System.Diagnostics.Process::GetProcessesByName\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "act as TCP client",
                        "description": "communication/tcp/client",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: act as TCP client\n    namespace: communication/tcp/client\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::Socket Communication::TCP Client [C0001.008]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - match: connect TCP socket\n      - api: System.Net.Sockets.TcpClient::ctor\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "decode data using Base64 in .NET",
                        "description": "data-manipulation/encoding/base64",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: decode data using Base64 in .NET\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Defense Evasion::Deobfuscate/Decode Files or Information [T1140]\n    mbc:\n      - Data::Decode Data::Base64 [C0053.001]\n  features:\n    - or:\n      - api: System.Convert::FromBase64String\n      - api: System.Convert::FromBase64CharArray\n      - api: System.Convert::TryFromBase64Chars\n      - api: System.Convert::TryFromBase64String\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "delete registry value",
                        "description": "host-interaction/registry/delete",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete registry value\n    namespace: host-interaction/registry/delete\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Defense Evasion::Modify Registry [T1112]\n    mbc:\n      - Operating System::Registry::Delete Registry Value [C0036.007]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4041A0\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegDeleteValue\n        - api: advapi32.RegDeleteKeyValue\n        - api: ZwDeleteValueKey\n        - api: NtDeleteValueKey\n        - api: RtlDeleteRegistryValue\n        - api: SHDeleteValue\n        - api: SHRegDeleteUSValue\n        - api: Microsoft.Win32.RegistryKey::DeleteValue\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "query or enumerate registry key",
                        "description": "host-interaction/registry",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: query or enumerate registry key\n    namespace: host-interaction/registry\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Key [C0036.005]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x404930\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegEnumKey\n        - api: advapi32.RegEnumKeyEx\n        - api: advapi32.RegQueryInfoKeyA\n        - api: ZwQueryKey\n        - api: ZwEnumerateKey\n        - api: NtQueryKey\n        - api: NtEnumerateKey\n        - api: RtlCheckRegistryKey\n        - api: SHEnumKeyEx\n        - api: SHQueryInfoKey\n        - api: SHRegEnumUSKey\n        - api: SHRegQueryInfoUSKey\n        - api: Microsoft.Win32.RegistryKey::GetSubKeyNames\n        - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenSubKey\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "encode data using Base64",
                        "description": "data-manipulation/encoding/base64",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using Base64\n    namespace: data-manipulation/encoding/base64\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::Base64 [C0026.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314889C\n      - 074072B261FC27B65C72671F13510C05:0x100049B2\n      - 5DB2D2BE20D59AA0BE6709A6850F1775:0x18001CC30\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - and:\n        - mnemonic: shl\n        - mnemonic: shr\n        - number: 0x3F = modulo 64\n        - or:\n          - number: 0x3D = '='\n          - number: 0x3D3D = '=='\n        - match: contain loop\n        - optional:\n          - number: 2\n          - number: 3\n          - number: 4\n          - number: 6\n          - number: 0xF\n          - string: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n      - api: System.Convert::ToBase64String\n      - api: System.Convert::ToBase64CharArray\n      - api: System.Convert::TryToBase64Chars\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "query or enumerate registry value",
                        "description": "host-interaction/registry",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "compress data using GZip in .NET",
                        "description": "data-manipulation/compression",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: compress data using GZip in .NET\n    namespace: data-manipulation/compression\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Collection::Archive Collected Data::Archive via Library [T1560.002]\n    mbc:\n      - Data::Compress Data [C0024]\n  features:\n    - or:\n      - api: System.IO.Compression.GZipStream::ctor\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "find graphical window",
                        "description": "host-interaction/gui/window/find",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "unmanaged call",
                        "description": "runtime : managed code calls unmanaged (native) code, often seen in .NET",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: unmanaged call\n    namespace: runtime\n    authors:\n      - michael.hunhoff@mandiant.com\n    description: managed code calls unmanaged (native) code, often seen in .NET\n    scopes:\n      static: function\n      dynamic: unsupported\n  features:\n    - or:\n      - characteristic: unmanaged call\n      - match: unmanaged call via dynamic PInvoke in .NET\n      - api: System.Runtime.InteropServices.Marshal::GetDelegateForFunctionPointer\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "find taskbar",
                        "description": "host-interaction/gui/taskbar/find",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: find taskbar\n    namespace: host-interaction/gui/taskbar/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Discovery::Taskbar Discovery [B0043]\n    examples:\n      - B7841B9D5DC1F511A93CC7576672EC0C:0x10007250\n  features:\n    - and:\n      - string: \"Shell_TrayWnd\"\n      - match: find graphical window\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "hide the Windows taskbar",
                        "description": "host-interaction/gui/taskbar/hide",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hide the Windows taskbar\n    namespace: host-interaction/gui/taskbar/hide\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Defense Evasion::Hide Artifacts [T1564]\n    examples:\n      - 39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10007250\n  features:\n    - and:\n      - match: find taskbar\n      - match: hide graphical window\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "set registry value",
                        "description": "host-interaction/registry/create",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "send data on socket",
                        "description": "communication/socket/send",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: send data on socket\n    namespace: communication/socket/send\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Send Data [C0001.007]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: send\n      - api: ws2_32.send\n      - api: ws2_32.#19 = send\n      - api: ws2_32.sendto\n      - api: ws2_32.#20 = sendto\n      - api: ws2_32.WSASend\n      - api: ws2_32.#76 = WSASend\n      - api: ws2_32.WSASendMsg\n      - api: ws2_32.WSASendTo\n      - api: ws2_32.#78 = WSASendTo\n      - api: System.Net.Sockets.Socket::Send\n      - api: System.Net.Sockets.Socket::SendAsync\n      - api: System.Net.Sockets.Socket::SendTo\n      - api: System.Net.Sockets.Socket::SendToAsync\n      - api: System.Net.Sockets.UdpClient::Send\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "send data",
                        "description": "communication : all known techniques for sending data to a potential C2 server",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: send data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n    description: all known techniques for sending data to a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Send Data [B0030.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n          - match: send data to Internet\n      - and:\n        - os: linux\n        - or: # Require network bound socket.\n          - match: create TCP socket\n          - match: create UDP socket\n        - or:\n          - match: send HTTP request\n          - match: send data on socket\n          - match: send file via HTTP\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "capture screenshot",
                        "description": "collection/screenshot",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "@_re_fox",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: capture screenshot\n    namespace: collection/screenshot\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Collection::Screen Capture [T1113]\n    mbc:\n      - Collection::Screen Capture::WinAPI [E1113.m01]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314610A\n      - 7204e3efc2434012e13ca939db0d0b02:0x414070\n      - 50D5EE1CE2CA5E30C6B1019EE64EEEC2:0x406E07\n  features:\n    - or:\n      - and:\n        - or:\n          - api: user32.GetWindowDC\n          - api: user32.GetDC\n          - and:\n            - api: gdi32.CreateDC\n            - string: \"DISPLAY\"\n        - or:\n          - api: gdi32.BitBlt\n          - api: gdi32.GetDIBits\n        - api: gdi32.CreateCompatibleDC\n        - api: gdi32.CreateCompatibleBitmap\n        - optional:\n          - or:\n            - api: user32.GetSystemMetrics = fetch screen dimensions\n            - api: user32.GetDesktopWindow = get entire desktop\n      - basic block:\n        - and:\n          - api: BitBlt\n          - characteristic: tight loop\n      - call:\n        - and:\n          - api: BitBlt\n      - api: System.Drawing.Graphics::CopyFromScreen\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "enumerate files in .NET",
                        "description": "host-interaction/file-system/files/list",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate files in .NET\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    references:\n      - https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b\n  features:\n    - or:\n      - api: System.IO.DirectoryInfo::GetFiles\n      - api: System.IO.DirectoryInfo::EnumerateFiles\n      - api: System.IO.Directory::GetFiles\n      - api: System.IO.Directory::EnumerateFiles\n      - api: System.IO.Directory::EnumerateFileSystemEntries\n      - api: System.IO.DirectoryInfo::GetDirectories\n      - api: System.IO.DirectoryInfo::EnumerateDirectories\n      - api: System.IO.Directory::GetDirectories\n      - api: System.IO.Directory::EnumerateDirectories\n",
                        "refs": [
                            {
                                "ref": "https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get disk size",
                        "description": "host-interaction/hardware/storage",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get disk size\n    namespace: host-interaction/hardware/storage\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347\n    examples:\n      - al-khaser_x86.exe_:0x4343D0\n      - al-khaser_x86.exe_:0x434010\n  features:\n    - or:\n      - api: kernel32.GetDiskFreeSpace\n      - api: kernel32.GetDiskFreeSpaceEx\n      - property/read: System.IO.DriveInfo::TotalSize\n      - property/read: System.IO.DriveInfo::TotalFreeSpace\n      - property/read: System.IO.DriveInfo::AvailableFreeSpace\n      - basic block:\n        - and:\n          - match: interact with driver via IOCTL\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - call:\n        - and:\n          - match: interact with driver via IOCTL\n          - number: 0x7405C = IOCTL_DISK_GET_LENGTH_INFO\n      - and:\n        - or:\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_LogicalDisk/i\n          - string: /SELECT\\s+\\*\\s+FROM\\s+Win32_DiskDrive\\s+WHERE\\s+\\(SerialNumber\\s+IS\\s+NOT\\s+NULL\\)\\s+AND\\s+\\(MediaType\\s+LIKE\\s+\\'Fixed\\s+hard\\s+disk\\%\\'\\)/i\n        - string: \"Size\"\n",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L347"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get disk information",
                        "description": "host-interaction/hardware/storage",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get disk information\n    namespace: host-interaction/hardware/storage\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 972B219F18379907A045431303F4DA7D:0x41064E\n  features:\n    - or:\n      - api: kernel32.GetDriveType\n      - api: kernel32.GetLogicalDrives\n      - api: kernel32.GetVolumeInformation\n      - api: kernel32.GetVolumeNameForVolumeMountPoint\n      - api: kernel32.GetVolumePathNamesForVolumeName\n      - api: kernel32.GetLogicalDriveStrings\n      - api: kernel32.QueryDosDevice\n      - property/read: System.IO.DriveInfo::VolumeLabel\n      - property/read: System.IO.DriveInfo::DriveType\n      - property/read: System.IO.DriveInfo::DriveFormat\n      - property/read: System.IO.DriveInfo::Name\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "enumerate drives",
                        "description": "host-interaction/file-system",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate drives\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.IO.DriveInfo::GetDrives\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get file size",
                        "description": "host-interaction/file-system/meta",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get session user name",
                        "description": "host-interaction/session",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get session user name\n    namespace: host-interaction/session\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n      - Discovery::Account Discovery [T1087]\n    examples:\n      - Practical Malware Analysis Lab 14-01.exe_:0x401285\n  features:\n    - or:\n      - api: advapi32.GetUserName\n      - api: secur32.GetUserNameEx\n      - basic block:\n        - and:\n          # - match: get session information (see #463)\n          - api: wtsapi32.WTSQuerySessionInformation\n          - number: 5 = WTSUserName\n      - call:\n        - and:\n          - api: wtsapi32.WTSQuerySessionInformation\n          - number: 5 = WTSUserName\n      - api: System.Security.Principal.WindowsIdentity::GetCurrent\n      - property/read: System.Environment::UserName\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get hostname",
                        "description": "host-interaction/os/hostname",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "write file on Windows",
                        "description": "host-interaction/file-system/write",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "read file on Windows",
                        "description": "host-interaction/file-system/read",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "enumerate processes",
                        "description": "host-interaction/process/list",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate processes\n    namespace: host-interaction/process/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n      - Discovery::Software Discovery [T1518]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403DAB\n      - 35d04ecd797041eee796f4ddaa96cae8:0x10004F34\n  features:\n    - or:\n      - api: System.Diagnostics.Process::GetProcesses\n      - and:\n        - api: kernel32.Process32First\n        - api: kernel32.Process32Next\n        - optional:\n          - basic block:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n          - call:\n            - and:\n              - or:\n                - number: 0xF = TH32CS_SNAPALL\n                - number: 0x2 = TH32CS_SNAPPROCESS\n              - api: kernel32.CreateToolhelp32Snapshot\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "persist via Run registry key",
                        "description": "persistence/registry/run",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: persist via Run registry key\n    namespace: persistence/registry/run\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n    mbc:\n      - Persistence::Registry Run Keys / Startup Folder [F0012]\n    examples:\n      - Practical Malware Analysis Lab 06-03.exe_:0x401130\n      - b87e9dd18a5533a09d3e48a7a1efbcf6:0x1400070E0\n      - 9ff8e68343cc29c1036650fc153e69f7:0x470624\n  features:\n    - and:\n      - or:\n        - match: set registry value\n        - number: 0x80000001 = HKEY_CURRENT_USER\n        - number: 0x80000002 = HKEY_LOCAL_MACHINE\n      - or:\n        - and:\n          - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion/i\n          - or:\n            - string: /Run/i\n            - string: /Explorer\\\\Shell Folders/i\n            - string: /User Shell Folders/i\n            - string: /RunServices/i\n            - string: /Policies\\\\Explorer\\\\Run/i\n        - string: /Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\load/i\n        - string: /System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\BootExecute/i\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get MAC address in .NET",
                        "description": "collection/network",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "echernofsky@google.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get MAC address in .NET\n    namespace: collection/network\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - echernofsky@google.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n  features:\n    - or:\n      - api: System.Net.NetworkInformation.NetworkInterface::GetPhysicalAddress\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "persist via Windows service",
                        "description": "persistence/service",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: persist via Windows service\n    namespace: persistence/service\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - 9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A\n  features:\n    - or:\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n          - call:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n        - optional:\n          - or:\n            - api: advapi32.OpenService\n            - api: advapi32.StartService\n      - and:\n        - match: host-interaction/process/create\n        - or:\n          - and:\n            - string: /^sc(|\\.exe)$/i\n            - string: /create /i\n          - string: /^sc(|\\.exe) create/i\n          - string: /New-Service /i\n      - and:\n        - match: \"set registry value\"\n        - string: /System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "copy file",
                        "description": "host-interaction/file-system/copy",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: LZCopy\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get common file path",
                        "description": "host-interaction/file-system",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "generate random filename in .NET",
                        "description": "host-interaction/file-system",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: generate random filename in .NET\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.IO.Path::GetRandomFileName\n      - api: System.IO.Path::GetTempFileName\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "query environment variable",
                        "description": "host-interaction/environment-variable",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@_re_fox"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "self delete",
                        "description": "anti-analysis/anti-forensic/self-deletion",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: self delete\n    namespace: anti-analysis/anti-forensic/self-deletion\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@mr-tz\"\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Defense Evasion::Indicator Removal::File Deletion [T1070.004]\n    mbc:\n      - Defense Evasion::Self Deletion::COMSPEC Environment Variable [F0007.001]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n  features:\n    - and:\n      - or:\n        - match: get COMSPEC environment variable\n        - string: \"cmd.exe\"\n        - match: host-interaction/process/create\n      - or:\n        - string: /\\/c\\s*del\\s*/\n          description: \"/c del\"\n        - string: /del\\s*\\S/\n          description: \"del \\\"%s\\\"\"\n      - optional:\n        - string: /\\s*>\\s*nul\\s*/i\n          description: \"> nul\"\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "write clipboard data",
                        "description": "host-interaction/clipboard",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write clipboard data\n    namespace: host-interaction/clipboard\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Impact::Clipboard Modification [E1510]\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard\n    examples:\n      - 6F99A2C8944CB02FF28C6F9CED59B161:0x403180\n  features:\n    - and:\n      - optional:\n        - match: open clipboard\n        - api: user32.EmptyClipboard\n        - api: System.Windows.Forms.Clipboard::Clear\n      - or:\n        - api: user32.SetClipboardData\n        - api: System.Windows.Forms.Clipboard::SetAudio\n        - api: System.Windows.Forms.Clipboard::SetData\n        - api: System.Windows.Forms.Clipboard::SetDataObject\n        - api: System.Windows.Forms.Clipboard::SetFileDropList\n        - api: System.Windows.Forms.Clipboard::SetImage\n        - api: System.Windows.Forms.Clipboard::SetText\n",
                        "refs": [
                            {
                                "ref": "https://learn.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get CPU information",
                        "description": "host-interaction/hardware/cpu",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get CPU information\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: query or enumerate registry value\n        - string: /Hardware\\\\Description\\\\System\\\\CentralProcessor/i\n      - and:\n        - os: linux\n        - match: host-interaction/file-system/read\n        - string: \"/proc/cpuinfo\"\n      - and:\n        - os: linux\n        - api: system\n        - substring: \"/proc/cpuinfo\"\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "read data from Internet",
                        "description": "communication/http/client",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read data from Internet\n    namespace: communication/http/client\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Communication::HTTP Communication::Get Response [C0002.017]\n    examples:\n      - 6f99a2c8944cb02ff28c6f9ced59b161:0x40D590\n  features:\n    - and:\n      - optional:\n        - or:\n          - match: connect to HTTP server\n          - match: connect to URL\n      - or:\n        - api: wininet.InternetReadFile\n        - api: wininet.InternetReadFileEx\n        - api: System.Net.WebClient::DownloadString\n        - api: System.Net.WebClient::DownloadStringAsync\n        - api: System.Net.WebClient::DownloadStringTaskAsync\n        - api: System.Net.WebClient::DownloadData\n        - api: System.Net.WebClient::DownloadDataAsync\n        - api: System.Net.WebClient::DownloadDataTaskAsync\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "delete file",
                        "description": "host-interaction/file-system/delete",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "save image in .NET",
                        "description": "collection",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: save image in .NET\n    namespace: collection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires class features\n  features:\n    - and:\n      - api: System.Drawing.Image::Save\n      - optional:\n        - class: System.Drawing.Imaging.ImageFormat\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "find process by PID",
                        "description": "host-interaction/process/list",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: find process by PID\n    namespace: host-interaction/process/list\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x404B00\n  features:\n    - and:\n      - or:\n        - api: ntoskrnl.PsLookupProcessByProcessId\n        - api: System.Diagnostics.Process::GetProcessById\n      - optional:\n        - api: ntoskrnl.ObfDereferenceObject\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "clear clipboard data",
                        "description": "host-interaction/clipboard",
                        "authors": [
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: clear clipboard data\n    namespace: host-interaction/clipboard\n    authors:\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Collection::Clipboard Data [T1115]\n  features:\n    - and:\n      - api: System.Windows.Forms.Clipboard::Clear\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "delete directory",
                        "description": "host-interaction/file-system/delete",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete directory\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Delete Directory [C0048]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10009236\n      - AFB6EC3D721A5CB67863487B0E51A34C167F629CF701F8BC7A038C117B4DDA44:0x429AA0\n  features:\n    - or:\n      - api: RemoveDirectory\n      - api: RemoveDirectoryTransacted\n      - api: rmdir\n      - api: _rmdir\n      - api: _wrmdir\n      - api: System.IO.DirectoryInfo::Delete\n      - api: System.IO.Directory::Delete\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "get graphical window text",
                        "description": "host-interaction/gui/window/get-text",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get graphical window text\n    namespace: host-interaction/gui/window/get-text\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Discovery::Application Window Discovery [E1010]\n    examples:\n      - B7841B9D5DC1F511A93CC7576672EC0C:0x10007A50\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001000\n  features:\n    - or:\n      - and:\n        - optional:\n          - api: user32.IsWindowVisible\n        - or:\n          - basic block:\n            - and:\n              - number: 0xD = WM_GETTEXT\n              - api: user32.SendMessage\n          - call:\n            - and:\n              - number: 0xD = WM_GETTEXT\n              - api: user32.SendMessage\n      - and:\n        - optional:\n          - api: user32.GetForegroundWindow\n        - api: user32.GetWindowText\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "manipulate CD-ROM drive",
                        "description": "host-interaction/hardware/cdrom",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: manipulate CD-ROM drive\n    namespace: host-interaction/hardware/cdrom\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Impact::Modify Hardware::CDROM [B0042.001]\n    examples:\n      - 39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10007250\n  features:\n    - and:\n      - api: winmm.mciSendString\n      - or:\n        - string: \"set cdaudio door closed wait\"\n        - string: \"set cdaudio door open\"\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "check if file exists",
                        "description": "host-interaction/file-system/exists",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "receive data",
                        "description": "communication : all known techniques for receiving data from a potential C2 server",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: receive data\n    namespace: communication\n    authors:\n      - william.ballenthin@mandiant.com\n    description: all known techniques for receiving data from a potential C2 server\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\n  features:\n    - or:\n      - match: receive data on socket\n      - match: read data from Internet\n      - match: download URL\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "receive and write data from server to client",
                        "description": "communication/c2/file-transfer",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: receive and write data from server to client\n    namespace: communication/c2/file-transfer\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n  features:\n    - and:\n      - match: receive data\n      - match: host-interaction/file-system/write\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "write and execute a file",
                        "description": "communication/c2/file-transfer",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write and execute a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: launcher\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403A40\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n  features:\n    - and:\n      - match: host-interaction/file-system/write\n      - match: host-interaction/process/create\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "download and write a file",
                        "description": "communication/c2/file-transfer",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: download and write a file\n    namespace: communication/c2/file-transfer\n    maec/malware-category: downloader\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Command and Control::Ingress Tool Transfer [T1105]\n    mbc:\n      - Command and Control::C2 Communication::Server to Client File Transfer [B0030.003]\n    examples:\n      - 5D7C34B6854D48D3DA4F96B71550A221:0x401346\n  features:\n    - and:\n      - match: receive data\n      - match: host-interaction/file-system/write\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "swap mouse buttons",
                        "description": "host-interaction/hardware/mouse",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: swap mouse buttons\n    namespace: host-interaction/hardware/mouse\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Impact::Modify Hardware::Mouse [B0042.002]\n    examples:\n      - B7841B9D5DC1F511A93CC7576672EC0C:0x10007250\n  features:\n    - or:\n      - api: user32.SwapMouseButton\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "schedule task via schtasks",
                        "description": "persistence/scheduled-tasks",
                        "authors": [
                            "0x534a@mailbox.org"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: schedule task via schtasks\n    namespace: persistence/scheduled-tasks\n    authors:\n      - 0x534a@mailbox.org\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Scheduled Task/Job::Scheduled Task [T1053.005]\n    examples:\n      - 79cde1aa711e321b4939805d27e160be:0x401440\n  features:\n    - and:\n      - match: host-interaction/process/create\n      - or:\n        - and:\n          - string: /schtasks/i\n          - string: /\\/create /i\n        - string: /Register-ScheduledTask /i\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "download URL",
                        "description": "communication/http/client",
                        "authors": [
                            "matthew.williams@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: download URL\n    namespace: communication/http/client\n    authors:\n      - matthew.williams@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::HTTP Communication::Download URL [C0002.006]\n    examples:\n      - F5C93AC768C8206E87544DDD76B3277C:0x100020F0\n      - Practical Malware Analysis Lab 20-01.exe_:0x401040\n  features:\n    - or:\n      - api: urlmon.URLDownloadToFile\n      - api: urlmon.URLDownloadToCacheFile\n      - api: urlmon.URLOpenBlockingStream\n      - api: urlmon.URLOpenPullStream\n      - api: urlmon.URLOpenStream\n      - api: System.Net.WebClient::DownloadFile\n      - api: System.Net.WebClient::DownloadFileAsync\n      - api: System.Net.WebClient::DownloadFileTaskAsync\n      - api: Microsoft.VisualBasic.Devices.Network::DownloadFile\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "set environment variable",
                        "description": "host-interaction/environment-variable",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Operating System::Environment Variable::Set Variable [C0034.001]\n    examples:\n      - 0731679c5f99e8ee65d8b29a3cabfc6b:0x43EA81\n  features:\n    - or:\n      - api: kernel32.SetEnvironmentStrings\n      - api: kernel32.SetEnvironmentVariable\n      - api: System.Environment::SetEnvironmentVariable\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create mutex",
                        "description": "host-interaction/mutex",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: System.Threading.Mutex::ctor\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "read clipboard data",
                        "description": "host-interaction/clipboard",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read clipboard data\n    namespace: host-interaction/clipboard\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Collection::Clipboard Data [T1115]\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x40156F\n      - 93dfc146f60bd796eb28d4e4f348f2e4:0x401050\n  features:\n    - and:\n      - optional:\n        - match: open clipboard\n        - match: contain loop\n        - api: kernel32.GlobalAlloc\n        - api: kernel32.GlobalLock\n        - api: kernel32.GlobalUnlock\n      - or:\n        - basic block:\n          - and:\n            - api: user32.GetClipboardData\n            - optional:\n              - number: 0x1 = CF_TEXT\n              - number: 0x7 = CF_OEMTEXT\n              - number: 0xD = CF_UNICODETEXT\n        - call:\n          - and:\n            - api: user32.GetClipboardData\n            - optional:\n              - number: 0x1 = CF_TEXT\n              - number: 0x7 = CF_OEMTEXT\n              - number: 0xD = CF_UNICODETEXT\n        - api: System.Windows.Forms.Clipboard::GetAudioStream\n        - api: System.Windows.Forms.Clipboard::GetData\n        - api: System.Windows.Forms.Clipboard::GetDataObject\n        - api: System.Windows.Forms.Clipboard::GetFileDropList\n        - api: System.Windows.Forms.Clipboard::GetImage\n        - api: System.Windows.Forms.Clipboard::GetText\n",
                        "refs": [
                            {
                                "ref": "https://learn.microsoft.com/en-us/windows/win32/dataxchg/using-the-clipboard"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "hash data with MD5",
                        "description": "data-manipulation/hashing/md5",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data with MD5\n    namespace: data-manipulation/hashing/md5\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Cryptography::Cryptographic Hash::MD5 [C0029.001]\n    references:\n      - https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x100108ED\n  features:\n    - or:\n      - and:\n        - description: magic initialization constants from MD4 and MD5\n        - number: 0x67452301 = A, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0xefcdab89 = B, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x98badcfe = C, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x10325476 = D, also used in SHA1, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - not:\n          - number: 0xc3d2e1f0 = likely SHA1 but also used in RIPEMD-160 and RIPEMD-320\n        - optional:\n          - description: specific compilation from https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp\n          - and:\n            - offset: -0x28955B88\n            - offset: -0x173848AA\n      - basic block:\n        - and:\n          - number: 0x8003 = CALG_MD5\n          - api: advapi32.CryptCreateHash\n      - call:\n        - and:\n          - number: 0x8003 = CALG_MD5\n          - api: advapi32.CryptCreateHash\n      - and:\n        - format: dotnet\n        - or:\n          - api: System.Security.Cryptography.MD5::Create\n          - api: System.Security.Cryptography.MD5CryptoServiceProvider::ctor\n        - optional:\n          - api: System.Security.Cryptography.HashAlgorithm::ComputeHash\n",
                        "refs": [
                            {
                                "ref": "https://github.com/rwfpl/rewolf-x86-virtualizer/blob/master/src/test_app/main.cpp"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "load .NET assembly",
                        "description": "load-code/dotnet",
                        "authors": [
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: load .NET assembly\n    namespace: load-code/dotnet\n    authors:\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Defense Evasion::Reflective Code Loading [T1620]\n  features:\n    - or:\n      - api: System.Reflection.Assembly::Load\n      - api: System.AppDomain::Load\n      - api: System.Reflection.Assembly::LoadFile\n      - api: System.Reflection.Assembly::LoadFrom\n      - api: System.Reflection.Assembly::LoadWithPartialName\n      - api: System.Reflection.Assembly::ReflectionOnlyLoad\n      - api: System.Reflection.Assembly::ReflectionOnlyLoadFrom\n      - api: System.Reflection.Assembly::UnsafeLoadFrom\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "receive data on socket",
                        "description": "communication/socket/receive",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: receive data on socket\n    namespace: communication/socket/receive\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Receive Data [C0001.006]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: recv\n      - api: ws2_32.recv\n      - api: ws2_32.#16 = recv\n      - api: ws2_32.recvfrom\n      - api: ws2_32.#17 = recvfrom\n      - api: ws2_32.WSARecv\n      - api: ws2_32.#71 = WSARecv\n      - api: ws2_32.WSARecvDisconnect\n      - api: ws2_32.#72 = WSARecvDisconnect\n      - api: ws2_32.WSARecvEx\n      - api: ws2_32.WSARecvFrom\n      - api: ws2_32.#73 = WSARecvFrom\n      - api: ws2_32.WSARecvMsg\n      - api: recvmsg\n      - api: System.Net.Sockets.Socket::Receive\n      - api: System.Net.Sockets.Socket::ReceiveAsync\n      - api: System.Net.Sockets.Socket::ReceiveFrom\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\n      - api: System.Net.Sockets.Socket::BeginReceive\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\n      - api: System.Net.Sockets.Socket::EndReceive\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "delete registry key",
                        "description": "host-interaction/registry/delete",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "johnk3r"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete registry key\n    namespace: host-interaction/registry/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Defense Evasion::Modify Registry [T1112]\n    mbc:\n      - Operating System::Registry::Delete Registry Key [C0036.002]\n    examples:\n      - 4f11bdb380dafa2518053c6d20147a05:0x402A36\n      - 493167E85E45363D09495D0841C30648:0x404D60\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegDeleteKey\n        - api: advapi32.RegDeleteTree\n        - api: advapi32.RegDeleteKeyEx\n        - api: advapi32.RegDeleteKeyTransacted\n        - api: ZwDeleteKey\n        - api: NtDeleteKey\n        - api: SHDeleteKey\n        - api: SHDeleteEmptyKey\n        - api: SHRegDeleteEmptyUSKey\n        - api: Microsoft.Win32.RegistryKey::DeleteSubKey\n        - api: Microsoft.Win32.RegistryKey::DeleteSubKeyTree\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "log keystrokes via polling",
                        "description": "collection/keylog",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: log keystrokes via polling\n    namespace: collection/keylog\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Collection::Input Capture::Keylogging [T1056.001]\n    mbc:\n      - Collection::Keylogging::Polling [F0002.002]\n    examples:\n      - Practical Malware Analysis Lab 11-03.dll_:0x10001030\n  features:\n    - or:\n      - api: user32.GetAsyncKeyState\n      - api: user32.GetKeyState\n      - api: user32.GetKeyboardState\n      - api: user32.VkKeyScan\n      - api: user32.VkKeyScanEx\n      - api: user32.GetKeyNameText\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "compiled to the .NET platform",
                        "description": "runtime/dotnet",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: compiled to the .NET platform\n    namespace: runtime/dotnet\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - b9f5bd514485fb06da39beff051b9fdc\n  features:\n    - or:\n      - format: dotnet\n      - import: mscoree._CorExeMain\n      - import: mscoree._corexemain\n      - import: mscoree._CorDllMain\n      - import: mscoree._cordllmain\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "reference anti-VM strings",
                        "description": "anti-analysis/anti-vm/vm-detection",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx.dll/i\n        description: AVG\n      - string: /avghooka.dll/i\n        description: AVG\n      - string: /snxhk.dll/i\n        description: Avast\n      - string: /pstorec.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck.dll/i\n        description: Virtual PC\n      - string: /wpespy.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample.exe/i\n      - string: /bot.exe/i\n      - string: /sandbox.exe/i\n      - string: /malware.exe/i\n      - string: /test.exe/i\n      - string: /klavme.exe/i\n      - string: /myapp.exe/i\n      - string: /testapp.exe/i\n",
                        "refs": [
                            {
                                "ref": "https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "packed with ASPack",
                        "description": "anti-analysis/packer/aspack",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: packed with ASPack\n    namespace: anti-analysis/packer/aspack\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002]\n    mbc:\n      - Anti-Static Analysis::Software Packing [F0001]\n    references:\n      - http://www.aspack.com/\n      - https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/\n    examples:\n      - 2055994ff75b4309eee3a49c5749d306\n  features:\n    - or:\n      - section: .aspack\n      - section: .adata\n      - section: .ASPack\n      - section: ASPack\n      - string: \"The procedure entry point %s could not be located in the dynamic link library %s\"\n      - string: \"The ordinal %u could not be located in the dynamic link library %s\"\n",
                        "refs": [
                            {
                                "ref": "http://www.aspack.com/"
                            },
                            {
                                "ref": "https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "reference analysis tools strings",
                        "description": "anti-analysis",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg(\\.exe)?/i\n      - string: /ProcessHacker(\\.exe)?/i\n      - string: /tcpview(\\.exe)?/i\n      - string: /autoruns(\\.exe)?/i\n      - string: /autorunsc(\\.exe)?/i\n      - string: /filemon(\\.exe)?/i\n      - string: /procmon(\\.exe)?/i\n      - string: /regmon(\\.exe)?/i\n      - string: /procexp(\\.exe)?/i\n      - string: /(?<!\\w)ida[gqtuw]?(\\.exe)?$/i\n      - string: /ida[gqtuw]?64(\\.exe)?$/i\n      - string: /ImmunityDebugger(\\.exe)?/i\n      - string: /Wireshark(\\.exe)?/i\n      - string: /dumpcap(\\.exe)?/i\n      - string: /HookExplorer(\\.exe)?/i\n      - string: /ImportREC(\\.exe)?/i\n      - string: /PETools(\\.exe)?/i\n      - string: /LordPE(\\.exe)?/i\n      - string: /SysInspector(\\.exe)?/i\n      - string: /proc_analyzer(\\.exe)?/i\n      - string: /sysAnalyzer(\\.exe)?/i\n      - string: /sniff_hit(\\.exe)?/i\n      - string: /windbg(\\.exe)?/i\n      - string: /joeboxcontrol(\\.exe)?/i\n      - string: /joeboxserver(\\.exe)?/i\n      - string: /ResourceHacker(\\.exe)?/i\n      - string: /x32dbg(\\.exe)?/i\n      - string: /x64dbg(\\.exe)?/i\n      - string: /Fiddler(\\.exe)?/i\n      - string: /httpdebugger(\\.exe)?/i\n      - string: /fakenet(\\.exe)?/i\n      - string: /netmon(\\.exe)?/i\n      - string: /WPE PRO(\\.exe)?/i\n      - string: /decompile(\\.exe)?/i\n      - string: /scylla/i\n      - string: /megadumper/i\n",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "(internal) packer file limitation",
                        "description": "internal/limitation/file : This sample appears to be packed.\n\nPacked samples have often been obfuscated to hide their logic.\ncapa cannot handle obfuscation well using static analysis. This means the results may be misleading or incomplete.\nIf possible, you should try to unpack this input file before analyzing it with capa.\nAlternatively, run the sample in a supported sandbox and invoke capa against the report to obtain dynamic analysis results.\n",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: (internal) packer file limitation\n    namespace: internal/limitation/file\n    authors:\n      - william.ballenthin@mandiant.com\n    description: |\n      This sample appears to be packed.\n\n      Packed samples have often been obfuscated to hide their logic.\n      capa cannot handle obfuscation well using static analysis. This means the results may be misleading or incomplete.\n      If possible, you should try to unpack this input file before analyzing it with capa.\n      Alternatively, run the sample in a supported sandbox and invoke capa against the report to obtain dynamic analysis results.\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - CD2CBA9E6313E8DF2C1273593E649682\n  features:\n    - or:\n      - match: anti-analysis/packer\n"
                    }
                ],
                "has_pcap": false,
                "behash": "6042bd58646ede5a3c47d666173544a7",
                "mitre_attack_techniques": [
                    {
                        "id": "T1564.003",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "hide graphical window",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hide graphical window"
                            }
                        ]
                    },
                    {
                        "id": "T1222",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "set file attributes",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set file attributes"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get OS version in .NET",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get OS version in .NET"
                            }
                        ]
                    },
                    {
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "find process by name",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "find process by name"
                            }
                        ]
                    },
                    {
                        "id": "T1140",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "decode data using Base64 in .NET",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "decode data using Base64 in .NET"
                            }
                        ]
                    },
                    {
                        "id": "T1112",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "delete registry value",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete registry value"
                            }
                        ]
                    },
                    {
                        "id": "T1012",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "query or enumerate registry key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry key"
                            }
                        ]
                    },
                    {
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "encode data using Base64",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using Base64"
                            }
                        ]
                    },
                    {
                        "id": "T1012",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "query or enumerate registry value",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry value"
                            }
                        ]
                    },
                    {
                        "id": "T1560.002",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "compress data using GZip in .NET",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "compress data using GZip in .NET"
                            }
                        ]
                    },
                    {
                        "id": "T1010",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "find graphical window",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "find graphical window"
                            }
                        ]
                    },
                    {
                        "id": "T1564",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "hide the Windows taskbar",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hide the Windows taskbar"
                            }
                        ]
                    },
                    {
                        "id": "T1113",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "capture screenshot",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "capture screenshot"
                            }
                        ]
                    },
                    {
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "enumerate files in .NET",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate files in .NET"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get disk size",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk size"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get disk information",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get disk information"
                            }
                        ]
                    },
                    {
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get file size",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get file size"
                            }
                        ]
                    },
                    {
                        "id": "T1033",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get session user name",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get session user name"
                            }
                        ]
                    },
                    {
                        "id": "T1087",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get session user name",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get session user name"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get hostname",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get hostname"
                            }
                        ]
                    },
                    {
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "enumerate processes",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate processes"
                            }
                        ]
                    },
                    {
                        "id": "T1518",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "enumerate processes",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate processes"
                            }
                        ]
                    },
                    {
                        "id": "T1547.001",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "persist via Run registry key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "persist via Run registry key"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get MAC address in .NET",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get MAC address in .NET"
                            }
                        ]
                    },
                    {
                        "id": "T1543.003",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "persist via Windows service",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "persist via Windows service"
                            }
                        ]
                    },
                    {
                        "id": "T1569.002",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "persist via Windows service",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "persist via Windows service"
                            }
                        ]
                    },
                    {
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get common file path",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "query environment variable",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query environment variable"
                            }
                        ]
                    },
                    {
                        "id": "T1070.004",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "self delete",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "self delete"
                            }
                        ]
                    },
                    {
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "get CPU information",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get CPU information"
                            }
                        ]
                    },
                    {
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "find process by PID",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "find process by PID"
                            }
                        ]
                    },
                    {
                        "id": "T1115",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "clear clipboard data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "clear clipboard data"
                            }
                        ]
                    },
                    {
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "check if file exists",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "check if file exists"
                            }
                        ]
                    },
                    {
                        "id": "T1105",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "download and write a file",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "download and write a file"
                            }
                        ]
                    },
                    {
                        "id": "T1053.005",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "schedule task via schtasks",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "schedule task via schtasks"
                            }
                        ]
                    },
                    {
                        "id": "T1115",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "read clipboard data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "read clipboard data"
                            }
                        ]
                    },
                    {
                        "id": "T1620",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "load .NET assembly",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "load .NET assembly"
                            }
                        ]
                    },
                    {
                        "id": "T1112",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "delete registry key",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete registry key"
                            }
                        ]
                    },
                    {
                        "id": "T1056.001",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "log keystrokes via polling",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "log keystrokes via polling"
                            }
                        ]
                    },
                    {
                        "id": "T1497.001",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "reference anti-VM strings",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "reference anti-VM strings"
                            }
                        ]
                    },
                    {
                        "id": "T1027.002",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "packed with ASPack",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "packed with ASPack"
                            }
                        ]
                    }
                ],
                "has_html_report": false
            }
        },
        {
            "id": "e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_CAPE Sandbox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_CAPE Sandbox"
            },
            "attributes": {
                "mutexes_created": [
                    "Global\\OneSettingQueryMutex+compat+encapsulation"
                ],
                "files_deleted": [
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\res1.log",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\res2.log",
                    "C:\\ProgramData\\Microsoft\\Windows\\LfSvc\\Cache"
                ],
                "sandbox_name": "CAPE Sandbox",
                "ja3_digests": [
                    "552b95e877797da6f9b4643123ab63e3",
                    "9b73195d9c3c4ad6f656d8dd8760ef97",
                    "d805cbb252512d7da5db6b3b50fe5a34",
                    "ac78d8368ab2061d9d42a30ba0fe95bb"
                ],
                "files_opened": [
                    "C:\\Users\\<USER>\\Desktop\\LisectAVT_2403002C_142.exe.config",
                    "C:\\Users\\<USER>\\Desktop\\LisectAVT_2403002C_142.exe",
                    "C:\\Users\\<USER>\\Desktop\\TextShaping.dll",
                    "C:\\Users\\<USER>\\Desktop\\PROPSYS.dll",
                    "C:\\Users\\<USER>\\Desktop\\urlmon.dll",
                    "C:\\Users\\<USER>\\Desktop\\iertutil.dll",
                    "C:\\Users\\<USER>\\Desktop\\srvcli.dll",
                    "C:\\Users\\<USER>\\Desktop\\netutils.dll",
                    "C:\\Users\\<USER>\\Desktop\\edputil.dll",
                    "C:\\Users\\<USER>\\Desktop\\profapi.dll",
                    "C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Windows",
                    "C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Windows\\INetCookies",
                    "C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Windows\\History",
                    "C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Windows\\History\\History.IE5",
                    "C:\\Users\\<USER>\\Desktop\\msvcp110_win.dll",
                    "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                    "C:\\ProgramData\\Microsoft\\Windows\\AppRepository\\Packages\\Microsoft.AAD.BrokerPlugin_1000.19041.1023.0_neutral_neutral_cw5n1h2txyewy\\S-1-5-21-4005801669-2598574594-602355426-1001.pckgdep",
                    "C:\\ProgramData\\Microsoft\\Windows\\AppRepository\\Packages\\Microsoft.Windows.Search_1.14.2.19041_neutral_neutral_cw5n1h2txyewy\\S-1-5-21-4005801669-2598574594-602355426-1001.pckgdep",
                    "C:\\ProgramData\\Microsoft\\Windows\\AppRepository\\Packages\\Microsoft.Windows.Search_1.14.2.19041_neutral_neutral_cw5n1h2txyewy\\S-1-5-18.pckgdep",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr0.dat",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr1.dat",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\",
                    "C:\\ProgramData\\Microsoft\\Network",
                    "C:\\ProgramData\\Microsoft\\Network\\",
                    "C:\\ProgramData\\Microsoft",
                    "C:\\ProgramData\\Microsoft\\",
                    "C:\\ProgramData",
                    "C:\\ProgramData\\",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\edb.chk",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\edb.log",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\res1.log",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\res2.log",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr.db",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr.jfm",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr.jfm\\",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\Fonts",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\Fonts\\",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\",
                    "C:\\Windows\\ServiceProfiles\\LocalService",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\",
                    "C:\\Windows\\ServiceProfiles",
                    "C:\\Windows\\ServiceProfiles\\",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\Fonts\\Download-1.tmp",
                    "C:\\Users\\<USER>\\AppData\\",
                    "C:\\Users\\<USER>\\",
                    "C:\\Users\\",
                    "C:\\ProgramData\\Microsoft\\Windows",
                    "C:\\ProgramData\\Microsoft\\Windows\\LfSvc",
                    "C:\\ProgramData\\Microsoft\\Windows\\LfSvc\\Cache"
                ],
                "analysis_date": 1721872213,
                "services_started": [
                    "BITS",
                    "WSearch",
                    "lfsvc",
                    "SecurityHealthService"
                ],
                "has_evtx": true,
                "processes_created": [
                    "\"C:\\Users\\<USER>\\Desktop\\LisectAVT_2403002C_142.exe\"",
                    "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --single-argument http://go.microsoft.com/fwlink/?prd=11324&pver=4.5&sbp=AppLaunch2&plcid=0x409&o1=SHIM_NOVERSION_FOUND&version=(null)&processName=LisectAVT_2403002C_142.exe&platform=0009&osver=6&isServer=0&shimver=4.0.30319.0",
                    "C:\\Windows\\system32\\services.exe",
                    "C:\\Windows\\system32\\svchost.exe -k LocalSystemNetworkRestricted -p -s PcaSvc",
                    "C:\\Windows\\System32\\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost",
                    "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding"
                ],
                "text_decoded": [
                    "{'Njrat': {'cncs': [['127.0.0.1:5552']], 'campaign id': ['Lmao'], 'version': ['0.7d']}}"
                ],
                "mbc": [
                    {
                        "id": "OB0001"
                    },
                    {
                        "id": "B0003"
                    },
                    {
                        "id": "OB0006"
                    },
                    {
                        "id": "F0004"
                    },
                    {
                        "id": "F0004.003"
                    },
                    {
                        "id": "OC0006"
                    },
                    {
                        "id": "C0005.001"
                    },
                    {
                        "id": "C0002"
                    },
                    {
                        "id": "F0005"
                    },
                    {
                        "id": "OC0001"
                    },
                    {
                        "id": "C0016"
                    },
                    {
                        "id": "C0018"
                    }
                ],
                "command_executions": [
                    "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --single-argument http://go.microsoft.com/fwlink/?prd=11324&pver=4.5&sbp=AppLaunch2&plcid=0x409&o1=SHIM_NOVERSION_FOUND&version=(null)&processName=LisectAVT_2403002C_142.exe&platform=0009&osver=6&isServer=0&shimver=4.0.30319.0",
                    "http://go.microsoft.com/fwlink/?prd=11324&pver=4.5&sbp=AppLaunch2&plcid=0x409&o1=SHIM_NOVERSION_FOUND&version=(null)&processName=LisectAVT_2403002C_142.exe&platform=0009&osver=6&isServer=0&shimver=4.0.30319.0 ",
                    "\"C:\\Windows\\system32\\BackgroundTaskHost.exe\" -ServerName:BackgroundTaskHost.WebAccountProvider",
                    "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding",
                    "\"C:\\Windows\\SystemApps\\MicrosoftWindows.Client.CBS_cw5n1h2txyewy\\InputApp\\TextInputHost.exe\" -ServerName:InputApp.AppX9jnwykgrccxc8by3hsrsh07r423xzvav.mca",
                    "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding",
                    "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --type=crashpad-handler \"--user-data-dir=C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Edge\\User Data\" /prefetch:4 --monitor-self-annotation=ptype=crashpad-handler \"--database=C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Edge\\User Data\\Crashpad\" --annotation=IsOfficialBuild=1 --annotation=channel= --annotation=chromium-version=122.0.6261.129 \"--annotation=exe=C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --annotation=plat=Win64 \"--annotation=prod=Microsoft Edge\" --annotation=ver=122.0.2365.92 --initial-client-data=0x340,0x344,0x348,0x33c,0x350,0x7ffacebe5fd8,0x7ffacebe5fe4,0x7ffacebe5ff0",
                    "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --type=gpu-process --no-appcompat-clear --gpu-preferences=WAAAAAAAAADgAAAMAAAAAAAAAAAAAAAAAABgAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAYAAAAAAAAAAgAAAAAAAAACAAAAAAAAAAIAAAAAAAAAA== --mojo-platform-channel-handle=1908 --field-trial-handle=1992,i,8418215331352590225,5543758077325114414,262144 --variations-seed-version /prefetch:2",
                    "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --type=utility --utility-sub-type=network.mojom.NetworkService --lang=en-US --service-sandbox-type=none --no-appcompat-clear --mojo-platform-channel-handle=2384 --field-trial-handle=1992,i,8418215331352590225,5543758077325114414,262144 --variations-seed-version /prefetch:3",
                    "C:\\Windows\\system32\\svchost.exe -k LocalSystemNetworkRestricted -p -s PcaSvc",
                    "C:\\Windows\\System32\\svchost.exe -k netsvcs -p",
                    "C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Appinfo",
                    "C:\\Windows\\system32\\svchost.exe -k netsvcs -p",
                    "C:\\Windows\\System32\\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost",
                    "C:\\Windows\\system32\\SecurityHealthService.exe"
                ],
                "processes_tree": [
                    {
                        "process_id": "3384",
                        "name": "\"C:\\Users\\<USER>\\Desktop\\LisectAVT_2403002C_142.exe\"",
                        "children": [
                            {
                                "process_id": "2152",
                                "name": "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --single-argument http://go.microsoft.com/fwlink/?prd=11324&pver=4.5&sbp=AppLaunch2&plcid=0x409&o1=SHIM_NOVERSION_FOUND&version=(null)&processName=LisectAVT_2403002C_142.exe&platform=0009&osver=6&isServer=0&shimver=4.0.30319.0"
                            },
                            {
                                "process_id": "2252",
                                "name": "\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" --single-argument http://go.microsoft.com/fwlink/?prd=11324&pver=4.5&sbp=AppLaunch2&plcid=0x409&o1=SHIM_NOVERSION_FOUND&version=(null)&processName=LisectAVT_2403002C_142.exe&platform=0009&osver=6&isServer=0&shimver=4.0.30319.0"
                            }
                        ]
                    }
                ],
                "has_memdump": true,
                "last_modification_date": 1721872247,
                "memory_dumps": [
                    {
                        "file_name": "7024.dmp",
                        "process": "C:\\Windows\\System32\\svchost.exe",
                        "size": "39698432",
                        "base_address": "2147352576"
                    },
                    {
                        "file_name": "5816.dmp",
                        "process": "C:\\Windows\\System32\\svchost.exe",
                        "size": "43384832",
                        "base_address": "2147352576"
                    },
                    {
                        "file_name": "5432.dmp",
                        "process": "C:\\Windows\\System32\\SecurityHealthService.exe",
                        "size": "58396672",
                        "base_address": "2147352576"
                    },
                    {
                        "file_name": "3384.dmp",
                        "process": "C:\\Users\\Bruno\\Desktop\\LisectAVT_2403002C_142.exe",
                        "size": "60887040",
                        "base_address": "5046272"
                    },
                    {
                        "file_name": "6216.dmp",
                        "process": "C:\\Windows\\System32\\RuntimeBroker.exe",
                        "size": "41750528",
                        "base_address": "2147352576"
                    }
                ],
                "dns_lookups": [
                    {
                        "hostname": "edge-mobile-static.azureedge.net",
                        "resolved_ips": [
                            "13.107.253.69"
                        ]
                    },
                    {
                        "hostname": "business.bing.com",
                        "resolved_ips": [
                            "13.107.6.158"
                        ]
                    },
                    {
                        "hostname": "bzib.nelreports.net",
                        "resolved_ips": [
                            "23.67.33.94",
                            "23.67.33.70"
                        ]
                    },
                    {
                        "hostname": "js.monitor.azure.com"
                    },
                    {
                        "hostname": "xpaywalletcdn.azureedge.net"
                    },
                    {
                        "hostname": "c.bing.com",
                        "resolved_ips": [
                            "13.107.21.237",
                            "204.79.197.237"
                        ]
                    },
                    {
                        "hostname": "edge-consumer-static.azureedge.net"
                    },
                    {
                        "hostname": "mdec.nelreports.net"
                    },
                    {
                        "hostname": "assets.onestore.ms",
                        "resolved_ips": [
                            "23.59.193.65"
                        ]
                    },
                    {
                        "hostname": "mem.gfx.ms"
                    },
                    {
                        "hostname": "microsoftwindows.112.2o7.net",
                        "resolved_ips": [
                            "63.140.37.126",
                            "63.140.36.51",
                            "63.140.37.206",
                            "63.140.36.145"
                        ]
                    },
                    {
                        "hostname": "img-prod-cms-rt-microsoft-com.akamaized.net",
                        "resolved_ips": [
                            "23.216.147.64",
                            "23.216.147.76"
                        ]
                    },
                    {
                        "hostname": "prod-video-cms-rt-microsoft-com.akamaized.net",
                        "resolved_ips": [
                            "23.216.147.42",
                            "23.216.147.69"
                        ]
                    },
                    {
                        "hostname": "amp.azure.net",
                        "resolved_ips": [
                            "72.21.81.200"
                        ]
                    }
                ],
                "signature_matches": [
                    {
                        "id": "antivm_checks_available_memory",
                        "name": "antivm_checks_available_memory",
                        "description": "Checks available memory",
                        "match_data": [
                            "{\"type\": \"call\", \"pid\": 5816, \"cid\": 1345}"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "queries_keyboard_layout",
                        "name": "queries_keyboard_layout",
                        "description": "Queries the keyboard layout",
                        "match_data": [
                            "{\"type\": \"call\", \"pid\": 3384, \"cid\": 494}"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "antidebug_setunhandledexceptionfilter",
                        "name": "antidebug_setunhandledexceptionfilter",
                        "description": "SetUnhandledExceptionFilter detected (possible anti-debug)",
                        "match_data": [
                            "{\"type\": \"call\", \"pid\": 5816, \"cid\": 5}"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "terminates_remote_process",
                        "name": "terminates_remote_process",
                        "description": "Terminates another process",
                        "match_data": [
                            "{\"type\": \"call\", \"pid\": 824, \"cid\": 178}",
                            "{\"process\": \"svchost.exe\"}"
                        ],
                        "severity": "IMPACT_SEVERITY_LOW"
                    },
                    {
                        "id": "network_http",
                        "name": "network_http",
                        "description": "Performs some HTTP requests",
                        "match_data": [
                            "{\"url\": \"http://www.msftconnecttest.com/connecttest.txt\"}",
                            "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBQ50otx%2Fh0Ztl%2Bz8SiPI7wEWVxDlQQUTiJUIBiV5uNu5g%2F6%2BrkS7QYXjzkCEA77flR%2B3w%2FxBpruV2lte6A%3D\"}",
                            "{\"url\": \"http://ocsp.digicert.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBSAUQYBMq2awn1Rh6Doh%2FsBYgFV7gQUA95QNVbRTLtm8KPiGxvDl7I90VUCEAJ0LqoXyo4hxxe7H%2Fz9DKA%3D\"}",
                            "{\"url\": \"http://c.pki.goog/r/r1.crl\"}",
                            "{\"url\": \"http://x1.c.lencr.org/\"}",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/cea6d764-36bf-4144-a357-ec91013ddbf5?P1=1722290877&P2=404&P3=2&P4=f2Lcd7SSEaqZYkevoLMP5T5uycEW3wFnF4zm0s4AEPAxuAEMM",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/68eda192-d0f3-46cf-b3be-1a828f951b21?P1=1722412603&P2=404&P3=2&P4=fm5wVhWEJCUyq3Zs5E9szQqGsw%2ffNwizqDSFpTo8oN4mESv",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/42ecbc28-babc-4ca9-b065-ed0625b7b7c2?P1=1722452290&P2=404&P3=2&P4=MysEMeh54PKoXT2290B7hYCNLjbi846lxBc5RlzGv%2byaqOq",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/81c945d1-1834-4d97-ab56-9ed86990a128?P1=1722302806&P2=404&P3=2&P4=BTXdcNYew3bmUB2Y4rYRsSezQR5G7anwK2kayJVplRBib0Vlg",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/3431e97b-0c2a-4d25-8965-bf938067ad33?P1=1722333323&P2=404&P3=2&P4=lkVLI2zwo%2f%2fZB%2fgwEELNkwSit%2bETauZlHmSQwxflr",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/e51c37f2-7da7-478a-bf32-cdb0df2e857f?P1=1722473503&P2=404&P3=2&P4=JxyFFi98fIsVMZnW9YfsRjbPpQcDKhy8cKQ6%2fiNp9%2bS8j",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/8bc315ba-54e5-49f4-9b75-997d7071eb06?P1=1722400660&P2=404&P3=2&P4=lNcVqEoseX7nA2h2l8WeOOolqvw2KKvpOR7IsvcQyKDp4BziM",
                            "{\"url\": \"http://msedge.b.tlu.dl.delivery.mp.microsoft.com/filestreamingservice/files/6d62015c-97e1-4610-b245-6577ee964059?P1=1722455978&P2=404&P3=2&P4=ENL8LpgqtAeGzVfVuFDbPH%2bv2peF%2f7XVm9%2fhmOl%2bQ"
                        ],
                        "severity": "IMPACT_SEVERITY_LOW"
                    },
                    {
                        "id": "antisandbox_unhook",
                        "name": "antisandbox_unhook",
                        "description": "Tries to unhook or modify Windows functions monitored by CAPE",
                        "match_data": [
                            "{\"type\": \"call\", \"pid\": 3384, \"cid\": 6044}",
                            "{\"unhook\": \"function_name: GetFileVersionInfoW, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpOpenRequest, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpQueryHeaders, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpSetOption, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpSendRequest, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpGetIEProxyConfigForCurrentUser, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpConnect, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpSetTimeouts, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpOpen, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpGetProxyForUrl, type: removal\"}",
                            "{\"unhook\": \"function_name: WinHttpReceiveResponse, type: removal\"}",
                            "{\"unhook\": \"function_name: GetFileVersionInfoSizeW, type: removal\"}",
                            "{\"unhook\": \"function_name: NetGetJoinInformation, type: removal\"}"
                        ],
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    },
                    {
                        "id": "infostealer_cookies",
                        "name": "infostealer_cookies",
                        "description": "Touches a file containing cookies, possibly for information gathering",
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    },
                    {
                        "id": "stealth_file",
                        "name": "stealth_file",
                        "description": "Creates a hidden or system file",
                        "match_data": [
                            "{\"type\": \"call\", \"pid\": 3532, \"cid\": 651}",
                            "{\"file\": \"C:\\\\Windows\\\\ServiceProfiles\\\\LocalService\\\\AppData\\\\Local\\\\FontCache\\\\Fonts\\\\Download-1.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_195329150\\\\BIT5228.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_994381638\\\\BITB0F3.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_670218317\\\\BITC120.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_291644666\\\\BITD1AC.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_849344914\\\\BITE1F9.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_1959747346\\\\BITF572.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_1058378741\\\\BIT16F5.tmp\"}",
                            "{\"file\": \"C:\\\\Users\\\\Bruno\\\\AppData\\\\Local\\\\Temp\\\\edge_BITS_68_536286589\\\\BIT2761.tmp\"}"
                        ],
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    },
                    {
                        "id": "procmem_yara",
                        "name": "procmem_yara",
                        "description": "Yara detections observed in process dumps, payloads or dropped files",
                        "match_data": [
                            "{\"Hit\": \"PID 3384 trigged the Yara rule 'INDICATOR_EXE_Packed_ASPack' with data '['{ 00 00 C2 2E 61 73 70 61 63 6B 00 00 }']'\"}",
                            "{\"Hit\": \"PID 5432 trigged the Yara rule 'shellcode_stack_strings' with data '['{ C7 45 D8 76 00 65 00 C7 45 DC 72 00 73 00 C7 45 E0 69 00 6F 00 C7 45 E4 6E 00 2E 00 C7 45 E8 64 00 6C 00 C7 45 EC 6C 00",
                            "{\"Hit\": \"PID 3384 trigged the Yara rule 'shellcode_get_eip' with data '['{ E8 00 00 00 00 58 }', '{ E8 00 00 00 00 58 }', '{ E8 00 00 00 00 58 }']'\"}",
                            "{\"Hit\": \"PID 3384 trigged the Yara rule 'Njrat' with data '[\\\"|\\\\x00'\\\\x00|\\\\x00'\\\\x00|\\\", 'n\\\\x00e\\\\x00t\\\\x00s\\\\x00h\\\\x00 \\\\x00f\\\\x00i\\\\x00r\\\\x00e\\\\x00w\\\\x00a\\\\x00l\\\\x00l\\\\x00 \\\\x00a\\\\x00d\\\\x00d\\\\x00"
                        ],
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    }
                ],
                "verdicts": [
                    "MALWARE"
                ],
                "files_dropped": [
                    {
                        "path": "edb.chk",
                        "sha256": "d551c96ef6363c0f6ec12673e09c09a926d31a6567e4fa82c0bf479f5122afa0",
                        "process_name": "C:\\Windows\\System32\\svchost.exe -k netsvcs -p",
                        "process_id": "3532"
                    }
                ],
                "registry_keys_opened": [
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\ErrorDialog",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CreateUriCacheSize",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder\\Attributes",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoInternetIcon",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\DelegateFolders\\",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\DelegateFolders",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\FontLink\\SystemLink",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellCompatibility\\Applications\\LisectAVT_2403002C_142.exe",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoCommonGroups",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer",
                    "HKEY_LOCAL_MACHINE\\Software\\Classes\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\FipsAlgorithmPolicy\\STE",
                    "HKEY_LOCAL_MACHINE\\Software\\Classes\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder\\Attributes",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace",
                    "HKEY_CURRENT_USER\\Software\\Classes\\WOW6432Node\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1\\Desktop\\NameSpace",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\NonEnum",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Input\\ResyncResetTime",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OLEAUT",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\DelegateFolders\\StorageDelegate",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder\\FolderValueFlags",
                    "HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\.NETFramework",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\FipsAlgorithmPolicy\\MDMEnabled",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\NonEnum",
                    "HKEY_LOCAL_MACHINE\\Software\\Classes",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyComputer",
                    "HKEY_CURRENT_USER\\Software\\Classes\\WOW6432Node\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoCommonGroups",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CreateUriCacheSize",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetFolders",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\FipsAlgorithmPolicy",
                    "HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder\\RestrictedAttributes",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Input",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Input\\MaxResyncAttempts",
                    "HKEY_CURRENT_USER\\Software\\Classes",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesRecycleBin",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\NonEnum\\{871C5380-42A0-1069-A2EA-08002B30309D}",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Lsa\\FipsAlgorithmPolicy\\Enabled",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Session Manager\\ResourcePolicies",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\Fod",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\NonEnum\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\.NETFramework\\Advertised",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetFolders",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\.NETFramework",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder\\RestrictedAttributes",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder\\Attributes",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder\\CallForAttributes",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\OOBE\\LaunchUserOOBE",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\NonEnum\\{208D2C60-3AEA-1069-A2D7-08002B30309D}",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoInternetIcon",
                    "HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder\\FolderValueFlags",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder\\CallForAttributes",
                    "HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\ValidateRegItems",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\UseLegacyV2RuntimeActivationPolicyDefaultValue",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SessionInfo\\1\\Desktop\\NameSpace\\DelegateFolders",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\OnlyUseLatestCLR",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CreateUriCacheSize",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder\\FolderValueFlags",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder\\CallForAttributes",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\DelegateFolders",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\IsVailContainer",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyComputer",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\OOBE",
                    "HKEY_LOCAL_MACHINE\\Software\\Classes\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\MonitorRegistry",
                    "HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\ShellFolder\\Attributes",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\EnablePunycode",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\CreateUriCacheSize",
                    "HKEY_CURRENT_USER\\Software\\Classes\\WOW6432Node\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\WOW6432Node\\CLSID\\{871C5380-42A0-1069-A2EA-08002B30309D}\\ShellFolder\\RestrictedAttributes",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\EnablePunycode",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\DelegateFolders\\StorageDelegateSuppressionPolicy",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\.NETFramework\\InstallRoot",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\DelegateFolders",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\LanmanWorkstation\\Parameters\\RpcCacheTimeout",
                    "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesRecycleBin"
                ],
                "services_opened": [
                    "WinDefend"
                ],
                "files_written": [
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr0.dat",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr1.dat",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\edb.chk",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\edb.log",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr.db",
                    "C:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr.jfm",
                    "\\Device\\Afd\\Endpoint",
                    "C:\\Windows\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\Fonts\\Download-1.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_195329150\\BIT5228.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_195329150\\cea6d764-36bf-4144-a357-ec91013ddbf5",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_994381638\\BITB0F3.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_994381638\\68eda192-d0f3-46cf-b3be-1a828f951b21",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_670218317\\BITC120.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_670218317\\42ecbc28-babc-4ca9-b065-ed0625b7b7c2",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_291644666\\BITD1AC.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_291644666\\81c945d1-1834-4d97-ab56-9ed86990a128",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_849344914\\BITE1F9.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_849344914\\3431e97b-0c2a-4d25-8965-bf938067ad33",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_1959747346\\BITF572.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_1959747346\\e51c37f2-7da7-478a-bf32-cdb0df2e857f",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_1058378741\\BIT16F5.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_1058378741\\8bc315ba-54e5-49f4-9b75-997d7071eb06",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_536286589\\BIT2761.tmp",
                    "C:\\Users\\<USER>\\AppData\\Local\\Temp\\edge_BITS_68_536286589\\6d62015c-97e1-4610-b245-6577ee964059",
                    "\\Device\\NamedPipe\\Sessions\\1\\AppContainerNamedObjects\\S-1-15-2-543634040-274359014-2226501544-3561766748-3991453649-3543631192-522786984"
                ],
                "has_pcap": true,
                "behash": "02f0186025f86a378a85924095b7eb8c",
                "mitre_attack_techniques": [
                    {
                        "id": "T1539",
                        "signature_description": "An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials."
                    },
                    {
                        "id": "T1564",
                        "signature_description": "Adversaries may attempt to hide artifacts associated with their behaviors to evade detection."
                    },
                    {
                        "id": "T1562",
                        "signature_description": "Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms."
                    },
                    {
                        "id": "T1562.001",
                        "signature_description": "Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities."
                    },
                    {
                        "id": "T1564.001",
                        "signature_description": "Adversaries may set files and directories to be hidden to evade detection mechanisms."
                    },
                    {
                        "id": "T1082",
                        "signature_description": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture."
                    },
                    {
                        "id": "T1071",
                        "signature_description": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic."
                    }
                ],
                "verdict_labels": [
                    "Njrat"
                ],
                "has_html_report": true,
                "ip_traffic": [
                    {
                        "destination_ip": "13.107.253.69",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "13.107.6.158",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "23.67.33.94",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "204.79.197.237",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "63.140.36.51",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "23.216.147.64",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "23.59.193.65",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "23.216.147.42",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    },
                    {
                        "destination_ip": "72.21.81.200",
                        "destination_port": 443,
                        "transport_layer_protocol": "TCP"
                    }
                ]
            }
        },
        {
            "id": "e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_Microsoft Sysinternals",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_Microsoft Sysinternals"
            },
            "attributes": {
                "sandbox_name": "Microsoft Sysinternals",
                "analysis_date": 1721872077,
                "has_evtx": false,
                "processes_created": [
                    "%SAMPLEPATH%\\LisectAVT_2403002C_142.exe"
                ],
                "command_executions": [
                    "\"%SAMPLEPATH%\\LisectAVT_2403002C_142.exe\" "
                ],
                "processes_tree": [
                    {
                        "process_id": "3648",
                        "name": "%WINDIR%\\explorer.exe",
                        "children": [
                            {
                                "process_id": "3504",
                                "name": "%SAMPLEPATH%\\LisectAVT_2403002C_142.exe"
                            }
                        ]
                    }
                ],
                "has_memdump": false,
                "last_modification_date": 1721872077,
                "dns_lookups": [
                    {
                        "hostname": "www.microsoft.com",
                        "resolved_ips": [
                            "23.216.81.152"
                        ]
                    }
                ],
                "has_pcap": false,
                "behash": "ad4e054a0bc469aa10da183753ab83c7",
                "has_html_report": false,
                "ip_traffic": [
                    {
                        "destination_ip": "192.168.0.66",
                        "destination_port": 137,
                        "transport_layer_protocol": "UDP"
                    },
                    {
                        "destination_ip": "23.216.81.152",
                        "destination_port": 80,
                        "transport_layer_protocol": "TCP"
                    }
                ]
            }
        },
        {
            "id": "e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_Yomi Hunter",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_Yomi Hunter"
            },
            "attributes": {
                "sandbox_name": "Yomi Hunter",
                "ids_alerts": [
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44486",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|Windows for Workgroups 3.1a\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44486; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44484",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|PC NETWORK PROGRAM 1.0\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; gid:1; sid:44484; rev:6; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44488",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|LANMAN2.1\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44488; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44487",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|LM1.2X002\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44487; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44485",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|LANMAN1.0\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44485; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER use of psexec remote administration tool SMBv2",
                        "rule_category": "policy-violation",
                        "rule_id": "1:30281",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://attack.mitre.org/techniques/T1028",
                            "https://attack.mitre.org/techniques/T1035",
                            "https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx"
                        ],
                        "rule_raw": "alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER use of psexec remote administration tool SMBv2\"; flow:to_server,established; content:\"|FE|SMB\",depth 8,nocase; content:\"|05 00|\",within 2,distance 8; content:\"P|00|S|00|E|00|X|00|E|00|S|00|V|00|C|00|\",fast_pattern,nocase; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1028; reference:url,attack.mitre.org/techniques/T1035; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:30281; rev:4; )"
                    },
                    {
                        "rule_msg": "FILE-EXECUTABLE Microsoft Windows executable file save onto SMB share attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:26385",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_raw": "alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:\"FILE-EXECUTABLE Microsoft Windows executable file save onto SMB share attempt\"; flow:to_server,established; content:\"SMB\",depth 3,offset 5; content:\"MZ\",within 150; byte_jump:4,58,relative,little; content:\"PE|00 00|\",within 4,distance -64,fast_pattern; metadata:policy max-detect-ips drop; service:netbios-ssn; classtype:policy-violation; sid:26385; rev:3; )"
                    },
                    {
                        "rule_msg": "NETBIOS SMB svcctl named pipe creation attempt",
                        "rule_category": "misc-activity",
                        "rule_id": "1:38321",
                        "alert_severity": "low",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_raw": "alert tcp any any -> $HOME_NET 445 ( msg:\"NETBIOS SMB svcctl named pipe creation attempt\"; flow:to_server,established; content:\"|FE|SMB|40 00|\",depth 6,offset 4; content:\"|05 00|\",within 2,distance 6; content:\"s|00|v|00|c|00|c|00|t|00|l|00|\",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:netbios-ssn; classtype:misc-activity; sid:38321; rev:2; )"
                    },
                    {
                        "rule_msg": "(dce_smb) SMB - next command specified in SMB2 header is beyond payload boundary",
                        "rule_category": "bad-unknown",
                        "rule_id": "133:59",
                        "alert_severity": "medium",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://msdn.microsoft.com/en-us/library/cc201989.aspx"
                        ],
                        "rule_raw": "alert ( gid:133; sid:59; rev:2; msg:\"(dce_smb) SMB - next command specified in SMB2 header is beyond payload boundary\"; metadata: rule-type preproc; reference:url,msdn.microsoft.com/en-us/library/cc201989.aspx; service:netbios-ssn; classtype:bad-unknown;)"
                    },
                    {
                        "rule_msg": "ATTACK [PTsecurity] Petya ransomware perfc.dat component",
                        "rule_category": "A suspicious filename was detected",
                        "rule_id": "1:10001443",
                        "alert_severity": "medium",
                        "rule_source": "Positive Technologies: PT Open Ruleset",
                        "rule_url": "https://github.com/ptresearch/AttackDetection/",
                        "rule_references": [
                            "https://github.com/ptresearch/AttackDetection"
                        ],
                        "rule_raw": "alert smb any any -> $HOME_NET any (msg: \"ATTACK [PTsecurity] Petya ransomware perfc.dat component\"; flow: to_server, established, no_stream; content: \"|fe 53 4d 42|\"; offset: 4; depth: 4; content: \"|05 00|\"; offset: 16; depth: 2; byte_jump: 2, 112, little, from_beginning, post_offset 4; content: \"|70 00 65 00 72 00 66 00 63 00 2e 00 64 00 61 00 74 00|\"; distance:0; classtype:suspicious-filename-detect; reference: url, github.com/ptresearch/AttackDetection; sid: 10001443; rev: 1;)"
                    },
                    {
                        "rule_msg": "ET RPC DCERPC SVCCTL - Remote Service Control Manager Access",
                        "rule_category": "Attempted User Privilege Gain",
                        "rule_id": "1:2027237",
                        "alert_severity": "high",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert tcp any any -> $HOME_NET 135 (msg:\"ET RPC DCERPC SVCCTL - Remote Service Control Manager Access\"; flow:established,to_server; content:\"|00 00 00 00 00 00 00 00|\"; content:\"|13 00 0d 81 bb 7a 36 44 98 f1 35 ad 32 98 f0 38 00 10 03|\"; within:100; classtype:attempted-user; sid:2027237; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2019_04_22, deployment Perimeter, performance_impact Low, signature_severity Informational, updated_at 2020_08_19;)"
                    },
                    {
                        "rule_msg": "ET POLICY SMB Executable File Transfer",
                        "rule_category": "Potentially Bad Traffic",
                        "rule_id": "1:2025699",
                        "alert_severity": "low",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert tcp any any -> $HOME_NET 445 (msg:\"ET POLICY SMB Executable File Transfer\"; flow:established,to_server; content:\"SMB\"; depth:8; content:\"MZ\"; distance:0; byte_jump:4,58,relative,little; content:\"PE|00 00|\"; distance:-64; within:4; flowbits:set,ET.smb.binary; classtype:bad-unknown; sid:2025699; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target SMB_Client, created_at 2018_07_16, deployment Internal, signature_severity Minor, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "File Found over SMB and stored",
                        "rule_id": "1:32",
                        "alert_severity": "low",
                        "rule_source": "Suricata",
                        "rule_url": "https://www.openinfosecfoundation.org/",
                        "rule_raw": "alert smb any any -> any any (msg:\"File Found over SMB and stored\"; filestore; sid:32; rev:1;)"
                    },
                    {
                        "rule_msg": "ET EXPLOIT ETERNALBLUE Exploit M2 MS17-010",
                        "rule_category": "Attempted Administrator Privilege Gain",
                        "rule_id": "1:2024297",
                        "alert_severity": "high",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_references": [
                            "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143"
                        ],
                        "tags": [
                            "cve-2017-0143"
                        ],
                        "rule_raw": "alert tcp any any -> any 445 (msg:\"ET EXPLOIT ETERNALBLUE Exploit M2 MS17-010\"; flow:established,to_server; content:\"|8000a80000000000000000000000000000000000ffff000000000000ffff0000000000000000000000000000000000000000000000f1dfff000000000000000020f0dfff00f1dfffffffffff600004100000000080efdfff|\"; reference:cve,CVE-2017-0143; classtype:attempted-admin; sid:2024297; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2017_05_16, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "ATTACK [PTsecurity] SMB2 Create PSEXESVC.EXE",
                        "rule_category": "A suspicious filename was detected",
                        "rule_id": "1:10001444",
                        "alert_severity": "medium",
                        "rule_source": "Positive Technologies: PT Open Ruleset",
                        "rule_url": "https://github.com/ptresearch/AttackDetection/",
                        "rule_references": [
                            "https://github.com/ptresearch/AttackDetection"
                        ],
                        "rule_raw": "alert smb any any -> $HOME_NET any (msg:\"ATTACK [PTsecurity] SMB2 Create PSEXESVC.EXE\"; flow:to_server, established, no_stream; content: \"|fe 53 4d 42|\"; offset: 4; depth: 4; content: \"|05 00|\"; offset: 16; depth: 2; byte_jump: 2, 112, little, from_beginning, post_offset 4; content:\"|50 00 53 00 45 00 58 00 45 00 53 00 56 00 43 00 2e 00 45 00 58 00 45|\"; distance:0; classtype:suspicious-filename-detect; reference: url, github.com/ptresearch/AttackDetection; sid: 10001444; rev:1;)"
                    },
                    {
                        "rule_msg": "ET POLICY SMB2 NT Create AndX Request For an Executable File",
                        "rule_category": "Potentially Bad Traffic",
                        "rule_id": "1:2025701",
                        "alert_severity": "low",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert tcp any any -> $HOME_NET 445 (msg:\"ET POLICY SMB2 NT Create AndX Request For an Executable File\"; flow:established,to_server; content:\"SMB\"; depth:8; content:\"|05 00|\"; distance:8; within:2; content:\"|00 2E 00|e|00|x|00|e|00|\"; nocase; distance:0; classtype:bad-unknown; sid:2025701; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target SMB_Client, created_at 2018_07_16, deployment Perimeter, signature_severity Minor, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "ET POLICY PsExec service created",
                        "rule_category": "A suspicious filename was detected",
                        "rule_id": "1:2010781",
                        "alert_severity": "medium",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_references": [
                            "https://xinn.org/Snort-psexec.html"
                        ],
                        "rule_raw": "alert tcp any any -> $HOME_NET [139,445] (msg:\"ET POLICY PsExec service created\"; flow:to_server,established; content:\"P|00|S|00|E|00|X|00|E|00|S|00|V|00|C\"; nocase; reference:url,xinn.org/Snort-psexec.html; classtype:suspicious-filename-detect; sid:2010781; rev:3; metadata:created_at 2010_07_30, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "ET POLICY RunDll Request Over SMB - Likely Lateral Movement",
                        "rule_category": "A Network Trojan was detected",
                        "rule_id": "1:2025725",
                        "alert_severity": "high",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert smb any any -> $HOME_NET 445 (msg:\"ET POLICY RunDll Request Over SMB - Likely Lateral Movement\"; flow:established,to_server; content:\"SMB\"; depth:8; content:\"|00|r|00|u|00|n|00|d|00|l|00|l|00|\"; nocase; distance:0; fast_pattern; classtype:trojan-activity; sid:2025725; rev:3; metadata:attack_target SMB_Client, created_at 2018_07_17, deployment Perimeter, deployment Internal, performance_impact Low, signature_severity Major, updated_at 2019_07_26, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1570, mitre_technique_name Lateral_Tool_Transfer;)"
                    }
                ],
                "analysis_date": 1721923751,
                "has_evtx": true,
                "has_memdump": false,
                "last_modification_date": 1721923776,
                "verdicts": [
                    "MALWARE"
                ],
                "has_pcap": true,
                "behash": "63f7d318ab3b960a81e28ab4e7830f3a",
                "mitre_attack_techniques": [
                    {
                        "id": "T1045",
                        "signature_description": "Manalize Local SandBox Packer Harvesting"
                    },
                    {
                        "id": "T1564.003",
                        "signature_description": "hide graphical window"
                    },
                    {
                        "id": "T1222",
                        "signature_description": "set file attributes"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "get OS version in .NET"
                    },
                    {
                        "id": "T1057",
                        "signature_description": "find process by name"
                    },
                    {
                        "id": "T1140",
                        "signature_description": "decode data using Base64 in .NET"
                    },
                    {
                        "id": "T1012",
                        "signature_description": "query or enumerate registry key"
                    },
                    {
                        "id": "T1112",
                        "signature_description": "delete registry value"
                    },
                    {
                        "id": "T1027",
                        "signature_description": "encode data using Base64"
                    },
                    {
                        "id": "T1012",
                        "signature_description": "query or enumerate registry value"
                    },
                    {
                        "id": "T1560.002",
                        "signature_description": "compress data using GZip in .NET"
                    },
                    {
                        "id": "T1010",
                        "signature_description": "find graphical window"
                    },
                    {
                        "id": "T1564",
                        "signature_description": "hide the Windows taskbar"
                    },
                    {
                        "id": "T1113",
                        "signature_description": "capture screenshot"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "enumerate files on Windows"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "get disk information"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "get disk size"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "get file size"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "get hostname"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "get common file path"
                    },
                    {
                        "id": "T1115",
                        "signature_description": "clear clipboard data"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "query environment variable"
                    },
                    {
                        "id": "T1547.001",
                        "signature_description": "persist via Run registry key"
                    },
                    {
                        "id": "T1057",
                        "signature_description": "find process by PID"
                    },
                    {
                        "id": "T1105",
                        "signature_description": "download and write a file"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "get MAC address on Windows"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "get CPU information"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "check if file exists"
                    },
                    {
                        "id": "T1053.005",
                        "signature_description": "schedule task via schtasks"
                    },
                    {
                        "id": "T1115",
                        "signature_description": "read clipboard data"
                    },
                    {
                        "id": "T1620",
                        "signature_description": "load .NET assembly"
                    },
                    {
                        "id": "T1112",
                        "signature_description": "delete registry key"
                    },
                    {
                        "id": "T1056.001",
                        "signature_description": "log keystrokes via polling"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "Manalize Local SandBox Strings"
                    },
                    {
                        "id": "T1569.002",
                        "signature_description": "Manalize Local SandBox Strings"
                    },
                    {
                        "id": "T1012",
                        "signature_description": "Manalize Local SandBox Strings"
                    },
                    {
                        "id": "T1027",
                        "signature_description": "Manalize Local SandBox Strings"
                    },
                    {
                        "id": "T1129",
                        "signature_description": "Manalize Local SandBox Strings"
                    },
                    {
                        "id": "T1543.003",
                        "signature_description": "Manalize Local SandBox Strings"
                    },
                    {
                        "id": "T1033",
                        "signature_description": "get session user name"
                    },
                    {
                        "id": "T1087",
                        "signature_description": "get session user name"
                    },
                    {
                        "id": "T1543.003",
                        "signature_description": "persist via Windows service"
                    },
                    {
                        "id": "T1569.002",
                        "signature_description": "persist via Windows service"
                    },
                    {
                        "id": "T1057",
                        "signature_description": "enumerate processes"
                    },
                    {
                        "id": "T1518",
                        "signature_description": "enumerate processes"
                    },
                    {
                        "id": "T1070.004",
                        "signature_description": "self delete"
                    },
                    {
                        "id": "T1027.002",
                        "signature_description": "packed with ASPack"
                    },
                    {
                        "id": "T1497.001",
                        "signature_description": "reference anti-VM strings"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1012",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1113",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1115",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1497.001",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1129",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1518",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1222",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1087",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1027.002",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1560.002",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1053.005",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1105",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1057",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1027",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1620",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1010",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1070.004",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1564.003",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1112",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1543.003",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1547.001",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1033",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1564",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1569.002",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1056.001",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1082",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1140",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    }
                ],
                "has_html_report": true
            }
        },
        {
            "id": "e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_Zenbox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc_Zenbox"
            },
            "attributes": {
                "sandbox_name": "Zenbox",
                "analysis_date": 1721872053,
                "has_evtx": false,
                "has_memdump": false,
                "last_modification_date": 1721872059,
                "tags": [
                    "CHECKS_USB_BUS"
                ],
                "signature_matches": [
                    {
                        "id": "7037",
                        "description": "Malicious sample detected (through community Yara rule)",
                        "match_data": [
                            "Detects NjRAT / Bladabindi Author: ditekSHen",
                            "detect njRAT in memory Author: JPCERT/CC Incident Response Group",
                            "Windows_Trojan_Njrat_30f3c220 Author: unknown"
                        ],
                        "severity": "IMPACT_SEVERITY_HIGH"
                    },
                    {
                        "id": "9028",
                        "description": "Uses 32bit PE files",
                        "match_data": [
                            "EXECUTABLE_IMAGE, 32BIT_MACHINE"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "171",
                        "description": "Parts of this applications are using the .NET runtime (Probably coded in C#)",
                        "match_data": [
                            "TRID: Win32 Executable (generic) Net Framework (10011505/4) 50.01%"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "287",
                        "description": "Yara signature match",
                        "match_data": [
                            "MALWARE_Win_NjRAT author = ditekSHen, description = Detects NjRAT / Bladabindi",
                            "Njrat hash1 = d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d, author = JPCERT/CC Incident Response Group, description = detect njRAT in memory, rule_usage = memory scan",
                            "Windows_Trojan_Njrat_30f3c220 reference_sample = 741a0f3954499c11f9eddc8df7c31e7c59ca41f1a7005646735b8b1d53438c1b, os = windows, severity  = x86, creation_date = 2021-06-13, scan_context = file, memor"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "414",
                        "description": "PE file contains a COM descriptor data directory",
                        "match_data": [
                            "data directory type: IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "716",
                        "description": "Sample is looking for USB drives. Launch the sample with the USB Fake Disk cookbook",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "715",
                        "description": "Classification label",
                        "match_data": [
                            "mal72.spre.troj.evad.winEXE@0/0@0/0"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "1725",
                        "description": "Contains functionality to disable the Task Manager (.Net Source)",
                        "match_data": [
                            "INS"
                        ],
                        "severity": "IMPACT_SEVERITY_LOW"
                    },
                    {
                        "id": "406",
                        "description": "Contains modern PE file flags such as dynamic base (ASLR) or NX",
                        "match_data": [
                            "DYNAMIC_BASE, NX_COMPAT, NO_SEH, TERMINAL_SERVER_AWARE"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "296",
                        "description": "May try to detect the Windows Explorer process (often used for injection)",
                        "match_data": [
                            "Shell_traywnd+MostrarBarraDeTarefas",
                            "Shell_TrayWnd",
                            "ProgMan"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "526",
                        "description": "May infect USB drives",
                        "match_data": [
                            "\\autorun.inf",
                            "[autorun]",
                            "autorun.inf"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "205",
                        "description": "Entry point lies outside standard sections",
                        "match_data": [
                            "section where entry point is pointing to: >|u"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "1365",
                        "description": "Contains functionality to spread to USB devices (.Net source)",
                        "match_data": [
                            "infect"
                        ],
                        "severity": "IMPACT_SEVERITY_LOW"
                    },
                    {
                        "id": "199",
                        "description": "PE file contains sections with non-standard names",
                        "match_data": [
                            "section name: >|u"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "100059",
                        "description": "Yara detected Njrat",
                        "match_data": [
                            "LisectAVT_2403002C_142.exe, type: SAMPLE"
                        ],
                        "severity": "IMPACT_SEVERITY_HIGH"
                    },
                    {
                        "id": "202",
                        "description": "Binary may include packed or encrypted code",
                        "match_data": [
                            "section name: >|u entropy: 6.934439630498995"
                        ],
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "id": "548",
                        "description": "PE file contains section with special chars",
                        "match_data": [
                            "section name: >|u"
                        ],
                        "severity": "IMPACT_SEVERITY_LOW"
                    },
                    {
                        "id": "975",
                        "description": ".NET source code contains potential unpacker",
                        "match_data": [
                            "Plugin System.Reflection.Assembly.Load(byte[])"
                        ],
                        "severity": "IMPACT_SEVERITY_LOW"
                    }
                ],
                "verdicts": [
                    "MALWARE",
                    "SPREADER",
                    "TROJAN",
                    "EVADER"
                ],
                "has_pcap": false,
                "behash": "97fcf127e59e2213d619bc3197c80707",
                "mitre_attack_techniques": [
                    {
                        "id": "T1091",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "May infect USB drives",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "526"
                            }
                        ]
                    },
                    {
                        "id": "T1091",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "signature_description": "Contains functionality to spread to USB devices (.Net source)",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "1365"
                            }
                        ]
                    },
                    {
                        "id": "T1055",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "May try to detect the Windows Explorer process (often used for injection)",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "296"
                            }
                        ]
                    },
                    {
                        "id": "T1562.001",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "signature_description": "Contains functionality to disable the Task Manager (.Net Source)",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "1725"
                            }
                        ]
                    },
                    {
                        "id": "T1027.002",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "Binary may include packed or crypted data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "202"
                            }
                        ]
                    },
                    {
                        "id": "T1027.002",
                        "severity": "IMPACT_SEVERITY_LOW",
                        "signature_description": ".NET source code contains potential unpacker",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "975"
                            }
                        ]
                    },
                    {
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "Binary may include packed or crypted data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "202"
                            }
                        ]
                    },
                    {
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "May try to detect the Windows Explorer process (often used for injection)",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "296"
                            }
                        ]
                    },
                    {
                        "id": "T1120",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "Sample is looking for USB drives. Launch the sample with the USB Fake Disk cookbook",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "716"
                            }
                        ]
                    }
                ],
                "verdict_confidence": 72,
                "verdict_labels": [
                    "Njrat"
                ],
                "has_html_report": true
            }
        }
    ],
    "meta": {
        "count": 5
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/e10057cbc98b12819a4a3a41f68281398a3f18f0a411019e7f069b31a11395fc/behaviours?limit=10"
    }
}