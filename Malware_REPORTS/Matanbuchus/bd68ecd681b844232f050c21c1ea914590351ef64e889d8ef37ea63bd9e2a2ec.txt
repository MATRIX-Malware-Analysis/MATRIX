{
    "data": [
        {
            "id": "bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_C2AE"
            },
            "attributes": {
                "last_modification_date": 1655519793,
                "has_evtx": false,
                "analysis_date": 1655433340,
                "has_memdump": false,
                "verdicts": [
                    "UNKNOWN_VERDICT"
                ],
                "processes_terminated": [
                    "wmiadap.exe /F /T /R"
                ],
                "sandbox_name": "C2AE",
                "behash": "7eb58e30b74038daa9b31b5d9df78cf2",
                "has_html_report": false,
                "has_pcap": false,
                "processes_tree": [
                    {
                        "process_id": "2848",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2888",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2568",
                        "name": "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483"
                    }
                ]
            }
        },
        {
            "id": "bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_CAPA"
            },
            "attributes": {
                "last_modification_date": 1682950550,
                "has_evtx": false,
                "analysis_date": 1682950550,
                "has_memdump": false,
                "sandbox_name": "CAPA",
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480",
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get process heap force flags"
                            }
                        ],
                        "signature_description": "get process heap force flags",
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "access PEB ldr_data"
                            }
                        ],
                        "signature_description": "access PEB ldr_data",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ],
                        "signature_description": "contain obfuscated stackstrings",
                        "id": "T1027.005",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get process heap flags"
                            }
                        ],
                        "signature_description": "get process heap flags",
                        "id": "T1057",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "resolve function by FNV-1a hash"
                            }
                        ],
                        "signature_description": "resolve function by FNV-1a hash",
                        "id": "T1027.005",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "parse PE header"
                            }
                        ],
                        "signature_description": "parse PE header",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get number of processors"
                            }
                        ],
                        "signature_description": "get number of processors",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using RC4 PRGA"
                            }
                        ],
                        "signature_description": "encrypt data using RC4 PRGA",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_html_report": false,
                "has_pcap": false,
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n",
                        "name": "calculate modulo 256 via x86 assembly",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "description": "host-interaction/file-system",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n",
                        "authors": [
                            "blas.kojusner@mandiant.com",
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "reference absolute stream path on Windows"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "description": "host-interaction/process",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get process heap force flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_ForceFlags.cpp#L14\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x44 = ProcessHeap->ForceFlags >= Vista\n            - number: 0x10 = ProcessHeap->ForceFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x74 = ProcessHeap->ForceFlags >= Vista\n            - number: 0x18 = ProcessHeap->ForceFlags < Vista\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "get process heap force flags"
                    },
                    {
                        "description": "linking/runtime-linking",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm"
                            },
                            {
                                "ref": "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "access PEB ldr_data"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n",
                        "name": "contain obfuscated stackstrings",
                        "description": "anti-analysis/obfuscation/string/stackstring"
                    },
                    {
                        "description": "anti-analysis/anti-debugging/debugger-detection",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "Practical Malware Analysis, Chapter 16, p. 353"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: check for PEB BeingDebugged flag\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block BeingDebugged [B0001.035]\n    references:\n      - Practical Malware Analysis, Chapter 16, p. 353\n    examples:\n      - Practical Malware Analysis Lab 16-01.exe_:0x403530\n  features:\n    - and:\n      - match: PEB access\n      - offset: 2 = PEB.BeingDebugged\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "check for PEB BeingDebugged flag"
                    },
                    {
                        "description": "host-interaction/process",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get process heap flags\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: basic block\n    att&ck:\n      - Discovery::Process Discovery [T1057]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiDebug/ProcessHeap_Flags.cpp#L13\n    examples:\n      - al-khaser_x86.exe_:0x425470\n  features:\n    - and:\n      - match: PEB access\n      - or:\n        - and:\n          - arch: i386\n          - number: 0x18 = PEB->ProcessHeap\n          - or:\n            - number: 0x40 = ProcessHeap->HeapFlags >= Vista\n            - number: 0xC = ProcessHeap->HeapFlags < Vista\n        - and:\n          - arch: amd64\n          - number: 0x30 = PEB->ProcessHeap\n          - or:\n            - number: 0x70 = ProcessHeap->HeapFlags >= Vista\n            - number: 0x14 = ProcessHeap->HeapFlags < Vista\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "get process heap flags"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "description": "linking/runtime-linking : known import name hashes calculated using the non-cryptographic FNV-1a hashing algorithm",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://blog.xorhex.com/blog/reddeltaplugxchangeup/"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by FNV-1a hash\n    namespace: linking/runtime-linking\n    authors:\n      - still@teamt5.org\n    description: known import name hashes calculated using the non-cryptographic FNV-1a hashing algorithm\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    references:\n      - https://blog.xorhex.com/blog/reddeltaplugxchangeup/\n  features:\n    - or:\n      - number: 0x53b2070f = FNV(LoadLibraryA)\n      - number: 0xfaba0065 = FNV(CloseHandle)\n      - number: 0x03285501 = FNV(VirtualAlloc)\n      - number: 0x820621f3 = FNV(VirtualProtect)\n      - number: 0xf8f45725 = FNV(GetProcAddress)\n      - number: 0xbdcac9ce = FNV(CreateFileA)\n      - number: 0xafcab3c4 = FNV(CreateFileW)\n      - number: 0x54fcc943 = FNV(ReadFile)\n      - number: 0x2fa62ca8 = FNV(Sleep)\n",
                        "authors": [
                            "still@teamt5.org"
                        ],
                        "name": "resolve function by FNV-1a hash"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n",
                        "name": "parse PE header",
                        "description": "load-code/pe"
                    },
                    {
                        "description": "data-manipulation/hashing/fnv : can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function"
                            },
                            {
                                "ref": "http://isthe.com/chongo/tech/comp/fnv/"
                            },
                            {
                                "ref": "https://create.stephan-brumme.com/fnv-hash/"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using fnv\n    namespace: data-manipulation/hashing/fnv\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    description: can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0\n    scope: function\n    mbc:\n      - Data::Non-Cryptographic Hash::FNV [C0030.005]\n    references:\n      - https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n      - http://isthe.com/chongo/tech/comp/fnv/\n      - https://create.stephan-brumme.com/fnv-hash/\n    examples:\n      - ad4229879180e267f431ac6666b6a0a2:0x14007B4D4\n  features:\n    - and:\n      - optional:\n        - characteristic: loop\n        - number: 0xcbf29ce484222325 = FNV_offset_basis, unused by FNV-0\n        - number: 0x811c9dc5 = FNV_offset_basis, unused by FNV-0\n      - or:\n        - number: 0x100000001b3 = FNV prime\n        - number: 0x01000193 = FNV prime\n      - basic block:\n        # FNV-1 hash does multiply then XOR\n        # FNV-1a hash does XOR then multiply\n        - and:\n          - characteristic: nzxor\n          - or:\n            - mnemonic: imul\n            - mnemonic: mul\n",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "@_re_fox",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "hash data using fnv"
                    },
                    {
                        "description": "data-manipulation/hmac",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://tools.ietf.org/html/rfc2104"
                            },
                            {
                                "ref": "https://tools.ietf.org/html/rfc4634"
                            },
                            {
                                "ref": "https://github.com/ogay/hmac"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: authenticate HMAC\n    namespace: data-manipulation/hmac\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    mbc:\n      - Cryptography::Hashed Message Authentication Code [C0061]\n    references:\n      - https://tools.ietf.org/html/rfc2104\n      - https://tools.ietf.org/html/rfc4634\n      - https://github.com/ogay/hmac\n    examples:\n      - mimikatz.exe_:0x403408\n  features:\n    - and:\n      # block-sized inner padding, consisting of repeated bytes valued 0x36\n      - number: 0x36 = inner padding byte value\n      # block-sized outer padding, consisting of repeated bytes valued 0x5c\n      - number: 0x5C = outer padding byte value\n      - match: contain loop\n      - count(characteristic(nzxor)): 2 or more\n      - optional:\n        - description: block size\n        - number: 64 = MD5, SHA-1, SHA-224, or SHA-256\n        - number: 128 = SHA-384 or SHA-512\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "authenticate HMAC"
                    },
                    {
                        "description": "host-interaction/hardware/cpu",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - or:\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x64 = PEB->NumberOfProcessors\n          - and:\n            - arch: amd64\n            - number: 0xB8 = PEB->NumberOfProcessors\n      - property/read: System.Environment::ProcessorCount\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "name": "get number of processors"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n",
                        "name": "encrypt data using RC4 PRGA",
                        "description": "data-manipulation/encryption/rc4"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: print debug messages\n    namespace: host-interaction/log/debug/write-event\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - or:\n      - api: DbgPrint\n      - api: kernel32.OutputDebugString\n",
                        "name": "print debug messages",
                        "description": "host-interaction/log/debug/write-event"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: debug build\n    namespace: executable/pe/debug\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n  features:\n    - or:\n      - string: \"Assertion failed!\"\n      - string: \"Assertion failed:\"\n",
                        "name": "debug build",
                        "description": "executable/pe/debug"
                    }
                ]
            }
        },
        {
            "id": "bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_DAS-Security Orcas",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_DAS-Security Orcas"
            },
            "attributes": {
                "last_modification_date": 1657867363,
                "has_evtx": false,
                "mutexes_created": [
                    "5504\\"
                ],
                "modules_loaded": [
                    "C:\\Windows\\System32\\ntdll.dll",
                    "C:\\Windows\\SysWOW64\\ntdll.dll",
                    "C:\\Windows\\System32\\wow64.dll",
                    "C:\\Windows\\System32\\wow64win.dll",
                    "C:\\Windows\\System32\\wow64cpu.dll",
                    "C:\\Windows\\System32\\kernel32.dll",
                    "C:\\Windows\\SysWOW64\\kernel32.dll",
                    "C:\\Windows\\System32\\user32.dll",
                    "C:\\Windows\\SysWOW64\\KernelBase.dll",
                    "C:\\Windows\\SysWOW64\\shell32.dll",
                    "C:\\Windows\\SysWOW64\\msvcrt.dll",
                    "C:\\Windows\\SysWOW64\\shlwapi.dll",
                    "C:\\Windows\\SysWOW64\\gdi32.dll",
                    "C:\\Windows\\SysWOW64\\user32.dll",
                    "C:\\Windows\\SysWOW64\\advapi32.dll",
                    "C:\\Windows\\SysWOW64\\sechost.dll",
                    "C:\\Windows\\SysWOW64\\rpcrt4.dll",
                    "C:\\Windows\\SysWOW64\\sspicli.dll",
                    "C:\\Windows\\SysWOW64\\cryptbase.dll",
                    "C:\\Windows\\SysWOW64\\lpk.dll",
                    "C:\\Windows\\SysWOW64\\usp10.dll",
                    "C:\\Windows\\SysWOW64\\ole32.dll",
                    "C:\\Windows\\SysWOW64\\imagehlp.dll",
                    "C:\\Windows\\SysWOW64\\imm32.dll",
                    "C:\\Windows\\SysWOW64\\msctf.dll",
                    "C:\\Windows\\winsxs\\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.24203_none_5c030043a0118fbf\\GdiPlus.dll",
                    "C:\\Windows\\SysWOW64\\dbghelp.dll",
                    "C:\\Windows\\SysWOW64\\ws2_32.dll",
                    "C:\\Windows\\SysWOW64\\nsi.dll",
                    "C:\\Windows\\SysWOW64\\psapi.dll",
                    "C:\\Windows\\SysWOW64\\oleaut32.dll",
                    "C:\\Windows\\SysWOW64\\setupapi.dll",
                    "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                    "C:\\Windows\\SysWOW64\\devobj.dll",
                    "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                    "C:\\Windows\\SysWOW64\\winnsi.dll",
                    "C:\\Windows\\SysWOW64\\api-ms-win-core-synch-l1-2-0.DLL",
                    "C:\\Windows\\SysWOW64\\version.dll",
                    "${SamplePath}\\bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec.dll",
                    "C:\\Windows\\SysWOW64\\wininet.dll",
                    "C:\\Windows\\SysWOW64\\urlmon.dll",
                    "C:\\Windows\\SysWOW64\\crypt32.dll",
                    "C:\\Windows\\SysWOW64\\msasn1.dll",
                    "C:\\Windows\\SysWOW64\\iertutil.dll"
                ],
                "analysis_date": 1657893740,
                "has_memdump": false,
                "registry_keys_opened": [
                    "\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Services\\crypt32",
                    "\\REGISTRY\\MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "\\REGISTRY\\MACHINE\\Software\\Wow6432Node\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                    "\\REGISTRY\\USER\\S-1-5-21-870151485-863566166-2146164720-1000",
                    "\\REGISTRY\\USER\\S-1-5-21-870151485-863566166-2146164720-1000\\Control Panel\\Desktop",
                    "\\REGISTRY\\USER\\S-1-5-21-870151485-863566166-2146164720-1000\\Control Panel\\Desktop\\LanguageConfiguration"
                ],
                "tags": [
                    "RUNTIME_MODULES"
                ],
                "windows_hidden": [
                    "C:\\windows\\system32\\rundll32.exe"
                ],
                "verdicts": [
                    "CLEAN"
                ],
                "processes_terminated": [
                    "C:\\windows\\system32\\rundll32.exe"
                ],
                "sandbox_name": "DAS-Security Orcas",
                "behash": "c8b857958973651abf5dbacdd37b1858",
                "processes_created": [
                    "C:\\windows\\system32\\rundll32.exe"
                ],
                "mitre_attack_techniques": [
                    {
                        "id": "T1129"
                    }
                ],
                "has_html_report": false,
                "has_pcap": false,
                "command_executions": [
                    "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec.dll "
                ],
                "processes_tree": [
                    {
                        "process_id": "3820",
                        "name": "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec.dll "
                    }
                ]
            }
        },
        {
            "id": "bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_Zenbox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec_Zenbox"
            },
            "attributes": {
                "files_written": [
                    "\\Device\\ConDrv\\\\Connect"
                ],
                "last_modification_date": 1658735446,
                "has_evtx": true,
                "mutexes_created": [
                    "\\Sessions\\1\\BaseNamedObjects\\5507\\"
                ],
                "analysis_date": 1655429004,
                "has_memdump": true,
                "verdict_confidence": 2,
                "registry_keys_opened": [
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                    "HKEY_CURRENT_USER_Classes",
                    "HKEY_CURRENT_USER_Classes\\.dll",
                    "HKEY_CURRENT_USER_Classes\\dllfile",
                    "HKEY_CURRENT_USER_Classes\\dllfile\\AutoRegister",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\dllfile\\AutoRegister",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DllNXOptions",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\loaddll32.exe",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\regsvr32.exe",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLE",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLEAUT",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\WindowsStore",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                    "HKEY_LOCAL_MACHINE\\Software\\Classes\\.dll",
                    "HKEY_LOCAL_MACHINE\\Software\\Classes\\dllfile",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\OLE\\Tracing",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                    "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\HwOrder",
                    "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\ProviderOrder",
                    "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings",
                    "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft",
                    "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole",
                    "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties"
                ],
                "tags": [
                    "IDLE"
                ],
                "verdicts": [
                    "CLEAN"
                ],
                "sandbox_name": "Zenbox",
                "behash": "0561e3810cffebbc8be0783cc9e00b41",
                "mitre_attack_techniques": [
                    {
                        "signature_description": "Tries to load missing DLLs",
                        "id": "T1574.002",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Creates a process in suspended mode (likely to inject code)",
                        "id": "T1055",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Spawns processes",
                        "id": "T1055",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Registers a DLL",
                        "id": "T1218.010",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Runs a DLL by calling functions",
                        "id": "T1218.011",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Reads software policies",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_html_report": false,
                "sigma_analysis_results": [
                    {
                        "match_context": [
                            {
                                "values": {
                                    "TerminalSessionId": "0",
                                    "ProcessGuid": "C784477D-2421-629F-5405-000000001F00",
                                    "ProcessId": "4188",
                                    "Product": "Microsoft\u00ae Windows\u00ae Operating System",
                                    "Description": "Windows Command Processor",
                                    "Company": "Microsoft Corporation",
                                    "ParentProcessGuid": "C784477D-240B-629F-3905-000000001F00",
                                    "User": "NT AUTHORITY\\SYSTEM",
                                    "Hashes": "MD5=4E2ACF4F8A396486AB4268C94A6A245F,SHA256=9A7C58BD98D70631AA1473F7B57B426DB367D72429A5455B433A05EE251F3236,IMPHASH=8542FB14699D84D7E8DA92F66145C7FE",
                                    "OriginalFileName": "Cmd.Exe",
                                    "ParentImage": "C:\\Program Files\\rempl\\sedlauncher.exe",
                                    "FileVersion": "10.0.17134.1 (WinBuild.160101.0800)",
                                    "ParentProcessId": "3200",
                                    "CurrentDirectory": "C:\\Windows\\system32\\",
                                    "CommandLine": "C:\\Windows\\System32\\cmd.exe /c C:\\Windows\\System32\\ipconfig.exe /flushdns >C:\\Windows\\TEMP\\ipconfig.out 2>&1",
                                    "EventID": "1",
                                    "LogonGuid": "C784477D-2356-629F-E703-000000000000",
                                    "LogonId": "999",
                                    "Image": "C:\\Windows\\System32\\cmd.exe",
                                    "IntegrityLevel": "System",
                                    "ParentCommandLine": "\"C:\\Program Files\\rempl\\sedlauncher.exe\"",
                                    "UtcTime": "2022-06-07 10:10:41.737",
                                    "RuleName": "-"
                                }
                            },
                            {
                                "values": {
                                    "TerminalSessionId": "0",
                                    "ProcessGuid": "C784477D-2421-629F-5705-000000001F00",
                                    "ProcessId": "4872",
                                    "Product": "Microsoft\u00ae Windows\u00ae Operating System",
                                    "Description": "Windows Command Processor",
                                    "Company": "Microsoft Corporation",
                                    "ParentProcessGuid": "C784477D-240B-629F-3905-000000001F00",
                                    "User": "NT AUTHORITY\\SYSTEM",
                                    "Hashes": "MD5=4E2ACF4F8A396486AB4268C94A6A245F,SHA256=9A7C58BD98D70631AA1473F7B57B426DB367D72429A5455B433A05EE251F3236,IMPHASH=8542FB14699D84D7E8DA92F66145C7FE",
                                    "OriginalFileName": "Cmd.Exe",
                                    "ParentImage": "C:\\Program Files\\rempl\\sedlauncher.exe",
                                    "FileVersion": "10.0.17134.1 (WinBuild.160101.0800)",
                                    "ParentProcessId": "3200",
                                    "CurrentDirectory": "C:\\Windows\\system32\\",
                                    "CommandLine": "C:\\Windows\\System32\\cmd.exe /c C:\\Windows\\System32\\netsh.exe interface ip delete arpcache >C:\\Windows\\TEMP\\ipconfig.out 2>&1",
                                    "EventID": "1",
                                    "LogonGuid": "C784477D-2356-629F-E703-000000000000",
                                    "LogonId": "999",
                                    "Image": "C:\\Windows\\System32\\cmd.exe",
                                    "IntegrityLevel": "System",
                                    "ParentCommandLine": "\"C:\\Program Files\\rempl\\sedlauncher.exe\"",
                                    "UtcTime": "2022-06-07 10:10:41.771",
                                    "RuleName": "-"
                                }
                            },
                            {
                                "values": {
                                    "TerminalSessionId": "0",
                                    "ProcessGuid": "C784477D-2423-629F-6005-000000001F00",
                                    "ProcessId": "3540",
                                    "Product": "Microsoft\u00ae Windows\u00ae Operating System",
                                    "Description": "Windows Command Processor",
                                    "Company": "Microsoft Corporation",
                                    "ParentProcessGuid": "C784477D-240B-629F-3905-000000001F00",
                                    "User": "NT AUTHORITY\\SYSTEM",
                                    "Hashes": "MD5=4E2ACF4F8A396486AB4268C94A6A245F,SHA256=9A7C58BD98D70631AA1473F7B57B426DB367D72429A5455B433A05EE251F3236,IMPHASH=8542FB14699D84D7E8DA92F66145C7FE",
                                    "OriginalFileName": "Cmd.Exe",
                                    "ParentImage": "C:\\Program Files\\rempl\\sedlauncher.exe",
                                    "FileVersion": "10.0.17134.1 (WinBuild.160101.0800)",
                                    "ParentProcessId": "3200",
                                    "CurrentDirectory": "C:\\Windows\\system32\\",
                                    "CommandLine": "C:\\Windows\\system32\\cmd.exe /c C:\\Windows\\system32\\powercfg.exe /getactivescheme > C:\\Windows\\TEMP\\PowerPlan.log",
                                    "EventID": "1",
                                    "LogonGuid": "C784477D-2356-629F-E703-000000000000",
                                    "LogonId": "999",
                                    "Image": "C:\\Windows\\System32\\cmd.exe",
                                    "IntegrityLevel": "System",
                                    "ParentCommandLine": "\"C:\\Program Files\\rempl\\sedlauncher.exe\"",
                                    "UtcTime": "2022-06-07 10:10:43.488",
                                    "RuleName": "-"
                                }
                            },
                            {
                                "values": {
                                    "TerminalSessionId": "0",
                                    "ProcessGuid": "C784477D-2423-629F-6305-000000001F00",
                                    "ProcessId": "3444",
                                    "Product": "Microsoft\u00ae Windows\u00ae Operating System",
                                    "Description": "Windows Command Processor",
                                    "Company": "Microsoft Corporation",
                                    "ParentProcessGuid": "C784477D-240B-629F-3905-000000001F00",
                                    "User": "NT AUTHORITY\\SYSTEM",
                                    "Hashes": "MD5=4E2ACF4F8A396486AB4268C94A6A245F,SHA256=9A7C58BD98D70631AA1473F7B57B426DB367D72429A5455B433A05EE251F3236,IMPHASH=8542FB14699D84D7E8DA92F66145C7FE",
                                    "OriginalFileName": "Cmd.Exe",
                                    "ParentImage": "C:\\Program Files\\rempl\\sedlauncher.exe",
                                    "FileVersion": "10.0.17134.1 (WinBuild.160101.0800)",
                                    "ParentProcessId": "3200",
                                    "CurrentDirectory": "C:\\Windows\\system32\\",
                                    "CommandLine": "C:\\Windows\\system32\\cmd.exe /c C:\\Windows\\system32\\powercfg.exe /query 381b4222-f694-41f0-9685-ff5bb260df2e > C:\\Windows\\TEMP\\HighPerformancePlan.log",
                                    "EventID": "1",
                                    "LogonGuid": "C784477D-2356-629F-E703-000000000000",
                                    "LogonId": "999",
                                    "Image": "C:\\Windows\\System32\\cmd.exe",
                                    "IntegrityLevel": "System",
                                    "ParentCommandLine": "\"C:\\Program Files\\rempl\\sedlauncher.exe\"",
                                    "UtcTime": "2022-06-07 10:10:43.542",
                                    "RuleName": "-"
                                }
                            }
                        ],
                        "rule_level": "high",
                        "rule_id": "f9333cf120369debd56e4e238fffa10bdb2a1497c11e08a082befd02f9f3bdf2",
                        "rule_source": "SOC Prime Threat Detection Marketplace",
                        "rule_title": "File deletion via CMD (via cmdline)",
                        "rule_description": "Detects \"cmd\" utilization to self-delete files in some critical Windows destinations.",
                        "rule_author": "Ariel Millahuel"
                    },
                    {
                        "match_context": [
                            {
                                "values": {
                                    "EventID": "5038",
                                    "param1": "\\Device\\HarddiskVolume4\\Program Files (x86)\\sandbox\\driver\\sandbox-driver.sys"
                                }
                            }
                        ],
                        "rule_level": "low",
                        "rule_id": "134564d292d785dff102940b8a1ee06dba2d462c5fb852124b3771a49d7885f1",
                        "rule_source": "Sigma Integrated Rule Set (GitHub)",
                        "rule_title": "Failed Code Integrity Checks",
                        "rule_description": "Code integrity failures may indicate tampered executables.",
                        "rule_author": "Thomas Patzke"
                    },
                    {
                        "match_context": [
                            {
                                "values": {
                                    "TerminalSessionId": "0",
                                    "ProcessGuid": "C784477D-2423-629F-5D05-000000001F00",
                                    "ProcessId": "5712",
                                    "Product": "Microsoft\u00ae Windows\u00ae Operating System",
                                    "Description": "Dism Host Servicing Process",
                                    "Company": "Microsoft Corporation",
                                    "ParentProcessGuid": "C784477D-240B-629F-3905-000000001F00",
                                    "User": "NT AUTHORITY\\SYSTEM",
                                    "Hashes": "MD5=2A1EE8DF1DD0335605DCC5015C60EBC0,SHA256=3344BE53D32153DCEF6A732E3BFF41AB2418F1B91F268567EB577314E34AA500,IMPHASH=8284817BCE2852A54A728AF71A282BBA",
                                    "OriginalFileName": "DismHost.exe",
                                    "ParentImage": "C:\\Program Files\\rempl\\sedlauncher.exe",
                                    "FileVersion": "10.0.17134.1 (WinBuild.160101.0800)",
                                    "ParentProcessId": "3200",
                                    "CurrentDirectory": "C:\\Windows\\system32\\",
                                    "CommandLine": "C:\\Windows\\TEMP\\BD342E41-5368-4312-A0A0-F4EBBFBD0066\\dismhost.exe {7570505E-6068-4499-80B7-8FE2753EA5A1}",
                                    "EventID": "1",
                                    "LogonGuid": "C784477D-2356-629F-E703-000000000000",
                                    "LogonId": "999",
                                    "Image": "C:\\Windows\\Temp\\BD342E41-5368-4312-A0A0-F4EBBFBD0066\\DismHost.exe",
                                    "IntegrityLevel": "System",
                                    "ParentCommandLine": "\"C:\\Program Files\\rempl\\sedlauncher.exe\"",
                                    "UtcTime": "2022-06-07 10:10:43.221",
                                    "RuleName": "-"
                                }
                            }
                        ],
                        "rule_level": "low",
                        "rule_id": "539d657ea3dfb52773cd8616d93fd64ba9112091984d1c3eb044c6e5dadd2c5c",
                        "rule_source": "Sigma Integrated Rule Set (GitHub)",
                        "rule_title": "Process Start From Suspicious Folder",
                        "rule_description": "Detects process start from rare or uncommon folders like temporary folder or folders that usually don't contain executable files",
                        "rule_author": "frack113"
                    },
                    {
                        "match_context": [
                            {
                                "values": {
                                    "EventID": "4104",
                                    "ScriptBlockText": "PnPEntity\"\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif(($pr.Name -eq \"DeviceId\" -or $pr.Name -eq \"Caption\" -or $pr.Name -eq \"Name\" -or $pr.Name -eq \"PNPDeviceID\"  -or $pr.Name -eq \"Service\") -and ($pr.Value -match 'VEN_80EE' -or $pr.Value -match 'VEN_15AD' -or $pr.Value -match 'VBOX' -or $pr.Value -match 'VBox' -or $pr.Value -match 'VMWARE' -or $pr.Value -match '82801FB' -or $pr.Value -match '82441FX' -or $pr.Value -match '82371SB' -or $pr.Value -match 'OpenHCD'))\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789_'\r\n\t\t\t$value = $pr.Value.replace(\"VEN_80EE\", $value).replace(\"VEN_15AD\", $value).replace(\"VBOX\", $value).replace(\"VBox\", $value).replace(\"VMWARE\", $value).replace(\"82801FB\", $value).replace(\"82441FX\", $value).replace(\"82371SB\", $value).replace(\"OpenHCD\", $value)\r\n\t\t\t\r\n\t\t\t# 82801FB 82441FX 82371SB OpenHCD\r\n\t\t\t\t\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t\t\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_PnPEntity -Arguments $args\r\n}\r\n\r\n#Joebox\r\n\r\n#Creating Win32_DiskDrive fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_DiskDrive\";\r\n$newClass.Qualifiers.Add(\"Static\", $true);\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_DiskDrive\"\r\n\r\nif(-Not ($objWMi -is [array]))\r\n{\r\n\t$objWMi = @($objWMi)\r\n}\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif(($pr.Name -eq \"DeviceId\" -or $pr.Name -eq \"Caption\" -or $pr.Name -eq \"Model\" -or $pr.Name -eq \"PNPDeviceID\") -and ($pr.Value -match 'VBOX' -or $pr.Value -match 'VBox' -or $pr.Value -match 'VMWARE' -or $pr.Value -match 'VMware'))\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789_'\r\n\t\t\t$value = $pr.Value.replace(\"VBOX\", $value).replace(\"VBox\", $value).replace(\"VMWARE\", $value).replace(\"VMware Virtual disk\", $value).replace(\"VMware\", $value).replace(\"HARDDISK\", \"WDC\").replace(\"VIRTUAL_DISK\", $value)\r\n\t\t\t\t\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t\r\n\t\t# Change disk size\r\n\t\t} elseif($pr.Name -eq \"Size\" -and $pr.Value -lt 200000000000)\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, 412300001200)\r\n\t\t} elseif(-Not($pr.Name -eq \"Capabilities\"))\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_DiskDrive -Arguments $args\r\n}\r\n\r\n#Joebox\r\n\r\n#Creating Win32_VideoController fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_VideoController\";\r\n$newClass.Qualifiers.Add(\"Static\", $true);\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_VideoController\"\r\n\r\nif(-Not ($objWMi -is [array]))\r\n{\r\n\t$objWMi = @($objWMi)\r\n}\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif(($pr.Name -eq \"Caption\" -or $pr.Name -eq \"Name\" -or $pr.Name -eq \"PNPDeviceID\" -or $pr.Name -eq \"AdapterCompatibility\" -or $pr.Name -eq \"Description\" -or $pr.Name -eq \"InfSection\" -or $pr.Name -eq \"VideoProcessor\") -and ($pr.Value -match 'VBOX' -or $pr.Value -match 'VBox' -or $pr.Value -match 'VMWARE' -or $pr.Value -match 'VirtualBox' -or $pr.Value -match 'VMware' -or $pr.Value -match 'Oracle Corporation' -or $pr.Value -match 'Microsoft Basic Display Adapter'))\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789_'\r\n\t\t\t$value = $pr.Value.replace(\"VBOX\", $value).replace(\"VBox\", $value).replace(\"VMWARE\", $value).replace(\"VMware\", $value).replace(\"VirtualBox\", $value).replace(\"Oracle Corporation\", $value).replace(\"Microsoft Basic Display Adapter\", $value)\r\n\t\t\t\t\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t\r\n\r\n\t\t} elseif($pr.Name -eq \"DriverVersion\")\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters '1234567890.'\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t} elseif($pr.Name -eq \"AdapterRAM\" -and $pr.Value -lt 1000000000)\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, 1073741824)\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_VideoController -Arguments $args\r\n}\r\n\r\n#Joebox\r\n\r\n#Creating Win32_BaseBoard fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_BaseBoard\";\r\n$newClass.Qualifiers.Add(\"Static\", $true)\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_BaseBoard\"\r\n\r\nforeach ($obj in $objWmi)\r\n{\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\r\n\t\tif($pr.Name -eq \"Name\")\r\n\t\t{\t$value = Get-RandomCharacters -length 10 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789'\r\n\r\n\t\t\t$newClass.Properties.Add($pr.Name, $value, $pr.Type)\r\n\t\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t\t} elseif($pr.Name -eq \"Product\" -or $pr.Name -eq \"Manufacturer\")\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 10 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789'\r\n\t\t\t$newClass.Properties.Add($pr.Name, $value, $pr.Type)\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.Value, $pr.Type)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$newClass.Put()\r\nSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_BaseBoard\r\n\r\n\r\n#Creating Win32_ComputerSystemProduct fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_ComputerSystemProduct\";\r\n$newClass.Qualifiers.Add(\"Static\", $true)\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_ComputerSystemProduct\"\r\n\r\nforeach ($obj in $objWmi)\r\n{\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\r\n\t\tif($pr.Name -eq \"Name\")\r\n\t\t{\t\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.$value, $pr.Type)\r\n\t\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t\t} elseif($pr.Name -eq \"IdentifyingNumber\")\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 6 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789'\r\n\t\t\t$newClass.Properties.Add($pr.Name, $value, $pr.Type)\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.Value, $pr.Type)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$newClass.Put()\r\nSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_ComputerSystemProduct\r\n\r\n\r\n\r\n#Creating Win32_LogicalDisk fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_LogicalDisk\";\r\n$newClass.Qualifiers.Add(\"Static\", $true);\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_LogicalDisk WHERE DriveType = 3\"\r\n\r\nif(-Not ($objWMi -is [array]))\r\n{\r\n\t$objWMi = @($objWMi)\r\n}\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif($pr.Name -eq \"Size\")\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, \"223496729601\")\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_LogicalDisk -Arguments $args\r\n}\r\n\r\n\r\n#Creating Win32_ComputerSystemProduct fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_OperatingSystem\";\r\n$newClass.Qualifiers.Add(\"Static\", $true)\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_OperatingSystem\"\r\n\r\n\r\nforeach ($obj in $objWmi)\r\n{\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\r\n\t\tif($pr.Name -eq \"CreationClassName\")\r\n\t\t{\t\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.$value, $pr.Type)\r\n\t\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t\t} elseif($pr.Name -eq \"LastBootUpTime\")\r\n\t\t{\r\n\t\t\t$d = [System.Management.ManagementDateTimeConverter]::ToDateTime($pr.Value)\r\n\t\t\t$d = $d.addDays(-10)\r\n\t\t\t$d = [System.Management.ManagementDateTimeConverter]::ToDmtfDateTime($d)\r\n\t\t\t\r\n\t\t\t$newClass.Properties.Add($pr.Name, $d, $pr.Type)\r\n\t\t\t\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.Value, $pr.Type)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$newClass.Put()\r\nSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_OperatingSystem\r\n\r\n\r\nfunction Delete() {\r\n    $Invocation = (Get-Variable MyInvocation -Scope 1).Value\r\n    $Path =  $Invocation.MyCommand.Path \r\n    Write-Host $Path\r\n    Remove-Item $Path -force\r\n} \r\n     \r\nDelete \r\n",
                                    "ScriptBlockId": "dfbe833d-ee8b-469b-8de3-409b1b6f1822",
                                    "MessageNumber": "\u0002",
                                    "MessageTotal": "\u0002",
                                    "Path": "C:\\Program Files (x86)\\Joebox\\unpack\\wmievasions.ps1"
                                }
                            }
                        ],
                        "rule_level": "low",
                        "rule_id": "d9b2eb00753c3049fbb4ed4f7d88f29b65a0c50bec45ff4723b95bb637f8f83d",
                        "rule_source": "Sigma Integrated Rule Set (GitHub)",
                        "rule_title": "Use Remove-Item to Delete File",
                        "rule_description": "Powershell Remove-Item  with -Path to delete a file or a folder with \"-Recurse\"",
                        "rule_author": "frack113"
                    }
                ],
                "has_pcap": true,
                "files_opened": [
                    "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                    "C:\\Users\\user\\Desktop\\attachment.dll",
                    "C:\\Users\\user\\Desktop\\attachment.dll.123.Manifest",
                    "C:\\Users\\user\\Desktop\\attachment.dll.124.Manifest",
                    "C:\\Users\\user\\Desktop\\attachment.dll.2.Manifest",
                    "C:\\Windows\\AppPatch\\sysmain.sdb",
                    "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                    "C:\\Windows\\SysWOW64\\",
                    "C:\\Windows\\SysWOW64\\AcLayers.DLL",
                    "C:\\Windows\\SysWOW64\\AcLayers.dll",
                    "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                    "C:\\Windows\\SysWOW64\\FLTLIB.DLL",
                    "C:\\Windows\\SysWOW64\\GDI32.dll",
                    "C:\\Windows\\SysWOW64\\IMM32.DLL",
                    "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                    "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                    "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                    "C:\\Windows\\SysWOW64\\MPR.dll",
                    "C:\\Windows\\SysWOW64\\MSCTF.dll",
                    "C:\\Windows\\SysWOW64\\OLEAUT32.dll",
                    "C:\\Windows\\SysWOW64\\PROPSYS.dll",
                    "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                    "C:\\Windows\\SysWOW64\\SETUPAPI.dll",
                    "C:\\Windows\\SysWOW64\\SHELL32.dll",
                    "C:\\Windows\\SysWOW64\\SHLWAPI.dll",
                    "C:\\Windows\\SysWOW64\\Shell32.dll",
                    "C:\\Windows\\SysWOW64\\SspiCli.dll",
                    "C:\\Windows\\SysWOW64\\USER32.dll",
                    "C:\\Windows\\SysWOW64\\WINSPOOL.DRV",
                    "C:\\Windows\\SysWOW64\\WS2_32.dll",
                    "C:\\Windows\\SysWOW64\\Wininet.dll",
                    "C:\\Windows\\SysWOW64\\advapi32.dll",
                    "C:\\Windows\\SysWOW64\\apphelp.dll",
                    "C:\\Windows\\SysWOW64\\bcrypt.dll",
                    "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                    "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                    "C:\\Windows\\SysWOW64\\combase.dll",
                    "C:\\Windows\\SysWOW64\\dwmapi.dll",
                    "C:\\Windows\\SysWOW64\\en-US\\regsvr32.exe.mui",
                    "C:\\Windows\\SysWOW64\\en-US\\rundll32.exe.mui",
                    "C:\\Windows\\SysWOW64\\gdi32full.dll",
                    "C:\\Windows\\SysWOW64\\imagehlp.dll",
                    "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
                    "C:\\Windows\\SysWOW64\\loaddll32.exe",
                    "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                    "C:\\Windows\\SysWOW64\\msvcrt.dll",
                    "C:\\Windows\\SysWOW64\\ntdll.dll",
                    "C:\\Windows\\SysWOW64\\ole32.dll",
                    "C:\\Windows\\SysWOW64\\powrprof.dll",
                    "C:\\Windows\\SysWOW64\\profapi.dll",
                    "C:\\Windows\\SysWOW64\\regsvr32.exe",
                    "C:\\Windows\\SysWOW64\\rundll32.exe",
                    "C:\\Windows\\SysWOW64\\sechost.dll",
                    "C:\\Windows\\SysWOW64\\sfc.dll",
                    "C:\\Windows\\SysWOW64\\sfc_os.DLL",
                    "C:\\Windows\\SysWOW64\\shcore.dll",
                    "C:\\Windows\\SysWOW64\\shlwapi.dll",
                    "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                    "C:\\Windows\\SysWOW64\\uxtheme.dll",
                    "C:\\Windows\\SysWOW64\\win32u.dll",
                    "C:\\Windows\\SysWOW64\\windows.storage.dll",
                    "\\Device\\KsecDD",
                    "C:\\Users\\user\\Desktop\\library.dll",
                    "C:\\Users\\user\\Desktop\\library.dll.123.Manifest",
                    "C:\\Users\\user\\Desktop\\library.dll.124.Manifest",
                    "C:\\Users\\user\\Desktop\\library.dll.2.Manifest",
                    "C:\\Users\\user\\Desktop\\readme.dll",
                    "C:\\Users\\user\\Desktop\\readme.dll.123.Manifest",
                    "C:\\Users\\user\\Desktop\\readme.dll.124.Manifest",
                    "C:\\Users\\user\\Desktop\\readme.dll.2.Manifest"
                ],
                "processes_tree": [
                    {
                        "process_id": "6876",
                        "name": "C:\\Windows\\System32\\loaddll32.exe loaddll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\"",
                        "children": [
                            {
                                "process_id": "6800",
                                "name": "C:\\Windows\\SysWOW64\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\attachment.dll\",#1",
                                "children": [
                                    {
                                        "process_id": "5560",
                                        "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\attachment.dll\",#1"
                                    }
                                ]
                            },
                            {
                                "process_id": "7816",
                                "name": "C:\\Windows\\SysWOW64\\regsvr32.exe regsvr32.exe /s C:\\Users\\user\\Desktop\\attachment.dll"
                            },
                            {
                                "process_id": "6048",
                                "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,DllRegisterServer"
                            },
                            {
                                "process_id": "4760",
                                "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\attachment.dll,DllUnregisterServer"
                            }
                        ]
                    }
                ]
            }
        }
    ],
    "meta": {
        "count": 4
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/bd68ecd681b844232f050c21c1ea914590351ef64e889d8ef37ea63bd9e2a2ec/behaviours?limit=10"
    }
}