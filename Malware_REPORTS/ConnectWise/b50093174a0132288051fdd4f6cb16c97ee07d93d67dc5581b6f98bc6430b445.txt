{
    "data": [
        {
            "id": "b50093174a0132288051fdd4f6cb16c97ee07d93d67dc5581b6f98bc6430b445_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/b50093174a0132288051fdd4f6cb16c97ee07d93d67dc5581b6f98bc6430b445_CAPA"
            },
            "attributes": {
                "has_evtx": false,
                "last_modification_date": 1716989287,
                "analysis_date": 1716989287,
                "behash": "c77182b946d4a31538c0ef20798e068e",
                "mitre_attack_techniques": [
                    {
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO",
                        "signature_description": "link function at runtime on Windows",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ]
                    }
                ],
                "has_memdump": false,
                "mbc": [
                    {
                        "id": "C0016",
                        "objective": "File System",
                        "behavior": "Create File",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open file"
                            }
                        ]
                    },
                    {
                        "id": "B0023",
                        "objective": "Execution",
                        "behavior": "Install Additional Program",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "contain an embedded PE file"
                            }
                        ]
                    }
                ],
                "has_html_report": false,
                "has_pcap": false,
                "sandbox_name": "CAPA",
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "extract resource via kernel32 functions",
                        "description": "executable/resource",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "load Windows Common Language Runtime",
                        "description": "load-code/dotnet",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "blas.kojusner@mandiant.com",
                            "jakub.jozwiak@mandiant.com"
                        ],
                        "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: load Windows Common Language Runtime\n    namespace: load-code/dotnet\n    authors:\n      - michael.hunhoff@mandiant.com\n      - blas.kojusner@mandiant.com\n      - jakub.jozwiak@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported\n    references:\n      - https://modexp.wordpress.com/2019/05/10/dotnet-loader-shellcode/\n      - https://github.com/TheWover/donut/blob/master/loader/inmem_dotnet.c\n    examples:\n      - 6CD1315F6F2FA4F8EE2B98BB3CA0A994:0x140001030\n  features:\n    - or:\n      - and:\n        - description: .NET Framework versions 2.0, 3.0, 3.5\n        - or:\n          - api: mscoree.CorBindToRuntime\n          - api: mscoree.CorBindToRuntimeEx\n          - api: mscoree.CorBindToRuntimeHost\n          - api: mscoree.CorBindToRuntimeByCfg\n          - api: mscoree.CorBindToCurrentRuntime\n          - api: ole32.CoCreateInstance\n          - and:\n            - or:\n              - string: \"CorBindToRuntime\"\n              - string: \"CorBindToRuntimeEx\"\n              - string: \"CorBindToRuntimeHost\"\n              - string: \"CorBindToRuntimeByCfg\"\n              - string: \"CorBindToCurrentRuntime\"\n              - string: \"CoCreateInstance\"\n            - match: link function at runtime on Windows\n        - bytes: 23 67 2F CB 3A AB D2 11 9C 40 00 C0 4F A3 0A 3E = CLSID_CorRuntimeHost\n        - bytes: 22 67 2F CB 3A AB D2 11 9C 40 00 C0 4F A3 0A 3E = IID_ICorRuntimeHost\n      - and:\n        - description: .NET Framework version 4.x\n        - or:\n          - api: mscoree.CLRCreateInstance\n          - and:\n            - string: \"CLRCreateInstance\"\n            - match: link function at runtime on Windows\n        - bytes: 8D 18 80 92 8E 0E 67 48 B3 0C 7F A8 38 84 E8 DE = CLSID_CLRMetaHost\n        - bytes: 9E DB 32 D3 B3 B9 25 41 82 07 A1 48 84 F5 32 16 = IID_ICLRMetaHost\n",
                        "refs": [
                            {
                                "ref": "https://modexp.wordpress.com/2019/05/10/dotnet-loader-shellcode/"
                            },
                            {
                                "ref": "https://github.com/TheWover/donut/blob/master/loader/inmem_dotnet.c"
                            }
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "contain an embedded PE file",
                        "description": "executable/subfile/pe",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "name": "contains PDB path",
                        "description": "executable/pe/pdb",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n"
                    }
                ]
            }
        },
        {
            "id": "b50093174a0132288051fdd4f6cb16c97ee07d93d67dc5581b6f98bc6430b445_Yomi Hunter",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/b50093174a0132288051fdd4f6cb16c97ee07d93d67dc5581b6f98bc6430b445_Yomi Hunter"
            },
            "attributes": {
                "has_evtx": false,
                "last_modification_date": 1717019140,
                "analysis_date": 1717019116,
                "behash": "db4b4edf2841e268af5242734497c19b",
                "mitre_attack_techniques": [
                    {
                        "id": "T1063",
                        "signature_description": "It Tries to detect injection methods"
                    }
                ],
                "has_memdump": false,
                "has_html_report": true,
                "has_pcap": true,
                "sandbox_name": "Yomi Hunter",
                "verdicts": [
                    "MALWARE"
                ]
            }
        }
    ],
    "meta": {
        "count": 2
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/b50093174a0132288051fdd4f6cb16c97ee07d93d67dc5581b6f98bc6430b445/behaviours?limit=10"
    }
}