{
    "data": [
        {
            "id": "9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_C2AE"
            },
            "attributes": {
                "analysis_date": 1708493095,
                "processes_tree": [
                    {
                        "process_id": "2208",
                        "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                    },
                    {
                        "process_id": "2792",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2836",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2572",
                        "name": "%SAMPLEPATH%"
                    }
                ],
                "sandbox_name": "C2AE",
                "last_modification_date": 1708611932,
                "has_html_report": false,
                "verdicts": [
                    "UNKNOWN_VERDICT"
                ],
                "has_evtx": false,
                "behash": "fe66e54118bb12b06dcbabb6c2d17206",
                "has_pcap": false,
                "processes_terminated": [
                    "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                    "wmiadap.exe /F /T /R",
                    "%SAMPLEPATH%"
                ],
                "has_memdump": false,
                "command_executions": [
                    "%SAMPLEPATH%"
                ]
            }
        },
        {
            "id": "9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_CAPA"
            },
            "attributes": {
                "analysis_date": 1708491938,
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "access PEB ldr_data"
                            }
                        ],
                        "signature_description": "access PEB ldr_data",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ],
                        "signature_description": "link function at runtime on Windows",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "parse PE header"
                            }
                        ],
                        "signature_description": "parse PE header",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "mbc": [
                    {
                        "objective": "Memory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "allocate memory"
                            }
                        ],
                        "id": "C0007",
                        "behavior": "Allocate Memory"
                    },
                    {
                        "objective": "Memory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "allocate or change RWX memory"
                            }
                        ],
                        "id": "C0007",
                        "behavior": "Allocate Memory"
                    },
                    {
                        "objective": "Memory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "change memory protection"
                            }
                        ],
                        "id": "C0008",
                        "behavior": "Change Memory Protection"
                    },
                    {
                        "objective": "Defense Evasion",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "id": "E1027.m02",
                        "behavior": "Obfuscated Files or Information",
                        "method": "Encoding-Standard Algorithm"
                    },
                    {
                        "objective": "Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "id": "C0026.002",
                        "behavior": "Encode Data",
                        "method": "XOR"
                    },
                    {
                        "objective": "Anti-Behavioral Analysis",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "PEB access"
                            }
                        ],
                        "id": "B0001.019",
                        "behavior": "Debugger Detection",
                        "method": "Process Environment Block"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open file"
                            }
                        ],
                        "id": "C0016",
                        "behavior": "Create File"
                    },
                    {
                        "objective": "Memory",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "execute shellcode via indirect call"
                            }
                        ],
                        "id": "C0007",
                        "behavior": "Allocate Memory"
                    },
                    {
                        "objective": "Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "terminate process"
                            }
                        ],
                        "id": "C0018",
                        "behavior": "Terminate Process"
                    }
                ],
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA  # ntdll.NtAllocateVirtualMemory\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualAlloc\"\n          - string: \"VirtualAllocEx\"\n          - string: \"VirtualAllocExNuma\"\n          - string: \"NtAllocateVirtualMemory\"\n          - string: \"ZwAllocateVirtualMemory\"\n          - string: \"NtMapViewOfSection\"\n          - string: \"ZwMapViewOfSection\"\n",
                        "name": "allocate memory",
                        "authors": [
                            "0x534a@mailbox.org",
                            "@mr-tz"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "@mr-tz"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: allocate or change RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x40 = PAGE_EXECUTE_READWRITE\n        # lea     r9d, [rcx+40h]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x40 = PAGE_EXECUTE_READWRITE\n",
                        "name": "allocate or change RWX memory",
                        "description": "host-interaction/process/inject"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: change memory protection\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Change Memory Protection [C0008]\n    examples:\n      - Practical Malware Analysis Lab 11-02.dll_:0x10001203\n  features:\n    - or:\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtProtectVirtualMemory\n      - api: ZwProtectVirtualMemory\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualProtect\"\n          - string: \"VirtualProtectEx\"\n          - string: \"NtProtectVirtualMemory\"\n          - string: \"ZwProtectVirtualMemory\"\n",
                        "name": "change memory protection",
                        "authors": [
                            "@mr-tz"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
                        "name": "encode data using XOR",
                        "description": "data-manipulation/encoding/xor"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "description": "linking/runtime-linking",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm"
                            },
                            {
                                "ref": "https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: access PEB ldr_data\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    references:\n      - https://www.geoffchappell.com/studies/windows/win32/ntdll/structs/peb_ldr_data.htm\n      - https://github.com/d35ha/CallObfuscator/blob/5834aff9ff4511f1408ae4ce80b79737af4ae77b/ShellCode/shell_x64.asm#L8\n    examples:\n      - 3FDFB2D522E7DEECAAAF2F87420F7E75:0x4117B7\n  features:\n    - or:\n      - and:\n        - arch: i386\n        - description: x32\n\n        - match: PEB access\n\n        # x86 Windows uses fs:0 to access the TIB which contains SEH information at offset 0\n        # checking for fs:0 and a (possibly unrelated) number or offset often results in false positives\n\n        - offset: 0x0C = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x0C = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x14 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x1C = PEB.LDR_DATA.InInitializationOrderModuleList\n\n      - and:\n        - arch: amd64\n        - description: x64\n\n        - match: PEB access\n\n        - offset: 0x18 = PEB.LDR_DATA\n\n        - or:\n          - description: resolve a module list\n          - offset: 0x10 = PEB.LDR_DATA.InLoadOrderModuleList\n          - offset: 0x20 = PEB.LDR_DATA.InMemoryOrderModuleList\n          - offset: 0x30 = PEB.LDR_DATA.InInitializationOrderModuleList\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "access PEB ldr_data"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "ronnie.salomonsen@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: execute shellcode via indirect call\n    namespace: load-code/shellcode\n    authors:\n      - ronnie.salomonsen@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    mbc:\n      - Memory::Allocate Memory [C0007]\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - or:\n        - characteristic: indirect call\n        - characteristic: cross section flow\n",
                        "name": "execute shellcode via indirect call",
                        "description": "load-code/shellcode"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n",
                        "name": "terminate process",
                        "description": "host-interaction/process/terminate"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n",
                        "name": "parse PE header",
                        "description": "load-code/pe"
                    }
                ],
                "sandbox_name": "CAPA",
                "last_modification_date": 1708491940,
                "has_html_report": false,
                "has_evtx": false,
                "behash": "67081d16e85e2ebb3f5341a47f738a45",
                "has_pcap": false,
                "has_memdump": false
            }
        },
        {
            "id": "9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_Microsoft Sysinternals",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_Microsoft Sysinternals"
            },
            "attributes": {
                "analysis_date": 1708489223,
                "registry_keys_set": [
                    {
                        "key": "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\GoogleUpdaterInternalService122.0.6234.0\\ImagePath",
                        "value": "\"C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\updater.exe\" --system --windows-service --service=update-internal --enable-logging --vmodule=*/components/winhttp/*=1,*/components/update_client/*=2,*/chrome/updater/*=2"
                    },
                    {
                        "key": "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\GoogleUpdaterInternalService122.0.6234.0\\Start",
                        "value": "DWORD (0x00000002)"
                    }
                ],
                "processes_tree": [
                    {
                        "process_id": "3712",
                        "name": "%WINDIR%\\explorer.exe",
                        "children": [
                            {
                                "process_id": "2856",
                                "name": "%SAMPLEPATH%\\zbetcheckin_tracker_svc.exe"
                            }
                        ]
                    },
                    {
                        "process_id": "2460",
                        "name": "C:\\Program Files (x86)\\Google\\Update\\Install\\{DE6A2C33-7838-4B13-A7FB-4846C0F0071F}\\UpdaterSetup.exe",
                        "children": [
                            {
                                "process_id": "3168",
                                "name": "C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe",
                                "children": [
                                    {
                                        "process_id": "3124",
                                        "name": "C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "process_id": "612",
                        "name": "C:\\Windows\\System32\\svchost.exe",
                        "children": [
                            {
                                "process_id": "2448",
                                "name": "C:\\Windows\\System32\\wuapihost.exe"
                            }
                        ]
                    }
                ],
                "sandbox_name": "Microsoft Sysinternals",
                "last_modification_date": 1708489223,
                "has_html_report": false,
                "has_evtx": false,
                "behash": "c9fe0426e705820cf33079b1d76c7b15",
                "has_pcap": false,
                "processes_injected": [
                    "C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe"
                ],
                "processes_terminated": [
                    "%SAMPLEPATH%\\zbetcheckin_tracker_svc.exe",
                    "C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe",
                    "C:\\Windows\\System32\\wuapihost.exe"
                ],
                "processes_created": [
                    "%SAMPLEPATH%\\zbetcheckin_tracker_svc.exe",
                    "C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe",
                    "C:\\Windows\\System32\\wuapihost.exe"
                ],
                "has_memdump": false,
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "20.99.184.37",
                        "destination_port": 443
                    },
                    {
                        "transport_layer_protocol": "TCP",
                        "destination_ip": "192.229.211.108",
                        "destination_port": 80
                    }
                ],
                "files_opened": [
                    "\\crashpad_3168_WESZQWUTXHZWCHZB"
                ],
                "files_dropped": [
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0"
                    },
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\Crashpad"
                    },
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\Crashpad\\reports"
                    },
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\Crashpad\\attachments"
                    },
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\Crashpad\\metadata"
                    },
                    {
                        "path": "C:\\Windows\\Temp\\updater-backup"
                    },
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\uninstall.cmd"
                    },
                    {
                        "path": "C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\updater.exe"
                    },
                    {
                        "path": "C:\\Windows\\System32\\Tasks\\GoogleSystem"
                    },
                    {
                        "path": "C:\\Windows\\System32\\Tasks\\GoogleSystem\\GoogleUpdater"
                    },
                    {
                        "path": "C:\\Windows\\System32\\Tasks\\GoogleSystem\\GoogleUpdater\\GoogleUpdaterTaskSystem122.0.6234.0{E973A200-2578-4A2C-92FA-447D84CC19D9}"
                    },
                    {
                        "path": "C:\\Windows\\System32\\spp\\store\\2.0\\data.dat.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1BB1.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1BB1.tmp.WERInternalMetadata.xml"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1C6C.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1C6C.tmp.csv"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1CBB.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1CBB.tmp.txt"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D48.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D48.tmp.WERInternalMetadata.xml"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D49.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D49.tmp.csv"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D59.tmp"
                    },
                    {
                        "path": "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D59.tmp.txt"
                    },
                    {
                        "path": "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                    }
                ],
                "files_deleted": [
                    "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1BB1.tmp.WERInternalMetadata.xml",
                    "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1C6C.tmp.csv",
                    "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1CBB.tmp.txt",
                    "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D48.tmp.WERInternalMetadata.xml",
                    "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D49.tmp.csv",
                    "C:\\ProgramData\\Microsoft\\Windows\\WER\\Temp\\WER1D59.tmp.txt",
                    "C:\\Windows\\System32\\spp\\store\\2.0\\cache\\cache.dat"
                ],
                "command_executions": [
                    "\"%SAMPLEPATH%\\zbetcheckin_tracker_svc.exe\" ",
                    "\"C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe\" --update --system --enable-logging --vmodule=*/chrome/updater/*=2 /sessionid {CBCD7668-1AF7-4F98-A523-731720A6D504}",
                    "\"C:\\Program Files (x86)\\Google2460_788789787\\bin\\updater.exe\" --crash-handler --enable-logging --vmodule=*/components/winhttp/*=1,*/components/update_client/*=2,*/chrome/updater/*=2 --system \"--database=C:\\Program Files (x86)\\Google\\GoogleUpdater\\122.0.6234.0\\Crashpad\" --url=https://clients2.google.com/cr/report --annotation=prod=Update4 --annotation=ver=122.0.6234.0 \"--attachment=C:\\Program Files (x86)\\Google\\GoogleUpdater\\updater.log\" --initial-client-data=0x254,0x258,0x25c,0x230,0x260,0x7964b0,0x7964bc,0x7964c8",
                    "C:\\Windows\\System32\\wuapihost.exe -Embedding"
                ]
            }
        },
        {
            "id": "9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_NSFOCUS POMA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_NSFOCUS POMA"
            },
            "attributes": {
                "analysis_date": 1708788856,
                "registry_keys_set": [
                    {
                        "key": "HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\USERASSIST\\{5E6AB780-7743-11CF-A12B-00AA004AE837}\\COUNT/HRZR_PGYFRFFVBA",
                        "value": "B7 39 D3 0E 0D 00 00 00 "
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\SESSIONINFORMATION/ProgramCount",
                        "value": "0x00000002(2)"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\STREAMS\\0/ViewView2",
                        "value": "1C 00 00 00 01 00 00 00 00 00 00 00 00 00 7C 00 ...(124)"
                    },
                    {
                        "key": "HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\WINDOWS\\SHELLNOROAM\\MUICACHE/C:\\Windows\\Temp\\sample\\9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459.exe",
                        "value": "Greener"
                    }
                ],
                "sandbox_name": "NSFOCUS POMA",
                "last_modification_date": 1708864170,
                "has_html_report": true,
                "verdicts": [
                    "MALWARE"
                ],
                "has_evtx": false,
                "behash": "e09d60919d3da6617bee5cb24eb04df2",
                "has_pcap": false,
                "has_memdump": false
            }
        },
        {
            "id": "9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_Rising MOVES",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_Rising MOVES"
            },
            "attributes": {
                "analysis_date": 1709450445,
                "sandbox_name": "Rising MOVES",
                "files_written": [
                    "C:\\Program Files\\Google\\Policies",
                    "C:\\Program Files\\Google\\Temp\\GUMC886.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMF5B1.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMB0D.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMCA99.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMF573.tmp"
                ],
                "last_modification_date": 1711187789,
                "has_html_report": false,
                "has_evtx": false,
                "behash": "79bd068cfaff0a2d54a4859dbce82d82",
                "has_pcap": false,
                "processes_created": [
                    "C:\\Windows\\System32\\net1.exe"
                ],
                "has_memdump": false,
                "files_opened": [
                    "\\SystemRoot\\AppPatch\\sysmain.sdb",
                    "C:\\",
                    "C:\\Program Files\\Google\\Policies",
                    "C:\\Program Files\\Google\\Temp\\GUMC886.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMF5B1.tmp",
                    "\\??\\PIPE\\wkssvc",
                    "\\??\\pipe\\GoogleCrashServices\\S-1-5-18",
                    "\\??\\{D5CD48D7-B0F7-4C10-89F8-4DF45C40E31E}",
                    "C:\\Program Files\\Google\\Temp\\GUMB0D.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMCA99.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMF573.tmp"
                ],
                "files_deleted": [
                    "C:\\Program Files\\Google\\Temp\\GUMC886.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMF5B1.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMB0D.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMCA99.tmp",
                    "C:\\Program Files\\Google\\Temp\\GUMF573.tmp"
                ],
                "command_executions": [
                    "C:\\Windows\\system32\\net1 stop badrv",
                    "net stop badrv",
                    " ",
                    "\"C:\\Program Files\\Google\\Update\\GoogleUpdate.exe\" /cr",
                    "\"C:\\Program Files\\Google\\Update\\1.3.36.352\\GoogleCrashHandler.exe\"",
                    "\"C:\\Program Files\\Google\\Update\\GoogleUpdate.exe\" /ua /installsource core"
                ]
            }
        },
        {
            "id": "9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_Yomi Hunter",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459_Yomi Hunter"
            },
            "attributes": {
                "analysis_date": 1708502489,
                "mitre_attack_techniques": [
                    {
                        "signature_description": "The process attempted to dynamically load a malicious function",
                        "id": "T1129"
                    },
                    {
                        "signature_description": "The binary has an Authenticode signature",
                        "id": "T1198"
                    },
                    {
                        "signature_description": "The file have a Trusted Certificate",
                        "id": "T1198"
                    },
                    {
                        "signature_description": "The process tried to load dynamically one or more functions.",
                        "id": "T1129"
                    },
                    {
                        "signature_description": "encode data using XOR",
                        "id": "T1027"
                    },
                    {
                        "signature_description": "access PEB ldr_data",
                        "id": "T1129"
                    },
                    {
                        "signature_description": "link function at runtime on Windows",
                        "id": "T1129"
                    },
                    {
                        "signature_description": "parse PE header",
                        "id": "T1129"
                    },
                    {
                        "signature_description": "The process attempted to access known Bitcoin/ALTCoin wallets",
                        "id": "T1083"
                    },
                    {
                        "signature_description": "The process has tried to detect VirtualBox looking for a known file",
                        "id": "T1083"
                    },
                    {
                        "signature_description": "The process has tried to detect VirtualBox looking for a known file",
                        "id": "T1063"
                    },
                    {
                        "signature_description": "The binary has an invalid Authenticode signature.",
                        "id": "T1116"
                    },
                    {
                        "signature_description": "It Tries to detect injection methods",
                        "id": "T1063"
                    }
                ],
                "calls_highlighted": [
                    "kernel32.WriteProcessMemory",
                    "kernel32.ReadProcessMemory",
                    "wininet.InternetConnectW",
                    "kernel32.ExitProcess",
                    "wininet.InternetReadFile",
                    "kernel32.FindNextFileW",
                    "kernel32.ReadFile",
                    "kernel32.GetSystemDirectoryW",
                    "advapi32.RegOpenKeyExW",
                    "kernel32.VirtualAllocEx",
                    "kernel32.SetFileAttributesW",
                    "wininet.HttpSendRequestW",
                    "kernel32.WriteFile",
                    "kernel32.SetThreadContext",
                    "kernel32.CreatePipe",
                    "shell32.ShellExecuteW"
                ],
                "processes_tree": [
                    {
                        "process_id": "3612",
                        "time_offset": 28549,
                        "name": "ab8f84baa5f39eace6b177c360bc2233.exe"
                    }
                ],
                "modules_loaded": [
                    "api-ms-win-core-synch-l1-2-0",
                    "WS2_32",
                    "api-ms-win-core-fibers-l1-1-1",
                    "ole32",
                    "SHELL32",
                    "ADVAPI32",
                    "kernel32",
                    "OLEAUT32",
                    "api-ms-win-core-localization-l1-2-1",
                    "WININET",
                    "KERNEL32",
                    "urlmon",
                    "USER32",
                    "ntdll",
                    "SHLWAPI",
                    "rpcrt4",
                    "SspiCli"
                ],
                "sandbox_name": "Yomi Hunter",
                "files_written": [
                    "\\Sessions\\1\\BaseNamedObjects"
                ],
                "last_modification_date": 1708499033,
                "has_html_report": true,
                "verdicts": [
                    "MALWARE"
                ],
                "has_evtx": true,
                "behash": "2cd8005dbe05c539ce8bb9e8eeea2648",
                "has_pcap": true,
                "has_memdump": false,
                "files_opened": [
                    "\\Sessions\\1\\BaseNamedObjects",
                    "C:\\Windows\\system32",
                    "C:\\Windows",
                    "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                    "C:\\Windows\\System32\\VBoxService.exe",
                    "C:\\Users\\user\\Desktop\\\\x43f\\x430\\x440\\x43e\\x43b\\x438.txt",
                    "C:\\Users\\user\\Documents\\Recently.docx",
                    "C:\\Users\\user\\Documents\\Opened.docx",
                    "C:\\Users\\user\\Documents\\These.docx",
                    "C:\\Users\\user\\Documents\\Are.docx",
                    "C:\\Users\\user\\Documents\\Files.docx",
                    "C:\\Users\\user\\Desktop\\Resource.txt",
                    "C:\\Users\\user\\Desktop\\new songs.txt",
                    "C:\\Users\\user\\AppData\\Roaming\\Jaxx\\Local Storage\\wallet.dat"
                ]
            }
        }
    ],
    "meta": {
        "count": 6
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/9216dc8ef5bb0e7c63e7b0ca92552709e322cbddead179e79f32d12f320bc459/behaviours?limit=10"
    }
}