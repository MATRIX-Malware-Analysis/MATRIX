{
    "data": [
        {
            "id": "7ab45db1a6c5448e4674510864a43d1a501a3b5a87608c9844c1a23f5bc4c52c_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/7ab45db1a6c5448e4674510864a43d1a501a3b5a87608c9844c1a23f5bc4c52c_C2AE"
            },
            "attributes": {
                "command_executions": [
                    "%windir%\\mssecsvc.exe"
                ],
                "has_evtx": false,
                "memory_pattern_domains": [
                    "www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
                ],
                "processes_tree": [
                    {
                        "process_id": "980",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2612",
                        "name": "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483",
                        "children": [
                            {
                                "process_id": "2692",
                                "time_offset": 1,
                                "name": "%windir%\\mssecsvc.exe"
                            }
                        ]
                    },
                    {
                        "process_id": "2724",
                        "name": "%windir%\\system32\\DllHost.exe /Processid:{3EB3C877-1F16-487C-9050-104DBCD66683}"
                    },
                    {
                        "process_id": "2700",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2772",
                        "name": "%windir%\\mssecsvc.exe -m security"
                    }
                ],
                "registry_keys_deleted": [
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\DhcpNameServer",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\DhcpDomain",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpNameServer",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpDomain",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpSubnetMaskOpt",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpDefaultGateway"
                ],
                "verdict_labels": [
                    "WannaCry_KillSwitch"
                ],
                "behash": "293926de9ac80e65af74e83f19dddd4f",
                "has_html_report": false,
                "files_dropped": [
                    {
                        "path": "%windir%\\mssecsvc.exe",
                        "sha256": "169ad74074677ba1d2dfa40b09661d34d8da04162fe9219bb230410e8d9bc401"
                    }
                ],
                "analysis_date": 1665578573,
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "104.17.244.81",
                            "104.16.173.80"
                        ],
                        "hostname": "www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
                    }
                ],
                "has_pcap": false,
                "registry_keys_set": [
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\Indexes\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\28000000000623"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\LruList\\CurrentLru"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\Indexes\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\3300000000056B"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\_FileId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\_ObjectLru_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\_Usn_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\_ObjectId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\AeFileID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\_UsnJournalId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\661\\AeProgramID"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable",
                        "value": "0"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyServer",
                        "value": "%HTTP_PROXY%:8080"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable",
                        "value": "1"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\_IndexName_"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\DhcpDomain",
                        "value": "sales.local"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\DhcpNameServer",
                        "value": "%GATEWAY%"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\MpsSvc\\Parameters\\PortKeywords\\DHCP\\Collection"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\28000000000623\\662"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings",
                        "value": "46 00 00 00 10 00 00 00 09 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 90 6F 5C 15 D2 C1 D5 01 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 17 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 D0 5C 32 00 00 00 00 00 D0 5C 32 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 F0 5C 32 00 00 00 00 00 F0 5C 32 00 00 00 00 00 70 5B 32 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 84 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2A 00 00 2A DD 9B 00 00 02 00 00 00 C0 A8 7D 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 C0 5D 32 00 00 00 00 00"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\DefaultConnectionSettings",
                        "value": "46 00 00 00 03 00 00 00 09 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 90 6F 5C 15 D2 C1 D5 01 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 C0 A8 7D 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\{27C1424F-EA11-4F9A-8496-FC0AEA53E8DE}\\WpadDecisionTime",
                        "value": "80 CD 0A 20 96 90 D7 01"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\{27C1424F-EA11-4F9A-8496-FC0AEA53E8DE}\\WpadDecision",
                        "value": "0"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\{27C1424F-EA11-4F9A-8496-FC0AEA53E8DE}\\WpadDecisionReason",
                        "value": "2"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\{27C1424F-EA11-4F9A-8496-FC0AEA53E8DE}\\WpadNetworkName",
                        "value": "Network  5"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\_FileId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\_ObjectLru_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\_Usn_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\_ObjectId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\AeFileID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\_UsnJournalId_"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\ObjectTable\\662\\AeProgramID"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\LruList\\0000000000002B6C\\ObjectLru"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\LruList\\0000000000002B6C\\ObjectId"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows Script\\Settings\\JITDebug",
                        "value": "0"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpDefaultGateway",
                        "value": "%GATEWAY%\n"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpDomain",
                        "value": "sales.local"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpSubnetMaskOpt",
                        "value": "255.255.255.0\n"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Parameters\\Interfaces\\{b5da8633-954c-4495-ae46-0bb5b5fb1cdc}\\DhcpNameServer",
                        "value": "%GATEWAY%"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\LruList\\0000000000002B69\\ObjectLru"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\LruList\\0000000000002B69\\ObjectId"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\SavedLegacySettings",
                        "value": "46 00 00 00 04 01 00 00 03 00 00 00 14 00 00 00 65 78 74 72 61 63 74 6F 72 2E 70 72 6F 78 79 3A 38 30 38 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 D0 5C 01 4D C1 D5 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\_CurrentObjectId_"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\00-22-44-66-88-fe\\WpadDecisionTime",
                        "value": "80 CD 0A 20 96 90 D7 01"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\00-22-44-66-88-fe\\WpadDecision",
                        "value": "0"
                    },
                    {
                        "key": "HKU\\S-1-5-18\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Wpad\\00-22-44-66-88-fe\\WpadDecisionReason",
                        "value": "2"
                    },
                    {
                        "key": "\\\\REGISTRY\\A\\{2f80e6d3-fc89-11eb-aa08-167c9a143b16}\\DefaultObjectStore\\IndexTable\\FileIdIndex-{853201e6-2d75-11ea-a138-806e6f6e6963}\\3300000000056B\\661"
                    }
                ],
                "verdicts": [
                    "RANSOM"
                ],
                "has_memdump": false,
                "sandbox_name": "C2AE",
                "memory_pattern_urls": [
                    "http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com"
                ],
                "verdict_confidence": 70,
                "processes_terminated": [
                    "wmiadap.exe /F /T /R",
                    "%windir%\\mssecsvc.exe",
                    "%windir%\\system32\\DllHost.exe /Processid:{3EB3C877-1F16-487C-9050-104DBCD66683}"
                ],
                "last_modification_date": 1665697382
            }
        },
        {
            "id": "7ab45db1a6c5448e4674510864a43d1a501a3b5a87608c9844c1a23f5bc4c52c_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/7ab45db1a6c5448e4674510864a43d1a501a3b5a87608c9844c1a23f5bc4c52c_CAPA"
            },
            "attributes": {
                "has_evtx": false,
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480",
                "has_html_report": false,
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n",
                        "name": "create process on Windows",
                        "description": "host-interaction/process/create"
                    },
                    {
                        "description": "host-interaction/file-system",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference absolute stream path on Windows\n    namespace: host-interaction/file-system\n    authors:\n      - blas.kojusner@mandiant.com\n      - william.ballenthin@mandiant.com\n    scope: basic block\n    references:\n      - https://learn.microsoft.com/en-us/windows/win32/fileio/file-streams\n    examples:\n      - 51828683DC26BFABD3994494099AE97D:0x11A9\n  features:\n    - and:\n      - string: /^(..\\?\\\\)?([\\w]\\:|\\\\)(\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+(\\:\\$?([a-zA-Z0-9_]+))?/\n        # ^(..\\?\\\\)? -> Check for path starting with \"\\\\?\\\"\n        # ([\\w]\\:|\\\\) -> Check for absolute path beginning\n        # (\\\\+((?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\])[\\x20-\\x5B\\x5D-\\x7E])+)+ -> Check for valid path and filename\n        #   \\\\+ -> Check for at least one backslash path separator\n        #   (?![\\<\\>\\\"\\/\\|\\*\\?\\:\\\\]) -> path component must not start with <, >, \", ...\n        #   [\\x20-\\x5B\\x5D-\\x7E] -> path component must be printable ASCII, except backslash path separator\n        # : -> Check for start of stream filename\n        # \\$?([a-zA-Z0-9_]+))? -> Check for valid stream filename\n        ### Example Matches:\n        ### \\\\\\\\server\\share\\\\file:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file.ext:stream \n        ### \\\\\\\\server\\share\\dir.ext\\\\file.tar.gz:stream\n        ### \\\\\\\\server\\share\\dir.ext\\\\file:stream.tar.gz\n        ### \\\\\\\\server\\share\\dir\\\\file.ext:stream.ext\n        ### \\\\\\\\?\\C:\\dir1\\dir2\\\\file:stream\n        ### C:\\dir\\\\file:stream.ext\n        ### C:\\dir\\\\file:}{+,.';[]-=-0987654321`~!@#$%^&()_+-.ext\n",
                        "authors": [
                            "blas.kojusner@mandiant.com",
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "reference absolute stream path on Windows"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: function\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - match: contain a resource (.rsrc) section\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n",
                        "name": "extract resource via kernel32 functions",
                        "description": "executable/resource"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - or:\n            - and:\n              - number: 0x40000000 = GENERIC_WRITE\n              - api: kernel32.CreateFile\n            - and:\n              - number: 0x2 = FILE_WRITE_DATA\n              - or:\n                - api: NtCreateFile\n                - api: ZwCreateFile\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n",
                        "name": "write file on Windows",
                        "description": "host-interaction/file-system/write"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain an embedded PE file\n    namespace: executable/subfile/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    mbc:\n      - Execution::Install Additional Program [B0023]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4060\n  features:\n    - or:\n      - count(characteristic(embedded pe)): 1 or more\n      - count(string(This program cannot be run in DOS mode.)): 2 or more\n",
                        "name": "contain an embedded PE file",
                        "description": "executable/subfile/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n",
                        "name": "contain a resource (.rsrc) section",
                        "description": "executable/pe/section/rsrc"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "matthew.williams@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference startup folder\n    namespace: persistence/startup-folder\n    authors:\n      - matthew.williams@mandiant.com\n    scope: file\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n  features:\n    - or:\n      - string: /Start Menu\\\\Programs\\\\Startup/i\n",
                        "name": "reference startup folder",
                        "description": "persistence/startup-folder"
                    },
                    {
                        "description": "anti-analysis/anti-vm/vm-detection",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(CurrentControlSet|ControlSet001)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx.dll/i\n        description: AVG\n      - string: /avghooka.dll/i\n        description: AVG\n      - string: /snxhk.dll/i\n        description: Avast\n      - string: /pstorec.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck.dll/i\n        description: Virtual PC\n      - string: /wpespy.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample.exe/i\n      - string: /bot.exe/i\n      - string: /sandbox.exe/i\n      - string: /malware.exe/i\n      - string: /test.exe/i\n      - string: /klavme.exe/i\n      - string: /myapp.exe/i\n      - string: /testapp.exe/i\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "reference anti-VM strings"
                    },
                    {
                        "description": "anti-analysis/anti-vm/vm-detection",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualPC.cpp"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualPC\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualPC.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VirtualPC/i\n      - string: /VMSrvc.exe/i\n      - string: /VMUSrvc.exe/i\n      - string: /SOFTWARE\\\\Microsoft\\\\Virtual Machine\\\\Guest\\\\Parameters/i\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "reference anti-VM strings targeting VirtualPC"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scope: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n",
                        "name": "linked against ZLIB",
                        "description": "linking/static/zlib"
                    },
                    {
                        "description": "anti-analysis",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg(\\.exe)?/i\n      - string: /ProcessHacker(\\.exe)?/i\n      - string: /tcpview(\\.exe)?/i\n      - string: /autoruns(\\.exe)?/i\n      - string: /autorunsc(\\.exe)?/i\n      - string: /filemon(\\.exe)?/i\n      - string: /procmon(\\.exe)?/i\n      - string: /regmon(\\.exe)?/i\n      - string: /procexp(\\.exe)?/i\n      - string: /ida[gqtuw]?(\\.exe)?$/i\n      - string: /ida[gqtuw]64(\\.exe)?$/i\n      - string: /ImmunityDebugger(\\.exe)?/i\n      - string: /Wireshark(\\.exe)?/i\n      - string: /dumpcap(\\.exe)?/i\n      - string: /HookExplorer(\\.exe)?/i\n      - string: /ImportREC(\\.exe)?/i\n      - string: /PETools(\\.exe)?/i\n      - string: /LordPE(\\.exe)?/i\n      - string: /SysInspector(\\.exe)?/i\n      - string: /proc_analyzer(\\.exe)?/i\n      - string: /sysAnalyzer(\\.exe)?/i\n      - string: /sniff_hit(\\.exe)?/i\n      - string: /windbg(\\.exe)?/i\n      - string: /joeboxcontrol(\\.exe)?/i\n      - string: /joeboxserver(\\.exe)?/i\n      - string: /ResourceHacker(\\.exe)?/i\n      - string: /x32dbg(\\.exe)?/i\n      - string: /x64dbg(\\.exe)?/i\n      - string: /Fiddler(\\.exe)?/i\n      - string: /httpdebugger(\\.exe)?/i\n      - string: /fakenet(\\.exe)?/i\n      - string: /netmon(\\.exe)?/i\n      - string: /WPE PRO(\\.exe)?/i\n      - string: /decompile(\\.exe)?/i\n      - string: /scylla/i\n      - string: /megadumper/i\n",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "reference analysis tools strings"
                    }
                ],
                "analysis_date": 1673579854,
                "has_pcap": false,
                "has_memdump": false,
                "sandbox_name": "CAPA",
                "mitre_attack_techniques": [
                    {
                        "signature_description": "reference anti-VM strings",
                        "id": "T1497.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "reference anti-VM strings targeting VirtualPC",
                        "id": "T1497.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "reference startup folder",
                        "id": "T1547.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "reference startup folder"
                            }
                        ],
                        "signature_description": "reference startup folder",
                        "id": "T1547.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "reference anti-VM strings"
                            }
                        ],
                        "signature_description": "reference anti-VM strings",
                        "id": "T1497.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "reference anti-VM strings targeting VirtualPC"
                            }
                        ],
                        "signature_description": "reference anti-VM strings targeting VirtualPC",
                        "id": "T1497.001",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "last_modification_date": 1684938430
            }
        }
    ],
    "meta": {
        "count": 2
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/7ab45db1a6c5448e4674510864a43d1a501a3b5a87608c9844c1a23f5bc4c52c/behaviours?limit=10"
    }
}