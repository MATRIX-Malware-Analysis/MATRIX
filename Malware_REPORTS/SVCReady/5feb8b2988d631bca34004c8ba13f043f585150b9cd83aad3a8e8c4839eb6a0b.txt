{
    "data": [
        {
            "id": "5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b_C2AE"
            },
            "attributes": {
                "has_evtx": false,
                "processes_terminated": [
                    "wmiadap.exe /F /T /R"
                ],
                "has_memdump": false,
                "behash": "7eb58e30b74038daa9b31b5d9df78cf2",
                "last_modification_date": 1658230527,
                "analysis_date": 1658144079,
                "has_pcap": false,
                "verdicts": [
                    "UNKNOWN_VERDICT"
                ],
                "has_html_report": false,
                "processes_tree": [
                    {
                        "process_id": "2912",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2664",
                        "name": "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483"
                    },
                    {
                        "process_id": "2952",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    }
                ],
                "sandbox_name": "C2AE"
            }
        },
        {
            "id": "5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b_CAPA"
            },
            "attributes": {
                "has_evtx": false,
                "has_memdump": false,
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480",
                "last_modification_date": 1675415786,
                "analysis_date": 1675415786,
                "has_pcap": false,
                "has_html_report": false,
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using RC4 PRGA"
                            }
                        ],
                        "signature_description": "encrypt data using RC4 PRGA",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: instruction\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n",
                        "name": "calculate modulo 256 via x86 assembly",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple\n      - count(basic blocks): 4 or more\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n",
                        "name": "encrypt data using RC4 PRGA",
                        "description": "data-manipulation/encryption/rc4"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contain a resource (.rsrc) section\n    namespace: executable/pe/section/rsrc\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: file\n    examples:\n      - A933A1A402775CFA94B6BEE0963F4B46:0x41fd25\n  features:\n    - section: .rsrc\n",
                        "name": "contain a resource (.rsrc) section",
                        "description": "executable/pe/section/rsrc"
                    }
                ],
                "sandbox_name": "CAPA"
            }
        },
        {
            "id": "5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b_SecondWrite",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b_SecondWrite"
            },
            "attributes": {
                "files_opened": [
                    "C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll",
                    "C:\\Windows\\SysWOW64\\rundll32.exe",
                    "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls"
                ],
                "has_evtx": false,
                "modules_loaded": [
                    "kernel32.dll",
                    "kernel32",
                    "api-ms-win-core-localization-l1-2-1",
                    "api-ms-win-core-fibers-l1-1-1",
                    "GDI32.dll",
                    "api-ms-win-core-sysinfo-l1-2-1",
                    "C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll",
                    "USER32.dll",
                    "C:\\Windows\\system32\\ole32.dll",
                    "api-ms-win-core-synch-l1-2-0"
                ],
                "processes_created": [
                    "rundll32.exe"
                ],
                "has_memdump": false,
                "behash": "18408989ebfac86c774376ad5e2676df",
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "UDP",
                        "destination_ip": "239.255.255.250",
                        "destination_port": 1900
                    }
                ],
                "last_modification_date": 1658448474,
                "analysis_date": 1658448184,
                "has_pcap": true,
                "verdicts": [
                    "MALWARE",
                    "TROJAN"
                ],
                "has_html_report": true,
                "processes_tree": [
                    {
                        "process_id": "2404",
                        "name": "rundll32.exe",
                        "children": [
                            {
                                "process_id": "2668",
                                "name": "rundll32.exe"
                            }
                        ]
                    }
                ],
                "mitre_attack_techniques": [
                    {
                        "signature_description": "Virtualization / Sandbox Evasion",
                        "id": "T1497"
                    },
                    {
                        "signature_description": "Software Packing",
                        "id": "T1045"
                    }
                ],
                "registry_keys_opened": [
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CTF\\KnownClasses",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CTF\\",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\CTF\\Compatibility\\rundll32.exe",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\CTF\\TIP\\{0000897b-83df-4b96-be07-0fb58b01c4a4}\\LanguageProfile\\0x00000000\\{0001bea3-ed56-483d-a2e2-aeae25577436}"
                ],
                "command_executions": [
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll,#1",
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll,DllRegisterServer",
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll,EZr4Zfj",
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll,DWrGmSO",
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b.dll,AT5DxVldu"
                ],
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "40.119.148.38"
                        ],
                        "hostname": "time.windows.com"
                    }
                ],
                "sandbox_name": "SecondWrite"
            }
        }
    ],
    "meta": {
        "count": 3
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/5feb8b2988d631bca34004c8ba13f043f585150b9cd83aad3a8e8c4839eb6a0b/behaviours?limit=10"
    }
}