{
    "data": [
        {
            "id": "e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec_C2AE"
            },
            "attributes": {
                "verdict_confidence": 70,
                "has_html_report": false,
                "verdict_labels": [
                    "Dridex"
                ],
                "verdicts": [
                    "TROJAN"
                ],
                "has_evtx": false,
                "behash": "0abef1459995846d53ebc1b564867586",
                "last_modification_date": 1630072834,
                "analysis_date": 1629986385,
                "memory_pattern_ips": [
                    "103.82.248.59",
                    "54.39.98.141",
                    "103.109.247.8"
                ],
                "registry_keys_set": [
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\CIMOM\\ConfigValueEssNeedsLoading",
                        "value": "1"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\CIMOM\\List of event-active namespaces",
                        "value": "00 00 54 00 45 00 76 00 65 00 6E 00 74 00 4C 00 6F 00 67 00 45 00 76 00 65 00 6E 00 74 00 43 00 6F 00 6E 00 73 00 75 00 6D 00 65 00 72 00"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{ad498944-762f-11d0-8dcb-00c04fc3358c}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{ad498944-762f-11d0-8dcb-00c04fc3358c}\\#{78032B7E-4968-42D3-9F37-287EA86C0AAA}\\SymbolicLink",
                        "value": "\\\\?\\SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{ad498944-762f-11d0-8dcb-00c04fc3358c}\\{78032B7E-4968-42D3-9F37-287EA86C0AAA}"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{cac88484-7515-4c03-82e6-71a87abac361}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{cac88484-7515-4c03-82e6-71a87abac361}\\#\\Control\\Linked",
                        "value": "1"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\Last Counter",
                        "value": "12642"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\Object List",
                        "value": "12476 12482 12492 12502 12522 12566 12576 12614 12620 12636"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\Last Help",
                        "value": "12643"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\First Counter",
                        "value": "12476"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\First Help",
                        "value": "12477"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\PerfIniFile",
                        "value": "WmiApRpl.ini\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000"
                    },
                    {
                        "key": "HKU\\S-1-5-21-575823232-3065301323-1442773979-1000_CLASSES\\Local Settings\\MuiCache\\17b\\52C64B7E\\LanguageList",
                        "value": "en-US\nen\n"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\drivers\\ndis.sys[MofResourceName]"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\System32\\Drivers\\portcls.SYS[PortclsMof]",
                        "value": "LowDateTime:418629328,HighDateTime:30487037***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\drivers\\en-US\\ACPI.sys.mui[ACPIMOFResource]",
                        "value": "LowDateTime:1237199616,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\DRIVERS\\HDAudBus.sys[HDAudioMofName]",
                        "value": "LowDateTime:-227274444,HighDateTime:30116024***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\System32\\Drivers\\en-US\\portcls.SYS.mui[PortclsMof]",
                        "value": "LowDateTime:1137199616,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\advapi32.dll[MofResourceName]",
                        "value": "LowDateTime:302488720,HighDateTime:30778805***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\en-US\\advapi32.dll.mui[MofResourceName]",
                        "value": "LowDateTime:369951187,HighDateTime:30778805***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\drivers\\en-US\\mssmbios.sys.mui[MofResource]",
                        "value": "LowDateTime:1497199616,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\DRIVERS\\en-US\\HDAudBus.sys.mui[HDAudioMofName]",
                        "value": "LowDateTime:-377767680,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\drivers\\en-US\\ndis.sys.mui[MofResourceName]",
                        "value": "LowDateTime:382232320,HighDateTime:30016580***Binary mof failed, see WMIPROV.LOG"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\DRIVERS\\en-US\\intelppm.sys.mui[PROCESSORWMI]",
                        "value": "LowDateTime:-577767680,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\IDE\\DiskAMDX_HARDDISK___________________________2.5+____\\5&2770a7af&0&0.0.0_0-{05901221-D566-11d1-B2F0-00A0C9062910}",
                        "value": "LowDateTime:803713417,HighDateTime:0***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\DRIVERS\\intelppm.sys[PROCESSORWMI]",
                        "value": "LowDateTime:-445445610,HighDateTime:30778799***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\drivers\\ACPI.sys[ACPIMOFResource]",
                        "value": "LowDateTime:398767260,HighDateTime:30646967***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\DRIVERS\\monitor.sys[MonitorWMI]"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\%windir%\\system32\\drivers\\mssmbios.sys[MofResource]",
                        "value": "LowDateTime:-649833737,HighDateTime:30733938***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\BackupRestore\\FilesNotToBackup\\BITS_LOG",
                        "value": "%windir%\\System32\\Bits.log\n"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\BackupRestore\\FilesNotToBackup\\BITS_BAK",
                        "value": "%windir%\\System32\\Bits.bak\n"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{cac88484-7515-4c03-82e6-71a87abac361}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{cac88484-7515-4c03-82e6-71a87abac361}\\#\\SymbolicLink",
                        "value": "\\\\?\\SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{cac88484-7515-4c03-82e6-71a87abac361}"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\WBEM\\PROVIDERS\\Performance\\Performance Refresh",
                        "value": "0"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\WBEM\\PROVIDERS\\Performance\\Performance Refreshed",
                        "value": "1"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\WBEM\\PROVIDERS\\Performance\\Performance Data",
                        "value": "28 1B 00 00 01 00 00 00 00 00 00 00 10 00 00 00 18 1B 00 00 09 00 00 00 9A 00 00 00 01 00 00 00 01 00 00 00 40 00 00 00 1A 00 00 00 5C 00 5C 00 2E 00 5C 00 72 00 6F 00 6F 00 74 00 5C 00 77 00 6D 00 69 00 00 00 00 00 00 00 00 00 00 00 00 00 C0 01 00 00 04 00 00 00 08 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 64 00 00 00 68 00 00 00 3A 00 00 00 4D 00 53 00 69 00 53 00 43 00 53 00 49 00 5F 00 43 00 6F 00 6E 00 6E 00 65 00 63 00 74 00 69 00 6F 00 6E 00 53 00 74 00 61 00 74 00 69 00 73 00 74 00 69 00 63 00 73 00 00 00 00 00 00 00 00 00 00 00 00 00 30 00 00 00 1A 00 00 00 49 00 6E 00 73 00 74 00 61 00 6E 00 63 00 65 00 4E 00 61 00 6D 00 65 00 00 00 2F 20 4D 6F 64 75 6C 65 20 4E 61 6D 65 3A 48 00 00 00 00 00 00 00 02 00 00 00 15 00 00 00 00 00 00 00 64 00 00 00 00 05 41 10 48 00 00 00 1C 00 00 00 42 00 79 00 74 00 65 00 73 00 52 00 65 00 63 00 65 00 69 00 76 00 65 00 64 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 04 00 00 00 15 00 00 00 00 00 00 00 64 00 00 00 00 05 41 10 40 00 00 00 14 00 00 00 42 0"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{cac88484-7515-4c03-82e6-71a87abac361}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{cac88484-7515-4c03-82e6-71a87abac361}\\Control\\ReferenceCount",
                        "value": "1"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Perflib\\Last Counter",
                        "value": "12642"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Perflib\\Last Help",
                        "value": "12643"
                    },
                    {
                        "key": "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Perflib\\Updating"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{ad498944-762f-11d0-8dcb-00c04fc3358c}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{ad498944-762f-11d0-8dcb-00c04fc3358c}\\DeviceInstance",
                        "value": "SW\\{eeab7790-c514-11d1-b42b-00805fc1270e}\\asyncmac"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\en-US\\intelppm.sys.mui[PROCESSORWMI]",
                        "value": "LowDateTime:-577767680,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\HDAudBus.sys[HDAudioMofName]",
                        "value": "LowDateTime:-227274444,HighDateTime:30116024***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\System32\\Drivers\\en-US\\portcls.SYS.mui[PortclsMof]",
                        "value": "LowDateTime:1137199616,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\advapi32.dll[MofResourceName]",
                        "value": "LowDateTime:302488720,HighDateTime:30778805***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\en-US\\advapi32.dll.mui[MofResourceName]",
                        "value": "LowDateTime:369951187,HighDateTime:30778805***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\en-US\\mssmbios.sys.mui[MofResource]",
                        "value": "LowDateTime:1497199616,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\System32\\Drivers\\portcls.SYS[PortclsMof]",
                        "value": "LowDateTime:418629328,HighDateTime:30487037***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\drivers\\en-US\\ndis.sys.mui[MofResourceName]",
                        "value": "LowDateTime:382232320,HighDateTime:30016580***Binary mof failed, see WMIPROV.LOG"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\en-US\\HDAudBus.sys.mui[HDAudioMofName]",
                        "value": "LowDateTime:-377767680,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\en-US\\ACPI.sys.mui[ACPIMOFResource]",
                        "value": "LowDateTime:1237199616,HighDateTime:30016579***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\IDE\\DiskAMDX_HARDDISK___________________________2.5+____\\5&2770a7af&0&0.0.0_0-{05901221-D566-11d1-B2F0-00A0C9062910}",
                        "value": "LowDateTime:803713417,HighDateTime:0***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\intelppm.sys[PROCESSORWMI]",
                        "value": "LowDateTime:-445445610,HighDateTime:30778799***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\ACPI.sys[ACPIMOFResource]",
                        "value": "LowDateTime:398767260,HighDateTime:30646967***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\Software\\Microsoft\\WBEM\\WDM\\DREDGE\\%windir%\\system32\\DRIVERS\\mssmbios.sys[MofResource]",
                        "value": "LowDateTime:-649833737,HighDateTime:30733938***Binary mof compiled successfully"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\Network\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\{B5DA8633-954C-4495-AE46-0BB5B5FB1CDC}\\Connection\\PnpInstanceID",
                        "value": "PCI\\VEN_8086&DEV_100E&SUBSYS_11001AF4&REV_03\\3&13C0B0C5&0&90"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{ad498944-762f-11d0-8dcb-00c04fc3358c}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{ad498944-762f-11d0-8dcb-00c04fc3358c}\\Control\\ReferenceCount",
                        "value": "1"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{cac88484-7515-4c03-82e6-71a87abac361}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{cac88484-7515-4c03-82e6-71a87abac361}\\DeviceInstance",
                        "value": "SW\\{eeab7790-c514-11d1-b42b-00805fc1270e}\\asyncmac"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\Nsi\\{eb004a03-9b1a-11d4-9123-0050047759bc}\\22\\(Default)"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\Nsi\\{eb004a03-9b1a-11d4-9123-0050047759bc}\\24\\ffffffffffffffffffffffffffffff00",
                        "value": "00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\Nsi\\{eb004a03-9b1a-11d4-9123-0050047759bc}\\24\\ffffffffffffffffffffffffffffff01",
                        "value": "00 00 00 00 6D 00 00 00 19 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\Nsi\\{eb004a03-9b1a-11d4-9123-0050047759bc}\\24\\ffffffffffffffffffffffffffffff02",
                        "value": "01 00 00 00 5A 00 00 00 D6 17 00 00 FF FF FF FF FF FF FF FF FF FF FF FF"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\Nsi\\{eb004a03-9b1a-11d4-9123-0050047759bc}\\24\\ffffffffffffffffffffffffffffff03",
                        "value": "00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Services\\BITS\\Performance\\PerfMMFileName",
                        "value": "Global\\MMF_BITS_s"
                    },
                    {
                        "key": "HKLM\\SYSTEM\\ControlSet001\\Control\\DeviceClasses\\{ad498944-762f-11d0-8dcb-00c04fc3358c}\\##?#SW#{eeab7790-c514-11d1-b42b-00805fc1270e}#asyncmac#{ad498944-762f-11d0-8dcb-00c04fc3358c}\\#{78032B7E-4968-42D3-9F37-287EA86C0AAA}\\Control\\Linked",
                        "value": "1"
                    }
                ],
                "processes_tree": [
                    {
                        "process_id": "2220",
                        "name": "%windir%\\System32\\svchost.exe -k WerSvcGroup"
                    },
                    {
                        "process_id": "2904",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2948",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2636",
                        "name": "%SANDBOX_DLL_LOADER_X86% %SAMPLEPATH% %WORKDIR% 483"
                    }
                ],
                "has_memdump": false,
                "memory_pattern_urls": [
                    "https://103.82.248.59",
                    "https://54.39.98.141:6602",
                    "https://103.109.247.8:10443"
                ],
                "has_pcap": false,
                "processes_terminated": [
                    "%windir%\\System32\\svchost.exe -k WerSvcGroup",
                    "wmiadap.exe /F /T /R"
                ],
                "registry_keys_deleted": [
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\First Counter",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\Last Counter",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\First Help",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\Last Help",
                    "HKLM\\SYSTEM\\ControlSet001\\Services\\WmiApRpl\\Performance\\Object List"
                ],
                "sandbox_name": "C2AE"
            }
        },
        {
            "id": "e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec_CAPA"
            },
            "attributes": {
                "has_html_report": false,
                "has_evtx": false,
                "behash": "ace1cd072aae1aaa72d0dc50354445a2",
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scope: basic block\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n",
                        "name": "allocate memory",
                        "authors": [
                            "0x534a@mailbox.org"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n",
                        "name": "get service handle",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n",
                        "name": "get common file path",
                        "description": "host-interaction/file-system"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read pipe\n    namespace: communication/named-pipe/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    description: PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output.\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Read Pipe [C0003.003]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x4014C0\n  features:\n    - or:\n      - and:\n        - api: kernel32.PeekNamedPipe\n        - api: kernel32.ReadFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n",
                        "name": "read pipe",
                        "description": "communication/named-pipe/read : PeekNamedPipe isn't required to read from a pipe; however, pipes are often utilized to capture the output of a cmd.exe process. In a multi-thread instance, a new thread is created that calls PeekNamedPipe and ReadFile to obtain the command output."
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scope: function\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n",
                        "name": "write file on Windows",
                        "description": "host-interaction/file-system/write"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write pipe\n    namespace: communication/named-pipe/write\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    mbc:\n      - Communication::Interprocess Communication::Write Pipe [C0003.004]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n  features:\n    - or:\n      - and:\n        - or:\n          - match: create pipe\n          - match: connect pipe\n        - api: kernel32.WriteFile\n      - api: kernel32.TransactNamedPipe\n        description: writes and reads pipe in single operation\n      - api: kernel32.CallNamedPipe\n        description: connects, writes, and reads pipe in single operation\n",
                        "name": "write pipe",
                        "description": "communication/named-pipe/write"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create service\n    namespace: host-interaction/service/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - and:\n      - api: advapi32.CreateService\n      - optional:\n        - api: advapi32.OpenSCManager\n",
                        "name": "create service",
                        "description": "host-interaction/service/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n",
                        "name": "parse PE header",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encrypt data using RC4 PRGA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403DB0\n      - 34404A3FB9804977C6AB86CB991FB130:0x403E50\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049F0\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x4064C6\n  features:\n    - and:\n      # TODO: maybe add characteristic for nzxor reg size\n      - count(characteristic(nzxor)): 1\n      - or:\n        - match: calculate modulo 256 via x86 assembly\n        # compiler may do this via zero-extended mov from 8-bit register\n        - count(mnemonic(movzx)): 4 or more\n      # should not call (many) functions\n      - count(characteristic(calls from)): (0, 4)\n      # should not be too simple or too complex (50 is picked by intuition)\n      - count(basic blocks): (4, 50)\n      - match: contain loop\n      - optional:\n        - or:\n          - number: 0xFF\n          - number: 0x100\n",
                        "name": "encrypt data using RC4 PRGA",
                        "description": "data-manipulation/encryption/rc4"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "ronnie.salomonsen@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: forwarded export\n    namespace: executable/pe/export\n    authors:\n      - ronnie.salomonsen@mandiant.com\n    scope: file\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 76FA734236DAA023444DEC26863401DC\n  features:\n    - characteristic: forwarded export\n",
                        "name": "forwarded export",
                        "description": "executable/pe/export"
                    }
                ],
                "last_modification_date": 1701842920,
                "analysis_date": 1701842920,
                "has_memdump": false,
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ],
                        "signature_description": "get common file path",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create service"
                            }
                        ],
                        "signature_description": "create service",
                        "id": "T1543.003",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create service"
                            }
                        ],
                        "signature_description": "create service",
                        "id": "T1569.002",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "parse PE header"
                            }
                        ],
                        "signature_description": "parse PE header",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encrypt data using RC4 PRGA"
                            }
                        ],
                        "signature_description": "encrypt data using RC4 PRGA",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "forwarded export"
                            }
                        ],
                        "signature_description": "forwarded export",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_pcap": false,
                "sandbox_name": "CAPA"
            }
        },
        {
            "id": "e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec_Yomi Hunter",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec_Yomi Hunter"
            },
            "attributes": {
                "has_html_report": true,
                "modules_loaded": [
                    "SspiCli",
                    "rpcrt4"
                ],
                "verdicts": [
                    "MALWARE"
                ],
                "has_evtx": true,
                "behash": "1d1bdcb99761ad7619e985fd01bbdc59",
                "last_modification_date": 1721922690,
                "analysis_date": 1721922655,
                "files_opened": [
                    "C:\\Users\\user\\AppData\\Local\\Temp\\6361788206621b6d9f0c6cc67785691c.dll",
                    "C:\\Users\\user\\AppData\\Local\\Temp\\6361788206621b6d9f0c6cc67785691c.dll.manifest"
                ],
                "processes_tree": [
                    {
                        "process_id": "1920",
                        "name": "13f43b565119f43f7155f96cafa8b05d.exe",
                        "time_offset": 14360
                    }
                ],
                "ids_alerts": [
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44486",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|Windows for Workgroups 3.1a\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44486; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44484",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|PC NETWORK PROGRAM 1.0\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; gid:1; sid:44484; rev:6; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44488",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|LANMAN2.1\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44488; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44487",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|LM1.2X002\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44487; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER SMBv1 protocol detection attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:44485",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb"
                        ],
                        "rule_raw": "alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER SMBv1 protocol detection attempt\"; flow:to_server,established; content:\"|FF|SMB|72 00 00 00 00|\"; content:\"|02|LANMAN1.0\",fast_pattern,nocase; service:netbios-ssn; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb1.rb; classtype:policy-violation; sid:44485; rev:4; )"
                    },
                    {
                        "rule_msg": "POLICY-OTHER use of psexec remote administration tool SMBv2",
                        "rule_category": "policy-violation",
                        "rule_id": "1:30281",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_references": [
                            "https://attack.mitre.org/techniques/T1028",
                            "https://attack.mitre.org/techniques/T1035",
                            "https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx"
                        ],
                        "rule_raw": "alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:\"POLICY-OTHER use of psexec remote administration tool SMBv2\"; flow:to_server,established; content:\"|FE|SMB\",depth 8,nocase; content:\"|05 00|\",within 2,distance 8; content:\"P|00|S|00|E|00|X|00|E|00|S|00|V|00|C|00|\",fast_pattern,nocase; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1028; reference:url,attack.mitre.org/techniques/T1035; reference:url,technet.microsoft.com/en-us/sysinternals/bb897553.aspx; classtype:policy-violation; sid:30281; rev:4; )"
                    },
                    {
                        "rule_msg": "FILE-EXECUTABLE Microsoft Windows executable file save onto SMB share attempt",
                        "rule_category": "policy-violation",
                        "rule_id": "1:26385",
                        "alert_severity": "high",
                        "rule_source": "Snort registered user ruleset",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_raw": "alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:\"FILE-EXECUTABLE Microsoft Windows executable file save onto SMB share attempt\"; flow:to_server,established; content:\"SMB\",depth 3,offset 5; content:\"MZ\",within 150; byte_jump:4,58,relative,little; content:\"PE|00 00|\",within 4,distance -64,fast_pattern; metadata:policy max-detect-ips drop; service:netbios-ssn; classtype:policy-violation; sid:26385; rev:3; )"
                    },
                    {
                        "rule_msg": "SURICATA STREAM SHUTDOWN RST invalid ack",
                        "rule_category": "Generic Protocol Command Decode",
                        "rule_id": "1:2210046",
                        "alert_severity": "low",
                        "rule_source": "Suricata",
                        "rule_url": "https://www.openinfosecfoundation.org/",
                        "rule_raw": "alert tcp any any -> any any (msg:\"SURICATA STREAM SHUTDOWN RST invalid ack\"; stream-event:rst_invalid_ack; classtype:protocol-command-decode; sid:2210046; rev:2;)"
                    },
                    {
                        "rule_msg": "ATTACK [PTsecurity] Petya ransomware perfc.dat component",
                        "rule_category": "A suspicious filename was detected",
                        "rule_id": "1:10001443",
                        "alert_severity": "medium",
                        "rule_source": "Positive Technologies: PT Open Ruleset",
                        "rule_url": "https://github.com/ptresearch/AttackDetection/",
                        "rule_references": [
                            "https://github.com/ptresearch/AttackDetection"
                        ],
                        "rule_raw": "alert smb any any -> $HOME_NET any (msg: \"ATTACK [PTsecurity] Petya ransomware perfc.dat component\"; flow: to_server, established, no_stream; content: \"|fe 53 4d 42|\"; offset: 4; depth: 4; content: \"|05 00|\"; offset: 16; depth: 2; byte_jump: 2, 112, little, from_beginning, post_offset 4; content: \"|70 00 65 00 72 00 66 00 63 00 2e 00 64 00 61 00 74 00|\"; distance:0; classtype:suspicious-filename-detect; reference: url, github.com/ptresearch/AttackDetection; sid: 10001443; rev: 1;)"
                    },
                    {
                        "rule_msg": "ET POLICY SMB Executable File Transfer",
                        "rule_category": "Potentially Bad Traffic",
                        "rule_id": "1:2025699",
                        "alert_severity": "low",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert tcp any any -> $HOME_NET 445 (msg:\"ET POLICY SMB Executable File Transfer\"; flow:established,to_server; content:\"SMB\"; depth:8; content:\"MZ\"; distance:0; byte_jump:4,58,relative,little; content:\"PE|00 00|\"; distance:-64; within:4; flowbits:set,ET.smb.binary; classtype:bad-unknown; sid:2025699; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target SMB_Client, created_at 2018_07_16, deployment Internal, signature_severity Minor, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "ET RPC DCERPC SVCCTL - Remote Service Control Manager Access",
                        "rule_category": "Attempted User Privilege Gain",
                        "rule_id": "1:2027237",
                        "alert_severity": "high",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert tcp any any -> $HOME_NET 135 (msg:\"ET RPC DCERPC SVCCTL - Remote Service Control Manager Access\"; flow:established,to_server; content:\"|00 00 00 00 00 00 00 00|\"; content:\"|13 00 0d 81 bb 7a 36 44 98 f1 35 ad 32 98 f0 38 00 10 03|\"; within:100; classtype:attempted-user; sid:2027237; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, created_at 2019_04_22, deployment Perimeter, performance_impact Low, signature_severity Informational, updated_at 2020_08_19;)"
                    },
                    {
                        "rule_msg": "File Found over SMB and stored",
                        "rule_id": "1:32",
                        "alert_severity": "low",
                        "rule_source": "Suricata",
                        "rule_url": "https://www.openinfosecfoundation.org/",
                        "rule_raw": "alert smb any any -> any any (msg:\"File Found over SMB and stored\"; filestore; sid:32; rev:1;)"
                    },
                    {
                        "rule_msg": "ET EXPLOIT ETERNALBLUE Exploit M2 MS17-010",
                        "rule_category": "Attempted Administrator Privilege Gain",
                        "rule_id": "1:2024297",
                        "alert_severity": "high",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_references": [
                            "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143"
                        ],
                        "tags": [
                            "cve-2017-0143"
                        ],
                        "rule_raw": "alert tcp any any -> any 445 (msg:\"ET EXPLOIT ETERNALBLUE Exploit M2 MS17-010\"; flow:established,to_server; content:\"|8000a80000000000000000000000000000000000ffff000000000000ffff0000000000000000000000000000000000000000000000f1dfff000000000000000020f0dfff00f1dfffffffffff600004100000000080efdfff|\"; reference:cve,CVE-2017-0143; classtype:attempted-admin; sid:2024297; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2017_05_16, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "ATTACK [PTsecurity] SMB2 Create PSEXESVC.EXE",
                        "rule_category": "A suspicious filename was detected",
                        "rule_id": "1:10001444",
                        "alert_severity": "medium",
                        "rule_source": "Positive Technologies: PT Open Ruleset",
                        "rule_url": "https://github.com/ptresearch/AttackDetection/",
                        "rule_references": [
                            "https://github.com/ptresearch/AttackDetection"
                        ],
                        "rule_raw": "alert smb any any -> $HOME_NET any (msg:\"ATTACK [PTsecurity] SMB2 Create PSEXESVC.EXE\"; flow:to_server, established, no_stream; content: \"|fe 53 4d 42|\"; offset: 4; depth: 4; content: \"|05 00|\"; offset: 16; depth: 2; byte_jump: 2, 112, little, from_beginning, post_offset 4; content:\"|50 00 53 00 45 00 58 00 45 00 53 00 56 00 43 00 2e 00 45 00 58 00 45|\"; distance:0; classtype:suspicious-filename-detect; reference: url, github.com/ptresearch/AttackDetection; sid: 10001444; rev:1;)"
                    },
                    {
                        "rule_msg": "ET POLICY SMB2 NT Create AndX Request For an Executable File",
                        "rule_category": "Potentially Bad Traffic",
                        "rule_id": "1:2025701",
                        "alert_severity": "low",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_raw": "alert tcp any any -> $HOME_NET 445 (msg:\"ET POLICY SMB2 NT Create AndX Request For an Executable File\"; flow:established,to_server; content:\"SMB\"; depth:8; content:\"|05 00|\"; distance:8; within:2; content:\"|00 2E 00|e|00|x|00|e|00|\"; nocase; distance:0; classtype:bad-unknown; sid:2025701; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target SMB_Client, created_at 2018_07_16, deployment Perimeter, signature_severity Minor, updated_at 2019_07_26;)"
                    },
                    {
                        "rule_msg": "ET POLICY PsExec service created",
                        "rule_category": "A suspicious filename was detected",
                        "rule_id": "1:2010781",
                        "alert_severity": "medium",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_references": [
                            "https://xinn.org/Snort-psexec.html"
                        ],
                        "rule_raw": "alert tcp any any -> $HOME_NET [139,445] (msg:\"ET POLICY PsExec service created\"; flow:to_server,established; content:\"P|00|S|00|E|00|X|00|E|00|S|00|V|00|C\"; nocase; reference:url,xinn.org/Snort-psexec.html; classtype:suspicious-filename-detect; sid:2010781; rev:3; metadata:created_at 2010_07_30, updated_at 2019_07_26;)"
                    }
                ],
                "has_memdump": false,
                "mutexes_created": [
                    "RasPbFile"
                ],
                "mitre_attack_techniques": [
                    {
                        "id": "T1045",
                        "signature_description": "Manalize Local SandBox Packer Harvesting"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "get common file path"
                    },
                    {
                        "id": "T1129",
                        "signature_description": "parse PE header"
                    },
                    {
                        "id": "T1027",
                        "signature_description": "encrypt data using RC4 PRGA"
                    },
                    {
                        "id": "T1129",
                        "signature_description": "forwarded export"
                    },
                    {
                        "id": "T1543.003",
                        "signature_description": "create service"
                    },
                    {
                        "id": "T1569.002",
                        "signature_description": "create service"
                    },
                    {
                        "id": "T1569.002",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1083",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1129",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1027",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    },
                    {
                        "id": "T1543.003",
                        "signature_description": "Created network traffic indicative of malicious activity"
                    }
                ],
                "has_pcap": true,
                "sandbox_name": "Yomi Hunter"
            }
        }
    ],
    "meta": {
        "count": 3
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/e83cff5322e8e8d608328b33c5cc62a31e2370530d80e735ddbc5a477e6579ec/behaviours?limit=10"
    }
}