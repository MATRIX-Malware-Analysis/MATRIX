{
    "data": [
        {
            "id": "a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_C2AE",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_C2AE"
            },
            "attributes": {
                "last_modification_date": 1693890770,
                "processes_tree": [
                    {
                        "process_id": "2808",
                        "name": "%CONHOST% \"-20143975152062326351-19949094081490154674-1842695749-874144522-2018164631490633486"
                    },
                    {
                        "process_id": "1284",
                        "name": "wmiadap.exe /F /T /R"
                    },
                    {
                        "process_id": "2204",
                        "name": "%windir%\\system32\\wbem\\wmiprvse.exe"
                    },
                    {
                        "process_id": "2692",
                        "name": "%SAMPLEPATH%",
                        "children": [
                            {
                                "process_id": "2796",
                                "name": "%ComSpec% /c \"\"%TEMP%\\ratt.bat\" \"",
                                "children": [
                                    {
                                        "process_id": "2844",
                                        "time_offset": 1,
                                        "name": "%ComSpec% /c wmic ComputerSystem get Domain",
                                        "children": [
                                            {
                                                "process_id": "2852",
                                                "time_offset": 2,
                                                "name": "wmic  ComputerSystem get Domain"
                                            }
                                        ]
                                    },
                                    {
                                        "process_id": "2824",
                                        "time_offset": 1,
                                        "name": "%ComSpec% /c nslookup myip.opendns.com. resolver1.opendns.com",
                                        "children": [
                                            {
                                                "process_id": "2832",
                                                "time_offset": 1,
                                                "name": "nslookup  myip.opendns.com. resolver1.opendns.com"
                                            }
                                        ]
                                    },
                                    {
                                        "process_id": "2908",
                                        "name": "Powershell  -Command 'Add-MpPreference -ExclusionPath \"%TEMP%\\ratt.exe\"'",
                                        "children": [
                                            {
                                                "process_id": "2928",
                                                "time_offset": 3,
                                                "name": "\"pwsh.exe\" -Command 'Add-MpPreference -ExclusionPath %TEMP%\\ratt.exe'"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "sandbox_name": "C2AE",
                "verdicts": [
                    "UNKNOWN_VERDICT"
                ],
                "has_pcap": false,
                "command_executions": [
                    "%SAMPLEPATH%",
                    "%ComSpec% /c wmic ComputerSystem get Domain",
                    "wmic  ComputerSystem get Domain",
                    "%ComSpec% /c nslookup myip.opendns.com. resolver1.opendns.com",
                    "nslookup  myip.opendns.com. resolver1.opendns.com",
                    "\"pwsh.exe\" -Command 'Add-MpPreference -ExclusionPath %TEMP%\\ratt.exe'"
                ],
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "208.67.222.222",
                            "2620:119:35::35"
                        ],
                        "hostname": "resolver1.opendns.com"
                    },
                    {
                        "hostname": "222.222.67.208.in-addr.arpa"
                    },
                    {
                        "hostname": "myip.opendns.com"
                    }
                ],
                "has_html_report": false,
                "behash": "c8d064c40f4171228a87c2304a717e98",
                "analysis_date": 1693804329,
                "has_memdump": false,
                "has_evtx": false,
                "processes_terminated": [
                    "wmiadap.exe /F /T /R",
                    "%SAMPLEPATH%",
                    "%ComSpec% /c wmic ComputerSystem get Domain",
                    "wmic  ComputerSystem get Domain",
                    "%ComSpec% /c nslookup myip.opendns.com. resolver1.opendns.com",
                    "nslookup  myip.opendns.com. resolver1.opendns.com",
                    "\"pwsh.exe\" -Command 'Add-MpPreference -ExclusionPath %TEMP%\\ratt.exe'"
                ]
            }
        },
        {
            "id": "a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_CAPA"
            },
            "attributes": {
                "last_modification_date": 1707689162,
                "sandbox_name": "CAPA",
                "has_pcap": false,
                "mbc": [
                    {
                        "objective": "Defense Evasion",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "id": "E1027.m02",
                        "behavior": "Obfuscated Files or Information",
                        "method": "Encoding-Standard Algorithm"
                    },
                    {
                        "objective": "Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "id": "C0026.002",
                        "behavior": "Encode Data",
                        "method": "XOR"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open file"
                            }
                        ],
                        "id": "C0016",
                        "behavior": "Create File"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get file attributes"
                            }
                        ],
                        "id": "C0049",
                        "behavior": "Get File Attributes"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set file attributes"
                            }
                        ],
                        "id": "C0050",
                        "behavior": "Set File Attributes"
                    },
                    {
                        "objective": "Anti-Behavioral Analysis",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delay execution"
                            }
                        ],
                        "id": "B0003.003",
                        "behavior": "Dynamic Analysis Evasion",
                        "method": "Delayed Execution"
                    },
                    {
                        "objective": "Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create thread"
                            }
                        ],
                        "id": "C0038",
                        "behavior": "Create Thread"
                    },
                    {
                        "objective": "Anti-Behavioral Analysis",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "PEB access"
                            }
                        ],
                        "id": "B0001.019",
                        "behavior": "Debugger Detection",
                        "method": "Process Environment Block"
                    },
                    {
                        "objective": "Operating System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open registry key"
                            }
                        ],
                        "id": "C0036.004",
                        "behavior": "Registry",
                        "method": "Create Registry Key"
                    },
                    {
                        "objective": "Operating System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create or open registry key"
                            }
                        ],
                        "id": "C0036.003",
                        "behavior": "Registry",
                        "method": "Open Registry Key"
                    },
                    {
                        "objective": "Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create process on Windows"
                            }
                        ],
                        "id": "C0017",
                        "behavior": "Create Process"
                    },
                    {
                        "objective": "Cryptography",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hash data using SHA256"
                            }
                        ],
                        "id": "C0029.003",
                        "behavior": "Cryptographic Hash",
                        "method": "SHA256"
                    },
                    {
                        "objective": "Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hash data with CRC32"
                            }
                        ],
                        "id": "C0032.001",
                        "behavior": "Checksum",
                        "method": "CRC32"
                    },
                    {
                        "objective": "Cryptography",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "authenticate HMAC"
                            }
                        ],
                        "id": "C0061",
                        "behavior": "Hashed Message Authentication Code"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete directory"
                            }
                        ],
                        "id": "C0048",
                        "behavior": "Delete Directory"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create directory"
                            }
                        ],
                        "id": "C0046",
                        "behavior": "Create Directory"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "delete file"
                            }
                        ],
                        "id": "C0047",
                        "behavior": "Delete File"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "move file"
                            }
                        ],
                        "id": "C0063",
                        "behavior": "Move File"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "read file on Windows"
                            }
                        ],
                        "id": "C0051",
                        "behavior": "Read File"
                    },
                    {
                        "objective": "Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "check if file exists"
                            }
                        ],
                        "id": "E1083",
                        "behavior": "File and Directory Discovery"
                    },
                    {
                        "objective": "File System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "write file on Windows"
                            }
                        ],
                        "id": "C0052",
                        "behavior": "Writes File"
                    },
                    {
                        "objective": "Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate files on Windows"
                            }
                        ],
                        "id": "E1083",
                        "behavior": "File and Directory Discovery"
                    },
                    {
                        "objective": "Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ],
                        "id": "E1083",
                        "behavior": "File and Directory Discovery"
                    },
                    {
                        "objective": "Cryptography",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "decrypt data using AES via x86 extensions"
                            }
                        ],
                        "id": "C0031.001",
                        "behavior": "Decrypt Data",
                        "method": "AES"
                    },
                    {
                        "objective": "Cryptography",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hash data using SHA1"
                            }
                        ],
                        "id": "C0029.002",
                        "behavior": "Cryptographic Hash",
                        "method": "SHA1"
                    },
                    {
                        "objective": "Data",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hash data using murmur3"
                            }
                        ],
                        "id": "C0030.001",
                        "behavior": "Non-Cryptographic Hash",
                        "method": "MurmurHash"
                    },
                    {
                        "objective": "Process",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "terminate process"
                            }
                        ],
                        "id": "C0018",
                        "behavior": "Terminate Process"
                    },
                    {
                        "objective": "Defense Evasion",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "bypass Windows File Protection"
                            }
                        ],
                        "id": "F0004.007",
                        "behavior": "Disable or Evade Security Tools",
                        "method": "Bypass Windows File Protection"
                    },
                    {
                        "objective": "Operating System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry value"
                            }
                        ],
                        "id": "C0036.006",
                        "behavior": "Registry",
                        "method": "Query Registry Value"
                    },
                    {
                        "objective": "Discovery",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query environment variable"
                            }
                        ],
                        "id": "E1082",
                        "behavior": "System Information Discovery"
                    },
                    {
                        "objective": "Execution",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "accept command line arguments"
                            }
                        ],
                        "id": "E1059",
                        "behavior": "Command and Scripting Interpreter"
                    },
                    {
                        "objective": "Operating System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set registry value"
                            }
                        ],
                        "id": "C0036.001",
                        "behavior": "Registry",
                        "method": "Set Registry Key"
                    },
                    {
                        "objective": "Operating System",
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set environment variable"
                            }
                        ],
                        "id": "C0034.001",
                        "behavior": "Environment Variable",
                        "method": "Set Variable"
                    }
                ],
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
                        "name": "encode data using XOR",
                        "description": "data-manipulation/encoding/xor"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n      - api: stat\n      - api: fstat\n      - api: lstat\n      - api: fstatat\n",
                        "name": "get file attributes",
                        "description": "host-interaction/file-system/meta"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Defense Evasion::File and Directory Permissions Modification [T1222]\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015f0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n  features:\n    - or:\n      - api: kernel32.SetFileAttributes\n      - api: ZwSetInformationFile\n      - api: NtSetInformationFile\n      - api: System.IO.File::SetAttributes\n      - api: System.IO.File::SetCreationTime\n      - api: System.IO.File::SetCreationTimeUtc\n      - api: System.IO.File::SetLastAccessTime\n      - api: System.IO.File::SetLastAccessTimeUtc\n      - api: System.IO.File::SetLastWriteTime\n      - api: System.IO.File::SetLastWriteTimeUtc\n      - property/write: System.IO.FileSystemInfo::Attributes\n      - api: utime\n      - api: utimes\n",
                        "name": "set file attributes",
                        "description": "host-interaction/file-system/meta"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                        "name": "delay execution",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@ramen0x3f"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - os: linux\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n",
                        "name": "create thread",
                        "description": "host-interaction/thread/create"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n",
                        "name": "PEB access",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hide graphical window\n    namespace: host-interaction/gui/window/hide\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Defense Evasion::Hide Artifacts::Hidden Window [T1564.003]\n    examples:\n      - 39C05B15E9834AC93F206BC114D0A00C357C888DB567BA8F5345DA0529CBED41:0x10007250\n  features:\n    - and:\n      - number: 0x0 = SW_HIDE\n      - api: user32.ShowWindow\n",
                        "name": "hide graphical window",
                        "description": "host-interaction/gui/window/hide"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n",
                        "name": "create or open registry key",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n",
                        "name": "create process on Windows",
                        "description": "host-interaction/process/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get file system object information\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    examples:\n      - 50D5EE1CE2CA5E30C6B1019EE64EEEC2:0x403538\n  features:\n    - or:\n      - api: SHGetFileInfo\n",
                        "name": "get file system object information",
                        "description": "host-interaction/file-system"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "description": "data-manipulation/hashing/sha256",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://www.rfc-editor.org/rfc/rfc6234"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using SHA256\n    namespace: data-manipulation/hashing/sha256\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Cryptography::Cryptographic Hash::SHA256 [C0029.003]\n    references:\n      - https://www.rfc-editor.org/rfc/rfc6234\n    examples:\n      - C0CFFCF211035A839E28D542DE300298:0x180011400\n      - 6CC148363200798A12091B97A17181A1:0x140120240\n      - 44d40faf3f1fe4ed969befab7afcd2f0:0x10033570\n  features:\n    - or:\n      - and:\n        - number: 0x6A09E667 = H(0)0\n        - number: 0xBB67AE85 = H(0)1\n        - number: 0x3C6EF372 = H(0)2\n        - number: 0xA54FF53A = H(0)3\n        - number: 0x510E527F = H(0)4\n        - number: 0x9B05688C = H(0)5\n        - number: 0x1F83D9AB = H(0)6\n        - number: 0x5BE0CD19 = H(0)7\n      - bytes: 67 E6 09 6A 85 AE 67 BB 72 F3 6E 3C 3A F5 4F A5 7F 52 0E 51 8C 68 05 9B AB D9 83 1F 19 CD E0 5B = H(0)\n      - and:\n        # there are 64 constants but we'll only include 8 here for simplicity\n        - number: 0x428a2f98\n        - number: 0x71374491\n        - number: 0xb5c0fbcf\n        - number: 0xe9b5dba5\n        - number: 0x3956c25b\n        - number: 0x59f111f1\n        - number: 0x923f82a4\n        - number: 0xab1c5ed5\n        - not:\n          - or:\n            - number: 0xd728ae22 = lower half of SHA512 constant, 0x428a2f98d728ae22\n            - number: 0x23ef65cd = lower half of SHA512 constant, 0x7137449123ef65cd\n      - and:\n        - format: dotnet\n        - or:\n          - api: System.Security.Cryptography.SHA256Managed::Initialize\n          - api: System.Security.Cryptography.SHA256CryptoServiceProvider::Initialize\n          - api: System.Security.Cryptography.SHA256::Create\n          - api: System.Security.Cryptography.SHA256Managed::ctor\n        - api: System.Security.Cryptography.HashAlgorithm::ComputeHash\n",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com",
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "hash data using SHA256"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "description": "load-code/pe"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data with CRC32\n    namespace: data-manipulation/checksum/crc32\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires operand[1].number, characteristic, bytes, mnemonic features\n    mbc:\n      - Data::Checksum::CRC32 [C0032.001]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403CBD\n      - 7D28CB106CB54876B2A5C111724A07CD:0x402350  # RtlComputeCrc32\n      - 7EFF498DE13CC734262F87E6B3EF38AB:0x100084A6\n  features:\n    - or:\n      - and:\n        - number: 1 = bits in a byte\n        - instruction:\n          - description: is bit set?\n          - or:\n            - mnemonic: and\n            - mnemonic: test\n          - operand[1].number: 1\n        - instruction:\n          - mnemonic: shr\n          - number: 1\n        - characteristic: nzxor\n        - operand[1].number: 0xEDB88320\n      - and:\n        - number: 0x8320\n        - number: 0xEDB8\n        - characteristic: nzxor\n      - api: RtlComputeCrc32\n      - bytes: 00 00 00 00 96 30 07 77 2C 61 0E EE BA 51 09 99 19 C4 6D 07 8F F4 6A 70 35 A5 63 E9 A3 95 64 9E = crc32_tab\n",
                        "name": "hash data with CRC32",
                        "description": "data-manipulation/checksum/crc32"
                    },
                    {
                        "description": "data-manipulation/hmac",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://tools.ietf.org/html/rfc2104"
                            },
                            {
                                "ref": "https://tools.ietf.org/html/rfc4634"
                            },
                            {
                                "ref": "https://github.com/ogay/hmac"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: authenticate HMAC\n    namespace: data-manipulation/hmac\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    mbc:\n      - Cryptography::Hashed Message Authentication Code [C0061]\n    references:\n      - https://tools.ietf.org/html/rfc2104\n      - https://tools.ietf.org/html/rfc4634\n      - https://github.com/ogay/hmac\n    examples:\n      - mimikatz.exe_:0x403408\n  features:\n    - and:\n      # block-sized inner padding, consisting of repeated bytes valued 0x36\n      - number: 0x36 = inner padding byte value\n      # block-sized outer padding, consisting of repeated bytes valued 0x5c\n      - number: 0x5C = outer padding byte value\n      - match: contain loop\n      - count(characteristic(nzxor)): 2 or more\n      - optional:\n        - description: block size\n        - number: 64 = MD5, SHA-1, SHA-224, or SHA-256\n        - number: 128 = SHA-384 or SHA-512\n",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "name": "authenticate HMAC"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete directory\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Delete Directory [C0048]\n    examples:\n      - Practical Malware Analysis Lab 05-01.dll_:0x10009236\n      - AFB6EC3D721A5CB67863487B0E51A34C167F629CF701F8BC7A038C117B4DDA44:0x429AA0\n  features:\n    - or:\n      - api: RemoveDirectory\n      - api: RemoveDirectoryTransacted\n      - api: rmdir\n      - api: _rmdir\n      - api: _wrmdir\n      - api: System.IO.DirectoryInfo::Delete\n      - api: System.IO.Directory::Delete\n",
                        "name": "delete directory",
                        "description": "host-interaction/file-system/delete"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create directory\n    namespace: host-interaction/file-system/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Create Directory [C0046]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x10008f62\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.CreateDirectory\n      - api: kernel32.CreateDirectoryEx\n      - api: kernel32.CreateDirectoryTransacted\n      - api: NtCreateDirectoryObject\n      - api: ZwCreateDirectoryObject\n      - api: SHCreateDirectory\n      - api: SHCreateDirectoryEx\n      - api: mkdir\n      - api: _mkdir\n      - api: _wmkdir\n      - api: System.IO.Directory::CreateDirectory\n      - api: System.IO.DirectoryInfo::Create\n      - api: System.IO.DirectoryInfo::CreateSubdirectory\n",
                        "name": "create directory",
                        "description": "host-interaction/file-system/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: interact with driver via control codes\n    namespace: host-interaction/driver\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 10-03.exe_:0x401000\n      - 9412A66BC81F51A1FA916AC47C77E02AC1A7C9DFF543233ED70AA265EF6A1E76:0x10002DE0\n  features:\n    - or:\n      - api: DeviceIoControl\n      - api: NtUnloadDriver\n      - api: ZwUnloadDriver\n      - and:\n        - number: 38 = SystemLoadAndCallImage\n        - api: ZwSetSystemInformation\n",
                        "name": "interact with driver via control codes",
                        "description": "host-interaction/driver"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n",
                        "name": "delete file",
                        "description": "host-interaction/file-system/delete"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: modify access privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403BE0\n  features:\n    - and:\n      - api: advapi32.AdjustTokenPrivileges\n      - optional:\n        - or:\n          - api: advapi32.LookupPrivilegeValue\n",
                        "name": "modify access privileges",
                        "description": "host-interaction/process/modify"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n",
                        "name": "move file",
                        "description": "host-interaction/file-system/move"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n",
                        "name": "read file on Windows",
                        "description": "host-interaction/file-system/read"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n",
                        "name": "check if file exists",
                        "description": "host-interaction/file-system/exists"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n",
                        "name": "write file on Windows",
                        "description": "host-interaction/file-system/write"
                    },
                    {
                        "description": "host-interaction/file-system/files/list",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: enumerate files on Windows\n    namespace: host-interaction/file-system/files/list\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    references:\n      - https://github.com/hfiref0x/TDL/blob/cc4b46ae1c939b14a22a734a727b163f873a41b5/Source/Furutaka/sup.c#L315\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x4011E0\n      - Practical Malware Analysis Lab 20-02.exe_:0x401000\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x14000203C\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.FindFirstFile\n          - api: kernel32.FindFirstFileEx\n          - api: kernel32.FindFirstFileTransacted\n          - api: kernel32.FindFirstFileName\n          - api: kernel32.FindFirstFileNameTransacted\n        - or:\n          - api: kernel32.FindNextFile\n          - api: kernel32.FindNextFileName\n        - optional:\n          - api: kernel32.FindClose\n          - match: contain loop\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 1 = DIRECTORY_QUERY\n              - api: ntdll.NtOpenDirectoryObject\n          - call:\n            - and:\n              - number: 1 = DIRECTORY_QUERY\n              - api: ntdll.NtOpenDirectoryObject\n        - api: ntdll.NtQueryDirectoryObject\n        - optional:\n          - api: RtlAllocateHeap\n          - match: contain loop\n          - characteristic: indirect call\n",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "name": "enumerate files on Windows"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n      - api: GetProductInfo\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - or:\n              - offset: 0xA4 = PEB->OSMajorVersion\n              - offset: 0xA8 = PEB->OSMinorVersion\n              - offset: 0xAC = PEB->OSBuildNumber\n          - and:\n            - arch: amd64\n            - or:\n              - offset: 0x118 = PEB->OSMajorVersion\n              - offset: 0x11C = PEB->OSMinorVersion\n              - offset: 0x120 = PEB->OSBuildNumber\n",
                        "name": "get OS version",
                        "authors": [
                            "@mr-tz"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n",
                        "name": "get common file path",
                        "description": "host-interaction/file-system"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: decrypt data using AES via x86 extensions\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    att&ck:\n      - Defense Evasion::Deobfuscate/Decode Files or Information [T1140]\n    mbc:\n      - Cryptography::Decrypt Data::AES [C0031.001]\n    examples:\n      - 66602B5FAB602CB4E6F754748D249542:0x4097D0\n  features:\n    - or:\n      - mnemonic: aesdec = Perform One Round of an AES Decryption Flow\n      - mnemonic: vaesdec\n      - mnemonic: aesdeclast = Perform Last Round of an AES Decryption Flow\n      - mnemonic: vaesdeclast\n",
                        "name": "decrypt data using AES via x86 extensions",
                        "description": "data-manipulation/encryption/aes"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using SHA1\n    namespace: data-manipulation/hashing/sha1\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Cryptography::Cryptographic Hash::SHA1 [C0029.002]\n    examples:\n      - D063B1804E8D2BB26BD2E097141C1BBC:0x4344D0\n      - 91B08896FBDA9EDB8B6F93A6BC811EC6:0x180004878\n  features:\n    - or:\n      - and:\n        - description: Magic initialization constants used in SHA1\n        - number: 0x67452301 = A, also used in MD5, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0xEFCDAB89 = B, also used in MD5, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x98BADCFE = C, also used in MD5, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x10325476 = D, also used in MD5, RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0xC3D2E1F0 = likely SHA1 but also used in RIPEMD-160 and RIPEMD-320\n      - and:\n        - number: 0x5A827999 = K(t) (0 <= t <= 19), also used in RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x6ED9EBA1 = K(t) (20 <= t <= 39), also used in RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0x8F1BBCDC = K(t) (40 <= t <= 59), also used in RIPEMD-128, RIPEMD-160, RIPEMD-256, and RIPEMD-320\n        - number: 0xCA62C1D6 = K(t) (60 <= t <= 79), also used in RIPEMD-160 and RIPEMD-320\n      - basic block:\n        - and:\n          - number: 0x8004 = CALG_SHA1\n          - api: advapi32.CryptCreateHash\n      - call:\n        - and:\n          - number: 0x8004 = CALG_SHA1\n          - api: advapi32.CryptCreateHash\n      - and:\n        - api: System.Security.Cryptography.SHA1Managed::ctor\n        - optional:\n          - api: System.Security.Cryptography.HashAlgorithm::ComputeHash\n",
                        "name": "hash data using SHA1",
                        "description": "data-manipulation/hashing/sha1"
                    },
                    {
                        "description": "data-manipulation/hashing/murmur",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://github.com/aappleby/smhasher/blob/master/src/MurmurHash3.cpp"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using murmur3\n    namespace: data-manipulation/hashing/murmur\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic features\n    mbc:\n      - Data::Non-Cryptographic Hash::MurmurHash [C0030.001]\n    references:\n      - https://github.com/aappleby/smhasher/blob/master/src/MurmurHash3.cpp\n    examples:\n      - c66172b12971a329f8d5ff01665f204b:0x404A18\n  features:\n    - or:\n      - and:\n        - number: 0x85ebca6b = 32-bit finalization mix constant 1\n        - number: 0xc2b2ae35 = 32-bit finalization mix constant 2\n      - and:\n        - number: 0xff51afd7ed558ccd = 64-bit finalization mix constant 1\n        - number: 0xc4ceb9fe1a85ec53 = 64-bit finalization mix constant 2\n      - and:\n        - number: 0xcc9e2d51 = c1 32-bit hash\n        - number: 0x1b873593 = c2 32-bit hash\n      - and:\n        - number: 0x239b961b = 32-bit c1 for 128-bit hash\n        - number: 0xab0e9789 = 32-bit c2 for 128-bit hash\n        - number: 0x38b34ae5 = 32-bit c3 for 128-bit hash\n        - number: 0xa1e38b93 = 32-bit c4 for 128-bit hash\n      - and:\n        - number: 0x87c37b91114253d5 = 64-bit c1 for 128-bit hash\n        - number: 0x4cf5ad432745937f = 64-bit c2 for 128-bit hash\n      - basic block:\n        - and:\n          - description: 'hash >> 16; hash >> 13; hash >> 16'\n          - count(mnemonic(shr)): 3\n          - instruction:\n            - mnemonic: shr\n            - number: 16\n          - instruction:\n            - mnemonic: shr\n            - number: 13\n          - optional:\n            - count(characteristic(nzxor)): 3 or more\n      - and:\n        # Group this two blocks under an `and` as on their own they are not\n        # unique enough and would cause false positives\n        - instruction:\n          - description: k ROL r1\n          - mnemonic: rol\n          - number: 15 = r1\n        - instruction:\n          - description: hash ROL r2\n          - mnemonic: rol\n          - number: 13 = r2\n",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "name": "hash data using murmur3"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get token membership\n    namespace: host-interaction/session\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n    examples:\n      - mimikatz.exe_:0x40DABE\n  features:\n    - and:\n      - api: advapi32.CheckTokenMembership\n      - optional:\n        - api: advapi32.AllocateAndInitializeSid\n        - api: advapi32.FreeSid\n",
                        "name": "get token membership",
                        "description": "host-interaction/session"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n",
                        "name": "terminate process",
                        "description": "host-interaction/process/terminate"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: bypass Windows File Protection\n    namespace: host-interaction/file-system/windows-file-protection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Defense Evasion::Disable or Evade Security Tools::Bypass Windows File Protection [F0004.007]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401174\n  features:\n    - and:\n      - string: \"sfc_os.dll\"\n        description: System File Checker\n      - number: 0x2 = SfcTerminateWatcherThread\n      - match: linking/runtime-linking\n",
                        "name": "bypass Windows File Protection",
                        "description": "host-interaction/file-system/windows-file-protection"
                    },
                    {
                        "description": "persistence",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/shell/links#creating-a-shortcut-and-a-folder-shortcut-to-a-file"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: create shortcut via IShellLink\n    namespace: persistence\n    authors:\n      - matthew.williams@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires offset, bytes features\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Shortcut Modification [T1547.009]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/shell/links#creating-a-shortcut-and-a-folder-shortcut-to-a-file\n    examples:\n      - 7f403f7d643d90c7cbadf3ccfc68bd1badf06f89a35af5fc7811920e820bbcc9:0x10001380\n  features:\n    - and:\n      - bytes: 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46 = CLSID_ShellLink\n      - or:\n        - bytes: EE 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46 = IID_IShellLinkA\n        - bytes: F9 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46 = IID_IShellLinkW\n      - bytes: 0B 01 00 00 00 00 00 00 C0 00 00 00 00 00 00 46 = IID_IPersistFile\n      - offset: 0x50 = psl->SetPath\n      - offset: 0x18 = ppf->Save\n      - api: ole32.CoCreateInstance\n",
                        "authors": [
                            "matthew.williams@mandiant.com"
                        ],
                        "name": "create shortcut via IShellLink"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n",
                        "name": "extract resource via kernel32 functions",
                        "description": "executable/resource"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n",
                        "name": "find graphical window",
                        "description": "host-interaction/gui/window/find"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set current directory\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.IO.Directory::SetCurrentDirectory\n      - api: kernel32.SetCurrentDirectory\n      - api: chdir\n      - api: fchdir\n",
                        "name": "set current directory",
                        "description": "host-interaction/file-system"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: get geographical location\n    namespace: collection\n    authors:\n      - moritz.raabe\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::System Location Discovery [T1614]\n    examples:\n      - 9879D201DC5ACA863F357184CD1F170E:0x10001A99\n  features:\n    - or:\n      - api: GetLocaleInfo\n      - api: GetLocaleInfoEx\n      - api: kernel32.GetUserGeoID\n      - api: kernel32.GetGeoInfo\n      # strings part of requests or parsed from response\n      # \"geo\" and \"zip\" are too short\n      # \"region\" results in FPs mostly related to memory\n      - string: /geolocation/i\n      - string: /geo-location/i\n      - string: /^city/i\n      - string: /region_code/i\n      - string: /region_name/i\n      - string: /^country/i\n      - string: /country_code/i\n      - string: /countrycode/i\n      - string: /country_name/i\n      - string: /continent_code/i\n      - string: /continent_name/i\n      - string: /^latitude/i\n      - string: /^longitude/i\n",
                        "name": "get geographical location",
                        "description": "collection"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "william.ballenthin@mandiant.com",
                            "michael.hunhoff@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n",
                        "name": "query or enumerate registry value",
                        "description": "host-interaction/registry"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@_re_fox"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n",
                        "name": "query environment variable",
                        "description": "host-interaction/environment-variable"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "anushka.virgaonkar@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    mbc:\n      - Execution::Command and Scripting Interpreter [E1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n",
                        "name": "accept command line arguments",
                        "description": "host-interaction/cli"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n",
                        "name": "set registry value",
                        "description": "host-interaction/registry/create"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: set environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Operating System::Environment Variable::Set Variable [C0034.001]\n    examples:\n      - 0731679c5f99e8ee65d8b29a3cabfc6b:0x43EA81\n  features:\n    - or:\n      - api: kernel32.SetEnvironmentStrings\n      - api: kernel32.SetEnvironmentVariable\n      - api: System.Environment::SetEnvironmentVariable\n",
                        "name": "set environment variable",
                        "description": "host-interaction/environment-variable"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n",
                        "name": "contains PDB path",
                        "description": "executable/pe/pdb"
                    }
                ],
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "set file attributes"
                            }
                        ],
                        "signature_description": "set file attributes",
                        "id": "T1222",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "hide graphical window"
                            }
                        ],
                        "signature_description": "hide graphical window",
                        "id": "T1564.003",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get file system object information"
                            }
                        ],
                        "signature_description": "get file system object information",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "interact with driver via control codes"
                            }
                        ],
                        "signature_description": "interact with driver via control codes",
                        "id": "T1569.002",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "modify access privileges"
                            }
                        ],
                        "signature_description": "modify access privileges",
                        "id": "T1134",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "check if file exists"
                            }
                        ],
                        "signature_description": "check if file exists",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "enumerate files on Windows"
                            }
                        ],
                        "signature_description": "enumerate files on Windows",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get common file path"
                            }
                        ],
                        "signature_description": "get common file path",
                        "id": "T1083",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "decrypt data using AES via x86 extensions"
                            }
                        ],
                        "signature_description": "decrypt data using AES via x86 extensions",
                        "id": "T1140",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ],
                        "signature_description": "link function at runtime on Windows",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get token membership"
                            }
                        ],
                        "signature_description": "get token membership",
                        "id": "T1033",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "create shortcut via IShellLink"
                            }
                        ],
                        "signature_description": "create shortcut via IShellLink",
                        "id": "T1547.009",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "find graphical window"
                            }
                        ],
                        "signature_description": "find graphical window",
                        "id": "T1010",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "get geographical location"
                            }
                        ],
                        "signature_description": "get geographical location",
                        "id": "T1614",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query or enumerate registry value"
                            }
                        ],
                        "signature_description": "query or enumerate registry value",
                        "id": "T1012",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "query environment variable"
                            }
                        ],
                        "signature_description": "query environment variable",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "accept command line arguments"
                            }
                        ],
                        "signature_description": "accept command line arguments",
                        "id": "T1059",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "has_html_report": false,
                "behash": "4e91baea32edf27857b1551adc8d274a",
                "analysis_date": 1707689160,
                "has_memdump": false,
                "has_evtx": false
            }
        },
        {
            "id": "a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_Sangfor ZSand",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_Sangfor ZSand"
            },
            "attributes": {
                "last_modification_date": 1721950254,
                "mutexes_created": [
                    "_SHuassist.mtx",
                    "Local\\_!MSFTHISTORY!_",
                    "Local\\c:!users!admin!appdata!local!microsoft!windows!temporary internet files!content.ie5!",
                    "Local\\c:!users!admin!appdata!roaming!microsoft!windows!cookies!",
                    "Local\\c:!users!admin!appdata!local!microsoft!windows!history!history.ie5!",
                    "Local\\WininetStartupMutex",
                    "Local\\WininetConnectionMutex",
                    "Local\\WininetProxyRegistryMutex",
                    "Local\\ZonesCounterMutex",
                    "Local\\ZoneAttributeCacheCounterMutex",
                    "Local\\ZonesCacheCounterMutex",
                    "Local\\ZonesLockedCacheCounterMutex"
                ],
                "registry_keys_set": [
                    {
                        "key": "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Internet Settings/ZoneMap//AutoDetect",
                        "value": "\u0001"
                    },
                    {
                        "key": "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Internet Settings/ZoneMap//UNCAsIntranet"
                    },
                    {
                        "key": "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Classes/Local Settings/MuiCache/2b/AAF68885/LanguageList",
                        "value": "zh-CN"
                    }
                ],
                "sandbox_name": "Sangfor ZSand",
                "memory_pattern_domains": [
                    "System.ComponentModel.Design",
                    "System.DirectoryServices.Design",
                    "LsjB.Bj",
                    "System.Runtime.Hosting",
                    "Microsoft.PowerShell.Commands.Management",
                    "Microsoft.Design",
                    "Microsoft.WSMan.Management",
                    "Lva.LvW.Lvk.Lv",
                    "sMicrosoft.PowerShell.Commands.Management",
                    "system.net",
                    "system.management.automation.host",
                    "System.Web.Services",
                    "microsoft.powershell.commands.management",
                    "cfgmgr32.CM",
                    "System.Management",
                    "microsoft.wsman.management",
                    "lSystem.Management.Automation.Help",
                    "jHt7Ht.Hu",
                    "system.componentmodel.design",
                    "system.io",
                    "go.microsoft.com",
                    "System.Runtime.Remoting.Services",
                    "system.media",
                    "www.w3.org",
                    "system.management.automation.internal.host",
                    "System.Net",
                    "system.runtime.remoting.services",
                    "System.IO",
                    "System.Web.Mobile",
                    "System.Management.Automation.Host",
                    "system.runtime.hosting",
                    "schemas.microsoft.com",
                    "System.Management.Automation.Internal.Host",
                    "System.Media",
                    "RRAS.Microsoft",
                    "system.directoryservices.design",
                    "System.Design",
                    "microsoftupdate.microsoft.com",
                    "ns.adobe.com",
                    "office.microsoft.com",
                    "resolver1.opendns.com",
                    "wustats.microsoft.com",
                    "windowsupdate.microsoft.com",
                    "download.microsoft.com",
                    "www.msn.com",
                    "microsoftupdate.com",
                    "2nhpT.nP",
                    "msdn.microsoft.com",
                    "myip.opendns.com",
                    "phR.phV.phR.ph",
                    "www.msdn.com",
                    "A.ROOT-SERVERS.NET",
                    "update.microsoft.com",
                    "support.microsoft.com",
                    "msdn.com",
                    "www.microsoft.com",
                    "system.management",
                    "windowsupdate.com",
                    "microsoft.com",
                    "System.Data.Com",
                    "u.in-addr.arpa"
                ],
                "processes_injected": [
                    "powershell.exe"
                ],
                "files_opened": [
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Data\\1e85062785e286cd9eae9c26d2c61f73\\System.Data.ni.dll",
                    "C:\\Windows\\system32\\NTDSAPI.dll",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\Y33QA2FKV51M6LV8ZV7Y.temp",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2828.172427",
                    "C:\\Windows\\system32\\UXTheme.dll.Config",
                    "C:\\Windows\\system32\\urlmon.dll",
                    "C:\\Windows\\system32\\netutils.dll",
                    "C:\\Windows\\system32\\sfc.dll",
                    "C:\\Windows\\system32\\srvcli.dll",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2432.101853",
                    "C:\\Users\\admin\\Favorites\\desktop.ini",
                    "C:\\Windows\\system32\\uxtheme.dll",
                    "C:\\Windows\\system32\\propsys.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2432.101681",
                    "C:\\Windows\\WindowsShell.Manifest",
                    "C:\\Windows\\system32\\ATL.DLL",
                    "C:\\Windows\\system32\\wbemcomn.dll",
                    "C:\\Windows\\WinSxS\\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.7523_none_508f21ccbcbbb7a8\\MSVCR90.dll",
                    "C:\\Users\\admin\\Links\\desktop.ini",
                    "C:\\Windows\\WinSxS\\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.6229_none_d089f796442de10e\\MSVCR80.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\Microsoft.PowerShel#\\82d7758f278f47dc4191abab1cb11ce3\\Microsoft.PowerShell.Commands.Utility.ni.dll",
                    "C:\\Windows\\system32\\version.dll",
                    "C:\\Windows\\system32\\shfolder.dll",
                    "C:\\Windows\\System32\\wship6.dll",
                    "C:\\Users\\admin\\Videos\\desktop.ini",
                    "C:\\Windows\\system32\\CRYPTSP.dll",
                    "C:\\Windows\\system32\\shell32.dll",
                    "C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Windows PowerShell",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Transactions\\ad18f93fc713db2c4b29b25116c13bd8\\System.Transactions.ni.dll",
                    "C:\\Windows\\system32\\WSOCK32.dll",
                    "C:\\Windows\\System32\\wshtcpip.dll",
                    "C:\\Windows\\system32\\wbem\\xml\\wmi2xml.dll",
                    "C:\\Windows\\system32\\riched20.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Xml\\461d3b6b3f43e6fbe6c897d5936e17e4\\System.Xml.ni.dll",
                    "C:\\Windows\\system32\\Secur32.dll",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\OPKMFBG9J0KY6O9PB2VY.temp",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\d93f411851d7c929.customDestinations-ms~RF29f4a.TMP",
                    "C:\\Users\\admin\\AppData\\Local\\Temp\\ratt.bat",
                    "C:\\Windows\\system32\\IMM32.DLL",
                    "C:\\Windows\\system32\\SHELL32.dll",
                    "C:\\Windows\\system32\\wbem\\wbemsvc.dll",
                    "C:\\Windows\\system32\\napinsp.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\culture.dll",
                    "C:\\Windows\\system32\\apphelp.dll",
                    "C:\\Windows\\system32\\DNSAPI.dll",
                    "C:\\Windows\\SYSTEM32\\sechost.dll",
                    "C:\\Users\\admin\\Downloads\\desktop.ini",
                    "C:\\Windows\\system32\\RpcRtRemote.dll",
                    "C:\\Users\\admin\\Searches\\desktop.ini",
                    "C:\\Windows\\assembly\\GAC_32\\System.Data\\2.0.0.0__b77a5c561934e089\\System.Data.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Configuratio#\\f02737c83305687a68c088927a6c5a98\\System.Configuration.Install.ni.dll",
                    "C:\\Windows\\assembly\\GAC_MSIL\\System.Management.Automation.resources\\1.0.0.0_zh-CHS_31bf3856ad364e35\\System.Management.Automation.resources.dll",
                    "C:\\Windows\\System32\\fwpuclnt.dll",
                    "C:\\Windows\\system32\\DEVRTL.dll",
                    "C:\\Users\\admin\\Contacts\\desktop.ini",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\Microsoft.PowerShel#\\583c7b9f52114c026088bdb9f19f64e8\\Microsoft.PowerShell.Commands.Management.ni.dll",
                    "C:\\Windows\\system32\\framedynos.dll",
                    "C:\\Program Files\\Common Files\\Microsoft Shared\\OFFICE14\\MSOXMLMF.DLL",
                    "C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_41e6975e2bd6f2b2\\comctl32.dll",
                    "C:\\Windows\\system32\\wbem\\fastprox.dll",
                    "C:\\Windows\\system32\\rasadhlp.dll",
                    "C:\\Windows\\system32\\SSPICLI.DLL",
                    "C:\\Windows\\system32\\ntshrui.dll",
                    "C:\\Windows\\assembly\\GAC_MSIL\\mscorlib.resources\\2.0.0.0_zh-CHS_b77a5c561934e089\\mscorlib.resources.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\Microsoft.PowerShel#\\6c5bef3ab74c06a641444eff648c0dde\\Microsoft.PowerShell.Security.ni.dll",
                    "C:\\Windows\\system32\\rsaenh.dll",
                    "C:\\Windows\\System32\\msxml3.dll",
                    "C:\\Windows\\system32\\sfc_os.dll",
                    "C:\\Windows\\system32\\LINKINFO.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\Microsoft.PowerShel#\\4bdde288f147e3b3f2c090ecdf704e6d\\Microsoft.PowerShell.ConsoleHost.ni.dll",
                    "C:\\Users\\admin\\Saved Games\\desktop.ini",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorjit.dll",
                    "C:\\Windows\\assembly\\GAC_MSIL\\Microsoft.PowerShell.Security.resources\\1.0.0.0_zh-CHS_31bf3856ad364e35\\Microsoft.PowerShell.Security.resources.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\Microsoft.WSMan.Man#\\f1865caa683ceb3d12b383a94a35da14\\Microsoft.WSMan.Management.ni.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\mscoreei.dll",
                    "C:\\Windows\\assembly\\GAC_MSIL\\Microsoft.PowerShell.ConsoleHost.resources\\1.0.0.0_zh-CHS_31bf3856ad364e35\\Microsoft.PowerShell.ConsoleHost.resources.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\Microsoft.PowerShel#\\e112e4460a0c9122de8c382126da4a2f\\Microsoft.PowerShell.Commands.Diagnostics.ni.dll",
                    "C:\\Windows\\system32\\vbscript.dll",
                    "C:\\Windows\\system32\\cryptbase.dll",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2980.196842",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2828.172334",
                    "C:\\Windows\\system32\\IPHLPAPI.DLL",
                    "C:\\Windows\\system32\\pnrpnsp.dll",
                    "C:\\Windows\\system32\\WINNSI.DLL",
                    "C:\\Windows\\system32\\cscapi.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2432.101681",
                    "C:\\Windows\\system32\\CRYPTBASE.dll",
                    "C:\\Windows\\system32\\WININET.dll",
                    "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                    "C:\\Windows\\system32\\rpcss.dll",
                    "C:\\Windows\\system32\\NLAapi.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Management\\6f3b99ed0b791ff4d8aa52f2f0cd0bcf\\System.Management.ni.dll",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\XFQMPNA27KBJXLGL9BSH.temp",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Core\\fbc05b5b05dc6366b02b8e2f77d080f1\\System.Core.ni.dll",
                    "C:\\Program Files\\Common Files\\microsoft shared\\ink\\tiptsf.dll",
                    "C:\\Windows\\system32\\PROPSYS.dll",
                    "C:\\Windows\\system32\\wbem\\wbemprox.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Management.A#\\a8e3a41ecbcc4bb1598ed5719f965110\\System.Management.Automation.ni.dll",
                    "C:\\Windows\\System32\\shdocvw.dll",
                    "C:\\Windows\\system32\\slc.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System\\9e0a3b9b9f457233a335d7fba8f95419\\System.ni.dll",
                    "C:\\Windows\\WinSxS\\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.17514_none_72d18a4386696c80\\gdiplus.dll",
                    "C:\\Windows\\system32\\WindowsCodecs.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorwks.dll",
                    "C:\\Windows\\system32\\mscoree.dll",
                    "C:\\Windows\\assembly\\GAC_MSIL\\Microsoft.WSMan.Management.resources\\1.0.0.0_zh-CHS_31bf3856ad364e35\\Microsoft.WSMan.Management.resources.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2828.172334",
                    "C:\\Windows\\assembly\\GAC_32\\System.Transactions\\2.0.0.0__b77a5c561934e089\\System.Transactions.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2980.196686",
                    "C:\\Windows\\system32\\MPR.dll",
                    "C:\\Windows\\System32\\Wbem\\WMIC.exe",
                    "C:\\Windows\\system32\\cmd.exe",
                    "C:\\Windows\\system32\\USERENV.dll",
                    "C:\\Windows\\system32\\dwmapi.dll",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\d93f411851d7c929.customDestinations-ms~RF2fe5a.TMP",
                    "C:\\Windows\\system32\\nslookup.exe",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.DirectorySer#\\45ec12795950a7d54691591c615a9e3c\\System.DirectoryServices.ni.dll",
                    "C:\\Windows\\system32\\profapi.dll",
                    "C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.17514_none_41e6975e2bd6f2b2\\COMCTL32.dll",
                    "C:\\Windows\\win.ini",
                    "C:\\Windows\\system32\\WTSAPI32.dll",
                    "C:\\Windows\\system32\\dnsapi.DLL",
                    "C:\\Windows\\system32\\WINBRAND.dll",
                    "C:\\Windows\\System32\\winrnr.dll",
                    "C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\mscorlib\\62a0b3e4b40ec0e8c5cfaa0c8848e64a\\mscorlib.ni.dll",
                    "C:\\Windows\\system32\\SXS.DLL",
                    "C:\\Windows\\system32\\secur32.dll",
                    "C:\\Windows\\system32\\MSWSOCK.DLL",
                    "C:\\Windows\\system32\\SspiCli.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2980.196686",
                    "C:\\Windows\\system32\\ntmarta.dll",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2948.200835",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\d93f411851d7c929.customDestinations-ms~RF30e80.TMP",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2576.124707",
                    "C:\\Windows\\system32\\dhcpcsvc6.DLL",
                    "C:\\Windows\\system32\\dhcpcsvc.DLL",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\FZI9QM7K2RRQMWAQB6GN.temp",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\JEPK76X4ZGBWG999OQBY.temp",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2576.124863",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2948.200991",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2576.124707",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2948.200835"
                ],
                "has_pcap": true,
                "ip_traffic": [
                    {
                        "transport_layer_protocol": "UDP",
                        "destination_ip": "114.114.114.114",
                        "destination_port": 53
                    },
                    {
                        "transport_layer_protocol": "UDP",
                        "destination_ip": "218.85.157.99",
                        "destination_port": 53
                    },
                    {
                        "transport_layer_protocol": "UDP",
                        "destination_ip": "208.67.222.222",
                        "destination_port": 53
                    }
                ],
                "processes_created": [
                    "C:\\Users\\admin\\AppData\\Local\\Temp\\ratt.bat ",
                    "C:\\Windows\\system32\\cmd.exe /c nslookup myip.opendns.com. resolver1.opendns.com",
                    "C:\\Windows\\system32\\cmd.exe /c wmic ComputerSystem get Domain",
                    "Powershell  -Command 'Add-MpPreference -ExclusionPath C:\\Users\\admin\\AppData\\Local\\Temp\\ratt.exe'",
                    "Powershell  -Command 'Add-MpPreference -ExclusionPath C:\\Users\\admin\\AppData\\Local\\Temp\\'",
                    "Powershell  -Command 'Add-MpPreference -ExclusionPath C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ratt.exe'",
                    "Powershell  -Command 'Add-MpPreference -ExclusionPath $Env:SystemDrive\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp'",
                    "C:\\a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0.exe",
                    "nslookup  myip.opendns.com. resolver1.opendns.com",
                    "wmic  ComputerSystem get Domain"
                ],
                "registry_keys_opened": [
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{77F10CF0-3DB5-4966-B520-B7C54FD35ED6}/InprocHandler",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/5569937f/27779ce9/3d",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Windows.Forms__b77a5c561934e089",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/2b1a4e4/38a3212c/4c",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.1.0.Microsoft.PowerShell.Commands.Utility__31bf3856ad364e35",
                    "HKCR/CLSID/{1F3427C8-5C10-4210-AA03-2EE45287D668}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}/InprocServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{660b90c8-73a9-4b58-8cae-355b7f55341b}/InprocHandler32",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/85e83df/4c239d82/79",
                    "HKCR/CLSID/{76765B11-3F95-4AF2-AC9D-EA55D8994F1A}",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Data__b77a5c561934e089",
                    "HKLM/SYSTEM/CurrentControlSet/Control/MUI/StringCacheSettings",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{DD313E04-FEFF-11d1-8ECD-0000F87A470C}/InprocHandler32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.EnterpriseServices__b03f5f7f11d50a3a",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{0139D44E-6AFE-49F2-8690-3DAFCAE6FFB8}/PropertyBag",
                    "HKLM/Software/Microsoft/PowerShell/1",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/424bd4d8/1c83327b/8d",
                    "HKCR/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.ServiceProcess__b03f5f7f11d50a3a",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer///UserAssist/{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System__b77a5c561934e089",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Policies/NonEnum",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{20D04FE0-3AEA-1069-A2D8-08002B30309D}",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{9E3995AB-1F9C-4F13-B827-48B24B6C7174}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/MountPoints2/CPC/Volume/{561ec7c4-eb9f-11e9-af89-806e6f6e6963}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/lnkfile/CLSID",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{603D3801-BD81-11d0-A3A5-00C04FD706EC}/InProcServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/StartPage",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{00021401-0000-0000-C000-000000000046}/InprocHandler32",
                    "HKCR/Drive/shellex/FolderExtensions/{fbeb8a05-beee-4442-804e-409d6c4515e9}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}/InprocHandler",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{2d3468c1-36a7-43b6-ac24-d3f02fd9607a}/InprocServer32",
                    "HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/ShellCompatibility/Objects/{1F3427C8-5C10-4210-AA03-2EE45287D668}",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/3a6a696d/52d7076e/7a",
                    "HKLM/SOFTWARE/Microsoft/PowerShell/1/PowerShellEngine",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/181938c6/7950e2c5/89",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/34cea914/43f5e26f",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Directory/BrowseInPlace",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/7ac727df/7b5311d7/69",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{76765b11-3f95-4af2-ac9d-ea55d8994f1a}/Progid",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/MountPoints2/CPC/Volume",
                    "HKCR/Drive/shellex/FolderExtensions",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/AllFilesystemObjects/DocObject",
                    "HKCR/CLSID/{20D04FE0-3AEA-1069-A2D8-08002B30309D}/ShellFolder",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/FileExts/.lnk/OpenWithProgids",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}/PropertyBag",
                    "HKCR/CLSID/{1F486A52-3CB1-48FD-8F50-B8DC300D9F9D}",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/5bec2d27/74219a81/3c",
                    "HKLM/SOFTWARE/Microsoft/OLE",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/181938c6/7950e2c5",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}/InprocServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}/InprocHandler",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{603D3801-BD81-11d0-A3A5-00C04FD706EC}/InprocHandler",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.1.0.Microsoft.WSMan.Runtime__31bf3856ad364e35",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Runtime.Serialization.Formatters.Soap__b03f5f7f11d50a3a",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/c991064/2bd33e1c/81",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Directory",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{A77F5D77-2E2B-44C3-A6A2-ABA601054A51}",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{625B53C3-AB48-4EC1-BA1F-A1EF4146FC19}",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{B97D20BB-F46A-4C97-BA10-5E3608430854}/PropertyBag",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{00021401-0000-0000-C000-000000000046}/InprocServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.1.0.Microsoft.PowerShell.Commands.Management__31bf3856ad364e35",
                    "HKLM",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{76765b11-3f95-4af2-ac9d-ea55d8994f1a}/InprocHandler",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{AE50C081-EBD2-438A-8655-8A092E34987A}/PropertyBag",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Transactions__b77a5c561934e089",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Policies/Explorer",
                    "HKLM/Software/Microsoft/.NETFramework",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}",
                    "HKCR/SystemFileAssociations/.lnk",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/Image File Execution Options/powershell.exe",
                    "HKLM/Software/Microsoft/PowerShell",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}/InprocHandler32",
                    "HKLM/SOFTWARE/Microsoft/Cryptography/Defaults/Provider/Microsoft Strong Cryptographic Provider",
                    "HKLM/SOFTWARE/Microsoft/.NETFramework/Policy/APTCA",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Control Panel/Desktop/MuiCached/MachineLanguageConfiguration",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{1777F761-68AD-4D8A-87BD-30B759FA33DD}/PropertyBag",
                    "HKLM/System/CurrentControlSet/Control/Srp/GP/DLL",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}/Progid",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}/Progid",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/SessionInfo/1",
                    "HKCR/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}",
                    "HKLM/Software/Microsoft/.NETFramework/Policy/AppPatch/v4.0.30319.00000/mscorwks.dll",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/39f21844/6a1fd7fc/2b",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/SystemFileAssociations/.lnk/DocObject",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{00021401-0000-0000-C000-000000000046}/ProgID",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/FileAssociation/StartMenu",
                    "HKCR/CLSID/{20D04FE0-3AEA-1069-A2D8-08002B30309D}",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{9E3995AB-1F9C-4F13-B827-48B24B6C7174}/PropertyBag",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{5E6C858F-0E22-4760-9AFE-EA3317B67173}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{76765b11-3f95-4af2-ac9d-ea55d8994f1a}/InProcServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{DD313E04-FEFF-11d1-8ECD-0000F87A470C}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/56d30baa/7df4ed04/3b",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Folder/BrowseInPlace",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Setup",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/141dfd70/6b79efab/4b",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/SessionInfo/1/KnownFolders",
                    "HKLM/Software/Policies/Microsoft/Cryptography",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{1777F761-68AD-4D8A-87BD-30B759FA33DD}",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/AppCompatFlags/Custom/shdocvw.dll",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}/InprocHandler32",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{7C5A40EF-A0FB-4BFC-874A-C0F2E0B9FA8E}",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/73843e06/43a920ef/6e",
                    "HKLM/System/CurrentControlSet/Control/Lsa/FipsAlgorithmPolicy",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/41c04c7e/7f3b6ac4/80",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Management__b03f5f7f11d50a3a",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Web.Services__b03f5f7f11d50a3a",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/User Shell Folders",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}/TreatAs",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{77F10CF0-3DB5-4966-B520-B7C54FD35ED6}/TreatAs",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.1.0.Microsoft.PowerShell.Security__31bf3856ad364e35",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{625B53C3-AB48-4EC1-BA1F-A1EF4146FC19}/PropertyBag",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/130e9a23/5569937f/3d",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/74219a81/7b596bff/3c",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{603D3801-BD81-11d0-A3A5-00C04FD706EC}/TreatAs",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{00021401-0000-0000-C000-000000000046}/Progid",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{603D3801-BD81-11d0-A3A5-00C04FD706EC}/InprocHandler32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{77F10CF0-3DB5-4966-B520-B7C54FD35ED6}/InProcServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer///UserAssist/{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}/InprocHandler32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{2d3468c1-36a7-43b6-ac24-d3f02fd9607a}/InProcServer32",
                    "HKLM/Software/Microsoft/Windows/Shell/RegisteredApplications/UrlAssociations/Directory/OpenWithProgids",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/MountPoints2/CPC/Volume/{561ec7c3-eb9f-11e9-af89-806e6f6e6963}",
                    "HKCR/CLSID/{1F3427C8-5C10-4210-AA03-2EE45287D668}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/56d30baa/7df4ed04",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/AllFilesystemObjects/BrowseInPlace",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{603D3801-BD81-11d0-A3A5-00C04FD706EC}/InprocServer32",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/Windows",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/ProfileList/S-1-5-21-470376811-3006406624-3672060426-1000",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/KnownFolderSettings",
                    "HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/ShellCompatibility/Applications/powershell.exe",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{77F10CF0-3DB5-4966-B520-B7C54FD35ED6}/Progid",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/Instance/InitPropertyBag",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/CLSID/{1F3427C8-5C10-4210-AA03-2EE45287D668}/ShellFolder",
                    "HKLM/Software/Policies/Microsoft/MUI/Settings",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}/InprocServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows NT/CurrentVersion",
                    "HKLM/Software/Microsoft/SQMClient/Windows",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/130e9a23/5569937f",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/SideBySide/AssemblyStorageRoots",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/AppCompatFlags",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Control Panel/Desktop",
                    "HKLM/Software/Policies/Microsoft/Windows/Explorer",
                    "HKLM/System/CurrentControlSet/Control/ComputerName",
                    "HKCR/.lnk/OpenWithProgids",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/19ab8d57/1bd7b0d8/8e",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/CLSID/{1F3427C8-5C10-4210-AA03-2EE45287D668}/ShellFolder",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/Advanced",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Shell Extensions/Blocked",
                    "HKCR/AllFilesystemObjects",
                    "HKCR/Directory",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{5E6C858F-0E22-4760-9AFE-EA3317B67173}/PropertyBag",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/Progid",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/43f5e26f/6350dd80/2c",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/6eae2d34/3b249b34",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Directory/DocObject",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Drive/shellex/FolderExtensions",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Folder/DocObject",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Shell Extensions/Blocked",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/7f0603e4/73843e06",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{76765b11-3f95-4af2-ac9d-ea55d8994f1a}/TreatAs",
                    "HKLM/Software/Microsoft/.NETFramework/Security/Policy/Extensions/NamedPermissionSets/LocalIntranet",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/SystemFileAssociations/.lnk/BrowseInPlace",
                    "HKLM/SOFTWARE/Microsoft/Windows/CurrentVersion/Explorer/StartPage",
                    "HKLM/Software/Policies/Microsoft/SQMClient/Windows",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/Diagnostics",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/SideBySide",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/lnkfile/CurVer",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/CLSID/{20D04FE0-3AEA-1069-A2D8-08002B30309D}/ShellFolder",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/AllFilesystemObjects/ShellEx/IconHandler",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{B97D20BB-F46A-4C97-BA10-5E3608430854}",
                    "HKLM/System/CurrentControlSet/Control/SafeBoot/Option",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}/InprocHandler",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{603D3801-BD81-11d0-A3A5-00C04FD706EC}/Progid",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/2b351479/2a0ed676/72",
                    "HKCR/CLSID/{1F3427C8-5C10-4210-AA03-2EE45287D668}/Instance",
                    "HKLM/Software/Microsoft/Cryptography",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{52A4F021-7B75-48A9-9F6B-4B87A210BC8F}/PropertyBag",
                    "HKLM/SOFTWARE/Microsoft/Fusion",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/7950e2c5/183e33de/89",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/AllFilesystemObjects",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}/InprocServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Classes/Local Settings/MuiCache/2b/AAF68885",
                    "HKLM/Software/Policies/Microsoft/Windows/Safer/CodeIdentifiers",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/lnkfile",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}/InprocHandler",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.8.0.Microsoft.JScript__b03f5f7f11d50a3a",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/CLSID/{20D04FE0-3AEA-1069-A2D8-08002B30309D}/ShellFolder",
                    "HKCR/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}/InProcServer32",
                    "HKLM/Software/Microsoft/PowerShell/1/PowerShellEngine",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/475dce40/2d382ce6/8c",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/IME Compatibility",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/InprocHandler32",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{90AA3A4E-1CBA-4233-B8BB-535773D48449}/Progid",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{660b90c8-73a9-4b58-8cae-355b7f55341b}/Progid",
                    "HKCR/Folder",
                    "HKLM/System/CurrentControlSet/Control/Nls/ExtendedLocale",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/7df4ed04/1582fc55/3b",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/ShellFolder",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{0139D44E-6AFE-49F2-8690-3DAFCAE6FFB8}",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{C4AA340D-F20F-4863-AFEF-F87EF2E6BA25}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer///UserAssist",
                    "HKCR/CLSID/{00021401-0000-0000-C000-000000000046}",
                    "HKLM/Software/Policies/Microsoft/Windows/AppCompat",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{3EB685DB-65F9-4CF6-A03A-E3EF65729F3D}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Drawing__b03f5f7f11d50a3a",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/lnkfile/ShellEx/IconHandler",
                    "HKLM/Software/Microsoft/Windows/Windows Error Reporting/WMR",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{2d3468c1-36a7-43b6-ac24-d3f02fd9607a}/InprocHandler32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/Shell/Associations/UrlAssociations/Directory",
                    "HKLM/Software/Policies/Microsoft/Windows NT/Rpc",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{660b90c8-73a9-4b58-8cae-355b7f55341b}/InProcServer32",
                    "HKCR/CLSID/{F3364BA0-65B9-11CE-A9BA-00AA004AE837}",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Web__b03f5f7f11d50a3a",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer///UserAssist/{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}/Count",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Configuration__b03f5f7f11d50a3a",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{2d3468c1-36a7-43b6-ac24-d3f02fd9607a}/InprocHandler",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/StartPage2",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{DD313E04-FEFF-11d1-8ECD-0000F87A470C}/Progid",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}/TreatAs",
                    "HKCR/CLSID/{00021401-0000-0000-C000-000000000046}/Implemented Categories/{00021490-0000-0000-C000-000000000046}",
                    "HKLM/System/CurrentControlSet/Control/Lsa",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/SystemFileAssociations/.lnk",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Directory/CurVer",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/5bec2d27/74219a81",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/lnkfile/Clsid",
                    "HKLM/SYSTEM/CurrentControlSet/Policies/Microsoft/Cryptography/Configuration",
                    "HKLM/Software/Microsoft/.NETFramework/Security/Policy/Extensions/NamedPermissionSets",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{B4BFCC3A-DB2C-424C-B029-7FE99A87C641}/PropertyBag",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{A4115719-D62E-491D-AA7C-E74B8BE3B067}",
                    "HKLM/System/Setup",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Xml__b77a5c561934e089",
                    "HKLM/Software/Microsoft/.NETFramework/Policy//v4.0",
                    "HKLM/Software/Microsoft/.NETFramework/Policy",
                    "HKLM/Software/Microsoft/.NETFramework/Security/Policy/Extensions/NamedPermissionSets/Internet",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows NT/CurrentVersion/AppCompatFlags/Layers",
                    "HKLM/SOFTWARE/Microsoft/OLEAUT",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/ProfileList/S-1-5-21-470376811-3006406624-3672060426-1000/Preference",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/30bc7c4f/3f50fe4f/8f",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Configuration.Install__b03f5f7f11d50a3a",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/3b249b34/531d6b08/78",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Policies/Microsoft/Control Panel/Desktop",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer/User Shell Folders",
                    "HKCR/CLSID/{DD313E04-FEFF-11D1-8ECD-0000F87A470C}",
                    "HKLM/System/CurrentControlSet/Control/Session Manager",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.2.0.System.Security__b03f5f7f11d50a3a",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{77F10CF0-3DB5-4966-B520-B7C54FD35ED6}/InprocHandler32",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/Compatibility32",
                    "HKLM/Software/Microsoft/Fusion",
                    "HKLM/System/CurrentControlSet/Control/ComputerName/ActiveComputerName",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{00021401-0000-0000-C000-000000000046}/InprocHandler",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{A4115719-D62E-491D-AA7C-E74B8BE3B067}/PropertyBag",
                    "HKCR/Applications/powershell.exe",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.1.0.Microsoft.PowerShell.Commands.Diagnostics__31bf3856ad364e35",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{1B3EA5DC-B587-4786-B4EF-BD1DC332AEAE}",
                    "HKLM/System/CurrentControlSet/Services/LDAP",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Explorer//UserAssist/Settings",
                    "HKLM/Software/Microsoft/Fusion/PublisherPolicy/Default/policy.1.0.System.Management.Automation__31bf3856ad364e35",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/5d88ef29/7f5cd084/3e",
                    "HKCR/lnkfile",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/.NETFramework",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/7f5cd084/ebd3c16/3e",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{C4AA340D-F20F-4863-AFEF-F87EF2E6BA25}/PropertyBag",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FileAssociation/StartMenu",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{ED228FDF-9EA8-4870-83b1-96b02CFE0D52}",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{00021401-0000-0000-C000-000000000046}/InProcServer32",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/IL/3f50fe4f/6f1da7aa/8f",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/.lnk",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{660b90c8-73a9-4b58-8cae-355b7f55341b}/InprocHandler",
                    "HKLM/Software/Microsoft/Fusion/GACChangeNotification/Default",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{660b90c8-73a9-4b58-8cae-355b7f55341b}/TreatAs",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/5d88ef29/7f5cd084",
                    "HKLM/Software/Microsoft/Windows NT/CurrentVersion/GRE_Initialize",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{1f3427c8-5c10-4210-aa03-2ee45287d668}/TreatAs",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{AE50C081-EBD2-438A-8655-8A092E34987A}",
                    "HKLM/Software/Microsoft/.NETFramework/v2.0.50727/Security/Policy",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/Folder",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/Advanced",
                    "HKLM/Software/Microsoft/Fusion/NativeImagesIndex/v2.0.50727_32/NI/7f0603e4/73843e06/6e",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Explorer/FolderDescriptions/{A77F5D77-2E2B-44C3-A6A2-ABA601054A51}/PropertyBag",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{2d3468c1-36a7-43b6-ac24-d3f02fd9607a}/TreatAs",
                    "HKLM/System/CurrentControlSet/Control/Nls/CustomLocale",
                    "HKCR/CLSID/{DD313E04-FEFF-11D1-8ECD-0000F87A470C}/InProcServer32",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000_Classes/CLSID/{77F10CF0-3DB5-4966-B520-B7C54FD35ED6}",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Policies/NonEnum"
                ],
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "208.67.222.222"
                        ],
                        "hostname": "resolver1.opendns.com"
                    },
                    {
                        "resolved_ips": [
                            "113.88.15.179"
                        ],
                        "hostname": "myip.opendns.com"
                    }
                ],
                "files_deleted": [
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\d93f411851d7c929.customDestinations-ms~RF29f4a.TMP",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2828.172334",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2828.172334",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2828.172427",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2432.101681",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2432.101681",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2432.101853",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\d93f411851d7c929.customDestinations-ms~RF2fe5a.TMP",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2980.196686",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2980.196686",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2980.196842",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\CustomDestinations\\d93f411851d7c929.customDestinations-ms~RF30e80.TMP",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2948.200835",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2948.200835",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2948.200991",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\security.config.cch.2576.124707",
                    "C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\config\\enterprisesec.config.cch.2576.124707",
                    "C:\\Users\\admin\\AppData\\Roaming\\Microsoft\\CLR Security Config\\v2.0.50727.312\\security.config.cch.2576.124863"
                ],
                "memory_pattern_ips": [
                    "2.00.0.0",
                    "6.0.0.0",
                    "3.5.0.0",
                    "113.88.15.179",
                    "2.0.0.0",
                    "1.0.0.0",
                    "2.5.29.10",
                    "5.1.0.0",
                    "2.5.29.19",
                    "2.5.4.10",
                    "2.5.4.43",
                    "2.5.4.11",
                    "2.5.29.32",
                    "2.5.4.26",
                    "2.5.4.12",
                    "2.5.4.13",
                    "2.5.4.32",
                    "127.0.0.1",
                    "2.5.4.33",
                    "2.5.29.27",
                    "2.5.4.30",
                    "2.5.4.8",
                    "2.5.4.9",
                    "2.5.4.6",
                    "2.5.4.7",
                    "2.5.4.4",
                    "2.5.4.5",
                    "2.5.4.3",
                    "2.5.4.17",
                    "1.0.0.1",
                    "114.114.114.114",
                    "2.5.29.21",
                    "2.5.29.20",
                    "2.5.29.17",
                    "2.5.29.28",
                    "2.5.4.36",
                    "2.5.4.37",
                    "2.5.4.34",
                    "2.5.4.35",
                    "2.5.4.14",
                    "2.5.4.15",
                    "2.5.4.16",
                    "2.5.4.31",
                    "2.5.4.18",
                    "2.5.4.19",
                    "2.5.29.46",
                    "2.5.4.38",
                    "2.5.29.1",
                    "2.5.29.2",
                    "2.5.29.3",
                    "2.5.29.4",
                    "2.5.29.5",
                    "2.5.29.7",
                    "2.5.29.8",
                    "2.5.4.39",
                    "2.5.29.18",
                    "2.5.4.46",
                    "2.5.4.22",
                    "2.5.29.30",
                    "2.5.29.31",
                    "2.5.29.54",
                    "2.5.29.33",
                    "2.5.29.35",
                    "2.5.29.36",
                    "2.5.29.37",
                    "2.5.4.29",
                    "2.5.4.28",
                    "2.5.4.42",
                    "2.5.29.14",
                    "2.5.29.15",
                    "2.5.4.21",
                    "2.5.4.20",
                    "2.5.4.23",
                    "2.5.4.25",
                    "2.5.4.24",
                    "2.5.4.27",
                    "2.5.4.40"
                ],
                "registry_keys_deleted": [
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Internet Settings/ZoneMap//IntranetName",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Internet Settings/ZoneMap//ProxyBypass",
                    "HKU/S-1-5-21-470376811-3006406624-3672060426-1000/Software/Microsoft/Windows/CurrentVersion/Internet Settings/ZoneMap//IntranetName",
                    "HKLM/Software/Microsoft/Windows/CurrentVersion/Internet Settings/ZoneMap//ProxyBypass"
                ],
                "has_html_report": false,
                "behash": "996793f98bd10eb96e0ed088b8320f83",
                "analysis_date": 1697091599,
                "has_memdump": false,
                "ids_alerts": [
                    {
                        "rule_category": "Device Retrieving External IP Address Detected",
                        "alert_severity": "medium",
                        "rule_msg": "ET POLICY External IP Lookup Domain (myip .opendns .com in DNS lookup)",
                        "rule_raw": "alert dns $HOME_NET any -> any any (msg:\"ET POLICY External IP Lookup Domain (myip .opendns .com in DNS lookup)\"; dns.query; content:\"myip.opendns.com\"; nocase; endswith; classtype:external-ip-check; sid:2023472; rev:7; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2016_11_01, deployment Perimeter, former_category POLICY, performance_impact Low, signature_severity Informational, tag IP_address_lookup_website, updated_at 2020_09_15;)",
                        "alert_context": {
                            "dest_port": 53,
                            "dest_ip": "208.67.222.222"
                        },
                        "rule_url": "https://rules.emergingthreats.net/",
                        "rule_source": "Proofpoint Emerging Threats Open",
                        "rule_id": "1:2023472"
                    }
                ],
                "files_dropped": [
                    {
                        "path": "c:\\users\\admin\\appdata\\local\\temp\\ratt.bat",
                        "sha256": "baee4aa1e7979cfa18b243c3cf9f7ecfbdf424ae5d2fda8f0ffa994097992d73"
                    },
                    {
                        "path": "c:\\users\\admin\\appdata\\roaming\\microsoft\\windows\\recent\\customdestinations\\xfqmpna27kbjxlgl9bsh.temp",
                        "sha256": "d15814c006e885857de90359f7e89ffd5c632fc1c84fea20161a19231f3fb15b"
                    },
                    {
                        "path": "c:\\users\\admin\\appdata\\local\\temp\\add.ps1",
                        "sha256": "6b1a947eb48755d6dfd414c170c47451dec539e7ff177f27db925940f521bfd9"
                    },
                    {
                        "path": "c:\\users\\admin\\appdata\\local\\temp\\ratt.7z",
                        "sha256": "75c23854ab5789224c0e4b483313f1be29dd424aee21d35972d833879409f1ac"
                    },
                    {
                        "path": "c:\\users\\admin\\appdata\\local\\temp\\7z.dll",
                        "sha256": "ed50ef8e0b6dd83fb0c3f733329d4aa6e5a3beb3491e2ba9d2ae206813508dde"
                    },
                    {
                        "path": "c:\\users\\admin\\appdata\\local\\temp\\7z.exe",
                        "sha256": "77cb558edb6c6869d72554f620c2213efd00854bb871a09c985fa29dcc4a7311"
                    },
                    {
                        "path": "c:\\users\\admin\\appdata\\roaming\\microsoft\\windows\\recent\\customdestinations\\jepk76x4zgbwg999oqby.temp",
                        "sha256": "b336b768b95c51f708d4706d35000ef19e063d621f866cc57d803282a366861a"
                    }
                ],
                "has_evtx": false,
                "mutexes_opened": [
                    "Global\\CLR_CASOFF_MUTEX",
                    "Local\\_!MSFTHISTORY!_",
                    "Local\\c:!users!admin!appdata!local!microsoft!windows!temporary internet files!content.ie5!",
                    "Local\\c:!users!admin!appdata!roaming!microsoft!windows!cookies!",
                    "Local\\c:!users!admin!appdata!local!microsoft!windows!history!history.ie5!",
                    "Local\\WininetStartupMutex",
                    "Local\\WininetConnectionMutex",
                    "Local\\WininetProxyRegistryMutex",
                    "DefaultTabtip-MainUI",
                    "CicLoadWinStaWinSta0"
                ],
                "modules_loaded": [
                    "gdi32.dll",
                    "imm32.dll",
                    "uxtheme.dll",
                    "comctl32.dll",
                    "advapi32.dll",
                    "shell32.dll",
                    "ole32.dll",
                    "api-ms-win-core-localregistry-l1-1-0.dll",
                    "propsys.dll",
                    "ntmarta.dll",
                    "oleaut32.dll",
                    "user32.dll",
                    "ntshrui.dll",
                    "srvcli.dll",
                    "cscapi.dll",
                    "slc.dll",
                    "shlwapi.dll",
                    "cryptbase.dll",
                    "mscoreei.dll",
                    "kernel32.dll",
                    "mscorwks.dll",
                    "mscoree.dll",
                    "ntdll",
                    "mscorlib.ni.dll",
                    "system.ni.dll",
                    "microsoft.powershell.consolehost.ni.dll",
                    "system.management.automation.ni.dll",
                    "version.dll",
                    "system.management.automation.dll",
                    "psapi.dll",
                    "ntdll.dll",
                    "cryptsp.dll",
                    "system.core.ni.dll",
                    "microsoft.powershell.commands.diagnostics.ni.dll",
                    "system.configuration.install.ni.dll",
                    "microsoft.wsman.management.ni.dll",
                    "system.transactions.ni.dll",
                    "system.transactions.dll",
                    "microsoft.powershell.commands.utility.ni.dll",
                    "microsoft.powershell.commands.management.ni.dll",
                    "microsoft.powershell.security.ni.dll",
                    "culture.dll",
                    "mscorrc.dll",
                    "microsoft.powershell.consolehost.resources.dll",
                    "system.xml.ni.dll",
                    "system.management.ni.dll",
                    "system.directoryservices.ni.dll",
                    "system.management.automation.resources.dll",
                    "shfolder.dll",
                    "microsoft.wsman.management.resources.dll",
                    "secur32.dll",
                    "sspicli.dll",
                    "microsoft.powershell.security.resources.dll",
                    "system.data.ni.dll",
                    "system.data.dll",
                    "mscorjit.dll",
                    "mscorlib.resources.dll",
                    "netutils.dll",
                    "api-ms-win-security-lsalookup-l1-1-0.dll",
                    "msxml3r.dll",
                    "urlmon.dll",
                    "wininet.dll",
                    "ws2_32",
                    "dnsapi",
                    "iphlpapi",
                    "wmi2xml.dll",
                    "sxs.dll",
                    "<pi-ms-win-core-synch-l1-2-0",
                    "kernel32",
                    "<pi-ms-win-core-fibers-l1-1-1",
                    "<pi-ms-win-core-localization-l1-2-1",
                    "dxgidebug.dll",
                    "sfc_os.dll",
                    "rsaenh.dll",
                    "dwmapi.dll",
                    "riched20.dll",
                    "gdiplus.dll",
                    "windowscodecs.dll",
                    "comctl32",
                    "ratt.bat",
                    "sfc.dll",
                    "setupapi.dll",
                    "devrtl.dll",
                    "api-ms-win-appmodel-runtime-l1-1-1",
                    "ext-ms-win-kernel32-package-current-l1-1-0",
                    "api-ms-win-security-sddl-l1-1-0.dll",
                    "ws2_32.dll"
                ]
            }
        },
        {
            "id": "a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_VirusTotal Cuckoofork",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0_VirusTotal Cuckoofork"
            },
            "attributes": {
                "last_modification_date": 1693799924,
                "sandbox_name": "VirusTotal Cuckoofork",
                "files_opened": [
                    "C:\\a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0"
                ],
                "has_pcap": true,
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "51.145.123.29"
                        ],
                        "hostname": "time.windows.com"
                    }
                ],
                "has_html_report": true,
                "behash": "9e7681d59f1846a44bde10de2a5a6dc2",
                "analysis_date": 1693792694,
                "has_memdump": false,
                "ids_alerts": [
                    {
                        "rule_category": "misc-activity",
                        "alert_severity": "low",
                        "rule_msg": "(eth) truncated ethernet header",
                        "rule_raw": "alert ( gid:116; sid:424; rev:2; msg:\"(eth) truncated ethernet header\"; metadata: policy max-detect-ips drop, rule-type decode; classtype:misc-activity;)",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_source": "Snort registered user ruleset",
                        "rule_id": "116:424"
                    },
                    {
                        "rule_category": "misc-activity",
                        "alert_severity": "low",
                        "rule_msg": "PROTOCOL-ICMP Destination Unreachable Network Unreachable",
                        "rule_raw": "alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:\"PROTOCOL-ICMP Destination Unreachable Network Unreachable\"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )",
                        "rule_url": "https://www.snort.org/downloads/#rule-downloads",
                        "rule_source": "Snort registered user ruleset",
                        "rule_id": "1:401"
                    }
                ],
                "has_evtx": false,
                "modules_loaded": [
                    "c:\\windows\\system32\\riched20.dll",
                    "ole32.dll",
                    "comctl32.dll"
                ]
            }
        }
    ],
    "meta": {
        "count": 4
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/a19c210ee7c596691805243f45285d4150be354955b2133d87833d5e23bdfac0/behaviours?limit=10"
    }
}