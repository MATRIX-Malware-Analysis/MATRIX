{
    "data": [
        {
            "id": "c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_CAPA",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_CAPA"
            },
            "attributes": {
                "behash": "76c6c8e44cd4f1dbddc0f6c2202c1480",
                "analysis_date": 1684116027,
                "has_html_report": false,
                "last_modification_date": 1684116029,
                "signature_matches": [
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scope: basic block\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n",
                        "name": "encode data using XOR",
                        "description": "data-manipulation/encoding/xor"
                    },
                    {
                        "refs": [
                            {
                                "ref": "https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions"
                            },
                            {
                                "ref": "https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"
                            }
                        ],
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scope: basic block\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - os: linux\n        - or:\n          - api: sleep\n          - api: usleep\n",
                        "name": "delay execution",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "@ramen0x3f"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scope: basic block\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n",
                        "name": "create or open file",
                        "authors": [
                            "michael.hunhoff@mandiant.com",
                            "joakim@intezer.com"
                        ]
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "rule_src": "rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scope: function\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n",
                        "name": "contain loop",
                        "authors": [
                            "moritz.raabe@mandiant.com"
                        ]
                    },
                    {
                        "description": "linking/runtime-linking : known import name hashes calculated using the non-cryptographic FNV-1a hashing algorithm",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://blog.xorhex.com/blog/reddeltaplugxchangeup/"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by FNV-1a hash\n    namespace: linking/runtime-linking\n    authors:\n      - still@teamt5.org\n    description: known import name hashes calculated using the non-cryptographic FNV-1a hashing algorithm\n    scope: function\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]\n    references:\n      - https://blog.xorhex.com/blog/reddeltaplugxchangeup/\n  features:\n    - or:\n      - number: 0x53b2070f = FNV(LoadLibraryA)\n      - number: 0xfaba0065 = FNV(CloseHandle)\n      - number: 0x03285501 = FNV(VirtualAlloc)\n      - number: 0x820621f3 = FNV(VirtualProtect)\n      - number: 0xf8f45725 = FNV(GetProcAddress)\n      - number: 0xbdcac9ce = FNV(CreateFileA)\n      - number: 0xafcab3c4 = FNV(CreateFileW)\n      - number: 0x54fcc943 = FNV(ReadFile)\n      - number: 0x2fa62ca8 = FNV(Sleep)\n",
                        "authors": [
                            "still@teamt5.org"
                        ],
                        "name": "resolve function by FNV-1a hash"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "sara-rn"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: resolve function by parsing PE exports\n    namespace: load-code/pe\n    authors:\n      - sara-rn\n    scope: function\n    examples:\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x406BA1\n  features:\n    - and:\n      - os: windows\n      - or:\n        - characteristic: loop\n        - mnemonic: movzx\n      - and:\n        - offset: 0x3C = IMAGE_DOS_HEADER.PE.e_lfanew\n        - or:\n          - and:\n            - arch: i386\n            - offset: 0x78 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n          - and:\n            - arch: amd64\n            - offset: 0x88 = offset to IMAGE_DATA_DIRECTORY[IMAGE_DIRECTORY_ENTRY_EXPORT]\n        - 3 or more:\n          - offset: 0x14 = IMAGE_EXPORT_DIRECTORY.NumberOfFunctions\n          - offset: 0x24 = IMAGE_EXPORT_DIRECTORY.AddressOfNameOrdinals\n          - offset: 0x20 = IMAGE_EXPORT_DIRECTORY.AddressOfNames\n          - offset: 0x18 = IMAGE_EXPORT_DIRECTORY.NumberOfNames\n          - offset: 0x1C = IMAGE_EXPORT_DIRECTORY.AddressOfFunctions\n      - optional:\n        - or:\n          - api: LoadLibrary\n          - api: strcmp\n",
                        "name": "resolve function by parsing PE exports",
                        "description": "load-code/pe"
                    },
                    {
                        "description": "data-manipulation/hashing/fnv : can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0",
                        "format": "SIG_FORMAT_CAPA",
                        "refs": [
                            {
                                "ref": "https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function"
                            },
                            {
                                "ref": "http://isthe.com/chongo/tech/comp/fnv/"
                            },
                            {
                                "ref": "https://create.stephan-brumme.com/fnv-hash/"
                            }
                        ],
                        "rule_src": "rule:\n  meta:\n    name: hash data using fnv\n    namespace: data-manipulation/hashing/fnv\n    authors:\n      - moritz.raabe@mandiant.com\n      - \"@_re_fox\"\n      - michael.hunhoff@mandiant.com\n    description: can be any Fowler-Noll-Vo (FNV) hash variant, including FNV-1, FNV-1a, FNV-0\n    scope: function\n    mbc:\n      - Data::Non-Cryptographic Hash::FNV [C0030.005]\n    references:\n      - https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n      - http://isthe.com/chongo/tech/comp/fnv/\n      - https://create.stephan-brumme.com/fnv-hash/\n    examples:\n      - ad4229879180e267f431ac6666b6a0a2:0x14007B4D4\n  features:\n    - and:\n      - optional:\n        - characteristic: loop\n        - number: 0xcbf29ce484222325 = FNV_offset_basis, unused by FNV-0\n        - number: 0x811c9dc5 = FNV_offset_basis, unused by FNV-0\n      - or:\n        - number: 0x100000001b3 = FNV prime\n        - number: 0x01000193 = FNV prime\n      - basic block:\n        # FNV-1 hash does multiply then XOR\n        # FNV-1a hash does XOR then multiply\n        - and:\n          - characteristic: nzxor\n          - or:\n            - mnemonic: imul\n            - mnemonic: mul\n",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "@_re_fox",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "name": "hash data using fnv"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: get thread local storage value\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n  features:\n    - and:\n      - api: kernel32.TlsGetValue\n",
                        "name": "get thread local storage value",
                        "description": "host-interaction/process"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: print debug messages\n    namespace: host-interaction/log/debug/write-event\n    authors:\n      - michael.hunhoff@mandiant.com\n    scope: function\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n  features:\n    - or:\n      - api: DbgPrint\n      - api: kernel32.OutputDebugString\n",
                        "name": "print debug messages",
                        "description": "host-interaction/log/debug/write-event"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "michael.hunhoff@mandiant.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n      - optional:\n        - characteristic: indirect call\n        - api: kernel32.LoadLibrary\n        - api: kernel32.GetModuleHandle\n        - api: kernel32.GetModuleHandleEx\n        - api: ntdll.LdrLoadDll\n",
                        "name": "link function at runtime on Windows",
                        "description": "linking/runtime-linking"
                    },
                    {
                        "format": "SIG_FORMAT_CAPA",
                        "authors": [
                            "moritz.raabe@mandiant.com",
                            "joakim@intezer.com"
                        ],
                        "rule_src": "rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scope: function\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - os: linux\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n",
                        "name": "link many functions at runtime",
                        "description": "linking/runtime-linking"
                    }
                ],
                "sandbox_name": "CAPA",
                "has_evtx": false,
                "has_memdump": false,
                "has_pcap": false,
                "mitre_attack_techniques": [
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "encode data using XOR"
                            }
                        ],
                        "signature_description": "encode data using XOR",
                        "id": "T1027",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "resolve function by FNV-1a hash"
                            }
                        ],
                        "signature_description": "resolve function by FNV-1a hash",
                        "id": "T1027.005",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link function at runtime on Windows"
                            }
                        ],
                        "signature_description": "link function at runtime on Windows",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "refs": [
                            {
                                "ref": "#signature_matches",
                                "value": "link many functions at runtime"
                            }
                        ],
                        "signature_description": "link many functions at runtime",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ]
            }
        },
        {
            "id": "c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_DAS-Security Orcas",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_DAS-Security Orcas"
            },
            "attributes": {
                "behash": "6398bac7ab2bd82223527c22a5f49711",
                "analysis_date": 1663213103,
                "has_html_report": false,
                "processes_created": [
                    "C:\\windows\\system32\\rundll32.exe"
                ],
                "last_modification_date": 1663191852,
                "processes_tree": [
                    {
                        "process_id": "2780",
                        "name": "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll "
                    },
                    {
                        "process_id": "3600",
                        "name": "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll "
                    },
                    {
                        "process_id": "1416",
                        "name": "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll "
                    }
                ],
                "sandbox_name": "DAS-Security Orcas",
                "memory_pattern_ips": [
                    "1.0.0.0",
                    "9.0.0.30",
                    "10.0.0.34"
                ],
                "processes_terminated": [
                    "C:\\windows\\system32\\rundll32.exe"
                ],
                "tags": [
                    "RUNTIME_MODULES"
                ],
                "command_executions": [
                    "C:\\windows\\system32\\rundll32.exe ${SamplePath}\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll "
                ],
                "has_evtx": false,
                "verdicts": [
                    "CLEAN"
                ],
                "has_memdump": false,
                "has_pcap": true,
                "mitre_attack_techniques": [
                    {
                        "signature_description": "load third party dll",
                        "id": "T1129",
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    },
                    {
                        "signature_description": "get time manytimes",
                        "id": "T1622",
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    },
                    {
                        "signature_description": "run rundll32 sample is dll",
                        "id": "T1218.011",
                        "severity": "IMPACT_SEVERITY_MEDIUM"
                    }
                ],
                "modules_loaded": [
                    "C:\\Windows\\System32\\ntdll.dll",
                    "C:\\Windows\\SysWOW64\\ntdll.dll",
                    "C:\\Windows\\System32\\wow64.dll",
                    "C:\\Windows\\System32\\wow64win.dll",
                    "C:\\Windows\\System32\\wow64cpu.dll",
                    "C:\\Windows\\System32\\kernel32.dll",
                    "C:\\Windows\\SysWOW64\\kernel32.dll",
                    "C:\\Windows\\System32\\user32.dll",
                    "C:\\Windows\\SysWOW64\\KernelBase.dll",
                    "C:\\Windows\\SysWOW64\\shell32.dll",
                    "C:\\Windows\\SysWOW64\\msvcrt.dll",
                    "C:\\Windows\\SysWOW64\\shlwapi.dll",
                    "C:\\Windows\\SysWOW64\\gdi32.dll",
                    "C:\\Windows\\SysWOW64\\user32.dll",
                    "C:\\Windows\\SysWOW64\\advapi32.dll",
                    "C:\\Windows\\SysWOW64\\sechost.dll",
                    "C:\\Windows\\SysWOW64\\rpcrt4.dll",
                    "C:\\Windows\\SysWOW64\\sspicli.dll",
                    "C:\\Windows\\SysWOW64\\cryptbase.dll",
                    "C:\\Windows\\SysWOW64\\lpk.dll",
                    "C:\\Windows\\SysWOW64\\usp10.dll",
                    "C:\\Windows\\SysWOW64\\ole32.dll",
                    "C:\\Windows\\SysWOW64\\imagehlp.dll",
                    "C:\\Windows\\SysWOW64\\imm32.dll",
                    "C:\\Windows\\SysWOW64\\msctf.dll",
                    "C:\\Windows\\winsxs\\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.7601.24203_none_5c030043a0118fbf\\GdiPlus.dll",
                    "C:\\Windows\\SysWOW64\\dbghelp.dll",
                    "C:\\Windows\\SysWOW64\\ws2_32.dll",
                    "C:\\Windows\\SysWOW64\\nsi.dll",
                    "C:\\Windows\\SysWOW64\\psapi.dll",
                    "C:\\Windows\\SysWOW64\\oleaut32.dll",
                    "C:\\Windows\\SysWOW64\\setupapi.dll",
                    "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                    "C:\\Windows\\SysWOW64\\devobj.dll",
                    "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                    "C:\\Windows\\SysWOW64\\winnsi.dll",
                    "C:\\Windows\\SysWOW64\\api-ms-win-core-synch-l1-2-0.DLL",
                    "C:\\Windows\\SysWOW64\\version.dll",
                    "${SamplePath}\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll"
                ],
                "windows_hidden": [
                    "C:\\windows\\system32\\rundll32.exe"
                ],
                "memory_pattern_domains": [
                    "localhost",
                    "system",
                    "msdn.microsoft.com",
                    "spaces.live.com",
                    "ieframe.dll"
                ],
                "memory_pattern_urls": [
                    "res://ieframe.dll/FeedUI.css",
                    "res://ieframe.dll/feedcheckmark.png",
                    "res://ieframe.dll/syncengine.png",
                    "res://ieframe.dll/favcenter.png",
                    "res://ieframe.dll/Subscribe_feed.gif",
                    "res://ieframe.dll/keysauth.png",
                    "res://ieframe.dll/feedarrowtrans.png",
                    "res://ieframe.dll/feedcomments.png",
                    "res://ieframe.dll/sort_down.gif",
                    "res://ieframe.dll/sort_up.gif",
                    "res://ieframe.dll/active_filter.gif",
                    "res://ieframe.dll/feedunreadarrow.png",
                    "res://ieframe.dll/feedreadarrow.png",
                    "res://ieframe.dll/active_filter_rtl.gif",
                    "res://ieframe.dll/feedunreadarrow_rtl.png",
                    "res://ieframe.dll/feedreadarrow_rtl.png",
                    "http://localhost",
                    "https://localhost",
                    "hcp://system",
                    "http://msdn.microsoft.com/workshop/security/privacy/overview/privacyimportxml.asp",
                    "http://msdn.microsoft.com/workshop/security/szone/overview/templates.asp",
                    "res://ieframe.dll/ErrorPageTemplate.css",
                    "res://ieframe.dll/errorPageStrings.js",
                    "res://ieframe.dll/httpErrorPagesScripts.js",
                    "res://ieframe.dll/info_48.png",
                    "res://ieframe.dll/bullet.png",
                    "http://spaces.live.com/BlogIt.aspx",
                    "res://ieframe.dll/info_32.png",
                    "res://ieframe.dll/ProgressSpinner.gif"
                ]
            }
        },
        {
            "id": "c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_SecondWrite",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_SecondWrite"
            },
            "attributes": {
                "behash": "8e21ec4c6f97189ddb0d8daff2a619f9",
                "analysis_date": 1655436010,
                "has_html_report": true,
                "processes_created": [
                    "rundll32.exe"
                ],
                "last_modification_date": 1655436091,
                "processes_tree": [
                    {
                        "process_id": "2572",
                        "name": "rundll32.exe",
                        "children": [
                            {
                                "process_id": "2724",
                                "name": "rundll32.exe"
                            }
                        ]
                    }
                ],
                "sandbox_name": "SecondWrite",
                "dns_lookups": [
                    {
                        "resolved_ips": [
                            "40.119.148.38"
                        ],
                        "hostname": "time.windows.com"
                    }
                ],
                "files_opened": [
                    "C:\\Users\\Virtual\\AppData\\Local\\Temp\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll"
                ],
                "command_executions": [
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll,#1",
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll,StartProtect",
                    "\"C:\\Windows\\System32\\rundll32.exe\" C:\\Users\\Virtual\\AppData\\Local\\Temp\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll,dtfeglxfwtukfsqdv"
                ],
                "has_evtx": false,
                "verdicts": [
                    "MALWARE",
                    "TROJAN"
                ],
                "has_memdump": false,
                "has_pcap": true,
                "modules_loaded": [
                    "C:\\Users\\Virtual\\AppData\\Local\\Temp\\c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b.dll",
                    "kernel32.dll"
                ]
            }
        },
        {
            "id": "c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_Zenbox",
            "type": "file_behaviour",
            "links": {
                "self": "https://www.virustotal.com/api/v3/file_behaviours/c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b_Zenbox"
            },
            "attributes": {
                "behash": "5065d2eae34bc06c241268060f9b6f79",
                "analysis_date": 1655419708,
                "has_html_report": false,
                "last_modification_date": 1656671671,
                "processes_tree": [
                    {
                        "process_id": "5616",
                        "name": "C:\\Windows\\System32\\loaddll32.exe loaddll32.exe \"C:\\Users\\user\\Desktop\\init.dll\"",
                        "children": [
                            {
                                "process_id": "6328",
                                "name": "C:\\Windows\\SysWOW64\\cmd.exe cmd.exe /C rundll32.exe \"C:\\Users\\user\\Desktop\\init.dll\",#1",
                                "children": [
                                    {
                                        "process_id": "7184",
                                        "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\init.dll\",#1"
                                    }
                                ]
                            },
                            {
                                "process_id": "5772",
                                "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\init.dll,StartProtect"
                            },
                            {
                                "process_id": "6440",
                                "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe C:\\Users\\user\\Desktop\\init.dll,dtfeglxfwtukfsqdv"
                            },
                            {
                                "process_id": "7852",
                                "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe \"C:\\Users\\user\\Desktop\\init.dll\",StartProtect"
                            },
                            {
                                "process_id": "7840",
                                "name": "C:\\Windows\\SysWOW64\\rundll32.exe rundll32.exe \"C:\\Users\\user\\Desktop\\init.dll\",dtfeglxfwtukfsqdv"
                            }
                        ]
                    }
                ],
                "sandbox_name": "Zenbox",
                "files_written": [
                    "\\Device\\ConDrv\\\\Connect"
                ],
                "files_opened": [
                    "C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath\\",
                    "C:\\Users\\user\\Desktop\\init.dll",
                    "C:\\Users\\user\\Desktop\\init.dll.123.Manifest",
                    "C:\\Users\\user\\Desktop\\init.dll.124.Manifest",
                    "C:\\Users\\user\\Desktop\\init.dll.2.Manifest",
                    "C:\\Windows\\AppPatch\\sysmain.sdb",
                    "C:\\Windows\\Globalization\\Sorting\\sortdefault.nls",
                    "C:\\Windows\\SysWOW64\\",
                    "C:\\Windows\\SysWOW64\\AcLayers.DLL",
                    "C:\\Windows\\SysWOW64\\CRYPTBASE.dll",
                    "C:\\Windows\\SysWOW64\\FLTLIB.DLL",
                    "C:\\Windows\\SysWOW64\\GDI32.dll",
                    "C:\\Windows\\SysWOW64\\IMM32.DLL",
                    "C:\\Windows\\SysWOW64\\IPHLPAPI.DLL",
                    "C:\\Windows\\SysWOW64\\KERNEL32.DLL",
                    "C:\\Windows\\SysWOW64\\KERNELBASE.dll",
                    "C:\\Windows\\SysWOW64\\MPR.dll",
                    "C:\\Windows\\SysWOW64\\MSCTF.dll",
                    "C:\\Windows\\SysWOW64\\OLEAUT32.dll",
                    "C:\\Windows\\SysWOW64\\PROPSYS.dll",
                    "C:\\Windows\\SysWOW64\\RPCRT4.dll",
                    "C:\\Windows\\SysWOW64\\SETUPAPI.dll",
                    "C:\\Windows\\SysWOW64\\SHELL32.dll",
                    "C:\\Windows\\SysWOW64\\SmadDB.dat",
                    "C:\\Windows\\SysWOW64\\SspiCli.dll",
                    "C:\\Windows\\SysWOW64\\USER32.dll",
                    "C:\\Windows\\SysWOW64\\WINSPOOL.DRV",
                    "C:\\Windows\\SysWOW64\\advapi32.dll",
                    "C:\\Windows\\SysWOW64\\apphelp.dll",
                    "C:\\Windows\\SysWOW64\\bcrypt.dll",
                    "C:\\Windows\\SysWOW64\\bcryptPrimitives.dll",
                    "C:\\Windows\\SysWOW64\\cfgmgr32.dll",
                    "C:\\Windows\\SysWOW64\\combase.dll",
                    "C:\\Windows\\SysWOW64\\dwmapi.dll",
                    "C:\\Windows\\SysWOW64\\en-US\\rundll32.exe.mui",
                    "C:\\Windows\\SysWOW64\\gdi32full.dll",
                    "C:\\Windows\\SysWOW64\\imagehlp.dll",
                    "C:\\Windows\\SysWOW64\\kernel.appcore.dll",
                    "C:\\Windows\\SysWOW64\\loaddll32.exe",
                    "C:\\Windows\\SysWOW64\\msvcp_win.dll",
                    "C:\\Windows\\SysWOW64\\msvcrt.dll",
                    "C:\\Windows\\SysWOW64\\ntdll.dll",
                    "C:\\Windows\\SysWOW64\\ole32.dll",
                    "C:\\Windows\\SysWOW64\\powrprof.dll",
                    "C:\\Windows\\SysWOW64\\profapi.dll",
                    "C:\\Windows\\SysWOW64\\rundll32.exe",
                    "C:\\Windows\\SysWOW64\\sechost.dll",
                    "C:\\Windows\\SysWOW64\\sfc.dll",
                    "C:\\Windows\\SysWOW64\\sfc_os.DLL",
                    "C:\\Windows\\SysWOW64\\shcore.dll",
                    "C:\\Windows\\SysWOW64\\shlwapi.dll",
                    "C:\\Windows\\SysWOW64\\ucrtbase.dll",
                    "C:\\Windows\\SysWOW64\\uxtheme.dll",
                    "C:\\Windows\\SysWOW64\\win32u.dll",
                    "C:\\Windows\\SysWOW64\\windows.storage.dll",
                    "\\Device\\KsecDD",
                    "C:\\Users\\user\\Desktop\\readme.dll",
                    "C:\\Users\\user\\Desktop\\readme.dll.123.Manifest",
                    "C:\\Users\\user\\Desktop\\readme.dll.124.Manifest",
                    "C:\\Users\\user\\Desktop\\readme.dll.2.Manifest"
                ],
                "registry_keys_opened": [
                    "HKEY_CURRENT_USER\\Software\\Classes\\Local Settings",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers",
                    "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
                    "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft",
                    "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole",
                    "HKEY_CURRENT_USER_Classes\\Local Settings\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppModel\\Lookaside\\Packages",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DllNXOptions",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\cmd.exe",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\rundll32.exe",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLE",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\OLEAUT",
                    "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Policies\\Microsoft\\WindowsStore",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\MUI\\UILanguages\\en-US",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Segment Heap",
                    "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\Cryptography\\Configuration",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Ole\\FeatureDevelopmentProperties",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Disable8And16BitMitigation",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86",
                    "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Wow64\\x86\\xtajit",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\LanguageOverlay\\OverlayPackages\\en-US",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\OLE\\Tracing",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\GRE_Initialize",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\SideBySide",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\MUI\\Settings",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Display",
                    "HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Policies\\Microsoft\\Windows\\Safer\\CodeIdentifiers",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\FipsAlgorithmPolicy",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\Settings\\LanguageConfiguration",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\MUI\\UILanguages\\PendingDelete",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\NLS\\Language",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\CustomLocale",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\ExtendedLocale",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Nls\\Sorting\\Versions",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SafeBoot\\Option",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                    "HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Srp\\GP\\DLL",
                    "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\HwOrder",
                    "HKEY_LOCAL_MACHINE\\system\\CurrentControlSet\\control\\NetworkProvider\\ProviderOrder"
                ],
                "tags": [
                    "IDLE"
                ],
                "has_evtx": true,
                "verdicts": [
                    "CLEAN"
                ],
                "has_memdump": true,
                "has_pcap": true,
                "mitre_attack_techniques": [
                    {
                        "signature_description": "Spawns processes",
                        "id": "T1055",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Creates a process in suspended mode (likely to inject code)",
                        "id": "T1055",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Runs a DLL by calling functions",
                        "id": "T1218.011",
                        "severity": "IMPACT_SEVERITY_INFO"
                    },
                    {
                        "signature_description": "Reads software policies",
                        "id": "T1082",
                        "severity": "IMPACT_SEVERITY_INFO"
                    }
                ],
                "sigma_analysis_results": [
                    {
                        "match_context": [
                            {
                                "values": {
                                    "EventID": "5038",
                                    "param1": "\\Device\\HarddiskVolume4\\Program Files (x86)\\sandbox\\driver\\sandbox-driver.sys"
                                }
                            }
                        ],
                        "rule_level": "low",
                        "rule_id": "134564d292d785dff102940b8a1ee06dba2d462c5fb852124b3771a49d7885f1",
                        "rule_source": "Sigma Integrated Rule Set (GitHub)",
                        "rule_title": "Failed Code Integrity Checks",
                        "rule_description": "Code integrity failures may indicate tampered executables.",
                        "rule_author": "Thomas Patzke"
                    },
                    {
                        "match_context": [
                            {
                                "values": {
                                    "EventID": "4104",
                                    "ScriptBlockText": "jWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif(($pr.Name -eq \"DeviceId\" -or $pr.Name -eq \"Caption\" -or $pr.Name -eq \"Name\" -or $pr.Name -eq \"PNPDeviceID\"  -or $pr.Name -eq \"Service\") -and ($pr.Value -match 'VEN_80EE' -or $pr.Value -match 'VEN_15AD' -or $pr.Value -match 'VBOX' -or $pr.Value -match 'VBox' -or $pr.Value -match 'VMWARE' -or $pr.Value -match '82801FB' -or $pr.Value -match '82441FX' -or $pr.Value -match '82371SB' -or $pr.Value -match 'OpenHCD'))\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789_'\r\n\t\t\t$value = $pr.Value.replace(\"VEN_80EE\", $value).replace(\"VEN_15AD\", $value).replace(\"VBOX\", $value).replace(\"VBox\", $value).replace(\"VMWARE\", $value).replace(\"82801FB\", $value).replace(\"82441FX\", $value).replace(\"82371SB\", $value).replace(\"OpenHCD\", $value)\r\n\t\t\t\r\n\t\t\t# 82801FB 82441FX 82371SB OpenHCD\r\n\t\t\t\t\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t\t\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_PnPEntity -Arguments $args\r\n}\r\n\r\n#Joebox\r\n\r\n#Creating Win32_DiskDrive fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_DiskDrive\";\r\n$newClass.Qualifiers.Add(\"Static\", $true);\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_DiskDrive\"\r\n\r\nif(-Not ($objWMi -is [array]))\r\n{\r\n\t$objWMi = @($objWMi)\r\n}\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif(($pr.Name -eq \"DeviceId\" -or $pr.Name -eq \"Caption\" -or $pr.Name -eq \"Model\" -or $pr.Name -eq \"PNPDeviceID\") -and ($pr.Value -match 'VBOX' -or $pr.Value -match 'VBox' -or $pr.Value -match 'VMWARE' -or $pr.Value -match 'VMware'))\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789_'\r\n\t\t\t$value = $pr.Value.replace(\"VBOX\", $value).replace(\"VBox\", $value).replace(\"VMWARE\", $value).replace(\"VMware Virtual disk\", $value).replace(\"VMware\", $value).replace(\"HARDDISK\", \"WDC\").replace(\"VIRTUAL_DISK\", $value)\r\n\t\t\t\t\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t\r\n\t\t# Change disk size\r\n\t\t} elseif($pr.Name -eq \"Size\" -and $pr.Value -lt 200000000000)\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, 412300001200)\r\n\t\t} elseif(-Not($pr.Name -eq \"Capabilities\"))\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_DiskDrive -Arguments $args\r\n}\r\n\r\n#Joebox\r\n\r\n#Creating Win32_VideoController fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_VideoController\";\r\n$newClass.Qualifiers.Add(\"Static\", $true);\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_VideoController\"\r\n\r\nif(-Not ($objWMi -is [array]))\r\n{\r\n\t$objWMi = @($objWMi)\r\n}\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif(($pr.Name -eq \"Caption\" -or $pr.Name -eq \"Name\" -or $pr.Name -eq \"PNPDeviceID\" -or $pr.Name -eq \"AdapterCompatibility\" -or $pr.Name -eq \"Description\" -or $pr.Name -eq \"InfSection\" -or $pr.Name -eq \"VideoProcessor\") -and ($pr.Value -match 'VBOX' -or $pr.Value -match 'VBox' -or $pr.Value -match 'VMWARE' -or $pr.Value -match 'VirtualBox' -or $pr.Value -match 'VMware' -or $pr.Value -match 'Oracle Corporation' -or $pr.Value -match 'Microsoft Basic Display Adapter'))\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789_'\r\n\t\t\t$value = $pr.Value.replace(\"VBOX\", $value).replace(\"VBox\", $value).replace(\"VMWARE\", $value).replace(\"VMware\", $value).replace(\"VirtualBox\", $value).replace(\"Oracle Corporation\", $value).replace(\"Microsoft Basic Display Adapter\", $value)\r\n\t\t\t\t\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t\r\n\r\n\t\t} elseif($pr.Name -eq \"DriverVersion\")\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 8 -characters '1234567890.'\r\n\t\t\t$args.add($pr.Name, $value)\r\n\t\t} elseif($pr.Name -eq \"AdapterRAM\" -and $pr.Value -lt 1000000000)\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, 1073741824)\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_VideoController -Arguments $args\r\n}\r\n\r\n#Joebox\r\n\r\n#Creating Win32_BaseBoard fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_BaseBoard\";\r\n$newClass.Qualifiers.Add(\"Static\", $true)\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_BaseBoard\"\r\n\r\nforeach ($obj in $objWmi)\r\n{\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\r\n\t\tif($pr.Name -eq \"Name\")\r\n\t\t{\t$value = Get-RandomCharacters -length 10 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789'\r\n\r\n\t\t\t$newClass.Properties.Add($pr.Name, $value, $pr.Type)\r\n\t\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t\t} elseif($pr.Name -eq \"Product\" -or $pr.Name -eq \"Manufacturer\")\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 10 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789'\r\n\t\t\t$newClass.Properties.Add($pr.Name, $value, $pr.Type)\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.Value, $pr.Type)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$newClass.Put()\r\nSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_BaseBoard\r\n\r\n\r\n#Creating Win32_ComputerSystemProduct fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_ComputerSystemProduct\";\r\n$newClass.Qualifiers.Add(\"Static\", $true)\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_ComputerSystemProduct\"\r\n\r\nforeach ($obj in $objWmi)\r\n{\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\r\n\t\tif($pr.Name -eq \"Name\")\r\n\t\t{\t\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.$value, $pr.Type)\r\n\t\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t\t} elseif($pr.Name -eq \"IdentifyingNumber\")\r\n\t\t{\r\n\t\t\t$value = Get-RandomCharacters -length 6 -characters 'ABCDEFGHKLMNOPRSTUVWXYZ123456789'\r\n\t\t\t$newClass.Properties.Add($pr.Name, $value, $pr.Type)\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.Value, $pr.Type)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$newClass.Put()\r\nSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_ComputerSystemProduct\r\n\r\n\r\n\r\n#Creating Win32_LogicalDisk fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_LogicalDisk\";\r\n$newClass.Qualifiers.Add(\"Static\", $true);\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_LogicalDisk WHERE DriveType = 3\"\r\n\r\nif(-Not ($objWMi -is [array]))\r\n{\r\n\t$objWMi = @($objWMi)\r\n}\r\n\r\nforeach ($pr in $objWmi[0].Properties)\r\n{\r\n\t$newClass.Properties.Add($pr.Name, $pr.Type, $false)\t\r\n\tif($pr.Name -eq \"DeviceID\")\r\n\t{\r\n\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t}\r\n\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"read\", $true)\r\n}\r\n\r\n$newClass.Put()\r\n\r\nforeach ($obj in $objWmi)\r\n{\t\r\n\t$args = @{}\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\t\r\n\t\tif($pr.Name -eq \"Size\")\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, \"223496729601\")\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$args.add($pr.Name, $pr.Value)\r\n\t\t}\r\n\t}\r\n\t\r\n\tSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_LogicalDisk -Arguments $args\r\n}\r\n\r\n\r\n#Creating Win32_ComputerSystemProduct fake class\r\n$newClass = New-Object System.Management.ManagementClass(\"root\\cimv2\", [String]::Empty, $null); \r\n$newClass[\"__CLASS\"] = \"Win32_OperatingSystem\";\r\n$newClass.Qualifiers.Add(\"Static\", $true)\r\n\r\n$objWMi = get-wmiobject -computername localhost -Namespace root\\CIMV2 -Query \"Select * from Win32_OperatingSystem\"\r\n\r\n\r\nforeach ($obj in $objWmi)\r\n{\r\n\tforeach ($pr in $obj.Properties)\r\n\t{\r\n\t\tif($pr.Name -eq \"CreationClassName\")\r\n\t\t{\t\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.$value, $pr.Type)\r\n\t\t\t$newClass.Properties[$pr.Name].Qualifiers.Add(\"Key\", $true)\r\n\t\t} elseif($pr.Name -eq \"LastBootUpTime\")\r\n\t\t{\r\n\t\t\t$d = [System.Management.ManagementDateTimeConverter]::ToDateTime($pr.Value)\r\n\t\t\t$d = $d.addDays(-10)\r\n\t\t\t$d = [System.Management.ManagementDateTimeConverter]::ToDmtfDateTime($d)\r\n\t\t\t\r\n\t\t\t$newClass.Properties.Add($pr.Name, $d, $pr.Type)\r\n\t\t\t\r\n\t\t} else\r\n\t\t{\r\n\t\t\t$newClass.Properties.Add($pr.Name, $pr.Value, $pr.Type)\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$newClass.Put()\r\nSet-WmiInstance -Path \\\\.\\root\\cimv2:Win32_OperatingSystem\r\n\r\n\r\nfunction Delete() {\r\n    $Invocation = (Get-Variable MyInvocation -Scope 1).Value\r\n    $Path =  $Invocation.MyCommand.Path \r\n    Write-Host $Path\r\n    Remove-Item $Path -force\r\n} \r\n     \r\nDelete \r\n",
                                    "ScriptBlockId": "eb973f7c-2a07-45d5-adcc-7ec9bd5254a6",
                                    "MessageNumber": "\u0002",
                                    "MessageTotal": "\u0002",
                                    "Path": "C:\\Program Files (x86)\\Joebox\\unpack\\wmievasions.ps1"
                                }
                            }
                        ],
                        "rule_level": "low",
                        "rule_id": "d9b2eb00753c3049fbb4ed4f7d88f29b65a0c50bec45ff4723b95bb637f8f83d",
                        "rule_source": "Sigma Integrated Rule Set (GitHub)",
                        "rule_title": "Use Remove-Item to Delete File",
                        "rule_description": "Powershell Remove-Item  with -Path to delete a file or a folder with \"-Recurse\"",
                        "rule_author": "frack113"
                    }
                ],
                "verdict_confidence": 1
            }
        }
    ],
    "meta": {
        "count": 4
    },
    "links": {
        "self": "https://www.virustotal.com/api/v3/files/c9f7248e64b531031822e3cda468bf52fcfe169ad15d7d8ddf379cb27ad8b63b/behaviours?limit=10"
    }
}